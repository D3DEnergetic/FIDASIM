language: python

python:
  - 2.7

cache:
  apt: true
  pip: true

branches:
  only:
    - master

notifications:
  email:
    recipients:
      - lstagner@uci.edu
    on_failure: always
    on_success: change

addons:
  apt:  
    packages:
    - git
    - gcc
    - g++
    - gfortran
    - zlib1g-dev
    - linkchecker
    - python-pip
    - graphviz

before_install:
  - openssl aes-256-cbc -K $encrypted_60fa3eb19c83_key -iv $encrypted_60fa3eb19c83_iv -in travis_key.enc -out travis_key -d

install:
  - export FC=gfortran
  - export CC=gcc
  - export CXX=g++
  - pip install --upgrade graphviz
  - (pip install --upgrade ford && ford --version)

script:
  - make
  - ./fidasim
  - make docs CHECK_LINKS=n
  - cd $TRAVIS_BUILD_DIR
  - git config --global user.name "TRAVIS-CI-for-$(git --no-pager show -s --format='%cn' $TRAVIS_COMMIT)"
  - git config --global user.email "$(git --no-pager show -s --format='%ce' $TRAVIS_COMMIT)"
  - bash ./deploy.sh
