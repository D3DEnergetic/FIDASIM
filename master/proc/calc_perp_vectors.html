<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>calc_perp_vectors &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>calc_perp_vectors
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.2% of total for procedures.">23 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
    
     <li><a href='../module/libfida.html'>libfida</a></li>
    
  
     <li class="active">calc_perp_vectors</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/calc_perp_vectors.html#src">calc_perp_vectors</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public pure subroutine calc_perp_vectors(b, a, c)
    
    
   
</h2>
    
  


    
    <p>Calculates normalized vectors that are perpendicular to b
 such that <code>a</code> x <code>c</code> = <code>b_norm</code></p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-b%7E4"></span>real(kind=Float64),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(3)</td><td>::</td>
  <td><strong>b</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-a%7E4"></span>real(kind=Float64),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(3)</td><td>::</td>
  <td><strong>a</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-c"></span>real(kind=Float64),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(3)</td><td>::</td>
  <td><strong>c</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~calc_perp_vectors~~CalledByGraph Pages: 1 -->
<svg id="proccalc_perp_vectorsCalledByGraph" width="614pt" height="902pt"
 viewBox="0.00 0.00 614.00 902.38" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~calc_perp_vectors~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 898.379)">
<title>proc~~calc_perp_vectors~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-898.379 610,-898.379 610,4 -4,4"/>
<!-- proc~calc_perp_vectors -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node1" class="node"><title>proc~calc_perp_vectors</title>
<polygon fill="none" stroke="black" points="606,-852.379 506,-852.379 506,-828.379 606,-828.379 606,-852.379"/>
<text text-anchor="middle" x="556" y="-837.979" font-family="Helvetica,sans-Serif" font-size="10.50">calc_perp_vectors</text>
</g>
<!-- proc~lflf_subtract -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node2" class="node"><title>proc~lflf_subtract</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node2"><a xlink:href=".././proc/lflf_subtract.html" xlink:title="lflf_subtract">
<polygon fill="#d94e8f" stroke="#d94e8f" points="469.5,-894.379 402.5,-894.379 402.5,-870.379 469.5,-870.379 469.5,-894.379"/>
<text text-anchor="middle" x="436" y="-879.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lflf_subtract</text>
</a>
</g>
</g>
<!-- proc~lflf_subtract&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge1" class="edge"><title>proc~lflf_subtract&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M469.556,-870.791C482.402,-866.219 497.355,-860.897 511.129,-855.994"/>
<polygon fill="#000000" stroke="#000000" points="512.656,-859.166 520.903,-852.515 510.308,-852.571 512.656,-859.166"/>
</g>
<!-- proc~lflf_add -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node3" class="node"><title>proc~lflf_add</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node3"><a xlink:href=".././proc/lflf_add.html" xlink:title="lflf_add">
<polygon fill="#d94e8f" stroke="#d94e8f" points="463,-852.379 409,-852.379 409,-828.379 463,-828.379 463,-852.379"/>
<text text-anchor="middle" x="436" y="-837.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lflf_add</text>
</a>
</g>
</g>
<!-- proc~lflf_add&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge2" class="edge"><title>proc~lflf_add&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M463.188,-840.379C472.753,-840.379 484.005,-840.379 495.292,-840.379"/>
<polygon fill="#000000" stroke="#000000" points="495.62,-843.879 505.62,-840.379 495.62,-836.879 495.62,-843.879"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node4" class="node"><title>proc~get_fields</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node4"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="465,-425.379 407,-425.379 407,-401.379 465,-401.379 465,-425.379"/>
<text text-anchor="middle" x="436" y="-410.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge3" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M440.404,-425.698C456.789,-484.989 527.612,-741.27 548.915,-818.361"/>
<polygon fill="#000000" stroke="#000000" points="545.545,-819.304 551.582,-828.01 552.292,-817.439 545.545,-819.304"/>
</g>
<!-- interface~operator(&#45;) -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node5" class="node"><title>interface~operator(&#45;)</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node5"><a xlink:href=".././interface/operator%28-%29.html" xlink:title="operator(&#45;)">
<polygon fill="#a7506f" stroke="#a7506f" points="339,-894.379 275,-894.379 275,-870.379 339,-870.379 339,-894.379"/>
<text text-anchor="middle" x="307" y="-879.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">operator(&#45;)</text>
</a>
</g>
</g>
<!-- interface~operator(&#45;)&#45;&gt;proc~lflf_subtract -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge4" class="edge"><title>interface~operator(&#45;)&#45;&gt;proc~lflf_subtract</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M339.068,-882.379C355.001,-882.379 374.657,-882.379 392.02,-882.379"/>
<polygon fill="#000000" stroke="#000000" points="392.481,-885.879 402.481,-882.379 392.481,-878.879 392.481,-885.879"/>
</g>
<!-- interface~operator(+) -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node6" class="node"><title>interface~operator(+)</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node6"><a xlink:href=".././interface/operator%28%2B%29.html" xlink:title="operator(+)">
<polygon fill="#a7506f" stroke="#a7506f" points="340.5,-852.379 273.5,-852.379 273.5,-828.379 340.5,-828.379 340.5,-852.379"/>
<text text-anchor="middle" x="307" y="-837.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">operator(+)</text>
</a>
</g>
</g>
<!-- interface~operator(+)&#45;&gt;proc~lflf_add -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge5" class="edge"><title>interface~operator(+)&#45;&gt;proc~lflf_add</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M340.706,-840.379C358.482,-840.379 380.507,-840.379 398.799,-840.379"/>
<polygon fill="#000000" stroke="#000000" points="398.801,-843.879 408.801,-840.379 398.801,-836.879 398.801,-843.879"/>
</g>
<!-- proc~neutron_f -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node7" class="node"><title>proc~neutron_f</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node7"><a xlink:href=".././proc/neutron_f.html" xlink:title="neutron_f">
<polygon fill="#d9534f" stroke="#d9534f" points="336,-640.379 278,-640.379 278,-616.379 336,-616.379 336,-640.379"/>
<text text-anchor="middle" x="307" y="-625.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutron_f</text>
</a>
</g>
</g>
<!-- proc~neutron_f&#45;&gt;proc~get_fields -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge12" class="edge"><title>proc~neutron_f&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M336.178,-622.441C346.697,-618.99 358.014,-613.629 366,-605.379 412.738,-557.095 428.098,-474.928 432.918,-435.616"/>
<polygon fill="#000000" stroke="#000000" points="436.415,-435.839 434.037,-425.515 429.457,-435.069 436.415,-435.839"/>
</g>
<!-- proc~store_fw_photons -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node8" class="node"><title>proc~store_fw_photons</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node8"><a xlink:href=".././proc/store_fw_photons.html" xlink:title="store_fw_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="355.5,-768.379 258.5,-768.379 258.5,-744.379 355.5,-744.379 355.5,-768.379"/>
<text text-anchor="middle" x="307" y="-753.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_fw_photons</text>
</a>
</g>
</g>
<!-- proc~store_fw_photons&#45;&gt;proc~get_fields -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge13" class="edge"><title>proc~store_fw_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M355.077,-744.333C359.157,-741.881 362.903,-738.93 366,-735.379 405.61,-689.966 426.773,-501.002 433.011,-435.697"/>
<polygon fill="#000000" stroke="#000000" points="436.504,-435.938 433.945,-425.656 429.534,-435.289 436.504,-435.938"/>
</g>
<!-- proc~store_npa -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node9" class="node"><title>proc~store_npa</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node9"><a xlink:href=".././proc/store_npa.html" xlink:title="store_npa">
<polygon fill="#d9534f" stroke="#d9534f" points="337.5,-109.379 276.5,-109.379 276.5,-85.3789 337.5,-85.3789 337.5,-109.379"/>
<text text-anchor="middle" x="307" y="-94.9789" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_npa</text>
</a>
</g>
</g>
<!-- proc~store_npa&#45;&gt;proc~get_fields -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge22" class="edge"><title>proc~store_npa&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M335.899,-109.507C346.765,-115.526 358.407,-123.804 366,-134.379 424.304,-215.583 433.61,-340.566 434.901,-391.069"/>
<polygon fill="#000000" stroke="#000000" points="431.404,-391.259 435.074,-401.198 438.403,-391.14 431.404,-391.259"/>
</g>
<!-- proc~fida_mc -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node10" class="node"><title>proc~fida_mc</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node10"><a xlink:href=".././proc/fida_mc.html" xlink:title="fida_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-571.379 124,-571.379 124,-547.379 178,-547.379 178,-571.379"/>
<text text-anchor="middle" x="151" y="-556.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_mc</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~get_fields -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge24" class="edge"><title>proc~fida_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M178.185,-554.901C220.43,-546.769 305.043,-526.662 366,-487.379 387.926,-473.249 407.633,-450.612 420.316,-434.091"/>
<polygon fill="#000000" stroke="#000000" points="423.447,-435.747 426.61,-425.636 417.832,-431.568 423.447,-435.747"/>
</g>
<!-- proc~track -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node17" class="node"><title>proc~track</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node17"><a xlink:href=".././proc/track.html" xlink:title="track">
<polygon fill="#d9534f" stroke="#d9534f" points="334,-445.379 280,-445.379 280,-421.379 334,-421.379 334,-445.379"/>
<text text-anchor="middle" x="307" y="-430.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~track -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge47" class="edge"><title>proc~fida_mc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.136,-553.346C189.178,-550.032 201.812,-545.181 212,-538.379 246.132,-515.592 275.891,-477.589 292.355,-454.092"/>
<polygon fill="#000000" stroke="#000000" points="295.427,-455.8 298.187,-445.571 289.651,-451.846 295.427,-455.8"/>
</g>
<!-- proc~mc_fastion_pass_grid -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node11" class="node"><title>proc~mc_fastion_pass_grid</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node11"><a xlink:href=".././proc/mc_fastion_pass_grid.html" xlink:title="mc_fastion_pass_grid">
<polygon fill="#d9534f" stroke="#d9534f" points="365.5,-167.379 248.5,-167.379 248.5,-143.379 365.5,-143.379 365.5,-167.379"/>
<text text-anchor="middle" x="307" y="-152.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_fastion_pass_grid</text>
</a>
</g>
</g>
<!-- proc~mc_fastion_pass_grid&#45;&gt;proc~get_fields -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge6" class="edge"><title>proc~mc_fastion_pass_grid&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M354.535,-167.497C358.773,-169.936 362.703,-172.864 366,-176.379 423.687,-237.886 433.459,-344.864 434.892,-391.07"/>
<polygon fill="#000000" stroke="#000000" points="431.396,-391.274 435.099,-401.201 438.394,-391.131 431.396,-391.274"/>
</g>
<!-- proc~neutron_mc -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node12" class="node"><title>proc~neutron_mc</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node12"><a xlink:href=".././proc/neutron_mc.html" xlink:title="neutron_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="342,-596.379 272,-596.379 272,-572.379 342,-572.379 342,-596.379"/>
<text text-anchor="middle" x="307" y="-581.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutron_mc</text>
</a>
</g>
</g>
<!-- proc~neutron_mc&#45;&gt;proc~get_fields -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge16" class="edge"><title>proc~neutron_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M339.017,-572.267C348.526,-567.453 358.458,-561.174 366,-553.379 399.228,-519.038 419.419,-465.578 428.767,-435.633"/>
<polygon fill="#000000" stroke="#000000" points="432.213,-436.327 431.725,-425.744 425.506,-434.322 432.213,-436.327"/>
</g>
<!-- proc~store_photons -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node13" class="node"><title>proc~store_photons</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node13"><a xlink:href=".././proc/store_photons.html" xlink:title="store_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="347.5,-726.379 266.5,-726.379 266.5,-702.379 347.5,-702.379 347.5,-726.379"/>
<text text-anchor="middle" x="307" y="-711.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_photons</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_fields -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge18" class="edge"><title>proc~store_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M347.74,-705.213C354.585,-702.1 361.07,-697.939 366,-692.379 400.285,-653.708 424.264,-494.94 432.167,-435.755"/>
<polygon fill="#000000" stroke="#000000" points="435.667,-435.981 433.493,-425.612 428.726,-435.073 435.667,-435.981"/>
</g>
<!-- proc~npa_mc -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node14" class="node"><title>proc~npa_mc</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node14"><a xlink:href=".././proc/npa_mc.html" xlink:title="npa_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-67.3789 124,-67.3789 124,-43.3789 178,-43.3789 178,-67.3789"/>
<text text-anchor="middle" x="151" y="-52.9789" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_mc</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~get_fields -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge20" class="edge"><title>proc~npa_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M178.239,-49.0933C222.888,-40.0972 313.858,-29.4023 366,-76.3789 413.178,-118.883 429.589,-323.326 433.793,-391.328"/>
<polygon fill="#000000" stroke="#000000" points="430.303,-391.589 434.385,-401.366 437.29,-391.177 430.303,-391.589"/>
</g>
<!-- proc~npa_mc&#45;&gt;proc~store_npa -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge26" class="edge"><title>proc~npa_mc&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M178.124,-62.5036C202.352,-69.1112 238.743,-79.036 266.516,-86.6106"/>
<polygon fill="#000000" stroke="#000000" points="265.751,-90.0298 276.32,-89.2844 267.593,-83.2764 265.751,-90.0298"/>
</g>
<!-- proc~make_diagnostic_grids -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node15" class="node"><title>proc~make_diagnostic_grids</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node15"><a xlink:href=".././proc/make_diagnostic_grids.html" xlink:title="make_diagnostic_grids">
<polygon fill="#d9534f" stroke="#d9534f" points="212,-319.379 90,-319.379 90,-295.379 212,-295.379 212,-319.379"/>
<text text-anchor="middle" x="151" y="-304.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">make_diagnostic_grids</text>
</a>
</g>
</g>
<!-- proc~make_diagnostic_grids&#45;&gt;proc~get_fields -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge23" class="edge"><title>proc~make_diagnostic_grids&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M212.435,-318.482C256.351,-327.863 316.511,-343.473 366,-366.379 382.351,-373.947 399.093,-385.248 411.99,-394.872"/>
<polygon fill="#000000" stroke="#000000" points="410.185,-397.898 420.252,-401.2 414.441,-392.341 410.185,-397.898"/>
</g>
<!-- proc~make_diagnostic_grids&#45;&gt;proc~track -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge46" class="edge"><title>proc~make_diagnostic_grids&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M194.917,-319.387C200.891,-321.908 206.768,-324.886 212,-328.379 246.132,-351.165 275.891,-389.169 292.355,-412.666"/>
<polygon fill="#000000" stroke="#000000" points="289.651,-414.912 298.187,-421.187 295.427,-410.958 289.651,-414.912"/>
</g>
<!-- proc~track_cylindrical -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node23" class="node"><title>proc~track_cylindrical</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node23"><a xlink:href=".././proc/track_cylindrical.html" xlink:title="track_cylindrical">
<polygon fill="#d9534f" stroke="#d9534f" points="351,-289.379 263,-289.379 263,-265.379 351,-265.379 351,-289.379"/>
<text text-anchor="middle" x="307" y="-274.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track_cylindrical</text>
</a>
</g>
</g>
<!-- proc~make_diagnostic_grids&#45;&gt;proc~track_cylindrical -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge55" class="edge"><title>proc~make_diagnostic_grids&#45;&gt;proc~track_cylindrical</title>
<path fill="none" stroke="#000000" d="M212.423,-295.608C225.721,-293.018 239.712,-290.292 252.705,-287.761"/>
<polygon fill="#000000" stroke="#000000" points="253.732,-291.127 262.878,-285.779 252.394,-284.256 253.732,-291.127"/>
</g>
<!-- proc~fida_weights_los -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node16" class="node"><title>proc~fida_weights_los</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node16"><a xlink:href=".././proc/fida_weights_los.html" xlink:title="fida_weights_los">
<polygon fill="#d9534f" stroke="#d9534f" points="196.5,-529.379 105.5,-529.379 105.5,-505.379 196.5,-505.379 196.5,-529.379"/>
<text text-anchor="middle" x="151" y="-514.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_weights_los</text>
</a>
</g>
</g>
<!-- proc~fida_weights_los&#45;&gt;proc~get_fields -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge8" class="edge"><title>proc~fida_weights_los&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M196.577,-507.701C240.673,-497.335 309.554,-478.994 366,-454.379 380.8,-447.925 396.339,-438.913 408.915,-430.982"/>
<polygon fill="#000000" stroke="#000000" points="410.988,-433.81 417.496,-425.449 407.195,-427.926 410.988,-433.81"/>
</g>
<!-- proc~fida_weights_los&#45;&gt;proc~track -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge41" class="edge"><title>proc~fida_weights_los&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M191.007,-505.348C198.124,-502.699 205.386,-499.685 212,-496.379 237.219,-483.772 263.705,-465.5 282.111,-451.878"/>
<polygon fill="#000000" stroke="#000000" points="284.563,-454.413 290.456,-445.609 280.359,-448.816 284.563,-454.413"/>
</g>
<!-- proc~track&#45;&gt;proc~get_fields -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge9" class="edge"><title>proc~track&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M334.007,-429.283C352.134,-426.429 376.613,-422.574 396.931,-419.374"/>
<polygon fill="#000000" stroke="#000000" points="397.488,-422.829 406.822,-417.816 396.399,-415.915 397.488,-422.829"/>
</g>
<!-- proc~mc_fastion -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node18" class="node"><title>proc~mc_fastion</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node18"><a xlink:href=".././proc/mc_fastion.html" xlink:title="mc_fastion">
<polygon fill="#d9534f" stroke="#d9534f" points="339,-209.379 275,-209.379 275,-185.379 339,-185.379 339,-209.379"/>
<text text-anchor="middle" x="307" y="-194.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_fastion</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;proc~get_fields -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge14" class="edge"><title>proc~mc_fastion&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M339.197,-206.059C348.829,-210.023 358.788,-215.62 366,-223.379 411.013,-271.808 427.143,-351.862 432.523,-390.762"/>
<polygon fill="#000000" stroke="#000000" points="429.092,-391.527 433.82,-401.009 436.037,-390.649 429.092,-391.527"/>
</g>
<!-- proc~pfida_mc -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node19" class="node"><title>proc~pfida_mc</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node19"><a xlink:href=".././proc/pfida_mc.html" xlink:title="pfida_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="179,-235.379 123,-235.379 123,-211.379 179,-211.379 179,-235.379"/>
<text text-anchor="middle" x="151" y="-220.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pfida_mc</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~get_fields -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge15" class="edge"><title>proc~pfida_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M179.167,-219.846C223.175,-215.66 310.692,-213.908 366,-256.379 409.468,-289.758 426.1,-356.31 432.015,-391.07"/>
<polygon fill="#000000" stroke="#000000" points="428.587,-391.81 433.579,-401.156 435.505,-390.738 428.587,-391.81"/>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~track_cylindrical -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge56" class="edge"><title>proc~pfida_mc&#45;&gt;proc~track_cylindrical</title>
<path fill="none" stroke="#000000" d="M179.182,-232.886C189.465,-236.485 201.273,-240.619 212,-244.379 228.355,-250.112 246.309,-256.413 262.103,-261.959"/>
<polygon fill="#000000" stroke="#000000" points="261.03,-265.291 271.625,-265.302 263.35,-258.687 261.03,-265.291"/>
</g>
<!-- proc~fida_weights_mc -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node20" class="node"><title>proc~fida_weights_mc</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node20"><a xlink:href=".././proc/fida_weights_mc.html" xlink:title="fida_weights_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="197,-403.379 105,-403.379 105,-379.379 197,-379.379 197,-403.379"/>
<text text-anchor="middle" x="151" y="-388.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_weights_mc</text>
</a>
</g>
</g>
<!-- proc~fida_weights_mc&#45;&gt;proc~get_fields -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge19" class="edge"><title>proc~fida_weights_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M197.155,-394.889C252.341,-399.179 344.76,-406.364 396.652,-410.398"/>
<polygon fill="#000000" stroke="#000000" points="396.533,-413.899 406.774,-411.185 397.076,-406.92 396.533,-413.899"/>
</g>
<!-- proc~fida_weights_mc&#45;&gt;proc~track -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge45" class="edge"><title>proc~fida_weights_mc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M196.13,-403.414C219.561,-409.805 247.991,-417.558 270.061,-423.577"/>
<polygon fill="#000000" stroke="#000000" points="269.144,-426.955 279.712,-426.21 270.986,-420.202 269.144,-426.955"/>
</g>
<!-- proc~cfpd_f -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node21" class="node"><title>proc~cfpd_f</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node21"><a xlink:href=".././proc/cfpd_f.html" xlink:title="cfpd_f">
<polygon fill="#d9534f" stroke="#d9534f" points="334,-810.379 280,-810.379 280,-786.379 334,-786.379 334,-810.379"/>
<text text-anchor="middle" x="307" y="-795.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cfpd_f</text>
</a>
</g>
</g>
<!-- proc~cfpd_f&#45;&gt;proc~get_fields -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge21" class="edge"><title>proc~cfpd_f&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M334.136,-794.818C345.5,-791.946 358.016,-786.756 366,-777.379 410.53,-725.084 428.784,-506.697 433.612,-435.748"/>
<polygon fill="#000000" stroke="#000000" points="437.11,-435.883 434.273,-425.675 430.126,-435.424 437.11,-435.883"/>
</g>
<!-- proc~pnpa_mc -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node22" class="node"><title>proc~pnpa_mc</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node22"><a xlink:href=".././proc/pnpa_mc.html" xlink:title="pnpa_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="179.5,-25.3789 122.5,-25.3789 122.5,-1.37888 179.5,-1.37888 179.5,-25.3789"/>
<text text-anchor="middle" x="151" y="-10.9789" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pnpa_mc</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~get_fields -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge11" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M179.844,-7.14334C225.219,1.22583 315.144,10.0456 366,-37.3789 418.063,-85.9286 431.323,-317.143 434.253,-390.791"/>
<polygon fill="#000000" stroke="#000000" points="430.771,-391.342 434.639,-401.206 437.766,-391.083 430.771,-391.342"/>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~store_npa -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge29" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M179.782,-21.4693C190.134,-24.9039 201.832,-29.2961 212,-34.3789 237.219,-46.9858 263.705,-65.2574 282.111,-78.8802"/>
<polygon fill="#000000" stroke="#000000" points="280.359,-81.9416 290.456,-85.1491 284.563,-76.3447 280.359,-81.9416"/>
</g>
<!-- proc~track_cylindrical&#45;&gt;proc~get_fields -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge7" class="edge"><title>proc~track_cylindrical&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M343.71,-289.415C351.585,-293.109 359.506,-297.729 366,-303.379 394.424,-328.108 415.143,-367.43 426.103,-391.752"/>
<polygon fill="#000000" stroke="#000000" points="423.001,-393.395 430.197,-401.171 429.421,-390.605 423.001,-393.395"/>
</g>
<!-- proc~ndmc -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node24" class="node"><title>proc~ndmc</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node24"><a xlink:href=".././proc/ndmc.html" xlink:title="ndmc">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-361.379 124,-361.379 124,-337.379 178,-337.379 178,-361.379"/>
<text text-anchor="middle" x="151" y="-346.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ndmc</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~get_fields -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge10" class="edge"><title>proc~ndmc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M178.106,-354.609C218.499,-362.788 298.529,-379.335 366,-395.379 376.117,-397.785 387.024,-400.55 397.113,-403.179"/>
<polygon fill="#000000" stroke="#000000" points="396.308,-406.586 406.869,-405.745 398.089,-399.817 396.308,-406.586"/>
</g>
<!-- proc~ndmc&#45;&gt;proc~track -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge42" class="edge"><title>proc~ndmc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.284,-356.976C188.994,-360.479 201.339,-365.049 212,-370.379 237.219,-382.986 263.705,-401.257 282.111,-414.88"/>
<polygon fill="#000000" stroke="#000000" points="280.359,-417.942 290.456,-421.149 284.563,-412.345 280.359,-417.942"/>
</g>
<!-- proc~npa_weights -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node25" class="node"><title>proc~npa_weights</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node25"><a xlink:href=".././proc/npa_weights.html" xlink:title="npa_weights">
<polygon fill="#d9534f" stroke="#d9534f" points="343.5,-683.379 270.5,-683.379 270.5,-659.379 343.5,-659.379 343.5,-683.379"/>
<text text-anchor="middle" x="307" y="-668.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_weights</text>
</a>
</g>
</g>
<!-- proc~npa_weights&#45;&gt;proc~get_fields -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge17" class="edge"><title>proc~npa_weights&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M343.65,-663.69C351.899,-660.45 360.004,-655.862 366,-649.379 423.032,-587.709 433.155,-481.409 434.787,-435.526"/>
<polygon fill="#000000" stroke="#000000" points="438.287,-435.552 435.039,-425.467 431.29,-435.376 438.287,-435.552"/>
</g>
<!-- proc~dcx -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node26" class="node"><title>proc~dcx</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node26"><a xlink:href=".././proc/dcx.html" xlink:title="dcx">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-487.379 124,-487.379 124,-463.379 178,-463.379 178,-487.379"/>
<text text-anchor="middle" x="151" y="-472.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dcx</text>
</a>
</g>
</g>
<!-- proc~dcx&#45;&gt;proc~track -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge40" class="edge"><title>proc~dcx&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.124,-468.254C203.345,-461.376 241.748,-450.902 269.888,-443.228"/>
<polygon fill="#000000" stroke="#000000" points="271.021,-446.546 279.748,-440.539 269.179,-439.793 271.021,-446.546"/>
</g>
<!-- proc~pnpa_f -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node27" class="node"><title>proc~pnpa_f</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node27"><a xlink:href=".././proc/pnpa_f.html" xlink:title="pnpa_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-109.379 124,-109.379 124,-85.3789 178,-85.3789 178,-109.379"/>
<text text-anchor="middle" x="151" y="-94.9789" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pnpa_f</text>
</a>
</g>
</g>
<!-- proc~pnpa_f&#45;&gt;proc~store_npa -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge28" class="edge"><title>proc~pnpa_f&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M178.124,-97.3789C202.246,-97.3789 238.424,-97.3789 266.15,-97.3789"/>
<polygon fill="#000000" stroke="#000000" points="266.32,-100.879 276.32,-97.3789 266.32,-93.879 266.32,-100.879"/>
</g>
<!-- proc~pnpa_f&#45;&gt;proc~mc_fastion_pass_grid -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge31" class="edge"><title>proc~pnpa_f&#45;&gt;proc~mc_fastion_pass_grid</title>
<path fill="none" stroke="#000000" d="M178.067,-106.259C188.633,-109.921 200.931,-114.265 212,-118.379 230.003,-125.07 249.804,-132.807 266.571,-139.47"/>
<polygon fill="#000000" stroke="#000000" points="265.471,-142.8 276.056,-143.254 268.064,-136.298 265.471,-142.8"/>
</g>
<!-- proc~nbi_spec -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node28" class="node"><title>proc~nbi_spec</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node28"><a xlink:href=".././proc/nbi_spec.html" xlink:title="nbi_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="178.5,-727.379 123.5,-727.379 123.5,-703.379 178.5,-703.379 178.5,-727.379"/>
<text text-anchor="middle" x="151" y="-712.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nbi_spec</text>
</a>
</g>
</g>
<!-- proc~nbi_spec&#45;&gt;proc~store_photons -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge35" class="edge"><title>proc~nbi_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M178.825,-715.205C200.108,-715.066 230.449,-714.869 256.158,-714.703"/>
<polygon fill="#000000" stroke="#000000" points="256.508,-718.2 266.485,-714.635 256.462,-711.201 256.508,-718.2"/>
</g>
<!-- proc~pfida_f -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node29" class="node"><title>proc~pfida_f</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node29"><a xlink:href=".././proc/pfida_f.html" xlink:title="pfida_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-193.379 124,-193.379 124,-169.379 178,-169.379 178,-193.379"/>
<text text-anchor="middle" x="151" y="-178.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pfida_f</text>
</a>
</g>
</g>
<!-- proc~pfida_f&#45;&gt;proc~mc_fastion_pass_grid -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge32" class="edge"><title>proc~pfida_f&#45;&gt;proc~mc_fastion_pass_grid</title>
<path fill="none" stroke="#000000" d="M178.124,-176.968C194.718,-174.167 217.019,-170.402 238.348,-166.801"/>
<polygon fill="#000000" stroke="#000000" points="239.105,-170.223 248.382,-165.107 237.939,-163.32 239.105,-170.223"/>
</g>
<!-- proc~pfida_f&#45;&gt;proc~track_cylindrical -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge54" class="edge"><title>proc~pfida_f&#45;&gt;proc~track_cylindrical</title>
<path fill="none" stroke="#000000" d="M178.217,-188.442C189.032,-191.887 201.472,-196.558 212,-202.379 239.886,-217.797 267.933,-241.489 286.037,-258.109"/>
<polygon fill="#000000" stroke="#000000" points="283.922,-260.923 293.619,-265.193 288.701,-255.808 283.922,-260.923"/>
</g>
<!-- proc~npa_f -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node30" class="node"><title>proc~npa_f</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node30"><a xlink:href=".././proc/npa_f.html" xlink:title="npa_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-151.379 124,-151.379 124,-127.379 178,-127.379 178,-151.379"/>
<text text-anchor="middle" x="151" y="-136.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_f</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~store_npa -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge27" class="edge"><title>proc~npa_f&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M178.124,-132.254C202.352,-125.647 238.743,-115.722 266.516,-108.147"/>
<polygon fill="#000000" stroke="#000000" points="267.593,-111.481 276.32,-105.473 265.751,-104.728 267.593,-111.481"/>
</g>
<!-- proc~npa_f&#45;&gt;proc~mc_fastion -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge48" class="edge"><title>proc~npa_f&#45;&gt;proc~mc_fastion</title>
<path fill="none" stroke="#000000" d="M178.16,-148.017C188.74,-151.644 201.022,-156.027 212,-160.379 228.277,-166.832 231.758,-169.839 248,-176.379 253.537,-178.608 259.412,-180.862 265.215,-183.025"/>
<polygon fill="#000000" stroke="#000000" points="264.249,-186.398 274.842,-186.556 266.66,-179.826 264.249,-186.398"/>
</g>
<!-- proc~fida_f -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node31" class="node"><title>proc~fida_f</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node31"><a xlink:href=".././proc/fida_f.html" xlink:title="fida_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-277.379 124,-277.379 124,-253.379 178,-253.379 178,-277.379"/>
<text text-anchor="middle" x="151" y="-262.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_f</text>
</a>
</g>
</g>
<!-- proc~fida_f&#45;&gt;proc~track -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge43" class="edge"><title>proc~fida_f&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.094,-270.474C189.383,-273.643 202.219,-278.642 212,-286.379 255.089,-320.466 284.306,-380.039 297.678,-411.875"/>
<polygon fill="#000000" stroke="#000000" points="294.449,-413.227 301.46,-421.17 300.933,-410.588 294.449,-413.227"/>
</g>
<!-- proc~fida_f&#45;&gt;proc~mc_fastion -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge49" class="edge"><title>proc~fida_f&#45;&gt;proc~mc_fastion</title>
<path fill="none" stroke="#000000" d="M178.264,-256.993C188.858,-253.403 201.124,-248.979 212,-244.379 233.465,-235.3 256.912,-223.58 275.019,-214.114"/>
<polygon fill="#000000" stroke="#000000" points="276.751,-217.158 283.963,-209.396 273.485,-210.967 276.751,-217.158"/>
</g>
<!-- proc~store_nbi_photons -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node32" class="node"><title>proc~store_nbi_photons</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node32"><a xlink:href=".././proc/store_nbi_photons.html" xlink:title="store_nbi_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="201.5,-811.379 100.5,-811.379 100.5,-787.379 201.5,-787.379 201.5,-811.379"/>
<text text-anchor="middle" x="151" y="-796.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_nbi_photons</text>
</a>
</g>
</g>
<!-- proc~store_nbi_photons&#45;&gt;proc~store_photons -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge36" class="edge"><title>proc~store_nbi_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M195.65,-787.257C201.392,-784.771 207.008,-781.832 212,-778.379 232.497,-764.198 227.579,-749.669 248,-735.379 250.85,-733.384 253.911,-731.558 257.083,-729.889"/>
<polygon fill="#000000" stroke="#000000" points="258.669,-733.011 266.234,-725.594 255.695,-726.674 258.669,-733.011"/>
</g>
<!-- proc~halo -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node33" class="node"><title>proc~halo</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node33"><a xlink:href=".././proc/halo.html" xlink:title="halo">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-445.379 124,-445.379 124,-421.379 178,-421.379 178,-445.379"/>
<text text-anchor="middle" x="151" y="-430.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">halo</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~track -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge44" class="edge"><title>proc~halo&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.124,-433.379C203.235,-433.379 241.411,-433.379 269.517,-433.379"/>
<polygon fill="#000000" stroke="#000000" points="269.748,-436.879 279.748,-433.379 269.748,-429.879 269.748,-436.879"/>
</g>
<!-- proc~store_fida_photons -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node34" class="node"><title>proc~store_fida_photons</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node34"><a xlink:href=".././proc/store_fida_photons.html" xlink:title="store_fida_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="203,-769.379 99,-769.379 99,-745.379 203,-745.379 203,-769.379"/>
<text text-anchor="middle" x="151" y="-754.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_fida_photons</text>
</a>
</g>
</g>
<!-- proc~store_fida_photons&#45;&gt;proc~store_photons -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge34" class="edge"><title>proc~store_fida_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M195.307,-745.287C214.41,-739.953 236.959,-733.657 256.703,-728.144"/>
<polygon fill="#000000" stroke="#000000" points="257.75,-731.485 266.44,-725.425 255.868,-724.743 257.75,-731.485"/>
</g>
<!-- program~fidasim -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_node35" class="node"><title>program~fidasim</title>
<g id="a_proc~~calc_perp_vectors~~CalledByGraph_node35"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-403.379 0,-403.379 0,-379.379 54,-379.379 54,-403.379"/>
<text text-anchor="middle" x="27" y="-388.979" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~neutron_f -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge25" class="edge"><title>program~fidasim&#45;&gt;proc~neutron_f</title>
<path fill="none" stroke="#000000" d="M29.6959,-403.577C35.7405,-445.182 57.6134,-580.425 90,-607.379 139.913,-648.919 220.525,-644.043 267.875,-636.423"/>
<polygon fill="#000000" stroke="#000000" points="268.477,-639.87 277.735,-634.718 267.285,-632.973 268.477,-639.87"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_mc -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge30" class="edge"><title>program~fidasim&#45;&gt;proc~fida_mc</title>
<path fill="none" stroke="#000000" d="M29.7369,-403.541C34.3436,-431.379 49.4234,-500.261 90,-538.379 96.7209,-544.693 105.446,-549.122 114.152,-552.224"/>
<polygon fill="#000000" stroke="#000000" points="113.277,-555.617 123.864,-555.193 115.324,-548.923 113.277,-555.617"/>
</g>
<!-- program~fidasim&#45;&gt;proc~neutron_mc -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge33" class="edge"><title>program~fidasim&#45;&gt;proc~neutron_mc</title>
<path fill="none" stroke="#000000" d="M27.6316,-403.815C27.3587,-438.662 31.9449,-537.499 90,-580.379 139.609,-617.02 214.605,-608.241 261.907,-597.273"/>
<polygon fill="#000000" stroke="#000000" points="262.969,-600.616 271.851,-594.84 261.306,-593.817 262.969,-600.616"/>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_mc -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge37" class="edge"><title>program~fidasim&#45;&gt;proc~npa_mc</title>
<path fill="none" stroke="#000000" d="M28.7958,-379.366C32.459,-327.509 49.2918,-123.337 90,-76.3789 96.2645,-69.1526 105.163,-64.4123 114.194,-61.303"/>
<polygon fill="#000000" stroke="#000000" points="115.27,-64.6357 123.928,-58.5287 113.352,-57.9038 115.27,-64.6357"/>
</g>
<!-- program~fidasim&#45;&gt;proc~make_diagnostic_grids -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge38" class="edge"><title>program~fidasim&#45;&gt;proc~make_diagnostic_grids</title>
<path fill="none" stroke="#000000" d="M37.2232,-379.057C48.3295,-365.001 68.2264,-342.183 90,-328.379 92.6186,-326.719 95.385,-325.17 98.2353,-323.728"/>
<polygon fill="#000000" stroke="#000000" points="99.8994,-326.816 107.546,-319.483 96.995,-320.447 99.8994,-326.816"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_weights_los -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge39" class="edge"><title>program~fidasim&#45;&gt;proc~fida_weights_los</title>
<path fill="none" stroke="#000000" d="M32.0372,-403.63C39.8133,-425.386 58.9027,-470.867 90,-496.379 92.0158,-498.033 94.1705,-499.56 96.4214,-500.97"/>
<polygon fill="#000000" stroke="#000000" points="95.0242,-504.193 105.489,-505.848 98.3406,-498.028 95.0242,-504.193"/>
</g>
<!-- program~fidasim&#45;&gt;proc~pfida_mc -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge50" class="edge"><title>program~fidasim&#45;&gt;proc~pfida_mc</title>
<path fill="none" stroke="#000000" d="M29.7369,-379.217C34.3436,-351.379 49.4234,-282.497 90,-244.379 96.4752,-238.296 104.811,-233.962 113.197,-230.879"/>
<polygon fill="#000000" stroke="#000000" points="114.47,-234.148 122.956,-227.804 112.366,-227.471 114.47,-234.148"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_weights_mc -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge51" class="edge"><title>program~fidasim&#45;&gt;proc~fida_weights_mc</title>
<path fill="none" stroke="#000000" d="M54.1721,-391.379C66.0035,-391.379 80.4637,-391.379 94.5287,-391.379"/>
<polygon fill="#000000" stroke="#000000" points="94.6571,-394.879 104.657,-391.379 94.657,-387.879 94.6571,-394.879"/>
</g>
<!-- program~fidasim&#45;&gt;proc~cfpd_f -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge52" class="edge"><title>program~fidasim&#45;&gt;proc~cfpd_f</title>
<path fill="none" stroke="#000000" d="M27.7353,-403.637C26.6338,-467.806 25.145,-764.223 90,-820.379 116.102,-842.979 215.456,-821.968 269.858,-808.189"/>
<polygon fill="#000000" stroke="#000000" points="270.976,-811.515 279.785,-805.629 269.228,-804.737 270.976,-811.515"/>
</g>
<!-- program~fidasim&#45;&gt;proc~pnpa_mc -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge53" class="edge"><title>program~fidasim&#45;&gt;proc~pnpa_mc</title>
<path fill="none" stroke="#000000" d="M28.4944,-379.317C31.025,-323.228 44.2443,-88.3682 90,-34.3789 95.8582,-27.4665 104.13,-22.8278 112.665,-19.7156"/>
<polygon fill="#000000" stroke="#000000" points="113.735,-23.0487 122.298,-16.8104 111.714,-16.3469 113.735,-23.0487"/>
</g>
<!-- program~fidasim&#45;&gt;proc~ndmc -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge57" class="edge"><title>program~fidasim&#45;&gt;proc~ndmc</title>
<path fill="none" stroke="#000000" d="M54.1721,-382.369C71.7009,-376.334 95.0001,-368.313 114.235,-361.691"/>
<polygon fill="#000000" stroke="#000000" points="115.555,-364.939 123.871,-358.374 113.277,-358.32 115.555,-364.939"/>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_weights -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge58" class="edge"><title>program~fidasim&#45;&gt;proc~npa_weights</title>
<path fill="none" stroke="#000000" d="M29.3015,-403.634C34.3668,-448.919 54.2732,-605.873 90,-638.379 136.008,-680.24 211.692,-682.015 260.163,-677.881"/>
<polygon fill="#000000" stroke="#000000" points="260.756,-681.34 270.37,-676.889 260.079,-674.373 260.756,-681.34"/>
</g>
<!-- program~fidasim&#45;&gt;proc~dcx -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge59" class="edge"><title>program~fidasim&#45;&gt;proc~dcx</title>
<path fill="none" stroke="#000000" d="M37.2232,-403.7C48.3295,-417.757 68.2264,-440.575 90,-454.379 97.3693,-459.051 105.91,-462.84 114.195,-465.846"/>
<polygon fill="#000000" stroke="#000000" points="113.124,-469.179 123.718,-469.021 115.339,-462.538 113.124,-469.179"/>
</g>
<!-- program~fidasim&#45;&gt;proc~pnpa_f -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge60" class="edge"><title>program~fidasim&#45;&gt;proc~pnpa_f</title>
<path fill="none" stroke="#000000" d="M29.2213,-379.067C34.1984,-331.214 54.3982,-158.264 90,-118.379 96.3146,-111.305 105.149,-106.613 114.101,-103.503"/>
<polygon fill="#000000" stroke="#000000" points="115.116,-106.853 123.747,-100.709 113.168,-100.129 115.116,-106.853"/>
</g>
<!-- program~fidasim&#45;&gt;proc~nbi_spec -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge61" class="edge"><title>program~fidasim&#45;&gt;proc~nbi_spec</title>
<path fill="none" stroke="#000000" d="M29.0608,-403.684C33.6232,-454.056 53.0407,-644.001 90,-689.379 96.1074,-696.877 104.794,-702.265 113.667,-706.115"/>
<polygon fill="#000000" stroke="#000000" points="112.663,-709.477 123.255,-709.717 115.125,-702.924 112.663,-709.477"/>
</g>
<!-- program~fidasim&#45;&gt;proc~pfida_f -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge62" class="edge"><title>program~fidasim&#45;&gt;proc~pfida_f</title>
<path fill="none" stroke="#000000" d="M28.4179,-379.346C30.2124,-346.381 39.7122,-253.667 90,-202.379 96.5121,-195.737 105.24,-191.193 114.018,-188.084"/>
<polygon fill="#000000" stroke="#000000" points="115.257,-191.367 123.835,-185.15 113.252,-184.66 115.257,-191.367"/>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_f -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge63" class="edge"><title>program~fidasim&#45;&gt;proc~npa_f</title>
<path fill="none" stroke="#000000" d="M27.5625,-379.238C26.8801,-341.523 29.9721,-225.051 90,-160.379 96.451,-153.429 105.331,-148.778 114.282,-145.667"/>
<polygon fill="#000000" stroke="#000000" points="115.291,-149.018 123.912,-142.859 113.332,-142.298 115.291,-149.018"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_f -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge64" class="edge"><title>program~fidasim&#45;&gt;proc~fida_f</title>
<path fill="none" stroke="#000000" d="M32.0372,-379.127C39.8133,-357.372 58.9027,-311.89 90,-286.379 96.9299,-280.694 105.502,-276.502 113.977,-273.429"/>
<polygon fill="#000000" stroke="#000000" points="115.307,-276.678 123.776,-270.312 113.186,-270.008 115.307,-276.678"/>
</g>
<!-- program~fidasim&#45;&gt;proc~halo -->
<g id="proc~~calc_perp_vectors~~CalledByGraph_edge65" class="edge"><title>program~fidasim&#45;&gt;proc~halo</title>
<path fill="none" stroke="#000000" d="M54.1721,-400.389C71.7009,-406.423 95.0001,-414.444 114.235,-421.066"/>
<polygon fill="#000000" stroke="#000000" points="113.277,-424.438 123.871,-424.384 115.555,-417.819 113.277,-424.438"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/calc_perp_vectors.html#src">calc_perp_vectors</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">pure subroutine </span><span class="n">calc_perp_vectors</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
  <span class="c">!+ Calculates normalized vectors that are perpendicular to b</span>
  <span class="c">!+ such that `a` x `c` = `b_norm`</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">b</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">c</span>

  <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">bnorm</span>

  <span class="n">bnorm</span><span class="o">=</span><span class="n">b</span><span class="o">/</span><span class="nb">norm2</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

  <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">bnorm</span><span class="p">(</span><span class="mi">3</span><span class="p">)).</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">      </span><span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="mf">1.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">]</span>
      <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">1.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">]</span>
  <span class="k">else</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">bnorm</span><span class="p">(</span><span class="mi">3</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          </span><span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">1.d0</span><span class="p">]</span>
          <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="n">bnorm</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="o">-</span><span class="n">bnorm</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mf">0.d0</span><span class="p">]</span><span class="o">/</span><span class="nb">sqrt</span><span class="p">(</span><span class="n">bnorm</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">bnorm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
      <span class="k">else</span>
<span class="k">          </span><span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="n">bnorm</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="o">-</span><span class="n">bnorm</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mf">0.d0</span><span class="p">]</span><span class="o">/</span><span class="nb">sqrt</span><span class="p">(</span><span class="n">bnorm</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">bnorm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
          <span class="n">c</span><span class="o">=-</span><span class="p">[</span> <span class="n">a</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">,</span> <span class="o">-</span><span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">bnorm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">a</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">bnorm</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">bnorm</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">]</span>
          <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="o">/</span><span class="nb">norm2</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
          <span class="k">if</span><span class="p">(</span><span class="n">bnorm</span><span class="p">(</span><span class="mi">3</span><span class="p">).</span><span class="n">lt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">              </span><span class="n">c</span><span class="o">=-</span><span class="n">c</span>
          <span class="k">endif</span>
<span class="k">      endif</span>
<span class="k">  endif</span>

<span class="k">end subroutine </span><span class="n">calc_perp_vectors</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> FIDASIM was developed by Luke Stagner</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>