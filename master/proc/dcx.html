<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>dcx &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>dcx
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.7% of total for procedures.">93 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
    
     <li><a href='../module/libfida.html'>libfida</a></li>
    
  
     <li class="active">dcx</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/dcx.html#src">dcx</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine dcx()
    
    
   
</h2>
    
  


    
    <p>Calculates Direct Charge Exchange (DCX) neutral density and spectra</p>
    

    <h3>Arguments</h3>
    
    <em>None</em>
    <br>
    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~dcx~~CallsGraph Pages: 1 -->
<svg id="procdcxCallsGraph" width="641pt" height="660pt"
 viewBox="0.00 0.00 641.00 659.79" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~dcx~~CallsGraph" class="graph" transform="scale(0.720225 0.720225) rotate(0) translate(4 912.093)">
<title>proc~~dcx~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-912.093 886,-912.093 886,4 -4,4"/>
<!-- proc~dcx -->
<g id="proc~~dcx~~CallsGraph_node1" class="node"><title>proc~dcx</title>
<polygon fill="none" stroke="black" points="54,-294.093 0,-294.093 0,-270.093 54,-270.093 54,-294.093"/>
<text text-anchor="middle" x="27" y="-279.693" font-family="Helvetica,sans-Serif" font-size="10.50">dcx</text>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~dcx~~CallsGraph_node2" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~dcx~~CallsGraph_node2"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="532.5,-656.093 459.5,-656.093 459.5,-632.093 532.5,-632.093 532.5,-656.093"/>
<text text-anchor="middle" x="496" y="-641.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~dcx&#45;&gt;interface~parallel_sum -->
<g id="proc~~dcx~~CallsGraph_edge1" class="edge"><title>proc~dcx&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M29.5169,-294.332C33.8311,-324.627 48.6503,-404.261 90,-454.093 185.099,-568.7 364.959,-618.218 449.247,-635.854"/>
<polygon fill="#000000" stroke="#000000" points="448.784,-639.331 459.281,-637.897 450.181,-632.472 448.784,-639.331"/>
</g>
<!-- proc~track -->
<g id="proc~~dcx~~CallsGraph_node3" class="node"><title>proc~track</title>
<g id="a_proc~~dcx~~CallsGraph_node3"><a xlink:href=".././proc/track.html" xlink:title="track">
<polygon fill="#d9534f" stroke="#d9534f" points="190,-161.093 136,-161.093 136,-137.093 190,-137.093 190,-161.093"/>
<text text-anchor="middle" x="163" y="-146.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track</text>
</a>
</g>
</g>
<!-- proc~dcx&#45;&gt;proc~track -->
<g id="proc~~dcx~~CallsGraph_edge2" class="edge"><title>proc~dcx&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M32.4434,-270.07C40.734,-249.139 60.4409,-205.789 90,-180.093 100.374,-171.075 113.769,-164.347 126.187,-159.507"/>
<polygon fill="#000000" stroke="#000000" points="127.639,-162.704 135.86,-156.021 125.266,-156.118 127.639,-162.704"/>
</g>
<!-- proc~parallel_merge_populations -->
<g id="proc~~dcx~~CallsGraph_node4" class="node"><title>proc~parallel_merge_populations</title>
<g id="a_proc~~dcx~~CallsGraph_node4"><a xlink:href=".././proc/parallel_merge_populations.html" xlink:title="parallel_merge_populations">
<polygon fill="#d9534f" stroke="#d9534f" points="235.5,-445.093 90.5,-445.093 90.5,-421.093 235.5,-421.093 235.5,-445.093"/>
<text text-anchor="middle" x="163" y="-430.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_merge_populations</text>
</a>
</g>
</g>
<!-- proc~dcx&#45;&gt;proc~parallel_merge_populations -->
<g id="proc~~dcx~~CallsGraph_edge4" class="edge"><title>proc~dcx&#45;&gt;proc~parallel_merge_populations</title>
<path fill="none" stroke="#000000" d="M31.9453,-294.099C39.8124,-316.464 59.3749,-364.96 90,-395.093 98.8156,-403.767 110.016,-410.951 120.942,-416.65"/>
<polygon fill="#000000" stroke="#000000" points="119.476,-419.829 129.996,-421.088 122.557,-413.544 119.476,-419.829"/>
</g>
<!-- proc~init_neutral_population -->
<g id="proc~~dcx~~CallsGraph_node5" class="node"><title>proc~init_neutral_population</title>
<g id="a_proc~~dcx~~CallsGraph_node5"><a xlink:href=".././proc/init_neutral_population.html" xlink:title="init_neutral_population">
<polygon fill="#d9534f" stroke="#d9534f" points="223.5,-119.093 102.5,-119.093 102.5,-95.0928 223.5,-95.0928 223.5,-119.093"/>
<text text-anchor="middle" x="163" y="-104.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_neutral_population</text>
</a>
</g>
</g>
<!-- proc~dcx&#45;&gt;proc~init_neutral_population -->
<g id="proc~~dcx~~CallsGraph_edge3" class="edge"><title>proc~dcx&#45;&gt;proc~init_neutral_population</title>
<path fill="none" stroke="#000000" d="M29.2956,-270.074C33.058,-241.19 46.6334,-167.367 90,-128.093 91.327,-126.891 92.7192,-125.758 94.1658,-124.689"/>
<polygon fill="#000000" stroke="#000000" points="96.3029,-127.483 102.969,-119.248 92.6226,-121.528 96.3029,-127.483"/>
</g>
<!-- proc~get_nlaunch -->
<g id="proc~~dcx~~CallsGraph_node6" class="node"><title>proc~get_nlaunch</title>
<g id="a_proc~~dcx~~CallsGraph_node6"><a xlink:href=".././proc/get_nlaunch.html" xlink:title="get_nlaunch">
<polygon fill="#d9534f" stroke="#d9534f" points="198.5,-320.093 127.5,-320.093 127.5,-296.093 198.5,-296.093 198.5,-320.093"/>
<text text-anchor="middle" x="163" y="-305.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_nlaunch</text>
</a>
</g>
</g>
<!-- proc~dcx&#45;&gt;proc~get_nlaunch -->
<g id="proc~~dcx~~CallsGraph_edge5" class="edge"><title>proc~dcx&#45;&gt;proc~get_nlaunch</title>
<path fill="none" stroke="#000000" d="M54.1547,-287.168C72.0891,-290.647 96.3376,-295.352 117.299,-299.42"/>
<polygon fill="#000000" stroke="#000000" points="116.8,-302.888 127.283,-301.357 118.133,-296.016 116.8,-302.888"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~dcx~~CallsGraph_node7" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~dcx~~CallsGraph_node7"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="375,-201.093 307,-201.093 307,-177.093 375,-177.093 375,-201.093"/>
<text text-anchor="middle" x="341" y="-186.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~dcx&#45;&gt;proc~get_plasma -->
<g id="proc~~dcx~~CallsGraph_edge6" class="edge"><title>proc~dcx&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M40.1647,-270.072C51.9146,-259.188 70.7201,-243.594 90,-235.093 158.188,-205.025 245.197,-194.609 296.527,-191.002"/>
<polygon fill="#000000" stroke="#000000" points="296.857,-194.488 306.61,-190.35 296.405,-187.503 296.857,-194.488"/>
</g>
<!-- proc~ind2sub -->
<g id="proc~~dcx~~CallsGraph_node8" class="node"><title>proc~ind2sub</title>
<g id="a_proc~~dcx~~CallsGraph_node8"><a xlink:href=".././proc/ind2sub.html" xlink:title="ind2sub">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-424.093 314,-424.093 314,-400.093 368,-400.093 368,-424.093"/>
<text text-anchor="middle" x="341" y="-409.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ind2sub</text>
</a>
</g>
</g>
<!-- proc~dcx&#45;&gt;proc~ind2sub -->
<g id="proc~~dcx~~CallsGraph_edge7" class="edge"><title>proc~dcx&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M41.4071,-294.291C53.4123,-304.695 71.8704,-319.458 90,-329.093 161.445,-367.062 253.539,-392.192 303.621,-404.094"/>
<polygon fill="#000000" stroke="#000000" points="303.114,-407.57 313.647,-406.434 304.704,-400.753 303.114,-407.57"/>
</g>
<!-- proc~mc_beam_grid -->
<g id="proc~~dcx~~CallsGraph_node9" class="node"><title>proc~mc_beam_grid</title>
<g id="a_proc~~dcx~~CallsGraph_node9"><a xlink:href=".././proc/mc_beam_grid.html" xlink:title="mc_beam_grid">
<polygon fill="#d9534f" stroke="#d9534f" points="205,-268.093 121,-268.093 121,-244.093 205,-244.093 205,-268.093"/>
<text text-anchor="middle" x="163" y="-253.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_beam_grid</text>
</a>
</g>
</g>
<!-- proc~dcx&#45;&gt;proc~mc_beam_grid -->
<g id="proc~~dcx~~CallsGraph_edge8" class="edge"><title>proc~dcx&#45;&gt;proc~mc_beam_grid</title>
<path fill="none" stroke="#000000" d="M54.1547,-277.018C70.3046,-273.884 91.5746,-269.757 110.954,-265.997"/>
<polygon fill="#000000" stroke="#000000" points="111.728,-269.412 120.879,-264.072 110.395,-262.541 111.728,-269.412"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~dcx~~CallsGraph_node12" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~dcx~~CallsGraph_node12"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="673,-824.093 585,-824.093 585,-800.093 673,-800.093 673,-824.093"/>
<text text-anchor="middle" x="629" y="-809.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~dcx~~CallsGraph_edge12" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M501.157,-656.427C511.026,-684.027 538.356,-751.45 582,-791.093 583.296,-792.27 584.668,-793.391 586.099,-794.457"/>
<polygon fill="#000000" stroke="#000000" points="584.462,-797.565 594.778,-799.982 588.221,-791.66 584.462,-797.565"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~dcx~~CallsGraph_node13" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~dcx~~CallsGraph_node13"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="673,-782.093 585,-782.093 585,-758.093 673,-758.093 673,-782.093"/>
<text text-anchor="middle" x="629" y="-767.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~dcx~~CallsGraph_edge14" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M504.219,-656.325C517.33,-677.649 546.962,-721.941 582,-749.093 583.748,-750.447 585.597,-751.739 587.511,-752.966"/>
<polygon fill="#000000" stroke="#000000" points="585.781,-756.009 596.2,-757.935 589.257,-749.932 585.781,-756.009"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~dcx~~CallsGraph_node15" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~dcx~~CallsGraph_node15"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-740.093 583.5,-740.093 583.5,-716.093 674.5,-716.093 674.5,-740.093"/>
<text text-anchor="middle" x="629" y="-725.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~dcx~~CallsGraph_edge9" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M511.393,-656.232C527.795,-669.709 555.739,-691.598 582,-707.093 584.481,-708.557 587.082,-709.99 589.731,-711.377"/>
<polygon fill="#000000" stroke="#000000" points="588.306,-714.577 598.819,-715.89 591.419,-708.308 588.306,-714.577"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~dcx~~CallsGraph_node18" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~dcx~~CallsGraph_node18"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-698.093 583.5,-698.093 583.5,-674.093 674.5,-674.093 674.5,-698.093"/>
<text text-anchor="middle" x="629" y="-683.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~dcx~~CallsGraph_edge13" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.796,-655.57C547.602,-660.316 564.976,-665.887 580.801,-670.96"/>
<polygon fill="#000000" stroke="#000000" points="579.826,-674.323 590.417,-674.043 581.963,-667.657 579.826,-674.323"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~dcx~~CallsGraph_node20" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~dcx~~CallsGraph_node20"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-656.093 583.5,-656.093 583.5,-632.093 674.5,-632.093 674.5,-656.093"/>
<text text-anchor="middle" x="629" y="-641.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~dcx~~CallsGraph_edge18" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.796,-644.093C545.232,-644.093 559.48,-644.093 573.1,-644.093"/>
<polygon fill="#000000" stroke="#000000" points="573.352,-647.593 583.352,-644.093 573.352,-640.593 573.352,-647.593"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~dcx~~CallsGraph_node21" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~dcx~~CallsGraph_node21"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-614.093 583.5,-614.093 583.5,-590.093 674.5,-590.093 674.5,-614.093"/>
<text text-anchor="middle" x="629" y="-599.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~dcx~~CallsGraph_edge10" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.796,-632.616C547.602,-627.869 564.976,-622.299 580.801,-617.225"/>
<polygon fill="#000000" stroke="#000000" points="581.963,-620.528 590.417,-614.142 579.826,-613.863 581.963,-620.528"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~dcx~~CallsGraph_node22" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~dcx~~CallsGraph_node22"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="673,-572.093 585,-572.093 585,-548.093 673,-548.093 673,-572.093"/>
<text text-anchor="middle" x="629" y="-557.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~dcx~~CallsGraph_edge11" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M511.393,-631.953C527.795,-618.477 555.739,-596.587 582,-581.093 584.481,-579.629 587.082,-578.195 589.731,-576.808"/>
<polygon fill="#000000" stroke="#000000" points="591.419,-579.878 598.819,-572.296 588.306,-573.608 591.419,-579.878"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~dcx~~CallsGraph_node26" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~dcx~~CallsGraph_node26"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-530.093 583.5,-530.093 583.5,-506.093 674.5,-506.093 674.5,-530.093"/>
<text text-anchor="middle" x="629" y="-515.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~dcx~~CallsGraph_edge17" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M504.219,-631.861C517.33,-610.537 546.962,-566.245 582,-539.093 583.748,-537.738 585.597,-536.447 587.511,-535.22"/>
<polygon fill="#000000" stroke="#000000" points="589.257,-538.253 596.2,-530.25 585.781,-532.177 589.257,-538.253"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~dcx~~CallsGraph_node29" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~dcx~~CallsGraph_node29"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="673,-908.093 585,-908.093 585,-884.093 673,-884.093 673,-908.093"/>
<text text-anchor="middle" x="629" y="-893.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~dcx~~CallsGraph_edge15" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M498.211,-656.331C502.536,-693.837 520.409,-808.656 582,-875.093 582.906,-876.071 583.867,-877.006 584.873,-877.901"/>
<polygon fill="#000000" stroke="#000000" points="583.143,-880.97 593.297,-883.996 587.246,-875.298 583.143,-880.97"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~dcx~~CallsGraph_node30" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~dcx~~CallsGraph_node30"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-866.093 583.5,-866.093 583.5,-842.093 674.5,-842.093 674.5,-866.093"/>
<text text-anchor="middle" x="629" y="-851.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~dcx~~CallsGraph_edge16" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M499.378,-656.411C506.322,-689.304 529.487,-780.283 582,-833.093 583.083,-834.182 584.233,-835.221 585.436,-836.21"/>
<polygon fill="#000000" stroke="#000000" points="583.756,-839.301 593.988,-842.051 587.704,-833.521 583.756,-839.301"/>
</g>
<!-- proc~track&#45;&gt;proc~get_plasma -->
<g id="proc~~dcx~~CallsGraph_edge19" class="edge"><title>proc~track&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M190.349,-155.081C218.506,-161.481 263.586,-171.726 296.918,-179.302"/>
<polygon fill="#000000" stroke="#000000" points="296.327,-182.756 306.854,-181.56 297.878,-175.93 296.327,-182.756"/>
</g>
<!-- proc~get_indices -->
<g id="proc~~dcx~~CallsGraph_node19" class="node"><title>proc~get_indices</title>
<g id="a_proc~~dcx~~CallsGraph_node19"><a xlink:href=".././proc/get_indices.html" xlink:title="get_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="374.5,-121.093 307.5,-121.093 307.5,-97.0928 374.5,-97.0928 374.5,-121.093"/>
<text text-anchor="middle" x="341" y="-106.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_indices</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~get_indices -->
<g id="proc~~dcx~~CallsGraph_edge21" class="edge"><title>proc~track&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M190.349,-143.104C218.68,-136.666 264.143,-126.333 297.534,-118.744"/>
<polygon fill="#000000" stroke="#000000" points="298.501,-122.114 307.477,-116.484 296.95,-115.288 298.501,-122.114"/>
</g>
<!-- proc~doppler_stark -->
<g id="proc~~dcx~~CallsGraph_node24" class="node"><title>proc~doppler_stark</title>
<g id="a_proc~~dcx~~CallsGraph_node24"><a xlink:href=".././proc/doppler_stark.html" xlink:title="doppler_stark">
<polygon fill="#d9534f" stroke="#d9534f" points="380,-79.0928 302,-79.0928 302,-55.0928 380,-55.0928 380,-79.0928"/>
<text text-anchor="middle" x="341" y="-64.6928" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">doppler_stark</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~doppler_stark -->
<g id="proc~~dcx~~CallsGraph_edge20" class="edge"><title>proc~track&#45;&gt;proc~doppler_stark</title>
<path fill="none" stroke="#000000" d="M190.096,-145.098C204.448,-142.044 222.107,-136.82 236,-128.093 256.253,-115.37 251.848,-100.974 272,-88.0928 278.155,-84.1583 285.094,-80.921 292.127,-78.2688"/>
<polygon fill="#000000" stroke="#000000" points="293.373,-81.5419 301.711,-75.0042 291.116,-74.9158 293.373,-81.5419"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~dcx~~CallsGraph_node27" class="node"><title>proc~get_fields</title>
<g id="a_proc~~dcx~~CallsGraph_node27"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="370,-37.0928 312,-37.0928 312,-13.0928 370,-13.0928 370,-37.0928"/>
<text text-anchor="middle" x="341" y="-22.6928" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~get_fields -->
<g id="proc~~dcx~~CallsGraph_edge22" class="edge"><title>proc~track&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M190.258,-146.898C205.193,-144.42 223.377,-139.174 236,-128.093 265.912,-101.835 242.296,-72.5857 272,-46.0928 280.315,-38.6763 291.211,-33.8791 301.836,-30.776"/>
<polygon fill="#000000" stroke="#000000" points="302.986,-34.0969 311.848,-28.2899 301.299,-27.3032 302.986,-34.0969"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~dcx~~CallsGraph_node31" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~dcx~~CallsGraph_node31"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="526.5,-111.093 465.5,-111.093 465.5,-87.0928 526.5,-87.0928 526.5,-111.093"/>
<text text-anchor="middle" x="496" y="-96.6928" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~in_plasma -->
<g id="proc~~dcx~~CallsGraph_edge23" class="edge"><title>proc~track&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M190.191,-149.393C235.519,-149.4 331.296,-147.148 410,-130.093 426.09,-126.606 443.253,-120.778 457.914,-115.11"/>
<polygon fill="#000000" stroke="#000000" points="459.625,-118.196 467.619,-111.243 457.034,-111.693 459.625,-118.196"/>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;interface~parallel_sum -->
<g id="proc~~dcx~~CallsGraph_edge24" class="edge"><title>proc~parallel_merge_populations&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M183.227,-445.349C239.232,-481.05 402.391,-585.058 467.602,-626.628"/>
<polygon fill="#000000" stroke="#000000" points="465.819,-629.642 476.133,-632.066 469.582,-623.739 465.819,-629.642"/>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;proc~ind2sub -->
<g id="proc~~dcx~~CallsGraph_edge26" class="edge"><title>proc~parallel_merge_populations&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M235.586,-424.551C258.98,-421.76 283.98,-418.777 303.65,-416.43"/>
<polygon fill="#000000" stroke="#000000" points="304.184,-419.891 313.699,-415.231 303.354,-412.941 304.184,-419.891"/>
</g>
<!-- proc~parallel_merge_reservoirs -->
<g id="proc~~dcx~~CallsGraph_node28" class="node"><title>proc~parallel_merge_reservoirs</title>
<g id="a_proc~~dcx~~CallsGraph_node28"><a xlink:href=".././proc/parallel_merge_reservoirs.html" xlink:title="parallel_merge_reservoirs">
<polygon fill="#d9534f" stroke="#d9534f" points="409.5,-466.093 272.5,-466.093 272.5,-442.093 409.5,-442.093 409.5,-466.093"/>
<text text-anchor="middle" x="341" y="-451.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_merge_reservoirs</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;proc~parallel_merge_reservoirs -->
<g id="proc~~dcx~~CallsGraph_edge25" class="edge"><title>proc~parallel_merge_populations&#45;&gt;proc~parallel_merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M235.586,-441.634C244.437,-442.69 253.517,-443.774 262.452,-444.84"/>
<polygon fill="#000000" stroke="#000000" points="262.113,-448.324 272.457,-446.034 262.942,-441.374 262.113,-448.324"/>
</g>
<!-- interface~randind_cdf -->
<g id="proc~~dcx~~CallsGraph_node11" class="node"><title>interface~randind_cdf</title>
<g id="a_proc~~dcx~~CallsGraph_node11"><a xlink:href=".././interface/randind_cdf.html" xlink:title="randind_cdf">
<polygon fill="#a7506f" stroke="#a7506f" points="375.5,-340.093 306.5,-340.093 306.5,-316.093 375.5,-316.093 375.5,-340.093"/>
<text text-anchor="middle" x="341" y="-325.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind_cdf</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;interface~randind_cdf -->
<g id="proc~~dcx~~CallsGraph_edge28" class="edge"><title>proc~get_nlaunch&#45;&gt;interface~randind_cdf</title>
<path fill="none" stroke="#000000" d="M198.772,-312.044C226.731,-315.221 266.174,-319.703 296.272,-323.124"/>
<polygon fill="#000000" stroke="#000000" points="296.163,-326.634 306.494,-324.285 296.954,-319.679 296.163,-326.634"/>
</g>
<!-- proc~rng_init -->
<g id="proc~~dcx~~CallsGraph_node16" class="node"><title>proc~rng_init</title>
<g id="a_proc~~dcx~~CallsGraph_node16"><a xlink:href=".././proc/rng_init.html" xlink:title="rng_init">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-382.093 314,-382.093 314,-358.093 368,-358.093 368,-382.093"/>
<text text-anchor="middle" x="341" y="-367.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rng_init</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~rng_init -->
<g id="proc~~dcx~~CallsGraph_edge27" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~rng_init</title>
<path fill="none" stroke="#000000" d="M194.073,-320.095C215.637,-328.557 245.448,-339.963 272,-349.093 282.36,-352.655 293.7,-356.269 304.1,-359.471"/>
<polygon fill="#000000" stroke="#000000" points="303.133,-362.835 313.719,-362.4 305.172,-356.139 303.133,-362.835"/>
</g>
<!-- proc~cumsum -->
<g id="proc~~dcx~~CallsGraph_node17" class="node"><title>proc~cumsum</title>
<g id="a_proc~~dcx~~CallsGraph_node17"><a xlink:href=".././proc/cumsum.html" xlink:title="cumsum">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-298.093 314,-298.093 314,-274.093 368,-274.093 368,-298.093"/>
<text text-anchor="middle" x="341" y="-283.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cumsum</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~cumsum -->
<g id="proc~~dcx~~CallsGraph_edge29" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~cumsum</title>
<path fill="none" stroke="#000000" d="M198.772,-303.746C229.061,-299.96 272.827,-294.489 303.59,-290.644"/>
<polygon fill="#000000" stroke="#000000" points="304.397,-294.071 313.886,-289.357 303.529,-287.125 304.397,-294.071"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~dcx~~CallsGraph_node10" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~dcx~~CallsGraph_node10"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="663,-69.0928 595,-69.0928 595,-45.0928 663,-45.0928 663,-69.0928"/>
<text text-anchor="middle" x="629" y="-54.6928" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~dcx~~CallsGraph_edge30" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M375.389,-180.132C425.589,-166.274 517.653,-139.244 546,-120.093 566.372,-106.33 562.357,-92.8778 582,-78.0928 583.824,-76.7202 585.751,-75.4098 587.743,-74.163"/>
<polygon fill="#000000" stroke="#000000" points="589.749,-77.051 596.763,-69.1098 586.328,-70.9441 589.749,-77.051"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~dcx~~CallsGraph_node23" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~dcx~~CallsGraph_node23"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="786,-151.093 718,-151.093 718,-127.093 786,-127.093 786,-151.093"/>
<text text-anchor="middle" x="752" y="-136.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~dcx~~CallsGraph_edge31" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M375.124,-185.043C448.711,-176.047 625.761,-154.403 707.856,-144.367"/>
<polygon fill="#000000" stroke="#000000" points="708.352,-147.833 717.853,-143.145 707.502,-140.884 708.352,-147.833"/>
</g>
<!-- proc~get_position -->
<g id="proc~~dcx~~CallsGraph_node25" class="node"><title>proc~get_position</title>
<g id="a_proc~~dcx~~CallsGraph_node25"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="531,-229.093 461,-229.093 461,-205.093 531,-205.093 531,-229.093"/>
<text text-anchor="middle" x="496" y="-214.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~dcx~~CallsGraph_edge32" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M375.199,-195.168C397.346,-199.222 426.714,-204.596 450.829,-209.009"/>
<polygon fill="#000000" stroke="#000000" points="450.34,-212.478 460.807,-210.835 451.6,-205.592 450.34,-212.478"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~dcx~~CallsGraph_edge33" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M375.269,-179.715C386.814,-175.615 399.489,-170.112 410,-163.093 429.347,-150.172 427.481,-139.175 446,-125.093 450.204,-121.896 454.856,-118.876 459.571,-116.103"/>
<polygon fill="#000000" stroke="#000000" points="461.561,-119.001 468.613,-111.094 458.169,-112.878 461.561,-119.001"/>
</g>
<!-- interface~randu -->
<g id="proc~~dcx~~CallsGraph_node14" class="node"><title>interface~randu</title>
<g id="a_proc~~dcx~~CallsGraph_node14"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="882,-349.093 828,-349.093 828,-325.093 882,-325.093 882,-349.093"/>
<text text-anchor="middle" x="855" y="-334.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~mc_beam_grid&#45;&gt;interface~randu -->
<g id="proc~~dcx~~CallsGraph_edge34" class="edge"><title>proc~mc_beam_grid&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M205.167,-253.169C307.186,-247.208 578.86,-239.227 792,-304.093 804.09,-307.772 816.553,-313.881 827.105,-319.849"/>
<polygon fill="#000000" stroke="#000000" points="825.437,-322.929 835.828,-324.993 828.992,-316.899 825.437,-322.929"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~dcx~~CallsGraph_node34" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="791.5,-719.093 712.5,-719.093 712.5,-695.093 791.5,-695.093 791.5,-719.093"/>
<text text-anchor="middle" x="752" y="-704.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~dcx~~CallsGraph_edge35" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M661.18,-799.999C666.341,-797.405 671.477,-794.426 676,-791.093 700.456,-773.07 722.856,-745.977 736.685,-727.466"/>
<polygon fill="#000000" stroke="#000000" points="739.514,-729.527 742.585,-719.387 733.861,-725.399 739.514,-729.527"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~dcx~~CallsGraph_edge36" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M657.419,-758.022C663.578,-755.188 670.05,-752.111 676,-749.093 691.248,-741.359 707.868,-732.137 721.579,-724.306"/>
<polygon fill="#000000" stroke="#000000" points="723.632,-727.163 730.554,-719.143 720.141,-721.096 723.632,-727.163"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~dcx~~CallsGraph_edge37" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M674.712,-720.333C683.712,-718.771 693.213,-717.122 702.34,-715.538"/>
<polygon fill="#000000" stroke="#000000" points="703.185,-718.944 712.439,-713.785 701.988,-712.047 703.185,-718.944"/>
</g>
<!-- proc~my_rank -->
<g id="proc~~dcx~~CallsGraph_node32" class="node"><title>proc~my_rank</title>
<g id="a_proc~~dcx~~CallsGraph_node32"><a xlink:href=".././proc/my_rank.html" xlink:title="my_rank">
<polygon fill="#d94e8f" stroke="#d94e8f" points="523,-366.093 469,-366.093 469,-342.093 523,-342.093 523,-366.093"/>
<text text-anchor="middle" x="496" y="-351.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">my_rank</text>
</a>
</g>
</g>
<!-- proc~rng_init&#45;&gt;proc~my_rank -->
<g id="proc~~dcx~~CallsGraph_edge38" class="edge"><title>proc~rng_init&#45;&gt;proc~my_rank</title>
<path fill="none" stroke="#000000" d="M368.302,-367.342C393.227,-364.736 430.881,-360.798 458.667,-357.892"/>
<polygon fill="#000000" stroke="#000000" points="459.204,-361.355 468.786,-356.834 458.476,-354.393 459.204,-361.355"/>
</g>
<!-- proc~rng_seed -->
<g id="proc~~dcx~~CallsGraph_node41" class="node"><title>proc~rng_seed</title>
<g id="a_proc~~dcx~~CallsGraph_node41"><a xlink:href=".././proc/rng_seed.html" xlink:title="rng_seed">
<polygon fill="#d94e8f" stroke="#d94e8f" points="525,-324.093 467,-324.093 467,-300.093 525,-300.093 525,-324.093"/>
<text text-anchor="middle" x="496" y="-309.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rng_seed</text>
</a>
</g>
</g>
<!-- proc~rng_init&#45;&gt;proc~rng_seed -->
<g id="proc~~dcx~~CallsGraph_edge39" class="edge"><title>proc~rng_init&#45;&gt;proc~rng_seed</title>
<path fill="none" stroke="#000000" d="M368.076,-362.829C380.835,-359.075 396.349,-354.214 410,-349.093 426.394,-342.943 429.953,-340.097 446,-333.093 449.817,-331.427 453.806,-329.697 457.789,-327.979"/>
<polygon fill="#000000" stroke="#000000" points="459.184,-331.189 466.987,-324.022 456.418,-324.759 459.184,-331.189"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~dcx~~CallsGraph_edge40" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M674.712,-693.853C683.712,-695.415 693.213,-697.064 702.34,-698.648"/>
<polygon fill="#000000" stroke="#000000" points="701.988,-702.139 712.439,-700.401 703.185,-695.242 701.988,-702.139"/>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~dcx~~CallsGraph_edge41" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M657.419,-656.163C663.578,-658.998 670.05,-662.075 676,-665.093 691.248,-672.826 707.868,-682.049 721.579,-689.88"/>
<polygon fill="#000000" stroke="#000000" points="720.141,-693.09 730.554,-695.043 723.632,-687.023 720.141,-693.09"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~dcx~~CallsGraph_edge42" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M661.18,-614.187C666.341,-616.78 671.477,-619.76 676,-623.093 700.456,-641.116 722.856,-668.208 736.685,-686.719"/>
<polygon fill="#000000" stroke="#000000" points="733.861,-688.787 742.585,-694.799 739.514,-684.659 733.861,-688.787"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~dcx~~CallsGraph_edge43" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M663.184,-572.246C667.775,-574.756 672.209,-577.693 676,-581.093 708.937,-610.633 731.72,-658.137 742.955,-685.599"/>
<polygon fill="#000000" stroke="#000000" points="739.764,-687.048 746.693,-695.063 746.275,-684.476 739.764,-687.048"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~dcx~~CallsGraph_node38" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~dcx~~CallsGraph_node38"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="660,-229.093 598,-229.093 598,-205.093 660,-205.093 660,-229.093"/>
<text text-anchor="middle" x="629" y="-214.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~dcx~~CallsGraph_edge44" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M531.077,-217.093C548.314,-217.093 569.356,-217.093 587.425,-217.093"/>
<polygon fill="#000000" stroke="#000000" points="587.668,-220.593 597.668,-217.093 587.668,-213.593 587.668,-220.593"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~dcx~~CallsGraph_edge45" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M664.021,-530.126C668.39,-532.634 672.538,-535.602 676,-539.093 717.401,-580.842 738.041,-649.414 746.37,-684.649"/>
<polygon fill="#000000" stroke="#000000" points="743.052,-685.848 748.653,-694.841 749.883,-684.318 743.052,-685.848"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~dcx~~CallsGraph_edge46" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M370.228,-24.8674C409.765,-24.9475 483.773,-26.5424 546,-36.0928 558.837,-38.063 572.583,-41.1756 585.081,-44.407"/>
<polygon fill="#000000" stroke="#000000" points="584.23,-47.8024 594.795,-47.0044 586.038,-41.04 584.23,-47.8024"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~dcx~~CallsGraph_edge47" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M370.318,-17.7328C431.041,-3.62402 576.341,21.0405 676,-36.0928 708.384,-54.658 730.663,-93.503 742.088,-117.825"/>
<polygon fill="#000000" stroke="#000000" points="738.9,-119.271 746.19,-126.96 745.286,-116.403 738.9,-119.271"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~dcx~~CallsGraph_edge49" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M370.229,-30.9266C382.901,-34.2581 397.728,-39.1787 410,-46.0928 428.651,-56.601 427.928,-66.6172 446,-78.0928 449.196,-80.1224 452.622,-82.0395 456.122,-83.8283"/>
<polygon fill="#000000" stroke="#000000" points="454.921,-87.1321 465.456,-88.2528 457.919,-80.8067 454.921,-87.1321"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~dcx~~CallsGraph_node33" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~dcx~~CallsGraph_node33"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="546,-69.0928 446,-69.0928 446,-45.0928 546,-45.0928 546,-69.0928"/>
<text text-anchor="middle" x="496" y="-54.6928" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~dcx~~CallsGraph_edge48" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M370.063,-30.9621C388.474,-34.8129 413.244,-39.9936 435.873,-44.7264"/>
<polygon fill="#000000" stroke="#000000" points="435.246,-48.171 445.751,-46.7924 436.679,-41.3192 435.246,-48.171"/>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;interface~parallel_sum -->
<g id="proc~~dcx~~CallsGraph_edge50" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M353.098,-466.299C366.783,-481.468 390.609,-508.265 410,-532.093 435.436,-563.348 463.414,-600.868 480.078,-623.575"/>
<polygon fill="#000000" stroke="#000000" points="477.354,-625.781 486.083,-631.786 483.004,-621.648 477.354,-625.781"/>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~my_rank -->
<g id="proc~~dcx~~CallsGraph_edge51" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~my_rank</title>
<path fill="none" stroke="#000000" d="M394.774,-442.052C400.202,-439.595 405.403,-436.641 410,-433.093 434.016,-414.553 422.993,-394.871 446,-375.093 450.02,-371.637 454.694,-368.676 459.529,-366.162"/>
<polygon fill="#000000" stroke="#000000" points="461.264,-369.216 468.893,-361.864 458.345,-362.854 461.264,-369.216"/>
</g>
<!-- proc~num_ranks -->
<g id="proc~~dcx~~CallsGraph_node36" class="node"><title>proc~num_ranks</title>
<g id="a_proc~~dcx~~CallsGraph_node36"><a xlink:href=".././proc/num_ranks.html" xlink:title="num_ranks">
<polygon fill="#d94e8f" stroke="#d94e8f" points="529,-408.093 463,-408.093 463,-384.093 529,-384.093 529,-408.093"/>
<text text-anchor="middle" x="496" y="-393.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">num_ranks</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~num_ranks -->
<g id="proc~~dcx~~CallsGraph_edge52" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~num_ranks</title>
<path fill="none" stroke="#000000" d="M383.98,-441.984C392.648,-439.245 401.671,-436.217 410,-433.093 426.394,-426.943 429.953,-424.097 446,-417.093 449.665,-415.493 453.488,-413.835 457.312,-412.185"/>
<polygon fill="#000000" stroke="#000000" points="458.927,-415.3 466.729,-408.133 456.16,-408.87 458.927,-415.3"/>
</g>
<!-- proc~init_reservoir -->
<g id="proc~~dcx~~CallsGraph_node37" class="node"><title>proc~init_reservoir</title>
<g id="a_proc~~dcx~~CallsGraph_node37"><a xlink:href=".././proc/init_reservoir.html" xlink:title="init_reservoir">
<polygon fill="#d9534f" stroke="#d9534f" points="789,-451.093 715,-451.093 715,-427.093 789,-427.093 789,-451.093"/>
<text text-anchor="middle" x="752" y="-436.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_reservoir</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~init_reservoir -->
<g id="proc~~dcx~~CallsGraph_edge53" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M409.74,-457.902C477.395,-460.717 584.241,-462.479 676,-452.093 685.354,-451.034 695.309,-449.558 704.807,-447.979"/>
<polygon fill="#000000" stroke="#000000" points="705.625,-451.389 714.884,-446.24 704.434,-444.491 705.625,-451.389"/>
</g>
<!-- proc~merge_reservoirs -->
<g id="proc~~dcx~~CallsGraph_node39" class="node"><title>proc~merge_reservoirs</title>
<g id="a_proc~~dcx~~CallsGraph_node39"><a xlink:href=".././proc/merge_reservoirs.html" xlink:title="merge_reservoirs">
<polygon fill="#d9534f" stroke="#d9534f" points="544.5,-450.093 447.5,-450.093 447.5,-426.093 544.5,-426.093 544.5,-450.093"/>
<text text-anchor="middle" x="496" y="-435.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">merge_reservoirs</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~merge_reservoirs -->
<g id="proc~~dcx~~CallsGraph_edge54" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M409.553,-447.028C418.743,-446.067 428.107,-445.088 437.106,-444.147"/>
<polygon fill="#000000" stroke="#000000" points="437.5,-447.625 447.082,-443.104 436.772,-440.663 437.5,-447.625"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~dcx~~CallsGraph_edge55" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M664.021,-884.06C668.39,-881.552 672.538,-878.584 676,-875.093 717.401,-833.343 738.041,-764.771 746.37,-729.537"/>
<polygon fill="#000000" stroke="#000000" points="749.883,-729.868 748.653,-719.345 743.052,-728.338 749.883,-729.868"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~dcx~~CallsGraph_edge56" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M663.184,-841.939C667.775,-839.43 672.209,-836.492 676,-833.093 708.937,-803.553 731.72,-756.049 742.955,-728.587"/>
<polygon fill="#000000" stroke="#000000" points="746.275,-729.709 746.693,-719.123 739.764,-727.138 746.275,-729.709"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~dcx~~CallsGraph_edge57" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M526.726,-89.5624C543.954,-84.0389 565.945,-76.9883 585.03,-70.8694"/>
<polygon fill="#000000" stroke="#000000" points="586.251,-74.1536 594.705,-67.7676 584.114,-67.4878 586.251,-74.1536"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~dcx~~CallsGraph_node35" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~dcx~~CallsGraph_node35"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="784.5,-211.093 719.5,-211.093 719.5,-187.093 784.5,-187.093 784.5,-211.093"/>
<text text-anchor="middle" x="752" y="-196.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~dcx~~CallsGraph_edge58" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M526.634,-110.76C572.245,-128.717 659.73,-163.16 710.942,-183.322"/>
<polygon fill="#000000" stroke="#000000" points="709.784,-186.627 720.371,-187.034 712.348,-180.114 709.784,-186.627"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~dcx~~CallsGraph_node40" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~dcx~~CallsGraph_node40"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="667.5,-111.093 590.5,-111.093 590.5,-87.0928 667.5,-87.0928 667.5,-111.093"/>
<text text-anchor="middle" x="629" y="-96.6928" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~dcx~~CallsGraph_edge59" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M526.726,-99.0928C542.576,-99.0928 562.457,-99.0928 580.398,-99.0928"/>
<polygon fill="#000000" stroke="#000000" points="580.409,-102.593 590.409,-99.0928 580.409,-95.5929 580.409,-102.593"/>
</g>
<!-- proc~init_reservoir&#45;&gt;interface~randu -->
<g id="proc~~dcx~~CallsGraph_edge60" class="edge"><title>proc~init_reservoir&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M777.916,-427.006C782.827,-424.093 787.765,-420.752 792,-417.093 811.97,-399.84 829.847,-375.296 841.215,-357.954"/>
<polygon fill="#000000" stroke="#000000" points="844.402,-359.465 846.832,-349.153 838.501,-355.699 844.402,-359.465"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~dcx~~CallsGraph_edge61" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M648.641,-205.076C668.656,-192.174 700.66,-171.544 723.553,-156.786"/>
<polygon fill="#000000" stroke="#000000" points="725.63,-159.611 732.138,-151.252 721.837,-153.728 725.63,-159.611"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~dcx~~CallsGraph_edge62" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M660.221,-212.597C675.036,-210.393 693.114,-207.704 709.226,-205.307"/>
<polygon fill="#000000" stroke="#000000" points="710.1,-208.716 719.476,-203.782 709.07,-201.792 710.1,-208.716"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;interface~randu -->
<g id="proc~~dcx~~CallsGraph_edge66" class="edge"><title>proc~merge_reservoirs&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M533.719,-426.043C538.193,-423.554 542.434,-420.595 546,-417.093 573.816,-389.772 549.258,-358.263 582,-337.093 654.61,-290.145 762.501,-310.356 818.058,-325.673"/>
<polygon fill="#000000" stroke="#000000" points="817.226,-329.075 827.803,-328.458 819.15,-322.344 817.226,-329.075"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;proc~init_reservoir -->
<g id="proc~~dcx~~CallsGraph_edge65" class="edge"><title>proc~merge_reservoirs&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M544.775,-438.281C590.638,-438.462 659.451,-438.732 704.784,-438.911"/>
<polygon fill="#000000" stroke="#000000" points="704.914,-442.411 714.928,-438.951 704.942,-435.411 704.914,-442.411"/>
</g>
<!-- float -->
<g id="proc~~dcx~~CallsGraph_node42" class="node"><title>float</title>
<polygon fill="#777777" stroke="#777777" points="656,-412.093 602,-412.093 602,-388.093 656,-388.093 656,-412.093"/>
<text text-anchor="middle" x="629" y="-397.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">float</text>
</g>
<!-- proc~merge_reservoirs&#45;&gt;float -->
<g id="proc~~dcx~~CallsGraph_edge63" class="edge"><title>proc~merge_reservoirs&#45;&gt;float</title>
<path fill="none" stroke="#000000" d="M538.449,-426.069C555.582,-421.1 575.264,-415.39 591.805,-410.592"/>
<polygon fill="#000000" stroke="#000000" points="593.019,-413.884 601.648,-407.737 591.069,-407.162 593.019,-413.884"/>
</g>
<!-- proc~update_reservoir -->
<g id="proc~~dcx~~CallsGraph_node43" class="node"><title>proc~update_reservoir</title>
<g id="a_proc~~dcx~~CallsGraph_node43"><a xlink:href=".././proc/update_reservoir.html" xlink:title="update_reservoir">
<polygon fill="#d9534f" stroke="#d9534f" points="676,-370.093 582,-370.093 582,-346.093 676,-346.093 676,-370.093"/>
<text text-anchor="middle" x="629" y="-355.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_reservoir</text>
</a>
</g>
</g>
<!-- proc~merge_reservoirs&#45;&gt;proc~update_reservoir -->
<g id="proc~~dcx~~CallsGraph_edge64" class="edge"><title>proc~merge_reservoirs&#45;&gt;proc~update_reservoir</title>
<path fill="none" stroke="#000000" d="M530.143,-426.089C535.648,-423.486 541.14,-420.48 546,-417.093 565.087,-403.791 563.07,-392.617 582,-379.093 583.857,-377.766 585.812,-376.492 587.825,-375.274"/>
<polygon fill="#000000" stroke="#000000" points="589.814,-378.175 596.902,-370.3 586.451,-372.036 589.814,-378.175"/>
</g>
<!-- proc~update_reservoir&#45;&gt;interface~randu -->
<g id="proc~~dcx~~CallsGraph_edge69" class="edge"><title>proc~update_reservoir&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M676.141,-353.767C718.051,-349.838 779.042,-344.12 817.604,-340.505"/>
<polygon fill="#000000" stroke="#000000" points="818.222,-343.962 827.851,-339.544 817.568,-336.993 818.222,-343.962"/>
</g>
<!-- proc~update_reservoir&#45;&gt;proc~init_reservoir -->
<g id="proc~~dcx~~CallsGraph_edge68" class="edge"><title>proc~update_reservoir&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M661.098,-370.3C666.267,-372.881 671.428,-375.827 676,-379.093 694.93,-392.617 693.664,-402.774 712,-417.093 713.984,-418.642 716.089,-420.151 718.254,-421.606"/>
<polygon fill="#000000" stroke="#000000" points="716.43,-424.592 726.767,-426.914 720.133,-418.653 716.43,-424.592"/>
</g>
<!-- interface~randind -->
<g id="proc~~dcx~~CallsGraph_node44" class="node"><title>interface~randind</title>
<g id="a_proc~~dcx~~CallsGraph_node44"><a xlink:href=".././interface/randind.html" xlink:title="randind">
<polygon fill="#a7506f" stroke="#a7506f" points="779,-408.093 725,-408.093 725,-384.093 779,-384.093 779,-408.093"/>
<text text-anchor="middle" x="752" y="-393.693" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind</text>
</a>
</g>
</g>
<!-- proc~update_reservoir&#45;&gt;interface~randind -->
<g id="proc~~dcx~~CallsGraph_edge67" class="edge"><title>proc~update_reservoir&#45;&gt;interface~randind</title>
<path fill="none" stroke="#000000" d="M668.285,-370.116C683.249,-374.816 700.318,-380.176 715.049,-384.803"/>
<polygon fill="#000000" stroke="#000000" points="714.23,-388.214 724.819,-387.871 716.327,-381.535 714.23,-388.214"/>
</g>
</g>
</svg>
</div><script>var panprocdcxCallsGraph = svgPanZoom('#procdcxCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~dcx~~CalledByGraph Pages: 1 -->
<svg id="procdcxCalledByGraph" width="152pt" height="32pt"
 viewBox="0.00 0.00 152.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~dcx~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~dcx~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 148,-28 148,4 -4,4"/>
<!-- proc~dcx -->
<g id="proc~~dcx~~CalledByGraph_node1" class="node"><title>proc~dcx</title>
<polygon fill="none" stroke="black" points="144,-24 90,-24 90,-0 144,-0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">dcx</text>
</g>
<!-- program~fidasim -->
<g id="proc~~dcx~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~dcx~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~dcx -->
<g id="proc~~dcx~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~dcx</title>
<path fill="none" stroke="#000000" d="M54.4029,-12C62.3932,-12 71.3106,-12 79.8241,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.919,-15.5001 89.919,-12 79.919,-8.5001 79.919,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/dcx.html#src">dcx</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">dcx</span>
    <span class="c">!+ Calculates Direct Charge Exchange (DCX) neutral density and spectra</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ic</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">ncell</span><span class="p">,</span><span class="k">is</span>
<span class="k">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">idcx</span> <span class="c">!! counter</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ri</span>    <span class="c">!! start position</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vihalo</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ind</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">neut_types</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
    <span class="c">!! Determination of the CX probability</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span> <span class="kd">::</span> <span class="n">plasma</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">denn</span>    <span class="c">!!  neutral dens (n=1-4)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rates</span>    <span class="c">!!  CX rates</span>
    <span class="c">!! Collisiional radiative model along track</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">states</span>  <span class="c">! Density of n-states</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ntrack</span>
    <span class="k">type</span><span class="p">(</span><span class="n">ParticleTrack</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ntrack</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tracks</span>  <span class="c">!! Particle tracks</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">jj</span>       <span class="c">!! counter along track</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="kd">::</span> <span class="n">tot_denn</span><span class="p">,</span> <span class="n">photons</span>  <span class="c">!! photon flux</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cell_ind</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nx</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ny</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nz</span><span class="p">)</span> <span class="kd">::</span> <span class="n">papprox</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nx</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ny</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nz</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nlaunch</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fi_correction</span><span class="p">,</span> <span class="n">dcx_dens</span>

    <span class="c">!! Initialized Neutral Population</span>
    <span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">dcx</span><span class="p">)</span>

    <span class="n">papprox</span><span class="o">=</span><span class="mf">0.d0</span>
    <span class="n">tot_denn</span><span class="o">=</span><span class="mf">0.d0</span>
    <span class="k">do </span><span class="n">ic</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span>
        <span class="k">call </span><span class="n">ind2sub</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">ic</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span> <span class="n">j</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">ind</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">plasma</span><span class="p">%</span><span class="n">in_plasma</span><span class="p">)</span> <span class="k">cycle</span>
<span class="k">        </span><span class="n">tot_denn</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
                   <span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">half</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
                   <span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">third</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
        <span class="n">papprox</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">=</span> <span class="n">tot_denn</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">plasma</span><span class="p">%</span><span class="n">deni</span><span class="p">)</span>
    <span class="k">enddo</span>

<span class="k">    </span><span class="n">ncell</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">do </span><span class="n">ic</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span>
        <span class="k">call </span><span class="n">ind2sub</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">ic</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span> <span class="n">j</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">papprox</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">ncell</span> <span class="o">=</span> <span class="n">ncell</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">cell_ind</span><span class="p">(</span><span class="n">ncell</span><span class="p">)</span> <span class="o">=</span> <span class="n">ic</span>
        <span class="k">endif</span>
<span class="k">    enddo</span>

<span class="k">    call </span><span class="n">get_nlaunch</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_dcx</span><span class="p">,</span><span class="n">papprox</span><span class="p">,</span><span class="n">nlaunch</span><span class="p">)</span>

    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">       write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i10)&#39;</span><span class="p">)</span> <span class="nb">sum</span><span class="p">(</span><span class="n">nlaunch</span><span class="p">)</span>
    <span class="k">endif</span>
    <span class="c">!$OMP PARALLEL DO schedule(dynamic,1) private(i,j,k,ic,is,idcx,ind,vihalo, &amp;</span>
    <span class="c">!$OMP&amp; ri,tracks,ntrack,rates,denn,states,jj,photons,plasma,fi_correction)</span>
    <span class="n">loop_over_cells</span><span class="p">:</span> <span class="k">do </span><span class="n">ic</span> <span class="o">=</span> <span class="n">istart</span><span class="p">,</span> <span class="n">ncell</span><span class="p">,</span> <span class="n">istep</span>
        <span class="k">call </span><span class="n">ind2sub</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">cell_ind</span><span class="p">(</span><span class="n">ic</span><span class="p">),</span><span class="n">ind</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span> <span class="n">j</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">loop_over_species</span><span class="p">:</span> <span class="k">do is</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_thermal</span> <span class="c">!This loop has to come first</span>
            <span class="c">!! Loop over the markers</span>
            <span class="n">loop_over_dcx</span><span class="p">:</span> <span class="k">do </span><span class="n">idcx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
                <span class="c">!! Calculate ri,vhalo and track</span>
                <span class="k">call </span><span class="n">mc_beam_grid</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">ri</span><span class="p">)</span>
                <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">)</span>
                <span class="k">call </span><span class="n">mc_halo</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span> <span class="n">thermal_mass</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="n">vihalo</span><span class="p">)</span>
                <span class="k">call </span><span class="n">track</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">vihalo</span><span class="p">,</span><span class="n">tracks</span><span class="p">,</span><span class="n">ntrack</span><span class="p">)</span>
                <span class="k">if</span><span class="p">(</span><span class="n">ntrack</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">loop_over_dcx</span>

                <span class="c">!! Calculate CX probability</span>
                <span class="k">call </span><span class="n">get_total_cx_rate</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">ind</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">vihalo</span><span class="p">,</span> <span class="n">neut_types</span><span class="p">,</span> <span class="n">rates</span><span class="p">)</span>
                <span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span> <span class="k">cycle </span><span class="n">loop_over_dcx</span>

                <span class="c">!! Solve collisional radiative model along track</span>
                <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">tracks</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">pos</span><span class="p">)</span>

                <span class="c">!! Weight CX rates by ion source density</span>
                <span class="k">if</span><span class="p">(</span><span class="n">beam_mass</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">thermal_mass</span><span class="p">(</span><span class="k">is</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                    </span><span class="n">states</span> <span class="o">=</span> <span class="n">rates</span><span class="o">*</span><span class="p">(</span><span class="n">plasma</span><span class="p">%</span><span class="n">deni</span><span class="p">(</span><span class="k">is</span><span class="p">)</span> <span class="o">+</span> <span class="n">plasma</span><span class="p">%</span><span class="n">denf</span><span class="p">)</span>
                    <span class="n">fi_correction</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">plasma</span><span class="p">%</span><span class="n">deni</span><span class="p">(</span><span class="k">is</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">plasma</span><span class="p">%</span><span class="n">deni</span><span class="p">(</span><span class="k">is</span><span class="p">)</span><span class="o">+</span><span class="n">plasma</span><span class="p">%</span><span class="n">denf</span><span class="p">),</span><span class="mf">0.d0</span><span class="p">)</span>
                <span class="k">else</span>
<span class="k">                    </span><span class="n">states</span> <span class="o">=</span> <span class="n">rates</span><span class="o">*</span><span class="n">plasma</span><span class="p">%</span><span class="n">deni</span><span class="p">(</span><span class="k">is</span><span class="p">)</span>
                    <span class="n">fi_correction</span> <span class="o">=</span> <span class="mf">1.d0</span>
                <span class="k">endif</span>
<span class="k">                if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">loop_over_dcx</span>

                <span class="n">loop_along_track</span><span class="p">:</span> <span class="k">do </span><span class="n">jj</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ntrack</span>
                    <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">)</span>
                    <span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">plasma</span><span class="p">%</span><span class="n">in_plasma</span><span class="p">)</span> <span class="k">exit </span><span class="n">loop_along_track</span>
                    <span class="k">call </span><span class="n">colrad</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">thermal_mass</span><span class="p">(</span><span class="k">is</span><span class="p">),</span><span class="n">vihalo</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="nb">time</span><span class="p">,</span><span class="n">states</span><span class="p">,</span><span class="n">denn</span><span class="p">,</span><span class="n">photons</span><span class="p">)</span>
                    <span class="k">call </span><span class="n">store_neutrals</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">ind</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span><span class="n">vihalo</span><span class="p">,</span><span class="n">dcx_type</span><span class="p">,</span><span class="n">denn</span><span class="o">/</span><span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>

                    <span class="k">if</span><span class="p">((</span><span class="n">photons</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_dcx</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                        </span><span class="n">photons</span> <span class="o">=</span> <span class="n">fi_correction</span><span class="o">*</span><span class="n">photons</span> <span class="c">!! Correct for including fast-ions in states</span>
                        <span class="k">call </span><span class="n">store_photons</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span><span class="n">vihalo</span><span class="p">,</span> <span class="n">thermal_lambda0</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="n">photons</span><span class="o">/</span><span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">spec</span><span class="p">%</span><span class="n">dcx</span><span class="p">(:,:,:,</span><span class="k">is</span><span class="p">))</span>
                    <span class="k">endif</span>
<span class="k">                enddo </span><span class="n">loop_along_track</span>
            <span class="k">enddo </span><span class="n">loop_over_dcx</span>
        <span class="k">enddo </span><span class="n">loop_over_species</span>
    <span class="k">enddo </span><span class="n">loop_over_cells</span>
    <span class="c">!$OMP END PARALLEL DO</span>

<span class="cp">#ifdef _MPI</span>
    <span class="c">!! Combine densities</span>
    <span class="k">call </span><span class="n">parallel_merge_populations</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">dcx</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_dcx</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">dcx</span><span class="p">)</span>
    <span class="k">endif</span>
<span class="cp">#endif</span>

    <span class="n">dcx_dens</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">dcx</span><span class="p">%</span><span class="n">dens</span><span class="p">)</span>
    <span class="k">if</span><span class="p">((</span><span class="n">dcx_dens</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">).</span><span class="nb">or</span><span class="p">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">dcx_dens</span><span class="p">))</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;DCX: DCX density is zero or nan: &#39;</span><span class="p">,</span> <span class="n">dcx_dens</span>
        <span class="k">stop</span>
<span class="k">    endif</span>

<span class="k">end subroutine </span><span class="n">dcx</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> FIDASIM was developed by Luke Stagner</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>