<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="">
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>fida_mc &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>User Guide</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>fida_mc
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.5% of total for procedures.">68 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
     <li><a href='../module/libfida.html'>libfida</a></li>
     <li class="active">fida_mc</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/fida_mc.html#src">fida_mc</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public subroutine fida_mc()</h2>
    

    <p>Calculate Active FIDA emission using a Monte Carlo Fast-ion distribution</p>

    <h3>Arguments</h3>
    <em>None</em>
    <br>
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~fida_mc~~CallsGraph Pages: 1 -->
<svg id="procfida_mcCallsGraph" width="641pt" height="929pt"
 viewBox="0.00 0.00 641.00 929.22" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~fida_mc~~CallsGraph" class="graph" transform="scale(0.750585 0.750585) rotate(0) translate(4 1234)">
<title>proc~~fida_mc~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1234 850,-1234 850,4 -4,4"/>
<!-- proc~fida_mc -->
<g id="proc~~fida_mc~~CallsGraph_node1" class="node"><title>proc~fida_mc</title>
<polygon fill="none" stroke="black" points="54,-622 0,-622 0,-598 54,-598 54,-622"/>
<text text-anchor="middle" x="27" y="-607.6" font-family="Helvetica,sans-Serif" font-size="10.50">fida_mc</text>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~fida_mc~~CallsGraph_node2" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~fida_mc~~CallsGraph_node2"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="178.5,-1017 105.5,-1017 105.5,-993 178.5,-993 178.5,-1017"/>
<text text-anchor="middle" x="142" y="-1002.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;interface~parallel_sum -->
<g id="proc~~fida_mc~~CallsGraph_edge1" class="edge"><title>proc~fida_mc&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M31.5058,-622.255C47.5217,-678.239 113.845,-910.079 134.696,-982.965"/>
<polygon fill="#000000" stroke="#000000" points="131.42,-984.237 137.535,-992.888 138.15,-982.311 131.42,-984.237"/>
</g>
<!-- interface~randu -->
<g id="proc~~fida_mc~~CallsGraph_node3" class="node"><title>interface~randu</title>
<g id="a_proc~~fida_mc~~CallsGraph_node3"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="303,-807 249,-807 249,-783 303,-783 303,-807"/>
<text text-anchor="middle" x="276" y="-792.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;interface~randu -->
<g id="proc~~fida_mc~~CallsGraph_edge2" class="edge"><title>proc~fida_mc&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M29.5589,-622.157C33.7912,-649.924 48.138,-718.276 90,-753 132.325,-788.108 198.135,-795.286 238.792,-796.033"/>
<polygon fill="#000000" stroke="#000000" points="238.784,-799.533 248.806,-796.096 238.828,-792.533 238.784,-799.533"/>
</g>
<!-- proc~get_total_cx_rate -->
<g id="proc~~fida_mc~~CallsGraph_node4" class="node"><title>proc~get_total_cx_rate</title>
<g id="a_proc~~fida_mc~~CallsGraph_node4"><a xlink:href=".././proc/get_total_cx_rate.html" xlink:title="get_total_cx_rate">
<polygon fill="#d9534f" stroke="#d9534f" points="189.5,-399 94.5,-399 94.5,-375 189.5,-375 189.5,-399"/>
<text text-anchor="middle" x="142" y="-384.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_total_cx_rate</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~get_total_cx_rate -->
<g id="proc~~fida_mc~~CallsGraph_edge3" class="edge"><title>proc~fida_mc&#45;&gt;proc~get_total_cx_rate</title>
<path fill="none" stroke="#000000" d="M28.6417,-597.825C31.0081,-564.403 41.8341,-469.939 90,-413 92.6326,-409.888 95.7308,-407.106 99.0778,-404.627"/>
<polygon fill="#000000" stroke="#000000" points="101.234,-407.404 107.787,-399.078 97.4723,-401.5 101.234,-407.404"/>
</g>
<!-- proc~track -->
<g id="proc~~fida_mc~~CallsGraph_node5" class="node"><title>proc~track</title>
<g id="a_proc~~fida_mc~~CallsGraph_node5"><a xlink:href=".././proc/track.html" xlink:title="track">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-643 249,-643 249,-619 303,-619 303,-643"/>
<text text-anchor="middle" x="276" y="-628.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~track -->
<g id="proc~~fida_mc~~CallsGraph_edge4" class="edge"><title>proc~fida_mc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M54.4333,-612.247C98.8169,-616.021 188.384,-623.636 238.656,-627.91"/>
<polygon fill="#000000" stroke="#000000" points="238.496,-631.409 248.757,-628.769 239.089,-624.434 238.496,-631.409"/>
</g>
<!-- proc~store_fida_photons -->
<g id="proc~~fida_mc~~CallsGraph_node6" class="node"><title>proc~store_fida_photons</title>
<g id="a_proc~~fida_mc~~CallsGraph_node6"><a xlink:href=".././proc/store_fida_photons.html" xlink:title="store_fida_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="194,-562 90,-562 90,-538 194,-538 194,-562"/>
<text text-anchor="middle" x="142" y="-547.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_fida_photons</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~store_fida_photons -->
<g id="proc~~fida_mc~~CallsGraph_edge5" class="edge"><title>proc~fida_mc&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M49.72,-597.88C61.5771,-591.317 76.544,-583.117 90,-576 95.7652,-572.951 101.926,-569.756 107.901,-566.691"/>
<polygon fill="#000000" stroke="#000000" points="109.736,-569.684 117.053,-562.021 106.555,-563.449 109.736,-569.684"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~fida_mc~~CallsGraph_node7" class="node"><title>proc~get_fields</title>
<g id="a_proc~~fida_mc~~CallsGraph_node7"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="454,-601 396,-601 396,-577 454,-577 454,-601"/>
<text text-anchor="middle" x="425" y="-586.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~get_fields -->
<g id="proc~~fida_mc~~CallsGraph_edge6" class="edge"><title>proc~fida_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M54.2893,-608.606C122.567,-604.985 305.757,-595.27 385.749,-591.028"/>
<polygon fill="#000000" stroke="#000000" points="386.079,-594.516 395.88,-590.491 385.708,-587.526 386.079,-594.516"/>
</g>
<!-- proc~gyro_correction -->
<g id="proc~~fida_mc~~CallsGraph_node8" class="node"><title>proc~gyro_correction</title>
<g id="a_proc~~fida_mc~~CallsGraph_node8"><a xlink:href=".././proc/gyro_correction.html" xlink:title="gyro_correction">
<polygon fill="#d9534f" stroke="#d9534f" points="185.5,-744 98.5,-744 98.5,-720 185.5,-720 185.5,-744"/>
<text text-anchor="middle" x="142" y="-729.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_correction</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~gyro_correction -->
<g id="proc~~fida_mc~~CallsGraph_edge7" class="edge"><title>proc~fida_mc&#45;&gt;proc~gyro_correction</title>
<path fill="none" stroke="#000000" d="M37.1896,-622.113C48.896,-637.302 70.0135,-663.908 90,-685 99.0958,-694.599 109.774,-704.612 119.003,-712.918"/>
<polygon fill="#000000" stroke="#000000" points="116.863,-715.698 126.663,-719.723 121.512,-710.465 116.863,-715.698"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~fida_mc~~CallsGraph_node9" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~fida_mc~~CallsGraph_node9"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="459,-765 391,-765 391,-741 459,-741 459,-765"/>
<text text-anchor="middle" x="425" y="-750.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~get_plasma -->
<g id="proc~~fida_mc~~CallsGraph_edge8" class="edge"><title>proc~fida_mc&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M54.0189,-620.406C65.0223,-624.61 78.0379,-629.325 90,-633 191.496,-664.182 231.567,-634.363 322,-690 342.94,-702.883 337.504,-718.422 358,-732 364.984,-736.627 373.055,-740.291 381.104,-743.173"/>
<polygon fill="#000000" stroke="#000000" points="380.245,-746.574 390.837,-746.313 382.395,-739.912 380.245,-746.574"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~fida_mc~~CallsGraph_node10" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~fida_mc~~CallsGraph_node10"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="846,-559 778,-559 778,-535 846,-535 846,-559"/>
<text text-anchor="middle" x="812" y="-544.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~fida_mc~~CallsGraph_edge9" class="edge"><title>proc~fida_mc&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M35.106,-597.751C45.4668,-580.691 66.1088,-549.564 90,-529 161.162,-467.75 181.109,-427 275,-427 275,-427 275,-427 579,-427 653.811,-427 678.197,-429.938 742,-469 765.635,-483.47 785.704,-508.576 798.004,-526.393"/>
<polygon fill="#000000" stroke="#000000" points="795.248,-528.569 803.705,-534.951 801.074,-524.688 795.248,-528.569"/>
</g>
<!-- proc~colrad -->
<g id="proc~~fida_mc~~CallsGraph_node11" class="node"><title>proc~colrad</title>
<g id="a_proc~~fida_mc~~CallsGraph_node11"><a xlink:href=".././proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="169,-306 115,-306 115,-282 169,-282 169,-306"/>
<text text-anchor="middle" x="142" y="-291.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~colrad -->
<g id="proc~~fida_mc~~CallsGraph_edge10" class="edge"><title>proc~fida_mc&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M29.4901,-597.794C34.2899,-561.194 51.3403,-449.728 90,-366 98.721,-347.112 112.543,-328.001 123.598,-314.219"/>
<polygon fill="#000000" stroke="#000000" points="126.401,-316.321 130.054,-306.376 120.997,-311.872 126.401,-316.321"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~fida_mc~~CallsGraph_node12" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~fida_mc~~CallsGraph_node12"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="321.5,-975 230.5,-975 230.5,-951 321.5,-951 321.5,-975"/>
<text text-anchor="middle" x="276" y="-960.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~fida_mc~~CallsGraph_edge13" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M178.721,-993.634C193.643,-988.886 211.202,-983.299 227.21,-978.206"/>
<polygon fill="#000000" stroke="#000000" points="228.471,-981.478 236.939,-975.11 226.349,-974.807 228.471,-981.478"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~fida_mc~~CallsGraph_node13" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~fida_mc~~CallsGraph_node13"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="320,-1186 232,-1186 232,-1162 320,-1162 320,-1186"/>
<text text-anchor="middle" x="276" y="-1171.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~fida_mc~~CallsGraph_edge14" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M147.868,-1017.1C159.015,-1043.59 188.648,-1107.57 230,-1148 233.049,-1150.98 236.505,-1153.75 240.114,-1156.28"/>
<polygon fill="#000000" stroke="#000000" points="238.379,-1159.32 248.695,-1161.74 242.138,-1153.41 238.379,-1159.32"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~fida_mc~~CallsGraph_node14" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~fida_mc~~CallsGraph_node14"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="469,-1099 381,-1099 381,-1075 469,-1075 469,-1099"/>
<text text-anchor="middle" x="425" y="-1084.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~fida_mc~~CallsGraph_edge16" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M155.266,-1017.23C171.043,-1032.1 200.006,-1056.64 230,-1068 275.415,-1085.21 330.876,-1089.09 370.85,-1089.19"/>
<polygon fill="#000000" stroke="#000000" points="370.939,-1092.69 380.919,-1089.13 370.9,-1085.69 370.939,-1092.69"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~fida_mc~~CallsGraph_node18" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~fida_mc~~CallsGraph_node18"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="320,-1139 232,-1139 232,-1115 320,-1115 320,-1139"/>
<text text-anchor="middle" x="276" y="-1124.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~fida_mc~~CallsGraph_edge12" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M151.893,-1017.02C166.607,-1036.37 197.624,-1074.86 230,-1101 233.751,-1104.03 237.897,-1106.93 242.11,-1109.61"/>
<polygon fill="#000000" stroke="#000000" points="240.373,-1112.65 250.745,-1114.82 243.985,-1106.66 240.373,-1112.65"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~fida_mc~~CallsGraph_node19" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~fida_mc~~CallsGraph_node19"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="470.5,-925 379.5,-925 379.5,-901 470.5,-901 470.5,-925"/>
<text text-anchor="middle" x="425" y="-910.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~fida_mc~~CallsGraph_edge15" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M155.64,-992.762C171.577,-978.113 200.476,-954.052 230,-942 274.667,-923.767 329.308,-916.833 369.205,-914.276"/>
<polygon fill="#000000" stroke="#000000" points="369.488,-917.766 379.273,-913.703 369.09,-910.777 369.488,-917.766"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~fida_mc~~CallsGraph_node20" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~fida_mc~~CallsGraph_node20"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="321.5,-895 230.5,-895 230.5,-871 321.5,-871 321.5,-895"/>
<text text-anchor="middle" x="276" y="-880.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~fida_mc~~CallsGraph_edge17" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M151.893,-992.975C166.607,-973.634 197.624,-935.14 230,-909 233.751,-905.971 237.897,-903.074 242.11,-900.385"/>
<polygon fill="#000000" stroke="#000000" points="243.985,-903.342 250.745,-895.184 240.373,-897.346 243.985,-903.342"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~fida_mc~~CallsGraph_node22" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~fida_mc~~CallsGraph_node22"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="320,-1059 232,-1059 232,-1035 320,-1035 320,-1059"/>
<text text-anchor="middle" x="276" y="-1044.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~fida_mc~~CallsGraph_edge20" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M178.721,-1016.37C193.643,-1021.11 211.202,-1026.7 227.21,-1031.79"/>
<polygon fill="#000000" stroke="#000000" points="226.349,-1035.19 236.939,-1034.89 228.471,-1028.52 226.349,-1035.19"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~fida_mc~~CallsGraph_node23" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~fida_mc~~CallsGraph_node23"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="321.5,-853 230.5,-853 230.5,-829 321.5,-829 321.5,-853"/>
<text text-anchor="middle" x="276" y="-838.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~fida_mc~~CallsGraph_edge11" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M147.612,-992.627C158.247,-965.591 186.923,-900.583 230,-862 231.325,-860.814 232.728,-859.682 234.188,-858.604"/>
<polygon fill="#000000" stroke="#000000" points="236.452,-861.314 243.033,-853.011 232.711,-855.398 236.452,-861.314"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~fida_mc~~CallsGraph_node26" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~fida_mc~~CallsGraph_node26"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="321.5,-1017 230.5,-1017 230.5,-993 321.5,-993 321.5,-1017"/>
<text text-anchor="middle" x="276" y="-1002.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~fida_mc~~CallsGraph_edge18" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M178.721,-1005C191.501,-1005 206.214,-1005 220.231,-1005"/>
<polygon fill="#000000" stroke="#000000" points="220.276,-1008.5 230.276,-1005 220.276,-1001.5 220.276,-1008.5"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~fida_mc~~CallsGraph_node28" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~fida_mc~~CallsGraph_node28"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="321.5,-1230 230.5,-1230 230.5,-1206 321.5,-1206 321.5,-1230"/>
<text text-anchor="middle" x="276" y="-1215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~fida_mc~~CallsGraph_edge19" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M145.633,-1017.26C153.232,-1050.01 178.053,-1140.77 230,-1195 231.805,-1196.89 233.799,-1198.64 235.913,-1200.28"/>
<polygon fill="#000000" stroke="#000000" points="234.246,-1203.37 244.515,-1205.98 238.113,-1197.54 234.246,-1203.37"/>
</g>
<!-- proc~neutral_cx_rate -->
<g id="proc~~fida_mc~~CallsGraph_node33" class="node"><title>proc~neutral_cx_rate</title>
<g id="a_proc~~fida_mc~~CallsGraph_node33"><a xlink:href=".././proc/neutral_cx_rate.html" xlink:title="neutral_cx_rate">
<polygon fill="#d9534f" stroke="#d9534f" points="319.5,-399 232.5,-399 232.5,-375 319.5,-375 319.5,-399"/>
<text text-anchor="middle" x="276" y="-384.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutral_cx_rate</text>
</a>
</g>
</g>
<!-- proc~get_total_cx_rate&#45;&gt;proc~neutral_cx_rate -->
<g id="proc~~fida_mc~~CallsGraph_edge21" class="edge"><title>proc~get_total_cx_rate&#45;&gt;proc~neutral_cx_rate</title>
<path fill="none" stroke="#000000" d="M189.538,-387C200.113,-387 211.42,-387 222.233,-387"/>
<polygon fill="#000000" stroke="#000000" points="222.408,-390.5 232.408,-387 222.408,-383.5 222.408,-390.5"/>
</g>
<!-- proc~track&#45;&gt;proc~get_fields -->
<g id="proc~~fida_mc~~CallsGraph_edge25" class="edge"><title>proc~track&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M303.281,-623.491C326.319,-616.909 360.09,-607.26 386.059,-599.84"/>
<polygon fill="#000000" stroke="#000000" points="387.291,-603.128 395.945,-597.016 385.368,-596.398 387.291,-603.128"/>
</g>
<!-- proc~track&#45;&gt;proc~get_plasma -->
<g id="proc~~fida_mc~~CallsGraph_edge26" class="edge"><title>proc~track&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M303.201,-642.638C309.918,-646.506 316.727,-651.308 322,-657 347.127,-684.124 330.097,-707.74 358,-732 364.587,-737.727 372.746,-741.895 381.055,-744.927"/>
<polygon fill="#000000" stroke="#000000" points="380.203,-748.328 390.793,-747.99 382.304,-741.651 380.203,-748.328"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~fida_mc~~CallsGraph_node15" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~fida_mc~~CallsGraph_node15"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="608.5,-679 547.5,-679 547.5,-655 608.5,-655 608.5,-679"/>
<text text-anchor="middle" x="578" y="-664.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~in_plasma -->
<g id="proc~~fida_mc~~CallsGraph_edge22" class="edge"><title>proc~track&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M303.003,-639.053C318.762,-643.604 339.359,-648.972 358,-652 420.163,-662.097 493.327,-665.409 537.386,-666.488"/>
<polygon fill="#000000" stroke="#000000" points="537.327,-669.988 547.401,-666.707 537.48,-662.989 537.327,-669.988"/>
</g>
<!-- proc~get_indices -->
<g id="proc~~fida_mc~~CallsGraph_node27" class="node"><title>proc~get_indices</title>
<g id="a_proc~~fida_mc~~CallsGraph_node27"><a xlink:href=".././proc/get_indices.html" xlink:title="get_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="458.5,-643 391.5,-643 391.5,-619 458.5,-619 458.5,-643"/>
<text text-anchor="middle" x="425" y="-628.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_indices</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~get_indices -->
<g id="proc~~fida_mc~~CallsGraph_edge23" class="edge"><title>proc~track&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M303.281,-631C324.91,-631 356.001,-631 381.213,-631"/>
<polygon fill="#000000" stroke="#000000" points="381.259,-634.5 391.259,-631 381.259,-627.5 381.259,-634.5"/>
</g>
<!-- proc~doppler_stark -->
<g id="proc~~fida_mc~~CallsGraph_node30" class="node"><title>proc~doppler_stark</title>
<g id="a_proc~~fida_mc~~CallsGraph_node30"><a xlink:href=".././proc/doppler_stark.html" xlink:title="doppler_stark">
<polygon fill="#d9534f" stroke="#d9534f" points="464,-723 386,-723 386,-699 464,-699 464,-723"/>
<text text-anchor="middle" x="425" y="-708.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">doppler_stark</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~doppler_stark -->
<g id="proc~~fida_mc~~CallsGraph_edge24" class="edge"><title>proc~track&#45;&gt;proc~doppler_stark</title>
<path fill="none" stroke="#000000" d="M299.341,-643.105C306.69,-647.298 314.814,-652.163 322,-657 338.815,-668.319 340.391,-674.961 358,-685 364.399,-688.648 371.411,-692.011 378.4,-695.023"/>
<polygon fill="#000000" stroke="#000000" points="377.276,-698.345 387.856,-698.905 379.935,-691.869 377.276,-698.345"/>
</g>
<!-- proc~store_photons -->
<g id="proc~~fida_mc~~CallsGraph_node32" class="node"><title>proc~store_photons</title>
<g id="a_proc~~fida_mc~~CallsGraph_node32"><a xlink:href=".././proc/store_photons.html" xlink:title="store_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="316.5,-561 235.5,-561 235.5,-537 316.5,-537 316.5,-561"/>
<text text-anchor="middle" x="276" y="-546.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_photons</text>
</a>
</g>
</g>
<!-- proc~store_fida_photons&#45;&gt;proc~store_photons -->
<g id="proc~~fida_mc~~CallsGraph_edge27" class="edge"><title>proc~store_fida_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M194.035,-549.613C204.157,-549.537 214.776,-549.456 224.868,-549.38"/>
<polygon fill="#000000" stroke="#000000" points="225.179,-552.878 235.152,-549.302 225.126,-545.878 225.179,-552.878"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~fida_mc~~CallsGraph_edge31" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M454.358,-581.365C474.703,-576.193 502.85,-569.657 528,-566 612.234,-553.751 711.744,-549.381 767.494,-547.834"/>
<polygon fill="#000000" stroke="#000000" points="767.806,-551.328 777.712,-547.569 767.625,-544.33 767.806,-551.328"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~fida_mc~~CallsGraph_edge29" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M454.321,-595.314C466.392,-598.678 480.348,-603.49 492,-610 510.433,-620.298 510.566,-629.089 528,-641 532.622,-644.158 537.671,-647.222 542.715,-650.072"/>
<polygon fill="#000000" stroke="#000000" points="541.237,-653.252 551.696,-654.946 544.576,-647.1 541.237,-653.252"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~fida_mc~~CallsGraph_node21" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~fida_mc~~CallsGraph_node21"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="628,-599 528,-599 528,-575 628,-575 628,-599"/>
<text text-anchor="middle" x="578" y="-584.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~fida_mc~~CallsGraph_edge30" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M454.048,-588.629C471.866,-588.393 495.614,-588.078 517.486,-587.788"/>
<polygon fill="#000000" stroke="#000000" points="517.753,-591.285 527.706,-587.653 517.66,-584.286 517.753,-591.285"/>
</g>
<!-- proc~get_position -->
<g id="proc~~fida_mc~~CallsGraph_node24" class="node"><title>proc~get_position</title>
<g id="a_proc~~fida_mc~~CallsGraph_node24"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="613,-759 543,-759 543,-735 613,-735 613,-759"/>
<text text-anchor="middle" x="578" y="-744.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~fida_mc~~CallsGraph_edge28" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M454.245,-592.69C467.012,-595.592 481.543,-600.769 492,-610 520.623,-635.268 507.63,-655.707 528,-688 536.717,-701.82 548.337,-715.948 558.073,-726.913"/>
<polygon fill="#000000" stroke="#000000" points="555.76,-729.572 565.072,-734.624 560.943,-724.867 555.76,-729.572"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~fida_mc~~CallsGraph_node34" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~fida_mc~~CallsGraph_node34"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="737,-659 669,-659 669,-635 737,-635 737,-659"/>
<text text-anchor="middle" x="703" y="-644.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~fida_mc~~CallsGraph_edge32" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M454.24,-594.934C502.713,-605.121 602.03,-625.992 659.101,-637.985"/>
<polygon fill="#000000" stroke="#000000" points="658.398,-641.414 668.904,-640.045 659.838,-634.563 658.398,-641.414"/>
</g>
<!-- proc~gyro_correction&#45;&gt;interface~randu -->
<g id="proc~~fida_mc~~CallsGraph_edge33" class="edge"><title>proc~gyro_correction&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M167.709,-744.035C185.1,-752.48 208.939,-764.003 230,-774 233.132,-775.487 236.391,-777.025 239.66,-778.561"/>
<polygon fill="#000000" stroke="#000000" points="238.258,-781.77 248.798,-782.843 241.228,-775.431 238.258,-781.77"/>
</g>
<!-- proc~gyro_step -->
<g id="proc~~fida_mc~~CallsGraph_node17" class="node"><title>proc~gyro_step</title>
<g id="a_proc~~fida_mc~~CallsGraph_node17"><a xlink:href=".././proc/gyro_step.html" xlink:title="gyro_step">
<polygon fill="#d9534f" stroke="#d9534f" points="306,-765 246,-765 246,-741 306,-741 306,-765"/>
<text text-anchor="middle" x="276" y="-750.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_step</text>
</a>
</g>
</g>
<!-- proc~gyro_correction&#45;&gt;proc~gyro_step -->
<g id="proc~~fida_mc~~CallsGraph_edge35" class="edge"><title>proc~gyro_correction&#45;&gt;proc~gyro_step</title>
<path fill="none" stroke="#000000" d="M185.857,-738.818C201.912,-741.372 220.06,-744.26 235.771,-746.759"/>
<polygon fill="#000000" stroke="#000000" points="235.272,-750.223 245.697,-748.338 236.371,-743.31 235.272,-750.223"/>
</g>
<!-- proc~pitch_to_vec -->
<g id="proc~~fida_mc~~CallsGraph_node31" class="node"><title>proc~pitch_to_vec</title>
<g id="a_proc~~fida_mc~~CallsGraph_node31"><a xlink:href=".././proc/pitch_to_vec.html" xlink:title="pitch_to_vec">
<polygon fill="#d9534f" stroke="#d9534f" points="312.5,-723 239.5,-723 239.5,-699 312.5,-699 312.5,-723"/>
<text text-anchor="middle" x="276" y="-708.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pitch_to_vec</text>
</a>
</g>
</g>
<!-- proc~gyro_correction&#45;&gt;proc~pitch_to_vec -->
<g id="proc~~fida_mc~~CallsGraph_edge34" class="edge"><title>proc~gyro_correction&#45;&gt;proc~pitch_to_vec</title>
<path fill="none" stroke="#000000" d="M185.857,-725.182C199.789,-722.965 215.297,-720.498 229.421,-718.251"/>
<polygon fill="#000000" stroke="#000000" points="230.093,-721.688 239.419,-716.661 228.993,-714.775 230.093,-721.688"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~fida_mc~~CallsGraph_edge37" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M459.047,-763.769C500.082,-775.295 571.557,-789.248 628,-768 721.6,-732.765 780.942,-616.87 802.192,-568.502"/>
<polygon fill="#000000" stroke="#000000" points="805.539,-569.575 806.252,-559.004 799.103,-566.823 805.539,-569.575"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~fida_mc~~CallsGraph_edge36" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M459.028,-746.106C470.056,-742.887 482.058,-738.326 492,-732 511.901,-719.336 509.316,-707.4 528,-693 532.137,-689.812 536.72,-686.807 541.375,-684.052"/>
<polygon fill="#000000" stroke="#000000" points="543.279,-686.998 550.316,-679.078 539.876,-680.881 543.279,-686.998"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~fida_mc~~CallsGraph_edge38" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M459.138,-751.683C480.766,-750.824 509.252,-749.692 532.801,-748.756"/>
<polygon fill="#000000" stroke="#000000" points="533.04,-752.25 542.893,-748.355 532.762,-745.255 533.04,-752.25"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~fida_mc~~CallsGraph_edge39" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M459.247,-742.456C469.73,-739.122 481.352,-735.416 492,-732 552.492,-712.591 569.722,-713.29 628,-688 643.654,-681.207 660.342,-672.134 673.901,-664.251"/>
<polygon fill="#000000" stroke="#000000" points="675.91,-667.129 682.736,-659.026 672.347,-661.104 675.91,-667.129"/>
</g>
<!-- proc~eigen -->
<g id="proc~~fida_mc~~CallsGraph_node16" class="node"><title>proc~eigen</title>
<g id="a_proc~~fida_mc~~CallsGraph_node16"><a xlink:href=".././proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-255 249,-255 249,-231 303,-231 303,-255"/>
<text text-anchor="middle" x="276" y="-240.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~fida_mc~~CallsGraph_edge41" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M169.079,-283.924C189.237,-276.136 217.354,-265.272 239.554,-256.695"/>
<polygon fill="#000000" stroke="#000000" points="240.909,-259.924 248.975,-253.055 238.386,-253.394 240.909,-259.924"/>
</g>
<!-- proc~linsolve -->
<g id="proc~~fida_mc~~CallsGraph_node25" class="node"><title>proc~linsolve</title>
<g id="a_proc~~fida_mc~~CallsGraph_node25"><a xlink:href=".././proc/linsolve.html" xlink:title="linsolve">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-87 249,-87 249,-63 303,-63 303,-87"/>
<text text-anchor="middle" x="276" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linsolve</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~linsolve -->
<g id="proc~~fida_mc~~CallsGraph_edge42" class="edge"><title>proc~colrad&#45;&gt;proc~linsolve</title>
<path fill="none" stroke="#000000" d="M150.285,-281.914C171.831,-246.167 235.43,-140.65 262.536,-95.6793"/>
<polygon fill="#000000" stroke="#000000" points="265.573,-97.4203 267.738,-87.049 259.578,-93.8068 265.573,-97.4203"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~fida_mc~~CallsGraph_node29" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~fida_mc~~CallsGraph_node29"><a xlink:href=".././proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="622,-357 534,-357 534,-333 622,-333 622,-357"/>
<text text-anchor="middle" x="578" y="-342.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~fida_mc~~CallsGraph_edge40" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M169.065,-298.607C209.431,-305.603 289.554,-318.944 358,-327 414.415,-333.64 479.293,-338.645 523.704,-341.671"/>
<polygon fill="#000000" stroke="#000000" points="523.483,-345.164 533.695,-342.342 523.952,-338.18 523.483,-345.164"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~fida_mc~~CallsGraph_edge43" class="edge"><title>proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M312.585,-950.896C332.553,-944.104 357.664,-935.563 378.989,-928.31"/>
<polygon fill="#000000" stroke="#000000" points="380.148,-931.613 388.489,-925.079 377.894,-924.985 380.148,-931.613"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_node38" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="617.5,-1040 538.5,-1040 538.5,-1016 617.5,-1016 617.5,-1040"/>
<text text-anchor="middle" x="578" y="-1025.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge44" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M321.583,-971.579C365.144,-980.09 433.28,-993.743 492,-1007 503.816,-1009.67 516.511,-1012.71 528.395,-1015.63"/>
<polygon fill="#000000" stroke="#000000" points="527.6,-1019.04 538.148,-1018.05 529.284,-1012.25 527.6,-1019.04"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge45" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M320.242,-1178.6C366.139,-1181.35 439.193,-1179.47 492,-1148 530.479,-1125.07 556.14,-1077.2 568.479,-1049.35"/>
<polygon fill="#000000" stroke="#000000" points="571.729,-1050.65 572.421,-1040.08 565.287,-1047.91 571.729,-1050.65"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~fida_mc~~CallsGraph_edge46" class="edge"><title>proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M400.529,-1099.01C391.984,-1107.97 400.141,-1117 425,-1117 440.149,-1117 449.095,-1113.65 451.839,-1109"/>
<polygon fill="#000000" stroke="#000000" points="455.184,-1107.94 449.471,-1099.01 448.373,-1109.55 455.184,-1107.94"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge47" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M456.921,-1074.92C479.925,-1065.93 511.531,-1053.58 536.543,-1043.81"/>
<polygon fill="#000000" stroke="#000000" points="538.079,-1046.97 546.12,-1040.07 535.532,-1040.45 538.079,-1046.97"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~fida_mc~~CallsGraph_edge50" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M608.775,-662.159C623.73,-659.727 642.132,-656.735 658.624,-654.053"/>
<polygon fill="#000000" stroke="#000000" points="659.289,-657.491 668.598,-652.431 658.166,-650.582 659.289,-657.491"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~fida_mc~~CallsGraph_node45" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~fida_mc~~CallsGraph_node45"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="844.5,-819 779.5,-819 779.5,-795 844.5,-795 844.5,-819"/>
<text text-anchor="middle" x="812" y="-804.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~fida_mc~~CallsGraph_edge48" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M591.005,-679.327C601.68,-690.748 617.223,-708.555 628,-726 648.919,-759.862 630.676,-786.236 664,-808 694.946,-828.211 737.925,-825.234 769.418,-818.837"/>
<polygon fill="#000000" stroke="#000000" points="770.205,-822.248 779.21,-816.665 768.689,-815.414 770.205,-822.248"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~fida_mc~~CallsGraph_node49" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~fida_mc~~CallsGraph_node49"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="741.5,-399 664.5,-399 664.5,-375 741.5,-375 741.5,-399"/>
<text text-anchor="middle" x="703" y="-384.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~fida_mc~~CallsGraph_edge49" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M591.542,-654.981C602.578,-643.768 618.35,-626.092 628,-608 654.606,-558.119 645.856,-539.543 664,-486 673.157,-458.977 685.154,-428.388 693.197,-408.456"/>
<polygon fill="#000000" stroke="#000000" points="696.485,-409.661 697.006,-399.079 689.999,-407.027 696.485,-409.661"/>
</g>
<!-- proc~balback -->
<g id="proc~~fida_mc~~CallsGraph_node36" class="node"><title>proc~balback</title>
<g id="a_proc~~fida_mc~~CallsGraph_node36"><a xlink:href=".././proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="452,-192 398,-192 398,-168 452,-168 452,-192"/>
<text text-anchor="middle" x="425" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~fida_mc~~CallsGraph_edge51" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M297.847,-230.936C313.935,-221.936 336.93,-209.74 358,-201 367.663,-196.992 378.381,-193.283 388.32,-190.132"/>
<polygon fill="#000000" stroke="#000000" points="389.402,-193.461 397.933,-187.177 387.346,-186.77 389.402,-193.461"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~fida_mc~~CallsGraph_node37" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~fida_mc~~CallsGraph_node37"><a xlink:href=".././proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="452,-234 398,-234 398,-210 452,-210 452,-234"/>
<text text-anchor="middle" x="425" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~fida_mc~~CallsGraph_edge52" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M303.281,-239.246C326.902,-235.871 361.807,-230.885 388.016,-227.141"/>
<polygon fill="#000000" stroke="#000000" points="388.542,-230.601 397.947,-225.722 387.552,-223.671 388.542,-230.601"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~fida_mc~~CallsGraph_node41" class="node"><title>proc~elmhes</title>
<g id="a_proc~~fida_mc~~CallsGraph_node41"><a xlink:href=".././proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="452,-318 398,-318 398,-294 452,-294 452,-318"/>
<text text-anchor="middle" x="425" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~fida_mc~~CallsGraph_edge53" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M297.847,-255.064C313.935,-264.064 336.93,-276.26 358,-285 367.663,-289.008 378.381,-292.717 388.32,-295.868"/>
<polygon fill="#000000" stroke="#000000" points="387.346,-299.23 397.933,-298.823 389.402,-292.539 387.346,-299.23"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~fida_mc~~CallsGraph_node43" class="node"><title>proc~hqr2</title>
<g id="a_proc~~fida_mc~~CallsGraph_node43"><a xlink:href=".././proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="452,-150 398,-150 398,-126 452,-126 452,-150"/>
<text text-anchor="middle" x="425" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~fida_mc~~CallsGraph_edge54" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M285.54,-230.878C298.952,-212.704 326.679,-178.455 358,-159 367.116,-153.338 377.898,-149.071 388.076,-145.915"/>
<polygon fill="#000000" stroke="#000000" points="389.298,-149.207 397.969,-143.119 387.394,-142.471 389.298,-149.207"/>
</g>
<!-- proc~balance -->
<g id="proc~~fida_mc~~CallsGraph_node50" class="node"><title>proc~balance</title>
<g id="a_proc~~fida_mc~~CallsGraph_node50"><a xlink:href=".././proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="452,-276 398,-276 398,-252 452,-252 452,-276"/>
<text text-anchor="middle" x="425" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~fida_mc~~CallsGraph_edge55" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M303.281,-246.754C326.902,-250.129 361.807,-255.115 388.016,-258.859"/>
<polygon fill="#000000" stroke="#000000" points="387.552,-262.329 397.947,-260.278 388.542,-255.399 387.552,-262.329"/>
</g>
<!-- proc~cross_product -->
<g id="proc~~fida_mc~~CallsGraph_node39" class="node"><title>proc~cross_product</title>
<g id="a_proc~~fida_mc~~CallsGraph_node39"><a xlink:href=".././proc/cross_product.html" xlink:title="cross_product">
<polygon fill="#d94e8f" stroke="#d94e8f" points="465,-807 385,-807 385,-783 465,-783 465,-807"/>
<text text-anchor="middle" x="425" y="-792.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cross_product</text>
</a>
</g>
</g>
<!-- proc~gyro_step&#45;&gt;proc~cross_product -->
<g id="proc~~fida_mc~~CallsGraph_edge56" class="edge"><title>proc~gyro_step&#45;&gt;proc~cross_product</title>
<path fill="none" stroke="#000000" d="M306.042,-761.298C325.722,-766.921 352.212,-774.489 375.103,-781.03"/>
<polygon fill="#000000" stroke="#000000" points="374.419,-784.474 384.996,-783.856 376.342,-777.743 374.419,-784.474"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~fida_mc~~CallsGraph_edge57" class="edge"><title>proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M320.31,-1115.22C336.16,-1110.9 354.278,-1105.97 370.887,-1101.45"/>
<polygon fill="#000000" stroke="#000000" points="372.27,-1104.7 381,-1098.7 370.432,-1097.95 372.27,-1104.7"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge58" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M320.031,-1136.83C365.106,-1144.89 436.878,-1151.31 492,-1126 526.358,-1110.22 552.206,-1073 565.931,-1049.24"/>
<polygon fill="#000000" stroke="#000000" points="569.113,-1050.72 570.904,-1040.27 562.992,-1047.32 569.113,-1050.72"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~fida_mc~~CallsGraph_edge59" class="edge"><title>proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M400.529,-925.014C391.984,-933.972 400.141,-943 425,-943 440.149,-943 449.095,-939.647 451.839,-935.001"/>
<polygon fill="#000000" stroke="#000000" points="455.184,-933.936 449.471,-925.014 448.373,-935.552 455.184,-933.936"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge60" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M445.439,-925.174C458.789,-933.724 476.779,-945.621 492,-957 514.499,-973.819 539.001,-994.565 555.892,-1009.28"/>
<polygon fill="#000000" stroke="#000000" points="553.703,-1012.01 563.531,-1015.97 558.317,-1006.75 553.703,-1012.01"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~fida_mc~~CallsGraph_edge61" class="edge"><title>proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M321.504,-892.082C336.546,-895.152 353.518,-898.616 369.26,-901.829"/>
<polygon fill="#000000" stroke="#000000" points="368.896,-905.326 379.394,-903.897 370.296,-898.468 368.896,-905.326"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge62" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M321.517,-873.437C367.488,-866.042 439.69,-861.56 492,-892 535.459,-917.289 559.901,-974.575 570.531,-1006.13"/>
<polygon fill="#000000" stroke="#000000" points="567.232,-1007.31 573.614,-1015.76 573.899,-1005.17 567.232,-1007.31"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~fida_mc~~CallsGraph_edge63" class="edge"><title>proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M320.31,-1058.78C336.16,-1063.1 354.278,-1068.03 370.887,-1072.55"/>
<polygon fill="#000000" stroke="#000000" points="370.432,-1076.05 381,-1075.3 372.27,-1069.3 370.432,-1076.05"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge64" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M320.302,-1044.26C375.447,-1040.77 470.483,-1034.75 528.157,-1031.09"/>
<polygon fill="#000000" stroke="#000000" points="528.714,-1034.57 538.473,-1030.44 528.271,-1027.58 528.714,-1034.57"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~fida_mc~~CallsGraph_edge65" class="edge"><title>proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M303.231,-853.096C309.403,-855.982 315.945,-859.074 322,-862 345.238,-873.229 371.257,-886.246 391.2,-896.318"/>
<polygon fill="#000000" stroke="#000000" points="389.68,-899.472 400.183,-900.864 392.841,-893.226 389.68,-899.472"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge66" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M321.507,-834.23C368.134,-829.588 441.484,-829.47 492,-864 541.426,-897.785 563.968,-969.51 572.551,-1005.87"/>
<polygon fill="#000000" stroke="#000000" points="569.201,-1006.94 574.781,-1015.94 576.035,-1005.42 569.201,-1006.94"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~fida_mc~~CallsGraph_node42" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~fida_mc~~CallsGraph_node42"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="734,-799 672,-799 672,-775 734,-775 734,-799"/>
<text text-anchor="middle" x="703" y="-784.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~fida_mc~~CallsGraph_edge67" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M613.262,-758.142C628.306,-763.035 646.076,-768.813 661.746,-773.909"/>
<polygon fill="#000000" stroke="#000000" points="661.099,-777.379 671.692,-777.144 663.264,-770.723 661.099,-777.379"/>
</g>
<!-- proc~matinv -->
<g id="proc~~fida_mc~~CallsGraph_node44" class="node"><title>proc~matinv</title>
<g id="a_proc~~fida_mc~~CallsGraph_node44"><a xlink:href=".././proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="452,-108 398,-108 398,-84 452,-84 452,-108"/>
<text text-anchor="middle" x="425" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~linsolve&#45;&gt;proc~matinv -->
<g id="proc~~fida_mc~~CallsGraph_edge68" class="edge"><title>proc~linsolve&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M303.281,-78.7544C326.902,-82.1288 361.807,-87.1153 388.016,-90.8594"/>
<polygon fill="#000000" stroke="#000000" points="387.552,-94.3286 397.947,-92.2781 388.542,-87.399 387.552,-94.3286"/>
</g>
<!-- dgetrs -->
<g id="proc~~fida_mc~~CallsGraph_node46" class="node"><title>dgetrs</title>
<polygon fill="#777777" stroke="#777777" points="452,-66 398,-66 398,-42 452,-42 452,-66"/>
<text text-anchor="middle" x="425" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrs</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrs -->
<g id="proc~~fida_mc~~CallsGraph_edge70" class="edge"><title>proc~linsolve&#45;&gt;dgetrs</title>
<path fill="none" stroke="#000000" d="M303.281,-71.2456C326.902,-67.8712 361.807,-62.8847 388.016,-59.1406"/>
<polygon fill="#000000" stroke="#000000" points="388.542,-62.601 397.947,-57.7219 387.552,-55.6714 388.542,-62.601"/>
</g>
<!-- dgetrf -->
<g id="proc~~fida_mc~~CallsGraph_node47" class="node"><title>dgetrf</title>
<polygon fill="#777777" stroke="#777777" points="452,-24 398,-24 398,-0 452,-0 452,-24"/>
<text text-anchor="middle" x="425" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrf</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrf -->
<g id="proc~~fida_mc~~CallsGraph_edge69" class="edge"><title>proc~linsolve&#45;&gt;dgetrf</title>
<path fill="none" stroke="#000000" d="M297.847,-62.9355C313.935,-53.9363 336.93,-41.7398 358,-33 367.663,-28.9918 378.381,-25.2826 388.32,-22.132"/>
<polygon fill="#000000" stroke="#000000" points="389.402,-25.4611 397.933,-19.1773 387.346,-18.77 389.402,-25.4611"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~fida_mc~~CallsGraph_edge71" class="edge"><title>proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M304.986,-992.849C310.707,-990.113 316.62,-987.097 322,-984 349.978,-967.893 380.095,-946.36 400.294,-931.246"/>
<polygon fill="#000000" stroke="#000000" points="402.435,-934.015 408.308,-925.196 398.218,-928.428 402.435,-934.015"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge72" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M321.589,-1008.42C376.907,-1012.66 470.899,-1019.87 528.13,-1024.25"/>
<polygon fill="#000000" stroke="#000000" points="528.132,-1027.76 538.37,-1025.04 528.667,-1020.78 528.132,-1027.76"/>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge73" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M321.554,-1219.96C368.221,-1219.78 441.604,-1213.01 492,-1177 536.167,-1145.44 560.531,-1083.29 570.901,-1050.1"/>
<polygon fill="#000000" stroke="#000000" points="574.284,-1051.01 573.783,-1040.42 567.575,-1049.01 574.284,-1051.01"/>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~fida_mc~~CallsGraph_edge74" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M614.247,-357.036C627.628,-361.605 643.051,-366.871 657.198,-371.702"/>
<polygon fill="#000000" stroke="#000000" points="656.153,-375.043 666.748,-374.963 658.416,-368.419 656.153,-375.043"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_fields -->
<g id="proc~~fida_mc~~CallsGraph_edge76" class="edge"><title>proc~store_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M316.78,-559.825C338.361,-565.697 364.893,-572.917 386.165,-578.705"/>
<polygon fill="#000000" stroke="#000000" points="385.267,-582.088 395.835,-581.336 387.105,-575.333 385.267,-582.088"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~fida_mc~~CallsGraph_edge78" class="edge"><title>proc~store_photons&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M287.256,-536.739C301.312,-520.998 328.233,-494.467 358,-484 401.596,-468.671 675.571,-460.542 742,-486 763.467,-494.227 782.586,-512.455 795.223,-526.854"/>
<polygon fill="#000000" stroke="#000000" points="792.772,-529.378 801.883,-534.786 798.133,-524.877 792.772,-529.378"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_indices -->
<g id="proc~~fida_mc~~CallsGraph_edge75" class="edge"><title>proc~store_photons&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M290.092,-561.1C305.368,-574.661 331.879,-596.509 358,-610 365.367,-613.805 373.555,-617.084 381.586,-619.844"/>
<polygon fill="#000000" stroke="#000000" points="380.647,-623.219 391.239,-622.954 382.794,-616.556 380.647,-623.219"/>
</g>
<!-- proc~get_passive_grid_indices -->
<g id="proc~~fida_mc~~CallsGraph_node35" class="node"><title>proc~get_passive_grid_indices</title>
<g id="a_proc~~fida_mc~~CallsGraph_node35"><a xlink:href=".././proc/get_passive_grid_indices.html" xlink:title="get_passive_grid_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="491.5,-559 358.5,-559 358.5,-535 491.5,-535 491.5,-559"/>
<text text-anchor="middle" x="425" y="-544.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_passive_grid_indices</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_passive_grid_indices -->
<g id="proc~~fida_mc~~CallsGraph_edge79" class="edge"><title>proc~store_photons&#45;&gt;proc~get_passive_grid_indices</title>
<path fill="none" stroke="#000000" d="M316.78,-548.459C326.61,-548.325 337.468,-548.177 348.388,-548.029"/>
<polygon fill="#000000" stroke="#000000" points="348.454,-551.528 358.406,-547.892 348.359,-544.529 348.454,-551.528"/>
</g>
<!-- proc~spectrum -->
<g id="proc~~fida_mc~~CallsGraph_node48" class="node"><title>proc~spectrum</title>
<g id="a_proc~~fida_mc~~CallsGraph_node48"><a xlink:href=".././proc/spectrum.html" xlink:title="spectrum">
<polygon fill="#d9534f" stroke="#d9534f" points="453.5,-517 396.5,-517 396.5,-493 453.5,-493 453.5,-517"/>
<text text-anchor="middle" x="425" y="-502.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spectrum</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~spectrum -->
<g id="proc~~fida_mc~~CallsGraph_edge77" class="edge"><title>proc~store_photons&#45;&gt;proc~spectrum</title>
<path fill="none" stroke="#000000" d="M316.78,-537.093C338.508,-530.59 365.254,-522.584 386.598,-516.195"/>
<polygon fill="#000000" stroke="#000000" points="387.715,-519.514 396.291,-513.294 385.707,-512.808 387.715,-519.514"/>
</g>
<!-- proc~bb_cx_rates -->
<g id="proc~~fida_mc~~CallsGraph_node40" class="node"><title>proc~bb_cx_rates</title>
<g id="a_proc~~fida_mc~~CallsGraph_node40"><a xlink:href=".././proc/bb_cx_rates.html" xlink:title="bb_cx_rates">
<polygon fill="#d9534f" stroke="#d9534f" points="613.5,-399 542.5,-399 542.5,-375 613.5,-375 613.5,-399"/>
<text text-anchor="middle" x="578" y="-384.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bb_cx_rates</text>
</a>
</g>
</g>
<!-- proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates -->
<g id="proc~~fida_mc~~CallsGraph_edge80" class="edge"><title>proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates</title>
<path fill="none" stroke="#000000" d="M319.664,-387C376.011,-387 474.792,-387 532.192,-387"/>
<polygon fill="#000000" stroke="#000000" points="532.409,-390.5 542.409,-387 532.409,-383.5 532.409,-390.5"/>
</g>
<!-- proc~xyz_to_cyl -->
<g id="proc~~fida_mc~~CallsGraph_node55" class="node"><title>proc~xyz_to_cyl</title>
<g id="a_proc~~fida_mc~~CallsGraph_node55"><a xlink:href=".././proc/xyz_to_cyl.html" xlink:title="xyz_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="609,-519 547,-519 547,-495 609,-495 609,-519"/>
<text text-anchor="middle" x="578" y="-504.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_cyl</text>
</a>
</g>
</g>
<!-- proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl -->
<g id="proc~~fida_mc~~CallsGraph_edge81" class="edge"><title>proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl</title>
<path fill="none" stroke="#000000" d="M471.305,-534.999C492.113,-529.487 516.585,-523.004 536.739,-517.665"/>
<polygon fill="#000000" stroke="#000000" points="537.775,-521.012 546.545,-515.068 535.982,-514.245 537.775,-521.012"/>
</g>
<!-- proc~rswap -->
<g id="proc~~fida_mc~~CallsGraph_node51" class="node"><title>proc~rswap</title>
<g id="a_proc~~fida_mc~~CallsGraph_node51"><a xlink:href=".././proc/rswap.html" xlink:title="RSWAP">
<polygon fill="#d9534f" stroke="#d9534f" points="605,-276 551,-276 551,-252 605,-252 605,-276"/>
<text text-anchor="middle" x="578" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RSWAP</text>
</a>
</g>
</g>
<!-- proc~balback&#45;&gt;proc~rswap -->
<g id="proc~~fida_mc~~CallsGraph_edge82" class="edge"><title>proc~balback&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M452.166,-186.182C464.614,-189.655 479.476,-194.592 492,-201 515.394,-212.97 539.186,-231.236 555.626,-245.023"/>
<polygon fill="#000000" stroke="#000000" points="553.637,-247.928 563.512,-251.768 558.187,-242.608 553.637,-247.928"/>
</g>
<!-- proc~bb_cx_rates&#45;&gt;interface~interpol_coeff -->
<g id="proc~~fida_mc~~CallsGraph_edge83" class="edge"><title>proc~bb_cx_rates&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M613.59,-387C626.16,-387 640.598,-387 654.113,-387"/>
<polygon fill="#000000" stroke="#000000" points="654.222,-390.5 664.222,-387 654.222,-383.5 654.222,-390.5"/>
</g>
<!-- proc~elmhes&#45;&gt;proc~rswap -->
<g id="proc~~fida_mc~~CallsGraph_edge84" class="edge"><title>proc~elmhes&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M452.302,-298.684C476.878,-291.849 513.771,-281.587 541.057,-273.997"/>
<polygon fill="#000000" stroke="#000000" points="542.303,-277.284 550.999,-271.232 540.427,-270.54 542.303,-277.284"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~fida_mc~~CallsGraph_edge86" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M726.971,-774.847C732.511,-771.029 737.983,-766.38 742,-761 786.71,-701.116 803.137,-611.116 808.579,-569.536"/>
<polygon fill="#000000" stroke="#000000" points="812.081,-569.729 809.812,-559.38 805.132,-568.886 812.081,-569.729"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~fida_mc~~CallsGraph_edge85" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M734.09,-792.624C744.99,-794.662 757.506,-797.001 769.23,-799.193"/>
<polygon fill="#000000" stroke="#000000" points="768.797,-802.672 779.27,-801.069 770.083,-795.791 768.797,-802.672"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~fida_mc~~CallsGraph_node54" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~fida_mc~~CallsGraph_node54"><a xlink:href=".././proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="605,-150 551,-150 551,-126 605,-126 605,-150"/>
<text text-anchor="middle" x="578" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~fida_mc~~CallsGraph_edge87" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M452.302,-138C476.769,-138 513.446,-138 540.696,-138"/>
<polygon fill="#000000" stroke="#000000" points="540.999,-141.5 550.999,-138 540.999,-134.5 540.999,-141.5"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~fida_mc~~CallsGraph_node52" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~fida_mc~~CallsGraph_node52"><a xlink:href=".././proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="605,-66 551,-66 551,-42 605,-42 605,-66"/>
<text text-anchor="middle" x="578" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~fida_mc~~CallsGraph_edge88" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M452.302,-88.6842C476.878,-81.8486 513.771,-71.5869 541.057,-63.9973"/>
<polygon fill="#000000" stroke="#000000" points="542.303,-67.2838 550.999,-61.232 540.427,-60.5398 542.303,-67.2838"/>
</g>
<!-- proc~lubksb -->
<g id="proc~~fida_mc~~CallsGraph_node53" class="node"><title>proc~lubksb</title>
<g id="a_proc~~fida_mc~~CallsGraph_node53"><a xlink:href=".././proc/lubksb.html" xlink:title="lubksb">
<polygon fill="#d9534f" stroke="#d9534f" points="605,-108 551,-108 551,-84 605,-84 605,-108"/>
<text text-anchor="middle" x="578" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lubksb</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~lubksb -->
<g id="proc~~fida_mc~~CallsGraph_edge89" class="edge"><title>proc~matinv&#45;&gt;proc~lubksb</title>
<path fill="none" stroke="#000000" d="M452.302,-96C476.769,-96 513.446,-96 540.696,-96"/>
<polygon fill="#000000" stroke="#000000" points="540.999,-99.5001 550.999,-96 540.999,-92.5001 540.999,-99.5001"/>
</g>
<!-- proc~balance&#45;&gt;proc~rswap -->
<g id="proc~~fida_mc~~CallsGraph_edge90" class="edge"><title>proc~balance&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M452.302,-264C476.769,-264 513.446,-264 540.696,-264"/>
<polygon fill="#000000" stroke="#000000" points="540.999,-267.5 550.999,-264 540.999,-260.5 540.999,-267.5"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~fida_mc~~CallsGraph_node58" class="node"><title>proc~outerprod</title>
<g id="a_proc~~fida_mc~~CallsGraph_node58"><a xlink:href=".././proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="732.5,-87 673.5,-87 673.5,-63 732.5,-63 732.5,-87"/>
<text text-anchor="middle" x="703" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~fida_mc~~CallsGraph_edge91" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M605.085,-58.4536C622.061,-61.3519 644.499,-65.1828 663.509,-68.4284"/>
<polygon fill="#000000" stroke="#000000" points="662.929,-71.8799 673.375,-70.1129 664.107,-64.9797 662.929,-71.8799"/>
</g>
<!-- proc~swap -->
<g id="proc~~fida_mc~~CallsGraph_node59" class="node"><title>proc~swap</title>
<g id="a_proc~~fida_mc~~CallsGraph_node59"><a xlink:href=".././proc/swap.html" xlink:title="swap">
<polygon fill="#d9534f" stroke="#d9534f" points="730,-45 676,-45 676,-21 730,-21 730,-45"/>
<text text-anchor="middle" x="703" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swap</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~swap -->
<g id="proc~~fida_mc~~CallsGraph_edge92" class="edge"><title>proc~ludcmp&#45;&gt;proc~swap</title>
<path fill="none" stroke="#000000" d="M605.085,-49.5464C622.779,-46.5256 646.405,-42.4918 665.9,-39.1634"/>
<polygon fill="#000000" stroke="#000000" points="666.684,-42.5803 675.952,-37.4471 665.506,-35.6801 666.684,-42.5803"/>
</g>
<!-- proc~comdiv -->
<g id="proc~~fida_mc~~CallsGraph_node56" class="node"><title>proc~comdiv</title>
<g id="a_proc~~fida_mc~~CallsGraph_node56"><a xlink:href=".././proc/comdiv.html" xlink:title="Comdiv">
<polygon fill="#d9534f" stroke="#d9534f" points="730,-150 676,-150 676,-126 730,-126 730,-150"/>
<text text-anchor="middle" x="703" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Comdiv</text>
</a>
</g>
</g>
<!-- proc~hqrvec&#45;&gt;proc~comdiv -->
<g id="proc~~fida_mc~~CallsGraph_edge93" class="edge"><title>proc~hqrvec&#45;&gt;proc~comdiv</title>
<path fill="none" stroke="#000000" d="M605.085,-138C622.779,-138 646.405,-138 665.9,-138"/>
<polygon fill="#000000" stroke="#000000" points="665.952,-141.5 675.952,-138 665.952,-134.5 665.952,-141.5"/>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~fida_mc~~CallsGraph_edge95" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M589.915,-519.424C611.305,-543.77 658.886,-597.927 684.64,-627.24"/>
<polygon fill="#000000" stroke="#000000" points="682.055,-629.601 691.285,-634.804 687.314,-624.981 682.055,-629.601"/>
</g>
<!-- proc~uvw_to_cyl -->
<g id="proc~~fida_mc~~CallsGraph_node57" class="node"><title>proc~uvw_to_cyl</title>
<g id="a_proc~~fida_mc~~CallsGraph_node57"><a xlink:href=".././proc/uvw_to_cyl.html" xlink:title="uvw_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="735.5,-519 670.5,-519 670.5,-495 735.5,-495 735.5,-519"/>
<text text-anchor="middle" x="703" y="-504.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_cyl</text>
</a>
</g>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl -->
<g id="proc~~fida_mc~~CallsGraph_edge94" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl</title>
<path fill="none" stroke="#000000" d="M609.089,-507C624.402,-507 643.267,-507 659.989,-507"/>
<polygon fill="#000000" stroke="#000000" points="660.072,-510.5 670.072,-507 660.072,-503.5 660.072,-510.5"/>
</g>
</g>
</svg>
</div><script>var panprocfida_mcCallsGraph = svgPanZoom('#procfida_mcCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~fida_mc~~CalledByGraph Pages: 1 -->
<svg id="procfida_mcCalledByGraph" width="152pt" height="32pt"
 viewBox="0.00 0.00 152.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~fida_mc~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~fida_mc~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 148,-28 148,4 -4,4"/>
<!-- proc~fida_mc -->
<g id="proc~~fida_mc~~CalledByGraph_node1" class="node"><title>proc~fida_mc</title>
<polygon fill="none" stroke="black" points="144,-24 90,-24 90,-0 144,-0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">fida_mc</text>
</g>
<!-- program~fidasim -->
<g id="proc~~fida_mc~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~fida_mc~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_mc -->
<g id="proc~~fida_mc~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~fida_mc</title>
<path fill="none" stroke="#000000" d="M54.4029,-12C62.3932,-12 71.3106,-12 79.8241,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.919,-15.5001 89.919,-12 79.919,-8.5001 79.919,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/fida_mc.html#src">fida_mc</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">fida_mc</span><span class="w"></span>
<span class="w">    </span><span class="c">!+ Calculate Active FIDA emission using a Monte Carlo Fast-ion distribution</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iion</span><span class="p">,</span><span class="n">igamma</span><span class="p">,</span><span class="n">ngamma</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">FastIon</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fast_ion</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fields</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">plasma</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">phi</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ri</span><span class="w">      </span><span class="c">!! start position</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">vi</span><span class="w">      </span><span class="c">!! velocity of fast ions</span>
<span class="w">    </span><span class="c">!! Determination of the CX probability</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">denn</span><span class="w">    </span><span class="c">!!  neutral dens (n=1-4)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rates</span><span class="w">    </span><span class="c">!! CX rates</span>
<span class="w">    </span><span class="c">!! Collisiional radiative model along track</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">states</span><span class="w">  </span><span class="c">! Density of n-states</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ntrack</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">ParticleTrack</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ntrack</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tracks</span><span class="w"></span>
<span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">los_intersect</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">jj</span><span class="w">      </span><span class="c">!! counter along track</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">photons</span><span class="w"> </span><span class="c">!! photon flux</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">neut_types</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">uvw</span><span class="p">,</span><span class="w"> </span><span class="n">uvw_vi</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">randomu</span><span class="w"></span>

<span class="w">    </span><span class="n">ngamma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">.</span><span class="nb">or</span><span class="p">.(</span><span class="n">inputs</span><span class="p">%</span><span class="n">dist_type</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">ngamma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ceiling</span><span class="p">(</span><span class="nb">dble</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_fida</span><span class="p">)</span><span class="o">/</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">    if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i10)&#39;</span><span class="p">)</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="o">*</span><span class="n">ngamma</span><span class="p">,</span><span class="n">Int64</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span><span class="w"></span>

<span class="w">    </span><span class="c">!$OMP PARALLEL DO schedule(dynamic,1) private(iion,igamma,fast_ion,vi,ri,phi,tracks,s,c, &amp;</span>
<span class="w">    </span><span class="c">!$OMP&amp; randomu,plasma,fields,uvw,uvw_vi,ntrack,jj,rates,denn,los_intersect,states,photons)</span>
<span class="w">    </span><span class="n">loop_over_fast_ions</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">iion</span><span class="o">=</span><span class="n">istart</span><span class="p">,</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="p">,</span><span class="n">istep</span><span class="w"></span>
<span class="w">        </span><span class="n">fast_ion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">particles</span><span class="p">%</span><span class="n">fast_ion</span><span class="p">(</span><span class="n">iion</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vabs</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">loop_over_fast_ions</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">beam_grid_cross_grid</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">loop_over_fast_ions</span><span class="w"></span>
<span class="w">        </span><span class="n">gamma_loop</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">igamma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ngamma</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">                </span><span class="c">!! Pick random toroidal angle</span>
<span class="w">                </span><span class="k">call </span><span class="n">randu</span><span class="p">(</span><span class="n">randomu</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="n">phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">beam_grid_phi_enter</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">delta_phi</span><span class="o">*</span><span class="n">randomu</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">else</span>
<span class="k">                </span><span class="n">phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">phi</span><span class="w"></span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">            </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="c">!! Calculate position in machine coordinates</span>
<span class="w">            </span><span class="n">uvw</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">c</span><span class="w"></span>
<span class="w">            </span><span class="n">uvw</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">s</span><span class="w"></span>
<span class="w">            </span><span class="n">uvw</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">z</span><span class="w"></span>

<span class="w">            </span><span class="c">!! Convert to beam grid coordinates</span>
<span class="w">            </span><span class="k">call </span><span class="n">uvw_to_xyz</span><span class="p">(</span><span class="n">uvw</span><span class="p">,</span><span class="w"> </span><span class="n">ri</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">dist_type</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">                </span><span class="c">!! Get electomagnetic fields</span>
<span class="w">                </span><span class="k">call </span><span class="n">get_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Correct for gyro motion and get particle position and velocity</span>
<span class="w">                </span><span class="k">call </span><span class="n">gyro_correction</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">energy</span><span class="p">,</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">pitch</span><span class="p">,</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="c">!! Full Orbit</span>
<span class="w">                </span><span class="c">!! Calculate velocity vector</span>
<span class="w">                </span><span class="n">uvw_vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vt</span><span class="w"></span>
<span class="w">                </span><span class="n">uvw_vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vt</span><span class="w"></span>
<span class="w">                </span><span class="n">uvw_vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vz</span><span class="w"></span>
<span class="w">                </span><span class="n">vi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">matmul</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">inv_basis</span><span class="p">,</span><span class="n">uvw_vi</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">endif</span><span class="w"></span>

<span class="w">            </span><span class="c">!! Track particle through grid</span>
<span class="w">            </span><span class="k">call </span><span class="n">track</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="p">,</span><span class="w"> </span><span class="n">tracks</span><span class="p">,</span><span class="w"> </span><span class="n">ntrack</span><span class="p">,</span><span class="w"> </span><span class="n">los_intersect</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">los_intersect</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">gamma_loop</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">ntrack</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">cycle </span><span class="n">gamma_loop</span><span class="w"></span>

<span class="w">            </span><span class="c">!! Calculate CX probability</span>
<span class="w">            </span><span class="k">call </span><span class="n">get_total_cx_rate</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">ind</span><span class="p">,</span><span class="w"> </span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="p">,</span><span class="w"> </span><span class="n">neut_types</span><span class="p">,</span><span class="w"> </span><span class="n">rates</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span><span class="k">cycle </span><span class="n">gamma_loop</span><span class="w"></span>

<span class="w">            </span><span class="c">!! Weight CX rates by ion source density</span>
<span class="w">            </span><span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">weight</span><span class="o">*</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">delta_phi</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">/</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="o">/</span><span class="n">ngamma</span><span class="w"></span>

<span class="w">            </span><span class="c">!! Calculate the spectra produced in each cell along the path</span>
<span class="w">            </span><span class="n">loop_along_track</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">jj</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ntrack</span><span class="w"></span>
<span class="w">                </span><span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">call </span><span class="n">colrad</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="p">,</span><span class="w"> </span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="nb">time</span><span class="p">,</span><span class="w"> </span><span class="n">states</span><span class="p">,</span><span class="w"> </span><span class="n">denn</span><span class="p">,</span><span class="w"> </span><span class="n">photons</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">call </span><span class="n">store_fida_photons</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="p">,</span><span class="w"> </span><span class="n">beam_lambda0</span><span class="p">,</span><span class="w"> </span><span class="n">photons</span><span class="p">,</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="k">class</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo </span><span class="n">loop_along_track</span><span class="w"></span>
<span class="w">        </span><span class="k">enddo </span><span class="n">gamma_loop</span><span class="w"></span>
<span class="w">    </span><span class="k">enddo </span><span class="n">loop_over_fast_ions</span><span class="w"></span>
<span class="w">    </span><span class="c">!$OMP END PARALLEL DO</span>

<span class="cp">#ifdef _MPI</span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">fida</span><span class="p">)</span><span class="w"></span>
<span class="cp">#endif</span>

<span class="k">end subroutine </span><span class="n">fida_mc</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>