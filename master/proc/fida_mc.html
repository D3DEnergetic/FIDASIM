<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>fida_mc &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
               
        
        
            </ul>
        
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>



          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>fida_mc
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.5% of total for procedures.">68 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
    
     <li><a href='../module/libfida.html'>libfida</a></li>
    
  
     <li class="active">fida_mc</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/fida_mc.html#src">fida_mc</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine fida_mc()
    
    
   
</h2>
    
  


    
    <p>Calculate Active FIDA emission using a Monte Carlo Fast-ion distribution</p>
    

    <h3>Arguments</h3>
    
    <em>None</em>
    <br>
    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~fida_mc~~CallsGraph Pages: 1 -->
<svg id="procfida_mcCallsGraph" width="641pt" height="1002pt"
 viewBox="0.00 0.00 641.00 1001.76" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~fida_mc~~CallsGraph" class="graph" transform="scale(0.750585 0.750585) rotate(0) translate(4 1330.64)">
<title>proc~~fida_mc~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1330.64 850,-1330.64 850,4 -4,4"/>
<!-- proc~fida_mc -->
<g id="proc~~fida_mc~~CallsGraph_node1" class="node"><title>proc~fida_mc</title>
<polygon fill="none" stroke="black" points="54,-393.636 0,-393.636 0,-369.636 54,-369.636 54,-393.636"/>
<text text-anchor="middle" x="27" y="-379.236" font-family="Helvetica,sans-Serif" font-size="10.50">fida_mc</text>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~fida_mc~~CallsGraph_node2" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~fida_mc~~CallsGraph_node2"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="178.5,-1117.64 105.5,-1117.64 105.5,-1093.64 178.5,-1093.64 178.5,-1117.64"/>
<text text-anchor="middle" x="142" y="-1103.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;interface~parallel_sum -->
<g id="proc~~fida_mc~~CallsGraph_edge1" class="edge"><title>proc~fida_mc&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M29.9139,-393.899C43.0783,-478.244 120.211,-972.436 137.543,-1083.49"/>
<polygon fill="#000000" stroke="#000000" points="134.112,-1084.2 139.112,-1093.54 141.028,-1083.12 134.112,-1084.2"/>
</g>
<!-- proc~colrad -->
<g id="proc~~fida_mc~~CallsGraph_node3" class="node"><title>proc~colrad</title>
<g id="a_proc~~fida_mc~~CallsGraph_node3"><a xlink:href=".././proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="169,-589.636 115,-589.636 115,-565.636 169,-565.636 169,-589.636"/>
<text text-anchor="middle" x="142" y="-575.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~colrad -->
<g id="proc~~fida_mc~~CallsGraph_edge2" class="edge"><title>proc~fida_mc&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M30.4985,-393.648C36.7067,-421.308 54.9231,-490.72 90,-537.636 96.2011,-545.93 104.535,-553.431 112.666,-559.636"/>
<polygon fill="#000000" stroke="#000000" points="110.808,-562.611 120.969,-565.613 114.898,-556.93 110.808,-562.611"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~fida_mc~~CallsGraph_node4" class="node"><title>proc~get_fields</title>
<g id="a_proc~~fida_mc~~CallsGraph_node4"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="454,-241.636 396,-241.636 396,-217.636 454,-217.636 454,-241.636"/>
<text text-anchor="middle" x="425" y="-227.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~get_fields -->
<g id="proc~~fida_mc~~CallsGraph_edge3" class="edge"><title>proc~fida_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M30.6369,-369.372C36.551,-345.147 53.3298,-291.366 90,-266.636 181.137,-205.174 319.052,-214.142 385.515,-223.161"/>
<polygon fill="#000000" stroke="#000000" points="385.155,-226.645 395.551,-224.598 386.148,-219.716 385.155,-226.645"/>
</g>
<!-- proc~get_total_cx_rate -->
<g id="proc~~fida_mc~~CallsGraph_node5" class="node"><title>proc~get_total_cx_rate</title>
<g id="a_proc~~fida_mc~~CallsGraph_node5"><a xlink:href=".././proc/get_total_cx_rate.html" xlink:title="get_total_cx_rate">
<polygon fill="#d9534f" stroke="#d9534f" points="189.5,-528.636 94.5,-528.636 94.5,-504.636 189.5,-504.636 189.5,-528.636"/>
<text text-anchor="middle" x="142" y="-514.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_total_cx_rate</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~get_total_cx_rate -->
<g id="proc~~fida_mc~~CallsGraph_edge5" class="edge"><title>proc~fida_mc&#45;&gt;proc~get_total_cx_rate</title>
<path fill="none" stroke="#000000" d="M32.5538,-393.96C41.0153,-415.47 60.9782,-460.277 90,-488.636 94.0637,-492.607 98.8038,-496.185 103.727,-499.351"/>
<polygon fill="#000000" stroke="#000000" points="102.283,-502.561 112.68,-504.6 105.823,-496.522 102.283,-502.561"/>
</g>
<!-- proc~gyro_correction -->
<g id="proc~~fida_mc~~CallsGraph_node6" class="node"><title>proc~gyro_correction</title>
<g id="a_proc~~fida_mc~~CallsGraph_node6"><a xlink:href=".././proc/gyro_correction.html" xlink:title="gyro_correction">
<polygon fill="#d9534f" stroke="#d9534f" points="185.5,-424.636 98.5,-424.636 98.5,-400.636 185.5,-400.636 185.5,-424.636"/>
<text text-anchor="middle" x="142" y="-410.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_correction</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~gyro_correction -->
<g id="proc~~fida_mc~~CallsGraph_edge4" class="edge"><title>proc~fida_mc&#45;&gt;proc~gyro_correction</title>
<path fill="none" stroke="#000000" d="M54.2085,-388.826C64.3957,-391.621 76.4482,-394.927 88.2788,-398.173"/>
<polygon fill="#000000" stroke="#000000" points="87.5487,-401.602 98.1184,-400.872 89.4007,-394.851 87.5487,-401.602"/>
</g>
<!-- proc~track -->
<g id="proc~~fida_mc~~CallsGraph_node7" class="node"><title>proc~track</title>
<g id="a_proc~~fida_mc~~CallsGraph_node7"><a xlink:href=".././proc/track.html" xlink:title="track">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-284.636 249,-284.636 249,-260.636 303,-260.636 303,-284.636"/>
<text text-anchor="middle" x="276" y="-270.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~track -->
<g id="proc~~fida_mc~~CallsGraph_edge6" class="edge"><title>proc~fida_mc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M33.3918,-369.492C42.2859,-351.022 61.8891,-316.265 90,-299.636 135.935,-272.465 199.181,-269.059 238.552,-270.099"/>
<polygon fill="#000000" stroke="#000000" points="238.622,-273.604 248.747,-270.482 238.885,-266.609 238.622,-273.604"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~fida_mc~~CallsGraph_node8" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~fida_mc~~CallsGraph_node8"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="459,-325.636 391,-325.636 391,-301.636 459,-301.636 459,-325.636"/>
<text text-anchor="middle" x="425" y="-311.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~get_plasma -->
<g id="proc~~fida_mc~~CallsGraph_edge7" class="edge"><title>proc~fida_mc&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M40.5726,-369.516C52.3174,-359.029 70.8676,-344.5 90,-337.636 189.005,-302.117 314.897,-304.816 380.22,-309.454"/>
<polygon fill="#000000" stroke="#000000" points="380.314,-312.971 390.551,-310.24 380.846,-305.991 380.314,-312.971"/>
</g>
<!-- proc~store_fida_photons -->
<g id="proc~~fida_mc~~CallsGraph_node9" class="node"><title>proc~store_fida_photons</title>
<g id="a_proc~~fida_mc~~CallsGraph_node9"><a xlink:href=".././proc/store_fida_photons.html" xlink:title="store_fida_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="194,-191.636 90,-191.636 90,-167.636 194,-167.636 194,-191.636"/>
<text text-anchor="middle" x="142" y="-177.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_fida_photons</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~store_fida_photons -->
<g id="proc~~fida_mc~~CallsGraph_edge8" class="edge"><title>proc~fida_mc&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M30.1717,-369.377C35.7832,-340.46 52.9881,-266.736 90,-217.636 95.7597,-209.996 103.464,-203.174 111.136,-197.491"/>
<polygon fill="#000000" stroke="#000000" points="113.134,-200.365 119.355,-191.788 109.144,-194.614 113.134,-200.365"/>
</g>
<!-- interface~randu -->
<g id="proc~~fida_mc~~CallsGraph_node10" class="node"><title>interface~randu</title>
<g id="a_proc~~fida_mc~~CallsGraph_node10"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="303,-487.636 249,-487.636 249,-463.636 303,-463.636 303,-487.636"/>
<text text-anchor="middle" x="276" y="-473.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;interface~randu -->
<g id="proc~~fida_mc~~CallsGraph_edge9" class="edge"><title>proc~fida_mc&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M39.1225,-393.875C50.6796,-405.831 69.8645,-423.646 90,-433.636 138.138,-457.521 200.063,-468.021 238.648,-472.495"/>
<polygon fill="#000000" stroke="#000000" points="238.562,-476.006 248.881,-473.603 239.316,-469.047 238.562,-476.006"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~fida_mc~~CallsGraph_node11" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~fida_mc~~CallsGraph_node11"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="846,-217.636 778,-217.636 778,-193.636 846,-193.636 846,-217.636"/>
<text text-anchor="middle" x="812" y="-203.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~fida_mc~~CallsGraph_edge10" class="edge"><title>proc~fida_mc&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M54.1299,-379.758C92.6122,-377.095 166.805,-372.356 230,-370.636 362.407,-367.034 395.55,-373.351 528,-374.636 572.442,-375.068 584.927,-385.592 628,-374.636 683.896,-360.42 699.724,-351.869 742,-312.636 768.794,-287.771 789.765,-250.379 801.255,-227.022"/>
<polygon fill="#000000" stroke="#000000" points="804.437,-228.48 805.588,-217.948 798.12,-225.464 804.437,-228.48"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~fida_mc~~CallsGraph_node13" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~fida_mc~~CallsGraph_node13"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="321.5,-1326.64 230.5,-1326.64 230.5,-1302.64 321.5,-1302.64 321.5,-1326.64"/>
<text text-anchor="middle" x="276" y="-1312.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~fida_mc~~CallsGraph_edge15" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M145.894,-1117.99C153.985,-1150.15 179.619,-1237.65 230,-1290.64 232.059,-1292.8 234.357,-1294.81 236.796,-1296.67"/>
<polygon fill="#000000" stroke="#000000" points="235.214,-1299.82 245.485,-1302.42 239.077,-1293.99 235.214,-1299.82"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~fida_mc~~CallsGraph_node15" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~fida_mc~~CallsGraph_node15"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="321.5,-1239.64 230.5,-1239.64 230.5,-1215.64 321.5,-1215.64 321.5,-1239.64"/>
<text text-anchor="middle" x="276" y="-1225.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~fida_mc~~CallsGraph_edge18" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M151.893,-1117.66C166.607,-1137 197.624,-1175.5 230,-1201.64 233.751,-1204.67 237.897,-1207.56 242.11,-1210.25"/>
<polygon fill="#000000" stroke="#000000" points="240.373,-1213.29 250.745,-1215.45 243.985,-1207.29 240.373,-1213.29"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~fida_mc~~CallsGraph_node16" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~fida_mc~~CallsGraph_node16"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="321.5,-1159.64 230.5,-1159.64 230.5,-1135.64 321.5,-1135.64 321.5,-1159.64"/>
<text text-anchor="middle" x="276" y="-1145.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~fida_mc~~CallsGraph_edge11" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M178.721,-1117C193.643,-1121.75 211.202,-1127.34 227.21,-1132.43"/>
<polygon fill="#000000" stroke="#000000" points="226.349,-1135.83 236.939,-1135.53 228.471,-1129.16 226.349,-1135.83"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~fida_mc~~CallsGraph_node17" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~fida_mc~~CallsGraph_node17"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="320,-1075.64 232,-1075.64 232,-1051.64 320,-1051.64 320,-1075.64"/>
<text text-anchor="middle" x="276" y="-1061.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~fida_mc~~CallsGraph_edge14" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M178.721,-1094.27C193.643,-1089.52 211.202,-1083.94 227.21,-1078.84"/>
<polygon fill="#000000" stroke="#000000" points="228.471,-1082.11 236.939,-1075.75 226.349,-1075.44 228.471,-1082.11"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~fida_mc~~CallsGraph_node22" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~fida_mc~~CallsGraph_node22"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="320,-1033.64 232,-1033.64 232,-1009.64 320,-1009.64 320,-1033.64"/>
<text text-anchor="middle" x="276" y="-1019.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~fida_mc~~CallsGraph_edge12" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M157.804,-1093.57C174.658,-1080.16 203.317,-1058.33 230,-1042.64 232.508,-1041.16 235.137,-1039.71 237.811,-1038.3"/>
<polygon fill="#000000" stroke="#000000" points="239.598,-1041.32 246.969,-1033.71 236.461,-1035.06 239.598,-1041.32"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~fida_mc~~CallsGraph_node23" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~fida_mc~~CallsGraph_node23"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="320,-953.636 232,-953.636 232,-929.636 320,-929.636 320,-953.636"/>
<text text-anchor="middle" x="276" y="-939.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~fida_mc~~CallsGraph_edge13" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M148.151,-1093.58C159.645,-1067.81 189.59,-1006.52 230,-967.636 233.233,-964.526 236.907,-961.643 240.73,-959.017"/>
<polygon fill="#000000" stroke="#000000" points="242.611,-961.968 249.221,-953.688 238.89,-956.039 242.611,-961.968"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~fida_mc~~CallsGraph_node26" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~fida_mc~~CallsGraph_node26"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="321.5,-1117.64 230.5,-1117.64 230.5,-1093.64 321.5,-1093.64 321.5,-1117.64"/>
<text text-anchor="middle" x="276" y="-1103.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~fida_mc~~CallsGraph_edge19" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M178.721,-1105.64C191.501,-1105.64 206.214,-1105.64 220.231,-1105.64"/>
<polygon fill="#000000" stroke="#000000" points="220.276,-1109.14 230.276,-1105.64 220.276,-1102.14 220.276,-1109.14"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~fida_mc~~CallsGraph_node27" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~fida_mc~~CallsGraph_node27"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="469,-983.636 381,-983.636 381,-959.636 469,-959.636 469,-983.636"/>
<text text-anchor="middle" x="425" y="-969.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~fida_mc~~CallsGraph_edge17" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M149.171,-1093.42C161.268,-1070.87 190.412,-1022.97 230,-1000.64 273.066,-976.341 329.686,-970.276 370.633,-969.578"/>
<polygon fill="#000000" stroke="#000000" points="370.712,-973.077 380.687,-969.508 370.663,-966.077 370.712,-973.077"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~fida_mc~~CallsGraph_node28" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~fida_mc~~CallsGraph_node28"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="321.5,-1281.64 230.5,-1281.64 230.5,-1257.64 321.5,-1257.64 321.5,-1281.64"/>
<text text-anchor="middle" x="276" y="-1267.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~fida_mc~~CallsGraph_edge20" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M147.612,-1118.01C158.247,-1145.05 186.923,-1210.05 230,-1248.64 231.325,-1249.82 232.728,-1250.95 234.188,-1252.03"/>
<polygon fill="#000000" stroke="#000000" points="232.711,-1255.24 243.033,-1257.63 236.452,-1249.32 232.711,-1255.24"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~fida_mc~~CallsGraph_node31" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~fida_mc~~CallsGraph_node31"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="470.5,-1195.64 379.5,-1195.64 379.5,-1171.64 470.5,-1171.64 470.5,-1195.64"/>
<text text-anchor="middle" x="425" y="-1181.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~fida_mc~~CallsGraph_edge16" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M154.955,-1117.7C170.631,-1132.65 199.716,-1157.51 230,-1168.64 274.923,-1185.13 329.537,-1187.97 369.359,-1187.21"/>
<polygon fill="#000000" stroke="#000000" points="369.505,-1190.7 379.406,-1186.93 369.314,-1183.71 369.505,-1190.7"/>
</g>
<!-- proc~linsolve -->
<g id="proc~~fida_mc~~CallsGraph_node12" class="node"><title>proc~linsolve</title>
<g id="a_proc~~fida_mc~~CallsGraph_node12"><a xlink:href=".././proc/linsolve.html" xlink:title="linsolve">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-630.636 249,-630.636 249,-606.636 303,-606.636 303,-630.636"/>
<text text-anchor="middle" x="276" y="-616.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linsolve</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~linsolve -->
<g id="proc~~fida_mc~~CallsGraph_edge21" class="edge"><title>proc~colrad&#45;&gt;proc~linsolve</title>
<path fill="none" stroke="#000000" d="M169.079,-585.737C189.147,-591.97 217.102,-600.653 239.255,-607.534"/>
<polygon fill="#000000" stroke="#000000" points="238.387,-610.929 248.975,-610.553 240.464,-604.244 238.387,-610.929"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~fida_mc~~CallsGraph_node24" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~fida_mc~~CallsGraph_node24"><a xlink:href=".././proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="622,-569.636 534,-569.636 534,-545.636 622,-545.636 622,-569.636"/>
<text text-anchor="middle" x="578" y="-555.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~fida_mc~~CallsGraph_edge23" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M169.171,-576.43C238.857,-573.219 429.976,-564.412 523.724,-560.091"/>
<polygon fill="#000000" stroke="#000000" points="524.016,-563.582 533.845,-559.625 523.694,-556.589 524.016,-563.582"/>
</g>
<!-- proc~eigen -->
<g id="proc~~fida_mc~~CallsGraph_node34" class="node"><title>proc~eigen</title>
<g id="a_proc~~fida_mc~~CallsGraph_node34"><a xlink:href=".././proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-798.636 249,-798.636 249,-774.636 303,-774.636 303,-798.636"/>
<text text-anchor="middle" x="276" y="-784.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~fida_mc~~CallsGraph_edge22" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M150.667,-589.776C172.403,-624.19 234.607,-722.681 261.898,-765.891"/>
<polygon fill="#000000" stroke="#000000" points="259.012,-767.877 267.311,-774.463 264.931,-764.139 259.012,-767.877"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~fida_mc~~CallsGraph_edge28" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M454.144,-226.686C467.199,-223.953 482.003,-218.705 492,-208.636 530.034,-170.33 484.539,-124.654 528,-92.6363 604.575,-36.2233 659.053,-46.0972 742,-92.6363 776.687,-112.098 796.006,-156.875 804.885,-183.855"/>
<polygon fill="#000000" stroke="#000000" points="801.586,-185.035 807.881,-193.557 808.275,-182.97 801.586,-185.035"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~fida_mc~~CallsGraph_node19" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~fida_mc~~CallsGraph_node19"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="608.5,-365.636 547.5,-365.636 547.5,-341.636 608.5,-341.636 608.5,-365.636"/>
<text text-anchor="middle" x="578" y="-351.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~fida_mc~~CallsGraph_edge25" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M454.237,-234.85C466.565,-238.043 480.743,-243.027 492,-250.636 524.075,-272.32 550.473,-309.542 564.952,-332.805"/>
<polygon fill="#000000" stroke="#000000" points="562.07,-334.803 570.241,-341.547 568.059,-331.18 562.07,-334.803"/>
</g>
<!-- proc~get_position -->
<g id="proc~~fida_mc~~CallsGraph_node20" class="node"><title>proc~get_position</title>
<g id="a_proc~~fida_mc~~CallsGraph_node20"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="613,-209.636 543,-209.636 543,-185.636 613,-185.636 613,-209.636"/>
<text text-anchor="middle" x="578" y="-195.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~fida_mc~~CallsGraph_edge26" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M454.048,-223.692C476.185,-219.001 507.474,-212.37 532.947,-206.972"/>
<polygon fill="#000000" stroke="#000000" points="533.692,-210.392 542.749,-204.895 532.241,-203.544 533.692,-210.392"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~fida_mc~~CallsGraph_node25" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~fida_mc~~CallsGraph_node25"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="737,-276.636 669,-276.636 669,-252.636 737,-252.636 737,-276.636"/>
<text text-anchor="middle" x="703" y="-262.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~fida_mc~~CallsGraph_edge27" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M454.24,-233.217C502.612,-239.352 601.619,-251.907 658.746,-259.151"/>
<polygon fill="#000000" stroke="#000000" points="658.543,-262.653 668.904,-260.439 659.424,-255.709 658.543,-262.653"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~fida_mc~~CallsGraph_node30" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~fida_mc~~CallsGraph_node30"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="628,-167.636 528,-167.636 528,-143.636 628,-143.636 628,-167.636"/>
<text text-anchor="middle" x="578" y="-153.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~fida_mc~~CallsGraph_edge24" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M454.045,-223.5C466.199,-220.149 480.295,-215.297 492,-208.636 510.606,-198.049 509.928,-188.112 528,-176.636 530.454,-175.078 533.043,-173.586 535.697,-172.168"/>
<polygon fill="#000000" stroke="#000000" points="537.455,-175.204 544.872,-167.638 534.356,-168.927 537.455,-175.204"/>
</g>
<!-- proc~neutral_cx_rate -->
<g id="proc~~fida_mc~~CallsGraph_node29" class="node"><title>proc~neutral_cx_rate</title>
<g id="a_proc~~fida_mc~~CallsGraph_node29"><a xlink:href=".././proc/neutral_cx_rate.html" xlink:title="neutral_cx_rate">
<polygon fill="#d9534f" stroke="#d9534f" points="319.5,-529.636 232.5,-529.636 232.5,-505.636 319.5,-505.636 319.5,-529.636"/>
<text text-anchor="middle" x="276" y="-515.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutral_cx_rate</text>
</a>
</g>
</g>
<!-- proc~get_total_cx_rate&#45;&gt;proc~neutral_cx_rate -->
<g id="proc~~fida_mc~~CallsGraph_edge29" class="edge"><title>proc~get_total_cx_rate&#45;&gt;proc~neutral_cx_rate</title>
<path fill="none" stroke="#000000" d="M189.538,-516.989C200.113,-517.069 211.42,-517.155 222.233,-517.237"/>
<polygon fill="#000000" stroke="#000000" points="222.382,-520.738 232.408,-517.314 222.435,-513.738 222.382,-520.738"/>
</g>
<!-- proc~gyro_correction&#45;&gt;interface~randu -->
<g id="proc~~fida_mc~~CallsGraph_edge30" class="edge"><title>proc~gyro_correction&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M167.709,-424.671C185.1,-433.116 208.939,-444.639 230,-454.636 233.132,-456.123 236.391,-457.661 239.66,-459.198"/>
<polygon fill="#000000" stroke="#000000" points="238.258,-462.406 248.798,-463.479 241.228,-456.067 238.258,-462.406"/>
</g>
<!-- proc~pitch_to_vec -->
<g id="proc~~fida_mc~~CallsGraph_node14" class="node"><title>proc~pitch_to_vec</title>
<g id="a_proc~~fida_mc~~CallsGraph_node14"><a xlink:href=".././proc/pitch_to_vec.html" xlink:title="pitch_to_vec">
<polygon fill="#d9534f" stroke="#d9534f" points="312.5,-403.636 239.5,-403.636 239.5,-379.636 312.5,-379.636 312.5,-403.636"/>
<text text-anchor="middle" x="276" y="-389.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pitch_to_vec</text>
</a>
</g>
</g>
<!-- proc~gyro_correction&#45;&gt;proc~pitch_to_vec -->
<g id="proc~~fida_mc~~CallsGraph_edge32" class="edge"><title>proc~gyro_correction&#45;&gt;proc~pitch_to_vec</title>
<path fill="none" stroke="#000000" d="M185.857,-405.818C199.789,-403.602 215.297,-401.134 229.421,-398.887"/>
<polygon fill="#000000" stroke="#000000" points="230.093,-402.325 239.419,-397.297 228.993,-395.412 230.093,-402.325"/>
</g>
<!-- proc~gyro_step -->
<g id="proc~~fida_mc~~CallsGraph_node21" class="node"><title>proc~gyro_step</title>
<g id="a_proc~~fida_mc~~CallsGraph_node21"><a xlink:href=".././proc/gyro_step.html" xlink:title="gyro_step">
<polygon fill="#d9534f" stroke="#d9534f" points="306,-445.636 246,-445.636 246,-421.636 306,-421.636 306,-445.636"/>
<text text-anchor="middle" x="276" y="-431.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_step</text>
</a>
</g>
</g>
<!-- proc~gyro_correction&#45;&gt;proc~gyro_step -->
<g id="proc~~fida_mc~~CallsGraph_edge31" class="edge"><title>proc~gyro_correction&#45;&gt;proc~gyro_step</title>
<path fill="none" stroke="#000000" d="M185.857,-419.454C201.912,-422.009 220.06,-424.896 235.771,-427.395"/>
<polygon fill="#000000" stroke="#000000" points="235.272,-430.86 245.697,-428.975 236.371,-423.947 235.272,-430.86"/>
</g>
<!-- proc~track&#45;&gt;proc~get_fields -->
<g id="proc~~fida_mc~~CallsGraph_edge34" class="edge"><title>proc~track&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M303.281,-264.949C326.319,-258.21 360.09,-248.331 386.059,-240.735"/>
<polygon fill="#000000" stroke="#000000" points="387.33,-244.01 395.945,-237.843 385.364,-237.291 387.33,-244.01"/>
</g>
<!-- proc~track&#45;&gt;proc~get_plasma -->
<g id="proc~~fida_mc~~CallsGraph_edge37" class="edge"><title>proc~track&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M303.281,-279.966C324.933,-286.006 356.068,-294.689 381.294,-301.725"/>
<polygon fill="#000000" stroke="#000000" points="380.419,-305.115 390.992,-304.43 382.3,-298.372 380.419,-305.115"/>
</g>
<!-- proc~get_indices -->
<g id="proc~~fida_mc~~CallsGraph_node18" class="node"><title>proc~get_indices</title>
<g id="a_proc~~fida_mc~~CallsGraph_node18"><a xlink:href=".././proc/get_indices.html" xlink:title="get_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="458.5,-199.636 391.5,-199.636 391.5,-175.636 458.5,-175.636 458.5,-199.636"/>
<text text-anchor="middle" x="425" y="-185.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_indices</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~get_indices -->
<g id="proc~~fida_mc~~CallsGraph_edge33" class="edge"><title>proc~track&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M289.439,-260.409C304.519,-246.187 331.252,-222.847 358,-208.636 365.323,-204.746 373.49,-201.427 381.514,-198.655"/>
<polygon fill="#000000" stroke="#000000" points="382.723,-201.943 391.166,-195.543 380.575,-195.281 382.723,-201.943"/>
</g>
<!-- proc~track&#45;&gt;proc~in_plasma -->
<g id="proc~~fida_mc~~CallsGraph_edge36" class="edge"><title>proc~track&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M288.267,-284.725C302.798,-299.422 329.601,-323.624 358,-334.636 417.294,-357.629 492.19,-358.739 537.251,-356.712"/>
<polygon fill="#000000" stroke="#000000" points="537.688,-360.194 547.49,-356.174 537.32,-353.204 537.688,-360.194"/>
</g>
<!-- proc~doppler_stark -->
<g id="proc~~fida_mc~~CallsGraph_node32" class="node"><title>proc~doppler_stark</title>
<g id="a_proc~~fida_mc~~CallsGraph_node32"><a xlink:href=".././proc/doppler_stark.html" xlink:title="doppler_stark">
<polygon fill="#d9534f" stroke="#d9534f" points="464,-283.636 386,-283.636 386,-259.636 464,-259.636 464,-283.636"/>
<text text-anchor="middle" x="425" y="-269.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">doppler_stark</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~doppler_stark -->
<g id="proc~~fida_mc~~CallsGraph_edge35" class="edge"><title>proc~track&#45;&gt;proc~doppler_stark</title>
<path fill="none" stroke="#000000" d="M303.281,-272.458C323.369,-272.321 351.618,-272.129 375.739,-271.965"/>
<polygon fill="#000000" stroke="#000000" points="375.812,-275.464 385.788,-271.896 375.765,-268.464 375.812,-275.464"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~fida_mc~~CallsGraph_edge38" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M459.3,-318.784C519.661,-326.439 649.457,-335.074 742,-285.636 767.188,-272.181 787.26,-245.501 799.123,-226.66"/>
<polygon fill="#000000" stroke="#000000" points="802.249,-228.253 804.417,-217.883 796.255,-224.638 802.249,-228.253"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~fida_mc~~CallsGraph_edge40" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M459.138,-322.415C482.257,-328.539 513.213,-336.739 537.598,-343.199"/>
<polygon fill="#000000" stroke="#000000" points="536.702,-346.582 547.265,-345.76 538.495,-339.815 536.702,-346.582"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~fida_mc~~CallsGraph_edge41" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M459.085,-306.83C470.117,-303.618 482.108,-299.04 492,-292.636 508.037,-282.255 541.102,-242.67 560.934,-217.991"/>
<polygon fill="#000000" stroke="#000000" points="563.845,-219.955 567.348,-209.956 558.374,-215.589 563.845,-219.955"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~fida_mc~~CallsGraph_edge39" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M459.018,-307.774C508.888,-298.921 603.46,-282.131 658.763,-272.312"/>
<polygon fill="#000000" stroke="#000000" points="659.71,-275.699 668.944,-270.505 658.486,-268.807 659.71,-275.699"/>
</g>
<!-- proc~store_photons -->
<g id="proc~~fida_mc~~CallsGraph_node33" class="node"><title>proc~store_photons</title>
<g id="a_proc~~fida_mc~~CallsGraph_node33"><a xlink:href=".././proc/store_photons.html" xlink:title="store_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="316.5,-178.636 235.5,-178.636 235.5,-154.636 316.5,-154.636 316.5,-178.636"/>
<text text-anchor="middle" x="276" y="-164.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_photons</text>
</a>
</g>
</g>
<!-- proc~store_fida_photons&#45;&gt;proc~store_photons -->
<g id="proc~~fida_mc~~CallsGraph_edge42" class="edge"><title>proc~store_fida_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M194.035,-174.61C204.264,-173.603 215,-172.545 225.187,-171.542"/>
<polygon fill="#000000" stroke="#000000" points="225.543,-175.024 235.152,-170.561 224.857,-168.058 225.543,-175.024"/>
</g>
<!-- proc~matinv -->
<g id="proc~~fida_mc~~CallsGraph_node36" class="node"><title>proc~matinv</title>
<g id="a_proc~~fida_mc~~CallsGraph_node36"><a xlink:href=".././proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="452,-651.636 398,-651.636 398,-627.636 452,-627.636 452,-651.636"/>
<text text-anchor="middle" x="425" y="-637.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~linsolve&#45;&gt;proc~matinv -->
<g id="proc~~fida_mc~~CallsGraph_edge45" class="edge"><title>proc~linsolve&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M303.281,-622.391C326.902,-625.765 361.807,-630.752 388.016,-634.496"/>
<polygon fill="#000000" stroke="#000000" points="387.552,-637.965 397.947,-635.914 388.542,-631.035 387.552,-637.965"/>
</g>
<!-- dgetrs -->
<g id="proc~~fida_mc~~CallsGraph_node39" class="node"><title>dgetrs</title>
<polygon fill="#777777" stroke="#777777" points="452,-609.636 398,-609.636 398,-585.636 452,-585.636 452,-609.636"/>
<text text-anchor="middle" x="425" y="-595.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrs</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrs -->
<g id="proc~~fida_mc~~CallsGraph_edge44" class="edge"><title>proc~linsolve&#45;&gt;dgetrs</title>
<path fill="none" stroke="#000000" d="M303.281,-614.882C326.902,-611.507 361.807,-606.521 388.016,-602.777"/>
<polygon fill="#000000" stroke="#000000" points="388.542,-606.237 397.947,-601.358 387.552,-599.308 388.542,-606.237"/>
</g>
<!-- dgetrf -->
<g id="proc~~fida_mc~~CallsGraph_node45" class="node"><title>dgetrf</title>
<polygon fill="#777777" stroke="#777777" points="452,-693.636 398,-693.636 398,-669.636 452,-669.636 452,-693.636"/>
<text text-anchor="middle" x="425" y="-679.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrf</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrf -->
<g id="proc~~fida_mc~~CallsGraph_edge43" class="edge"><title>proc~linsolve&#45;&gt;dgetrf</title>
<path fill="none" stroke="#000000" d="M297.847,-630.701C313.935,-639.7 336.93,-651.897 358,-660.636 367.663,-664.645 378.381,-668.354 388.32,-671.504"/>
<polygon fill="#000000" stroke="#000000" points="387.346,-674.866 397.933,-674.459 389.402,-668.175 387.346,-674.866"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_node37" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="617.5,-1136.64 538.5,-1136.64 538.5,-1112.64 617.5,-1112.64 617.5,-1136.64"/>
<text text-anchor="middle" x="578" y="-1122.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge46" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M321.56,-1316.86C368.231,-1316.96 441.618,-1310.57 492,-1274.64 536.637,-1242.8 560.914,-1179.72 571.114,-1146.42"/>
<polygon fill="#000000" stroke="#000000" points="574.501,-1147.3 573.94,-1136.72 567.781,-1145.35 574.501,-1147.3"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~fida_mc~~CallsGraph_edge47" class="edge"><title>proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M317.168,-1215.61C334.75,-1210.35 355.561,-1204.12 374.122,-1198.57"/>
<polygon fill="#000000" stroke="#000000" points="375.304,-1201.87 383.88,-1195.64 373.296,-1195.16 375.304,-1201.87"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge48" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M321.8,-1236.72C367.035,-1243.64 437.777,-1248.15 492,-1222.64 526.21,-1206.54 552.104,-1169.41 565.878,-1145.76"/>
<polygon fill="#000000" stroke="#000000" points="569.041,-1147.28 570.871,-1136.84 562.933,-1143.86 569.041,-1147.28"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~fida_mc~~CallsGraph_edge49" class="edge"><title>proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M321.504,-1158.54C336.546,-1162.22 353.518,-1166.38 369.26,-1170.23"/>
<polygon fill="#000000" stroke="#000000" points="368.848,-1173.73 379.394,-1172.71 370.514,-1166.93 368.848,-1173.73"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge50" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M321.589,-1144.22C376.907,-1139.98 470.899,-1132.77 528.13,-1128.38"/>
<polygon fill="#000000" stroke="#000000" points="528.667,-1131.85 538.37,-1127.6 528.132,-1124.87 528.667,-1131.85"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge51" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M320.269,-1072.14C363.707,-1080.71 432.533,-1094.39 492,-1106.64 503.656,-1109.04 516.2,-1111.67 527.978,-1114.16"/>
<polygon fill="#000000" stroke="#000000" points="527.581,-1117.65 538.089,-1116.3 529.032,-1110.8 527.581,-1117.65"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~fida_mc~~CallsGraph_edge52" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M595.588,-341.633C616.496,-326.505 652.631,-300.359 676.919,-282.784"/>
<polygon fill="#000000" stroke="#000000" points="679.232,-285.431 685.282,-276.733 675.128,-279.76 679.232,-285.431"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~fida_mc~~CallsGraph_node44" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~fida_mc~~CallsGraph_node44"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="741.5,-527.636 664.5,-527.636 664.5,-503.636 741.5,-503.636 741.5,-527.636"/>
<text text-anchor="middle" x="703" y="-513.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~fida_mc~~CallsGraph_edge54" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M588.245,-365.813C609.17,-393.372 660.352,-460.783 686.327,-494.994"/>
<polygon fill="#000000" stroke="#000000" points="683.813,-497.471 692.648,-503.319 689.388,-493.238 683.813,-497.471"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~fida_mc~~CallsGraph_node49" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~fida_mc~~CallsGraph_node49"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="844.5,-355.636 779.5,-355.636 779.5,-331.636 844.5,-331.636 844.5,-355.636"/>
<text text-anchor="middle" x="812" y="-341.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~fida_mc~~CallsGraph_edge53" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M608.855,-352.349C649.701,-350.589 723.193,-347.421 769.412,-345.429"/>
<polygon fill="#000000" stroke="#000000" points="769.565,-348.926 779.405,-344.998 769.263,-341.932 769.565,-348.926"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~fida_mc~~CallsGraph_node46" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~fida_mc~~CallsGraph_node46"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="734,-217.636 672,-217.636 672,-193.636 734,-193.636 734,-217.636"/>
<text text-anchor="middle" x="703" y="-203.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~fida_mc~~CallsGraph_edge55" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M613.262,-199.865C628.163,-200.834 645.737,-201.977 661.298,-202.989"/>
<polygon fill="#000000" stroke="#000000" points="661.486,-206.509 671.692,-203.665 661.94,-199.523 661.486,-206.509"/>
</g>
<!-- proc~cross_product -->
<g id="proc~~fida_mc~~CallsGraph_node42" class="node"><title>proc~cross_product</title>
<g id="a_proc~~fida_mc~~CallsGraph_node42"><a xlink:href=".././proc/cross_product.html" xlink:title="cross_product">
<polygon fill="#d94e8f" stroke="#d94e8f" points="465,-445.636 385,-445.636 385,-421.636 465,-421.636 465,-445.636"/>
<text text-anchor="middle" x="425" y="-431.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cross_product</text>
</a>
</g>
</g>
<!-- proc~gyro_step&#45;&gt;proc~cross_product -->
<g id="proc~~fida_mc~~CallsGraph_edge56" class="edge"><title>proc~gyro_step&#45;&gt;proc~cross_product</title>
<path fill="none" stroke="#000000" d="M306.042,-433.636C325.634,-433.636 351.975,-433.636 374.795,-433.636"/>
<polygon fill="#000000" stroke="#000000" points="374.996,-437.136 384.996,-433.636 374.996,-430.136 374.996,-437.136"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~fida_mc~~CallsGraph_edge57" class="edge"><title>proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M312.585,-1009.53C332.553,-1002.74 357.664,-994.2 378.989,-986.946"/>
<polygon fill="#000000" stroke="#000000" points="380.148,-990.249 388.489,-983.715 377.894,-983.622 380.148,-990.249"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge58" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M320.119,-1028.82C364.333,-1037.03 434.562,-1052.39 492,-1075.64 512.783,-1084.05 534.665,-1096.76 551.022,-1107.13"/>
<polygon fill="#000000" stroke="#000000" points="549.2,-1110.12 559.498,-1112.61 552.999,-1104.24 549.2,-1110.12"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~fida_mc~~CallsGraph_edge59" class="edge"><title>proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M320.31,-950.475C336.16,-953.71 354.278,-957.407 370.887,-960.797"/>
<polygon fill="#000000" stroke="#000000" points="370.502,-964.29 381,-962.861 371.902,-957.432 370.502,-964.29"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge60" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M320.052,-931.374C366.457,-922.877 440.565,-917.003 492,-950.636 545.269,-985.469 566.236,-1063.94 573.545,-1102.46"/>
<polygon fill="#000000" stroke="#000000" points="570.152,-1103.37 575.329,-1112.62 577.047,-1102.16 570.152,-1103.37"/>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~fida_mc~~CallsGraph_edge61" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M614.247,-545.601C627.628,-541.032 643.051,-535.765 657.198,-530.934"/>
<polygon fill="#000000" stroke="#000000" points="658.416,-534.217 666.748,-527.674 656.153,-527.593 658.416,-534.217"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~fida_mc~~CallsGraph_edge62" class="edge"><title>proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M303.806,-1117.75C309.832,-1120.59 316.168,-1123.65 322,-1126.64 346.898,-1139.38 374.566,-1154.93 394.796,-1166.57"/>
<polygon fill="#000000" stroke="#000000" points="393.122,-1169.64 403.531,-1171.62 396.624,-1163.58 393.122,-1169.64"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge63" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M321.589,-1108.46C376.907,-1111.96 470.899,-1117.92 528.13,-1121.54"/>
<polygon fill="#000000" stroke="#000000" points="528.169,-1125.05 538.37,-1122.19 528.612,-1118.06 528.169,-1125.05"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~fida_mc~~CallsGraph_edge64" class="edge"><title>proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M400.529,-983.65C391.984,-992.608 400.141,-1001.64 425,-1001.64 440.149,-1001.64 449.095,-998.284 451.839,-993.638"/>
<polygon fill="#000000" stroke="#000000" points="455.184,-992.573 449.471,-983.65 448.373,-994.188 455.184,-992.573"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge65" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M447.771,-983.718C461.287,-991.786 478.577,-1003.18 492,-1015.64 521.345,-1042.88 548.545,-1080.91 563.931,-1104.1"/>
<polygon fill="#000000" stroke="#000000" points="561.012,-1106.03 569.411,-1112.49 566.872,-1102.2 561.012,-1106.03"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~fida_mc~~CallsGraph_edge66" class="edge"><title>proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M304.413,-1257.54C310.288,-1254.76 316.407,-1251.71 322,-1248.64 348.618,-1234.03 377.709,-1215.18 397.987,-1201.55"/>
<polygon fill="#000000" stroke="#000000" points="400.056,-1204.38 406.374,-1195.87 396.131,-1198.58 400.056,-1204.38"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge67" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M321.501,-1274.85C367.459,-1278.02 439.651,-1276.65 492,-1245.64 530.754,-1222.68 556.313,-1174.35 568.56,-1146.22"/>
<polygon fill="#000000" stroke="#000000" points="571.849,-1147.42 572.47,-1136.85 565.389,-1144.73 571.849,-1147.42"/>
</g>
<!-- proc~bb_cx_rates -->
<g id="proc~~fida_mc~~CallsGraph_node43" class="node"><title>proc~bb_cx_rates</title>
<g id="a_proc~~fida_mc~~CallsGraph_node43"><a xlink:href=".././proc/bb_cx_rates.html" xlink:title="bb_cx_rates">
<polygon fill="#d9534f" stroke="#d9534f" points="613.5,-527.636 542.5,-527.636 542.5,-503.636 613.5,-503.636 613.5,-527.636"/>
<text text-anchor="middle" x="578" y="-513.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bb_cx_rates</text>
</a>
</g>
</g>
<!-- proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates -->
<g id="proc~~fida_mc~~CallsGraph_edge68" class="edge"><title>proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates</title>
<path fill="none" stroke="#000000" d="M319.664,-517.352C376.011,-516.976 474.792,-516.318 532.192,-515.935"/>
<polygon fill="#000000" stroke="#000000" points="532.432,-519.434 542.409,-515.867 532.386,-512.434 532.432,-519.434"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~fida_mc~~CallsGraph_edge69" class="edge"><title>proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M400.529,-1195.65C391.984,-1204.61 400.141,-1213.64 425,-1213.64 440.149,-1213.64 449.095,-1210.28 451.839,-1205.64"/>
<polygon fill="#000000" stroke="#000000" points="455.184,-1204.57 449.471,-1195.65 448.373,-1206.19 455.184,-1204.57"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge70" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M456.921,-1171.55C479.925,-1162.57 511.531,-1150.22 536.543,-1140.44"/>
<polygon fill="#000000" stroke="#000000" points="538.079,-1143.6 546.12,-1136.7 535.532,-1137.08 538.079,-1143.6"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_fields -->
<g id="proc~~fida_mc~~CallsGraph_edge72" class="edge"><title>proc~store_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M297.847,-178.701C313.935,-187.7 336.93,-199.897 358,-208.636 366.891,-212.324 376.674,-215.759 385.923,-218.738"/>
<polygon fill="#000000" stroke="#000000" points="385.093,-222.146 395.682,-221.783 387.178,-215.463 385.093,-222.146"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~fida_mc~~CallsGraph_edge75" class="edge"><title>proc~store_photons&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M285.044,-154.335C298.001,-135.601 325.373,-100.242 358,-82.6363 508.567,-1.3915 600.002,39.7982 742,-55.6363 785.604,-84.9421 802.14,-149.171 808.016,-183.296"/>
<polygon fill="#000000" stroke="#000000" points="804.626,-184.279 809.623,-193.621 811.543,-183.202 804.626,-184.279"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_indices -->
<g id="proc~~fida_mc~~CallsGraph_edge71" class="edge"><title>proc~store_photons&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M316.78,-172.319C336.711,-175.166 360.865,-178.617 381.198,-181.522"/>
<polygon fill="#000000" stroke="#000000" points="380.743,-184.992 391.138,-182.942 381.733,-178.063 380.743,-184.992"/>
</g>
<!-- proc~spectrum -->
<g id="proc~~fida_mc~~CallsGraph_node41" class="node"><title>proc~spectrum</title>
<g id="a_proc~~fida_mc~~CallsGraph_node41"><a xlink:href=".././proc/spectrum.html" xlink:title="spectrum">
<polygon fill="#d9534f" stroke="#d9534f" points="453.5,-157.636 396.5,-157.636 396.5,-133.636 453.5,-133.636 453.5,-157.636"/>
<text text-anchor="middle" x="425" y="-143.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spectrum</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~spectrum -->
<g id="proc~~fida_mc~~CallsGraph_edge73" class="edge"><title>proc~store_photons&#45;&gt;proc~spectrum</title>
<path fill="none" stroke="#000000" d="M316.78,-160.953C338.409,-157.864 365.012,-154.063 386.308,-151.021"/>
<polygon fill="#000000" stroke="#000000" points="386.887,-154.474 396.291,-149.595 385.897,-147.544 386.887,-154.474"/>
</g>
<!-- proc~get_passive_grid_indices -->
<g id="proc~~fida_mc~~CallsGraph_node50" class="node"><title>proc~get_passive_grid_indices</title>
<g id="a_proc~~fida_mc~~CallsGraph_node50"><a xlink:href=".././proc/get_passive_grid_indices.html" xlink:title="get_passive_grid_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="491.5,-115.636 358.5,-115.636 358.5,-91.6363 491.5,-91.6363 491.5,-115.636"/>
<text text-anchor="middle" x="425" y="-101.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_passive_grid_indices</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_passive_grid_indices -->
<g id="proc~~fida_mc~~CallsGraph_edge74" class="edge"><title>proc~store_photons&#45;&gt;proc~get_passive_grid_indices</title>
<path fill="none" stroke="#000000" d="M297.847,-154.572C313.935,-145.573 336.93,-133.376 358,-124.636 362.738,-122.671 367.729,-120.778 372.758,-118.987"/>
<polygon fill="#000000" stroke="#000000" points="374.092,-122.229 382.418,-115.677 371.823,-115.607 374.092,-122.229"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~fida_mc~~CallsGraph_node35" class="node"><title>proc~hqr2</title>
<g id="a_proc~~fida_mc~~CallsGraph_node35"><a xlink:href=".././proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="452,-903.636 398,-903.636 398,-879.636 452,-879.636 452,-903.636"/>
<text text-anchor="middle" x="425" y="-889.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~fida_mc~~CallsGraph_edge76" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M285.54,-798.758C298.952,-816.933 326.679,-851.182 358,-870.636 367.116,-876.299 377.898,-880.565 388.076,-883.721"/>
<polygon fill="#000000" stroke="#000000" points="387.394,-887.166 397.969,-886.517 389.298,-880.429 387.394,-887.166"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~fida_mc~~CallsGraph_node38" class="node"><title>proc~elmhes</title>
<g id="a_proc~~fida_mc~~CallsGraph_node38"><a xlink:href=".././proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="452,-861.636 398,-861.636 398,-837.636 452,-837.636 452,-861.636"/>
<text text-anchor="middle" x="425" y="-847.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~fida_mc~~CallsGraph_edge77" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M297.847,-798.701C313.935,-807.7 336.93,-819.897 358,-828.636 367.663,-832.645 378.381,-836.354 388.32,-839.504"/>
<polygon fill="#000000" stroke="#000000" points="387.346,-842.866 397.933,-842.459 389.402,-836.175 387.346,-842.866"/>
</g>
<!-- proc~balance -->
<g id="proc~~fida_mc~~CallsGraph_node40" class="node"><title>proc~balance</title>
<g id="a_proc~~fida_mc~~CallsGraph_node40"><a xlink:href=".././proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="452,-819.636 398,-819.636 398,-795.636 452,-795.636 452,-819.636"/>
<text text-anchor="middle" x="425" y="-805.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~fida_mc~~CallsGraph_edge78" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M303.281,-790.391C326.902,-793.765 361.807,-798.752 388.016,-802.496"/>
<polygon fill="#000000" stroke="#000000" points="387.552,-805.965 397.947,-803.914 388.542,-799.035 387.552,-805.965"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~fida_mc~~CallsGraph_node47" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~fida_mc~~CallsGraph_node47"><a xlink:href=".././proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="452,-777.636 398,-777.636 398,-753.636 452,-753.636 452,-777.636"/>
<text text-anchor="middle" x="425" y="-763.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~fida_mc~~CallsGraph_edge79" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M303.281,-782.882C326.902,-779.507 361.807,-774.521 388.016,-770.777"/>
<polygon fill="#000000" stroke="#000000" points="388.542,-774.237 397.947,-769.358 387.552,-767.308 388.542,-774.237"/>
</g>
<!-- proc~balback -->
<g id="proc~~fida_mc~~CallsGraph_node48" class="node"><title>proc~balback</title>
<g id="a_proc~~fida_mc~~CallsGraph_node48"><a xlink:href=".././proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="452,-735.636 398,-735.636 398,-711.636 452,-711.636 452,-735.636"/>
<text text-anchor="middle" x="425" y="-721.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~fida_mc~~CallsGraph_edge80" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M297.847,-774.572C313.935,-765.573 336.93,-753.376 358,-744.636 367.663,-740.628 378.381,-736.919 388.32,-733.768"/>
<polygon fill="#000000" stroke="#000000" points="389.402,-737.097 397.933,-730.814 387.346,-730.406 389.402,-737.097"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~fida_mc~~CallsGraph_node55" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~fida_mc~~CallsGraph_node55"><a xlink:href=".././proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="605,-903.636 551,-903.636 551,-879.636 605,-879.636 605,-903.636"/>
<text text-anchor="middle" x="578" y="-889.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~fida_mc~~CallsGraph_edge81" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M452.302,-891.636C476.769,-891.636 513.446,-891.636 540.696,-891.636"/>
<polygon fill="#000000" stroke="#000000" points="540.999,-895.136 550.999,-891.636 540.999,-888.136 540.999,-895.136"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~fida_mc~~CallsGraph_node52" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~fida_mc~~CallsGraph_node52"><a xlink:href=".././proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="605,-631.636 551,-631.636 551,-607.636 605,-607.636 605,-631.636"/>
<text text-anchor="middle" x="578" y="-617.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~fida_mc~~CallsGraph_edge83" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M452.302,-636.153C476.878,-632.898 513.771,-628.011 541.057,-624.397"/>
<polygon fill="#000000" stroke="#000000" points="541.545,-627.863 550.999,-623.08 540.626,-620.924 541.545,-627.863"/>
</g>
<!-- proc~lubksb -->
<g id="proc~~fida_mc~~CallsGraph_node54" class="node"><title>proc~lubksb</title>
<g id="a_proc~~fida_mc~~CallsGraph_node54"><a xlink:href=".././proc/lubksb.html" xlink:title="lubksb">
<polygon fill="#d9534f" stroke="#d9534f" points="605,-673.636 551,-673.636 551,-649.636 605,-649.636 605,-673.636"/>
<text text-anchor="middle" x="578" y="-659.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lubksb</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~lubksb -->
<g id="proc~~fida_mc~~CallsGraph_edge82" class="edge"><title>proc~matinv&#45;&gt;proc~lubksb</title>
<path fill="none" stroke="#000000" d="M452.302,-643.468C476.878,-647.049 513.771,-652.424 541.057,-656.4"/>
<polygon fill="#000000" stroke="#000000" points="540.599,-659.87 550.999,-657.848 541.608,-652.943 540.599,-659.87"/>
</g>
<!-- proc~rswap -->
<g id="proc~~fida_mc~~CallsGraph_node53" class="node"><title>proc~rswap</title>
<g id="a_proc~~fida_mc~~CallsGraph_node53"><a xlink:href=".././proc/rswap.html" xlink:title="RSWAP">
<polygon fill="#d9534f" stroke="#d9534f" points="605,-819.636 551,-819.636 551,-795.636 605,-795.636 605,-819.636"/>
<text text-anchor="middle" x="578" y="-805.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RSWAP</text>
</a>
</g>
</g>
<!-- proc~elmhes&#45;&gt;proc~rswap -->
<g id="proc~~fida_mc~~CallsGraph_edge84" class="edge"><title>proc~elmhes&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M452.302,-842.32C476.878,-835.485 513.771,-825.223 541.057,-817.634"/>
<polygon fill="#000000" stroke="#000000" points="542.303,-820.92 550.999,-814.868 540.427,-814.176 542.303,-820.92"/>
</g>
<!-- proc~balance&#45;&gt;proc~rswap -->
<g id="proc~~fida_mc~~CallsGraph_edge85" class="edge"><title>proc~balance&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M452.302,-807.636C476.769,-807.636 513.446,-807.636 540.696,-807.636"/>
<polygon fill="#000000" stroke="#000000" points="540.999,-811.136 550.999,-807.636 540.999,-804.136 540.999,-811.136"/>
</g>
<!-- proc~bb_cx_rates&#45;&gt;interface~interpol_coeff -->
<g id="proc~~fida_mc~~CallsGraph_edge86" class="edge"><title>proc~bb_cx_rates&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M613.59,-515.636C626.16,-515.636 640.598,-515.636 654.113,-515.636"/>
<polygon fill="#000000" stroke="#000000" points="654.222,-519.136 664.222,-515.636 654.222,-512.136 654.222,-519.136"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~fida_mc~~CallsGraph_edge88" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M734.09,-205.636C744.502,-205.636 756.387,-205.636 767.649,-205.636"/>
<polygon fill="#000000" stroke="#000000" points="767.756,-209.136 777.756,-205.636 767.756,-202.136 767.756,-209.136"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~fida_mc~~CallsGraph_edge87" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M717.266,-217.755C724.855,-224.962 734.355,-234.462 742,-243.636 763.545,-269.493 785.038,-301.966 798.174,-322.763"/>
<polygon fill="#000000" stroke="#000000" points="795.324,-324.806 803.592,-331.431 801.26,-321.096 795.324,-324.806"/>
</g>
<!-- proc~balback&#45;&gt;proc~rswap -->
<g id="proc~~fida_mc~~CallsGraph_edge89" class="edge"><title>proc~balback&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M452.166,-729.819C464.614,-733.291 479.476,-738.228 492,-744.636 515.394,-756.606 539.186,-774.873 555.626,-788.66"/>
<polygon fill="#000000" stroke="#000000" points="553.637,-791.564 563.512,-795.404 558.187,-786.245 553.637,-791.564"/>
</g>
<!-- proc~xyz_to_cyl -->
<g id="proc~~fida_mc~~CallsGraph_node51" class="node"><title>proc~xyz_to_cyl</title>
<g id="a_proc~~fida_mc~~CallsGraph_node51"><a xlink:href=".././proc/xyz_to_cyl.html" xlink:title="xyz_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="609,-125.636 547,-125.636 547,-101.636 609,-101.636 609,-125.636"/>
<text text-anchor="middle" x="578" y="-111.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_cyl</text>
</a>
</g>
</g>
<!-- proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl -->
<g id="proc~~fida_mc~~CallsGraph_edge90" class="edge"><title>proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl</title>
<path fill="none" stroke="#000000" d="M491.792,-107.993C507.118,-109.008 522.987,-110.059 536.816,-110.975"/>
<polygon fill="#000000" stroke="#000000" points="536.741,-114.478 546.95,-111.646 537.203,-107.493 536.741,-114.478"/>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~fida_mc~~CallsGraph_edge91" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M609.076,-122.111C615.964,-125.172 622.784,-129.251 628,-134.636 658.548,-166.175 639.967,-189.89 664,-226.636 668.353,-233.293 674.021,-239.73 679.646,-245.356"/>
<polygon fill="#000000" stroke="#000000" points="677.492,-248.136 687.16,-252.469 682.304,-243.052 677.492,-248.136"/>
</g>
<!-- proc~uvw_to_cyl -->
<g id="proc~~fida_mc~~CallsGraph_node59" class="node"><title>proc~uvw_to_cyl</title>
<g id="a_proc~~fida_mc~~CallsGraph_node59"><a xlink:href=".././proc/uvw_to_cyl.html" xlink:title="uvw_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="735.5,-125.636 670.5,-125.636 670.5,-101.636 735.5,-101.636 735.5,-125.636"/>
<text text-anchor="middle" x="703" y="-111.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_cyl</text>
</a>
</g>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl -->
<g id="proc~~fida_mc~~CallsGraph_edge92" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl</title>
<path fill="none" stroke="#000000" d="M609.089,-113.636C624.402,-113.636 643.267,-113.636 659.989,-113.636"/>
<polygon fill="#000000" stroke="#000000" points="660.072,-117.136 670.072,-113.636 660.072,-110.136 660.072,-117.136"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~fida_mc~~CallsGraph_node57" class="node"><title>proc~outerprod</title>
<g id="a_proc~~fida_mc~~CallsGraph_node57"><a xlink:href=".././proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="732.5,-610.636 673.5,-610.636 673.5,-586.636 732.5,-586.636 732.5,-610.636"/>
<text text-anchor="middle" x="703" y="-596.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~fida_mc~~CallsGraph_edge93" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M605.085,-615.183C622.061,-612.284 644.499,-608.454 663.509,-605.208"/>
<polygon fill="#000000" stroke="#000000" points="664.107,-608.657 673.375,-603.523 662.929,-601.756 664.107,-608.657"/>
</g>
<!-- proc~swap -->
<g id="proc~~fida_mc~~CallsGraph_node58" class="node"><title>proc~swap</title>
<g id="a_proc~~fida_mc~~CallsGraph_node58"><a xlink:href=".././proc/swap.html" xlink:title="swap">
<polygon fill="#d9534f" stroke="#d9534f" points="730,-652.636 676,-652.636 676,-628.636 730,-628.636 730,-652.636"/>
<text text-anchor="middle" x="703" y="-638.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swap</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~swap -->
<g id="proc~~fida_mc~~CallsGraph_edge94" class="edge"><title>proc~ludcmp&#45;&gt;proc~swap</title>
<path fill="none" stroke="#000000" d="M605.085,-624.09C622.779,-627.111 646.405,-631.144 665.9,-634.473"/>
<polygon fill="#000000" stroke="#000000" points="665.506,-637.956 675.952,-636.189 666.684,-631.056 665.506,-637.956"/>
</g>
<!-- proc~comdiv -->
<g id="proc~~fida_mc~~CallsGraph_node56" class="node"><title>proc~comdiv</title>
<g id="a_proc~~fida_mc~~CallsGraph_node56"><a xlink:href=".././proc/comdiv.html" xlink:title="Comdiv">
<polygon fill="#d9534f" stroke="#d9534f" points="730,-903.636 676,-903.636 676,-879.636 730,-879.636 730,-903.636"/>
<text text-anchor="middle" x="703" y="-889.236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Comdiv</text>
</a>
</g>
</g>
<!-- proc~hqrvec&#45;&gt;proc~comdiv -->
<g id="proc~~fida_mc~~CallsGraph_edge95" class="edge"><title>proc~hqrvec&#45;&gt;proc~comdiv</title>
<path fill="none" stroke="#000000" d="M605.085,-891.636C622.779,-891.636 646.405,-891.636 665.9,-891.636"/>
<polygon fill="#000000" stroke="#000000" points="665.952,-895.136 675.952,-891.636 665.952,-888.136 665.952,-895.136"/>
</g>
</g>
</svg>
</div><script>var panprocfida_mcCallsGraph = svgPanZoom('#procfida_mcCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~fida_mc~~CalledByGraph Pages: 1 -->
<svg id="procfida_mcCalledByGraph" width="152pt" height="32pt"
 viewBox="0.00 0.00 152.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~fida_mc~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~fida_mc~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 148,-28 148,4 -4,4"/>
<!-- proc~fida_mc -->
<g id="proc~~fida_mc~~CalledByGraph_node1" class="node"><title>proc~fida_mc</title>
<polygon fill="none" stroke="black" points="144,-24 90,-24 90,-0 144,-0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">fida_mc</text>
</g>
<!-- program~fidasim -->
<g id="proc~~fida_mc~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~fida_mc~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_mc -->
<g id="proc~~fida_mc~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~fida_mc</title>
<path fill="none" stroke="#000000" d="M54.4029,-12C62.3932,-12 71.3106,-12 79.8241,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.919,-15.5001 89.919,-12 79.919,-8.5001 79.919,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/fida_mc.html#src">fida_mc</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">fida_mc</span>
    <span class="c">!+ Calculate Active FIDA emission using a Monte Carlo Fast-ion distribution</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iion</span><span class="p">,</span><span class="n">igamma</span><span class="p">,</span><span class="n">ngamma</span>
    <span class="k">type</span><span class="p">(</span><span class="n">FastIon</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fast_ion</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fields</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span> <span class="kd">::</span> <span class="n">plasma</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">phi</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ri</span>      <span class="c">!! start position</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vi</span>      <span class="c">!! velocity of fast ions</span>
    <span class="c">!! Determination of the CX probability</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">denn</span>    <span class="c">!!  neutral dens (n=1-4)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rates</span>    <span class="c">!! CX rates</span>
    <span class="c">!! Collisiional radiative model along track</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">states</span>  <span class="c">! Density of n-states</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ntrack</span>
    <span class="k">type</span><span class="p">(</span><span class="n">ParticleTrack</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ntrack</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tracks</span>
    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">los_intersect</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">jj</span>      <span class="c">!! counter along track</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">photons</span> <span class="c">!! photon flux</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="kd">::</span> <span class="n">neut_types</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">uvw</span><span class="p">,</span> <span class="n">uvw_vi</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">s</span><span class="p">,</span> <span class="n">c</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">randomu</span>

    <span class="n">ngamma</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">.</span><span class="nb">or</span><span class="p">.(</span><span class="n">inputs</span><span class="p">%</span><span class="n">dist_type</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">))</span> <span class="k">then</span>
<span class="k">        </span><span class="n">ngamma</span> <span class="o">=</span> <span class="nb">ceiling</span><span class="p">(</span><span class="nb">dble</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_fida</span><span class="p">)</span><span class="o">/</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="p">)</span>
    <span class="k">endif</span>

<span class="k">    if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i10)&#39;</span><span class="p">)</span> <span class="nb">int</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="o">*</span><span class="n">ngamma</span><span class="p">,</span><span class="n">Int64</span><span class="p">)</span>
    <span class="k">endif</span>

    <span class="c">!$OMP PARALLEL DO schedule(dynamic,1) private(iion,igamma,fast_ion,vi,ri,phi,tracks,s,c, &amp;</span>
    <span class="c">!$OMP&amp; randomu,plasma,fields,uvw,uvw_vi,ntrack,jj,rates,denn,los_intersect,states,photons)</span>
    <span class="n">loop_over_fast_ions</span><span class="p">:</span> <span class="k">do </span><span class="n">iion</span><span class="o">=</span><span class="n">istart</span><span class="p">,</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="p">,</span><span class="n">istep</span>
        <span class="n">fast_ion</span> <span class="o">=</span> <span class="n">particles</span><span class="p">%</span><span class="n">fast_ion</span><span class="p">(</span><span class="n">iion</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vabs</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">loop_over_fast_ions</span>
        <span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">beam_grid_cross_grid</span><span class="p">)</span> <span class="k">cycle </span><span class="n">loop_over_fast_ions</span>
        <span class="n">gamma_loop</span><span class="p">:</span> <span class="k">do </span><span class="n">igamma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ngamma</span>
            <span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">)</span> <span class="k">then</span>
                <span class="c">!! Pick random toroidal angle</span>
                <span class="k">call </span><span class="n">randu</span><span class="p">(</span><span class="n">randomu</span><span class="p">)</span>
                <span class="n">phi</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">beam_grid_phi_enter</span> <span class="o">+</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">delta_phi</span><span class="o">*</span><span class="n">randomu</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span>
<span class="k">                </span><span class="n">phi</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">phi</span>
            <span class="k">endif</span>
<span class="k">            </span><span class="n">s</span> <span class="o">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="nb">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>

            <span class="c">!! Calculate position in machine coordinates</span>
            <span class="n">uvw</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">c</span>
            <span class="n">uvw</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">s</span>
            <span class="n">uvw</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">z</span>

            <span class="c">!! Convert to beam grid coordinates</span>
            <span class="k">call </span><span class="n">uvw_to_xyz</span><span class="p">(</span><span class="n">uvw</span><span class="p">,</span> <span class="n">ri</span><span class="p">)</span>

            <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">dist_type</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
                <span class="c">!! Get electomagnetic fields</span>
                <span class="k">call </span><span class="n">get_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">)</span>

                <span class="c">!! Correct for gyro motion and get particle position and velocity</span>
                <span class="k">call </span><span class="n">gyro_correction</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">energy</span><span class="p">,</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">pitch</span><span class="p">,</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">A</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">)</span>
            <span class="k">else</span> <span class="c">!! Full Orbit</span>
                <span class="c">!! Calculate velocity vector</span>
                <span class="n">uvw_vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vr</span> <span class="o">-</span> <span class="n">s</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vt</span>
                <span class="n">uvw_vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vr</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vt</span>
                <span class="n">uvw_vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">vz</span>
                <span class="n">vi</span> <span class="o">=</span> <span class="nb">matmul</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">inv_basis</span><span class="p">,</span><span class="n">uvw_vi</span><span class="p">)</span>
            <span class="k">endif</span>

            <span class="c">!! Track particle through grid</span>
            <span class="k">call </span><span class="n">track</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">,</span> <span class="n">tracks</span><span class="p">,</span> <span class="n">ntrack</span><span class="p">,</span> <span class="n">los_intersect</span><span class="p">)</span>
            <span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">los_intersect</span><span class="p">)</span> <span class="k">cycle </span><span class="n">gamma_loop</span>
            <span class="k">if</span><span class="p">(</span><span class="n">ntrack</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">cycle </span><span class="n">gamma_loop</span>

            <span class="c">!! Calculate CX probability</span>
            <span class="k">call </span><span class="n">get_total_cx_rate</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">ind</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">,</span> <span class="n">neut_types</span><span class="p">,</span> <span class="n">rates</span><span class="p">)</span>
            <span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span><span class="k">cycle </span><span class="n">gamma_loop</span>

            <span class="c">!! Weight CX rates by ion source density</span>
            <span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">weight</span><span class="o">*</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">delta_phi</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">/</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="o">/</span><span class="n">ngamma</span>

            <span class="c">!! Calculate the spectra produced in each cell along the path</span>
            <span class="n">loop_along_track</span><span class="p">:</span> <span class="k">do </span><span class="n">jj</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ntrack</span>
                <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">)</span>

                <span class="k">call </span><span class="n">colrad</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">A</span><span class="p">,</span> <span class="n">vi</span><span class="p">,</span> <span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="nb">time</span><span class="p">,</span> <span class="n">states</span><span class="p">,</span> <span class="n">denn</span><span class="p">,</span> <span class="n">photons</span><span class="p">)</span>

                <span class="k">call </span><span class="n">store_fida_photons</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span> <span class="n">vi</span><span class="p">,</span> <span class="n">beam_lambda0</span><span class="p">,</span> <span class="n">photons</span><span class="p">,</span> <span class="n">fast_ion</span><span class="p">%</span><span class="k">class</span><span class="p">)</span>
            <span class="k">enddo </span><span class="n">loop_along_track</span>
        <span class="k">enddo </span><span class="n">gamma_loop</span>
    <span class="k">enddo </span><span class="n">loop_over_fast_ions</span>
    <span class="c">!$OMP END PARALLEL DO</span>

<span class="cp">#ifdef _MPI</span>
    <span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">fida</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="k">end subroutine </span><span class="n">fida_mc</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2021 
                                          </p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            
            
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>