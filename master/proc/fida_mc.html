<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="">
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>fida_mc &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>User Guide</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>fida_mc
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.5% of total for procedures.">68 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
     <li><a href='../module/libfida.html'>libfida</a></li>
     <li class="active">fida_mc</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/fida_mc.html#src">fida_mc</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public subroutine fida_mc()</h2>
    

    <p>Calculate Active FIDA emission using a Monte Carlo Fast-ion distribution</p>

    <h3>Arguments</h3>
    <em>None</em>
    <br>
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~fida_mc~~CallsGraph Pages: 1 -->
<svg id="procfida_mcCallsGraph" width="641pt" height="978pt"
 viewBox="0.00 0.00 641.00 978.01" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~fida_mc~~CallsGraph" class="graph" transform="scale(0.750585 0.750585) rotate(0) translate(4 1299)">
<title>proc~~fida_mc~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1299 850,-1299 850,4 -4,4"/>
<!-- proc~fida_mc -->
<g id="proc~~fida_mc~~CallsGraph_node1" class="node"><title>proc~fida_mc</title>
<polygon fill="none" stroke="black" points="54,-321 0,-321 0,-297 54,-297 54,-321"/>
<text text-anchor="middle" x="27" y="-306.6" font-family="Helvetica,sans-Serif" font-size="10.50">fida_mc</text>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~fida_mc~~CallsGraph_node2" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~fida_mc~~CallsGraph_node2"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="178.5,-1082 105.5,-1082 105.5,-1058 178.5,-1058 178.5,-1082"/>
<text text-anchor="middle" x="142" y="-1067.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;interface~parallel_sum -->
<g id="proc~~fida_mc~~CallsGraph_edge1" class="edge"><title>proc~fida_mc&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M29.8207,-321.262C42.7467,-408.312 120.614,-932.713 137.691,-1047.72"/>
<polygon fill="#000000" stroke="#000000" points="134.259,-1048.44 139.19,-1057.81 141.184,-1047.41 134.259,-1048.44"/>
</g>
<!-- proc~colrad -->
<g id="proc~~fida_mc~~CallsGraph_node3" class="node"><title>proc~colrad</title>
<g id="a_proc~~fida_mc~~CallsGraph_node3"><a xlink:href=".././proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="169,-562 115,-562 115,-538 169,-538 169,-562"/>
<text text-anchor="middle" x="142" y="-547.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~colrad -->
<g id="proc~~fida_mc~~CallsGraph_edge2" class="edge"><title>proc~fida_mc&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M30.4876,-321.08C37.017,-351.137 56.4926,-431.104 90,-490 98.3776,-504.725 110.595,-519.254 120.972,-530.326"/>
<polygon fill="#000000" stroke="#000000" points="118.657,-532.967 128.121,-537.73 123.693,-528.105 118.657,-532.967"/>
</g>
<!-- proc~track -->
<g id="proc~~fida_mc~~CallsGraph_node4" class="node"><title>proc~track</title>
<g id="a_proc~~fida_mc~~CallsGraph_node4"><a xlink:href=".././proc/track.html" xlink:title="track">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-383 249,-383 249,-359 303,-359 303,-383"/>
<text text-anchor="middle" x="276" y="-368.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~track -->
<g id="proc~~fida_mc~~CallsGraph_edge4" class="edge"><title>proc~fida_mc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M46.8017,-321.138C58.7264,-328.287 74.7332,-336.902 90,-342 140.031,-358.708 200.954,-365.886 238.867,-368.903"/>
<polygon fill="#000000" stroke="#000000" points="238.691,-372.399 248.922,-369.648 239.208,-365.418 238.691,-372.399"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~fida_mc~~CallsGraph_node5" class="node"><title>proc~get_fields</title>
<g id="a_proc~~fida_mc~~CallsGraph_node5"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="454,-300 396,-300 396,-276 454,-276 454,-300"/>
<text text-anchor="middle" x="425" y="-285.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~get_fields -->
<g id="proc~~fida_mc~~CallsGraph_edge9" class="edge"><title>proc~fida_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M54.2893,-307.606C122.567,-303.985 305.757,-294.27 385.749,-290.028"/>
<polygon fill="#000000" stroke="#000000" points="386.079,-293.516 395.88,-289.491 385.708,-286.526 386.079,-293.516"/>
</g>
<!-- proc~gyro_correction -->
<g id="proc~~fida_mc~~CallsGraph_node6" class="node"><title>proc~gyro_correction</title>
<g id="a_proc~~fida_mc~~CallsGraph_node6"><a xlink:href=".././proc/gyro_correction.html" xlink:title="gyro_correction">
<polygon fill="#d9534f" stroke="#d9534f" points="185.5,-67 98.5,-67 98.5,-43 185.5,-43 185.5,-67"/>
<text text-anchor="middle" x="142" y="-52.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_correction</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~gyro_correction -->
<g id="proc~~fida_mc~~CallsGraph_edge5" class="edge"><title>proc~fida_mc&#45;&gt;proc~gyro_correction</title>
<path fill="none" stroke="#000000" d="M28.1431,-296.752C29.1814,-260.219 36.8095,-150.383 90,-83 93.0842,-79.0928 96.871,-75.6523 100.975,-72.6436"/>
<polygon fill="#000000" stroke="#000000" points="103.175,-75.3919 109.723,-67.0631 99.4104,-69.4905 103.175,-75.3919"/>
</g>
<!-- proc~get_total_cx_rate -->
<g id="proc~~fida_mc~~CallsGraph_node7" class="node"><title>proc~get_total_cx_rate</title>
<g id="a_proc~~fida_mc~~CallsGraph_node7"><a xlink:href=".././proc/get_total_cx_rate.html" xlink:title="get_total_cx_rate">
<polygon fill="#d9534f" stroke="#d9534f" points="189.5,-481 94.5,-481 94.5,-457 189.5,-457 189.5,-481"/>
<text text-anchor="middle" x="142" y="-466.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_total_cx_rate</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~get_total_cx_rate -->
<g id="proc~~fida_mc~~CallsGraph_edge6" class="edge"><title>proc~fida_mc&#45;&gt;proc~get_total_cx_rate</title>
<path fill="none" stroke="#000000" d="M36.4934,-321.026C55.7169,-348.245 102.738,-414.823 126.602,-448.613"/>
<polygon fill="#000000" stroke="#000000" points="123.78,-450.685 132.408,-456.834 129.498,-446.647 123.78,-450.685"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~fida_mc~~CallsGraph_node8" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~fida_mc~~CallsGraph_node8"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="459,-384 391,-384 391,-360 459,-360 459,-384"/>
<text text-anchor="middle" x="425" y="-369.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~get_plasma -->
<g id="proc~~fida_mc~~CallsGraph_edge7" class="edge"><title>proc~fida_mc&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M54.0582,-311.978C105.478,-317.999 223.557,-332.544 322,-350 341.325,-353.427 362.561,-357.893 380.63,-361.906"/>
<polygon fill="#000000" stroke="#000000" points="380.063,-365.365 390.587,-364.141 381.596,-358.535 380.063,-365.365"/>
</g>
<!-- proc~store_fida_photons -->
<g id="proc~~fida_mc~~CallsGraph_node9" class="node"><title>proc~store_fida_photons</title>
<g id="a_proc~~fida_mc~~CallsGraph_node9"><a xlink:href=".././proc/store_fida_photons.html" xlink:title="store_fida_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="194,-259 90,-259 90,-235 194,-235 194,-259"/>
<text text-anchor="middle" x="142" y="-244.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_fida_photons</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~store_fida_photons -->
<g id="proc~~fida_mc~~CallsGraph_edge8" class="edge"><title>proc~fida_mc&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M50.0558,-296.899C67.1667,-287.51 91.0932,-274.382 110.11,-263.948"/>
<polygon fill="#000000" stroke="#000000" points="111.916,-266.95 119,-259.071 108.549,-260.813 111.916,-266.95"/>
</g>
<!-- interface~randu -->
<g id="proc~~fida_mc~~CallsGraph_node10" class="node"><title>interface~randu</title>
<g id="a_proc~~fida_mc~~CallsGraph_node10"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="303,-108 249,-108 249,-84 303,-84 303,-108"/>
<text text-anchor="middle" x="276" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;interface~randu -->
<g id="proc~~fida_mc~~CallsGraph_edge3" class="edge"><title>proc~fida_mc&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M27.9594,-296.548C28.5822,-262.537 35.365,-167.566 90,-122 131.702,-87.2198 197.987,-86.8117 238.862,-90.6929"/>
<polygon fill="#000000" stroke="#000000" points="238.607,-94.1857 248.926,-91.7842 239.362,-87.2265 238.607,-94.1857"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~fida_mc~~CallsGraph_node11" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~fida_mc~~CallsGraph_node11"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="846,-228 778,-228 778,-204 846,-204 846,-228"/>
<text text-anchor="middle" x="812" y="-213.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~fida_mc~~CallsGraph_edge10" class="edge"><title>proc~fida_mc&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M34.5521,-296.853C44.535,-279.285 65.0515,-246.633 90,-226 160.461,-167.727 183.564,-136 275,-136 275,-136 275,-136 579,-136 651.935,-136 675.404,-125.261 742,-155 762.869,-164.319 781.946,-182.25 794.725,-196.27"/>
<polygon fill="#000000" stroke="#000000" points="792.262,-198.769 801.488,-203.978 797.524,-194.153 792.262,-198.769"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~fida_mc~~CallsGraph_node12" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~fida_mc~~CallsGraph_node12"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="320,-1166 232,-1166 232,-1142 320,-1142 320,-1166"/>
<text text-anchor="middle" x="276" y="-1151.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~fida_mc~~CallsGraph_edge11" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M157.804,-1082.07C174.658,-1095.48 203.317,-1117.31 230,-1133 232.508,-1134.48 235.137,-1135.93 237.811,-1137.33"/>
<polygon fill="#000000" stroke="#000000" points="236.461,-1140.57 246.969,-1141.93 239.598,-1134.32 236.461,-1140.57"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~fida_mc~~CallsGraph_node14" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~fida_mc~~CallsGraph_node14"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="321.5,-1082 230.5,-1082 230.5,-1058 321.5,-1058 321.5,-1082"/>
<text text-anchor="middle" x="276" y="-1067.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~fida_mc~~CallsGraph_edge16" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M178.721,-1070C191.501,-1070 206.214,-1070 220.231,-1070"/>
<polygon fill="#000000" stroke="#000000" points="220.276,-1073.5 230.276,-1070 220.276,-1066.5 220.276,-1073.5"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~fida_mc~~CallsGraph_node17" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~fida_mc~~CallsGraph_node17"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="321.5,-1040 230.5,-1040 230.5,-1016 321.5,-1016 321.5,-1040"/>
<text text-anchor="middle" x="276" y="-1025.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~fida_mc~~CallsGraph_edge20" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M178.721,-1058.63C193.643,-1053.89 211.202,-1048.3 227.21,-1043.21"/>
<polygon fill="#000000" stroke="#000000" points="228.471,-1046.48 236.939,-1040.11 226.349,-1039.81 228.471,-1046.48"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~fida_mc~~CallsGraph_node19" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~fida_mc~~CallsGraph_node19"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="320,-1295 232,-1295 232,-1271 320,-1271 320,-1295"/>
<text text-anchor="middle" x="276" y="-1280.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~fida_mc~~CallsGraph_edge12" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M146.1,-1082.16C154.686,-1113.87 181.412,-1200.37 230,-1255 233.268,-1258.67 237.132,-1262.03 241.201,-1265.05"/>
<polygon fill="#000000" stroke="#000000" points="239.46,-1268.1 249.717,-1270.75 243.355,-1262.28 239.46,-1268.1"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~fida_mc~~CallsGraph_node20" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~fida_mc~~CallsGraph_node20"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="321.5,-960 230.5,-960 230.5,-936 321.5,-936 321.5,-960"/>
<text text-anchor="middle" x="276" y="-945.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~fida_mc~~CallsGraph_edge14" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M151.893,-1057.98C166.607,-1038.63 197.624,-1000.14 230,-974 233.751,-970.971 237.897,-968.074 242.11,-965.385"/>
<polygon fill="#000000" stroke="#000000" points="243.985,-968.342 250.745,-960.184 240.373,-962.346 243.985,-968.342"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~fida_mc~~CallsGraph_node22" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~fida_mc~~CallsGraph_node22"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="320,-1246 232,-1246 232,-1222 320,-1222 320,-1246"/>
<text text-anchor="middle" x="276" y="-1231.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~fida_mc~~CallsGraph_edge17" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M148.151,-1082.05C159.645,-1107.83 189.59,-1169.12 230,-1208 233.233,-1211.11 236.907,-1213.99 240.73,-1216.62"/>
<polygon fill="#000000" stroke="#000000" points="238.89,-1219.6 249.221,-1221.95 242.611,-1213.67 238.89,-1219.6"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~fida_mc~~CallsGraph_node23" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~fida_mc~~CallsGraph_node23"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="469,-1206 381,-1206 381,-1182 469,-1182 469,-1206"/>
<text text-anchor="middle" x="425" y="-1191.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~fida_mc~~CallsGraph_edge19" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M148.882,-1082.05C160.691,-1104.77 189.649,-1153.57 230,-1175 273.395,-1198.05 329.972,-1201.06 370.818,-1199.36"/>
<polygon fill="#000000" stroke="#000000" points="371.043,-1202.85 380.846,-1198.83 370.676,-1195.86 371.043,-1202.85"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~fida_mc~~CallsGraph_node29" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~fida_mc~~CallsGraph_node29"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="470.5,-994 379.5,-994 379.5,-970 470.5,-970 470.5,-994"/>
<text text-anchor="middle" x="425" y="-979.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~fida_mc~~CallsGraph_edge18" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M155.323,-1057.92C171.159,-1043.2 200.183,-1018.82 230,-1007 274.723,-989.269 329.358,-983.507 369.239,-981.896"/>
<polygon fill="#000000" stroke="#000000" points="369.422,-985.392 379.302,-981.564 369.192,-978.395 369.422,-985.392"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~fida_mc~~CallsGraph_node30" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~fida_mc~~CallsGraph_node30"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="321.5,-1124 230.5,-1124 230.5,-1100 321.5,-1100 321.5,-1124"/>
<text text-anchor="middle" x="276" y="-1109.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~fida_mc~~CallsGraph_edge13" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M178.721,-1081.37C193.643,-1086.11 211.202,-1091.7 227.21,-1096.79"/>
<polygon fill="#000000" stroke="#000000" points="226.349,-1100.19 236.939,-1099.89 228.471,-1093.52 226.349,-1100.19"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~fida_mc~~CallsGraph_node32" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~fida_mc~~CallsGraph_node32"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="321.5,-918 230.5,-918 230.5,-894 321.5,-894 321.5,-918"/>
<text text-anchor="middle" x="276" y="-903.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~fida_mc~~CallsGraph_edge15" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M147.612,-1057.63C158.247,-1030.59 186.923,-965.583 230,-927 231.325,-925.814 232.728,-924.682 234.188,-923.604"/>
<polygon fill="#000000" stroke="#000000" points="236.452,-926.314 243.033,-918.011 232.711,-920.398 236.452,-926.314"/>
</g>
<!-- proc~linsolve -->
<g id="proc~~fida_mc~~CallsGraph_node18" class="node"><title>proc~linsolve</title>
<g id="a_proc~~fida_mc~~CallsGraph_node18"><a xlink:href=".././proc/linsolve.html" xlink:title="linsolve">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-813 249,-813 249,-789 303,-789 303,-813"/>
<text text-anchor="middle" x="276" y="-798.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linsolve</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~linsolve -->
<g id="proc~~fida_mc~~CallsGraph_edge23" class="edge"><title>proc~colrad&#45;&gt;proc~linsolve</title>
<path fill="none" stroke="#000000" d="M149.367,-562.106C170.272,-601.858 237.002,-728.746 263.751,-779.61"/>
<polygon fill="#000000" stroke="#000000" points="260.79,-781.5 268.543,-788.721 266.986,-778.241 260.79,-781.5"/>
</g>
<!-- proc~eigen -->
<g id="proc~~fida_mc~~CallsGraph_node26" class="node"><title>proc~eigen</title>
<g id="a_proc~~fida_mc~~CallsGraph_node26"><a xlink:href=".././proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-645 249,-645 249,-621 303,-621 303,-645"/>
<text text-anchor="middle" x="276" y="-630.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~fida_mc~~CallsGraph_edge22" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M162.194,-562.069C184.581,-576.145 221.77,-599.53 247.287,-615.575"/>
<polygon fill="#000000" stroke="#000000" points="245.454,-618.556 255.783,-620.917 249.18,-612.631 245.454,-618.556"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~fida_mc~~CallsGraph_node31" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~fida_mc~~CallsGraph_node31"><a xlink:href=".././proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="622,-550 534,-550 534,-526 622,-526 622,-550"/>
<text text-anchor="middle" x="578" y="-535.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~fida_mc~~CallsGraph_edge21" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M169.171,-549.276C238.857,-547.35 429.976,-542.065 523.724,-539.473"/>
<polygon fill="#000000" stroke="#000000" points="523.945,-542.968 533.845,-539.193 523.752,-535.971 523.945,-542.968"/>
</g>
<!-- proc~track&#45;&gt;proc~get_fields -->
<g id="proc~~fida_mc~~CallsGraph_edge28" class="edge"><title>proc~track&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M289.782,-358.935C304.98,-345.159 331.62,-322.756 358,-309 366.783,-304.42 376.749,-300.613 386.226,-297.555"/>
<polygon fill="#000000" stroke="#000000" points="387.298,-300.888 395.855,-294.64 385.269,-294.188 387.298,-300.888"/>
</g>
<!-- proc~track&#45;&gt;proc~get_plasma -->
<g id="proc~~fida_mc~~CallsGraph_edge27" class="edge"><title>proc~track&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M303.281,-371.179C324.838,-371.325 355.792,-371.536 380.959,-371.707"/>
<polygon fill="#000000" stroke="#000000" points="380.968,-375.207 390.992,-371.775 381.016,-368.207 380.968,-375.207"/>
</g>
<!-- proc~doppler_stark -->
<g id="proc~~fida_mc~~CallsGraph_node13" class="node"><title>proc~doppler_stark</title>
<g id="a_proc~~fida_mc~~CallsGraph_node13"><a xlink:href=".././proc/doppler_stark.html" xlink:title="doppler_stark">
<polygon fill="#d9534f" stroke="#d9534f" points="464,-426 386,-426 386,-402 464,-402 464,-426"/>
<text text-anchor="middle" x="425" y="-411.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">doppler_stark</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~doppler_stark -->
<g id="proc~~fida_mc~~CallsGraph_edge25" class="edge"><title>proc~track&#45;&gt;proc~doppler_stark</title>
<path fill="none" stroke="#000000" d="M303.281,-378.688C323.459,-384.59 351.87,-392.901 376.062,-399.977"/>
<polygon fill="#000000" stroke="#000000" points="375.208,-403.374 385.788,-402.822 377.173,-396.656 375.208,-403.374"/>
</g>
<!-- proc~get_indices -->
<g id="proc~~fida_mc~~CallsGraph_node25" class="node"><title>proc~get_indices</title>
<g id="a_proc~~fida_mc~~CallsGraph_node25"><a xlink:href=".././proc/get_indices.html" xlink:title="get_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="458.5,-342 391.5,-342 391.5,-318 458.5,-318 458.5,-342"/>
<text text-anchor="middle" x="425" y="-327.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_indices</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~get_indices -->
<g id="proc~~fida_mc~~CallsGraph_edge24" class="edge"><title>proc~track&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M303.281,-363.67C325.006,-357.61 356.277,-348.889 381.549,-341.84"/>
<polygon fill="#000000" stroke="#000000" points="382.567,-345.19 391.259,-339.132 380.686,-338.447 382.567,-345.19"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~fida_mc~~CallsGraph_node33" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~fida_mc~~CallsGraph_node33"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="608.5,-466 547.5,-466 547.5,-442 608.5,-442 608.5,-466"/>
<text text-anchor="middle" x="578" y="-451.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~in_plasma -->
<g id="proc~~fida_mc~~CallsGraph_edge26" class="edge"><title>proc~track&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M287.934,-383.215C302.32,-398.36 329.179,-423.568 358,-435 417.116,-458.448 492.065,-459.42 537.186,-457.242"/>
<polygon fill="#000000" stroke="#000000" points="537.651,-460.722 547.439,-456.667 537.259,-453.733 537.651,-460.722"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~fida_mc~~CallsGraph_edge33" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M454.045,-281.864C466.199,-278.513 480.295,-273.661 492,-267 510.606,-256.412 508.256,-243.274 528,-235 607.31,-201.763 710.106,-205.03 767.44,-210.465"/>
<polygon fill="#000000" stroke="#000000" points="767.298,-213.968 777.601,-211.497 768.006,-207.004 767.298,-213.968"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~fida_mc~~CallsGraph_node15" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~fida_mc~~CallsGraph_node15"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="628,-268 528,-268 528,-244 628,-244 628,-268"/>
<text text-anchor="middle" x="578" y="-253.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~fida_mc~~CallsGraph_edge32" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M454.048,-282.056C471.947,-278.263 495.829,-273.202 517.783,-268.549"/>
<polygon fill="#000000" stroke="#000000" points="518.648,-271.944 527.706,-266.447 517.197,-265.096 518.648,-271.944"/>
</g>
<!-- proc~get_position -->
<g id="proc~~fida_mc~~CallsGraph_node21" class="node"><title>proc~get_position</title>
<g id="a_proc~~fida_mc~~CallsGraph_node21"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="613,-386 543,-386 543,-362 613,-362 613,-386"/>
<text text-anchor="middle" x="578" y="-371.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~fida_mc~~CallsGraph_edge30" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M454.144,-294.642C466.184,-298.064 480.164,-302.831 492,-309 515.849,-321.43 539.906,-340.587 556.31,-354.889"/>
<polygon fill="#000000" stroke="#000000" points="554.352,-357.831 564.149,-361.864 559.005,-352.602 554.352,-357.831"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~fida_mc~~CallsGraph_node24" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~fida_mc~~CallsGraph_node24"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="737,-327 669,-327 669,-303 737,-303 737,-327"/>
<text text-anchor="middle" x="703" y="-312.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~fida_mc~~CallsGraph_edge29" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M454.24,-290.763C502.612,-295.495 601.619,-305.18 658.746,-310.769"/>
<polygon fill="#000000" stroke="#000000" points="658.611,-314.272 668.904,-311.762 659.292,-307.305 658.611,-314.272"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~fida_mc~~CallsGraph_edge31" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M454.065,-291.449C466.945,-294.299 481.622,-299.501 492,-309 522.565,-336.977 506.528,-359.562 528,-395 536.468,-408.975 548.077,-423.109 557.87,-434.039"/>
<polygon fill="#000000" stroke="#000000" points="555.58,-436.72 564.923,-441.717 560.735,-431.985 555.58,-436.72"/>
</g>
<!-- proc~gyro_correction&#45;&gt;interface~randu -->
<g id="proc~~fida_mc~~CallsGraph_edge36" class="edge"><title>proc~gyro_correction&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M181.89,-67.0796C199.945,-72.6874 221.275,-79.3127 238.961,-84.8061"/>
<polygon fill="#000000" stroke="#000000" points="238.313,-88.2697 248.901,-87.8936 240.39,-81.5848 238.313,-88.2697"/>
</g>
<!-- proc~pitch_to_vec -->
<g id="proc~~fida_mc~~CallsGraph_node27" class="node"><title>proc~pitch_to_vec</title>
<g id="a_proc~~fida_mc~~CallsGraph_node27"><a xlink:href=".././proc/pitch_to_vec.html" xlink:title="pitch_to_vec">
<polygon fill="#d9534f" stroke="#d9534f" points="312.5,-66 239.5,-66 239.5,-42 312.5,-42 312.5,-66"/>
<text text-anchor="middle" x="276" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pitch_to_vec</text>
</a>
</g>
</g>
<!-- proc~gyro_correction&#45;&gt;proc~pitch_to_vec -->
<g id="proc~~fida_mc~~CallsGraph_edge34" class="edge"><title>proc~gyro_correction&#45;&gt;proc~pitch_to_vec</title>
<path fill="none" stroke="#000000" d="M185.857,-54.6753C199.654,-54.5708 214.996,-54.4546 229.01,-54.3484"/>
<polygon fill="#000000" stroke="#000000" points="229.446,-57.8453 239.419,-54.2696 229.393,-50.8455 229.446,-57.8453"/>
</g>
<!-- proc~gyro_step -->
<g id="proc~~fida_mc~~CallsGraph_node28" class="node"><title>proc~gyro_step</title>
<g id="a_proc~~fida_mc~~CallsGraph_node28"><a xlink:href=".././proc/gyro_step.html" xlink:title="gyro_step">
<polygon fill="#d9534f" stroke="#d9534f" points="306,-24 246,-24 246,-0 306,-0 306,-24"/>
<text text-anchor="middle" x="276" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_step</text>
</a>
</g>
</g>
<!-- proc~gyro_correction&#45;&gt;proc~gyro_step -->
<g id="proc~~fida_mc~~CallsGraph_edge35" class="edge"><title>proc~gyro_correction&#45;&gt;proc~gyro_step</title>
<path fill="none" stroke="#000000" d="M180.121,-42.9077C197.459,-37.2596 218.11,-30.5325 235.711,-24.7987"/>
<polygon fill="#000000" stroke="#000000" points="237.25,-27.9784 245.674,-21.5531 235.082,-21.3227 237.25,-27.9784"/>
</g>
<!-- proc~neutral_cx_rate -->
<g id="proc~~fida_mc~~CallsGraph_node34" class="node"><title>proc~neutral_cx_rate</title>
<g id="a_proc~~fida_mc~~CallsGraph_node34"><a xlink:href=".././proc/neutral_cx_rate.html" xlink:title="neutral_cx_rate">
<polygon fill="#d9534f" stroke="#d9534f" points="319.5,-501 232.5,-501 232.5,-477 319.5,-477 319.5,-501"/>
<text text-anchor="middle" x="276" y="-486.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutral_cx_rate</text>
</a>
</g>
</g>
<!-- proc~get_total_cx_rate&#45;&gt;proc~neutral_cx_rate -->
<g id="proc~~fida_mc~~CallsGraph_edge37" class="edge"><title>proc~get_total_cx_rate&#45;&gt;proc~neutral_cx_rate</title>
<path fill="none" stroke="#000000" d="M189.538,-476.051C200.113,-477.654 211.42,-479.367 222.233,-481.005"/>
<polygon fill="#000000" stroke="#000000" points="221.997,-484.509 232.408,-482.547 223.045,-477.588 221.997,-484.509"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~fida_mc~~CallsGraph_edge40" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M459.335,-382.848C499.751,-394.393 569.699,-409.193 628,-395 683.431,-381.506 700.777,-375.438 742,-336 771.74,-307.548 792.57,-263.457 803.101,-237.386"/>
<polygon fill="#000000" stroke="#000000" points="806.375,-238.624 806.747,-228.035 799.853,-236.081 806.375,-238.624"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~fida_mc~~CallsGraph_edge39" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M459.138,-372.439C480.766,-372.725 509.252,-373.103 532.801,-373.415"/>
<polygon fill="#000000" stroke="#000000" points="532.848,-376.915 542.893,-373.548 532.941,-369.916 532.848,-376.915"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~fida_mc~~CallsGraph_edge38" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M459.018,-365.181C508.992,-354.86 603.853,-335.269 659.108,-323.858"/>
<polygon fill="#000000" stroke="#000000" points="659.859,-327.277 668.944,-321.827 658.443,-320.422 659.859,-327.277"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~fida_mc~~CallsGraph_edge41" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M459.174,-379.304C470.095,-382.54 481.994,-387.006 492,-393 511.144,-404.467 509.963,-414.861 528,-428 532.427,-431.225 537.306,-434.3 542.217,-437.133"/>
<polygon fill="#000000" stroke="#000000" points="540.55,-440.211 551.001,-441.951 543.916,-434.073 540.55,-440.211"/>
</g>
<!-- proc~store_photons -->
<g id="proc~~fida_mc~~CallsGraph_node16" class="node"><title>proc~store_photons</title>
<g id="a_proc~~fida_mc~~CallsGraph_node16"><a xlink:href=".././proc/store_photons.html" xlink:title="store_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="316.5,-259 235.5,-259 235.5,-235 316.5,-235 316.5,-259"/>
<text text-anchor="middle" x="276" y="-244.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_photons</text>
</a>
</g>
</g>
<!-- proc~store_fida_photons&#45;&gt;proc~store_photons -->
<g id="proc~~fida_mc~~CallsGraph_edge42" class="edge"><title>proc~store_fida_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M194.035,-247C204.157,-247 214.776,-247 224.868,-247"/>
<polygon fill="#000000" stroke="#000000" points="225.152,-250.5 235.152,-247 225.152,-243.5 225.152,-250.5"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~fida_mc~~CallsGraph_edge43" class="edge"><title>proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M320.31,-1165.78C336.16,-1170.1 354.278,-1175.03 370.887,-1179.55"/>
<polygon fill="#000000" stroke="#000000" points="370.432,-1183.05 381,-1182.3 372.27,-1176.3 370.432,-1183.05"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_node39" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="617.5,-1109 538.5,-1109 538.5,-1085 617.5,-1085 617.5,-1109"/>
<text text-anchor="middle" x="578" y="-1094.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge44" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M320.011,-1147.79C363.543,-1141.27 432.703,-1130.27 492,-1118 503.862,-1115.55 516.575,-1112.58 528.46,-1109.67"/>
<polygon fill="#000000" stroke="#000000" points="529.352,-1113.05 538.212,-1107.24 527.663,-1106.26 529.352,-1113.05"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~fida_mc~~CallsGraph_edge45" class="edge"><title>proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M304.446,-1057.96C310.318,-1055.17 316.429,-1052.11 322,-1049 349.077,-1033.89 378.529,-1014.16 398.792,-1000.03"/>
<polygon fill="#000000" stroke="#000000" points="400.978,-1002.77 407.147,-994.16 396.953,-997.047 400.978,-1002.77"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge46" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M321.589,-1074.01C376.907,-1078.99 470.899,-1087.45 528.13,-1092.6"/>
<polygon fill="#000000" stroke="#000000" points="528.097,-1096.11 538.37,-1093.52 528.725,-1089.14 528.097,-1096.11"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_fields -->
<g id="proc~~fida_mc~~CallsGraph_edge50" class="edge"><title>proc~store_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M316.78,-258.095C338.361,-264.114 364.893,-271.514 386.165,-277.447"/>
<polygon fill="#000000" stroke="#000000" points="385.262,-280.829 395.835,-280.144 387.143,-274.086 385.262,-280.829"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~fida_mc~~CallsGraph_edge51" class="edge"><title>proc~store_photons&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M288.658,-234.769C303.383,-220.09 330.178,-195.852 358,-183 483.893,-124.846 525.995,-135.621 664,-122 698.499,-118.595 711.073,-106.337 742,-122 771.891,-137.138 791.973,-171.992 802.435,-194.742"/>
<polygon fill="#000000" stroke="#000000" points="799.242,-196.176 806.448,-203.943 805.658,-193.378 799.242,-196.176"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_indices -->
<g id="proc~~fida_mc~~CallsGraph_edge48" class="edge"><title>proc~store_photons&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M289.782,-259.065C304.98,-272.841 331.62,-295.244 358,-309 365.352,-312.834 373.533,-316.126 381.562,-318.891"/>
<polygon fill="#000000" stroke="#000000" points="380.623,-322.265 391.215,-322.001 382.77,-315.603 380.623,-322.265"/>
</g>
<!-- proc~get_passive_grid_indices -->
<g id="proc~~fida_mc~~CallsGraph_node37" class="node"><title>proc~get_passive_grid_indices</title>
<g id="a_proc~~fida_mc~~CallsGraph_node37"><a xlink:href=".././proc/get_passive_grid_indices.html" xlink:title="get_passive_grid_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="491.5,-258 358.5,-258 358.5,-234 491.5,-234 491.5,-258"/>
<text text-anchor="middle" x="425" y="-243.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_passive_grid_indices</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_passive_grid_indices -->
<g id="proc~~fida_mc~~CallsGraph_edge47" class="edge"><title>proc~store_photons&#45;&gt;proc~get_passive_grid_indices</title>
<path fill="none" stroke="#000000" d="M316.78,-246.729C326.61,-246.663 337.468,-246.589 348.388,-246.514"/>
<polygon fill="#000000" stroke="#000000" points="348.43,-250.014 358.406,-246.446 348.382,-243.014 348.43,-250.014"/>
</g>
<!-- proc~spectrum -->
<g id="proc~~fida_mc~~CallsGraph_node45" class="node"><title>proc~spectrum</title>
<g id="a_proc~~fida_mc~~CallsGraph_node45"><a xlink:href=".././proc/spectrum.html" xlink:title="spectrum">
<polygon fill="#d9534f" stroke="#d9534f" points="453.5,-216 396.5,-216 396.5,-192 453.5,-192 453.5,-216"/>
<text text-anchor="middle" x="425" y="-201.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spectrum</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~spectrum -->
<g id="proc~~fida_mc~~CallsGraph_edge49" class="edge"><title>proc~store_photons&#45;&gt;proc~spectrum</title>
<path fill="none" stroke="#000000" d="M316.78,-235.364C338.508,-229.008 365.254,-221.184 386.598,-214.941"/>
<polygon fill="#000000" stroke="#000000" points="387.676,-218.272 396.291,-212.105 385.711,-211.554 387.676,-218.272"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~fida_mc~~CallsGraph_edge52" class="edge"><title>proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M315.623,-1015.91C334.106,-1010.13 356.421,-1003.15 375.986,-997.025"/>
<polygon fill="#000000" stroke="#000000" points="377.137,-1000.33 385.635,-994.005 375.047,-993.651 377.137,-1000.33"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge53" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M321.673,-1036.42C365.301,-1044.86 433.484,-1058.63 492,-1073 503.867,-1075.91 516.582,-1079.34 528.467,-1082.67"/>
<polygon fill="#000000" stroke="#000000" points="527.643,-1086.08 538.219,-1085.44 529.555,-1079.34 527.643,-1086.08"/>
</g>
<!-- dgetrf -->
<g id="proc~~fida_mc~~CallsGraph_node40" class="node"><title>dgetrf</title>
<polygon fill="#777777" stroke="#777777" points="452,-792 398,-792 398,-768 452,-768 452,-792"/>
<text text-anchor="middle" x="425" y="-777.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrf</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrf -->
<g id="proc~~fida_mc~~CallsGraph_edge56" class="edge"><title>proc~linsolve&#45;&gt;dgetrf</title>
<path fill="none" stroke="#000000" d="M303.281,-797.246C326.902,-793.871 361.807,-788.885 388.016,-785.141"/>
<polygon fill="#000000" stroke="#000000" points="388.542,-788.601 397.947,-783.722 387.552,-781.671 388.542,-788.601"/>
</g>
<!-- proc~matinv -->
<g id="proc~~fida_mc~~CallsGraph_node46" class="node"><title>proc~matinv</title>
<g id="a_proc~~fida_mc~~CallsGraph_node46"><a xlink:href=".././proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="452,-876 398,-876 398,-852 452,-852 452,-876"/>
<text text-anchor="middle" x="425" y="-861.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~linsolve&#45;&gt;proc~matinv -->
<g id="proc~~fida_mc~~CallsGraph_edge54" class="edge"><title>proc~linsolve&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M297.847,-813.064C313.935,-822.064 336.93,-834.26 358,-843 367.663,-847.008 378.381,-850.717 388.32,-853.868"/>
<polygon fill="#000000" stroke="#000000" points="387.346,-857.23 397.933,-856.823 389.402,-850.539 387.346,-857.23"/>
</g>
<!-- dgetrs -->
<g id="proc~~fida_mc~~CallsGraph_node49" class="node"><title>dgetrs</title>
<polygon fill="#777777" stroke="#777777" points="452,-834 398,-834 398,-810 452,-810 452,-834"/>
<text text-anchor="middle" x="425" y="-819.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrs</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrs -->
<g id="proc~~fida_mc~~CallsGraph_edge55" class="edge"><title>proc~linsolve&#45;&gt;dgetrs</title>
<path fill="none" stroke="#000000" d="M303.281,-804.754C326.902,-808.129 361.807,-813.115 388.016,-816.859"/>
<polygon fill="#000000" stroke="#000000" points="387.552,-820.329 397.947,-818.278 388.542,-813.399 387.552,-820.329"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge57" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M320.22,-1288.82C366.77,-1292.75 441.003,-1291.99 492,-1257 540.183,-1223.94 563.198,-1154.6 572.198,-1119.05"/>
<polygon fill="#000000" stroke="#000000" points="575.637,-1119.72 574.554,-1109.18 568.828,-1118.09 575.637,-1119.72"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~fida_mc~~CallsGraph_edge58" class="edge"><title>proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M321.504,-958.293C336.546,-961.773 353.518,-965.698 369.26,-969.339"/>
<polygon fill="#000000" stroke="#000000" points="368.862,-972.839 379.394,-971.683 370.44,-966.019 368.862,-972.839"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge59" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M321.612,-939.451C367.661,-933.063 439.926,-930.047 492,-961 535.222,-986.691 559.762,-1043.81 570.469,-1075.24"/>
<polygon fill="#000000" stroke="#000000" points="567.165,-1076.39 573.577,-1084.82 573.824,-1074.23 567.165,-1076.39"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~fida_mc~~CallsGraph_node38" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~fida_mc~~CallsGraph_node38"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="734,-427 672,-427 672,-403 734,-403 734,-427"/>
<text text-anchor="middle" x="703" y="-412.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~fida_mc~~CallsGraph_edge60" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M613.262,-385.421C628.45,-390.483 646.414,-396.471 662.194,-401.731"/>
<polygon fill="#000000" stroke="#000000" points="661.098,-405.055 671.692,-404.897 663.312,-398.414 661.098,-405.055"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~fida_mc~~CallsGraph_edge61" class="edge"><title>proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M320.31,-1222.22C336.16,-1217.9 354.278,-1212.97 370.887,-1208.45"/>
<polygon fill="#000000" stroke="#000000" points="372.27,-1211.7 381,-1205.7 370.432,-1204.95 372.27,-1211.7"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge62" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M320.045,-1245.34C365.776,-1254.88 438.69,-1262.71 492,-1233 535.921,-1208.52 560.174,-1150.9 570.651,-1119.08"/>
<polygon fill="#000000" stroke="#000000" points="574.046,-1119.95 573.685,-1109.36 567.364,-1117.87 574.046,-1119.95"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~fida_mc~~CallsGraph_edge63" class="edge"><title>proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M400.529,-1206.01C391.984,-1214.97 400.141,-1224 425,-1224 440.149,-1224 449.095,-1220.65 451.839,-1216"/>
<polygon fill="#000000" stroke="#000000" points="455.184,-1214.94 449.471,-1206.01 448.373,-1216.55 455.184,-1214.94"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge64" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M462.61,-1181.98C472.455,-1178.11 482.892,-1173.41 492,-1168 516.583,-1153.41 541.281,-1131.82 557.669,-1116.28"/>
<polygon fill="#000000" stroke="#000000" points="560.245,-1118.66 565.01,-1109.2 555.384,-1113.62 560.245,-1118.66"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~fida_mc~~CallsGraph_node36" class="node"><title>proc~hqr2</title>
<g id="a_proc~~fida_mc~~CallsGraph_node36"><a xlink:href=".././proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="452,-750 398,-750 398,-726 452,-726 452,-750"/>
<text text-anchor="middle" x="425" y="-735.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~fida_mc~~CallsGraph_edge65" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M285.54,-645.122C298.952,-663.296 326.679,-697.545 358,-717 367.116,-722.662 377.898,-726.929 388.076,-730.085"/>
<polygon fill="#000000" stroke="#000000" points="387.394,-733.529 397.969,-732.881 389.298,-726.793 387.394,-733.529"/>
</g>
<!-- proc~balback -->
<g id="proc~~fida_mc~~CallsGraph_node41" class="node"><title>proc~balback</title>
<g id="a_proc~~fida_mc~~CallsGraph_node41"><a xlink:href=".././proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="452,-624 398,-624 398,-600 452,-600 452,-624"/>
<text text-anchor="middle" x="425" y="-609.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~fida_mc~~CallsGraph_edge66" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M303.281,-629.246C326.902,-625.871 361.807,-620.885 388.016,-617.141"/>
<polygon fill="#000000" stroke="#000000" points="388.542,-620.601 397.947,-615.722 387.552,-613.671 388.542,-620.601"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~fida_mc~~CallsGraph_node42" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~fida_mc~~CallsGraph_node42"><a xlink:href=".././proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="452,-582 398,-582 398,-558 452,-558 452,-582"/>
<text text-anchor="middle" x="425" y="-567.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~fida_mc~~CallsGraph_edge67" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M297.847,-620.936C313.935,-611.936 336.93,-599.74 358,-591 367.663,-586.992 378.381,-583.283 388.32,-580.132"/>
<polygon fill="#000000" stroke="#000000" points="389.402,-583.461 397.933,-577.177 387.346,-576.77 389.402,-583.461"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~fida_mc~~CallsGraph_node44" class="node"><title>proc~elmhes</title>
<g id="a_proc~~fida_mc~~CallsGraph_node44"><a xlink:href=".././proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="452,-708 398,-708 398,-684 452,-684 452,-708"/>
<text text-anchor="middle" x="425" y="-693.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~fida_mc~~CallsGraph_edge68" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M297.847,-645.064C313.935,-654.064 336.93,-666.26 358,-675 367.663,-679.008 378.381,-682.717 388.32,-685.868"/>
<polygon fill="#000000" stroke="#000000" points="387.346,-689.23 397.933,-688.823 389.402,-682.539 387.346,-689.23"/>
</g>
<!-- proc~balance -->
<g id="proc~~fida_mc~~CallsGraph_node47" class="node"><title>proc~balance</title>
<g id="a_proc~~fida_mc~~CallsGraph_node47"><a xlink:href=".././proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="452,-666 398,-666 398,-642 452,-642 452,-666"/>
<text text-anchor="middle" x="425" y="-651.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~fida_mc~~CallsGraph_edge69" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M303.281,-636.754C326.902,-640.129 361.807,-645.115 388.016,-648.859"/>
<polygon fill="#000000" stroke="#000000" points="387.552,-652.329 397.947,-650.278 388.542,-645.399 387.552,-652.329"/>
</g>
<!-- proc~cross_product -->
<g id="proc~~fida_mc~~CallsGraph_node43" class="node"><title>proc~cross_product</title>
<g id="a_proc~~fida_mc~~CallsGraph_node43"><a xlink:href=".././proc/cross_product.html" xlink:title="cross_product">
<polygon fill="#d94e8f" stroke="#d94e8f" points="465,-24 385,-24 385,-0 465,-0 465,-24"/>
<text text-anchor="middle" x="425" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cross_product</text>
</a>
</g>
</g>
<!-- proc~gyro_step&#45;&gt;proc~cross_product -->
<g id="proc~~fida_mc~~CallsGraph_edge70" class="edge"><title>proc~gyro_step&#45;&gt;proc~cross_product</title>
<path fill="none" stroke="#000000" d="M306.042,-12C325.634,-12 351.975,-12 374.795,-12"/>
<polygon fill="#000000" stroke="#000000" points="374.996,-15.5001 384.996,-12 374.996,-8.5001 374.996,-15.5001"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~fida_mc~~CallsGraph_edge71" class="edge"><title>proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M400.529,-994.014C391.984,-1002.97 400.141,-1012 425,-1012 440.149,-1012 449.095,-1008.65 451.839,-1004"/>
<polygon fill="#000000" stroke="#000000" points="455.184,-1002.94 449.471,-994.014 448.373,-1004.55 455.184,-1002.94"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge72" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M445.439,-994.174C458.789,-1002.72 476.779,-1014.62 492,-1026 514.499,-1042.82 539.001,-1063.56 555.892,-1078.28"/>
<polygon fill="#000000" stroke="#000000" points="553.703,-1081.01 563.531,-1084.97 558.317,-1075.75 553.703,-1081.01"/>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge73" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M321.589,-1109.77C376.907,-1107 470.899,-1102.31 528.13,-1099.44"/>
<polygon fill="#000000" stroke="#000000" points="528.558,-1102.93 538.37,-1098.93 528.208,-1095.94 528.558,-1102.93"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~fida_mc~~CallsGraph_node50" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~fida_mc~~CallsGraph_node50"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="741.5,-508 664.5,-508 664.5,-484 741.5,-484 741.5,-508"/>
<text text-anchor="middle" x="703" y="-493.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~fida_mc~~CallsGraph_edge74" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M614.247,-525.964C627.628,-521.395 643.051,-516.129 657.198,-511.298"/>
<polygon fill="#000000" stroke="#000000" points="658.416,-514.581 666.748,-508.037 656.153,-507.957 658.416,-514.581"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~fida_mc~~CallsGraph_edge75" class="edge"><title>proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M303.773,-918.184C309.801,-921.013 316.145,-924.058 322,-927 346.21,-939.164 373.176,-953.75 393.298,-964.845"/>
<polygon fill="#000000" stroke="#000000" points="391.861,-968.05 402.305,-969.829 395.251,-961.925 391.861,-968.05"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~fida_mc~~CallsGraph_edge76" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M321.584,-899.675C368.275,-895.492 441.678,-896.079 492,-931 541.659,-965.461 564.094,-1037.94 572.602,-1074.66"/>
<polygon fill="#000000" stroke="#000000" points="569.267,-1075.8 574.81,-1084.83 576.108,-1074.31 569.267,-1075.8"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~fida_mc~~CallsGraph_edge78" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M589.915,-441.665C611.305,-417.493 658.886,-363.722 684.64,-334.619"/>
<polygon fill="#000000" stroke="#000000" points="687.279,-336.918 691.285,-327.109 682.037,-332.279 687.279,-336.918"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~fida_mc~~CallsGraph_node48" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~fida_mc~~CallsGraph_node48"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="844.5,-447 779.5,-447 779.5,-423 844.5,-423 844.5,-447"/>
<text text-anchor="middle" x="812" y="-432.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~fida_mc~~CallsGraph_edge77" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M608.855,-451.555C649.701,-448.21 723.193,-442.191 769.412,-438.406"/>
<polygon fill="#000000" stroke="#000000" points="769.724,-441.892 779.405,-437.588 769.152,-434.916 769.724,-441.892"/>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~fida_mc~~CallsGraph_edge79" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M608.775,-464.167C623.259,-469.113 640.976,-475.162 657.06,-480.655"/>
<polygon fill="#000000" stroke="#000000" points="656.226,-484.068 666.82,-483.987 658.488,-477.444 656.226,-484.068"/>
</g>
<!-- proc~bb_cx_rates -->
<g id="proc~~fida_mc~~CallsGraph_node35" class="node"><title>proc~bb_cx_rates</title>
<g id="a_proc~~fida_mc~~CallsGraph_node35"><a xlink:href=".././proc/bb_cx_rates.html" xlink:title="bb_cx_rates">
<polygon fill="#d9534f" stroke="#d9534f" points="613.5,-508 542.5,-508 542.5,-484 613.5,-484 613.5,-508"/>
<text text-anchor="middle" x="578" y="-493.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bb_cx_rates</text>
</a>
</g>
</g>
<!-- proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates -->
<g id="proc~~fida_mc~~CallsGraph_edge80" class="edge"><title>proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates</title>
<path fill="none" stroke="#000000" d="M319.664,-489.995C376.011,-491.31 474.792,-493.615 532.192,-494.954"/>
<polygon fill="#000000" stroke="#000000" points="532.33,-498.459 542.409,-495.193 532.493,-491.46 532.33,-498.459"/>
</g>
<!-- proc~bb_cx_rates&#45;&gt;interface~interpol_coeff -->
<g id="proc~~fida_mc~~CallsGraph_edge81" class="edge"><title>proc~bb_cx_rates&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M613.59,-496C626.16,-496 640.598,-496 654.113,-496"/>
<polygon fill="#000000" stroke="#000000" points="654.222,-499.5 664.222,-496 654.222,-492.5 654.222,-499.5"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~fida_mc~~CallsGraph_node53" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~fida_mc~~CallsGraph_node53"><a xlink:href=".././proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="605,-750 551,-750 551,-726 605,-726 605,-750"/>
<text text-anchor="middle" x="578" y="-735.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~fida_mc~~CallsGraph_edge82" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M452.302,-738C476.769,-738 513.446,-738 540.696,-738"/>
<polygon fill="#000000" stroke="#000000" points="540.999,-741.5 550.999,-738 540.999,-734.5 540.999,-741.5"/>
</g>
<!-- proc~xyz_to_cyl -->
<g id="proc~~fida_mc~~CallsGraph_node55" class="node"><title>proc~xyz_to_cyl</title>
<g id="a_proc~~fida_mc~~CallsGraph_node55"><a xlink:href=".././proc/xyz_to_cyl.html" xlink:title="xyz_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="609,-188 547,-188 547,-164 609,-164 609,-188"/>
<text text-anchor="middle" x="578" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_cyl</text>
</a>
</g>
</g>
<!-- proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl -->
<g id="proc~~fida_mc~~CallsGraph_edge83" class="edge"><title>proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl</title>
<path fill="none" stroke="#000000" d="M469.577,-233.913C477.185,-231.303 484.923,-228.317 492,-225 509.192,-216.942 511.601,-211.569 528,-202 533.222,-198.953 538.83,-195.837 544.32,-192.869"/>
<polygon fill="#000000" stroke="#000000" points="546.181,-195.843 553.36,-188.051 542.889,-189.665 546.181,-195.843"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~fida_mc~~CallsGraph_edge85" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M726.332,-402.931C732.005,-399.062 737.703,-394.366 742,-389 779.201,-342.535 798.579,-273.444 806.531,-238.29"/>
<polygon fill="#000000" stroke="#000000" points="810.033,-238.653 808.719,-228.14 803.19,-237.178 810.033,-238.653"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~fida_mc~~CallsGraph_edge84" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M734.09,-420.624C744.99,-422.662 757.506,-425.001 769.23,-427.193"/>
<polygon fill="#000000" stroke="#000000" points="768.797,-430.672 779.27,-429.069 770.083,-423.791 768.797,-430.672"/>
</g>
<!-- proc~rswap -->
<g id="proc~~fida_mc~~CallsGraph_node52" class="node"><title>proc~rswap</title>
<g id="a_proc~~fida_mc~~CallsGraph_node52"><a xlink:href=".././proc/rswap.html" xlink:title="RSWAP">
<polygon fill="#d9534f" stroke="#d9534f" points="605,-666 551,-666 551,-642 605,-642 605,-666"/>
<text text-anchor="middle" x="578" y="-651.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RSWAP</text>
</a>
</g>
</g>
<!-- proc~balback&#45;&gt;proc~rswap -->
<g id="proc~~fida_mc~~CallsGraph_edge86" class="edge"><title>proc~balback&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M452.302,-619.316C476.878,-626.151 513.771,-636.413 541.057,-644.003"/>
<polygon fill="#000000" stroke="#000000" points="540.427,-647.46 550.999,-646.768 542.303,-640.716 540.427,-647.46"/>
</g>
<!-- proc~elmhes&#45;&gt;proc~rswap -->
<g id="proc~~fida_mc~~CallsGraph_edge87" class="edge"><title>proc~elmhes&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M452.302,-688.684C476.878,-681.849 513.771,-671.587 541.057,-663.997"/>
<polygon fill="#000000" stroke="#000000" points="542.303,-667.284 550.999,-661.232 540.427,-660.54 542.303,-667.284"/>
</g>
<!-- proc~lubksb -->
<g id="proc~~fida_mc~~CallsGraph_node51" class="node"><title>proc~lubksb</title>
<g id="a_proc~~fida_mc~~CallsGraph_node51"><a xlink:href=".././proc/lubksb.html" xlink:title="lubksb">
<polygon fill="#d9534f" stroke="#d9534f" points="605,-855 551,-855 551,-831 605,-831 605,-855"/>
<text text-anchor="middle" x="578" y="-840.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lubksb</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~lubksb -->
<g id="proc~~fida_mc~~CallsGraph_edge89" class="edge"><title>proc~matinv&#45;&gt;proc~lubksb</title>
<path fill="none" stroke="#000000" d="M452.302,-860.342C476.878,-856.924 513.771,-851.793 541.057,-847.999"/>
<polygon fill="#000000" stroke="#000000" points="541.577,-851.46 550.999,-846.616 540.612,-844.527 541.577,-851.46"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~fida_mc~~CallsGraph_node54" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~fida_mc~~CallsGraph_node54"><a xlink:href=".././proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="605,-897 551,-897 551,-873 605,-873 605,-897"/>
<text text-anchor="middle" x="578" y="-882.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~fida_mc~~CallsGraph_edge88" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M452.302,-867.658C476.878,-871.076 513.771,-876.207 541.057,-880.001"/>
<polygon fill="#000000" stroke="#000000" points="540.612,-883.473 550.999,-881.384 541.577,-876.54 540.612,-883.473"/>
</g>
<!-- proc~balance&#45;&gt;proc~rswap -->
<g id="proc~~fida_mc~~CallsGraph_edge90" class="edge"><title>proc~balance&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M452.302,-654C476.769,-654 513.446,-654 540.696,-654"/>
<polygon fill="#000000" stroke="#000000" points="540.999,-657.5 550.999,-654 540.999,-650.5 540.999,-657.5"/>
</g>
<!-- proc~comdiv -->
<g id="proc~~fida_mc~~CallsGraph_node59" class="node"><title>proc~comdiv</title>
<g id="a_proc~~fida_mc~~CallsGraph_node59"><a xlink:href=".././proc/comdiv.html" xlink:title="Comdiv">
<polygon fill="#d9534f" stroke="#d9534f" points="730,-750 676,-750 676,-726 730,-726 730,-750"/>
<text text-anchor="middle" x="703" y="-735.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Comdiv</text>
</a>
</g>
</g>
<!-- proc~hqrvec&#45;&gt;proc~comdiv -->
<g id="proc~~fida_mc~~CallsGraph_edge91" class="edge"><title>proc~hqrvec&#45;&gt;proc~comdiv</title>
<path fill="none" stroke="#000000" d="M605.085,-738C622.779,-738 646.405,-738 665.9,-738"/>
<polygon fill="#000000" stroke="#000000" points="665.952,-741.5 675.952,-738 665.952,-734.5 665.952,-741.5"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~fida_mc~~CallsGraph_node56" class="node"><title>proc~outerprod</title>
<g id="a_proc~~fida_mc~~CallsGraph_node56"><a xlink:href=".././proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="732.5,-918 673.5,-918 673.5,-894 732.5,-894 732.5,-918"/>
<text text-anchor="middle" x="703" y="-903.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~fida_mc~~CallsGraph_edge93" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M605.085,-889.454C622.061,-892.352 644.499,-896.183 663.509,-899.428"/>
<polygon fill="#000000" stroke="#000000" points="662.929,-902.88 673.375,-901.113 664.107,-895.98 662.929,-902.88"/>
</g>
<!-- proc~swap -->
<g id="proc~~fida_mc~~CallsGraph_node57" class="node"><title>proc~swap</title>
<g id="a_proc~~fida_mc~~CallsGraph_node57"><a xlink:href=".././proc/swap.html" xlink:title="swap">
<polygon fill="#d9534f" stroke="#d9534f" points="730,-876 676,-876 676,-852 730,-852 730,-876"/>
<text text-anchor="middle" x="703" y="-861.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swap</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~swap -->
<g id="proc~~fida_mc~~CallsGraph_edge92" class="edge"><title>proc~ludcmp&#45;&gt;proc~swap</title>
<path fill="none" stroke="#000000" d="M605.085,-880.546C622.779,-877.526 646.405,-873.492 665.9,-870.163"/>
<polygon fill="#000000" stroke="#000000" points="666.684,-873.58 675.952,-868.447 665.506,-866.68 666.684,-873.58"/>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~fida_mc~~CallsGraph_edge94" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M589.915,-188.335C611.305,-212.507 658.886,-266.278 684.64,-295.381"/>
<polygon fill="#000000" stroke="#000000" points="682.037,-297.721 691.285,-302.891 687.279,-293.082 682.037,-297.721"/>
</g>
<!-- proc~uvw_to_cyl -->
<g id="proc~~fida_mc~~CallsGraph_node58" class="node"><title>proc~uvw_to_cyl</title>
<g id="a_proc~~fida_mc~~CallsGraph_node58"><a xlink:href=".././proc/uvw_to_cyl.html" xlink:title="uvw_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="735.5,-188 670.5,-188 670.5,-164 735.5,-164 735.5,-188"/>
<text text-anchor="middle" x="703" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_cyl</text>
</a>
</g>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl -->
<g id="proc~~fida_mc~~CallsGraph_edge95" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl</title>
<path fill="none" stroke="#000000" d="M609.089,-176C624.402,-176 643.267,-176 659.989,-176"/>
<polygon fill="#000000" stroke="#000000" points="660.072,-179.5 670.072,-176 660.072,-172.5 660.072,-179.5"/>
</g>
</g>
</svg>
</div><script>var panprocfida_mcCallsGraph = svgPanZoom('#procfida_mcCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~fida_mc~~CalledByGraph Pages: 1 -->
<svg id="procfida_mcCalledByGraph" width="152pt" height="32pt"
 viewBox="0.00 0.00 152.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~fida_mc~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~fida_mc~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 148,-28 148,4 -4,4"/>
<!-- proc~fida_mc -->
<g id="proc~~fida_mc~~CalledByGraph_node1" class="node"><title>proc~fida_mc</title>
<polygon fill="none" stroke="black" points="144,-24 90,-24 90,-0 144,-0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">fida_mc</text>
</g>
<!-- program~fidasim -->
<g id="proc~~fida_mc~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~fida_mc~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_mc -->
<g id="proc~~fida_mc~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~fida_mc</title>
<path fill="none" stroke="#000000" d="M54.4029,-12C62.3932,-12 71.3106,-12 79.8241,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.919,-15.5001 89.919,-12 79.919,-8.5001 79.919,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/fida_mc.html#src">fida_mc</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">fida_mc</span><span class="w"></span>
<span class="w">    </span><span class="c">!+ Calculate Active FIDA emission using a Monte Carlo Fast-ion distribution</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iion</span><span class="p">,</span><span class="n">igamma</span><span class="p">,</span><span class="n">ngamma</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">FastIon</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fast_ion</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fields</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">plasma</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">phi</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ri</span><span class="w">      </span><span class="c">!! start position</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">vi</span><span class="w">      </span><span class="c">!! velocity of fast ions</span>
<span class="w">    </span><span class="c">!! Determination of the CX probability</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">denn</span><span class="w">    </span><span class="c">!!  neutral dens (n=1-4)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rates</span><span class="w">    </span><span class="c">!! CX rates</span>
<span class="w">    </span><span class="c">!! Collisiional radiative model along track</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">states</span><span class="w">  </span><span class="c">! Density of n-states</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ntrack</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">ParticleTrack</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ntrack</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tracks</span><span class="w"></span>
<span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">los_intersect</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">jj</span><span class="w">      </span><span class="c">!! counter along track</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">photons</span><span class="w"> </span><span class="c">!! photon flux</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">neut_types</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">uvw</span><span class="p">,</span><span class="w"> </span><span class="n">uvw_vi</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">randomu</span><span class="w"></span>

<span class="w">    </span><span class="n">ngamma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">.</span><span class="nb">or</span><span class="p">.(</span><span class="n">inputs</span><span class="p">%</span><span class="n">dist_type</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">ngamma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ceiling</span><span class="p">(</span><span class="nb">dble</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_fida</span><span class="p">)</span><span class="o">/</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">    if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i10)&#39;</span><span class="p">)</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="o">*</span><span class="n">ngamma</span><span class="p">,</span><span class="n">Int64</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span><span class="w"></span>

<span class="w">    </span><span class="c">!$OMP PARALLEL DO schedule(dynamic,1) private(iion,igamma,fast_ion,vi,ri,phi,tracks,s,c, &amp;</span>
<span class="w">    </span><span class="c">!$OMP&amp; randomu,plasma,fields,uvw,uvw_vi,ntrack,jj,rates,denn,los_intersect,states,photons)</span>
<span class="w">    </span><span class="n">loop_over_fast_ions</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">iion</span><span class="o">=</span><span class="n">istart</span><span class="p">,</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="p">,</span><span class="n">istep</span><span class="w"></span>
<span class="w">        </span><span class="n">fast_ion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">particles</span><span class="p">%</span><span class="n">fast_ion</span><span class="p">(</span><span class="n">iion</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vabs</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">loop_over_fast_ions</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">beam_grid_cross_grid</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">loop_over_fast_ions</span><span class="w"></span>
<span class="w">        </span><span class="n">gamma_loop</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">igamma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ngamma</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">                </span><span class="c">!! Pick random toroidal angle</span>
<span class="w">                </span><span class="k">call </span><span class="n">randu</span><span class="p">(</span><span class="n">randomu</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="n">phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">beam_grid_phi_enter</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">delta_phi</span><span class="o">*</span><span class="n">randomu</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">else</span>
<span class="k">                </span><span class="n">phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">phi</span><span class="w"></span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">            </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="c">!! Calculate position in machine coordinates</span>
<span class="w">            </span><span class="n">uvw</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">c</span><span class="w"></span>
<span class="w">            </span><span class="n">uvw</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">s</span><span class="w"></span>
<span class="w">            </span><span class="n">uvw</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">z</span><span class="w"></span>

<span class="w">            </span><span class="c">!! Convert to beam grid coordinates</span>
<span class="w">            </span><span class="k">call </span><span class="n">uvw_to_xyz</span><span class="p">(</span><span class="n">uvw</span><span class="p">,</span><span class="w"> </span><span class="n">ri</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">dist_type</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">                </span><span class="c">!! Get electomagnetic fields</span>
<span class="w">                </span><span class="k">call </span><span class="n">get_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Correct for gyro motion and get particle position and velocity</span>
<span class="w">                </span><span class="k">call </span><span class="n">gyro_correction</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">energy</span><span class="p">,</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">pitch</span><span class="p">,</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="c">!! Full Orbit</span>
<span class="w">                </span><span class="c">!! Calculate velocity vector</span>
<span class="w">                </span><span class="n">uvw_vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vt</span><span class="w"></span>
<span class="w">                </span><span class="n">uvw_vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vt</span><span class="w"></span>
<span class="w">                </span><span class="n">uvw_vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vz</span><span class="w"></span>
<span class="w">                </span><span class="n">vi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">matmul</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">inv_basis</span><span class="p">,</span><span class="n">uvw_vi</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">endif</span><span class="w"></span>

<span class="w">            </span><span class="c">!! Track particle through grid</span>
<span class="w">            </span><span class="k">call </span><span class="n">track</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="p">,</span><span class="w"> </span><span class="n">tracks</span><span class="p">,</span><span class="w"> </span><span class="n">ntrack</span><span class="p">,</span><span class="w"> </span><span class="n">los_intersect</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">los_intersect</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">gamma_loop</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">ntrack</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">cycle </span><span class="n">gamma_loop</span><span class="w"></span>

<span class="w">            </span><span class="c">!! Calculate CX probability</span>
<span class="w">            </span><span class="k">call </span><span class="n">get_total_cx_rate</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">ind</span><span class="p">,</span><span class="w"> </span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="p">,</span><span class="w"> </span><span class="n">neut_types</span><span class="p">,</span><span class="w"> </span><span class="n">rates</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span><span class="k">cycle </span><span class="n">gamma_loop</span><span class="w"></span>

<span class="w">            </span><span class="c">!! Weight CX rates by ion source density</span>
<span class="w">            </span><span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">weight</span><span class="o">*</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">delta_phi</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">/</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="o">/</span><span class="n">ngamma</span><span class="w"></span>

<span class="w">            </span><span class="c">!! Calculate the spectra produced in each cell along the path</span>
<span class="w">            </span><span class="n">loop_along_track</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">jj</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ntrack</span><span class="w"></span>
<span class="w">                </span><span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">call </span><span class="n">colrad</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="p">,</span><span class="w"> </span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="nb">time</span><span class="p">,</span><span class="w"> </span><span class="n">states</span><span class="p">,</span><span class="w"> </span><span class="n">denn</span><span class="p">,</span><span class="w"> </span><span class="n">photons</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">call </span><span class="n">store_fida_photons</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="p">,</span><span class="w"> </span><span class="n">beam_lambda0</span><span class="p">,</span><span class="w"> </span><span class="n">photons</span><span class="p">,</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="k">class</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo </span><span class="n">loop_along_track</span><span class="w"></span>
<span class="w">        </span><span class="k">enddo </span><span class="n">gamma_loop</span><span class="w"></span>
<span class="w">    </span><span class="k">enddo </span><span class="n">loop_over_fast_ions</span><span class="w"></span>
<span class="w">    </span><span class="c">!$OMP END PARALLEL DO</span>

<span class="cp">#ifdef _MPI</span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">fida</span><span class="p">)</span><span class="w"></span>
<span class="cp">#endif</span>

<span class="k">end subroutine </span><span class="n">fida_mc</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>