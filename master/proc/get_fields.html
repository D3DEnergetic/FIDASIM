<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="">
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>get_fields &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>User Guide</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>get_fields
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.5% of total for procedures.">76 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
     <li><a href='../module/libfida.html'>libfida</a></li>
     <li class="active">get_fields</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/get_fields.html#src">get_fields</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public subroutine get_fields(fields, pos, ind, input_coords, output_coords)</h2>
    

    <p>Gets electro-magnetic fields at position <code>pos</code> or <a href="../module/libfida.html#variable-beam_grid">beam_grid</a> indices <code>ind</code></p>

    <h3>Arguments</h3>
      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-fields%7E4"></span>type(<a href='../type/localemfields.html'>LocalEMFields</a>),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>fields</strong></td><td><p>Electro-magnetic fields at <code>pos</code>/<code>ind</code></p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-pos%7E9"></span>real(kind=Float64),</td>
<td>intent(in),</td>
  <td>optional</td>  <td>dimension(3)</td><td>::</td>
  <td><strong>pos</strong></td><td><p>Position in beam grid coordinates</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ind%7E8"></span>integer(kind=Int32),</td>
<td>intent(in),</td>
  <td>optional</td>  <td>dimension(3)</td><td>::</td>
  <td><strong>ind</strong></td><td><p><a href="../module/libfida.html#variable-beam_grid">beam_grid</a> indices</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-input_coords%7E6"></span>integer(kind=Int32),</td>
<td>intent(in),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>input_coords</strong></td><td><p>Indicates coordinate system of inputs. Beam grid (0), machine (1) and cylindrical (2)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-output_coords%7E2"></span>integer(kind=Int32),</td>
<td>intent(in),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>output_coords</strong></td><td><p>Indicates coordinate system of outputs. Beam grid (0), machine (1) and cylindrical (2)</p></td>
</tr>
</tbody>
</table>

    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~get_fields~~CallsGraph Pages: 1 -->
<svg id="procget_fieldsCallsGraph" width="420pt" height="184pt"
 viewBox="0.00 0.00 420.00 183.69" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~get_fields~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 179.692)">
<title>proc~~get_fields~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-179.692 416,-179.692 416,4 -4,4"/>
<!-- proc~get_fields -->
<g id="proc~~get_fields~~CallsGraph_node1" class="node"><title>proc~get_fields</title>
<polygon fill="none" stroke="black" points="58,-93.6921 3.55271e-15,-93.6921 3.55271e-15,-69.6921 58,-69.6921 58,-93.6921"/>
<text text-anchor="middle" x="29" y="-79.2921" font-family="Helvetica,sans-Serif" font-size="10.50">get_fields</text>
</g>
<!-- proc~get_position -->
<g id="proc~~get_fields~~CallsGraph_node2" class="node"><title>proc~get_position</title>
<g id="a_proc~~get_fields~~CallsGraph_node2"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="179,-53.6921 109,-53.6921 109,-29.6921 179,-29.6921 179,-53.6921"/>
<text text-anchor="middle" x="144" y="-39.2921" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~get_fields~~CallsGraph_edge1" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M58.2232,-71.7016C70.5323,-67.3444 85.2539,-62.1332 98.9487,-57.2855"/>
<polygon fill="#000000" stroke="#000000" points="100.431,-60.4736 108.69,-53.8372 98.0953,-53.8748 100.431,-60.4736"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~get_fields~~CallsGraph_node3" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~get_fields~~CallsGraph_node3"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="194,-133.692 94,-133.692 94,-109.692 194,-109.692 194,-133.692"/>
<text text-anchor="middle" x="144" y="-119.292" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~get_fields~~CallsGraph_edge2" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M58.2232,-91.6826C70.5323,-96.0398 85.2539,-101.251 98.9487,-106.099"/>
<polygon fill="#000000" stroke="#000000" points="98.0953,-109.509 108.69,-109.547 100.431,-102.911 98.0953,-109.509"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_node4" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~get_fields~~CallsGraph_node4"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-95.6921 235,-95.6921 235,-71.6921 303,-71.6921 303,-95.6921"/>
<text text-anchor="middle" x="269" y="-81.2921" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_edge3" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M58.2363,-81.9294C99.419,-82.2755 176.308,-82.9216 224.681,-83.3281"/>
<polygon fill="#000000" stroke="#000000" points="224.813,-86.8292 234.843,-83.4135 224.872,-79.8295 224.813,-86.8292"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~get_fields~~CallsGraph_node5" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~get_fields~~CallsGraph_node5"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="174.5,-175.692 113.5,-175.692 113.5,-151.692 174.5,-151.692 174.5,-175.692"/>
<text text-anchor="middle" x="144" y="-161.292" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~get_fields~~CallsGraph_edge4" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M40.2822,-93.8066C52.1349,-107.178 72.7307,-128.661 94,-142.692 97.1603,-144.777 100.562,-146.732 104.047,-148.545"/>
<polygon fill="#000000" stroke="#000000" points="102.827,-151.841 113.357,-153.005 105.851,-145.528 102.827,-151.841"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~get_fields~~CallsGraph_node6" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~get_fields~~CallsGraph_node6"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="412,-33.6921 344,-33.6921 344,-9.69211 412,-9.69211 412,-33.6921"/>
<text text-anchor="middle" x="378" y="-19.2921" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~get_fields~~CallsGraph_edge5" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M38.2329,-69.4678C49.024,-54.6663 69.4889,-30.5021 94,-20.6921 173.657,11.1888 276.326,-0.890877 333.545,-11.7907"/>
<polygon fill="#000000" stroke="#000000" points="333.195,-15.2893 343.685,-13.8014 334.557,-8.42299 333.195,-15.2893"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~get_fields~~CallsGraph_node9" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~get_fields~~CallsGraph_node9"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="300,-53.6921 238,-53.6921 238,-29.6921 300,-29.6921 300,-53.6921"/>
<text text-anchor="middle" x="269" y="-39.2921" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~get_fields~~CallsGraph_edge6" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M179.262,-41.6921C194.163,-41.6921 211.737,-41.6921 227.298,-41.6921"/>
<polygon fill="#000000" stroke="#000000" points="227.692,-45.1922 237.692,-41.6921 227.692,-38.1922 227.692,-45.1922"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_edge7" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M174.535,-153.339C181.215,-150.382 188.077,-146.82 194,-142.692 213.087,-129.39 211.602,-118.931 230,-104.692 231.565,-103.481 233.208,-102.298 234.898,-101.149"/>
<polygon fill="#000000" stroke="#000000" points="236.951,-103.993 243.578,-95.7262 233.242,-98.056 236.951,-103.993"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_node7" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~get_fields~~CallsGraph_node7"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="410.5,-126.692 345.5,-126.692 345.5,-102.692 410.5,-102.692 410.5,-126.692"/>
<text text-anchor="middle" x="378" y="-112.292" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_edge8" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M174.69,-163.514C207.781,-162.648 262.606,-159.21 308,-146.692 321.158,-143.063 334.94,-137.148 346.696,-131.384"/>
<polygon fill="#000000" stroke="#000000" points="348.31,-134.49 355.64,-126.84 345.139,-128.249 348.31,-134.49"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~get_fields~~CallsGraph_node8" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~get_fields~~CallsGraph_node8"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="307.5,-137.692 230.5,-137.692 230.5,-113.692 307.5,-113.692 307.5,-137.692"/>
<text text-anchor="middle" x="269" y="-123.292" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~get_fields~~CallsGraph_edge9" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M174.775,-154.493C188.422,-150.277 204.94,-145.174 220.258,-140.442"/>
<polygon fill="#000000" stroke="#000000" points="221.587,-143.694 230.108,-137.399 219.52,-137.006 221.587,-143.694"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~get_fields~~CallsGraph_edge11" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M300.09,-36.0678C310.502,-34.1217 322.387,-31.9002 333.649,-29.7951"/>
<polygon fill="#000000" stroke="#000000" points="334.57,-33.1837 343.756,-27.9059 333.283,-26.3029 334.57,-33.1837"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_edge10" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M293.214,-53.8405C298.171,-56.622 303.32,-59.6571 308,-62.6921 323.899,-73.0028 340.909,-85.8001 354.062,-96.1191"/>
<polygon fill="#000000" stroke="#000000" points="352.087,-99.0204 362.098,-102.491 356.437,-93.5355 352.087,-99.0204"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~get_fields~~CalledByGraph Pages: 1 -->
<svg id="procget_fieldsCalledByGraph" width="602pt" height="1036pt"
 viewBox="0.00 0.00 602.00 1035.93" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~get_fields~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 1031.93)">
<title>proc~~get_fields~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1031.93 598,-1031.93 598,4 -4,4"/>
<!-- proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_node1" class="node"><title>proc~get_fields</title>
<polygon fill="none" stroke="black" points="594,-662.006 536,-662.006 536,-638.006 594,-638.006 594,-662.006"/>
<text text-anchor="middle" x="565" y="-647.606" font-family="Helvetica,sans-Serif" font-size="10.50">get_fields</text>
</g>
<!-- proc~mc_fastion_pass_grid -->
<g id="proc~~get_fields~~CalledByGraph_node2" class="node"><title>proc~mc_fastion_pass_grid</title>
<g id="a_proc~~get_fields~~CalledByGraph_node2"><a xlink:href=".././proc/mc_fastion_pass_grid.html" xlink:title="mc_fastion_pass_grid">
<polygon fill="#d9534f" stroke="#d9534f" points="365.5,-860.006 248.5,-860.006 248.5,-836.006 365.5,-836.006 365.5,-860.006"/>
<text text-anchor="middle" x="307" y="-845.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_fastion_pass_grid</text>
</a>
</g>
</g>
<!-- proc~mc_fastion_pass_grid&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge15" class="edge"><title>proc~mc_fastion_pass_grid&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M365.682,-854.86C407.315,-856.608 462.566,-851.944 500,-822.006 546.453,-784.855 559.19,-710.419 562.682,-672.834"/>
<polygon fill="#000000" stroke="#000000" points="566.204,-672.678 563.495,-662.435 559.226,-672.132 566.204,-672.678"/>
</g>
<!-- proc~make_diagnostic_grids -->
<g id="proc~~get_fields~~CalledByGraph_node3" class="node"><title>proc~make_diagnostic_grids</title>
<g id="a_proc~~get_fields~~CalledByGraph_node3"><a xlink:href=".././proc/make_diagnostic_grids.html" xlink:title="make_diagnostic_grids">
<polygon fill="#d9534f" stroke="#d9534f" points="212,-902.006 90,-902.006 90,-878.006 212,-878.006 212,-902.006"/>
<text text-anchor="middle" x="151" y="-887.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">make_diagnostic_grids</text>
</a>
</g>
</g>
<!-- proc~make_diagnostic_grids&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge1" class="edge"><title>proc~make_diagnostic_grids&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M184.511,-902.061C252.904,-925.089 412.544,-966.199 500,-885.006 531.462,-855.797 553.279,-725.074 560.957,-672.254"/>
<polygon fill="#000000" stroke="#000000" points="564.44,-672.622 562.379,-662.229 557.509,-671.639 564.44,-672.622"/>
</g>
<!-- proc~track_cylindrical -->
<g id="proc~~get_fields~~CalledByGraph_node4" class="node"><title>proc~track_cylindrical</title>
<g id="a_proc~~get_fields~~CalledByGraph_node4"><a xlink:href=".././proc/track_cylindrical.html" xlink:title="track_cylindrical">
<polygon fill="#d9534f" stroke="#d9534f" points="351,-902.006 263,-902.006 263,-878.006 351,-878.006 351,-902.006"/>
<text text-anchor="middle" x="307" y="-887.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track_cylindrical</text>
</a>
</g>
</g>
<!-- proc~make_diagnostic_grids&#45;&gt;proc~track_cylindrical -->
<g id="proc~~get_fields~~CalledByGraph_edge25" class="edge"><title>proc~make_diagnostic_grids&#45;&gt;proc~track_cylindrical</title>
<path fill="none" stroke="#000000" d="M212.423,-890.006C225.721,-890.006 239.712,-890.006 252.705,-890.006"/>
<polygon fill="#000000" stroke="#000000" points="252.878,-893.506 262.878,-890.006 252.878,-886.506 252.878,-893.506"/>
</g>
<!-- proc~track -->
<g id="proc~~get_fields~~CalledByGraph_node9" class="node"><title>proc~track</title>
<g id="a_proc~~get_fields~~CalledByGraph_node9"><a xlink:href=".././proc/track.html" xlink:title="track">
<polygon fill="#d9534f" stroke="#d9534f" points="334,-464.006 280,-464.006 280,-440.006 334,-440.006 334,-464.006"/>
<text text-anchor="middle" x="307" y="-449.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track</text>
</a>
</g>
</g>
<!-- proc~make_diagnostic_grids&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge34" class="edge"><title>proc~make_diagnostic_grids&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M201.851,-877.891C205.679,-875.452 209.153,-872.523 212,-869.006 251.751,-819.904 231.37,-647.953 248,-587.006 259.432,-545.108 281.311,-499.23 294.685,-473.197"/>
<polygon fill="#000000" stroke="#000000" points="297.835,-474.725 299.355,-464.24 291.628,-471.489 297.835,-474.725"/>
</g>
<!-- proc~track_cylindrical&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge2" class="edge"><title>proc~track_cylindrical&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M351.251,-893.265C394.201,-894.068 459.348,-888.362 500,-852.006 552.748,-804.831 562.361,-714.497 563.88,-672.501"/>
<polygon fill="#000000" stroke="#000000" points="567.385,-672.319 564.121,-662.24 560.387,-672.155 567.385,-672.319"/>
</g>
<!-- proc~mc_fastion -->
<g id="proc~~get_fields~~CalledByGraph_node5" class="node"><title>proc~mc_fastion</title>
<g id="a_proc~~get_fields~~CalledByGraph_node5"><a xlink:href=".././proc/mc_fastion.html" xlink:title="mc_fastion">
<polygon fill="#d9534f" stroke="#d9534f" points="339,-662.006 275,-662.006 275,-638.006 339,-638.006 339,-662.006"/>
<text text-anchor="middle" x="307" y="-647.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_fastion</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge3" class="edge"><title>proc~mc_fastion&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M339.135,-650.006C386.034,-650.006 474.716,-650.006 525.572,-650.006"/>
<polygon fill="#000000" stroke="#000000" points="525.822,-653.506 535.822,-650.006 525.822,-646.506 525.822,-653.506"/>
</g>
<!-- proc~neutron_f -->
<g id="proc~~get_fields~~CalledByGraph_node6" class="node"><title>proc~neutron_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node6"><a xlink:href=".././proc/neutron_f.html" xlink:title="neutron_f">
<polygon fill="#d9534f" stroke="#d9534f" points="480,-1022.01 422,-1022.01 422,-998.006 480,-998.006 480,-1022.01"/>
<text text-anchor="middle" x="451" y="-1007.61" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutron_f</text>
</a>
</g>
</g>
<!-- proc~neutron_f&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge5" class="edge"><title>proc~neutron_f&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M480.191,-1002.94C487.619,-999.806 494.957,-995.339 500,-989.006 539.502,-939.4 557.443,-739.922 562.465,-672.443"/>
<polygon fill="#000000" stroke="#000000" points="565.982,-672.338 563.209,-662.112 559,-671.835 565.982,-672.338"/>
</g>
<!-- proc~npa_weights -->
<g id="proc~~get_fields~~CalledByGraph_node7" class="node"><title>proc~npa_weights</title>
<g id="a_proc~~get_fields~~CalledByGraph_node7"><a xlink:href=".././proc/npa_weights.html" xlink:title="npa_weights">
<polygon fill="#d9534f" stroke="#d9534f" points="487.5,-980.006 414.5,-980.006 414.5,-956.006 487.5,-956.006 487.5,-980.006"/>
<text text-anchor="middle" x="451" y="-965.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_weights</text>
</a>
</g>
</g>
<!-- proc~npa_weights&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge7" class="edge"><title>proc~npa_weights&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M483.893,-955.764C489.994,-952.146 495.783,-947.61 500,-942.006 532.46,-898.867 554.43,-732.986 561.522,-672.36"/>
<polygon fill="#000000" stroke="#000000" points="565.011,-672.651 562.672,-662.318 558.057,-671.855 565.011,-672.651"/>
</g>
<!-- proc~store_npa -->
<g id="proc~~get_fields~~CalledByGraph_node8" class="node"><title>proc~store_npa</title>
<g id="a_proc~~get_fields~~CalledByGraph_node8"><a xlink:href=".././proc/store_npa.html" xlink:title="store_npa">
<polygon fill="#d9534f" stroke="#d9534f" points="337.5,-742.006 276.5,-742.006 276.5,-718.006 337.5,-718.006 337.5,-742.006"/>
<text text-anchor="middle" x="307" y="-727.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_npa</text>
</a>
</g>
</g>
<!-- proc~store_npa&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge9" class="edge"><title>proc~store_npa&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M337.676,-731.018C376.63,-731.248 446.35,-727.818 500,-704.006 517.876,-696.071 534.638,-681.563 546.521,-669.582"/>
<polygon fill="#000000" stroke="#000000" points="549.222,-671.821 553.587,-662.168 544.154,-666.992 549.222,-671.821"/>
</g>
<!-- proc~track&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge10" class="edge"><title>proc~track&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M334.128,-446.21C374.289,-438.916 451.608,-431.478 500,-469.006 549.969,-507.756 561.025,-588.479 563.4,-627.682"/>
<polygon fill="#000000" stroke="#000000" points="559.909,-627.957 563.872,-637.783 566.901,-627.63 559.909,-627.957"/>
</g>
<!-- proc~pfida_mc -->
<g id="proc~~get_fields~~CalledByGraph_node10" class="node"><title>proc~pfida_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node10"><a xlink:href=".././proc/pfida_mc.html" xlink:title="pfida_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="179,-776.006 123,-776.006 123,-752.006 179,-752.006 179,-776.006"/>
<text text-anchor="middle" x="151" y="-761.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pfida_mc</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge11" class="edge"><title>proc~pfida_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M179.116,-772.704C241.495,-790.95 397.663,-826.391 500,-761.006 531.962,-740.585 549.739,-698.125 558.048,-672.043"/>
<polygon fill="#000000" stroke="#000000" points="561.451,-672.879 560.956,-662.296 554.743,-670.878 561.451,-672.879"/>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~track_cylindrical -->
<g id="proc~~get_fields~~CalledByGraph_edge23" class="edge"><title>proc~pfida_mc&#45;&gt;proc~track_cylindrical</title>
<path fill="none" stroke="#000000" d="M179.021,-768.456C190.353,-771.494 202.967,-776.569 212,-785.006 241.684,-812.73 218.465,-841.122 248,-869.006 249.874,-870.775 251.908,-872.397 254.055,-873.884"/>
<polygon fill="#000000" stroke="#000000" points="252.399,-876.969 262.802,-878.975 255.92,-870.919 252.399,-876.969"/>
</g>
<!-- proc~store_fida_photons -->
<g id="proc~~get_fields~~CalledByGraph_node21" class="node"><title>proc~store_fida_photons</title>
<g id="a_proc~~get_fields~~CalledByGraph_node21"><a xlink:href=".././proc/store_fida_photons.html" xlink:title="store_fida_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="359,-620.006 255,-620.006 255,-596.006 359,-596.006 359,-620.006"/>
<text text-anchor="middle" x="307" y="-605.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_fida_photons</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge60" class="edge"><title>proc~pfida_mc&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M179.123,-760.049C190.611,-757.1 203.319,-751.959 212,-743.006 248.988,-704.861 211.217,-667.348 248,-629.006 249.066,-627.895 250.195,-626.842 251.376,-625.846"/>
<polygon fill="#000000" stroke="#000000" points="253.569,-628.586 259.83,-620.039 249.605,-622.816 253.569,-628.586"/>
</g>
<!-- proc~fida_weights_mc -->
<g id="proc~~get_fields~~CalledByGraph_node11" class="node"><title>proc~fida_weights_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node11"><a xlink:href=".././proc/fida_weights_mc.html" xlink:title="fida_weights_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="197,-524.006 105,-524.006 105,-500.006 197,-500.006 197,-524.006"/>
<text text-anchor="middle" x="151" y="-509.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_weights_mc</text>
</a>
</g>
</g>
<!-- proc~fida_weights_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge19" class="edge"><title>proc~fida_weights_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M197.05,-515.276C265.88,-521.815 399.776,-540.699 500,-593.006 517.746,-602.267 534.515,-617.536 546.433,-629.94"/>
<polygon fill="#000000" stroke="#000000" points="544.159,-632.636 553.526,-637.586 549.291,-627.875 544.159,-632.636"/>
</g>
<!-- proc~fida_weights_mc&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge37" class="edge"><title>proc~fida_weights_mc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M187.655,-499.899C195.694,-497.066 204.165,-493.999 212,-491.006 231.496,-483.556 253.014,-474.678 270.537,-467.276"/>
<polygon fill="#000000" stroke="#000000" points="271.986,-470.463 279.823,-463.333 269.25,-464.02 271.986,-470.463"/>
</g>
<!-- proc~store_fw_photons -->
<g id="proc~~get_fields~~CalledByGraph_node17" class="node"><title>proc~store_fw_photons</title>
<g id="a_proc~~get_fields~~CalledByGraph_node17"><a xlink:href=".././proc/store_fw_photons.html" xlink:title="store_fw_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="499.5,-502.006 402.5,-502.006 402.5,-478.006 499.5,-478.006 499.5,-502.006"/>
<text text-anchor="middle" x="451" y="-487.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_fw_photons</text>
</a>
</g>
</g>
<!-- proc~fida_weights_mc&#45;&gt;proc~store_fw_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge56" class="edge"><title>proc~fida_weights_mc&#45;&gt;proc~store_fw_photons</title>
<path fill="none" stroke="#000000" d="M197.26,-508.664C249.375,-504.817 335.105,-498.488 392.054,-494.284"/>
<polygon fill="#000000" stroke="#000000" points="392.623,-497.751 402.338,-493.524 392.107,-490.77 392.623,-497.751"/>
</g>
<!-- proc~fida_mc -->
<g id="proc~~get_fields~~CalledByGraph_node12" class="node"><title>proc~fida_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node12"><a xlink:href=".././proc/fida_mc.html" xlink:title="fida_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-566.006 124,-566.006 124,-542.006 178,-542.006 178,-566.006"/>
<text text-anchor="middle" x="151" y="-551.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_mc</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge17" class="edge"><title>proc~fida_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M178.275,-556.728C218.89,-561.233 299.21,-571.33 366,-587.006 422.818,-600.341 486.903,-621.984 526.375,-636.107"/>
<polygon fill="#000000" stroke="#000000" points="525.267,-639.428 535.861,-639.526 527.64,-632.842 525.267,-639.428"/>
</g>
<!-- proc~fida_mc&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge40" class="edge"><title>proc~fida_mc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.03,-547.232C188.933,-543.811 201.489,-539.079 212,-533.006 241.115,-516.182 269.673,-489.76 287.528,-471.699"/>
<polygon fill="#000000" stroke="#000000" points="290.493,-473.67 294.942,-464.054 285.468,-468.796 290.493,-473.67"/>
</g>
<!-- proc~fida_mc&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge62" class="edge"><title>proc~fida_mc&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M178.288,-563.2C188.776,-566.87 200.96,-571.136 212,-575.006 228.355,-580.739 246.309,-587.04 262.103,-592.585"/>
<polygon fill="#000000" stroke="#000000" points="261.03,-595.918 271.625,-595.929 263.35,-589.314 261.03,-595.918"/>
</g>
<!-- proc~ndmc -->
<g id="proc~~get_fields~~CalledByGraph_node13" class="node"><title>proc~ndmc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node13"><a xlink:href=".././proc/ndmc.html" xlink:title="ndmc">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-440.006 124,-440.006 124,-416.006 178,-416.006 178,-440.006"/>
<text text-anchor="middle" x="151" y="-425.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ndmc</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge12" class="edge"><title>proc~ndmc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M178.334,-418.543C201.825,-410.28 234.527,-399.262 248,-397.006 358.47,-378.507 411.715,-325.075 500,-394.006 537.153,-423.014 555.93,-570.8 561.867,-627.666"/>
<polygon fill="#000000" stroke="#000000" points="558.4,-628.166 562.885,-637.764 565.364,-627.464 558.4,-628.166"/>
</g>
<!-- proc~ndmc&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge38" class="edge"><title>proc~ndmc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.124,-432.077C203.235,-435.99 241.411,-441.94 269.517,-446.32"/>
<polygon fill="#000000" stroke="#000000" points="269.328,-449.833 279.748,-447.914 270.406,-442.916 269.328,-449.833"/>
</g>
<!-- proc~store_nbi_photons -->
<g id="proc~~get_fields~~CalledByGraph_node27" class="node"><title>proc~store_nbi_photons</title>
<g id="a_proc~~get_fields~~CalledByGraph_node27"><a xlink:href=".././proc/store_nbi_photons.html" xlink:title="store_nbi_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="357.5,-346.006 256.5,-346.006 256.5,-322.006 357.5,-322.006 357.5,-346.006"/>
<text text-anchor="middle" x="307" y="-331.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_nbi_photons</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~store_nbi_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge69" class="edge"><title>proc~ndmc&#45;&gt;proc~store_nbi_photons</title>
<path fill="none" stroke="#000000" d="M178.094,-422.43C189.254,-419.183 201.99,-414.257 212,-407.006 233.309,-391.569 227.364,-376.331 248,-360.006 252.381,-356.54 257.298,-353.428 262.367,-350.665"/>
<polygon fill="#000000" stroke="#000000" points="264.189,-353.668 271.572,-346.07 261.062,-347.405 264.189,-353.668"/>
</g>
<!-- proc~npa_mc -->
<g id="proc~~get_fields~~CalledByGraph_node14" class="node"><title>proc~npa_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node14"><a xlink:href=".././proc/npa_mc.html" xlink:title="npa_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-734.006 124,-734.006 124,-710.006 178,-710.006 178,-734.006"/>
<text text-anchor="middle" x="151" y="-719.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_mc</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge13" class="edge"><title>proc~npa_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M178.351,-730.915C201.856,-738.686 234.566,-749.021 248,-751.006 359.219,-767.438 402.79,-785.483 500,-729.006 523.524,-715.338 541.922,-689.491 552.838,-671.085"/>
<polygon fill="#000000" stroke="#000000" points="555.964,-672.667 557.852,-662.242 549.875,-669.214 555.964,-672.667"/>
</g>
<!-- proc~npa_mc&#45;&gt;proc~store_npa -->
<g id="proc~~get_fields~~CalledByGraph_edge33" class="edge"><title>proc~npa_mc&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M178.124,-723.363C202.246,-724.616 238.424,-726.495 266.15,-727.936"/>
<polygon fill="#000000" stroke="#000000" points="266.152,-731.44 276.32,-728.464 266.515,-724.45 266.152,-731.44"/>
</g>
<!-- proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_node15" class="node"><title>proc~store_photons</title>
<g id="a_proc~~get_fields~~CalledByGraph_node15"><a xlink:href=".././proc/store_photons.html" xlink:title="store_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="491.5,-268.006 410.5,-268.006 410.5,-244.006 491.5,-244.006 491.5,-268.006"/>
<text text-anchor="middle" x="451" y="-253.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_photons</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge14" class="edge"><title>proc~store_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M458.65,-268.14C468.849,-287.192 488.387,-325.517 500,-360.006 532.743,-457.242 553.254,-578.542 560.764,-627.738"/>
<polygon fill="#000000" stroke="#000000" points="557.34,-628.505 562.282,-637.877 564.263,-627.468 557.34,-628.505"/>
</g>
<!-- proc~pnpa_mc -->
<g id="proc~~get_fields~~CalledByGraph_node16" class="node"><title>proc~pnpa_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node16"><a xlink:href=".././proc/pnpa_mc.html" xlink:title="pnpa_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="179.5,-692.006 122.5,-692.006 122.5,-668.006 179.5,-668.006 179.5,-692.006"/>
<text text-anchor="middle" x="151" y="-677.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pnpa_mc</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge4" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M179.666,-680.377C238.77,-680.81 381.618,-679.937 500,-664.006 508.415,-662.873 517.364,-661.211 525.82,-659.424"/>
<polygon fill="#000000" stroke="#000000" points="526.814,-662.789 535.821,-657.21 525.301,-655.954 526.814,-662.789"/>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~store_npa -->
<g id="proc~~get_fields~~CalledByGraph_edge30" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M179.532,-688.945C203.804,-696.825 239.447,-708.398 266.713,-717.25"/>
<polygon fill="#000000" stroke="#000000" points="265.751,-720.618 276.343,-720.377 267.912,-713.96 265.751,-720.618"/>
</g>
<!-- proc~store_fw_photons&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge16" class="edge"><title>proc~store_fw_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M481.211,-502.043C487.964,-505.795 494.712,-510.441 500,-516.006 531.025,-548.65 549.509,-599.136 558.121,-627.915"/>
<polygon fill="#000000" stroke="#000000" points="554.832,-629.146 560.944,-637.8 561.563,-627.223 554.832,-629.146"/>
</g>
<!-- proc~cfpd_f -->
<g id="proc~~get_fields~~CalledByGraph_node18" class="node"><title>proc~cfpd_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node18"><a xlink:href=".././proc/cfpd_f.html" xlink:title="cfpd_f">
<polygon fill="#d9534f" stroke="#d9534f" points="478,-186.006 424,-186.006 424,-162.006 478,-162.006 478,-186.006"/>
<text text-anchor="middle" x="451" y="-171.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cfpd_f</text>
</a>
</g>
</g>
<!-- proc~cfpd_f&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge8" class="edge"><title>proc~cfpd_f&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M464.85,-186.275C476.04,-197.763 491.731,-215.972 500,-235.006 560.836,-375.033 564.967,-563.69 564.457,-627.7"/>
<polygon fill="#000000" stroke="#000000" points="560.955,-627.8 564.326,-637.844 567.955,-627.89 560.955,-627.8"/>
</g>
<!-- proc~neutron_mc -->
<g id="proc~~get_fields~~CalledByGraph_node19" class="node"><title>proc~neutron_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node19"><a xlink:href=".././proc/neutron_mc.html" xlink:title="neutron_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="486,-64.0057 416,-64.0057 416,-40.0057 486,-40.0057 486,-64.0057"/>
<text text-anchor="middle" x="451" y="-49.6057" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutron_mc</text>
</a>
</g>
</g>
<!-- proc~neutron_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge18" class="edge"><title>proc~neutron_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M459.394,-64.252C470.199,-82.7624 490.091,-119.292 500,-153.006 552.169,-330.507 561.829,-556.072 563.604,-627.358"/>
<polygon fill="#000000" stroke="#000000" points="560.114,-627.874 563.833,-637.794 567.113,-627.72 560.114,-627.874"/>
</g>
<!-- proc~fida_weights_los -->
<g id="proc~~get_fields~~CalledByGraph_node20" class="node"><title>proc~fida_weights_los</title>
<g id="a_proc~~get_fields~~CalledByGraph_node20"><a xlink:href=".././proc/fida_weights_los.html" xlink:title="fida_weights_los">
<polygon fill="#d9534f" stroke="#d9534f" points="196.5,-482.006 105.5,-482.006 105.5,-458.006 196.5,-458.006 196.5,-482.006"/>
<text text-anchor="middle" x="151" y="-467.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_weights_los</text>
</a>
</g>
</g>
<!-- proc~fida_weights_los&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge6" class="edge"><title>proc~fida_weights_los&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M188.771,-457.966C196.513,-455.2 204.58,-452.144 212,-449.006 228.475,-442.037 230.59,-435.116 248,-431.006 357.025,-405.268 411.417,-367.434 500,-436.006 530.789,-459.84 552.655,-577.96 560.652,-627.781"/>
<polygon fill="#000000" stroke="#000000" points="557.223,-628.504 562.226,-637.842 564.138,-627.421 557.223,-628.504"/>
</g>
<!-- proc~fida_weights_los&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge35" class="edge"><title>proc~fida_weights_los&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M196.543,-464.799C219.751,-462.087 247.773,-458.811 269.654,-456.254"/>
<polygon fill="#000000" stroke="#000000" points="270.328,-459.699 279.854,-455.062 269.515,-452.746 270.328,-459.699"/>
</g>
<!-- proc~store_fida_photons&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge47" class="edge"><title>proc~store_fida_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M313.428,-595.784C323.876,-572.171 347.394,-518.587 366,-473.006 394.95,-402.087 427.098,-317.176 441.824,-277.907"/>
<polygon fill="#000000" stroke="#000000" points="445.191,-278.896 445.419,-268.303 438.635,-276.441 445.191,-278.896"/>
</g>
<!-- proc~halo -->
<g id="proc~~get_fields~~CalledByGraph_node22" class="node"><title>proc~halo</title>
<g id="a_proc~~get_fields~~CalledByGraph_node22"><a xlink:href=".././proc/halo.html" xlink:title="halo">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-356.006 124,-356.006 124,-332.006 178,-332.006 178,-356.006"/>
<text text-anchor="middle" x="151" y="-341.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">halo</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge39" class="edge"><title>proc~halo&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.137,-350.598C189.058,-353.989 201.598,-358.746 212,-365.006 242.508,-383.364 271.628,-412.794 289.16,-432.263"/>
<polygon fill="#000000" stroke="#000000" points="286.692,-434.756 295.934,-439.936 291.939,-430.123 286.692,-434.756"/>
</g>
<!-- proc~halo&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge52" class="edge"><title>proc~halo&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M165.477,-331.965C183.075,-317.004 215.485,-291.99 248,-280.006 297.641,-261.709 358.355,-256.608 400.185,-255.524"/>
<polygon fill="#000000" stroke="#000000" points="400.463,-259.019 410.394,-255.329 400.329,-252.02 400.463,-259.019"/>
</g>
<!-- proc~halo_spec -->
<g id="proc~~get_fields~~CalledByGraph_node23" class="node"><title>proc~halo_spec</title>
<g id="a_proc~~get_fields~~CalledByGraph_node23"><a xlink:href=".././proc/halo_spec.html" xlink:title="halo_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="337.5,-102.006 276.5,-102.006 276.5,-78.0057 337.5,-78.0057 337.5,-102.006"/>
<text text-anchor="middle" x="307" y="-87.6057" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">halo_spec</text>
</a>
</g>
</g>
<!-- proc~halo_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge49" class="edge"><title>proc~halo_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M337.689,-95.7062C347.659,-98.8415 358.213,-103.654 366,-111.006 395.535,-138.889 381.264,-160.08 402,-195.006 410.636,-209.552 422.344,-224.499 432.035,-235.958"/>
<polygon fill="#000000" stroke="#000000" points="429.476,-238.35 438.662,-243.629 434.773,-233.773 429.476,-238.35"/>
</g>
<!-- proc~pfida_f -->
<g id="proc~~get_fields~~CalledByGraph_node24" class="node"><title>proc~pfida_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node24"><a xlink:href=".././proc/pfida_f.html" xlink:title="pfida_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-860.006 124,-860.006 124,-836.006 178,-836.006 178,-860.006"/>
<text text-anchor="middle" x="151" y="-845.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pfida_f</text>
</a>
</g>
</g>
<!-- proc~pfida_f&#45;&gt;proc~mc_fastion_pass_grid -->
<g id="proc~~get_fields~~CalledByGraph_edge20" class="edge"><title>proc~pfida_f&#45;&gt;proc~mc_fastion_pass_grid</title>
<path fill="none" stroke="#000000" d="M178.124,-848.006C194.718,-848.006 217.019,-848.006 238.348,-848.006"/>
<polygon fill="#000000" stroke="#000000" points="238.382,-851.506 248.382,-848.006 238.382,-844.506 238.382,-851.506"/>
</g>
<!-- proc~pfida_f&#45;&gt;proc~track_cylindrical -->
<g id="proc~~get_fields~~CalledByGraph_edge24" class="edge"><title>proc~pfida_f&#45;&gt;proc~track_cylindrical</title>
<path fill="none" stroke="#000000" d="M178.124,-855.13C198.579,-860.709 227.703,-868.652 252.992,-875.549"/>
<polygon fill="#000000" stroke="#000000" points="252.262,-878.978 262.83,-878.232 254.104,-872.224 252.262,-878.978"/>
</g>
<!-- proc~pfida_f&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge63" class="edge"><title>proc~pfida_f&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M178.134,-844.91C190.132,-842.143 203.541,-836.907 212,-827.006 270.097,-759 190.268,-697.321 248,-629.006 248.743,-628.126 249.526,-627.284 250.344,-626.477"/>
<polygon fill="#000000" stroke="#000000" points="252.778,-629.018 258.532,-620.123 248.486,-623.488 252.778,-629.018"/>
</g>
<!-- proc~pnpa_f -->
<g id="proc~~get_fields~~CalledByGraph_node25" class="node"><title>proc~pnpa_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node25"><a xlink:href=".././proc/pnpa_f.html" xlink:title="pnpa_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-818.006 124,-818.006 124,-794.006 178,-794.006 178,-818.006"/>
<text text-anchor="middle" x="151" y="-803.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pnpa_f</text>
</a>
</g>
</g>
<!-- proc~pnpa_f&#45;&gt;proc~mc_fastion_pass_grid -->
<g id="proc~~get_fields~~CalledByGraph_edge21" class="edge"><title>proc~pnpa_f&#45;&gt;proc~mc_fastion_pass_grid</title>
<path fill="none" stroke="#000000" d="M178.124,-813.13C198.351,-818.647 227.057,-826.476 252.147,-833.319"/>
<polygon fill="#000000" stroke="#000000" points="251.351,-836.729 261.92,-835.984 253.193,-829.976 251.351,-836.729"/>
</g>
<!-- proc~pnpa_f&#45;&gt;proc~store_npa -->
<g id="proc~~get_fields~~CalledByGraph_edge32" class="edge"><title>proc~pnpa_f&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M178.126,-798.08C188.812,-794.526 201.181,-790.007 212,-785.006 235.598,-774.096 260.965,-759.039 279.392,-747.437"/>
<polygon fill="#000000" stroke="#000000" points="281.29,-750.378 287.842,-742.052 277.528,-744.475 281.29,-750.378"/>
</g>
<!-- proc~fida_f -->
<g id="proc~~get_fields~~CalledByGraph_node26" class="node"><title>proc~fida_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node26"><a xlink:href=".././proc/fida_f.html" xlink:title="fida_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-608.006 124,-608.006 124,-584.006 178,-584.006 178,-608.006"/>
<text text-anchor="middle" x="151" y="-593.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_f</text>
</a>
</g>
</g>
<!-- proc~fida_f&#45;&gt;proc~mc_fastion -->
<g id="proc~~get_fields~~CalledByGraph_edge27" class="edge"><title>proc~fida_f&#45;&gt;proc~mc_fastion</title>
<path fill="none" stroke="#000000" d="M178.288,-605.2C188.776,-608.87 200.96,-613.136 212,-617.006 229.301,-623.07 248.391,-629.771 264.822,-635.54"/>
<polygon fill="#000000" stroke="#000000" points="264.074,-638.987 274.669,-638.998 266.394,-632.383 264.074,-638.987"/>
</g>
<!-- proc~fida_f&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge36" class="edge"><title>proc~fida_f&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.098,-590.436C189.259,-587.189 201.994,-582.263 212,-575.006 249.979,-547.462 279.87,-500.291 295.045,-473.066"/>
<polygon fill="#000000" stroke="#000000" points="298.265,-474.471 299.957,-464.012 292.112,-471.132 298.265,-474.471"/>
</g>
<!-- proc~fida_f&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge61" class="edge"><title>proc~fida_f&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M178.124,-598.041C196.364,-599.463 221.497,-601.421 244.657,-603.226"/>
<polygon fill="#000000" stroke="#000000" points="244.539,-606.727 254.78,-604.015 245.083,-599.748 244.539,-606.727"/>
</g>
<!-- proc~store_nbi_photons&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge50" class="edge"><title>proc~store_nbi_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M336.979,-321.92C346.365,-317.767 356.74,-312.92 366,-308.006 385.814,-297.491 407.306,-284.149 423.59,-273.612"/>
<polygon fill="#000000" stroke="#000000" points="425.599,-276.48 432.058,-268.082 421.771,-270.619 425.599,-276.48"/>
</g>
<!-- proc~nbi_spec -->
<g id="proc~~get_fields~~CalledByGraph_node28" class="node"><title>proc~nbi_spec</title>
<g id="a_proc~~get_fields~~CalledByGraph_node28"><a xlink:href=".././proc/nbi_spec.html" xlink:title="nbi_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="334.5,-228.006 279.5,-228.006 279.5,-204.006 334.5,-204.006 334.5,-228.006"/>
<text text-anchor="middle" x="307" y="-213.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nbi_spec</text>
</a>
</g>
</g>
<!-- proc~nbi_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge51" class="edge"><title>proc~nbi_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M334.709,-223.529C353.172,-228.73 378.287,-235.805 400.363,-242.023"/>
<polygon fill="#000000" stroke="#000000" points="399.683,-245.468 410.258,-244.811 401.581,-238.73 399.683,-245.468"/>
</g>
<!-- proc~cold_spec -->
<g id="proc~~get_fields~~CalledByGraph_node29" class="node"><title>proc~cold_spec</title>
<g id="a_proc~~get_fields~~CalledByGraph_node29"><a xlink:href=".././proc/cold_spec.html" xlink:title="cold_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="337.5,-186.006 276.5,-186.006 276.5,-162.006 337.5,-162.006 337.5,-186.006"/>
<text text-anchor="middle" x="307" y="-171.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cold_spec</text>
</a>
</g>
</g>
<!-- proc~cold_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge53" class="edge"><title>proc~cold_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M337.6,-182.924C346.925,-186.204 357.107,-190.288 366,-195.006 388.506,-206.945 411.77,-224.298 428.092,-237.446"/>
<polygon fill="#000000" stroke="#000000" points="426,-240.257 435.953,-243.887 430.436,-234.842 426,-240.257"/>
</g>
<!-- proc~dcx_spec -->
<g id="proc~~get_fields~~CalledByGraph_node30" class="node"><title>proc~dcx_spec</title>
<g id="a_proc~~get_fields~~CalledByGraph_node30"><a xlink:href=".././proc/dcx_spec.html" xlink:title="dcx_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="336,-144.006 278,-144.006 278,-120.006 336,-120.006 336,-144.006"/>
<text text-anchor="middle" x="307" y="-129.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dcx_spec</text>
</a>
</g>
</g>
<!-- proc~dcx_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge48" class="edge"><title>proc~dcx_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M336.042,-138.799C346.074,-142.068 357.091,-146.685 366,-153.006 370.282,-156.044 410.946,-206.839 434.087,-235.938"/>
<polygon fill="#000000" stroke="#000000" points="431.415,-238.202 440.375,-243.855 436.896,-233.848 431.415,-238.202"/>
</g>
<!-- proc~npa_f -->
<g id="proc~~get_fields~~CalledByGraph_node31" class="node"><title>proc~npa_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node31"><a xlink:href=".././proc/npa_f.html" xlink:title="npa_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-650.006 124,-650.006 124,-626.006 178,-626.006 178,-650.006"/>
<text text-anchor="middle" x="151" y="-635.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_f</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~mc_fastion -->
<g id="proc~~get_fields~~CalledByGraph_edge26" class="edge"><title>proc~npa_f&#45;&gt;proc~mc_fastion</title>
<path fill="none" stroke="#000000" d="M178.124,-640.041C201.865,-641.891 237.286,-644.651 264.832,-646.798"/>
<polygon fill="#000000" stroke="#000000" points="264.721,-650.3 274.963,-647.587 265.265,-643.321 264.721,-650.3"/>
</g>
<!-- proc~npa_f&#45;&gt;proc~store_npa -->
<g id="proc~~get_fields~~CalledByGraph_edge31" class="edge"><title>proc~npa_f&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M178.141,-645.208C188.945,-648.675 201.396,-653.325 212,-659.006 239.202,-673.578 266.994,-695.638 285.231,-711.297"/>
<polygon fill="#000000" stroke="#000000" points="283.065,-714.052 292.9,-717.991 287.668,-708.778 283.065,-714.052"/>
</g>
<!-- program~fidasim -->
<g id="proc~~get_fields~~CalledByGraph_node32" class="node"><title>program~fidasim</title>
<g id="a_proc~~get_fields~~CalledByGraph_node32"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-545.006 0,-545.006 0,-521.006 54,-521.006 54,-545.006"/>
<text text-anchor="middle" x="27" y="-530.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~make_diagnostic_grids -->
<g id="proc~~get_fields~~CalledByGraph_edge22" class="edge"><title>program~fidasim&#45;&gt;proc~make_diagnostic_grids</title>
<path fill="none" stroke="#000000" d="M28.6381,-545.078C31.7264,-599.142 46.7805,-818.549 90,-869.006 90.7539,-869.886 91.5468,-870.729 92.3744,-871.537"/>
<polygon fill="#000000" stroke="#000000" points="90.5771,-874.57 100.636,-877.896 94.8466,-869.023 90.5771,-874.57"/>
</g>
<!-- program~fidasim&#45;&gt;proc~neutron_f -->
<g id="proc~~get_fields~~CalledByGraph_edge28" class="edge"><title>program~fidasim&#45;&gt;proc~neutron_f</title>
<path fill="none" stroke="#000000" d="M28.0171,-545.248C28.3586,-608.067 33.0618,-893.667 90,-956.006 172.941,-1046.81 337.803,-1030.77 412.117,-1017.85"/>
<polygon fill="#000000" stroke="#000000" points="412.77,-1021.29 421.984,-1016.06 411.52,-1014.4 412.77,-1021.29"/>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_weights -->
<g id="proc~~get_fields~~CalledByGraph_edge29" class="edge"><title>program~fidasim&#45;&gt;proc~npa_weights</title>
<path fill="none" stroke="#000000" d="M28.1932,-545.146C29.3829,-603.799 37.5331,-857.207 90,-911.006 172.809,-995.917 327.342,-987.046 404.18,-976.203"/>
<polygon fill="#000000" stroke="#000000" points="405.115,-979.602 414.491,-974.669 404.085,-972.678 405.115,-979.602"/>
</g>
<!-- program~fidasim&#45;&gt;proc~pfida_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge42" class="edge"><title>program~fidasim&#45;&gt;proc~pfida_mc</title>
<path fill="none" stroke="#000000" d="M27.9518,-545.055C28.4721,-580.415 34.8378,-685.038 90,-743.006 96.2462,-749.57 104.657,-754.083 113.202,-757.187"/>
<polygon fill="#000000" stroke="#000000" points="112.212,-760.544 122.798,-760.125 114.261,-753.85 112.212,-760.544"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_weights_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge43" class="edge"><title>program~fidasim&#45;&gt;proc~fida_weights_mc</title>
<path fill="none" stroke="#000000" d="M54.1721,-528.501C66.0035,-526.464 80.4637,-523.975 94.5287,-521.554"/>
<polygon fill="#000000" stroke="#000000" points="95.3957,-524.956 104.657,-519.811 94.2082,-518.058 95.3957,-524.956"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge44" class="edge"><title>program~fidasim&#45;&gt;proc~fida_mc</title>
<path fill="none" stroke="#000000" d="M54.1721,-537.511C71.6205,-540.514 94.7864,-544.502 113.97,-547.804"/>
<polygon fill="#000000" stroke="#000000" points="113.422,-551.261 123.871,-549.508 114.61,-544.362 113.422,-551.261"/>
</g>
<!-- program~fidasim&#45;&gt;proc~ndmc -->
<g id="proc~~get_fields~~CalledByGraph_edge45" class="edge"><title>program~fidasim&#45;&gt;proc~ndmc</title>
<path fill="none" stroke="#000000" d="M33.8933,-520.918C43.3186,-502.787 63.4579,-468.595 90,-449.006 97.1481,-443.73 105.734,-439.696 114.146,-436.644"/>
<polygon fill="#000000" stroke="#000000" points="115.413,-439.912 123.844,-433.497 113.252,-433.254 115.413,-439.912"/>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge46" class="edge"><title>program~fidasim&#45;&gt;proc~npa_mc</title>
<path fill="none" stroke="#000000" d="M28.9907,-545.032C32.1355,-575.472 44.5552,-656.321 90,-701.006 96.6324,-707.527 105.401,-712.031 114.18,-715.138"/>
<polygon fill="#000000" stroke="#000000" points="113.399,-718.558 123.984,-718.087 115.416,-711.855 113.399,-718.558"/>
</g>
<!-- program~fidasim&#45;&gt;proc~pnpa_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge55" class="edge"><title>program~fidasim&#45;&gt;proc~pnpa_mc</title>
<path fill="none" stroke="#000000" d="M30.7272,-545.303C36.8925,-570.292 54.2364,-627.315 90,-659.006 96.4008,-664.678 104.424,-668.84 112.502,-671.887"/>
<polygon fill="#000000" stroke="#000000" points="111.683,-675.301 122.275,-675.077 113.855,-668.647 111.683,-675.301"/>
</g>
<!-- program~fidasim&#45;&gt;proc~cfpd_f -->
<g id="proc~~get_fields~~CalledByGraph_edge57" class="edge"><title>program~fidasim&#45;&gt;proc~cfpd_f</title>
<path fill="none" stroke="#000000" d="M27.7,-520.592C26.3769,-454.221 23.7753,-141.966 90,-80.0057 134.823,-38.0692 310.676,-42.4157 366,-69.0057 402.035,-86.3252 427.451,-127.466 440.328,-152.803"/>
<polygon fill="#000000" stroke="#000000" points="437.264,-154.506 444.788,-161.965 443.558,-151.442 437.264,-154.506"/>
</g>
<!-- program~fidasim&#45;&gt;proc~neutron_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge58" class="edge"><title>program~fidasim&#45;&gt;proc~neutron_mc</title>
<path fill="none" stroke="#000000" d="M28.6045,-520.914C32.324,-448.91 53.1663,-78.655 90,-46.0057 180.022,33.7898 338.143,-9.77819 411.101,-36.3272"/>
<polygon fill="#000000" stroke="#000000" points="410.222,-39.7346 420.815,-39.9458 412.666,-33.175 410.222,-39.7346"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_weights_los -->
<g id="proc~~get_fields~~CalledByGraph_edge59" class="edge"><title>program~fidasim&#45;&gt;proc~fida_weights_los</title>
<path fill="none" stroke="#000000" d="M43.6139,-520.753C55.7484,-511.656 73.2749,-499.418 90,-491.006 93.7157,-489.137 97.6378,-487.363 101.625,-485.697"/>
<polygon fill="#000000" stroke="#000000" points="102.959,-488.933 110.98,-482.01 100.393,-482.42 102.959,-488.933"/>
</g>
<!-- program~fidasim&#45;&gt;proc~halo -->
<g id="proc~~get_fields~~CalledByGraph_edge64" class="edge"><title>program~fidasim&#45;&gt;proc~halo</title>
<path fill="none" stroke="#000000" d="M28.9907,-520.98C32.1355,-490.54 44.5552,-409.69 90,-365.006 96.6324,-358.484 105.401,-353.981 114.18,-350.873"/>
<polygon fill="#000000" stroke="#000000" points="115.416,-354.157 123.984,-347.925 113.399,-347.453 115.416,-354.157"/>
</g>
<!-- program~fidasim&#45;&gt;proc~halo_spec -->
<g id="proc~~get_fields~~CalledByGraph_edge65" class="edge"><title>program~fidasim&#45;&gt;proc~halo_spec</title>
<path fill="none" stroke="#000000" d="M28.0236,-520.779C28.404,-459.313 33.295,-184.747 90,-127.006 135.822,-80.3464 217.489,-79.664 266.209,-84.2526"/>
<polygon fill="#000000" stroke="#000000" points="266.06,-87.7565 276.374,-85.3318 266.799,-80.7956 266.06,-87.7565"/>
</g>
<!-- program~fidasim&#45;&gt;proc~pfida_f -->
<g id="proc~~get_fields~~CalledByGraph_edge66" class="edge"><title>program~fidasim&#45;&gt;proc~pfida_f</title>
<path fill="none" stroke="#000000" d="M28.9967,-545.221C33.3059,-595.212 51.8635,-783.61 90,-827.006 96.3131,-834.189 105.227,-838.916 114.258,-842.026"/>
<polygon fill="#000000" stroke="#000000" points="113.409,-845.423 123.986,-844.806 115.332,-838.693 113.409,-845.423"/>
</g>
<!-- program~fidasim&#45;&gt;proc~pnpa_f -->
<g id="proc~~get_fields~~CalledByGraph_edge67" class="edge"><title>program~fidasim&#45;&gt;proc~pnpa_f</title>
<path fill="none" stroke="#000000" d="M29.4703,-545.299C35.1348,-590.755 56.8944,-748.58 90,-785.006 96.3777,-792.023 105.233,-796.696 114.185,-799.807"/>
<polygon fill="#000000" stroke="#000000" points="113.244,-803.178 123.823,-802.607 115.197,-796.456 113.244,-803.178"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_f -->
<g id="proc~~get_fields~~CalledByGraph_edge68" class="edge"><title>program~fidasim&#45;&gt;proc~fida_f</title>
<path fill="none" stroke="#000000" d="M43.6139,-545.258C55.7484,-554.356 73.2749,-566.593 90,-575.006 97.6402,-578.849 106.153,-582.289 114.309,-585.219"/>
<polygon fill="#000000" stroke="#000000" points="113.405,-588.609 124,-588.532 115.67,-581.985 113.405,-588.609"/>
</g>
<!-- program~fidasim&#45;&gt;proc~nbi_spec -->
<g id="proc~~get_fields~~CalledByGraph_edge70" class="edge"><title>program~fidasim&#45;&gt;proc~nbi_spec</title>
<path fill="none" stroke="#000000" d="M28.3217,-520.771C29.8624,-485.792 38.7575,-383.97 90,-323.006 137.387,-266.629 221.696,-237.198 269.772,-224.308"/>
<polygon fill="#000000" stroke="#000000" points="270.649,-227.697 279.455,-221.805 268.897,-220.919 270.649,-227.697"/>
</g>
<!-- program~fidasim&#45;&gt;proc~cold_spec -->
<g id="proc~~get_fields~~CalledByGraph_edge71" class="edge"><title>program~fidasim&#45;&gt;proc~cold_spec</title>
<path fill="none" stroke="#000000" d="M28.9778,-520.881C33.2123,-471.266 51.516,-284.334 90,-242.006 135.459,-192.005 217.251,-178.493 266.091,-175.011"/>
<polygon fill="#000000" stroke="#000000" points="266.512,-178.492 276.283,-174.396 266.09,-171.505 266.512,-178.492"/>
</g>
<!-- program~fidasim&#45;&gt;proc~dcx_spec -->
<g id="proc~~get_fields~~CalledByGraph_edge72" class="edge"><title>program~fidasim&#45;&gt;proc~dcx_spec</title>
<path fill="none" stroke="#000000" d="M28.3791,-520.956C30.3902,-464.943 41.6233,-230.6 90,-180.006 136.128,-131.764 219.141,-126.895 267.722,-128.747"/>
<polygon fill="#000000" stroke="#000000" points="267.671,-132.249 277.832,-129.249 268.017,-125.257 267.671,-132.249"/>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_f -->
<g id="proc~~get_fields~~CalledByGraph_edge73" class="edge"><title>program~fidasim&#45;&gt;proc~npa_f</title>
<path fill="none" stroke="#000000" d="M33.8933,-545.094C43.3186,-563.224 63.4579,-597.416 90,-617.006 97.1481,-622.281 105.734,-626.316 114.146,-629.368"/>
<polygon fill="#000000" stroke="#000000" points="113.252,-632.757 123.844,-632.515 115.413,-626.099 113.252,-632.757"/>
</g>
<!-- proc~dcx -->
<g id="proc~~get_fields~~CalledByGraph_node33" class="node"><title>proc~dcx</title>
<g id="a_proc~~get_fields~~CalledByGraph_node33"><a xlink:href=".././proc/dcx.html" xlink:title="dcx">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-398.006 124,-398.006 124,-374.006 178,-374.006 178,-398.006"/>
<text text-anchor="middle" x="151" y="-383.606" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dcx</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~dcx -->
<g id="proc~~get_fields~~CalledByGraph_edge74" class="edge"><title>program~fidasim&#45;&gt;proc~dcx</title>
<path fill="none" stroke="#000000" d="M30.7272,-520.708C36.8925,-495.72 54.2364,-438.697 90,-407.006 96.8415,-400.943 105.537,-396.605 114.17,-393.511"/>
<polygon fill="#000000" stroke="#000000" points="115.28,-396.831 123.789,-390.52 113.201,-390.147 115.28,-396.831"/>
</g>
<!-- proc~dcx&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge41" class="edge"><title>proc~dcx&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.224,-394.486C188.812,-398.091 201.085,-402.499 212,-407.006 232.742,-415.57 255.451,-426.399 273.351,-435.288"/>
<polygon fill="#000000" stroke="#000000" points="272.25,-438.65 282.758,-439.999 275.385,-432.391 272.25,-438.65"/>
</g>
<!-- proc~dcx&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge54" class="edge"><title>proc~dcx&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M178.262,-380.657C189.454,-377.451 202.167,-372.496 212,-365.006 234.361,-347.973 225.106,-329.315 248,-313.006 292.354,-281.41 313.597,-294.819 366,-280.006 377.175,-276.847 389.18,-273.43 400.519,-270.193"/>
<polygon fill="#000000" stroke="#000000" points="401.621,-273.518 410.274,-267.405 399.697,-266.788 401.621,-273.518"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/get_fields.html#src">get_fields</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">get_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="n">ind</span><span class="p">,</span><span class="w"> </span><span class="n">input_coords</span><span class="p">,</span><span class="w"> </span><span class="n">output_coords</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="c">!+ Gets electro-magnetic fields at position `pos` or [[libfida:beam_grid]] indices `ind`</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w">                    </span><span class="kd">::</span><span class="w"> </span><span class="n">fields</span><span class="w"></span>
<span class="w">        </span><span class="c">!+ Electro-magnetic fields at `pos`/`ind`</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">pos</span><span class="w"></span>
<span class="w">        </span><span class="c">!+ Position in beam grid coordinates</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ind</span><span class="w"></span>
<span class="w">        </span><span class="c">!+ [[libfida:beam_grid]] indices</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">input_coords</span><span class="w"></span>
<span class="w">        </span><span class="c">!+ Indicates coordinate system of inputs. Beam grid (0), machine (1) and cylindrical (2)</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">output_coords</span><span class="w"></span>
<span class="w">        </span><span class="c">!+ Indicates coordinate system of outputs. Beam grid (0), machine (1) and cylindrical (2)</span>

<span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">inp</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xyz</span><span class="p">,</span><span class="w"> </span><span class="n">uvw</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">uvw_bfield</span><span class="p">,</span><span class="w"> </span><span class="n">uvw_efield</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xyz_bfield</span><span class="p">,</span><span class="w"> </span><span class="n">xyz_efield</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">phi</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">InterpolCoeffs3D</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">coeffs</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">k2</span><span class="p">,</span><span class="w"> </span><span class="n">mc</span><span class="p">,</span><span class="w"> </span><span class="n">ocs</span><span class="p">,</span><span class="w"> </span><span class="n">ics</span><span class="w"></span>

<span class="w">    </span><span class="n">fields</span><span class="p">%</span><span class="n">in_plasma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">False</span><span class="p">.</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">input_coords</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">ics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input_coords</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span>
<span class="k">        </span><span class="n">ics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">    if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">output_coords</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">ocs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">output_coords</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span>
<span class="k">        </span><span class="n">ocs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">    if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">ind</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">get_position</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">xyz</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">        if</span><span class="p">(</span><span class="n">ics</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">xyz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">xyz_to_uvw</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span><span class="w"> </span><span class="n">uvw</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">        if</span><span class="p">(</span><span class="n">ics</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">uvw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">uvw_to_xyz</span><span class="p">(</span><span class="n">uvw</span><span class="p">,</span><span class="w"> </span><span class="n">xyz</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">    endif</span>

<span class="k">    call </span><span class="n">in_plasma</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span><span class="n">inp</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">coeffs</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">i</span><span class="w"></span>
<span class="w">        </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">j</span><span class="w"></span>
<span class="w">        </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">k</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">inter_grid</span><span class="p">%</span><span class="n">nphi</span><span class="w"> </span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">k2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">inter_grid</span><span class="p">%</span><span class="n">nphi</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">else</span>
<span class="k">            </span><span class="n">k2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>

<span class="k">        </span><span class="n">fields</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b111</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b121</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                 </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b112</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k2</span><span class="p">)</span><span class="w">   </span><span class="o">+</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b122</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                 </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b211</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b221</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                 </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b212</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b222</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k2</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">atan2</span><span class="p">(</span><span class="n">uvw</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">uvw</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">        </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="c">!Convert cylindrical coordinates to uvw</span>
<span class="w">        </span><span class="n">uvw_bfield</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">br</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">bt</span><span class="w"></span>
<span class="w">        </span><span class="n">uvw_bfield</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">br</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">bt</span><span class="w"></span>
<span class="w">        </span><span class="n">uvw_bfield</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fields</span><span class="p">%</span><span class="n">bz</span><span class="w"></span>
<span class="w">        </span><span class="n">uvw_efield</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">er</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">et</span><span class="w"></span>
<span class="w">        </span><span class="n">uvw_efield</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">er</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">et</span><span class="w"></span>
<span class="w">        </span><span class="n">uvw_efield</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fields</span><span class="p">%</span><span class="n">ez</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">ocs</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">            </span><span class="c">!Represent fields in beam grid coordinates</span>
<span class="w">            </span><span class="n">xyz_bfield</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">matmul</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">inv_basis</span><span class="p">,</span><span class="n">uvw_bfield</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">xyz_efield</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">matmul</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">inv_basis</span><span class="p">,</span><span class="n">uvw_efield</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">fields</span><span class="p">%</span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xyz</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">        if</span><span class="p">(</span><span class="n">ocs</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">xyz_bfield</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uvw_bfield</span><span class="w"></span>
<span class="w">            </span><span class="n">xyz_efield</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uvw_efield</span><span class="w"></span>
<span class="w">            </span><span class="n">fields</span><span class="p">%</span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uvw</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span><span class="w"></span>

<span class="w">        </span><span class="c">!Calculate field directions and magnitudes</span>
<span class="w">        </span><span class="n">fields</span><span class="p">%</span><span class="n">b_abs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">norm2</span><span class="p">(</span><span class="n">xyz_bfield</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">fields</span><span class="p">%</span><span class="n">e_abs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">norm2</span><span class="p">(</span><span class="n">xyz_efield</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">fields</span><span class="p">%</span><span class="n">b_abs</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">)</span><span class="w"> </span><span class="n">fields</span><span class="p">%</span><span class="n">b_norm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xyz_bfield</span><span class="o">/</span><span class="n">fields</span><span class="p">%</span><span class="n">b_abs</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">fields</span><span class="p">%</span><span class="n">e_abs</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">)</span><span class="w"> </span><span class="n">fields</span><span class="p">%</span><span class="n">e_norm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xyz_efield</span><span class="o">/</span><span class="n">fields</span><span class="p">%</span><span class="n">e_abs</span><span class="w"></span>

<span class="w">        </span><span class="k">call </span><span class="n">calc_perp_vectors</span><span class="p">(</span><span class="n">fields</span><span class="p">%</span><span class="n">b_norm</span><span class="p">,</span><span class="n">fields</span><span class="p">%</span><span class="n">a_norm</span><span class="p">,</span><span class="n">fields</span><span class="p">%</span><span class="n">c_norm</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">fields</span><span class="p">%</span><span class="n">uvw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uvw</span><span class="w"></span>
<span class="w">        </span><span class="n">fields</span><span class="p">%</span><span class="n">in_plasma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">True</span><span class="p">.</span><span class="w"></span>
<span class="w">        </span><span class="n">fields</span><span class="p">%</span><span class="n">coords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ocs</span><span class="w"></span>
<span class="w">        </span><span class="n">fields</span><span class="p">%</span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coeffs</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">end subroutine </span><span class="n">get_fields</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>