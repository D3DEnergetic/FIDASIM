<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="">
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>get_fields &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>User Guide</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>get_fields
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.5% of total for procedures.">76 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
     <li><a href='../module/libfida.html'>libfida</a></li>
     <li class="active">get_fields</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/get_fields.html#src">get_fields</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public subroutine get_fields(fields, pos, ind, input_coords, output_coords)</h2>
    

    <p>Gets electro-magnetic fields at position <code>pos</code> or <a href="../module/libfida.html#variable-beam_grid">beam_grid</a> indices <code>ind</code></p>

    <h3>Arguments</h3>
      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-fields%7E4"></span>type(<a href='../type/localemfields.html'>LocalEMFields</a>),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>fields</strong></td><td><p>Electro-magnetic fields at <code>pos</code>/<code>ind</code></p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-pos%7E9"></span>real(kind=Float64),</td>
<td>intent(in),</td>
  <td>optional</td>  <td>dimension(3)</td><td>::</td>
  <td><strong>pos</strong></td><td><p>Position in beam grid coordinates</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ind%7E8"></span>integer(kind=Int32),</td>
<td>intent(in),</td>
  <td>optional</td>  <td>dimension(3)</td><td>::</td>
  <td><strong>ind</strong></td><td><p><a href="../module/libfida.html#variable-beam_grid">beam_grid</a> indices</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-input_coords%7E6"></span>integer(kind=Int32),</td>
<td>intent(in),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>input_coords</strong></td><td><p>Indicates coordinate system of inputs. Beam grid (0), machine (1) and cylindrical (2)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-output_coords%7E2"></span>integer(kind=Int32),</td>
<td>intent(in),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>output_coords</strong></td><td><p>Indicates coordinate system of outputs. Beam grid (0), machine (1) and cylindrical (2)</p></td>
</tr>
</tbody>
</table>

    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~get_fields~~CallsGraph Pages: 1 -->
<svg id="procget_fieldsCallsGraph" width="420pt" height="200pt"
 viewBox="0.00 0.00 420.00 200.11" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~get_fields~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 196.109)">
<title>proc~~get_fields~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-196.109 416,-196.109 416,4 -4,4"/>
<!-- proc~get_fields -->
<g id="proc~~get_fields~~CallsGraph_node1" class="node"><title>proc~get_fields</title>
<polygon fill="none" stroke="black" points="58,-96.1121 3.55271e-15,-96.1121 3.55271e-15,-72.1121 58,-72.1121 58,-96.1121"/>
<text text-anchor="middle" x="29" y="-81.7121" font-family="Helvetica,sans-Serif" font-size="10.50">get_fields</text>
</g>
<!-- proc~get_position -->
<g id="proc~~get_fields~~CallsGraph_node2" class="node"><title>proc~get_position</title>
<g id="a_proc~~get_fields~~CallsGraph_node2"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="179,-54.1121 109,-54.1121 109,-30.1121 179,-30.1121 179,-54.1121"/>
<text text-anchor="middle" x="144" y="-39.7121" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~get_fields~~CallsGraph_edge1" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M58.2232,-73.622C71.0767,-68.8446 86.5609,-63.0894 100.76,-57.8121"/>
<polygon fill="#000000" stroke="#000000" points="102.182,-61.0174 110.336,-54.2527 99.743,-54.456 102.182,-61.0174"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~get_fields~~CallsGraph_node3" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~get_fields~~CallsGraph_node3"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="174.5,-176.112 113.5,-176.112 113.5,-152.112 174.5,-152.112 174.5,-176.112"/>
<text text-anchor="middle" x="144" y="-161.712" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~get_fields~~CallsGraph_edge2" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M42.5894,-96.139C55.0507,-107.695 74.9692,-125.25 94,-138.112 98.6377,-141.247 103.695,-144.298 108.743,-147.143"/>
<polygon fill="#000000" stroke="#000000" points="107.267,-150.323 117.726,-152.013 110.603,-144.17 107.267,-150.323"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~get_fields~~CallsGraph_node4" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~get_fields~~CallsGraph_node4"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="194,-96.1121 94,-96.1121 94,-72.1121 194,-72.1121 194,-96.1121"/>
<text text-anchor="middle" x="144" y="-81.7121" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~get_fields~~CallsGraph_edge3" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M58.2232,-84.1121C65.9288,-84.1121 74.5798,-84.1121 83.3325,-84.1121"/>
<polygon fill="#000000" stroke="#000000" points="83.6035,-87.6122 93.6035,-84.1121 83.6035,-80.6122 83.6035,-87.6122"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~get_fields~~CallsGraph_node5" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~get_fields~~CallsGraph_node5"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="412,-34.1121 344,-34.1121 344,-10.1121 412,-10.1121 412,-34.1121"/>
<text text-anchor="middle" x="378" y="-19.7121" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~get_fields~~CallsGraph_edge4" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M37.7655,-72.0266C48.3511,-56.804 68.8957,-31.395 94,-21.1121 173.398,11.4099 276.161,-0.903314 333.467,-12.0164"/>
<polygon fill="#000000" stroke="#000000" points="333.127,-15.5183 343.622,-14.0664 334.512,-8.65676 333.127,-15.5183"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_node6" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~get_fields~~CallsGraph_node6"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-134.112 235,-134.112 235,-110.112 303,-110.112 303,-134.112"/>
<text text-anchor="middle" x="269" y="-119.712" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_edge5" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M58.3073,-94.8842C69.3044,-98.6749 82.0985,-102.61 94,-105.112 138.066,-114.377 189.494,-118.612 224.952,-120.537"/>
<polygon fill="#000000" stroke="#000000" points="224.799,-124.033 234.963,-121.042 225.152,-117.042 224.799,-124.033"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~get_fields~~CallsGraph_node9" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~get_fields~~CallsGraph_node9"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="300,-54.1121 238,-54.1121 238,-30.1121 300,-30.1121 300,-54.1121"/>
<text text-anchor="middle" x="269" y="-39.7121" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~get_fields~~CallsGraph_edge6" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M179.262,-42.1121C194.163,-42.1121 211.737,-42.1121 227.298,-42.1121"/>
<polygon fill="#000000" stroke="#000000" points="227.692,-45.6122 237.692,-42.1121 227.692,-38.6122 227.692,-45.6122"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_edge9" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M174.775,-153.945C189.871,-148.79 208.479,-142.436 225.09,-136.764"/>
<polygon fill="#000000" stroke="#000000" points="226.265,-140.061 234.598,-133.518 224.003,-133.437 226.265,-140.061"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_node7" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~get_fields~~CallsGraph_node7"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="410.5,-146.112 345.5,-146.112 345.5,-122.112 410.5,-122.112 410.5,-146.112"/>
<text text-anchor="middle" x="378" y="-131.712" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_edge7" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M174.593,-175.569C207.833,-186.703 263.015,-199.933 308,-185.112 327.215,-178.782 345.462,-164.814 358.36,-153.094"/>
<polygon fill="#000000" stroke="#000000" points="360.81,-155.595 365.661,-146.176 355.995,-150.514 360.81,-155.595"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~get_fields~~CallsGraph_node8" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~get_fields~~CallsGraph_node8"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="307.5,-176.112 230.5,-176.112 230.5,-152.112 307.5,-152.112 307.5,-176.112"/>
<text text-anchor="middle" x="269" y="-161.712" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~get_fields~~CallsGraph_edge8" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M174.775,-164.112C188.292,-164.112 204.626,-164.112 219.82,-164.112"/>
<polygon fill="#000000" stroke="#000000" points="220.108,-167.612 230.108,-164.112 220.108,-160.612 220.108,-167.612"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~get_fields~~CallsGraph_edge11" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M300.09,-36.4877C310.502,-34.5416 322.387,-32.3202 333.649,-30.2151"/>
<polygon fill="#000000" stroke="#000000" points="334.57,-33.6037 343.756,-28.3259 333.283,-26.7229 334.57,-33.6037"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_edge10" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M283.988,-54.1395C302.172,-69.7738 334.114,-97.238 355.416,-115.554"/>
<polygon fill="#000000" stroke="#000000" points="353.144,-118.216 363.008,-122.082 357.707,-112.908 353.144,-118.216"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~get_fields~~CalledByGraph Pages: 1 -->
<svg id="procget_fieldsCalledByGraph" width="602pt" height="1054pt"
 viewBox="0.00 0.00 602.00 1053.54" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~get_fields~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 1049.54)">
<title>proc~~get_fields~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1049.54 598,-1049.54 598,4 -4,4"/>
<!-- proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_node1" class="node"><title>proc~get_fields</title>
<polygon fill="none" stroke="black" points="594,-684.384 536,-684.384 536,-660.384 594,-660.384 594,-684.384"/>
<text text-anchor="middle" x="565" y="-669.984" font-family="Helvetica,sans-Serif" font-size="10.50">get_fields</text>
</g>
<!-- proc~npa_mc -->
<g id="proc~~get_fields~~CalledByGraph_node2" class="node"><title>proc~npa_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node2"><a xlink:href=".././proc/npa_mc.html" xlink:title="npa_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-968.384 124,-968.384 124,-944.384 178,-944.384 178,-968.384"/>
<text text-anchor="middle" x="151" y="-953.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_mc</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge3" class="edge"><title>proc~npa_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M171.267,-968.519C228.658,-1002.98 400.635,-1093.75 500,-1011.38 549.032,-970.743 560.766,-763.688 563.334,-694.747"/>
<polygon fill="#000000" stroke="#000000" points="566.838,-694.684 563.683,-684.57 559.842,-694.444 566.838,-694.684"/>
</g>
<!-- proc~store_npa -->
<g id="proc~~get_fields~~CalledByGraph_node17" class="node"><title>proc~store_npa</title>
<g id="a_proc~~get_fields~~CalledByGraph_node17"><a xlink:href=".././proc/store_npa.html" xlink:title="store_npa">
<polygon fill="#d9534f" stroke="#d9534f" points="337.5,-884.384 276.5,-884.384 276.5,-860.384 337.5,-860.384 337.5,-884.384"/>
<text text-anchor="middle" x="307" y="-869.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_npa</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~store_npa -->
<g id="proc~~get_fields~~CalledByGraph_edge47" class="edge"><title>proc~npa_mc&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M178.284,-948.787C188.994,-945.284 201.339,-940.713 212,-935.384 237.219,-922.777 263.705,-904.505 282.111,-890.883"/>
<polygon fill="#000000" stroke="#000000" points="284.563,-893.418 290.456,-884.614 280.359,-887.821 284.563,-893.418"/>
</g>
<!-- proc~store_fw_photons -->
<g id="proc~~get_fields~~CalledByGraph_node3" class="node"><title>proc~store_fw_photons</title>
<g id="a_proc~~get_fields~~CalledByGraph_node3"><a xlink:href=".././proc/store_fw_photons.html" xlink:title="store_fw_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="499.5,-1002.38 402.5,-1002.38 402.5,-978.384 499.5,-978.384 499.5,-1002.38"/>
<text text-anchor="middle" x="451" y="-987.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_fw_photons</text>
</a>
</g>
</g>
<!-- proc~store_fw_photons&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge2" class="edge"><title>proc~store_fw_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M483.893,-978.143C489.994,-974.524 495.783,-969.988 500,-964.384 532.46,-921.245 554.43,-755.364 561.522,-694.738"/>
<polygon fill="#000000" stroke="#000000" points="565.011,-695.029 562.672,-684.696 558.057,-694.233 565.011,-695.029"/>
</g>
<!-- proc~fida_weights_mc -->
<g id="proc~~get_fields~~CalledByGraph_node4" class="node"><title>proc~fida_weights_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node4"><a xlink:href=".././proc/fida_weights_mc.html" xlink:title="fida_weights_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="197,-926.384 105,-926.384 105,-902.384 197,-902.384 197,-926.384"/>
<text text-anchor="middle" x="151" y="-911.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_weights_mc</text>
</a>
</g>
</g>
<!-- proc~fida_weights_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge4" class="edge"><title>proc~fida_weights_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M189.275,-926.417C259.661,-946.567 412.865,-977.783 500,-900.384 531.071,-872.785 552.981,-746.586 560.822,-694.729"/>
<polygon fill="#000000" stroke="#000000" points="564.322,-694.987 562.319,-684.584 557.396,-693.966 564.322,-694.987"/>
</g>
<!-- proc~fida_weights_mc&#45;&gt;proc~store_fw_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge21" class="edge"><title>proc~fida_weights_mc&#45;&gt;proc~store_fw_photons</title>
<path fill="none" stroke="#000000" d="M192.525,-926.434C199.203,-929.018 205.923,-932.005 212,-935.384 229.957,-945.367 229.101,-956.325 248,-964.384 293.876,-983.946 350.519,-989.844 392.139,-991.198"/>
<polygon fill="#000000" stroke="#000000" points="392.298,-994.702 402.381,-991.449 392.47,-987.705 392.298,-994.702"/>
</g>
<!-- proc~track -->
<g id="proc~~get_fields~~CalledByGraph_node8" class="node"><title>proc~track</title>
<g id="a_proc~~get_fields~~CalledByGraph_node8"><a xlink:href=".././proc/track.html" xlink:title="track">
<polygon fill="#d9534f" stroke="#d9534f" points="334,-724.384 280,-724.384 280,-700.384 334,-700.384 334,-724.384"/>
<text text-anchor="middle" x="307" y="-709.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track</text>
</a>
</g>
</g>
<!-- proc~fida_weights_mc&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge28" class="edge"><title>proc~fida_weights_mc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M197.286,-903.243C202.649,-900.616 207.725,-897.376 212,-893.384 241.684,-865.659 229.536,-845.562 248,-809.384 261.797,-782.35 280.097,-752.57 292.421,-733.233"/>
<polygon fill="#000000" stroke="#000000" points="295.483,-734.942 297.945,-724.637 289.594,-731.158 295.483,-734.942"/>
</g>
<!-- proc~fida_weights_los -->
<g id="proc~~get_fields~~CalledByGraph_node5" class="node"><title>proc~fida_weights_los</title>
<g id="a_proc~~get_fields~~CalledByGraph_node5"><a xlink:href=".././proc/fida_weights_los.html" xlink:title="fida_weights_los">
<polygon fill="#d9534f" stroke="#d9534f" points="196.5,-774.384 105.5,-774.384 105.5,-750.384 196.5,-750.384 196.5,-774.384"/>
<text text-anchor="middle" x="151" y="-759.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_weights_los</text>
</a>
</g>
</g>
<!-- proc~fida_weights_los&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge5" class="edge"><title>proc~fida_weights_los&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M196.723,-770.775C265.99,-781.461 401.49,-792.982 500,-742.384 521.875,-731.148 540.008,-709.199 551.321,-692.86"/>
<polygon fill="#000000" stroke="#000000" points="554.278,-694.733 556.884,-684.464 548.443,-690.866 554.278,-694.733"/>
</g>
<!-- proc~fida_weights_los&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge30" class="edge"><title>proc~fida_weights_los&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M189.279,-750.28C213.846,-742.304 245.841,-731.916 270.118,-724.034"/>
<polygon fill="#000000" stroke="#000000" points="271.244,-727.348 279.674,-720.931 269.082,-720.69 271.244,-727.348"/>
</g>
<!-- proc~mc_fastion -->
<g id="proc~~get_fields~~CalledByGraph_node6" class="node"><title>proc~mc_fastion</title>
<g id="a_proc~~get_fields~~CalledByGraph_node6"><a xlink:href=".././proc/mc_fastion.html" xlink:title="mc_fastion">
<polygon fill="#d9534f" stroke="#d9534f" points="339,-842.384 275,-842.384 275,-818.384 339,-818.384 339,-842.384"/>
<text text-anchor="middle" x="307" y="-827.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_fastion</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge6" class="edge"><title>proc~mc_fastion&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M339.184,-834.595C380.112,-838.389 452.33,-838.92 500,-804.384 536.554,-777.901 553.169,-724.819 559.933,-694.661"/>
<polygon fill="#000000" stroke="#000000" points="563.4,-695.181 561.999,-684.679 556.545,-693.763 563.4,-695.181"/>
</g>
<!-- proc~mc_fastion_pass_grid -->
<g id="proc~~get_fields~~CalledByGraph_node7" class="node"><title>proc~mc_fastion_pass_grid</title>
<g id="a_proc~~get_fields~~CalledByGraph_node7"><a xlink:href=".././proc/mc_fastion_pass_grid.html" xlink:title="mc_fastion_pass_grid">
<polygon fill="#d9534f" stroke="#d9534f" points="365.5,-644.384 248.5,-644.384 248.5,-620.384 365.5,-620.384 365.5,-644.384"/>
<text text-anchor="middle" x="307" y="-629.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_fastion_pass_grid</text>
</a>
</g>
</g>
<!-- proc~mc_fastion_pass_grid&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge7" class="edge"><title>proc~mc_fastion_pass_grid&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M365.739,-638.969C403.957,-643.63 455.117,-650.449 500,-658.384 508.361,-659.862 517.287,-661.668 525.739,-663.486"/>
<polygon fill="#000000" stroke="#000000" points="525.224,-666.956 535.742,-665.687 526.728,-660.12 525.224,-666.956"/>
</g>
<!-- proc~track&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge8" class="edge"><title>proc~track&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M334.19,-709.517C371.247,-705.306 441.039,-696.807 500,-686.384 508.361,-684.906 517.287,-683.099 525.739,-681.282"/>
<polygon fill="#000000" stroke="#000000" points="526.728,-684.648 535.742,-679.08 525.224,-677.811 526.728,-684.648"/>
</g>
<!-- proc~fida_mc -->
<g id="proc~~get_fields~~CalledByGraph_node9" class="node"><title>proc~fida_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node9"><a xlink:href=".././proc/fida_mc.html" xlink:title="fida_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-648.384 124,-648.384 124,-624.384 178,-624.384 178,-648.384"/>
<text text-anchor="middle" x="151" y="-633.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_mc</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge9" class="edge"><title>proc~fida_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M178.268,-640.833C189.725,-643.885 202.646,-648.97 212,-657.384 239.788,-682.379 216.417,-713.397 248,-733.384 341.218,-792.375 478.61,-724.09 536.591,-689.761"/>
<polygon fill="#000000" stroke="#000000" points="538.442,-692.732 545.195,-684.568 534.825,-686.739 538.442,-692.732"/>
</g>
<!-- proc~fida_mc&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge32" class="edge"><title>proc~fida_mc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.23,-643.423C189.048,-646.864 201.486,-651.539 212,-657.384 229.957,-667.367 230.482,-675.649 248,-686.384 255.09,-690.729 263.032,-694.769 270.71,-698.307"/>
<polygon fill="#000000" stroke="#000000" points="269.308,-701.514 279.869,-702.36 272.141,-695.112 269.308,-701.514"/>
</g>
<!-- proc~store_fida_photons -->
<g id="proc~~get_fields~~CalledByGraph_node27" class="node"><title>proc~store_fida_photons</title>
<g id="a_proc~~get_fields~~CalledByGraph_node27"><a xlink:href=".././proc/store_fida_photons.html" xlink:title="store_fida_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="359,-522.384 255,-522.384 255,-498.384 359,-498.384 359,-522.384"/>
<text text-anchor="middle" x="307" y="-507.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_fida_photons</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge69" class="edge"><title>proc~fida_mc&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M178.058,-630.759C189.212,-627.502 201.952,-622.583 212,-615.384 233.103,-600.263 230.873,-588.894 248,-569.384 260.011,-555.702 274.346,-541.105 285.76,-529.853"/>
<polygon fill="#000000" stroke="#000000" points="288.425,-532.143 293.131,-522.65 283.533,-527.136 288.425,-532.143"/>
</g>
<!-- proc~ndmc -->
<g id="proc~~get_fields~~CalledByGraph_node10" class="node"><title>proc~ndmc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node10"><a xlink:href=".././proc/ndmc.html" xlink:title="ndmc">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-606.384 124,-606.384 124,-582.384 178,-582.384 178,-606.384"/>
<text text-anchor="middle" x="151" y="-591.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ndmc</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge10" class="edge"><title>proc~ndmc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M178.044,-600.556C189.071,-603.894 201.717,-608.726 212,-615.384 231.529,-628.027 226.914,-643.554 248,-653.384 340.059,-696.301 463.886,-687.155 525.637,-678.75"/>
<polygon fill="#000000" stroke="#000000" points="526.309,-682.19 535.712,-677.309 525.317,-675.26 526.309,-682.19"/>
</g>
<!-- proc~ndmc&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge33" class="edge"><title>proc~ndmc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.165,-598.95C189.6,-602.026 202.534,-607.096 212,-615.384 238.62,-638.689 222.391,-661.972 248,-686.384 254.372,-692.458 262.406,-697.272 270.447,-701.02"/>
<polygon fill="#000000" stroke="#000000" points="269.214,-704.299 279.79,-704.943 271.924,-697.845 269.214,-704.299"/>
</g>
<!-- proc~store_nbi_photons -->
<g id="proc~~get_fields~~CalledByGraph_node22" class="node"><title>proc~store_nbi_photons</title>
<g id="a_proc~~get_fields~~CalledByGraph_node22"><a xlink:href=".././proc/store_nbi_photons.html" xlink:title="store_nbi_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="357.5,-602.384 256.5,-602.384 256.5,-578.384 357.5,-578.384 357.5,-602.384"/>
<text text-anchor="middle" x="307" y="-587.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_nbi_photons</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~store_nbi_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge61" class="edge"><title>proc~ndmc&#45;&gt;proc~store_nbi_photons</title>
<path fill="none" stroke="#000000" d="M178.124,-593.705C196.737,-593.222 222.53,-592.552 246.078,-591.94"/>
<polygon fill="#000000" stroke="#000000" points="246.449,-595.432 256.354,-591.673 246.267,-588.434 246.449,-595.432"/>
</g>
<!-- proc~pnpa_mc -->
<g id="proc~~get_fields~~CalledByGraph_node11" class="node"><title>proc~pnpa_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node11"><a xlink:href=".././proc/pnpa_mc.html" xlink:title="pnpa_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="179.5,-884.384 122.5,-884.384 122.5,-860.384 179.5,-860.384 179.5,-884.384"/>
<text text-anchor="middle" x="151" y="-869.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pnpa_mc</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge11" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M179.76,-882.426C244.896,-904.018 408.901,-946.631 500,-865.384 550.33,-820.497 561.184,-735.125 563.451,-694.688"/>
<polygon fill="#000000" stroke="#000000" points="566.954,-694.687 563.888,-684.546 559.961,-694.385 566.954,-694.687"/>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~store_npa -->
<g id="proc~~get_fields~~CalledByGraph_edge48" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M179.532,-872.384C203.591,-872.384 238.823,-872.384 265.994,-872.384"/>
<polygon fill="#000000" stroke="#000000" points="266.343,-875.884 276.343,-872.384 266.343,-868.884 266.343,-875.884"/>
</g>
<!-- proc~cfpd_f -->
<g id="proc~~get_fields~~CalledByGraph_node12" class="node"><title>proc~cfpd_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node12"><a xlink:href=".././proc/cfpd_f.html" xlink:title="cfpd_f">
<polygon fill="#d9534f" stroke="#d9534f" points="478,-400.384 424,-400.384 424,-376.384 478,-376.384 478,-400.384"/>
<text text-anchor="middle" x="451" y="-385.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cfpd_f</text>
</a>
</g>
</g>
<!-- proc~cfpd_f&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge12" class="edge"><title>proc~cfpd_f&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M463.866,-400.469C474.693,-412.112 490.421,-430.671 500,-449.384 535.135,-518.026 553.512,-608.718 560.546,-650.091"/>
<polygon fill="#000000" stroke="#000000" points="557.127,-650.87 562.199,-660.172 564.035,-649.737 557.127,-650.87"/>
</g>
<!-- proc~neutron_mc -->
<g id="proc~~get_fields~~CalledByGraph_node13" class="node"><title>proc~neutron_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node13"><a xlink:href=".././proc/neutron_mc.html" xlink:title="neutron_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="486,-319.384 416,-319.384 416,-295.384 486,-295.384 486,-319.384"/>
<text text-anchor="middle" x="451" y="-304.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutron_mc</text>
</a>
</g>
</g>
<!-- proc~neutron_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge13" class="edge"><title>proc~neutron_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M464.614,-319.52C475.645,-330.865 491.235,-348.804 500,-367.384 546.453,-465.854 559.421,-597.977 562.844,-650"/>
<polygon fill="#000000" stroke="#000000" points="559.358,-650.342 563.453,-660.113 566.345,-649.921 559.358,-650.342"/>
</g>
<!-- proc~track_cylindrical -->
<g id="proc~~get_fields~~CalledByGraph_node14" class="node"><title>proc~track_cylindrical</title>
<g id="a_proc~~get_fields~~CalledByGraph_node14"><a xlink:href=".././proc/track_cylindrical.html" xlink:title="track_cylindrical">
<polygon fill="#d9534f" stroke="#d9534f" points="351,-160.384 263,-160.384 263,-136.384 351,-136.384 351,-160.384"/>
<text text-anchor="middle" x="307" y="-145.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track_cylindrical</text>
</a>
</g>
</g>
<!-- proc~track_cylindrical&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge14" class="edge"><title>proc~track_cylindrical&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M351.117,-140.688C394.912,-135.579 461.599,-135.721 500,-174.384 534.055,-208.67 557.133,-557.221 562.699,-649.87"/>
<polygon fill="#000000" stroke="#000000" points="559.218,-650.31 563.303,-660.085 566.206,-649.896 559.218,-650.31"/>
</g>
<!-- proc~npa_weights -->
<g id="proc~~get_fields~~CalledByGraph_node15" class="node"><title>proc~npa_weights</title>
<g id="a_proc~~get_fields~~CalledByGraph_node15"><a xlink:href=".././proc/npa_weights.html" xlink:title="npa_weights">
<polygon fill="#d9534f" stroke="#d9534f" points="487.5,-82.3839 414.5,-82.3839 414.5,-58.3839 487.5,-58.3839 487.5,-82.3839"/>
<text text-anchor="middle" x="451" y="-67.9839" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_weights</text>
</a>
</g>
</g>
<!-- proc~npa_weights&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge15" class="edge"><title>proc~npa_weights&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M484.839,-82.5981C490.725,-86.1903 496.189,-90.7234 500,-96.3839 562.498,-189.22 564.705,-555.657 564.211,-650.09"/>
<polygon fill="#000000" stroke="#000000" points="560.71,-650.197 564.141,-660.221 567.71,-650.246 560.71,-650.197"/>
</g>
<!-- proc~pfida_mc -->
<g id="proc~~get_fields~~CalledByGraph_node16" class="node"><title>proc~pfida_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node16"><a xlink:href=".././proc/pfida_mc.html" xlink:title="pfida_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="179,-156.384 123,-156.384 123,-132.384 179,-132.384 179,-156.384"/>
<text text-anchor="middle" x="151" y="-141.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pfida_mc</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge1" class="edge"><title>proc~pfida_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M179.053,-132.495C244.085,-105.957 410.416,-50.5436 500,-134.384 538.315,-170.243 558.464,-552.42 563.002,-649.871"/>
<polygon fill="#000000" stroke="#000000" points="559.515,-650.238 563.468,-660.068 566.508,-649.919 559.515,-650.238"/>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~track_cylindrical -->
<g id="proc~~get_fields~~CalledByGraph_edge41" class="edge"><title>proc~pfida_mc&#45;&gt;proc~track_cylindrical</title>
<path fill="none" stroke="#000000" d="M179.178,-145.09C199.517,-145.618 227.983,-146.357 252.795,-147.002"/>
<polygon fill="#000000" stroke="#000000" points="252.724,-150.501 262.811,-147.262 252.905,-143.504 252.724,-150.501"/>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge66" class="edge"><title>proc~pfida_mc&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M179.295,-147.494C191.105,-150.272 204.023,-155.512 212,-165.384 292.524,-265.029 192.156,-336.082 248,-451.384 255.58,-467.034 268.961,-481.077 280.962,-491.532"/>
<polygon fill="#000000" stroke="#000000" points="279.032,-494.479 288.962,-498.173 283.503,-489.093 279.032,-494.479"/>
</g>
<!-- proc~store_npa&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge16" class="edge"><title>proc~store_npa&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M337.675,-874.545C378.872,-875.906 453.553,-872.222 500,-833.384 542.476,-797.866 556.957,-730.183 561.742,-694.957"/>
<polygon fill="#000000" stroke="#000000" points="565.251,-695.09 562.978,-684.742 558.302,-694.249 565.251,-695.09"/>
</g>
<!-- proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_node18" class="node"><title>proc~store_photons</title>
<g id="a_proc~~get_fields~~CalledByGraph_node18"><a xlink:href=".././proc/store_photons.html" xlink:title="store_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="491.5,-482.384 410.5,-482.384 410.5,-458.384 491.5,-458.384 491.5,-482.384"/>
<text text-anchor="middle" x="451" y="-467.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_photons</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge17" class="edge"><title>proc~store_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M458.671,-482.415C477.108,-515.667 528.935,-609.141 552.308,-651.296"/>
<polygon fill="#000000" stroke="#000000" points="549.313,-653.112 557.223,-660.16 555.435,-649.718 549.313,-653.112"/>
</g>
<!-- proc~make_diagnostic_grids -->
<g id="proc~~get_fields~~CalledByGraph_node19" class="node"><title>proc~make_diagnostic_grids</title>
<g id="a_proc~~get_fields~~CalledByGraph_node19"><a xlink:href=".././proc/make_diagnostic_grids.html" xlink:title="make_diagnostic_grids">
<polygon fill="#d9534f" stroke="#d9534f" points="212,-198.384 90,-198.384 90,-174.384 212,-174.384 212,-198.384"/>
<text text-anchor="middle" x="151" y="-183.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">make_diagnostic_grids</text>
</a>
</g>
</g>
<!-- proc~make_diagnostic_grids&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge18" class="edge"><title>proc~make_diagnostic_grids&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M212.052,-183.279C293.121,-182.809 434.904,-195.955 500,-286.384 542.568,-345.517 558.735,-576.6 562.857,-649.927"/>
<polygon fill="#000000" stroke="#000000" points="559.382,-650.494 563.417,-660.29 566.372,-650.116 559.382,-650.494"/>
</g>
<!-- proc~make_diagnostic_grids&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge35" class="edge"><title>proc~make_diagnostic_grids&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M155.042,-198.564C164.272,-235.727 192.513,-350.998 212,-447.384 230.418,-538.484 205.499,-570.727 248,-653.384 256.005,-668.952 269.533,-683.069 281.512,-693.588"/>
<polygon fill="#000000" stroke="#000000" points="279.561,-696.52 289.47,-700.27 284.062,-691.159 279.561,-696.52"/>
</g>
<!-- proc~make_diagnostic_grids&#45;&gt;proc~track_cylindrical -->
<g id="proc~~get_fields~~CalledByGraph_edge43" class="edge"><title>proc~make_diagnostic_grids&#45;&gt;proc~track_cylindrical</title>
<path fill="none" stroke="#000000" d="M200.727,-174.36C217.374,-170.253 236.07,-165.639 253.035,-161.453"/>
<polygon fill="#000000" stroke="#000000" points="253.925,-164.839 262.795,-159.045 252.248,-158.042 253.925,-164.839"/>
</g>
<!-- proc~neutron_f -->
<g id="proc~~get_fields~~CalledByGraph_node20" class="node"><title>proc~neutron_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node20"><a xlink:href=".././proc/neutron_f.html" xlink:title="neutron_f">
<polygon fill="#d9534f" stroke="#d9534f" points="480,-40.3839 422,-40.3839 422,-16.3839 480,-16.3839 480,-40.3839"/>
<text text-anchor="middle" x="451" y="-25.9839" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutron_f</text>
</a>
</g>
</g>
<!-- proc~neutron_f&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge19" class="edge"><title>proc~neutron_f&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M480.036,-34.9767C487.645,-38.1111 495.121,-42.6974 500,-49.3839 536.136,-98.9061 558.274,-544.704 563.032,-650.115"/>
<polygon fill="#000000" stroke="#000000" points="559.541,-650.412 563.482,-660.247 566.534,-650.101 559.541,-650.412"/>
</g>
<!-- proc~npa_f -->
<g id="proc~~get_fields~~CalledByGraph_node21" class="node"><title>proc~npa_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node21"><a xlink:href=".././proc/npa_f.html" xlink:title="npa_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-842.384 124,-842.384 124,-818.384 178,-818.384 178,-842.384"/>
<text text-anchor="middle" x="151" y="-827.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_f</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~mc_fastion -->
<g id="proc~~get_fields~~CalledByGraph_edge24" class="edge"><title>proc~npa_f&#45;&gt;proc~mc_fastion</title>
<path fill="none" stroke="#000000" d="M178.124,-830.384C201.865,-830.384 237.286,-830.384 264.832,-830.384"/>
<polygon fill="#000000" stroke="#000000" points="264.963,-833.884 274.963,-830.384 264.963,-826.884 264.963,-833.884"/>
</g>
<!-- proc~npa_f&#45;&gt;proc~store_npa -->
<g id="proc~~get_fields~~CalledByGraph_edge46" class="edge"><title>proc~npa_f&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M178.124,-837.509C202.352,-844.116 238.743,-854.041 266.516,-861.616"/>
<polygon fill="#000000" stroke="#000000" points="265.751,-865.035 276.32,-864.289 267.593,-858.281 265.751,-865.035"/>
</g>
<!-- proc~store_nbi_photons&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge50" class="edge"><title>proc~store_nbi_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M341.232,-578.355C349.702,-574.536 358.518,-569.856 366,-564.384 394.596,-543.47 420.614,-511.42 435.881,-490.68"/>
<polygon fill="#000000" stroke="#000000" points="438.734,-492.708 441.742,-482.549 433.055,-488.615 438.734,-492.708"/>
</g>
<!-- proc~nbi_spec -->
<g id="proc~~get_fields~~CalledByGraph_node23" class="node"><title>proc~nbi_spec</title>
<g id="a_proc~~get_fields~~CalledByGraph_node23"><a xlink:href=".././proc/nbi_spec.html" xlink:title="nbi_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="334.5,-442.384 279.5,-442.384 279.5,-418.384 334.5,-418.384 334.5,-442.384"/>
<text text-anchor="middle" x="307" y="-427.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nbi_spec</text>
</a>
</g>
</g>
<!-- proc~nbi_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge51" class="edge"><title>proc~nbi_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M334.709,-437.908C353.172,-443.108 378.287,-450.183 400.363,-456.402"/>
<polygon fill="#000000" stroke="#000000" points="399.683,-459.846 410.258,-459.189 401.581,-453.109 399.683,-459.846"/>
</g>
<!-- proc~halo -->
<g id="proc~~get_fields~~CalledByGraph_node24" class="node"><title>proc~halo</title>
<g id="a_proc~~get_fields~~CalledByGraph_node24"><a xlink:href=".././proc/halo.html" xlink:title="halo">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-564.384 124,-564.384 124,-540.384 178,-540.384 178,-564.384"/>
<text text-anchor="middle" x="151" y="-549.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">halo</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge29" class="edge"><title>proc~halo&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.043,-556.67C189.59,-559.695 202.647,-564.804 212,-573.384 240.732,-599.741 225.989,-621.201 248,-653.384 258.014,-668.026 271.865,-682.272 283.519,-693.096"/>
<polygon fill="#000000" stroke="#000000" points="281.398,-695.896 291.163,-700.006 286.092,-690.704 281.398,-695.896"/>
</g>
<!-- proc~halo&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge52" class="edge"><title>proc~halo&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M178.023,-554.122C219.327,-555.95 301.785,-555.771 366,-531.384 390.535,-522.066 414.336,-503.612 430.301,-489.43"/>
<polygon fill="#000000" stroke="#000000" points="432.885,-491.809 437.897,-482.474 428.158,-486.646 432.885,-491.809"/>
</g>
<!-- proc~pnpa_f -->
<g id="proc~~get_fields~~CalledByGraph_node25" class="node"><title>proc~pnpa_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node25"><a xlink:href=".././proc/pnpa_f.html" xlink:title="pnpa_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-732.384 124,-732.384 124,-708.384 178,-708.384 178,-732.384"/>
<text text-anchor="middle" x="151" y="-717.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pnpa_f</text>
</a>
</g>
</g>
<!-- proc~pnpa_f&#45;&gt;proc~mc_fastion_pass_grid -->
<g id="proc~~get_fields~~CalledByGraph_edge27" class="edge"><title>proc~pnpa_f&#45;&gt;proc~mc_fastion_pass_grid</title>
<path fill="none" stroke="#000000" d="M178.065,-713.036C188.856,-709.545 201.319,-704.917 212,-699.384 238.15,-685.838 265.253,-665.766 283.597,-651.124"/>
<polygon fill="#000000" stroke="#000000" points="286.295,-653.442 291.857,-644.425 281.885,-648.006 286.295,-653.442"/>
</g>
<!-- proc~pnpa_f&#45;&gt;proc~store_npa -->
<g id="proc~~get_fields~~CalledByGraph_edge49" class="edge"><title>proc~pnpa_f&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M178.168,-724.152C189.881,-727.071 203.04,-732.24 212,-741.384 248.001,-778.127 212.196,-814.449 248,-851.384 253.176,-856.723 259.811,-860.711 266.733,-863.688"/>
<polygon fill="#000000" stroke="#000000" points="265.646,-867.017 276.24,-867.152 268.043,-860.44 265.646,-867.017"/>
</g>
<!-- proc~fida_f -->
<g id="proc~~get_fields~~CalledByGraph_node26" class="node"><title>proc~fida_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node26"><a xlink:href=".././proc/fida_f.html" xlink:title="fida_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-690.384 124,-690.384 124,-666.384 178,-666.384 178,-690.384"/>
<text text-anchor="middle" x="151" y="-675.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_f</text>
</a>
</g>
</g>
<!-- proc~fida_f&#45;&gt;proc~mc_fastion -->
<g id="proc~~get_fields~~CalledByGraph_edge25" class="edge"><title>proc~fida_f&#45;&gt;proc~mc_fastion</title>
<path fill="none" stroke="#000000" d="M178.074,-683.054C189.492,-686.151 202.436,-691.21 212,-699.384 237.697,-721.347 228.506,-738.767 248,-766.384 259.208,-782.262 273.934,-798.467 285.743,-810.598"/>
<polygon fill="#000000" stroke="#000000" points="283.49,-813.298 293.015,-817.937 288.463,-808.371 283.49,-813.298"/>
</g>
<!-- proc~fida_f&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge31" class="edge"><title>proc~fida_f&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.124,-684.151C203.345,-689.72 241.748,-698.198 269.888,-704.411"/>
<polygon fill="#000000" stroke="#000000" points="269.228,-707.85 279.748,-706.588 270.738,-701.014 269.228,-707.85"/>
</g>
<!-- proc~fida_f&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge68" class="edge"><title>proc~fida_f&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M178.179,-674.244C189.754,-671.249 202.797,-666.124 212,-657.384 242.642,-628.285 224.751,-604.671 248,-569.384 257.76,-554.571 271.601,-540.319 283.315,-529.534"/>
<polygon fill="#000000" stroke="#000000" points="285.885,-531.931 291.008,-522.658 281.22,-526.713 285.885,-531.931"/>
</g>
<!-- proc~store_fida_photons&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge53" class="edge"><title>proc~store_fida_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M350.605,-498.383C366.3,-493.961 384.212,-488.916 400.467,-484.337"/>
<polygon fill="#000000" stroke="#000000" points="401.663,-487.636 410.339,-481.556 399.764,-480.899 401.663,-487.636"/>
</g>
<!-- proc~halo_spec -->
<g id="proc~~get_fields~~CalledByGraph_node28" class="node"><title>proc~halo_spec</title>
<g id="a_proc~~get_fields~~CalledByGraph_node28"><a xlink:href=".././proc/halo_spec.html" xlink:title="halo_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="337.5,-400.384 276.5,-400.384 276.5,-376.384 337.5,-376.384 337.5,-400.384"/>
<text text-anchor="middle" x="307" y="-385.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">halo_spec</text>
</a>
</g>
</g>
<!-- proc~halo_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge57" class="edge"><title>proc~halo_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M337.6,-397.302C346.925,-400.582 357.107,-404.666 366,-409.384 388.506,-421.323 411.77,-438.676 428.092,-451.824"/>
<polygon fill="#000000" stroke="#000000" points="426,-454.635 435.953,-458.266 430.436,-449.221 426,-454.635"/>
</g>
<!-- proc~dcx_spec -->
<g id="proc~~get_fields~~CalledByGraph_node29" class="node"><title>proc~dcx_spec</title>
<g id="a_proc~~get_fields~~CalledByGraph_node29"><a xlink:href=".././proc/dcx_spec.html" xlink:title="dcx_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="336,-358.384 278,-358.384 278,-334.384 336,-334.384 336,-358.384"/>
<text text-anchor="middle" x="307" y="-343.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dcx_spec</text>
</a>
</g>
</g>
<!-- proc~dcx_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge54" class="edge"><title>proc~dcx_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M336.042,-353.178C346.074,-356.446 357.091,-361.064 366,-367.384 370.282,-370.422 410.946,-421.217 434.087,-450.317"/>
<polygon fill="#000000" stroke="#000000" points="431.415,-452.58 440.375,-458.233 436.896,-448.226 431.415,-452.58"/>
</g>
<!-- proc~dcx -->
<g id="proc~~get_fields~~CalledByGraph_node30" class="node"><title>proc~dcx</title>
<g id="a_proc~~get_fields~~CalledByGraph_node30"><a xlink:href=".././proc/dcx.html" xlink:title="dcx">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-522.384 124,-522.384 124,-498.384 178,-498.384 178,-522.384"/>
<text text-anchor="middle" x="151" y="-507.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dcx</text>
</a>
</g>
</g>
<!-- proc~dcx&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge34" class="edge"><title>proc~dcx&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.289,-514.035C190.029,-516.928 203.175,-522.109 212,-531.384 250.969,-572.341 219.328,-604.661 248,-653.384 256.937,-668.572 270.63,-682.753 282.467,-693.404"/>
<polygon fill="#000000" stroke="#000000" points="280.436,-696.276 290.284,-700.183 285.022,-690.988 280.436,-696.276"/>
</g>
<!-- proc~dcx&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge55" class="edge"><title>proc~dcx&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M178.323,-503.72C197.523,-499.082 224.231,-493.087 248,-489.384 299.657,-481.335 359.315,-476.233 400.333,-473.366"/>
<polygon fill="#000000" stroke="#000000" points="400.604,-476.855 410.343,-472.684 400.128,-469.871 400.604,-476.855"/>
</g>
<!-- proc~cold_spec -->
<g id="proc~~get_fields~~CalledByGraph_node31" class="node"><title>proc~cold_spec</title>
<g id="a_proc~~get_fields~~CalledByGraph_node31"><a xlink:href=".././proc/cold_spec.html" xlink:title="cold_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="337.5,-316.384 276.5,-316.384 276.5,-292.384 337.5,-292.384 337.5,-316.384"/>
<text text-anchor="middle" x="307" y="-301.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cold_spec</text>
</a>
</g>
</g>
<!-- proc~cold_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge56" class="edge"><title>proc~cold_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M337.689,-310.084C347.659,-313.22 358.213,-318.032 366,-325.384 395.535,-353.267 381.264,-374.458 402,-409.384 410.636,-423.93 422.344,-438.878 432.035,-450.336"/>
<polygon fill="#000000" stroke="#000000" points="429.476,-452.728 438.662,-458.007 434.773,-448.151 429.476,-452.728"/>
</g>
<!-- proc~pfida_f -->
<g id="proc~~get_fields~~CalledByGraph_node32" class="node"><title>proc~pfida_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node32"><a xlink:href=".././proc/pfida_f.html" xlink:title="pfida_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-480.384 124,-480.384 124,-456.384 178,-456.384 178,-480.384"/>
<text text-anchor="middle" x="151" y="-465.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pfida_f</text>
</a>
</g>
</g>
<!-- proc~pfida_f&#45;&gt;proc~mc_fastion_pass_grid -->
<g id="proc~~get_fields~~CalledByGraph_edge26" class="edge"><title>proc~pfida_f&#45;&gt;proc~mc_fastion_pass_grid</title>
<path fill="none" stroke="#000000" d="M178.289,-472.035C190.029,-474.928 203.175,-480.109 212,-489.384 250.969,-530.341 209.251,-570.219 248,-611.384 249.032,-612.48 250.126,-613.52 251.272,-614.505"/>
<polygon fill="#000000" stroke="#000000" points="249.28,-617.383 259.478,-620.254 253.296,-611.65 249.28,-617.383"/>
</g>
<!-- proc~pfida_f&#45;&gt;proc~track_cylindrical -->
<g id="proc~~get_fields~~CalledByGraph_edge42" class="edge"><title>proc~pfida_f&#45;&gt;proc~track_cylindrical</title>
<path fill="none" stroke="#000000" d="M157.849,-456.23C180.956,-408.215 266.071,-231.352 295.728,-169.728"/>
<polygon fill="#000000" stroke="#000000" points="298.963,-171.078 300.145,-160.55 292.655,-168.043 298.963,-171.078"/>
</g>
<!-- proc~pfida_f&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge67" class="edge"><title>proc~pfida_f&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M178.124,-475.509C198.351,-481.025 227.057,-488.854 252.147,-495.697"/>
<polygon fill="#000000" stroke="#000000" points="251.351,-499.107 261.92,-498.362 253.193,-492.354 251.351,-499.107"/>
</g>
<!-- program~fidasim -->
<g id="proc~~get_fields~~CalledByGraph_node33" class="node"><title>program~fidasim</title>
<g id="a_proc~~get_fields~~CalledByGraph_node33"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-501.384 0,-501.384 0,-477.384 54,-477.384 54,-501.384"/>
<text text-anchor="middle" x="27" y="-486.984" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge20" class="edge"><title>program~fidasim&#45;&gt;proc~npa_mc</title>
<path fill="none" stroke="#000000" d="M28.0365,-501.748C28.4699,-566.528 33.5388,-866.431 90,-935.384 96.1103,-942.846 105.041,-947.661 114.154,-950.766"/>
<polygon fill="#000000" stroke="#000000" points="113.417,-954.194 123.99,-953.509 115.298,-947.451 113.417,-954.194"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_weights_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge22" class="edge"><title>program~fidasim&#45;&gt;proc~fida_weights_mc</title>
<path fill="none" stroke="#000000" d="M28.2345,-501.779C29.6308,-562.882 38.6484,-831.569 90,-893.384 91.8843,-895.652 94.0288,-897.676 96.3587,-899.481"/>
<polygon fill="#000000" stroke="#000000" points="94.552,-902.479 104.886,-904.815 98.2645,-896.544 94.552,-902.479"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_weights_los -->
<g id="proc~~get_fields~~CalledByGraph_edge23" class="edge"><title>program~fidasim&#45;&gt;proc~fida_weights_los</title>
<path fill="none" stroke="#000000" d="M29.4703,-501.677C35.1348,-547.133 56.8944,-704.958 90,-741.384 91.9833,-743.566 94.2061,-745.521 96.5969,-747.274"/>
<polygon fill="#000000" stroke="#000000" points="94.8942,-750.334 105.269,-752.483 98.4986,-744.333 94.8942,-750.334"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge36" class="edge"><title>program~fidasim&#45;&gt;proc~fida_mc</title>
<path fill="none" stroke="#000000" d="M30.7272,-501.681C36.8925,-526.67 54.2364,-583.693 90,-615.384 96.8415,-621.446 105.537,-625.784 114.17,-628.879"/>
<polygon fill="#000000" stroke="#000000" points="113.201,-632.243 123.789,-631.87 115.28,-625.558 113.201,-632.243"/>
</g>
<!-- program~fidasim&#45;&gt;proc~ndmc -->
<g id="proc~~get_fields~~CalledByGraph_edge37" class="edge"><title>program~fidasim&#45;&gt;proc~ndmc</title>
<path fill="none" stroke="#000000" d="M33.8933,-501.472C43.3186,-519.602 63.4579,-553.794 90,-573.384 97.1481,-578.66 105.734,-582.694 114.146,-585.746"/>
<polygon fill="#000000" stroke="#000000" points="113.252,-589.136 123.844,-588.893 115.413,-582.477 113.252,-589.136"/>
</g>
<!-- program~fidasim&#45;&gt;proc~pnpa_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge38" class="edge"><title>program~fidasim&#45;&gt;proc~pnpa_mc</title>
<path fill="none" stroke="#000000" d="M28.4699,-501.613C30.8898,-558.481 43.6859,-796.606 90,-851.384 95.8502,-858.303 104.119,-862.944 112.654,-866.057"/>
<polygon fill="#000000" stroke="#000000" points="111.703,-869.426 122.288,-868.961 113.724,-862.724 111.703,-869.426"/>
</g>
<!-- program~fidasim&#45;&gt;proc~cfpd_f -->
<g id="proc~~get_fields~~CalledByGraph_edge39" class="edge"><title>program~fidasim&#45;&gt;proc~cfpd_f</title>
<path fill="none" stroke="#000000" d="M27.7153,-476.962C27.6627,-442.12 32.7728,-343.041 90,-297.384 186.012,-220.783 255.298,-230.178 366,-283.384 366,-283.384 409.697,-338.005 434.058,-368.457"/>
<polygon fill="#000000" stroke="#000000" points="431.384,-370.717 440.364,-376.339 436.85,-366.344 431.384,-370.717"/>
</g>
<!-- program~fidasim&#45;&gt;proc~neutron_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge40" class="edge"><title>program~fidasim&#45;&gt;proc~neutron_mc</title>
<path fill="none" stroke="#000000" d="M29.1024,-477.166C33.5165,-431.292 51.5645,-270.423 90,-240.384 138.325,-202.616 308.109,-220.124 366,-240.384 392.782,-249.757 417.393,-271.645 432.958,-287.868"/>
<polygon fill="#000000" stroke="#000000" points="430.478,-290.341 439.842,-295.296 435.613,-285.583 430.478,-290.341"/>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_weights -->
<g id="proc~~get_fields~~CalledByGraph_edge44" class="edge"><title>program~fidasim&#45;&gt;proc~npa_weights</title>
<path fill="none" stroke="#000000" d="M28.2575,-477.239C29.7345,-419.695 38.9725,-175.116 90,-123.384 173.046,-39.1911 327.132,-49.7881 403.96,-61.5661"/>
<polygon fill="#000000" stroke="#000000" points="403.844,-65.0923 414.273,-63.2262 404.956,-58.1813 403.844,-65.0923"/>
</g>
<!-- program~fidasim&#45;&gt;proc~pfida_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge45" class="edge"><title>program~fidasim&#45;&gt;proc~pfida_mc</title>
<path fill="none" stroke="#000000" d="M28.7463,-477.031C32.203,-423.704 48.2987,-213.744 90,-165.384 96.0219,-158.4 104.505,-153.738 113.2,-150.627"/>
<polygon fill="#000000" stroke="#000000" points="114.392,-153.924 122.988,-147.731 112.406,-147.211 114.392,-153.924"/>
</g>
<!-- program~fidasim&#45;&gt;proc~make_diagnostic_grids -->
<g id="proc~~get_fields~~CalledByGraph_edge58" class="edge"><title>program~fidasim&#45;&gt;proc~make_diagnostic_grids</title>
<path fill="none" stroke="#000000" d="M29.2484,-477.296C34.3993,-429.498 55.3724,-254.251 90,-212.384 92.7269,-209.087 95.9512,-206.197 99.4675,-203.666"/>
<polygon fill="#000000" stroke="#000000" points="101.396,-206.589 108.105,-198.389 97.747,-200.616 101.396,-206.589"/>
</g>
<!-- program~fidasim&#45;&gt;proc~neutron_f -->
<g id="proc~~get_fields~~CalledByGraph_edge59" class="edge"><title>program~fidasim&#45;&gt;proc~neutron_f</title>
<path fill="none" stroke="#000000" d="M27.8115,-477.164C27.0984,-413.185 27.2689,-117.476 90,-58.3839 178.292,24.786 338.649,-0.588163 411.79,-17.9697"/>
<polygon fill="#000000" stroke="#000000" points="410.97,-21.3721 421.516,-20.3572 412.638,-14.5739 410.97,-21.3721"/>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_f -->
<g id="proc~~get_fields~~CalledByGraph_edge60" class="edge"><title>program~fidasim&#45;&gt;proc~npa_f</title>
<path fill="none" stroke="#000000" d="M27.7049,-501.669C27.2453,-544.194 30.4286,-687.745 90,-783.384 97.2314,-794.994 108.405,-804.89 119.159,-812.565"/>
<polygon fill="#000000" stroke="#000000" points="117.355,-815.57 127.609,-818.234 121.255,-809.756 117.355,-815.57"/>
</g>
<!-- program~fidasim&#45;&gt;proc~nbi_spec -->
<g id="proc~~get_fields~~CalledByGraph_edge62" class="edge"><title>program~fidasim&#45;&gt;proc~nbi_spec</title>
<path fill="none" stroke="#000000" d="M41.6201,-477.061C53.4724,-467.143 71.5951,-453.832 90,-447.384 150.017,-426.358 224.966,-425.688 268.951,-427.659"/>
<polygon fill="#000000" stroke="#000000" points="269.005,-431.167 279.173,-428.19 269.368,-424.176 269.005,-431.167"/>
</g>
<!-- program~fidasim&#45;&gt;proc~halo -->
<g id="proc~~get_fields~~CalledByGraph_edge63" class="edge"><title>program~fidasim&#45;&gt;proc~halo</title>
<path fill="none" stroke="#000000" d="M43.6139,-501.636C55.7484,-510.734 73.2749,-522.971 90,-531.384 97.6402,-535.227 106.153,-538.667 114.309,-541.597"/>
<polygon fill="#000000" stroke="#000000" points="113.405,-544.987 124,-544.91 115.67,-538.363 113.405,-544.987"/>
</g>
<!-- program~fidasim&#45;&gt;proc~pnpa_f -->
<g id="proc~~get_fields~~CalledByGraph_edge64" class="edge"><title>program~fidasim&#45;&gt;proc~pnpa_f</title>
<path fill="none" stroke="#000000" d="M27.9518,-501.434C28.4721,-536.793 34.8378,-641.416 90,-699.384 96.4121,-706.122 105.105,-710.7 113.883,-713.809"/>
<polygon fill="#000000" stroke="#000000" points="113.129,-717.236 123.712,-716.732 115.125,-710.527 113.129,-717.236"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_f -->
<g id="proc~~get_fields~~CalledByGraph_edge65" class="edge"><title>program~fidasim&#45;&gt;proc~fida_f</title>
<path fill="none" stroke="#000000" d="M28.9907,-501.41C32.1355,-531.85 44.5552,-612.699 90,-657.384 96.6324,-663.905 105.401,-668.409 114.18,-671.516"/>
<polygon fill="#000000" stroke="#000000" points="113.399,-674.936 123.984,-674.465 115.416,-668.233 113.399,-674.936"/>
</g>
<!-- program~fidasim&#45;&gt;proc~halo_spec -->
<g id="proc~~get_fields~~CalledByGraph_edge70" class="edge"><title>program~fidasim&#45;&gt;proc~halo_spec</title>
<path fill="none" stroke="#000000" d="M35.574,-477.36C45.8842,-462.101 65.8465,-436.225 90,-423.384 146.015,-393.604 220.862,-387.783 266.137,-387.335"/>
<polygon fill="#000000" stroke="#000000" points="266.162,-390.835 276.156,-387.319 266.151,-383.835 266.162,-390.835"/>
</g>
<!-- program~fidasim&#45;&gt;proc~dcx_spec -->
<g id="proc~~get_fields~~CalledByGraph_edge71" class="edge"><title>program~fidasim&#45;&gt;proc~dcx_spec</title>
<path fill="none" stroke="#000000" d="M31.6244,-477.227C38.8486,-455.251 57.2345,-409.091 90,-386.384 143.363,-349.402 221.273,-343.917 267.485,-344.392"/>
<polygon fill="#000000" stroke="#000000" points="267.611,-347.895 277.68,-344.6 267.754,-340.897 267.611,-347.895"/>
</g>
<!-- program~fidasim&#45;&gt;proc~dcx -->
<g id="proc~~get_fields~~CalledByGraph_edge72" class="edge"><title>program~fidasim&#45;&gt;proc~dcx</title>
<path fill="none" stroke="#000000" d="M54.1721,-493.889C71.6205,-496.892 94.7864,-500.88 113.97,-504.182"/>
<polygon fill="#000000" stroke="#000000" points="113.422,-507.639 123.871,-505.886 114.61,-500.741 113.422,-507.639"/>
</g>
<!-- program~fidasim&#45;&gt;proc~cold_spec -->
<g id="proc~~get_fields~~CalledByGraph_edge73" class="edge"><title>program~fidasim&#45;&gt;proc~cold_spec</title>
<path fill="none" stroke="#000000" d="M29.2718,-477.176C32.9391,-448.62 46.2465,-377.255 90,-342.384 140.52,-302.12 218.954,-298.535 266.11,-300.697"/>
<polygon fill="#000000" stroke="#000000" points="266.064,-304.2 276.247,-301.272 266.461,-297.211 266.064,-304.2"/>
</g>
<!-- program~fidasim&#45;&gt;proc~pfida_f -->
<g id="proc~~get_fields~~CalledByGraph_edge74" class="edge"><title>program~fidasim&#45;&gt;proc~pfida_f</title>
<path fill="none" stroke="#000000" d="M54.1721,-484.879C71.6205,-481.875 94.7864,-477.888 113.97,-474.586"/>
<polygon fill="#000000" stroke="#000000" points="114.61,-478.027 123.871,-472.881 113.422,-471.129 114.61,-478.027"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/get_fields.html#src">get_fields</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">get_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="n">ind</span><span class="p">,</span><span class="w"> </span><span class="n">input_coords</span><span class="p">,</span><span class="w"> </span><span class="n">output_coords</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="c">!+ Gets electro-magnetic fields at position `pos` or [[libfida:beam_grid]] indices `ind`</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w">                    </span><span class="kd">::</span><span class="w"> </span><span class="n">fields</span><span class="w"></span>
<span class="w">        </span><span class="c">!+ Electro-magnetic fields at `pos`/`ind`</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">pos</span><span class="w"></span>
<span class="w">        </span><span class="c">!+ Position in beam grid coordinates</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ind</span><span class="w"></span>
<span class="w">        </span><span class="c">!+ [[libfida:beam_grid]] indices</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">input_coords</span><span class="w"></span>
<span class="w">        </span><span class="c">!+ Indicates coordinate system of inputs. Beam grid (0), machine (1) and cylindrical (2)</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">output_coords</span><span class="w"></span>
<span class="w">        </span><span class="c">!+ Indicates coordinate system of outputs. Beam grid (0), machine (1) and cylindrical (2)</span>

<span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">inp</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xyz</span><span class="p">,</span><span class="w"> </span><span class="n">uvw</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">uvw_bfield</span><span class="p">,</span><span class="w"> </span><span class="n">uvw_efield</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xyz_bfield</span><span class="p">,</span><span class="w"> </span><span class="n">xyz_efield</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">phi</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">InterpolCoeffs3D</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">coeffs</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">k2</span><span class="p">,</span><span class="w"> </span><span class="n">mc</span><span class="p">,</span><span class="w"> </span><span class="n">ocs</span><span class="p">,</span><span class="w"> </span><span class="n">ics</span><span class="w"></span>

<span class="w">    </span><span class="n">fields</span><span class="p">%</span><span class="n">in_plasma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">False</span><span class="p">.</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">input_coords</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">ics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input_coords</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span>
<span class="k">        </span><span class="n">ics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">    if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">output_coords</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">ocs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">output_coords</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span>
<span class="k">        </span><span class="n">ocs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">    if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">ind</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">get_position</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">xyz</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">        if</span><span class="p">(</span><span class="n">ics</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">xyz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">xyz_to_uvw</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span><span class="w"> </span><span class="n">uvw</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">        if</span><span class="p">(</span><span class="n">ics</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">uvw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">uvw_to_xyz</span><span class="p">(</span><span class="n">uvw</span><span class="p">,</span><span class="w"> </span><span class="n">xyz</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">    endif</span>

<span class="k">    call </span><span class="n">in_plasma</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span><span class="n">inp</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">coeffs</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">i</span><span class="w"></span>
<span class="w">        </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">j</span><span class="w"></span>
<span class="w">        </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">k</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">inter_grid</span><span class="p">%</span><span class="n">nphi</span><span class="w"> </span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">k2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">inter_grid</span><span class="p">%</span><span class="n">nphi</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">else</span>
<span class="k">            </span><span class="n">k2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>

<span class="k">        </span><span class="n">fields</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b111</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b121</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                 </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b112</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k2</span><span class="p">)</span><span class="w">   </span><span class="o">+</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b122</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                 </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b211</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b221</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                 </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b212</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b222</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k2</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">atan2</span><span class="p">(</span><span class="n">uvw</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">uvw</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">        </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="c">!Convert cylindrical coordinates to uvw</span>
<span class="w">        </span><span class="n">uvw_bfield</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">br</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">bt</span><span class="w"></span>
<span class="w">        </span><span class="n">uvw_bfield</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">br</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">bt</span><span class="w"></span>
<span class="w">        </span><span class="n">uvw_bfield</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fields</span><span class="p">%</span><span class="n">bz</span><span class="w"></span>
<span class="w">        </span><span class="n">uvw_efield</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">er</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">et</span><span class="w"></span>
<span class="w">        </span><span class="n">uvw_efield</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">er</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">et</span><span class="w"></span>
<span class="w">        </span><span class="n">uvw_efield</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fields</span><span class="p">%</span><span class="n">ez</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">ocs</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">            </span><span class="c">!Represent fields in beam grid coordinates</span>
<span class="w">            </span><span class="n">xyz_bfield</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">matmul</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">inv_basis</span><span class="p">,</span><span class="n">uvw_bfield</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">xyz_efield</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">matmul</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">inv_basis</span><span class="p">,</span><span class="n">uvw_efield</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">fields</span><span class="p">%</span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xyz</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">        if</span><span class="p">(</span><span class="n">ocs</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">xyz_bfield</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uvw_bfield</span><span class="w"></span>
<span class="w">            </span><span class="n">xyz_efield</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uvw_efield</span><span class="w"></span>
<span class="w">            </span><span class="n">fields</span><span class="p">%</span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uvw</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span><span class="w"></span>

<span class="w">        </span><span class="c">!Calculate field directions and magnitudes</span>
<span class="w">        </span><span class="n">fields</span><span class="p">%</span><span class="n">b_abs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">norm2</span><span class="p">(</span><span class="n">xyz_bfield</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">fields</span><span class="p">%</span><span class="n">e_abs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">norm2</span><span class="p">(</span><span class="n">xyz_efield</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">fields</span><span class="p">%</span><span class="n">b_abs</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">)</span><span class="w"> </span><span class="n">fields</span><span class="p">%</span><span class="n">b_norm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xyz_bfield</span><span class="o">/</span><span class="n">fields</span><span class="p">%</span><span class="n">b_abs</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">fields</span><span class="p">%</span><span class="n">e_abs</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">)</span><span class="w"> </span><span class="n">fields</span><span class="p">%</span><span class="n">e_norm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xyz_efield</span><span class="o">/</span><span class="n">fields</span><span class="p">%</span><span class="n">e_abs</span><span class="w"></span>

<span class="w">        </span><span class="k">call </span><span class="n">calc_perp_vectors</span><span class="p">(</span><span class="n">fields</span><span class="p">%</span><span class="n">b_norm</span><span class="p">,</span><span class="n">fields</span><span class="p">%</span><span class="n">a_norm</span><span class="p">,</span><span class="n">fields</span><span class="p">%</span><span class="n">c_norm</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">fields</span><span class="p">%</span><span class="n">uvw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uvw</span><span class="w"></span>
<span class="w">        </span><span class="n">fields</span><span class="p">%</span><span class="n">in_plasma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">True</span><span class="p">.</span><span class="w"></span>
<span class="w">        </span><span class="n">fields</span><span class="p">%</span><span class="n">coords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ocs</span><span class="w"></span>
<span class="w">        </span><span class="n">fields</span><span class="p">%</span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coeffs</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">end subroutine </span><span class="n">get_fields</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>