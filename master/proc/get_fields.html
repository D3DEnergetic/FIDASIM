<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="">
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>get_fields &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>User Guide</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>get_fields
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.5% of total for procedures.">76 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
     <li><a href='../module/libfida.html'>libfida</a></li>
     <li class="active">get_fields</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/get_fields.html#src">get_fields</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public subroutine get_fields(fields, pos, ind, input_coords, output_coords)</h2>
    

    <p>Gets electro-magnetic fields at position <code>pos</code> or <a href="../module/libfida.html#variable-beam_grid">beam_grid</a> indices <code>ind</code></p>

    <h3>Arguments</h3>
      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-fields%7E4"></span>type(<a href='../type/localemfields.html'>LocalEMFields</a>),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>fields</strong></td><td><p>Electro-magnetic fields at <code>pos</code>/<code>ind</code></p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-pos%7E9"></span>real(kind=Float64),</td>
<td>intent(in),</td>
  <td>optional</td>  <td>dimension(3)</td><td>::</td>
  <td><strong>pos</strong></td><td><p>Position in beam grid coordinates</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ind%7E8"></span>integer(kind=Int32),</td>
<td>intent(in),</td>
  <td>optional</td>  <td>dimension(3)</td><td>::</td>
  <td><strong>ind</strong></td><td><p><a href="../module/libfida.html#variable-beam_grid">beam_grid</a> indices</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-input_coords%7E6"></span>integer(kind=Int32),</td>
<td>intent(in),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>input_coords</strong></td><td><p>Indicates coordinate system of inputs. Beam grid (0), machine (1) and cylindrical (2)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-output_coords%7E2"></span>integer(kind=Int32),</td>
<td>intent(in),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>output_coords</strong></td><td><p>Indicates coordinate system of outputs. Beam grid (0), machine (1) and cylindrical (2)</p></td>
</tr>
</tbody>
</table>

    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~get_fields~~CallsGraph Pages: 1 -->
<svg id="procget_fieldsCallsGraph" width="420pt" height="184pt"
 viewBox="0.00 0.00 420.00 183.69" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~get_fields~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 179.692)">
<title>proc~~get_fields~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-179.692 416,-179.692 416,4 -4,4"/>
<!-- proc~get_fields -->
<g id="proc~~get_fields~~CallsGraph_node1" class="node"><title>proc~get_fields</title>
<polygon fill="none" stroke="black" points="58,-93.6921 3.55271e-15,-93.6921 3.55271e-15,-69.6921 58,-69.6921 58,-93.6921"/>
<text text-anchor="middle" x="29" y="-79.2921" font-family="Helvetica,sans-Serif" font-size="10.50">get_fields</text>
</g>
<!-- proc~in_plasma -->
<g id="proc~~get_fields~~CallsGraph_node2" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~get_fields~~CallsGraph_node2"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="174.5,-175.692 113.5,-175.692 113.5,-151.692 174.5,-151.692 174.5,-175.692"/>
<text text-anchor="middle" x="144" y="-161.292" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~get_fields~~CallsGraph_edge1" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M40.2822,-93.8066C52.1349,-107.178 72.7307,-128.661 94,-142.692 97.1603,-144.777 100.562,-146.732 104.047,-148.545"/>
<polygon fill="#000000" stroke="#000000" points="102.827,-151.841 113.357,-153.005 105.851,-145.528 102.827,-151.841"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~get_fields~~CallsGraph_node3" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~get_fields~~CallsGraph_node3"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="194,-133.692 94,-133.692 94,-109.692 194,-109.692 194,-133.692"/>
<text text-anchor="middle" x="144" y="-119.292" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~get_fields~~CallsGraph_edge2" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M58.2232,-91.6826C70.5323,-96.0398 85.2539,-101.251 98.9487,-106.099"/>
<polygon fill="#000000" stroke="#000000" points="98.0953,-109.509 108.69,-109.547 100.431,-102.911 98.0953,-109.509"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_node4" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~get_fields~~CallsGraph_node4"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-95.6921 235,-95.6921 235,-71.6921 303,-71.6921 303,-95.6921"/>
<text text-anchor="middle" x="269" y="-81.2921" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_edge3" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M58.2363,-81.9294C99.419,-82.2755 176.308,-82.9216 224.681,-83.3281"/>
<polygon fill="#000000" stroke="#000000" points="224.813,-86.8292 234.843,-83.4135 224.872,-79.8295 224.813,-86.8292"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~get_fields~~CallsGraph_node5" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~get_fields~~CallsGraph_node5"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="412,-33.6921 344,-33.6921 344,-9.69211 412,-9.69211 412,-33.6921"/>
<text text-anchor="middle" x="378" y="-19.2921" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~get_fields~~CallsGraph_edge4" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M38.2329,-69.4678C49.024,-54.6663 69.4889,-30.5021 94,-20.6921 173.657,11.1888 276.326,-0.890877 333.545,-11.7907"/>
<polygon fill="#000000" stroke="#000000" points="333.195,-15.2893 343.685,-13.8014 334.557,-8.42299 333.195,-15.2893"/>
</g>
<!-- proc~get_position -->
<g id="proc~~get_fields~~CallsGraph_node6" class="node"><title>proc~get_position</title>
<g id="a_proc~~get_fields~~CallsGraph_node6"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="179,-53.6921 109,-53.6921 109,-29.6921 179,-29.6921 179,-53.6921"/>
<text text-anchor="middle" x="144" y="-39.2921" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~get_fields~~CallsGraph_edge5" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M58.2232,-71.7016C70.5323,-67.3444 85.2539,-62.1332 98.9487,-57.2855"/>
<polygon fill="#000000" stroke="#000000" points="100.431,-60.4736 108.69,-53.8372 98.0953,-53.8748 100.431,-60.4736"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_edge6" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M174.587,-152.919C181.195,-149.999 188.013,-146.558 194,-142.692 212.233,-130.917 213.001,-123.188 230,-109.692 233.381,-107.008 237.026,-104.3 240.674,-101.696"/>
<polygon fill="#000000" stroke="#000000" points="242.845,-104.45 249.067,-95.8741 238.855,-98.6983 242.845,-104.45"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_node7" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~get_fields~~CallsGraph_node7"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="410.5,-105.692 345.5,-105.692 345.5,-81.6921 410.5,-81.6921 410.5,-105.692"/>
<text text-anchor="middle" x="378" y="-91.2921" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_edge7" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M174.855,-154.684C215.787,-142.334 289.502,-120.092 335.703,-106.152"/>
<polygon fill="#000000" stroke="#000000" points="336.842,-109.465 345.405,-103.225 334.82,-102.763 336.842,-109.465"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~get_fields~~CallsGraph_node9" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~get_fields~~CallsGraph_node9"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="307.5,-175.692 230.5,-175.692 230.5,-151.692 307.5,-151.692 307.5,-175.692"/>
<text text-anchor="middle" x="269" y="-161.292" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~get_fields~~CallsGraph_edge8" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M174.775,-163.692C188.292,-163.692 204.626,-163.692 219.82,-163.692"/>
<polygon fill="#000000" stroke="#000000" points="220.108,-167.192 230.108,-163.692 220.108,-160.192 220.108,-167.192"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~get_fields~~CallsGraph_node8" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~get_fields~~CallsGraph_node8"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="300,-53.6921 238,-53.6921 238,-29.6921 300,-29.6921 300,-53.6921"/>
<text text-anchor="middle" x="269" y="-39.2921" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~get_fields~~CallsGraph_edge9" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M179.262,-41.6921C194.163,-41.6921 211.737,-41.6921 227.298,-41.6921"/>
<polygon fill="#000000" stroke="#000000" points="227.692,-45.1922 237.692,-41.6921 227.692,-38.1922 227.692,-45.1922"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~get_fields~~CallsGraph_edge11" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M300.09,-36.0678C310.502,-34.1217 322.387,-31.9002 333.649,-29.7951"/>
<polygon fill="#000000" stroke="#000000" points="334.57,-33.1837 343.756,-27.9059 333.283,-26.3029 334.57,-33.1837"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_edge10" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M294.817,-53.7527C309.03,-60.6598 327.077,-69.4304 342.637,-76.9922"/>
<polygon fill="#000000" stroke="#000000" points="341.423,-80.2937 351.947,-81.5168 344.483,-73.9978 341.423,-80.2937"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~get_fields~~CalledByGraph Pages: 1 -->
<svg id="procget_fieldsCalledByGraph" width="602pt" height="1021pt"
 viewBox="0.00 0.00 602.00 1021.12" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~get_fields~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 1017.12)">
<title>proc~~get_fields~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1017.12 598,-1017.12 598,4 -4,4"/>
<!-- proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_node1" class="node"><title>proc~get_fields</title>
<polygon fill="none" stroke="black" points="594,-385.428 536,-385.428 536,-361.428 594,-361.428 594,-385.428"/>
<text text-anchor="middle" x="565" y="-371.028" font-family="Helvetica,sans-Serif" font-size="10.50">get_fields</text>
</g>
<!-- proc~cfpd_f -->
<g id="proc~~get_fields~~CalledByGraph_node2" class="node"><title>proc~cfpd_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node2"><a xlink:href=".././proc/cfpd_f.html" xlink:title="cfpd_f">
<polygon fill="#d9534f" stroke="#d9534f" points="478,-985.428 424,-985.428 424,-961.428 478,-961.428 478,-985.428"/>
<text text-anchor="middle" x="451" y="-971.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cfpd_f</text>
</a>
</g>
</g>
<!-- proc~cfpd_f&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge1" class="edge"><title>proc~cfpd_f&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M465.008,-961.226C476.305,-949.783 492.063,-931.603 500,-912.428 539.745,-816.405 558.512,-485.729 562.945,-396.029"/>
<polygon fill="#000000" stroke="#000000" points="566.449,-396.037 563.436,-385.88 559.457,-395.699 566.449,-396.037"/>
</g>
<!-- proc~npa_weights -->
<g id="proc~~get_fields~~CalledByGraph_node3" class="node"><title>proc~npa_weights</title>
<g id="a_proc~~get_fields~~CalledByGraph_node3"><a xlink:href=".././proc/npa_weights.html" xlink:title="npa_weights">
<polygon fill="#d9534f" stroke="#d9534f" points="487.5,-903.428 414.5,-903.428 414.5,-879.428 487.5,-879.428 487.5,-903.428"/>
<text text-anchor="middle" x="451" y="-889.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_weights</text>
</a>
</g>
</g>
<!-- proc~npa_weights&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge2" class="edge"><title>proc~npa_weights&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M459.289,-879.151C469.96,-860.6 489.684,-824.02 500,-790.428 544.931,-644.127 559.153,-458.839 562.862,-395.679"/>
<polygon fill="#000000" stroke="#000000" points="566.359,-395.837 563.421,-385.658 559.37,-395.447 566.359,-395.837"/>
</g>
<!-- proc~mc_fastion -->
<g id="proc~~get_fields~~CalledByGraph_node4" class="node"><title>proc~mc_fastion</title>
<g id="a_proc~~get_fields~~CalledByGraph_node4"><a xlink:href=".././proc/mc_fastion.html" xlink:title="mc_fastion">
<polygon fill="#d9534f" stroke="#d9534f" points="339,-383.428 275,-383.428 275,-359.428 339,-359.428 339,-383.428"/>
<text text-anchor="middle" x="307" y="-369.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_fastion</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge4" class="edge"><title>proc~mc_fastion&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M339.135,-371.672C386.034,-372.038 474.716,-372.731 525.572,-373.128"/>
<polygon fill="#000000" stroke="#000000" points="525.795,-376.63 535.822,-373.208 525.85,-369.63 525.795,-376.63"/>
</g>
<!-- proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_node5" class="node"><title>proc~store_photons</title>
<g id="a_proc~~get_fields~~CalledByGraph_node5"><a xlink:href=".././proc/store_photons.html" xlink:title="store_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="491.5,-781.428 410.5,-781.428 410.5,-757.428 491.5,-757.428 491.5,-781.428"/>
<text text-anchor="middle" x="451" y="-767.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_photons</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge3" class="edge"><title>proc~store_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M458.656,-757.296C468.863,-738.246 488.411,-699.925 500,-665.428 532.957,-567.322 553.404,-444.874 560.833,-395.539"/>
<polygon fill="#000000" stroke="#000000" points="564.296,-396.046 562.294,-385.642 557.371,-395.023 564.296,-396.046"/>
</g>
<!-- proc~track_cylindrical -->
<g id="proc~~get_fields~~CalledByGraph_node6" class="node"><title>proc~track_cylindrical</title>
<g id="a_proc~~get_fields~~CalledByGraph_node6"><a xlink:href=".././proc/track_cylindrical.html" xlink:title="track_cylindrical">
<polygon fill="#d9534f" stroke="#d9534f" points="351,-463.428 263,-463.428 263,-439.428 351,-439.428 351,-463.428"/>
<text text-anchor="middle" x="307" y="-449.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track_cylindrical</text>
</a>
</g>
</g>
<!-- proc~track_cylindrical&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge5" class="edge"><title>proc~track_cylindrical&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M351.344,-452.159C391.469,-451.334 451.997,-446.204 500,-425.428 517.46,-417.872 534.039,-404.148 545.947,-392.696"/>
<polygon fill="#000000" stroke="#000000" points="548.461,-395.132 553.059,-385.587 543.512,-390.181 548.461,-395.132"/>
</g>
<!-- proc~fida_mc -->
<g id="proc~~get_fields~~CalledByGraph_node7" class="node"><title>proc~fida_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node7"><a xlink:href=".././proc/fida_mc.html" xlink:title="fida_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-585.428 124,-585.428 124,-561.428 178,-561.428 178,-585.428"/>
<text text-anchor="middle" x="151" y="-571.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_mc</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge6" class="edge"><title>proc~fida_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M178.412,-581.144C243.471,-598.354 412.503,-631.838 500,-544.428 541.662,-502.807 556.561,-431.538 561.6,-395.573"/>
<polygon fill="#000000" stroke="#000000" points="565.076,-395.978 562.866,-385.616 558.132,-395.095 565.076,-395.978"/>
</g>
<!-- proc~track -->
<g id="proc~~get_fields~~CalledByGraph_node12" class="node"><title>proc~track</title>
<g id="a_proc~~get_fields~~CalledByGraph_node12"><a xlink:href=".././proc/track.html" xlink:title="track">
<polygon fill="#d9534f" stroke="#d9534f" points="334,-585.428 280,-585.428 280,-561.428 334,-561.428 334,-585.428"/>
<text text-anchor="middle" x="307" y="-571.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge40" class="edge"><title>proc~fida_mc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.124,-573.428C203.235,-573.428 241.411,-573.428 269.517,-573.428"/>
<polygon fill="#000000" stroke="#000000" points="269.748,-576.928 279.748,-573.428 269.748,-569.928 269.748,-576.928"/>
</g>
<!-- proc~store_fida_photons -->
<g id="proc~~get_fields~~CalledByGraph_node22" class="node"><title>proc~store_fida_photons</title>
<g id="a_proc~~get_fields~~CalledByGraph_node22"><a xlink:href=".././proc/store_fida_photons.html" xlink:title="store_fida_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="359,-543.428 255,-543.428 255,-519.428 359,-519.428 359,-543.428"/>
<text text-anchor="middle" x="307" y="-529.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_fida_photons</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge61" class="edge"><title>proc~fida_mc&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M178.124,-566.304C198.351,-560.787 227.057,-552.958 252.147,-546.115"/>
<polygon fill="#000000" stroke="#000000" points="253.193,-549.458 261.92,-543.45 251.351,-542.705 253.193,-549.458"/>
</g>
<!-- proc~pfida_mc -->
<g id="proc~~get_fields~~CalledByGraph_node8" class="node"><title>proc~pfida_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node8"><a xlink:href=".././proc/pfida_mc.html" xlink:title="pfida_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="179,-501.428 123,-501.428 123,-477.428 179,-477.428 179,-501.428"/>
<text text-anchor="middle" x="151" y="-487.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pfida_mc</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge7" class="edge"><title>proc~pfida_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M179.062,-493.265C240.669,-500.614 394.22,-510.998 500,-450.428 523.122,-437.188 541.5,-412.198 552.525,-394.276"/>
<polygon fill="#000000" stroke="#000000" points="555.548,-396.04 557.607,-385.647 549.516,-392.488 555.548,-396.04"/>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~track_cylindrical -->
<g id="proc~~get_fields~~CalledByGraph_edge34" class="edge"><title>proc~pfida_mc&#45;&gt;proc~track_cylindrical</title>
<path fill="none" stroke="#000000" d="M179.178,-482.722C199.517,-477.703 227.983,-470.679 252.795,-464.557"/>
<polygon fill="#000000" stroke="#000000" points="253.941,-467.879 262.811,-462.085 252.264,-461.083 253.941,-467.879"/>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge64" class="edge"><title>proc~pfida_mc&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M179.178,-496.84C199.289,-502.325 227.347,-509.978 251.96,-516.69"/>
<polygon fill="#000000" stroke="#000000" points="251.339,-520.149 261.908,-519.403 253.181,-513.395 251.339,-520.149"/>
</g>
<!-- proc~make_diagnostic_grids -->
<g id="proc~~get_fields~~CalledByGraph_node9" class="node"><title>proc~make_diagnostic_grids</title>
<g id="a_proc~~get_fields~~CalledByGraph_node9"><a xlink:href=".././proc/make_diagnostic_grids.html" xlink:title="make_diagnostic_grids">
<polygon fill="#d9534f" stroke="#d9534f" points="212,-459.428 90,-459.428 90,-435.428 212,-435.428 212,-459.428"/>
<text text-anchor="middle" x="151" y="-445.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">make_diagnostic_grids</text>
</a>
</g>
</g>
<!-- proc~make_diagnostic_grids&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge8" class="edge"><title>proc~make_diagnostic_grids&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M212.168,-436.751C224.044,-434.65 236.414,-432.466 248,-430.428 359.976,-410.738 388.28,-407.524 500,-386.428 508.488,-384.826 517.593,-383.025 526.195,-381.287"/>
<polygon fill="#000000" stroke="#000000" points="526.895,-384.717 535.995,-379.291 525.497,-377.857 526.895,-384.717"/>
</g>
<!-- proc~make_diagnostic_grids&#45;&gt;proc~track_cylindrical -->
<g id="proc~~get_fields~~CalledByGraph_edge32" class="edge"><title>proc~make_diagnostic_grids&#45;&gt;proc~track_cylindrical</title>
<path fill="none" stroke="#000000" d="M212.423,-448.998C225.721,-449.343 239.712,-449.707 252.705,-450.044"/>
<polygon fill="#000000" stroke="#000000" points="252.791,-453.547 262.878,-450.308 252.973,-446.55 252.791,-453.547"/>
</g>
<!-- proc~make_diagnostic_grids&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge42" class="edge"><title>proc~make_diagnostic_grids&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M199.096,-459.485C203.788,-461.939 208.209,-464.888 212,-468.428 241.684,-496.153 218.465,-524.545 248,-552.428 254.2,-558.282 262.155,-562.526 270.172,-565.595"/>
<polygon fill="#000000" stroke="#000000" points="269.277,-568.985 279.869,-568.786 271.464,-562.336 269.277,-568.985"/>
</g>
<!-- proc~store_fw_photons -->
<g id="proc~~get_fields~~CalledByGraph_node10" class="node"><title>proc~store_fw_photons</title>
<g id="a_proc~~get_fields~~CalledByGraph_node10"><a xlink:href=".././proc/store_fw_photons.html" xlink:title="store_fw_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="499.5,-307.428 402.5,-307.428 402.5,-283.428 499.5,-283.428 499.5,-307.428"/>
<text text-anchor="middle" x="451" y="-293.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_fw_photons</text>
</a>
</g>
</g>
<!-- proc~store_fw_photons&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge9" class="edge"><title>proc~store_fw_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M476.441,-307.537C484.155,-311.656 492.594,-316.477 500,-321.428 514.891,-331.385 530.515,-344.031 542.598,-354.359"/>
<polygon fill="#000000" stroke="#000000" points="540.497,-357.17 550.345,-361.078 545.083,-351.882 540.497,-357.17"/>
</g>
<!-- proc~npa_mc -->
<g id="proc~~get_fields~~CalledByGraph_node11" class="node"><title>proc~npa_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node11"><a xlink:href=".././proc/npa_mc.html" xlink:title="npa_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-147.428 124,-147.428 124,-123.428 178,-123.428 178,-147.428"/>
<text text-anchor="middle" x="151" y="-133.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_mc</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge10" class="edge"><title>proc~npa_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M178.234,-128.088C197.39,-123.122 224.084,-117.014 248,-114.428 359.383,-102.388 413.162,-49.6454 500,-120.428 536.058,-149.82 555.449,-294.853 561.71,-351.09"/>
<polygon fill="#000000" stroke="#000000" points="558.268,-351.814 562.818,-361.382 565.228,-351.064 558.268,-351.814"/>
</g>
<!-- proc~store_npa -->
<g id="proc~~get_fields~~CalledByGraph_node20" class="node"><title>proc~store_npa</title>
<g id="a_proc~~get_fields~~CalledByGraph_node20"><a xlink:href=".././proc/store_npa.html" xlink:title="store_npa">
<polygon fill="#d9534f" stroke="#d9534f" points="337.5,-147.428 276.5,-147.428 276.5,-123.428 337.5,-123.428 337.5,-147.428"/>
<text text-anchor="middle" x="307" y="-133.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_npa</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~store_npa -->
<g id="proc~~get_fields~~CalledByGraph_edge57" class="edge"><title>proc~npa_mc&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M178.124,-135.428C202.246,-135.428 238.424,-135.428 266.15,-135.428"/>
<polygon fill="#000000" stroke="#000000" points="266.32,-138.928 276.32,-135.428 266.32,-131.928 266.32,-138.928"/>
</g>
<!-- proc~track&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge11" class="edge"><title>proc~track&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M334.168,-570.519C374.383,-564.784 451.772,-548.577 500,-505.428 533.324,-475.614 551.042,-424.608 558.886,-395.501"/>
<polygon fill="#000000" stroke="#000000" points="562.354,-396.061 561.42,-385.507 555.569,-394.34 562.354,-396.061"/>
</g>
<!-- proc~neutron_mc -->
<g id="proc~~get_fields~~CalledByGraph_node13" class="node"><title>proc~neutron_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node13"><a xlink:href=".././proc/neutron_mc.html" xlink:title="neutron_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="486,-189.428 416,-189.428 416,-165.428 486,-165.428 486,-189.428"/>
<text text-anchor="middle" x="451" y="-175.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutron_mc</text>
</a>
</g>
</g>
<!-- proc~neutron_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge13" class="edge"><title>proc~neutron_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M482.3,-189.578C488.787,-193.267 495.141,-197.857 500,-203.428 538.156,-247.178 554.53,-315.908 560.719,-351.073"/>
<polygon fill="#000000" stroke="#000000" points="557.313,-351.935 562.385,-361.237 564.221,-350.802 557.313,-351.935"/>
</g>
<!-- proc~fida_weights_mc -->
<g id="proc~~get_fields~~CalledByGraph_node14" class="node"><title>proc~fida_weights_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node14"><a xlink:href=".././proc/fida_weights_mc.html" xlink:title="fida_weights_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="197,-417.428 105,-417.428 105,-393.428 197,-393.428 197,-417.428"/>
<text text-anchor="middle" x="151" y="-403.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_weights_mc</text>
</a>
</g>
</g>
<!-- proc~fida_weights_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge14" class="edge"><title>proc~fida_weights_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M193.71,-393.403C200.043,-390.854 206.344,-387.871 212,-384.428 230.799,-372.986 227.549,-358.559 248,-350.428 342.417,-312.89 465.101,-341.498 526.104,-360.34"/>
<polygon fill="#000000" stroke="#000000" points="525.112,-363.697 535.703,-363.383 527.228,-357.025 525.112,-363.697"/>
</g>
<!-- proc~fida_weights_mc&#45;&gt;proc~store_fw_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge38" class="edge"><title>proc~fida_weights_mc&#45;&gt;proc~store_fw_photons</title>
<path fill="none" stroke="#000000" d="M197.268,-393.779C202.572,-391.237 207.637,-388.157 212,-384.428 237.697,-362.465 219.97,-336.323 248,-317.428 290.11,-289.043 348.738,-285.625 391.989,-288.07"/>
<polygon fill="#000000" stroke="#000000" points="391.863,-291.57 402.079,-288.762 392.341,-284.586 391.863,-291.57"/>
</g>
<!-- proc~fida_weights_mc&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge44" class="edge"><title>proc~fida_weights_mc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M197.179,-415.771C202.69,-418.525 207.835,-422.013 212,-426.428 251.963,-468.795 208.264,-509.848 248,-552.428 253.987,-558.844 262.083,-563.304 270.325,-566.403"/>
<polygon fill="#000000" stroke="#000000" points="269.359,-569.768 279.949,-569.451 271.473,-563.095 269.359,-569.768"/>
</g>
<!-- proc~ndmc -->
<g id="proc~~get_fields~~CalledByGraph_node15" class="node"><title>proc~ndmc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node15"><a xlink:href=".././proc/ndmc.html" xlink:title="ndmc">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-669.428 124,-669.428 124,-645.428 178,-645.428 178,-669.428"/>
<text text-anchor="middle" x="151" y="-655.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ndmc</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge18" class="edge"><title>proc~ndmc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M178.236,-660.109C242.168,-665.106 407.521,-668.56 500,-583.428 554.314,-533.43 563.076,-438.874 564.124,-395.808"/>
<polygon fill="#000000" stroke="#000000" points="567.627,-395.606 564.247,-385.565 560.627,-395.522 567.627,-395.606"/>
</g>
<!-- proc~ndmc&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge47" class="edge"><title>proc~ndmc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.284,-649.831C188.994,-646.328 201.339,-641.758 212,-636.428 237.219,-623.821 263.705,-605.55 282.111,-591.927"/>
<polygon fill="#000000" stroke="#000000" points="284.563,-594.463 290.456,-585.658 280.359,-588.866 284.563,-594.463"/>
</g>
<!-- proc~store_nbi_photons -->
<g id="proc~~get_fields~~CalledByGraph_node32" class="node"><title>proc~store_nbi_photons</title>
<g id="a_proc~~get_fields~~CalledByGraph_node32"><a xlink:href=".././proc/store_nbi_photons.html" xlink:title="store_nbi_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="357.5,-741.428 256.5,-741.428 256.5,-717.428 357.5,-717.428 357.5,-741.428"/>
<text text-anchor="middle" x="307" y="-727.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_nbi_photons</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~store_nbi_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge73" class="edge"><title>proc~ndmc&#45;&gt;proc~store_nbi_photons</title>
<path fill="none" stroke="#000000" d="M178.031,-664.841C188.817,-668.342 201.285,-672.961 212,-678.428 229.351,-687.282 231.039,-693.847 248,-703.428 254.003,-706.82 260.532,-710.104 266.971,-713.133"/>
<polygon fill="#000000" stroke="#000000" points="265.718,-716.408 276.269,-717.368 268.62,-710.038 265.718,-716.408"/>
</g>
<!-- proc~fida_weights_los -->
<g id="proc~~get_fields~~CalledByGraph_node16" class="node"><title>proc~fida_weights_los</title>
<g id="a_proc~~get_fields~~CalledByGraph_node16"><a xlink:href=".././proc/fida_weights_los.html" xlink:title="fida_weights_los">
<polygon fill="#d9534f" stroke="#d9534f" points="196.5,-375.428 105.5,-375.428 105.5,-351.428 196.5,-351.428 196.5,-375.428"/>
<text text-anchor="middle" x="151" y="-361.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_weights_los</text>
</a>
</g>
</g>
<!-- proc~fida_weights_los&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge15" class="edge"><title>proc~fida_weights_los&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M196.769,-351.692C202.214,-349.16 207.451,-346.105 212,-342.428 235.889,-323.118 221.663,-299.239 248,-283.428 296.043,-254.587 450.783,-247.639 500,-274.428 529.908,-290.707 547.974,-327.643 556.957,-351.509"/>
<polygon fill="#000000" stroke="#000000" points="553.727,-352.873 560.358,-361.137 560.327,-350.542 553.727,-352.873"/>
</g>
<!-- proc~fida_weights_los&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge45" class="edge"><title>proc~fida_weights_los&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M196.559,-373.066C202.372,-375.923 207.767,-379.627 212,-384.428 262.501,-441.706 197.806,-494.881 248,-552.428 253.818,-559.099 261.926,-563.652 270.238,-566.758"/>
<polygon fill="#000000" stroke="#000000" points="269.376,-570.155 279.964,-569.781 271.454,-563.471 269.376,-570.155"/>
</g>
<!-- proc~mc_fastion_pass_grid -->
<g id="proc~~get_fields~~CalledByGraph_node17" class="node"><title>proc~mc_fastion_pass_grid</title>
<g id="a_proc~~get_fields~~CalledByGraph_node17"><a xlink:href=".././proc/mc_fastion_pass_grid.html" xlink:title="mc_fastion_pass_grid">
<polygon fill="#d9534f" stroke="#d9534f" points="365.5,-227.428 248.5,-227.428 248.5,-203.428 365.5,-203.428 365.5,-227.428"/>
<text text-anchor="middle" x="307" y="-213.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_fastion_pass_grid</text>
</a>
</g>
</g>
<!-- proc~mc_fastion_pass_grid&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge16" class="edge"><title>proc~mc_fastion_pass_grid&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M365.737,-209.62C406.862,-208.505 461.455,-213.503 500,-241.428 536.554,-267.911 553.169,-320.993 559.933,-351.151"/>
<polygon fill="#000000" stroke="#000000" points="556.545,-352.049 561.999,-361.133 563.4,-350.631 556.545,-352.049"/>
</g>
<!-- proc~neutron_f -->
<g id="proc~~get_fields~~CalledByGraph_node18" class="node"><title>proc~neutron_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node18"><a xlink:href=".././proc/neutron_f.html" xlink:title="neutron_f">
<polygon fill="#d9534f" stroke="#d9534f" points="480,-29.4283 422,-29.4283 422,-5.42834 480,-5.42834 480,-29.4283"/>
<text text-anchor="middle" x="451" y="-15.0283" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutron_f</text>
</a>
</g>
</g>
<!-- proc~neutron_f&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge17" class="edge"><title>proc~neutron_f&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M480.009,-27.3723C487.524,-31.296 494.954,-36.5511 500,-43.4283 536.468,-93.1351 556.334,-285.566 562.162,-351.284"/>
<polygon fill="#000000" stroke="#000000" points="558.685,-351.704 563.033,-361.365 565.659,-351.101 558.685,-351.704"/>
</g>
<!-- proc~pnpa_mc -->
<g id="proc~~get_fields~~CalledByGraph_node19" class="node"><title>proc~pnpa_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node19"><a xlink:href=".././proc/pnpa_mc.html" xlink:title="pnpa_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="179.5,-105.428 122.5,-105.428 122.5,-81.4283 179.5,-81.4283 179.5,-105.428"/>
<text text-anchor="middle" x="151" y="-91.0283" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pnpa_mc</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge12" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M179.701,-81.4012C244.004,-55.554 405.126,-2.98554 500,-79.4283 542.593,-113.747 558.329,-288.671 562.645,-351.184"/>
<polygon fill="#000000" stroke="#000000" points="559.153,-351.425 563.302,-361.173 566.138,-350.965 559.153,-351.425"/>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~store_npa -->
<g id="proc~~get_fields~~CalledByGraph_edge56" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M179.532,-100.937C203.697,-107.528 239.135,-117.192 266.354,-124.616"/>
<polygon fill="#000000" stroke="#000000" points="265.774,-128.085 276.343,-127.34 267.616,-121.332 265.774,-128.085"/>
</g>
<!-- proc~store_npa&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge19" class="edge"><title>proc~store_npa&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M337.511,-129.48C378.853,-122.97 454.085,-118.031 500,-156.428 559.025,-205.79 565.192,-306.675 564.834,-351.325"/>
<polygon fill="#000000" stroke="#000000" points="561.333,-351.33 564.63,-361.399 568.332,-351.472 561.333,-351.33"/>
</g>
<!-- proc~halo_spec -->
<g id="proc~~get_fields~~CalledByGraph_node21" class="node"><title>proc~halo_spec</title>
<g id="a_proc~~get_fields~~CalledByGraph_node21"><a xlink:href=".././proc/halo_spec.html" xlink:title="halo_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="337.5,-947.428 276.5,-947.428 276.5,-923.428 337.5,-923.428 337.5,-947.428"/>
<text text-anchor="middle" x="307" y="-933.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">halo_spec</text>
</a>
</g>
</g>
<!-- proc~halo_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge24" class="edge"><title>proc~halo_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M337.511,-929.096C347.351,-925.912 357.868,-921.23 366,-914.428 387.01,-896.855 422.558,-826.687 439.891,-790.802"/>
<polygon fill="#000000" stroke="#000000" points="443.105,-792.192 444.269,-781.661 436.792,-789.168 443.105,-792.192"/>
</g>
<!-- proc~store_fida_photons&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge25" class="edge"><title>proc~store_fida_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M353.659,-543.527C358.17,-545.973 362.402,-548.909 366,-552.428 422.052,-607.263 441.396,-703.696 447.473,-747.123"/>
<polygon fill="#000000" stroke="#000000" points="444.022,-747.727 448.774,-757.196 450.964,-746.83 444.022,-747.727"/>
</g>
<!-- proc~cold_spec -->
<g id="proc~~get_fields~~CalledByGraph_node23" class="node"><title>proc~cold_spec</title>
<g id="a_proc~~get_fields~~CalledByGraph_node23"><a xlink:href=".././proc/cold_spec.html" xlink:title="cold_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="337.5,-905.428 276.5,-905.428 276.5,-881.428 337.5,-881.428 337.5,-905.428"/>
<text text-anchor="middle" x="307" y="-891.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cold_spec</text>
</a>
</g>
</g>
<!-- proc~cold_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge26" class="edge"><title>proc~cold_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M337.524,-886.144C347.149,-882.909 357.528,-878.439 366,-872.428 397.262,-850.25 423.321,-813.486 437.767,-790.404"/>
<polygon fill="#000000" stroke="#000000" points="440.846,-792.077 443.06,-781.716 434.868,-788.435 440.846,-792.077"/>
</g>
<!-- proc~fida_f -->
<g id="proc~~get_fields~~CalledByGraph_node24" class="node"><title>proc~fida_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node24"><a xlink:href=".././proc/fida_f.html" xlink:title="fida_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-543.428 124,-543.428 124,-519.428 178,-519.428 178,-543.428"/>
<text text-anchor="middle" x="151" y="-529.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_f</text>
</a>
</g>
</g>
<!-- proc~fida_f&#45;&gt;proc~mc_fastion -->
<g id="proc~~get_fields~~CalledByGraph_edge22" class="edge"><title>proc~fida_f&#45;&gt;proc~mc_fastion</title>
<path fill="none" stroke="#000000" d="M178.043,-527.142C189.59,-524.117 202.647,-519.008 212,-510.428 240.732,-484.072 225.989,-462.611 248,-430.428 258.014,-415.786 271.865,-401.54 283.519,-390.716"/>
<polygon fill="#000000" stroke="#000000" points="286.092,-393.109 291.163,-383.806 281.398,-387.916 286.092,-393.109"/>
</g>
<!-- proc~fida_f&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge41" class="edge"><title>proc~fida_f&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.124,-538.553C203.345,-545.432 241.748,-555.905 269.888,-563.58"/>
<polygon fill="#000000" stroke="#000000" points="269.179,-567.014 279.748,-566.269 271.021,-560.261 269.179,-567.014"/>
</g>
<!-- proc~fida_f&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge63" class="edge"><title>proc~fida_f&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M178.124,-531.428C196.364,-531.428 221.497,-531.428 244.657,-531.428"/>
<polygon fill="#000000" stroke="#000000" points="244.78,-534.928 254.78,-531.428 244.78,-527.928 244.78,-534.928"/>
</g>
<!-- proc~dcx_spec -->
<g id="proc~~get_fields~~CalledByGraph_node25" class="node"><title>proc~dcx_spec</title>
<g id="a_proc~~get_fields~~CalledByGraph_node25"><a xlink:href=".././proc/dcx_spec.html" xlink:title="dcx_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="336,-863.428 278,-863.428 278,-839.428 336,-839.428 336,-863.428"/>
<text text-anchor="middle" x="307" y="-849.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dcx_spec</text>
</a>
</g>
</g>
<!-- proc~dcx_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge29" class="edge"><title>proc~dcx_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M336.119,-843.027C345.838,-839.663 356.634,-835.397 366,-830.428 388.506,-818.489 411.77,-801.136 428.092,-787.988"/>
<polygon fill="#000000" stroke="#000000" points="430.436,-790.592 435.953,-781.547 426,-785.177 430.436,-790.592"/>
</g>
<!-- proc~pnpa_f -->
<g id="proc~~get_fields~~CalledByGraph_node26" class="node"><title>proc~pnpa_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node26"><a xlink:href=".././proc/pnpa_f.html" xlink:title="pnpa_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-189.428 124,-189.428 124,-165.428 178,-165.428 178,-189.428"/>
<text text-anchor="middle" x="151" y="-175.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pnpa_f</text>
</a>
</g>
</g>
<!-- proc~pnpa_f&#45;&gt;proc~mc_fastion_pass_grid -->
<g id="proc~~get_fields~~CalledByGraph_edge53" class="edge"><title>proc~pnpa_f&#45;&gt;proc~mc_fastion_pass_grid</title>
<path fill="none" stroke="#000000" d="M178.124,-183.875C197.131,-188.564 223.623,-195.101 247.567,-201.01"/>
<polygon fill="#000000" stroke="#000000" points="246.746,-204.412 257.293,-203.41 248.423,-197.616 246.746,-204.412"/>
</g>
<!-- proc~pnpa_f&#45;&gt;proc~store_npa -->
<g id="proc~~get_fields~~CalledByGraph_edge58" class="edge"><title>proc~pnpa_f&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M178.124,-170.304C202.352,-163.696 238.743,-153.771 266.516,-146.197"/>
<polygon fill="#000000" stroke="#000000" points="267.593,-149.531 276.32,-143.523 265.751,-142.777 267.593,-149.531"/>
</g>
<!-- proc~pfida_f -->
<g id="proc~~get_fields~~CalledByGraph_node27" class="node"><title>proc~pfida_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node27"><a xlink:href=".././proc/pfida_f.html" xlink:title="pfida_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-333.428 124,-333.428 124,-309.428 178,-309.428 178,-333.428"/>
<text text-anchor="middle" x="151" y="-319.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pfida_f</text>
</a>
</g>
</g>
<!-- proc~pfida_f&#45;&gt;proc~track_cylindrical -->
<g id="proc~~get_fields~~CalledByGraph_edge33" class="edge"><title>proc~pfida_f&#45;&gt;proc~track_cylindrical</title>
<path fill="none" stroke="#000000" d="M178.197,-326.864C189.376,-330.085 202.098,-335.03 212,-342.428 233.936,-358.819 230.35,-371.492 248,-392.428 259.735,-406.348 274.067,-420.947 285.549,-432.141"/>
<polygon fill="#000000" stroke="#000000" points="283.345,-434.878 292.975,-439.296 288.202,-429.837 283.345,-434.878"/>
</g>
<!-- proc~pfida_f&#45;&gt;proc~mc_fastion_pass_grid -->
<g id="proc~~get_fields~~CalledByGraph_edge52" class="edge"><title>proc~pfida_f&#45;&gt;proc~mc_fastion_pass_grid</title>
<path fill="none" stroke="#000000" d="M167.467,-309.413C179.691,-299.832 197.112,-285.986 212,-273.428 228.364,-259.626 230.024,-253.053 248,-241.428 253.351,-237.968 259.24,-234.746 265.151,-231.83"/>
<polygon fill="#000000" stroke="#000000" points="266.809,-234.918 274.384,-227.511 263.843,-228.578 266.809,-234.918"/>
</g>
<!-- proc~pfida_f&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge62" class="edge"><title>proc~pfida_f&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M178.055,-324.939C189.887,-327.803 203.178,-332.999 212,-342.428 252.959,-386.207 218.029,-420.505 248,-472.428 256.81,-487.691 270.497,-501.875 282.363,-512.509"/>
<polygon fill="#000000" stroke="#000000" points="280.346,-515.392 290.204,-519.274 284.919,-510.092 280.346,-515.392"/>
</g>
<!-- proc~nbi_spec -->
<g id="proc~~get_fields~~CalledByGraph_node28" class="node"><title>proc~nbi_spec</title>
<g id="a_proc~~get_fields~~CalledByGraph_node28"><a xlink:href=".././proc/nbi_spec.html" xlink:title="nbi_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="334.5,-821.428 279.5,-821.428 279.5,-797.428 334.5,-797.428 334.5,-821.428"/>
<text text-anchor="middle" x="307" y="-807.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nbi_spec</text>
</a>
</g>
</g>
<!-- proc~nbi_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge27" class="edge"><title>proc~nbi_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M334.709,-801.905C353.172,-796.704 378.287,-789.629 400.363,-783.411"/>
<polygon fill="#000000" stroke="#000000" points="401.581,-786.704 410.258,-780.623 399.683,-779.966 401.581,-786.704"/>
</g>
<!-- proc~dcx -->
<g id="proc~~get_fields~~CalledByGraph_node29" class="node"><title>proc~dcx</title>
<g id="a_proc~~get_fields~~CalledByGraph_node29"><a xlink:href=".././proc/dcx.html" xlink:title="dcx">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-711.428 124,-711.428 124,-687.428 178,-687.428 178,-711.428"/>
<text text-anchor="middle" x="151" y="-697.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dcx</text>
</a>
</g>
</g>
<!-- proc~dcx&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge28" class="edge"><title>proc~dcx&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M169.479,-711.458C188.049,-723.562 218.712,-741.655 248,-750.428 298.393,-765.524 358.735,-769.473 400.269,-770.143"/>
<polygon fill="#000000" stroke="#000000" points="400.37,-773.645 410.406,-770.248 400.443,-766.645 400.37,-773.645"/>
</g>
<!-- proc~dcx&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge43" class="edge"><title>proc~dcx&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.136,-693.395C189.178,-690.082 201.812,-685.23 212,-678.428 246.132,-655.642 275.891,-617.638 292.355,-594.141"/>
<polygon fill="#000000" stroke="#000000" points="295.427,-595.849 298.187,-585.62 289.651,-591.895 295.427,-595.849"/>
</g>
<!-- program~fidasim -->
<g id="proc~~get_fields~~CalledByGraph_node30" class="node"><title>program~fidasim</title>
<g id="a_proc~~get_fields~~CalledByGraph_node30"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-522.428 0,-522.428 0,-498.428 54,-498.428 54,-522.428"/>
<text text-anchor="middle" x="27" y="-508.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~cfpd_f -->
<g id="proc~~get_fields~~CalledByGraph_edge20" class="edge"><title>program~fidasim&#45;&gt;proc~cfpd_f</title>
<path fill="none" stroke="#000000" d="M27.8293,-522.576C27.1794,-587.536 27.5106,-893.339 90,-957.428 175.721,-1045.34 341.606,-1007.86 414.35,-985.58"/>
<polygon fill="#000000" stroke="#000000" points="415.489,-988.891 423.978,-982.552 413.389,-982.214 415.489,-988.891"/>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_weights -->
<g id="proc~~get_fields~~CalledByGraph_edge21" class="edge"><title>program~fidasim&#45;&gt;proc~npa_weights</title>
<path fill="none" stroke="#000000" d="M28.2342,-522.611C29.6293,-582.659 38.6418,-846.654 90,-906.428 171.242,-1000.98 248.034,-996.74 366,-956.428 392.391,-947.41 416.919,-926.358 432.574,-910.641"/>
<polygon fill="#000000" stroke="#000000" points="435.102,-913.061 439.515,-903.429 430.058,-908.207 435.102,-913.061"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge35" class="edge"><title>program~fidasim&#45;&gt;proc~fida_mc</title>
<path fill="none" stroke="#000000" d="M43.6139,-522.681C55.7484,-531.778 73.2749,-544.016 90,-552.428 97.6402,-556.271 106.153,-559.712 114.309,-562.642"/>
<polygon fill="#000000" stroke="#000000" points="113.405,-566.031 124,-565.955 115.67,-559.408 113.405,-566.031"/>
</g>
<!-- program~fidasim&#45;&gt;proc~pfida_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge36" class="edge"><title>program~fidasim&#45;&gt;proc~pfida_mc</title>
<path fill="none" stroke="#000000" d="M54.1721,-505.923C71.1857,-502.995 93.6353,-499.13 112.529,-495.878"/>
<polygon fill="#000000" stroke="#000000" points="113.341,-499.29 122.602,-494.144 112.153,-492.392 113.341,-499.29"/>
</g>
<!-- program~fidasim&#45;&gt;proc~make_diagnostic_grids -->
<g id="proc~~get_fields~~CalledByGraph_edge37" class="edge"><title>program~fidasim&#45;&gt;proc~make_diagnostic_grids</title>
<path fill="none" stroke="#000000" d="M43.6139,-498.176C55.7484,-489.078 73.2749,-476.841 90,-468.428 93.7157,-466.559 97.6378,-464.786 101.625,-463.119"/>
<polygon fill="#000000" stroke="#000000" points="102.959,-466.356 110.98,-459.433 100.393,-459.843 102.959,-466.356"/>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge39" class="edge"><title>program~fidasim&#45;&gt;proc~npa_mc</title>
<path fill="none" stroke="#000000" d="M28.5266,-498.093C31.1662,-441.812 44.6802,-209.826 90,-156.428 96.1884,-149.137 105.062,-144.375 114.094,-141.267"/>
<polygon fill="#000000" stroke="#000000" points="115.174,-144.599 123.838,-138.501 113.262,-137.865 115.174,-144.599"/>
</g>
<!-- program~fidasim&#45;&gt;proc~neutron_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge48" class="edge"><title>program~fidasim&#45;&gt;proc~neutron_mc</title>
<path fill="none" stroke="#000000" d="M28.313,-498.187C29.8307,-463.188 38.6701,-361.319 90,-300.428 128.945,-254.229 165.088,-278.513 212,-240.428 232.155,-224.066 225.159,-206.769 248,-194.428 297.057,-167.924 362.764,-167.714 405.721,-171.405"/>
<polygon fill="#000000" stroke="#000000" points="405.57,-174.906 415.861,-172.385 406.244,-167.939 405.57,-174.906"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_weights_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge49" class="edge"><title>program~fidasim&#45;&gt;proc~fida_weights_mc</title>
<path fill="none" stroke="#000000" d="M33.8933,-498.34C43.3186,-480.21 63.4579,-446.018 90,-426.428 92.059,-424.909 94.2372,-423.492 96.4962,-422.172"/>
<polygon fill="#000000" stroke="#000000" points="98.2217,-425.221 105.528,-417.548 95.0318,-418.99 98.2217,-425.221"/>
</g>
<!-- program~fidasim&#45;&gt;proc~ndmc -->
<g id="proc~~get_fields~~CalledByGraph_edge50" class="edge"><title>program~fidasim&#45;&gt;proc~ndmc</title>
<path fill="none" stroke="#000000" d="M30.7272,-522.726C36.8925,-547.714 54.2364,-604.737 90,-636.428 96.8415,-642.491 105.537,-646.829 114.17,-649.923"/>
<polygon fill="#000000" stroke="#000000" points="113.201,-653.287 123.789,-652.914 115.28,-646.603 113.201,-653.287"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_weights_los -->
<g id="proc~~get_fields~~CalledByGraph_edge51" class="edge"><title>program~fidasim&#45;&gt;proc~fida_weights_los</title>
<path fill="none" stroke="#000000" d="M30.7272,-498.131C36.8925,-473.142 54.2364,-416.119 90,-384.428 91.9514,-382.699 94.0536,-381.11 96.2622,-379.651"/>
<polygon fill="#000000" stroke="#000000" points="98.1996,-382.577 105.214,-374.637 94.779,-376.47 98.1996,-382.577"/>
</g>
<!-- program~fidasim&#45;&gt;proc~neutron_f -->
<g id="proc~~get_fields~~CalledByGraph_edge54" class="edge"><title>program~fidasim&#45;&gt;proc~neutron_f</title>
<path fill="none" stroke="#000000" d="M27.9426,-498.174C27.8971,-433.99 30.9203,-137.042 90,-72.4283 173.023,18.3714 337.843,2.90929 412.132,-9.73175"/>
<polygon fill="#000000" stroke="#000000" points="411.537,-13.1809 421.995,-11.4854 412.762,-6.28893 411.537,-13.1809"/>
</g>
<!-- program~fidasim&#45;&gt;proc~pnpa_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge55" class="edge"><title>program~fidasim&#45;&gt;proc~pnpa_mc</title>
<path fill="none" stroke="#000000" d="M28.2704,-498.277C29.8386,-438.374 39.5499,-174.971 90,-114.428 95.8005,-107.467 104.052,-102.811 112.585,-99.6978"/>
<polygon fill="#000000" stroke="#000000" points="113.657,-103.031 122.224,-96.7973 111.639,-96.3274 113.657,-103.031"/>
</g>
<!-- program~fidasim&#45;&gt;proc~halo_spec -->
<g id="proc~~get_fields~~CalledByGraph_edge60" class="edge"><title>program~fidasim&#45;&gt;proc~halo_spec</title>
<path fill="none" stroke="#000000" d="M28.5339,-522.666C31.2054,-578.505 44.8396,-808.651 90,-861.428 134.419,-913.338 216.934,-928.893 266.115,-933.516"/>
<polygon fill="#000000" stroke="#000000" points="266.119,-937.028 276.374,-934.367 266.698,-930.052 266.119,-937.028"/>
</g>
<!-- program~fidasim&#45;&gt;proc~cold_spec -->
<g id="proc~~get_fields~~CalledByGraph_edge65" class="edge"><title>program~fidasim&#45;&gt;proc~cold_spec</title>
<path fill="none" stroke="#000000" d="M28.9158,-522.737C32.9613,-574.007 50.7951,-770.037 90,-815.428 134.917,-867.433 217.26,-884.768 266.275,-890.544"/>
<polygon fill="#000000" stroke="#000000" points="266.182,-894.054 276.498,-891.638 266.927,-887.094 266.182,-894.054"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_f -->
<g id="proc~~get_fields~~CalledByGraph_edge66" class="edge"><title>program~fidasim&#45;&gt;proc~fida_f</title>
<path fill="none" stroke="#000000" d="M54.1721,-514.933C71.6205,-517.937 94.7864,-521.924 113.97,-525.226"/>
<polygon fill="#000000" stroke="#000000" points="113.422,-528.684 123.871,-526.931 114.61,-521.785 113.422,-528.684"/>
</g>
<!-- program~fidasim&#45;&gt;proc~dcx_spec -->
<g id="proc~~get_fields~~CalledByGraph_edge67" class="edge"><title>program~fidasim&#45;&gt;proc~dcx_spec</title>
<path fill="none" stroke="#000000" d="M29.4353,-522.655C35.0522,-568.62 56.8773,-730.384 90,-768.428 135.834,-821.073 218.953,-840.491 267.631,-847.533"/>
<polygon fill="#000000" stroke="#000000" points="267.386,-851.032 277.762,-848.892 268.316,-844.094 267.386,-851.032"/>
</g>
<!-- program~fidasim&#45;&gt;proc~pnpa_f -->
<g id="proc~~get_fields~~CalledByGraph_edge68" class="edge"><title>program~fidasim&#45;&gt;proc~pnpa_f</title>
<path fill="none" stroke="#000000" d="M28.8376,-498.181C32.621,-446.255 49.7131,-244.815 90,-198.428 96.2711,-191.208 105.172,-186.469 114.203,-183.36"/>
<polygon fill="#000000" stroke="#000000" points="115.279,-186.693 123.936,-180.585 113.359,-179.961 115.279,-186.693"/>
</g>
<!-- program~fidasim&#45;&gt;proc~pfida_f -->
<g id="proc~~get_fields~~CalledByGraph_edge69" class="edge"><title>program~fidasim&#45;&gt;proc~pfida_f</title>
<path fill="none" stroke="#000000" d="M28.9907,-498.403C32.1355,-467.962 44.5552,-387.113 90,-342.428 96.6324,-335.907 105.401,-331.403 114.18,-328.296"/>
<polygon fill="#000000" stroke="#000000" points="115.416,-331.579 123.984,-325.347 113.399,-324.876 115.416,-331.579"/>
</g>
<!-- program~fidasim&#45;&gt;proc~nbi_spec -->
<g id="proc~~get_fields~~CalledByGraph_edge70" class="edge"><title>program~fidasim&#45;&gt;proc~nbi_spec</title>
<path fill="none" stroke="#000000" d="M28.1093,-522.589C29.0726,-557.806 36.555,-661.129 90,-720.428 137.559,-773.197 221.149,-795.42 269.205,-804.194"/>
<polygon fill="#000000" stroke="#000000" points="268.732,-807.664 279.181,-805.915 269.922,-800.766 268.732,-807.664"/>
</g>
<!-- program~fidasim&#45;&gt;proc~dcx -->
<g id="proc~~get_fields~~CalledByGraph_edge71" class="edge"><title>program~fidasim&#45;&gt;proc~dcx</title>
<path fill="none" stroke="#000000" d="M28.9907,-522.454C32.1355,-552.894 44.5552,-633.744 90,-678.428 96.6324,-684.95 105.401,-689.453 114.18,-692.561"/>
<polygon fill="#000000" stroke="#000000" points="113.399,-695.981 123.984,-695.509 115.416,-689.277 113.399,-695.981"/>
</g>
<!-- proc~halo -->
<g id="proc~~get_fields~~CalledByGraph_node31" class="node"><title>proc~halo</title>
<g id="a_proc~~get_fields~~CalledByGraph_node31"><a xlink:href=".././proc/halo.html" xlink:title="halo">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-627.428 124,-627.428 124,-603.428 178,-603.428 178,-627.428"/>
<text text-anchor="middle" x="151" y="-613.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">halo</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~halo -->
<g id="proc~~get_fields~~CalledByGraph_edge72" class="edge"><title>program~fidasim&#45;&gt;proc~halo</title>
<path fill="none" stroke="#000000" d="M33.8933,-522.516C43.3186,-540.647 63.4579,-574.839 90,-594.428 97.1481,-599.704 105.734,-603.738 114.146,-606.79"/>
<polygon fill="#000000" stroke="#000000" points="113.252,-610.18 123.844,-609.937 115.413,-603.522 113.252,-610.18"/>
</g>
<!-- proc~npa_f -->
<g id="proc~~get_fields~~CalledByGraph_node33" class="node"><title>proc~npa_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node33"><a xlink:href=".././proc/npa_f.html" xlink:title="npa_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-231.428 124,-231.428 124,-207.428 178,-207.428 178,-231.428"/>
<text text-anchor="middle" x="151" y="-217.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_f</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_f -->
<g id="proc~~get_fields~~CalledByGraph_edge74" class="edge"><title>program~fidasim&#45;&gt;proc~npa_f</title>
<path fill="none" stroke="#000000" d="M29.3944,-498.231C34.9401,-451.598 56.7579,-285.228 90,-245.428 96.3735,-237.797 105.408,-232.345 114.538,-228.473"/>
<polygon fill="#000000" stroke="#000000" points="115.81,-231.734 123.978,-224.986 113.385,-225.168 115.81,-231.734"/>
</g>
<!-- proc~halo&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge30" class="edge"><title>proc~halo&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M178.203,-623.96C188.789,-627.572 201.065,-631.971 212,-636.428 281.968,-664.944 300.914,-670.056 366,-708.428 387.682,-721.212 410.707,-738.201 427.156,-751.004"/>
<polygon fill="#000000" stroke="#000000" points="425.095,-753.836 435.117,-757.272 429.426,-748.336 425.095,-753.836"/>
</g>
<!-- proc~halo&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge46" class="edge"><title>proc~halo&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.124,-608.304C203.345,-601.425 241.748,-590.952 269.888,-583.277"/>
<polygon fill="#000000" stroke="#000000" points="271.021,-586.596 279.748,-580.588 269.179,-579.843 271.021,-586.596"/>
</g>
<!-- proc~store_nbi_photons&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge31" class="edge"><title>proc~store_nbi_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M350.605,-741.43C366.3,-745.851 384.212,-750.896 400.467,-755.475"/>
<polygon fill="#000000" stroke="#000000" points="399.764,-758.914 410.339,-758.256 401.663,-752.176 399.764,-758.914"/>
</g>
<!-- proc~npa_f&#45;&gt;proc~mc_fastion -->
<g id="proc~~get_fields~~CalledByGraph_edge23" class="edge"><title>proc~npa_f&#45;&gt;proc~mc_fastion</title>
<path fill="none" stroke="#000000" d="M164.342,-231.61C190.925,-257.847 253.79,-319.897 286.087,-351.774"/>
<polygon fill="#000000" stroke="#000000" points="284.023,-354.655 293.599,-359.188 288.941,-349.673 284.023,-354.655"/>
</g>
<!-- proc~npa_f&#45;&gt;proc~store_npa -->
<g id="proc~~get_fields~~CalledByGraph_edge59" class="edge"><title>proc~npa_f&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M178.002,-213.19C189.021,-209.84 201.673,-205.017 212,-198.428 231.343,-186.088 229.198,-174.577 248,-161.428 253.772,-157.392 260.271,-153.752 266.776,-150.562"/>
<polygon fill="#000000" stroke="#000000" points="268.604,-153.574 276.227,-146.216 265.68,-147.214 268.604,-153.574"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/get_fields.html#src">get_fields</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">get_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="n">ind</span><span class="p">,</span><span class="w"> </span><span class="n">input_coords</span><span class="p">,</span><span class="w"> </span><span class="n">output_coords</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="c">!+ Gets electro-magnetic fields at position `pos` or [[libfida:beam_grid]] indices `ind`</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w">                    </span><span class="kd">::</span><span class="w"> </span><span class="n">fields</span><span class="w"></span>
<span class="w">        </span><span class="c">!+ Electro-magnetic fields at `pos`/`ind`</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">pos</span><span class="w"></span>
<span class="w">        </span><span class="c">!+ Position in beam grid coordinates</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ind</span><span class="w"></span>
<span class="w">        </span><span class="c">!+ [[libfida:beam_grid]] indices</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">input_coords</span><span class="w"></span>
<span class="w">        </span><span class="c">!+ Indicates coordinate system of inputs. Beam grid (0), machine (1) and cylindrical (2)</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">output_coords</span><span class="w"></span>
<span class="w">        </span><span class="c">!+ Indicates coordinate system of outputs. Beam grid (0), machine (1) and cylindrical (2)</span>

<span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">inp</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xyz</span><span class="p">,</span><span class="w"> </span><span class="n">uvw</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">uvw_bfield</span><span class="p">,</span><span class="w"> </span><span class="n">uvw_efield</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xyz_bfield</span><span class="p">,</span><span class="w"> </span><span class="n">xyz_efield</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">phi</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">InterpolCoeffs3D</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">coeffs</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">k2</span><span class="p">,</span><span class="w"> </span><span class="n">mc</span><span class="p">,</span><span class="w"> </span><span class="n">ocs</span><span class="p">,</span><span class="w"> </span><span class="n">ics</span><span class="w"></span>

<span class="w">    </span><span class="n">fields</span><span class="p">%</span><span class="n">in_plasma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">False</span><span class="p">.</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">input_coords</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">ics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input_coords</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span>
<span class="k">        </span><span class="n">ics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">    if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">output_coords</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">ocs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">output_coords</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span>
<span class="k">        </span><span class="n">ocs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">    if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">ind</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">get_position</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">xyz</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">        if</span><span class="p">(</span><span class="n">ics</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">xyz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">xyz_to_uvw</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span><span class="w"> </span><span class="n">uvw</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">        if</span><span class="p">(</span><span class="n">ics</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">uvw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">uvw_to_xyz</span><span class="p">(</span><span class="n">uvw</span><span class="p">,</span><span class="w"> </span><span class="n">xyz</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">    endif</span>

<span class="k">    call </span><span class="n">in_plasma</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span><span class="n">inp</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">coeffs</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">i</span><span class="w"></span>
<span class="w">        </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">j</span><span class="w"></span>
<span class="w">        </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">k</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">inter_grid</span><span class="p">%</span><span class="n">nphi</span><span class="w"> </span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">k2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">inter_grid</span><span class="p">%</span><span class="n">nphi</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">else</span>
<span class="k">            </span><span class="n">k2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>

<span class="k">        </span><span class="n">fields</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b111</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b121</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                 </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b112</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k2</span><span class="p">)</span><span class="w">   </span><span class="o">+</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b122</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                 </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b211</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b221</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                 </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b212</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b222</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k2</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">atan2</span><span class="p">(</span><span class="n">uvw</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">uvw</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">        </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="c">!Convert cylindrical coordinates to uvw</span>
<span class="w">        </span><span class="n">uvw_bfield</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">br</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">bt</span><span class="w"></span>
<span class="w">        </span><span class="n">uvw_bfield</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">br</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">bt</span><span class="w"></span>
<span class="w">        </span><span class="n">uvw_bfield</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fields</span><span class="p">%</span><span class="n">bz</span><span class="w"></span>
<span class="w">        </span><span class="n">uvw_efield</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">er</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">et</span><span class="w"></span>
<span class="w">        </span><span class="n">uvw_efield</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">er</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">et</span><span class="w"></span>
<span class="w">        </span><span class="n">uvw_efield</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fields</span><span class="p">%</span><span class="n">ez</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">ocs</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">            </span><span class="c">!Represent fields in beam grid coordinates</span>
<span class="w">            </span><span class="n">xyz_bfield</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">matmul</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">inv_basis</span><span class="p">,</span><span class="n">uvw_bfield</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">xyz_efield</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">matmul</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">inv_basis</span><span class="p">,</span><span class="n">uvw_efield</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">fields</span><span class="p">%</span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xyz</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">        if</span><span class="p">(</span><span class="n">ocs</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">xyz_bfield</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uvw_bfield</span><span class="w"></span>
<span class="w">            </span><span class="n">xyz_efield</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uvw_efield</span><span class="w"></span>
<span class="w">            </span><span class="n">fields</span><span class="p">%</span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uvw</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span><span class="w"></span>

<span class="w">        </span><span class="c">!Calculate field directions and magnitudes</span>
<span class="w">        </span><span class="n">fields</span><span class="p">%</span><span class="n">b_abs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">norm2</span><span class="p">(</span><span class="n">xyz_bfield</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">fields</span><span class="p">%</span><span class="n">e_abs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">norm2</span><span class="p">(</span><span class="n">xyz_efield</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">fields</span><span class="p">%</span><span class="n">b_abs</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">)</span><span class="w"> </span><span class="n">fields</span><span class="p">%</span><span class="n">b_norm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xyz_bfield</span><span class="o">/</span><span class="n">fields</span><span class="p">%</span><span class="n">b_abs</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">fields</span><span class="p">%</span><span class="n">e_abs</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">)</span><span class="w"> </span><span class="n">fields</span><span class="p">%</span><span class="n">e_norm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xyz_efield</span><span class="o">/</span><span class="n">fields</span><span class="p">%</span><span class="n">e_abs</span><span class="w"></span>

<span class="w">        </span><span class="k">call </span><span class="n">calc_perp_vectors</span><span class="p">(</span><span class="n">fields</span><span class="p">%</span><span class="n">b_norm</span><span class="p">,</span><span class="n">fields</span><span class="p">%</span><span class="n">a_norm</span><span class="p">,</span><span class="n">fields</span><span class="p">%</span><span class="n">c_norm</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">fields</span><span class="p">%</span><span class="n">uvw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uvw</span><span class="w"></span>
<span class="w">        </span><span class="n">fields</span><span class="p">%</span><span class="n">in_plasma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">True</span><span class="p">.</span><span class="w"></span>
<span class="w">        </span><span class="n">fields</span><span class="p">%</span><span class="n">coords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ocs</span><span class="w"></span>
<span class="w">        </span><span class="n">fields</span><span class="p">%</span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coeffs</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">end subroutine </span><span class="n">get_fields</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>