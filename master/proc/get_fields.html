<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>get_fields &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
               
        
        
            </ul>
        
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>



          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>get_fields
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.5% of total for procedures.">76 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
    
     <li><a href='../module/libfida.html'>libfida</a></li>
    
  
     <li class="active">get_fields</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/get_fields.html#src">get_fields</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine get_fields(fields, pos, ind, input_coords, output_coords)
    
    
   
</h2>
    
  


    
    <p>Gets electro-magnetic fields at position <code>pos</code> or <a href="../module/libfida.html#variable-beam_grid">beam_grid</a> indices <code>ind</code></p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-fields%7E4"></span>type(<a href='../type/localemfields.html'>LocalEMFields</a>),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>fields</strong></td><td><p>Electro-magnetic fields at <code>pos</code>/<code>ind</code></p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pos%7E9"></span>real(kind=Float64),</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td>dimension(3)</td><td>::</td>
  <td><strong>pos</strong></td><td><p>Position in beam grid coordinates</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ind%7E8"></span>integer(kind=Int32),</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td>dimension(3)</td><td>::</td>
  <td><strong>ind</strong></td><td><p><a href="../module/libfida.html#variable-beam_grid">beam_grid</a> indices</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-input_coords%7E6"></span>integer(kind=Int32),</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>input_coords</strong></td><td><p>Indicates coordinate system of inputs. Beam grid (0), machine (1) and cylindrical (2)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-output_coords%7E2"></span>integer(kind=Int32),</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>output_coords</strong></td><td><p>Indicates coordinate system of outputs. Beam grid (0), machine (1) and cylindrical (2)</p></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~get_fields~~CallsGraph Pages: 1 -->
<svg id="procget_fieldsCallsGraph" width="420pt" height="206pt"
 viewBox="0.00 0.00 420.00 206.22" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~get_fields~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 202.22)">
<title>proc~~get_fields~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-202.22 416,-202.22 416,4 -4,4"/>
<!-- proc~get_fields -->
<g id="proc~~get_fields~~CallsGraph_node1" class="node"><title>proc~get_fields</title>
<polygon fill="none" stroke="black" points="58,-118.22 3.55271e-15,-118.22 3.55271e-15,-94.2196 58,-94.2196 58,-118.22"/>
<text text-anchor="middle" x="29" y="-103.82" font-family="Helvetica,sans-Serif" font-size="10.50">get_fields</text>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~get_fields~~CallsGraph_node2" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~get_fields~~CallsGraph_node2"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="194,-198.22 94,-198.22 94,-174.22 194,-174.22 194,-198.22"/>
<text text-anchor="middle" x="144" y="-183.82" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~get_fields~~CallsGraph_edge1" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M42.5894,-118.247C55.0507,-129.802 74.9692,-147.357 94,-160.22 98.6377,-163.354 103.695,-166.406 108.743,-169.25"/>
<polygon fill="#000000" stroke="#000000" points="107.267,-172.431 117.726,-174.12 110.603,-166.277 107.267,-172.431"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~get_fields~~CallsGraph_node3" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~get_fields~~CallsGraph_node3"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="174.5,-118.22 113.5,-118.22 113.5,-94.2196 174.5,-94.2196 174.5,-118.22"/>
<text text-anchor="middle" x="144" y="-103.82" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~get_fields~~CallsGraph_edge2" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M58.2232,-106.22C71.6895,-106.22 88.0434,-106.22 102.781,-106.22"/>
<polygon fill="#000000" stroke="#000000" points="103.163,-109.72 113.163,-106.22 103.163,-102.72 103.163,-109.72"/>
</g>
<!-- proc~get_position -->
<g id="proc~~get_fields~~CallsGraph_node4" class="node"><title>proc~get_position</title>
<g id="a_proc~~get_fields~~CallsGraph_node4"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="179,-66.2196 109,-66.2196 109,-42.2196 179,-42.2196 179,-66.2196"/>
<text text-anchor="middle" x="144" y="-51.8196" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~get_fields~~CallsGraph_edge3" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M56.2085,-94.1591C71.3599,-87.1868 90.6375,-78.3157 107.174,-70.7058"/>
<polygon fill="#000000" stroke="#000000" points="108.921,-73.7549 116.542,-66.3949 105.995,-67.3959 108.921,-73.7549"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_node5" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~get_fields~~CallsGraph_node5"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-168.22 235,-168.22 235,-144.22 303,-144.22 303,-168.22"/>
<text text-anchor="middle" x="269" y="-153.82" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_edge4" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M58.087,-116.459C69.1674,-120.228 82.0765,-124.288 94,-127.22 138.12,-138.068 189.539,-146.082 224.98,-150.904"/>
<polygon fill="#000000" stroke="#000000" points="224.612,-154.385 234.986,-152.238 225.537,-147.447 224.612,-154.385"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~get_fields~~CallsGraph_node6" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~get_fields~~CallsGraph_node6"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="412,-26.2196 344,-26.2196 344,-2.21965 412,-2.21965 412,-26.2196"/>
<text text-anchor="middle" x="378" y="-11.8196" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~get_fields~~CallsGraph_edge5" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M36.8651,-94.0134C47.0016,-77.253 67.65,-47.5636 94,-33.2196 170.092,8.20196 275.26,1.66339 333.6,-6.47796"/>
<polygon fill="#000000" stroke="#000000" points="333.182,-9.95405 343.586,-7.95171 334.204,-3.02906 333.182,-9.95405"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_edge6" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M174.775,-118.323C190.972,-124.907 211.212,-133.135 228.69,-140.24"/>
<polygon fill="#000000" stroke="#000000" points="227.491,-143.531 238.073,-144.054 230.127,-137.046 227.491,-143.531"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_node8" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~get_fields~~CallsGraph_node8"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="410.5,-98.2196 345.5,-98.2196 345.5,-74.2196 410.5,-74.2196 410.5,-98.2196"/>
<text text-anchor="middle" x="378" y="-83.8196" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_edge7" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M174.52,-105.503C207.229,-104.497 261.502,-102.196 308,-97.2196 316.939,-96.2629 326.485,-94.9383 335.537,-93.5389"/>
<polygon fill="#000000" stroke="#000000" points="336.17,-96.9823 345.489,-91.9429 335.061,-90.0706 336.17,-96.9823"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~get_fields~~CallsGraph_node9" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~get_fields~~CallsGraph_node9"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="307.5,-88.2196 230.5,-88.2196 230.5,-64.2196 307.5,-64.2196 307.5,-88.2196"/>
<text text-anchor="middle" x="269" y="-73.8196" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~get_fields~~CallsGraph_edge8" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M174.775,-98.9575C188.422,-95.6288 204.94,-91.6001 220.258,-87.8641"/>
<polygon fill="#000000" stroke="#000000" points="221.222,-91.2315 230.108,-85.4616 219.563,-84.4309 221.222,-91.2315"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~get_fields~~CallsGraph_node7" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~get_fields~~CallsGraph_node7"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="300,-46.2196 238,-46.2196 238,-22.2196 300,-22.2196 300,-46.2196"/>
<text text-anchor="middle" x="269" y="-31.8196" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~get_fields~~CallsGraph_edge9" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M179.262,-48.6485C194.306,-46.2023 212.076,-43.313 227.746,-40.7649"/>
<polygon fill="#000000" stroke="#000000" points="228.383,-44.2075 237.692,-39.1478 227.26,-37.2982 228.383,-44.2075"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~get_fields~~CallsGraph_edge11" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M300.09,-28.5953C310.502,-26.6492 322.387,-24.4278 333.649,-22.3227"/>
<polygon fill="#000000" stroke="#000000" points="334.57,-25.7113 343.756,-20.4334 333.283,-18.8304 334.57,-25.7113"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_edge10" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M294.817,-46.2802C309.03,-53.1874 327.077,-61.958 342.637,-69.5198"/>
<polygon fill="#000000" stroke="#000000" points="341.423,-72.8213 351.947,-74.0444 344.483,-66.5254 341.423,-72.8213"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~get_fields~~CalledByGraph Pages: 1 -->
<svg id="procget_fieldsCalledByGraph" width="602pt" height="1051pt"
 viewBox="0.00 0.00 602.00 1051.23" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~get_fields~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 1047.23)">
<title>proc~~get_fields~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1047.23 598,-1047.23 598,4 -4,4"/>
<!-- proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_node1" class="node"><title>proc~get_fields</title>
<polygon fill="none" stroke="black" points="594,-677.649 536,-677.649 536,-653.649 594,-653.649 594,-677.649"/>
<text text-anchor="middle" x="565" y="-663.249" font-family="Helvetica,sans-Serif" font-size="10.50">get_fields</text>
</g>
<!-- proc~npa_mc -->
<g id="proc~~get_fields~~CalledByGraph_node2" class="node"><title>proc~npa_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node2"><a xlink:href=".././proc/npa_mc.html" xlink:title="npa_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-920.649 124,-920.649 124,-896.649 178,-896.649 178,-920.649"/>
<text text-anchor="middle" x="151" y="-906.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_mc</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge1" class="edge"><title>proc~npa_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M178.098,-918.078C241.012,-938.982 402.995,-981.7 500,-906.649 534.995,-879.573 554.91,-742.074 561.514,-687.762"/>
<polygon fill="#000000" stroke="#000000" points="564.996,-688.126 562.69,-677.785 558.044,-687.306 564.996,-688.126"/>
</g>
<!-- proc~store_npa -->
<g id="proc~~get_fields~~CalledByGraph_node12" class="node"><title>proc~store_npa</title>
<g id="a_proc~~get_fields~~CalledByGraph_node12"><a xlink:href=".././proc/store_npa.html" xlink:title="store_npa">
<polygon fill="#d9534f" stroke="#d9534f" points="337.5,-761.649 276.5,-761.649 276.5,-737.649 337.5,-737.649 337.5,-761.649"/>
<text text-anchor="middle" x="307" y="-747.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_npa</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~store_npa -->
<g id="proc~~get_fields~~CalledByGraph_edge34" class="edge"><title>proc~npa_mc&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M178.289,-903.335C189.486,-900.136 202.196,-895.176 212,-887.649 253.11,-856.088 282.647,-801.301 296.724,-771.123"/>
<polygon fill="#000000" stroke="#000000" points="299.963,-772.455 300.9,-761.902 293.587,-769.568 299.963,-772.455"/>
</g>
<!-- proc~fida_weights_mc -->
<g id="proc~~get_fields~~CalledByGraph_node3" class="node"><title>proc~fida_weights_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node3"><a xlink:href=".././proc/fida_weights_mc.html" xlink:title="fida_weights_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="197,-878.649 105,-878.649 105,-854.649 197,-854.649 197,-878.649"/>
<text text-anchor="middle" x="151" y="-864.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_weights_mc</text>
</a>
</g>
</g>
<!-- proc~fida_weights_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge3" class="edge"><title>proc~fida_weights_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M197.012,-875.868C280.115,-891.797 453.408,-919.574 500,-884.649 531.965,-860.689 553.289,-738.535 560.898,-687.794"/>
<polygon fill="#000000" stroke="#000000" points="564.369,-688.245 562.35,-677.845 557.442,-687.234 564.369,-688.245"/>
</g>
<!-- proc~store_fw_photons -->
<g id="proc~~get_fields~~CalledByGraph_node8" class="node"><title>proc~store_fw_photons</title>
<g id="a_proc~~get_fields~~CalledByGraph_node8"><a xlink:href=".././proc/store_fw_photons.html" xlink:title="store_fw_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="499.5,-875.649 402.5,-875.649 402.5,-851.649 499.5,-851.649 499.5,-875.649"/>
<text text-anchor="middle" x="451" y="-861.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_fw_photons</text>
</a>
</g>
</g>
<!-- proc~fida_weights_mc&#45;&gt;proc~store_fw_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge27" class="edge"><title>proc~fida_weights_mc&#45;&gt;proc~store_fw_photons</title>
<path fill="none" stroke="#000000" d="M197.26,-866.193C249.375,-865.669 335.105,-864.806 392.054,-864.232"/>
<polygon fill="#000000" stroke="#000000" points="392.374,-867.729 402.338,-864.129 392.303,-860.73 392.374,-867.729"/>
</g>
<!-- proc~track -->
<g id="proc~~get_fields~~CalledByGraph_node13" class="node"><title>proc~track</title>
<g id="a_proc~~get_fields~~CalledByGraph_node13"><a xlink:href=".././proc/track.html" xlink:title="track">
<polygon fill="#d9534f" stroke="#d9534f" points="334,-437.649 280,-437.649 280,-413.649 334,-413.649 334,-437.649"/>
<text text-anchor="middle" x="307" y="-423.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track</text>
</a>
</g>
</g>
<!-- proc~fida_weights_mc&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge37" class="edge"><title>proc~fida_weights_mc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M162.213,-854.647C175.968,-837.768 200.092,-805.506 212,-773.649 251.459,-668.085 210.345,-628.869 248,-522.649 258.131,-494.071 277.164,-464.651 290.661,-445.818"/>
<polygon fill="#000000" stroke="#000000" points="293.513,-447.847 296.6,-437.712 287.866,-443.71 293.513,-447.847"/>
</g>
<!-- proc~neutron_mc -->
<g id="proc~~get_fields~~CalledByGraph_node4" class="node"><title>proc~neutron_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node4"><a xlink:href=".././proc/neutron_mc.html" xlink:title="neutron_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="486,-1035.65 416,-1035.65 416,-1011.65 486,-1011.65 486,-1035.65"/>
<text text-anchor="middle" x="451" y="-1021.25" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutron_mc</text>
</a>
</g>
</g>
<!-- proc~neutron_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge2" class="edge"><title>proc~neutron_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M486.376,-1013.61C491.557,-1010.79 496.371,-1007.2 500,-1002.65 539.304,-953.347 557.375,-755.038 562.447,-687.955"/>
<polygon fill="#000000" stroke="#000000" points="565.96,-687.913 563.199,-677.685 558.978,-687.403 565.96,-687.913"/>
</g>
<!-- proc~pfida_mc -->
<g id="proc~~get_fields~~CalledByGraph_node5" class="node"><title>proc~pfida_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node5"><a xlink:href=".././proc/pfida_mc.html" xlink:title="pfida_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="179,-596.649 123,-596.649 123,-572.649 179,-572.649 179,-596.649"/>
<text text-anchor="middle" x="151" y="-582.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pfida_mc</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge4" class="edge"><title>proc~pfida_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M179.194,-585.564C220.004,-587.246 299.407,-591.718 366,-602.649 426.525,-612.583 442.174,-615.2 500,-635.649 510.608,-639.4 521.828,-644.313 531.86,-649.074"/>
<polygon fill="#000000" stroke="#000000" points="530.533,-652.321 541.056,-653.55 533.596,-646.026 530.533,-652.321"/>
</g>
<!-- proc~track_cylindrical -->
<g id="proc~~get_fields~~CalledByGraph_node10" class="node"><title>proc~track_cylindrical</title>
<g id="a_proc~~get_fields~~CalledByGraph_node10"><a xlink:href=".././proc/track_cylindrical.html" xlink:title="track_cylindrical">
<polygon fill="#d9534f" stroke="#d9534f" points="351,-635.649 263,-635.649 263,-611.649 351,-611.649 351,-635.649"/>
<text text-anchor="middle" x="307" y="-621.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track_cylindrical</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~track_cylindrical -->
<g id="proc~~get_fields~~CalledByGraph_edge30" class="edge"><title>proc~pfida_mc&#45;&gt;proc~track_cylindrical</title>
<path fill="none" stroke="#000000" d="M179.178,-591.532C199.517,-596.682 227.983,-603.891 252.795,-610.175"/>
<polygon fill="#000000" stroke="#000000" points="252.258,-613.649 262.811,-612.711 253.976,-606.864 252.258,-613.649"/>
</g>
<!-- proc~store_fida_photons -->
<g id="proc~~get_fields~~CalledByGraph_node31" class="node"><title>proc~store_fida_photons</title>
<g id="a_proc~~get_fields~~CalledByGraph_node31"><a xlink:href=".././proc/store_fida_photons.html" xlink:title="store_fida_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="359,-555.649 255,-555.649 255,-531.649 359,-531.649 359,-555.649"/>
<text text-anchor="middle" x="307" y="-541.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_fida_photons</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge72" class="edge"><title>proc~pfida_mc&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M179.178,-577.413C198.985,-572.14 226.502,-564.814 250.843,-558.333"/>
<polygon fill="#000000" stroke="#000000" points="251.932,-561.666 260.695,-555.711 250.131,-554.901 251.932,-561.666"/>
</g>
<!-- proc~npa_weights -->
<g id="proc~~get_fields~~CalledByGraph_node6" class="node"><title>proc~npa_weights</title>
<g id="a_proc~~get_fields~~CalledByGraph_node6"><a xlink:href=".././proc/npa_weights.html" xlink:title="npa_weights">
<polygon fill="#d9534f" stroke="#d9534f" points="487.5,-993.649 414.5,-993.649 414.5,-969.649 487.5,-969.649 487.5,-993.649"/>
<text text-anchor="middle" x="451" y="-979.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_weights</text>
</a>
</g>
</g>
<!-- proc~npa_weights&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge5" class="edge"><title>proc~npa_weights&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M483.887,-969.403C489.988,-965.785 495.779,-961.25 500,-955.649 532.279,-912.815 554.362,-748.065 561.503,-687.851"/>
<polygon fill="#000000" stroke="#000000" points="564.984,-688.214 562.661,-677.877 558.031,-687.407 564.984,-688.214"/>
</g>
<!-- proc~mc_fastion -->
<g id="proc~~get_fields~~CalledByGraph_node7" class="node"><title>proc~mc_fastion</title>
<g id="a_proc~~get_fields~~CalledByGraph_node7"><a xlink:href=".././proc/mc_fastion.html" xlink:title="mc_fastion">
<polygon fill="#d9534f" stroke="#d9534f" points="339,-677.649 275,-677.649 275,-653.649 339,-653.649 339,-677.649"/>
<text text-anchor="middle" x="307" y="-663.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_fastion</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge6" class="edge"><title>proc~mc_fastion&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M339.135,-665.649C386.034,-665.649 474.716,-665.649 525.572,-665.649"/>
<polygon fill="#000000" stroke="#000000" points="525.822,-669.149 535.822,-665.649 525.822,-662.149 525.822,-669.149"/>
</g>
<!-- proc~store_fw_photons&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge7" class="edge"><title>proc~store_fw_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M488.704,-851.473C492.866,-849.017 496.767,-846.101 500,-842.649 541.498,-798.341 556.471,-725.125 561.563,-688.293"/>
<polygon fill="#000000" stroke="#000000" points="565.069,-688.462 562.844,-678.103 558.124,-687.588 565.069,-688.462"/>
</g>
<!-- proc~cfpd_f -->
<g id="proc~~get_fields~~CalledByGraph_node9" class="node"><title>proc~cfpd_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node9"><a xlink:href=".././proc/cfpd_f.html" xlink:title="cfpd_f">
<polygon fill="#d9534f" stroke="#d9534f" points="478,-833.649 424,-833.649 424,-809.649 478,-809.649 478,-833.649"/>
<text text-anchor="middle" x="451" y="-819.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cfpd_f</text>
</a>
</g>
</g>
<!-- proc~cfpd_f&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge8" class="edge"><title>proc~cfpd_f&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M478.416,-811.046C486.057,-807.058 493.956,-801.933 500,-795.649 530.307,-764.137 548.961,-715.495 557.816,-687.506"/>
<polygon fill="#000000" stroke="#000000" points="561.186,-688.454 560.734,-677.868 554.486,-686.425 561.186,-688.454"/>
</g>
<!-- proc~track_cylindrical&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge9" class="edge"><title>proc~track_cylindrical&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M351.137,-630.726C400.021,-638.746 478.96,-651.697 525.733,-659.371"/>
<polygon fill="#000000" stroke="#000000" points="525.331,-662.852 535.766,-661.017 526.465,-655.944 525.331,-662.852"/>
</g>
<!-- proc~fida_mc -->
<g id="proc~~get_fields~~CalledByGraph_node11" class="node"><title>proc~fida_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node11"><a xlink:href=".././proc/fida_mc.html" xlink:title="fida_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-470.649 124,-470.649 124,-446.649 178,-446.649 178,-470.649"/>
<text text-anchor="middle" x="151" y="-456.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_mc</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge10" class="edge"><title>proc~fida_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M178.152,-456.762C241.184,-453.658 403.411,-454.462 500,-534.649 534.193,-563.036 551.588,-614.102 559.143,-643.388"/>
<polygon fill="#000000" stroke="#000000" points="555.823,-644.552 561.571,-653.453 562.628,-642.911 555.823,-644.552"/>
</g>
<!-- proc~fida_mc&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge40" class="edge"><title>proc~fida_mc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.124,-453.051C203.345,-447.646 241.748,-439.417 269.888,-433.387"/>
<polygon fill="#000000" stroke="#000000" points="270.703,-436.792 279.748,-431.274 269.236,-429.947 270.703,-436.792"/>
</g>
<!-- proc~fida_mc&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge69" class="edge"><title>proc~fida_mc&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M178.007,-466.11C188.788,-469.619 201.26,-474.231 212,-479.649 237.449,-492.487 264.091,-511.2 282.485,-525.079"/>
<polygon fill="#000000" stroke="#000000" points="280.745,-528.154 290.812,-531.456 285.001,-522.597 280.745,-528.154"/>
</g>
<!-- proc~store_npa&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge19" class="edge"><title>proc~store_npa&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M337.665,-744.476C376.015,-737.252 444.464,-722.519 500,-700.649 512.336,-695.791 525.285,-689.053 536.283,-682.785"/>
<polygon fill="#000000" stroke="#000000" points="538.142,-685.753 545.006,-677.683 534.607,-679.711 538.142,-685.753"/>
</g>
<!-- proc~track&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge12" class="edge"><title>proc~track&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M334.187,-421.072C374.778,-415.57 453.086,-411.536 500,-451.649 557.481,-500.796 564.526,-599.258 564.62,-643.374"/>
<polygon fill="#000000" stroke="#000000" points="561.118,-643.556 564.516,-653.591 568.118,-643.628 561.118,-643.556"/>
</g>
<!-- proc~pnpa_mc -->
<g id="proc~~get_fields~~CalledByGraph_node14" class="node"><title>proc~pnpa_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node14"><a xlink:href=".././proc/pnpa_mc.html" xlink:title="pnpa_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="179.5,-764.649 122.5,-764.649 122.5,-740.649 179.5,-740.649 179.5,-764.649"/>
<text text-anchor="middle" x="151" y="-750.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pnpa_mc</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge13" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M179.535,-759.216C198.623,-763.422 224.7,-768.483 248,-770.649 300.219,-775.502 314.159,-778.583 366,-770.649 427.694,-761.207 446.489,-760.771 500,-728.649 518.598,-717.485 535.883,-699.848 547.79,-686.072"/>
<polygon fill="#000000" stroke="#000000" points="550.74,-688.001 554.473,-678.085 545.371,-683.509 550.74,-688.001"/>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~store_npa -->
<g id="proc~~get_fields~~CalledByGraph_edge35" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M179.532,-752.113C203.591,-751.644 238.823,-750.958 265.994,-750.428"/>
<polygon fill="#000000" stroke="#000000" points="266.413,-753.921 276.343,-750.227 266.277,-746.922 266.413,-753.921"/>
</g>
<!-- proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_node15" class="node"><title>proc~store_photons</title>
<g id="a_proc~~get_fields~~CalledByGraph_node15"><a xlink:href=".././proc/store_photons.html" xlink:title="store_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="491.5,-241.649 410.5,-241.649 410.5,-217.649 491.5,-217.649 491.5,-241.649"/>
<text text-anchor="middle" x="451" y="-227.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_photons</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge14" class="edge"><title>proc~store_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M458.763,-241.746C469.113,-260.749 488.849,-299.008 500,-333.649 536.523,-447.11 555.372,-589.457 561.607,-643.481"/>
<polygon fill="#000000" stroke="#000000" points="558.152,-644.08 562.747,-653.627 565.108,-643.298 558.152,-644.08"/>
</g>
<!-- proc~make_diagnostic_grids -->
<g id="proc~~get_fields~~CalledByGraph_node16" class="node"><title>proc~make_diagnostic_grids</title>
<g id="a_proc~~get_fields~~CalledByGraph_node16"><a xlink:href=".././proc/make_diagnostic_grids.html" xlink:title="make_diagnostic_grids">
<polygon fill="#d9534f" stroke="#d9534f" points="212,-512.649 90,-512.649 90,-488.649 212,-488.649 212,-512.649"/>
<text text-anchor="middle" x="151" y="-498.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">make_diagnostic_grids</text>
</a>
</g>
</g>
<!-- proc~make_diagnostic_grids&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge15" class="edge"><title>proc~make_diagnostic_grids&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M212.087,-499.764C255.832,-500.797 315.932,-505.734 366,-522.649 441.497,-548.155 512.854,-613.278 545.463,-646.106"/>
<polygon fill="#000000" stroke="#000000" points="543.045,-648.64 552.54,-653.342 548.05,-643.745 543.045,-648.64"/>
</g>
<!-- proc~make_diagnostic_grids&#45;&gt;proc~track_cylindrical -->
<g id="proc~~get_fields~~CalledByGraph_edge31" class="edge"><title>proc~make_diagnostic_grids&#45;&gt;proc~track_cylindrical</title>
<path fill="none" stroke="#000000" d="M195.65,-512.771C201.392,-515.257 207.008,-518.195 212,-521.649 232.497,-535.83 231.25,-546.191 248,-564.649 260.235,-578.131 274.572,-592.726 285.931,-604.027"/>
<polygon fill="#000000" stroke="#000000" points="283.685,-606.728 293.257,-611.27 288.607,-601.75 283.685,-606.728"/>
</g>
<!-- proc~make_diagnostic_grids&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge42" class="edge"><title>proc~make_diagnostic_grids&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M189.869,-488.59C197.305,-485.889 204.975,-482.863 212,-479.649 235.279,-468.999 260.358,-454.422 278.751,-443.097"/>
<polygon fill="#000000" stroke="#000000" points="280.825,-445.929 287.461,-437.67 277.123,-439.988 280.825,-445.929"/>
</g>
<!-- proc~mc_fastion_pass_grid -->
<g id="proc~~get_fields~~CalledByGraph_node17" class="node"><title>proc~mc_fastion_pass_grid</title>
<g id="a_proc~~get_fields~~CalledByGraph_node17"><a xlink:href=".././proc/mc_fastion_pass_grid.html" xlink:title="mc_fastion_pass_grid">
<polygon fill="#d9534f" stroke="#d9534f" points="365.5,-719.649 248.5,-719.649 248.5,-695.649 365.5,-695.649 365.5,-719.649"/>
<text text-anchor="middle" x="307" y="-705.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_fastion_pass_grid</text>
</a>
</g>
</g>
<!-- proc~mc_fastion_pass_grid&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge16" class="edge"><title>proc~mc_fastion_pass_grid&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M365.724,-700.312C403.935,-695.19 455.094,-687.824 500,-679.649 508.353,-678.128 517.277,-676.304 525.727,-674.482"/>
<polygon fill="#000000" stroke="#000000" points="526.716,-677.849 535.731,-672.283 525.213,-671.012 526.716,-677.849"/>
</g>
<!-- proc~ndmc -->
<g id="proc~~get_fields~~CalledByGraph_node18" class="node"><title>proc~ndmc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node18"><a xlink:href=".././proc/ndmc.html" xlink:title="ndmc">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-386.649 124,-386.649 124,-362.649 178,-362.649 178,-386.649"/>
<text text-anchor="middle" x="151" y="-372.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ndmc</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge17" class="edge"><title>proc~ndmc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M178.41,-366.033C242.014,-347.09 405.417,-309.438 500,-387.649 539.622,-420.412 557.071,-582.885 562.252,-643.125"/>
<polygon fill="#000000" stroke="#000000" points="558.792,-643.758 563.103,-653.436 565.768,-643.182 558.792,-643.758"/>
</g>
<!-- proc~ndmc&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge43" class="edge"><title>proc~ndmc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.124,-383.3C203.345,-391.653 241.748,-404.371 269.888,-413.69"/>
<polygon fill="#000000" stroke="#000000" points="269.155,-417.134 279.748,-416.955 271.355,-410.489 269.155,-417.134"/>
</g>
<!-- proc~store_nbi_photons -->
<g id="proc~~get_fields~~CalledByGraph_node25" class="node"><title>proc~store_nbi_photons</title>
<g id="a_proc~~get_fields~~CalledByGraph_node25"><a xlink:href=".././proc/store_nbi_photons.html" xlink:title="store_nbi_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="357.5,-319.649 256.5,-319.649 256.5,-295.649 357.5,-295.649 357.5,-319.649"/>
<text text-anchor="middle" x="307" y="-305.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_nbi_photons</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~store_nbi_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge64" class="edge"><title>proc~ndmc&#45;&gt;proc~store_nbi_photons</title>
<path fill="none" stroke="#000000" d="M178.071,-366.602C188.748,-363.03 201.126,-358.53 212,-353.649 228.698,-346.154 231.634,-341.844 248,-333.649 254.58,-330.354 261.668,-327.011 268.552,-323.869"/>
<polygon fill="#000000" stroke="#000000" points="270.063,-327.027 277.747,-319.733 267.191,-320.644 270.063,-327.027"/>
</g>
<!-- proc~fida_weights_los -->
<g id="proc~~get_fields~~CalledByGraph_node19" class="node"><title>proc~fida_weights_los</title>
<g id="a_proc~~get_fields~~CalledByGraph_node19"><a xlink:href=".././proc/fida_weights_los.html" xlink:title="fida_weights_los">
<polygon fill="#d9534f" stroke="#d9534f" points="196.5,-428.649 105.5,-428.649 105.5,-404.649 196.5,-404.649 196.5,-428.649"/>
<text text-anchor="middle" x="151" y="-414.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_weights_los</text>
</a>
</g>
</g>
<!-- proc~fida_weights_los&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge18" class="edge"><title>proc~fida_weights_los&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M196.715,-409.413C280.157,-396.986 455.203,-376.331 500,-413.649 535.603,-443.308 555.264,-587.482 561.654,-643.412"/>
<polygon fill="#000000" stroke="#000000" points="558.176,-643.807 562.756,-653.361 565.134,-643.036 558.176,-643.807"/>
</g>
<!-- proc~fida_weights_los&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge44" class="edge"><title>proc~fida_weights_los&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M196.543,-419.252C219.751,-420.608 247.773,-422.246 269.654,-423.525"/>
<polygon fill="#000000" stroke="#000000" points="269.667,-427.031 279.854,-424.121 270.075,-420.043 269.667,-427.031"/>
</g>
<!-- proc~neutron_f -->
<g id="proc~~get_fields~~CalledByGraph_node20" class="node"><title>proc~neutron_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node20"><a xlink:href=".././proc/neutron_f.html" xlink:title="neutron_f">
<polygon fill="#d9534f" stroke="#d9534f" points="480,-117.649 422,-117.649 422,-93.6489 480,-93.6489 480,-117.649"/>
<text text-anchor="middle" x="451" y="-103.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutron_f</text>
</a>
</g>
</g>
<!-- proc~neutron_f&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge11" class="edge"><title>proc~neutron_f&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M459.16,-117.862C469.851,-136.684 489.815,-174.218 500,-208.649 547.907,-370.597 560.313,-575.713 563.2,-643.09"/>
<polygon fill="#000000" stroke="#000000" points="559.714,-643.513 563.61,-653.365 566.708,-643.233 559.714,-643.513"/>
</g>
<!-- proc~fida_f -->
<g id="proc~~get_fields~~CalledByGraph_node21" class="node"><title>proc~fida_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node21"><a xlink:href=".././proc/fida_f.html" xlink:title="fida_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-554.649 124,-554.649 124,-530.649 178,-530.649 178,-554.649"/>
<text text-anchor="middle" x="151" y="-540.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_f</text>
</a>
</g>
</g>
<!-- proc~fida_f&#45;&gt;proc~mc_fastion -->
<g id="proc~~get_fields~~CalledByGraph_edge26" class="edge"><title>proc~fida_f&#45;&gt;proc~mc_fastion</title>
<path fill="none" stroke="#000000" d="M178.061,-546.915C189.612,-549.936 202.667,-555.048 212,-563.649 240.969,-590.347 219.174,-617.796 248,-644.649 253.002,-649.308 259.115,-652.949 265.474,-655.791"/>
<polygon fill="#000000" stroke="#000000" points="264.277,-659.08 274.867,-659.407 266.792,-652.548 264.277,-659.08"/>
</g>
<!-- proc~fida_f&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge38" class="edge"><title>proc~fida_f&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.29,-536.304C189.237,-532.955 201.755,-528.162 212,-521.649 244.353,-501.08 273.909,-467.353 290.924,-445.841"/>
<polygon fill="#000000" stroke="#000000" points="293.863,-447.761 297.217,-437.711 288.328,-443.476 293.863,-447.761"/>
</g>
<!-- proc~fida_f&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge70" class="edge"><title>proc~fida_f&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M178.124,-542.819C196.364,-542.937 221.497,-543.1 244.657,-543.251"/>
<polygon fill="#000000" stroke="#000000" points="244.758,-546.751 254.78,-543.316 244.803,-539.751 244.758,-546.751"/>
</g>
<!-- proc~pnpa_f -->
<g id="proc~~get_fields~~CalledByGraph_node22" class="node"><title>proc~pnpa_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node22"><a xlink:href=".././proc/pnpa_f.html" xlink:title="pnpa_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-722.649 124,-722.649 124,-698.649 178,-698.649 178,-722.649"/>
<text text-anchor="middle" x="151" y="-708.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pnpa_f</text>
</a>
</g>
</g>
<!-- proc~pnpa_f&#45;&gt;proc~store_npa -->
<g id="proc~~get_fields~~CalledByGraph_edge36" class="edge"><title>proc~pnpa_f&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M178.124,-717.265C202.352,-723.4 238.743,-732.616 266.516,-739.65"/>
<polygon fill="#000000" stroke="#000000" points="265.767,-743.07 276.32,-742.133 267.485,-736.285 265.767,-743.07"/>
</g>
<!-- proc~pnpa_f&#45;&gt;proc~mc_fastion_pass_grid -->
<g id="proc~~get_fields~~CalledByGraph_edge56" class="edge"><title>proc~pnpa_f&#45;&gt;proc~mc_fastion_pass_grid</title>
<path fill="none" stroke="#000000" d="M178.124,-710.14C194.718,-709.817 217.019,-709.382 238.348,-708.967"/>
<polygon fill="#000000" stroke="#000000" points="238.452,-712.466 248.382,-708.771 238.316,-705.467 238.452,-712.466"/>
</g>
<!-- proc~dcx -->
<g id="proc~~get_fields~~CalledByGraph_node23" class="node"><title>proc~dcx</title>
<g id="a_proc~~get_fields~~CalledByGraph_node23"><a xlink:href=".././proc/dcx.html" xlink:title="dcx">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-344.649 124,-344.649 124,-320.649 178,-320.649 178,-344.649"/>
<text text-anchor="middle" x="151" y="-330.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dcx</text>
</a>
</g>
</g>
<!-- proc~dcx&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge39" class="edge"><title>proc~dcx&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.16,-339.815C188.967,-343.277 201.415,-347.933 212,-353.649 239.293,-368.388 267.068,-390.766 285.276,-406.657"/>
<polygon fill="#000000" stroke="#000000" points="283.13,-409.431 292.932,-413.451 287.776,-404.196 283.13,-409.431"/>
</g>
<!-- proc~dcx&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge46" class="edge"><title>proc~dcx&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M178.031,-325.237C188.817,-321.735 201.285,-317.117 212,-311.649 229.351,-302.795 230.374,-294.943 248,-286.649 297.273,-263.461 313.597,-268.462 366,-253.649 377.175,-250.49 389.18,-247.073 400.519,-243.836"/>
<polygon fill="#000000" stroke="#000000" points="401.621,-247.162 410.274,-241.048 399.697,-240.431 401.621,-247.162"/>
</g>
<!-- proc~npa_f -->
<g id="proc~~get_fields~~CalledByGraph_node24" class="node"><title>proc~npa_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node24"><a xlink:href=".././proc/npa_f.html" xlink:title="npa_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-680.649 124,-680.649 124,-656.649 178,-656.649 178,-680.649"/>
<text text-anchor="middle" x="151" y="-666.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_f</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~mc_fastion -->
<g id="proc~~get_fields~~CalledByGraph_edge25" class="edge"><title>proc~npa_f&#45;&gt;proc~mc_fastion</title>
<path fill="none" stroke="#000000" d="M178.124,-668.14C201.865,-667.677 237.286,-666.987 264.832,-666.451"/>
<polygon fill="#000000" stroke="#000000" points="265.033,-669.948 274.963,-666.253 264.897,-662.949 265.033,-669.948"/>
</g>
<!-- proc~npa_f&#45;&gt;proc~store_npa -->
<g id="proc~~get_fields~~CalledByGraph_edge33" class="edge"><title>proc~npa_f&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M178.086,-674.757C189.12,-678.084 201.76,-682.925 212,-689.649 231.718,-702.596 228.352,-715.596 248,-728.649 253.754,-732.471 260.29,-735.7 266.849,-738.393"/>
<polygon fill="#000000" stroke="#000000" points="265.794,-741.735 276.387,-741.96 268.246,-735.179 265.794,-741.735"/>
</g>
<!-- proc~store_nbi_photons&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge47" class="edge"><title>proc~store_nbi_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M336.979,-295.564C346.365,-291.41 356.74,-286.563 366,-281.649 385.814,-271.135 407.306,-257.792 423.59,-247.255"/>
<polygon fill="#000000" stroke="#000000" points="425.599,-250.124 432.058,-241.725 421.771,-244.263 425.599,-250.124"/>
</g>
<!-- program~fidasim -->
<g id="proc~~get_fields~~CalledByGraph_node26" class="node"><title>program~fidasim</title>
<g id="a_proc~~get_fields~~CalledByGraph_node26"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-533.649 0,-533.649 0,-509.649 54,-509.649 54,-533.649"/>
<text text-anchor="middle" x="27" y="-519.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge20" class="edge"><title>program~fidasim&#45;&gt;proc~npa_mc</title>
<path fill="none" stroke="#000000" d="M28.4502,-534.012C30.7815,-591.503 43.239,-832.241 90,-887.649 96.1681,-894.958 105.035,-899.725 114.068,-902.833"/>
<polygon fill="#000000" stroke="#000000" points="113.238,-906.236 123.814,-905.597 115.148,-899.501 113.238,-906.236"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_weights_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge21" class="edge"><title>program~fidasim&#45;&gt;proc~fida_weights_mc</title>
<path fill="none" stroke="#000000" d="M28.8608,-533.74C32.7951,-585.948 50.5954,-791.613 90,-840.649 92.5667,-843.843 95.6024,-846.653 98.9237,-849.124"/>
<polygon fill="#000000" stroke="#000000" points="97.3302,-852.256 107.664,-854.594 101.044,-846.322 97.3302,-852.256"/>
</g>
<!-- program~fidasim&#45;&gt;proc~neutron_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge22" class="edge"><title>program~fidasim&#45;&gt;proc~neutron_mc</title>
<path fill="none" stroke="#000000" d="M27.8558,-533.885C27.3438,-599.325 28.2756,-907.473 90,-973.649 171.287,-1060.8 328.578,-1046.57 405.484,-1033.12"/>
<polygon fill="#000000" stroke="#000000" points="406.578,-1036.47 415.786,-1031.23 405.319,-1029.59 406.578,-1036.47"/>
</g>
<!-- program~fidasim&#45;&gt;proc~pfida_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge23" class="edge"><title>program~fidasim&#45;&gt;proc~pfida_mc</title>
<path fill="none" stroke="#000000" d="M43.6139,-533.901C55.7484,-542.999 73.2749,-555.236 90,-563.649 97.2789,-567.31 105.35,-570.606 113.15,-573.443"/>
<polygon fill="#000000" stroke="#000000" points="112.211,-576.822 122.806,-576.784 114.5,-570.207 112.211,-576.822"/>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_weights -->
<g id="proc~~get_fields~~CalledByGraph_edge24" class="edge"><title>program~fidasim&#45;&gt;proc~npa_weights</title>
<path fill="none" stroke="#000000" d="M28.0134,-533.936C28.3444,-595.703 33.0317,-871.62 90,-929.649 172.814,-1014 327.007,-1002.8 403.91,-990.68"/>
<polygon fill="#000000" stroke="#000000" points="404.937,-994.057 414.233,-988.974 403.796,-987.151 404.937,-994.057"/>
</g>
<!-- program~fidasim&#45;&gt;proc~cfpd_f -->
<g id="proc~~get_fields~~CalledByGraph_edge28" class="edge"><title>program~fidasim&#45;&gt;proc~cfpd_f</title>
<path fill="none" stroke="#000000" d="M29.2093,-533.855C34.0099,-579.707 53.2716,-740.71 90,-773.649 181.495,-855.703 342.358,-840.634 413.918,-828.77"/>
<polygon fill="#000000" stroke="#000000" points="414.554,-832.212 423.809,-827.055 413.358,-825.315 414.554,-832.212"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge32" class="edge"><title>program~fidasim&#45;&gt;proc~fida_mc</title>
<path fill="none" stroke="#000000" d="M43.6139,-509.397C55.7484,-500.299 73.2749,-488.062 90,-479.649 97.6402,-475.806 106.153,-472.365 114.309,-469.436"/>
<polygon fill="#000000" stroke="#000000" points="115.67,-472.669 124,-466.123 113.405,-466.046 115.67,-472.669"/>
</g>
<!-- program~fidasim&#45;&gt;proc~pnpa_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge45" class="edge"><title>program~fidasim&#45;&gt;proc~pnpa_mc</title>
<path fill="none" stroke="#000000" d="M27.9518,-533.699C28.4721,-569.058 34.8378,-673.681 90,-731.649 96.1244,-738.085 104.33,-742.55 112.702,-745.647"/>
<polygon fill="#000000" stroke="#000000" points="111.904,-749.064 122.492,-748.69 113.982,-742.379 111.904,-749.064"/>
</g>
<!-- program~fidasim&#45;&gt;proc~make_diagnostic_grids -->
<g id="proc~~get_fields~~CalledByGraph_edge54" class="edge"><title>program~fidasim&#45;&gt;proc~make_diagnostic_grids</title>
<path fill="none" stroke="#000000" d="M54.1721,-517.144C61.8846,-515.816 70.7143,-514.296 79.8233,-512.728"/>
<polygon fill="#000000" stroke="#000000" points="80.5163,-516.161 89.7777,-511.015 79.3288,-509.262 80.5163,-516.161"/>
</g>
<!-- program~fidasim&#45;&gt;proc~ndmc -->
<g id="proc~~get_fields~~CalledByGraph_edge57" class="edge"><title>program~fidasim&#45;&gt;proc~ndmc</title>
<path fill="none" stroke="#000000" d="M30.7272,-509.352C36.8925,-484.363 54.2364,-427.34 90,-395.649 96.8415,-389.586 105.537,-385.249 114.17,-382.154"/>
<polygon fill="#000000" stroke="#000000" points="115.28,-385.474 123.789,-379.163 113.201,-378.79 115.28,-385.474"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_weights_los -->
<g id="proc~~get_fields~~CalledByGraph_edge58" class="edge"><title>program~fidasim&#45;&gt;proc~fida_weights_los</title>
<path fill="none" stroke="#000000" d="M33.8933,-509.561C43.3186,-491.43 63.4579,-457.239 90,-437.649 92.059,-436.129 94.2372,-434.713 96.4962,-433.393"/>
<polygon fill="#000000" stroke="#000000" points="98.2217,-436.441 105.528,-428.769 95.0318,-430.211 98.2217,-436.441"/>
</g>
<!-- program~fidasim&#45;&gt;proc~neutron_f -->
<g id="proc~~get_fields~~CalledByGraph_edge59" class="edge"><title>program~fidasim&#45;&gt;proc~neutron_f</title>
<path fill="none" stroke="#000000" d="M28.6833,-509.519C32.778,-438.911 55.0716,-82.8796 90,-50.6489 180.188,32.5733 249.579,-3.84199 366,-42.6489 391.624,-51.1904 415.727,-70.9496 431.484,-86.0796"/>
<polygon fill="#000000" stroke="#000000" points="429.37,-88.9136 438.928,-93.4857 434.308,-83.9513 429.37,-88.9136"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_f -->
<g id="proc~~get_fields~~CalledByGraph_edge60" class="edge"><title>program~fidasim&#45;&gt;proc~fida_f</title>
<path fill="none" stroke="#000000" d="M54.1721,-526.154C71.6205,-529.157 94.7864,-533.145 113.97,-536.447"/>
<polygon fill="#000000" stroke="#000000" points="113.422,-539.904 123.871,-538.151 114.61,-533.006 113.422,-539.904"/>
</g>
<!-- program~fidasim&#45;&gt;proc~pnpa_f -->
<g id="proc~~get_fields~~CalledByGraph_edge61" class="edge"><title>program~fidasim&#45;&gt;proc~pnpa_f</title>
<path fill="none" stroke="#000000" d="M28.9907,-533.675C32.1355,-564.115 44.5552,-644.964 90,-689.649 96.6324,-696.17 105.401,-700.674 114.18,-703.781"/>
<polygon fill="#000000" stroke="#000000" points="113.399,-707.201 123.984,-706.73 115.416,-700.498 113.399,-707.201"/>
</g>
<!-- program~fidasim&#45;&gt;proc~dcx -->
<g id="proc~~get_fields~~CalledByGraph_edge62" class="edge"><title>program~fidasim&#45;&gt;proc~dcx</title>
<path fill="none" stroke="#000000" d="M28.9907,-509.623C32.1355,-479.183 44.5552,-398.334 90,-353.649 96.6324,-347.127 105.401,-342.624 114.18,-339.516"/>
<polygon fill="#000000" stroke="#000000" points="115.416,-342.8 123.984,-336.568 113.399,-336.096 115.416,-342.8"/>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_f -->
<g id="proc~~get_fields~~CalledByGraph_edge63" class="edge"><title>program~fidasim&#45;&gt;proc~npa_f</title>
<path fill="none" stroke="#000000" d="M30.7272,-533.946C36.8925,-558.935 54.2364,-615.958 90,-647.649 96.8415,-653.711 105.537,-658.049 114.17,-661.144"/>
<polygon fill="#000000" stroke="#000000" points="113.201,-664.508 123.789,-664.135 115.28,-657.823 113.201,-664.508"/>
</g>
<!-- proc~dcx_spec -->
<g id="proc~~get_fields~~CalledByGraph_node27" class="node"><title>proc~dcx_spec</title>
<g id="a_proc~~get_fields~~CalledByGraph_node27"><a xlink:href=".././proc/dcx_spec.html" xlink:title="dcx_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="336,-201.649 278,-201.649 278,-177.649 336,-177.649 336,-201.649"/>
<text text-anchor="middle" x="307" y="-187.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dcx_spec</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~dcx_spec -->
<g id="proc~~get_fields~~CalledByGraph_edge65" class="edge"><title>program~fidasim&#45;&gt;proc~dcx_spec</title>
<path fill="none" stroke="#000000" d="M29.4915,-509.375C35.2314,-463.987 57.2242,-306.372 90,-269.649 136.266,-217.811 219.231,-199.487 267.765,-193.064"/>
<polygon fill="#000000" stroke="#000000" points="268.361,-196.517 277.865,-191.833 267.515,-189.568 268.361,-196.517"/>
</g>
<!-- proc~halo_spec -->
<g id="proc~~get_fields~~CalledByGraph_node28" class="node"><title>proc~halo_spec</title>
<g id="a_proc~~get_fields~~CalledByGraph_node28"><a xlink:href=".././proc/halo_spec.html" xlink:title="halo_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="337.5,-159.649 276.5,-159.649 276.5,-135.649 337.5,-135.649 337.5,-159.649"/>
<text text-anchor="middle" x="307" y="-145.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">halo_spec</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~halo_spec -->
<g id="proc~~get_fields~~CalledByGraph_edge66" class="edge"><title>program~fidasim&#45;&gt;proc~halo_spec</title>
<path fill="none" stroke="#000000" d="M28.6506,-509.308C31.7079,-456.046 46.3782,-246.5 90,-200.649 135.747,-152.564 217.44,-145.157 266.184,-145.481"/>
<polygon fill="#000000" stroke="#000000" points="266.294,-148.983 276.355,-145.664 266.42,-141.984 266.294,-148.983"/>
</g>
<!-- proc~halo -->
<g id="proc~~get_fields~~CalledByGraph_node29" class="node"><title>proc~halo</title>
<g id="a_proc~~get_fields~~CalledByGraph_node29"><a xlink:href=".././proc/halo.html" xlink:title="halo">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-302.649 124,-302.649 124,-278.649 178,-278.649 178,-302.649"/>
<text text-anchor="middle" x="151" y="-288.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">halo</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~halo -->
<g id="proc~~get_fields~~CalledByGraph_edge67" class="edge"><title>program~fidasim&#45;&gt;proc~halo</title>
<path fill="none" stroke="#000000" d="M27.9518,-509.599C28.4721,-474.24 34.8378,-369.617 90,-311.649 96.4121,-304.911 105.105,-300.333 113.883,-297.224"/>
<polygon fill="#000000" stroke="#000000" points="115.125,-300.506 123.712,-294.3 113.129,-293.797 115.125,-300.506"/>
</g>
<!-- proc~cold_spec -->
<g id="proc~~get_fields~~CalledByGraph_node30" class="node"><title>proc~cold_spec</title>
<g id="a_proc~~get_fields~~CalledByGraph_node30"><a xlink:href=".././proc/cold_spec.html" xlink:title="cold_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="337.5,-117.649 276.5,-117.649 276.5,-93.6489 337.5,-93.6489 337.5,-117.649"/>
<text text-anchor="middle" x="307" y="-103.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cold_spec</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~cold_spec -->
<g id="proc~~get_fields~~CalledByGraph_edge68" class="edge"><title>program~fidasim&#45;&gt;proc~cold_spec</title>
<path fill="none" stroke="#000000" d="M28.1884,-509.531C29.3554,-450.985 37.4157,-198.062 90,-144.649 135.952,-97.9727 217.575,-96.3944 266.251,-100.396"/>
<polygon fill="#000000" stroke="#000000" points="266.123,-103.899 276.406,-101.352 266.778,-96.9303 266.123,-103.899"/>
</g>
<!-- proc~pfida_f -->
<g id="proc~~get_fields~~CalledByGraph_node32" class="node"><title>proc~pfida_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node32"><a xlink:href=".././proc/pfida_f.html" xlink:title="pfida_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-638.649 124,-638.649 124,-614.649 178,-614.649 178,-638.649"/>
<text text-anchor="middle" x="151" y="-624.249" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pfida_f</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~pfida_f -->
<g id="proc~~get_fields~~CalledByGraph_edge73" class="edge"><title>program~fidasim&#45;&gt;proc~pfida_f</title>
<path fill="none" stroke="#000000" d="M33.8933,-533.737C43.3186,-551.867 63.4579,-586.059 90,-605.649 97.1481,-610.925 105.734,-614.959 114.146,-618.011"/>
<polygon fill="#000000" stroke="#000000" points="113.252,-621.401 123.844,-621.158 115.413,-614.742 113.252,-621.401"/>
</g>
<!-- proc~nbi_spec -->
<g id="proc~~get_fields~~CalledByGraph_node33" class="node"><title>proc~nbi_spec</title>
<g id="a_proc~~get_fields~~CalledByGraph_node33"><a xlink:href=".././proc/nbi_spec.html" xlink:title="nbi_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="334.5,-75.6489 279.5,-75.6489 279.5,-51.6489 334.5,-51.6489 334.5,-75.6489"/>
<text text-anchor="middle" x="307" y="-61.2489" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nbi_spec</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~nbi_spec -->
<g id="proc~~get_fields~~CalledByGraph_edge74" class="edge"><title>program~fidasim&#45;&gt;proc~nbi_spec</title>
<path fill="none" stroke="#000000" d="M27.9117,-509.257C27.7274,-445.686 30.2269,-156.827 90,-96.6489 136.948,-49.3832 221.131,-51.436 269.369,-57.3856"/>
<polygon fill="#000000" stroke="#000000" points="269,-60.8674 279.379,-58.7403 269.938,-53.9306 269,-60.8674"/>
</g>
<!-- proc~dcx_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge48" class="edge"><title>proc~dcx_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M336.055,-197.552C354.489,-202.744 379.11,-209.68 400.748,-215.775"/>
<polygon fill="#000000" stroke="#000000" points="399.872,-219.165 410.447,-218.507 401.77,-212.427 399.872,-219.165"/>
</g>
<!-- proc~halo_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge49" class="edge"><title>proc~halo_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M337.6,-156.567C346.925,-159.847 357.107,-163.931 366,-168.649 388.506,-180.588 411.77,-197.941 428.092,-211.089"/>
<polygon fill="#000000" stroke="#000000" points="426,-213.9 435.953,-217.531 430.436,-208.486 426,-213.9"/>
</g>
<!-- proc~halo&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge41" class="edge"><title>proc~halo&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.271,-296.484C189.337,-299.763 201.952,-304.642 212,-311.649 248.009,-336.761 277.882,-379.244 293.73,-404.651"/>
<polygon fill="#000000" stroke="#000000" points="290.914,-406.756 299.102,-413.48 296.895,-403.118 290.914,-406.756"/>
</g>
<!-- proc~halo&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge50" class="edge"><title>proc~halo&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M177.914,-278.627C196.915,-270.319 223.555,-259.71 248,-253.649 299.034,-240.994 359.03,-234.941 400.303,-232.091"/>
<polygon fill="#000000" stroke="#000000" points="400.625,-235.578 410.376,-231.434 400.169,-228.593 400.625,-235.578"/>
</g>
<!-- proc~cold_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge51" class="edge"><title>proc~cold_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M337.524,-112.933C347.149,-116.168 357.528,-120.638 366,-126.649 397.262,-148.827 423.321,-185.591 437.767,-208.674"/>
<polygon fill="#000000" stroke="#000000" points="434.868,-210.642 443.06,-217.362 440.846,-207.001 434.868,-210.642"/>
</g>
<!-- proc~store_fida_photons&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge52" class="edge"><title>proc~store_fida_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M316.204,-531.469C328.127,-513.449 350.507,-478.387 366,-446.649 399.765,-377.48 429.8,-291.068 442.953,-251.395"/>
<polygon fill="#000000" stroke="#000000" points="446.339,-252.304 446.136,-241.711 439.689,-250.118 446.339,-252.304"/>
</g>
<!-- proc~pfida_f&#45;&gt;proc~track_cylindrical -->
<g id="proc~~get_fields~~CalledByGraph_edge29" class="edge"><title>proc~pfida_f&#45;&gt;proc~track_cylindrical</title>
<path fill="none" stroke="#000000" d="M178.124,-626.14C198.488,-625.743 227.445,-625.179 252.656,-624.688"/>
<polygon fill="#000000" stroke="#000000" points="252.9,-628.184 262.83,-624.49 252.764,-621.185 252.9,-628.184"/>
</g>
<!-- proc~pfida_f&#45;&gt;proc~mc_fastion_pass_grid -->
<g id="proc~~get_fields~~CalledByGraph_edge55" class="edge"><title>proc~pfida_f&#45;&gt;proc~mc_fastion_pass_grid</title>
<path fill="none" stroke="#000000" d="M178.086,-632.757C189.12,-636.084 201.76,-640.925 212,-647.649 231.718,-660.596 228.352,-673.596 248,-686.649 250.425,-688.26 252.989,-689.766 255.636,-691.17"/>
<polygon fill="#000000" stroke="#000000" points="254.333,-694.427 264.867,-695.562 257.341,-688.106 254.333,-694.427"/>
</g>
<!-- proc~pfida_f&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge71" class="edge"><title>proc~pfida_f&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M178.264,-619.012C188.972,-615.503 201.319,-610.939 212,-605.649 237.256,-593.14 263.878,-575.057 282.317,-561.645"/>
<polygon fill="#000000" stroke="#000000" points="284.454,-564.418 290.424,-555.665 280.299,-558.785 284.454,-564.418"/>
</g>
<!-- proc~nbi_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge53" class="edge"><title>proc~nbi_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M334.553,-69.0615C345.202,-72.241 357.046,-77.1597 366,-84.6489 387.01,-102.222 422.558,-172.39 439.891,-208.276"/>
<polygon fill="#000000" stroke="#000000" points="436.792,-209.909 444.269,-217.416 443.105,-206.885 436.792,-209.909"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/get_fields.html#src">get_fields</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">get_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">input_coords</span><span class="p">,</span> <span class="n">output_coords</span><span class="p">)</span>
    <span class="c">!+ Gets electro-magnetic fields at position `pos` or [[libfida:beam_grid]] indices `ind`</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">fields</span>
        <span class="c">!+ Electro-magnetic fields at `pos`/`ind`</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>  <span class="kd">::</span> <span class="n">pos</span>
        <span class="c">!+ Position in beam grid coordinates</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">ind</span>
        <span class="c">!+ [[libfida:beam_grid]] indices</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>               <span class="kd">::</span> <span class="n">input_coords</span>
        <span class="c">!+ Indicates coordinate system of inputs. Beam grid (0), machine (1) and cylindrical (2)</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>               <span class="kd">::</span> <span class="n">output_coords</span>
        <span class="c">!+ Indicates coordinate system of outputs. Beam grid (0), machine (1) and cylindrical (2)</span>

    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">inp</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">uvw</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">uvw_bfield</span><span class="p">,</span> <span class="n">uvw_efield</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xyz_bfield</span><span class="p">,</span> <span class="n">xyz_efield</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">phi</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">c</span>
    <span class="k">type</span><span class="p">(</span><span class="n">InterpolCoeffs3D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">coeffs</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">k2</span><span class="p">,</span> <span class="n">mc</span><span class="p">,</span> <span class="n">ocs</span><span class="p">,</span> <span class="n">ics</span>

    <span class="n">fields</span><span class="p">%</span><span class="n">in_plasma</span> <span class="o">=</span> <span class="p">.</span><span class="n">False</span><span class="p">.</span>

    <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">input_coords</span><span class="p">))</span> <span class="k">then</span>
<span class="k">        </span><span class="n">ics</span> <span class="o">=</span> <span class="n">input_coords</span>
    <span class="k">else</span>
<span class="k">        </span><span class="n">ics</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">endif</span>

<span class="k">    if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">output_coords</span><span class="p">))</span> <span class="k">then</span>
<span class="k">        </span><span class="n">ocs</span> <span class="o">=</span> <span class="n">output_coords</span>
    <span class="k">else</span>
<span class="k">        </span><span class="n">ocs</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">endif</span>

<span class="k">    if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">ind</span><span class="p">))</span> <span class="k">call </span><span class="n">get_position</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">xyz</span><span class="p">)</span>

    <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span> <span class="k">then</span>
<span class="k">        if</span><span class="p">(</span><span class="n">ics</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">xyz</span> <span class="o">=</span> <span class="n">pos</span>
            <span class="k">call </span><span class="n">xyz_to_uvw</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span> <span class="n">uvw</span><span class="p">)</span>
        <span class="k">endif</span>
<span class="k">        if</span><span class="p">(</span><span class="n">ics</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">uvw</span> <span class="o">=</span> <span class="n">pos</span>
            <span class="k">call </span><span class="n">uvw_to_xyz</span><span class="p">(</span><span class="n">uvw</span><span class="p">,</span> <span class="n">xyz</span><span class="p">)</span>
        <span class="k">endif</span>
<span class="k">    endif</span>

<span class="k">    call </span><span class="n">in_plasma</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span><span class="n">inp</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">coeffs</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">i</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">%</span><span class="n">i</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">%</span><span class="n">j</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">%</span><span class="n">k</span>
        <span class="k">if</span><span class="p">(</span><span class="n">inter_grid</span><span class="p">%</span><span class="n">nphi</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">k2</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">inter_grid</span><span class="p">%</span><span class="n">nphi</span><span class="p">)</span>
        <span class="k">else</span>
<span class="k">            </span><span class="n">k2</span> <span class="o">=</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span>
        <span class="k">endif</span>

<span class="k">        </span><span class="n">fields</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">%</span><span class="n">b111</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>    <span class="o">+</span> <span class="n">coeffs</span><span class="p">%</span><span class="n">b121</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span>   <span class="p">&amp;</span>
                 <span class="n">coeffs</span><span class="p">%</span><span class="n">b112</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k2</span><span class="p">)</span>   <span class="o">+</span> <span class="n">coeffs</span><span class="p">%</span><span class="n">b122</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k2</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
                 <span class="n">coeffs</span><span class="p">%</span><span class="n">b211</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>  <span class="o">+</span> <span class="n">coeffs</span><span class="p">%</span><span class="n">b221</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
                 <span class="n">coeffs</span><span class="p">%</span><span class="n">b212</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k2</span><span class="p">)</span> <span class="o">+</span> <span class="n">coeffs</span><span class="p">%</span><span class="n">b222</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k2</span><span class="p">)</span>

        <span class="n">phi</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">uvw</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">uvw</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">s</span> <span class="o">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="nb">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>

        <span class="c">!Convert cylindrical coordinates to uvw</span>
        <span class="n">uvw_bfield</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">br</span> <span class="o">-</span> <span class="n">s</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">bt</span>
        <span class="n">uvw_bfield</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">br</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">bt</span>
        <span class="n">uvw_bfield</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">fields</span><span class="p">%</span><span class="n">bz</span>
        <span class="n">uvw_efield</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">er</span> <span class="o">-</span> <span class="n">s</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">et</span>
        <span class="n">uvw_efield</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">er</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">et</span>
        <span class="n">uvw_efield</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">fields</span><span class="p">%</span><span class="n">ez</span>

        <span class="k">if</span><span class="p">(</span><span class="n">ocs</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
            <span class="c">!Represent fields in beam grid coordinates</span>
            <span class="n">xyz_bfield</span> <span class="o">=</span> <span class="nb">matmul</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">inv_basis</span><span class="p">,</span><span class="n">uvw_bfield</span><span class="p">)</span>
            <span class="n">xyz_efield</span> <span class="o">=</span> <span class="nb">matmul</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">inv_basis</span><span class="p">,</span><span class="n">uvw_efield</span><span class="p">)</span>
            <span class="n">fields</span><span class="p">%</span><span class="n">pos</span> <span class="o">=</span> <span class="n">xyz</span>
        <span class="k">endif</span>
<span class="k">        if</span><span class="p">(</span><span class="n">ocs</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">xyz_bfield</span> <span class="o">=</span> <span class="n">uvw_bfield</span>
            <span class="n">xyz_efield</span> <span class="o">=</span> <span class="n">uvw_efield</span>
            <span class="n">fields</span><span class="p">%</span><span class="n">pos</span> <span class="o">=</span> <span class="n">uvw</span>
        <span class="k">endif</span>

        <span class="c">!Calculate field directions and magnitudes</span>
        <span class="n">fields</span><span class="p">%</span><span class="n">b_abs</span> <span class="o">=</span> <span class="nb">norm2</span><span class="p">(</span><span class="n">xyz_bfield</span><span class="p">)</span>
        <span class="n">fields</span><span class="p">%</span><span class="n">e_abs</span> <span class="o">=</span> <span class="nb">norm2</span><span class="p">(</span><span class="n">xyz_efield</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">fields</span><span class="p">%</span><span class="n">b_abs</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">)</span> <span class="n">fields</span><span class="p">%</span><span class="n">b_norm</span> <span class="o">=</span> <span class="n">xyz_bfield</span><span class="o">/</span><span class="n">fields</span><span class="p">%</span><span class="n">b_abs</span>
        <span class="k">if</span><span class="p">(</span><span class="n">fields</span><span class="p">%</span><span class="n">e_abs</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">)</span> <span class="n">fields</span><span class="p">%</span><span class="n">e_norm</span> <span class="o">=</span> <span class="n">xyz_efield</span><span class="o">/</span><span class="n">fields</span><span class="p">%</span><span class="n">e_abs</span>

        <span class="k">call </span><span class="n">calc_perp_vectors</span><span class="p">(</span><span class="n">fields</span><span class="p">%</span><span class="n">b_norm</span><span class="p">,</span><span class="n">fields</span><span class="p">%</span><span class="n">a_norm</span><span class="p">,</span><span class="n">fields</span><span class="p">%</span><span class="n">c_norm</span><span class="p">)</span>

        <span class="n">fields</span><span class="p">%</span><span class="n">uvw</span> <span class="o">=</span> <span class="n">uvw</span>
        <span class="n">fields</span><span class="p">%</span><span class="n">in_plasma</span> <span class="o">=</span> <span class="p">.</span><span class="n">True</span><span class="p">.</span>
        <span class="n">fields</span><span class="p">%</span><span class="n">coords</span> <span class="o">=</span> <span class="n">ocs</span>
        <span class="n">fields</span><span class="p">%</span><span class="n">b</span> <span class="o">=</span> <span class="n">coeffs</span>
    <span class="k">endif</span>

<span class="k">end subroutine </span><span class="n">get_fields</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2021 
                                          </p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            
            
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>