<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="">
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>get_fields &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>User Guide</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>get_fields
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.5% of total for procedures.">76 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
     <li><a href='../module/libfida.html'>libfida</a></li>
     <li class="active">get_fields</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/get_fields.html#src">get_fields</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public subroutine get_fields(fields, pos, ind, input_coords, output_coords)</h2>
    

    <p>Gets electro-magnetic fields at position <code>pos</code> or <a href="../module/libfida.html#variable-beam_grid">beam_grid</a> indices <code>ind</code></p>

    <h3>Arguments</h3>
      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-fields%7E4"></span>type(<a href='../type/localemfields.html'>LocalEMFields</a>),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>fields</strong></td><td><p>Electro-magnetic fields at <code>pos</code>/<code>ind</code></p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-pos%7E9"></span>real(kind=Float64),</td>
<td>intent(in),</td>
  <td>optional</td>  <td>dimension(3)</td><td>::</td>
  <td><strong>pos</strong></td><td><p>Position in beam grid coordinates</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ind%7E8"></span>integer(kind=Int32),</td>
<td>intent(in),</td>
  <td>optional</td>  <td>dimension(3)</td><td>::</td>
  <td><strong>ind</strong></td><td><p><a href="../module/libfida.html#variable-beam_grid">beam_grid</a> indices</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-input_coords%7E6"></span>integer(kind=Int32),</td>
<td>intent(in),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>input_coords</strong></td><td><p>Indicates coordinate system of inputs. Beam grid (0), machine (1) and cylindrical (2)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-output_coords%7E2"></span>integer(kind=Int32),</td>
<td>intent(in),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>output_coords</strong></td><td><p>Indicates coordinate system of outputs. Beam grid (0), machine (1) and cylindrical (2)</p></td>
</tr>
</tbody>
</table>

    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~get_fields~~CallsGraph Pages: 1 -->
<svg id="procget_fieldsCallsGraph" width="420pt" height="203pt"
 viewBox="0.00 0.00 420.00 202.77" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~get_fields~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 198.774)">
<title>proc~~get_fields~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-198.774 416,-198.774 416,4 -4,4"/>
<!-- proc~get_fields -->
<g id="proc~~get_fields~~CallsGraph_node1" class="node"><title>proc~get_fields</title>
<polygon fill="none" stroke="black" points="58,-94.391 3.55271e-15,-94.391 3.55271e-15,-70.391 58,-70.391 58,-94.391"/>
<text text-anchor="middle" x="29" y="-79.991" font-family="Helvetica,sans-Serif" font-size="10.50">get_fields</text>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_node2" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~get_fields~~CallsGraph_node2"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-133.391 235,-133.391 235,-109.391 303,-109.391 303,-133.391"/>
<text text-anchor="middle" x="269" y="-118.991" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_edge1" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M58.3148,-93.1274C69.3129,-96.9137 82.1056,-100.855 94,-103.391 138.064,-112.786 189.492,-117.337 224.951,-119.503"/>
<polygon fill="#000000" stroke="#000000" points="224.778,-122.999 234.962,-120.077 225.179,-116.01 224.778,-122.999"/>
</g>
<!-- proc~get_position -->
<g id="proc~~get_fields~~CallsGraph_node3" class="node"><title>proc~get_position</title>
<g id="a_proc~~get_fields~~CallsGraph_node3"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="179,-94.391 109,-94.391 109,-70.391 179,-70.391 179,-94.391"/>
<text text-anchor="middle" x="144" y="-79.991" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~get_fields~~CallsGraph_edge2" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M58.2232,-82.391C70.4128,-82.391 84.9683,-82.391 98.5496,-82.391"/>
<polygon fill="#000000" stroke="#000000" points="98.6901,-85.8911 108.69,-82.391 98.69,-78.8911 98.6901,-85.8911"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~get_fields~~CallsGraph_node4" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~get_fields~~CallsGraph_node4"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="174.5,-174.391 113.5,-174.391 113.5,-150.391 174.5,-150.391 174.5,-174.391"/>
<text text-anchor="middle" x="144" y="-159.991" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~get_fields~~CallsGraph_edge3" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M42.5894,-94.4179C55.0507,-105.974 74.9692,-123.529 94,-136.391 98.6377,-139.526 103.695,-142.577 108.743,-145.422"/>
<polygon fill="#000000" stroke="#000000" points="107.267,-148.602 117.726,-150.292 110.603,-142.449 107.267,-148.602"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~get_fields~~CallsGraph_node5" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~get_fields~~CallsGraph_node5"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="194,-52.391 94,-52.391 94,-28.391 194,-28.391 194,-52.391"/>
<text text-anchor="middle" x="144" y="-37.991" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~get_fields~~CallsGraph_edge4" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M58.2232,-71.901C71.0767,-67.1236 86.5609,-61.3684 100.76,-56.091"/>
<polygon fill="#000000" stroke="#000000" points="102.182,-59.2964 110.336,-52.5317 99.743,-52.735 102.182,-59.2964"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~get_fields~~CallsGraph_node6" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~get_fields~~CallsGraph_node6"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="412,-41.391 344,-41.391 344,-17.391 412,-17.391 412,-41.391"/>
<text text-anchor="middle" x="378" y="-26.991" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~get_fields~~CallsGraph_edge5" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M37.7655,-70.3056C48.3511,-55.083 68.8957,-29.674 94,-19.391 173.611,13.2185 276.619,-3.42622 333.838,-17.2253"/>
<polygon fill="#000000" stroke="#000000" points="333.084,-20.6445 343.634,-19.6688 334.778,-13.8526 333.084,-20.6445"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~get_fields~~CallsGraph_node8" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~get_fields~~CallsGraph_node8"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="300,-91.391 238,-91.391 238,-67.391 300,-67.391 300,-91.391"/>
<text text-anchor="middle" x="269" y="-76.991" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~get_fields~~CallsGraph_edge6" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M179.262,-81.5554C194.163,-81.1919 211.737,-80.7633 227.298,-80.3838"/>
<polygon fill="#000000" stroke="#000000" points="227.78,-83.8732 237.692,-80.1303 227.609,-76.8752 227.78,-83.8732"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_edge8" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M174.775,-152.466C189.871,-147.434 208.479,-141.231 225.09,-135.694"/>
<polygon fill="#000000" stroke="#000000" points="226.218,-139.008 234.598,-132.525 224.004,-132.367 226.218,-139.008"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_node7" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~get_fields~~CallsGraph_node7"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="410.5,-112.391 345.5,-112.391 345.5,-88.391 410.5,-88.391 410.5,-112.391"/>
<text text-anchor="middle" x="378" y="-97.991" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_edge7" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M171.208,-174.487C204.6,-188.034 263.338,-205.502 308,-184.391 335.397,-171.441 355.571,-141.689 366.805,-121.308"/>
<polygon fill="#000000" stroke="#000000" points="369.915,-122.914 371.463,-112.433 363.716,-119.661 369.915,-122.914"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~get_fields~~CallsGraph_node9" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~get_fields~~CallsGraph_node9"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="307.5,-175.391 230.5,-175.391 230.5,-151.391 307.5,-151.391 307.5,-175.391"/>
<text text-anchor="middle" x="269" y="-160.991" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~get_fields~~CallsGraph_edge9" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M174.775,-162.633C188.292,-162.743 204.626,-162.876 219.82,-162.999"/>
<polygon fill="#000000" stroke="#000000" points="220.08,-166.501 230.108,-163.083 220.137,-159.502 220.08,-166.501"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~get_fields~~CallsGraph_edge11" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M295.902,-67.2874C309.6,-60.8862 326.623,-52.9315 341.531,-45.9653"/>
<polygon fill="#000000" stroke="#000000" points="343.388,-48.9609 350.966,-41.5565 340.425,-42.6191 343.388,-48.9609"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~get_fields~~CallsGraph_edge10" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M300.09,-85.2966C310.99,-87.4359 323.506,-89.8922 335.23,-92.1933"/>
<polygon fill="#000000" stroke="#000000" points="334.783,-95.6721 345.27,-94.1636 336.131,-88.8032 334.783,-95.6721"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~get_fields~~CalledByGraph Pages: 1 -->
<svg id="procget_fieldsCalledByGraph" width="602pt" height="1042pt"
 viewBox="0.00 0.00 602.00 1041.92" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~get_fields~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 1037.92)">
<title>proc~~get_fields~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1037.92 598,-1037.92 598,4 -4,4"/>
<!-- proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_node1" class="node"><title>proc~get_fields</title>
<polygon fill="none" stroke="black" points="594,-681.921 536,-681.921 536,-657.921 594,-657.921 594,-681.921"/>
<text text-anchor="middle" x="565" y="-667.521" font-family="Helvetica,sans-Serif" font-size="10.50">get_fields</text>
</g>
<!-- proc~make_diagnostic_grids -->
<g id="proc~~get_fields~~CalledByGraph_node2" class="node"><title>proc~make_diagnostic_grids</title>
<g id="a_proc~~get_fields~~CalledByGraph_node2"><a xlink:href=".././proc/make_diagnostic_grids.html" xlink:title="make_diagnostic_grids">
<polygon fill="#d9534f" stroke="#d9534f" points="212,-938.921 90,-938.921 90,-914.921 212,-914.921 212,-938.921"/>
<text text-anchor="middle" x="151" y="-924.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">make_diagnostic_grids</text>
</a>
</g>
</g>
<!-- proc~make_diagnostic_grids&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge1" class="edge"><title>proc~make_diagnostic_grids&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M176.834,-939.057C239.709,-967.835 406.797,-1031.9 500,-949.921 538.869,-915.734 556.787,-752.832 562.171,-692.48"/>
<polygon fill="#000000" stroke="#000000" points="565.69,-692.414 563.058,-682.151 558.715,-691.815 565.69,-692.414"/>
</g>
<!-- proc~track_cylindrical -->
<g id="proc~~get_fields~~CalledByGraph_node4" class="node"><title>proc~track_cylindrical</title>
<g id="a_proc~~get_fields~~CalledByGraph_node4"><a xlink:href=".././proc/track_cylindrical.html" xlink:title="track_cylindrical">
<polygon fill="#d9534f" stroke="#d9534f" points="351,-953.921 263,-953.921 263,-929.921 351,-929.921 351,-953.921"/>
<text text-anchor="middle" x="307" y="-939.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track_cylindrical</text>
</a>
</g>
</g>
<!-- proc~make_diagnostic_grids&#45;&gt;proc~track_cylindrical -->
<g id="proc~~get_fields~~CalledByGraph_edge23" class="edge"><title>proc~make_diagnostic_grids&#45;&gt;proc~track_cylindrical</title>
<path fill="none" stroke="#000000" d="M212.423,-932.807C225.721,-934.102 239.712,-935.465 252.705,-936.73"/>
<polygon fill="#000000" stroke="#000000" points="252.586,-940.235 262.878,-937.721 253.265,-933.268 252.586,-940.235"/>
</g>
<!-- proc~track -->
<g id="proc~~get_fields~~CalledByGraph_node6" class="node"><title>proc~track</title>
<g id="a_proc~~get_fields~~CalledByGraph_node6"><a xlink:href=".././proc/track.html" xlink:title="track">
<polygon fill="#d9534f" stroke="#d9534f" points="334,-683.921 280,-683.921 280,-659.921 334,-659.921 334,-683.921"/>
<text text-anchor="middle" x="307" y="-669.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track</text>
</a>
</g>
</g>
<!-- proc~make_diagnostic_grids&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge26" class="edge"><title>proc~make_diagnostic_grids&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M189.069,-914.837C197.399,-910.792 205.642,-905.566 212,-898.921 269.635,-838.691 294.055,-738.123 302.384,-693.911"/>
<polygon fill="#000000" stroke="#000000" points="305.851,-694.403 304.165,-683.944 298.96,-693.172 305.851,-694.403"/>
</g>
<!-- proc~cfpd_f -->
<g id="proc~~get_fields~~CalledByGraph_node3" class="node"><title>proc~cfpd_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node3"><a xlink:href=".././proc/cfpd_f.html" xlink:title="cfpd_f">
<polygon fill="#d9534f" stroke="#d9534f" points="478,-1033.92 424,-1033.92 424,-1009.92 478,-1009.92 478,-1033.92"/>
<text text-anchor="middle" x="451" y="-1019.52" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cfpd_f</text>
</a>
</g>
</g>
<!-- proc~cfpd_f&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge3" class="edge"><title>proc~cfpd_f&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M478.245,-1012.86C486.343,-1008.85 494.553,-1003.33 500,-995.921 536.018,-946.946 556.115,-757.575 562.088,-692.237"/>
<polygon fill="#000000" stroke="#000000" points="565.581,-692.465 562.983,-682.193 558.609,-691.843 565.581,-692.465"/>
</g>
<!-- proc~track_cylindrical&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge2" class="edge"><title>proc~track_cylindrical&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M351.279,-949.797C394.249,-954.974 459.414,-955.313 500,-919.921 534.592,-889.757 554.808,-747.743 561.502,-692.234"/>
<polygon fill="#000000" stroke="#000000" points="565.006,-692.397 562.693,-682.058 558.054,-691.583 565.006,-692.397"/>
</g>
<!-- proc~store_fw_photons -->
<g id="proc~~get_fields~~CalledByGraph_node5" class="node"><title>proc~store_fw_photons</title>
<g id="a_proc~~get_fields~~CalledByGraph_node5"><a xlink:href=".././proc/store_fw_photons.html" xlink:title="store_fw_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="499.5,-877.921 402.5,-877.921 402.5,-853.921 499.5,-853.921 499.5,-877.921"/>
<text text-anchor="middle" x="451" y="-863.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_fw_photons</text>
</a>
</g>
</g>
<!-- proc~store_fw_photons&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge4" class="edge"><title>proc~store_fw_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M482.3,-853.772C488.787,-850.082 495.141,-845.493 500,-839.921 538.156,-796.172 554.53,-727.442 560.719,-692.277"/>
<polygon fill="#000000" stroke="#000000" points="564.221,-692.548 562.385,-682.113 557.313,-691.415 564.221,-692.548"/>
</g>
<!-- proc~track&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge5" class="edge"><title>proc~track&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M334.432,-671.715C379.848,-671.36 472.875,-670.633 525.499,-670.222"/>
<polygon fill="#000000" stroke="#000000" points="525.799,-673.72 535.771,-670.142 525.744,-666.72 525.799,-673.72"/>
</g>
<!-- proc~neutron_mc -->
<g id="proc~~get_fields~~CalledByGraph_node7" class="node"><title>proc~neutron_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node7"><a xlink:href=".././proc/neutron_mc.html" xlink:title="neutron_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="486,-797.921 416,-797.921 416,-773.921 486,-773.921 486,-797.921"/>
<text text-anchor="middle" x="451" y="-783.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutron_mc</text>
</a>
</g>
</g>
<!-- proc~neutron_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge6" class="edge"><title>proc~neutron_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M479.314,-773.899C486.477,-770.03 493.897,-765.324 500,-759.921 522.578,-739.937 541.569,-710.541 552.859,-690.839"/>
<polygon fill="#000000" stroke="#000000" points="555.957,-692.469 557.765,-682.03 549.842,-689.064 555.957,-692.469"/>
</g>
<!-- proc~pnpa_mc -->
<g id="proc~~get_fields~~CalledByGraph_node8" class="node"><title>proc~pnpa_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node8"><a xlink:href=".././proc/pnpa_mc.html" xlink:title="pnpa_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="179.5,-136.921 122.5,-136.921 122.5,-112.921 179.5,-112.921 179.5,-136.921"/>
<text text-anchor="middle" x="151" y="-122.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pnpa_mc</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge7" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M179.763,-120.361C253.86,-108.874 453.79,-82.569 500,-124.921 539.223,-160.87 558.726,-549.078 563.058,-647.395"/>
<polygon fill="#000000" stroke="#000000" points="559.564,-647.594 563.492,-657.434 566.557,-647.292 559.564,-647.594"/>
</g>
<!-- proc~store_npa -->
<g id="proc~~get_fields~~CalledByGraph_node17" class="node"><title>proc~store_npa</title>
<g id="a_proc~~get_fields~~CalledByGraph_node17"><a xlink:href=".././proc/store_npa.html" xlink:title="store_npa">
<polygon fill="#d9534f" stroke="#d9534f" points="337.5,-153.921 276.5,-153.921 276.5,-129.921 337.5,-129.921 337.5,-153.921"/>
<text text-anchor="middle" x="307" y="-139.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_npa</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~store_npa -->
<g id="proc~~get_fields~~CalledByGraph_edge54" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M179.532,-127.961C203.697,-130.628 239.135,-134.54 266.354,-137.545"/>
<polygon fill="#000000" stroke="#000000" points="266.019,-141.029 276.343,-138.648 266.787,-134.071 266.019,-141.029"/>
</g>
<!-- proc~mc_fastion_pass_grid -->
<g id="proc~~get_fields~~CalledByGraph_node9" class="node"><title>proc~mc_fastion_pass_grid</title>
<g id="a_proc~~get_fields~~CalledByGraph_node9"><a xlink:href=".././proc/mc_fastion_pass_grid.html" xlink:title="mc_fastion_pass_grid">
<polygon fill="#d9534f" stroke="#d9534f" points="365.5,-275.921 248.5,-275.921 248.5,-251.921 365.5,-251.921 365.5,-275.921"/>
<text text-anchor="middle" x="307" y="-261.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_fastion_pass_grid</text>
</a>
</g>
</g>
<!-- proc~mc_fastion_pass_grid&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge8" class="edge"><title>proc~mc_fastion_pass_grid&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M349.948,-275.97C355.596,-278.476 361.117,-281.439 366,-284.921 443.195,-339.976 456.071,-366.896 500,-450.921 535.135,-518.126 553.512,-607.293 560.546,-647.989"/>
<polygon fill="#000000" stroke="#000000" points="557.103,-648.617 562.199,-657.905 564.007,-647.466 557.103,-648.617"/>
</g>
<!-- proc~pfida_mc -->
<g id="proc~~get_fields~~CalledByGraph_node10" class="node"><title>proc~pfida_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node10"><a xlink:href=".././proc/pfida_mc.html" xlink:title="pfida_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="179,-889.921 123,-889.921 123,-865.921 179,-865.921 179,-889.921"/>
<text text-anchor="middle" x="151" y="-875.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pfida_mc</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge9" class="edge"><title>proc~pfida_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M179.068,-882.766C251.864,-895.165 449.72,-924.513 500,-886.921 531.659,-863.252 553.098,-742.659 560.817,-692.184"/>
<polygon fill="#000000" stroke="#000000" points="564.321,-692.414 562.331,-682.007 557.397,-691.383 564.321,-692.414"/>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~track_cylindrical -->
<g id="proc~~get_fields~~CalledByGraph_edge22" class="edge"><title>proc~pfida_mc&#45;&gt;proc~track_cylindrical</title>
<path fill="none" stroke="#000000" d="M179.178,-889.216C203.74,-899.424 240.157,-914.558 267.673,-925.994"/>
<polygon fill="#000000" stroke="#000000" points="266.424,-929.264 277.001,-929.87 269.11,-922.8 266.424,-929.264"/>
</g>
<!-- proc~store_fida_photons -->
<g id="proc~~get_fields~~CalledByGraph_node28" class="node"><title>proc~store_fida_photons</title>
<g id="a_proc~~get_fields~~CalledByGraph_node28"><a xlink:href=".././proc/store_fida_photons.html" xlink:title="store_fida_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="359,-523.921 255,-523.921 255,-499.921 359,-499.921 359,-523.921"/>
<text text-anchor="middle" x="307" y="-509.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_fida_photons</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge68" class="edge"><title>proc~pfida_mc&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M179.164,-871.156C191.096,-866.783 204.151,-859.808 212,-848.921 284.863,-747.862 193.493,-682.953 248,-570.921 255.659,-555.18 269.171,-541.055 281.227,-530.574"/>
<polygon fill="#000000" stroke="#000000" points="283.784,-533.001 289.251,-523.926 279.318,-527.611 283.784,-533.001"/>
</g>
<!-- proc~fida_weights_los -->
<g id="proc~~get_fields~~CalledByGraph_node11" class="node"><title>proc~fida_weights_los</title>
<g id="a_proc~~get_fields~~CalledByGraph_node11"><a xlink:href=".././proc/fida_weights_los.html" xlink:title="fida_weights_los">
<polygon fill="#d9534f" stroke="#d9534f" points="196.5,-727.921 105.5,-727.921 105.5,-703.921 196.5,-703.921 196.5,-727.921"/>
<text text-anchor="middle" x="151" y="-713.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_weights_los</text>
</a>
</g>
</g>
<!-- proc~fida_weights_los&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge10" class="edge"><title>proc~fida_weights_los&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M196.648,-720.831C263.828,-726.791 394.299,-732.782 500,-703.921 513.086,-700.349 526.501,-693.755 537.647,-687.318"/>
<polygon fill="#000000" stroke="#000000" points="539.669,-690.185 546.418,-682.018 536.049,-684.194 539.669,-690.185"/>
</g>
<!-- proc~fida_weights_los&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge27" class="edge"><title>proc~fida_weights_los&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M194.081,-703.898C217.867,-697.102 247.294,-688.695 270.003,-682.206"/>
<polygon fill="#000000" stroke="#000000" points="271.266,-685.486 279.92,-679.373 269.343,-678.755 271.266,-685.486"/>
</g>
<!-- proc~fida_mc -->
<g id="proc~~get_fields~~CalledByGraph_node12" class="node"><title>proc~fida_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node12"><a xlink:href=".././proc/fida_mc.html" xlink:title="fida_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-685.921 124,-685.921 124,-661.921 178,-661.921 178,-685.921"/>
<text text-anchor="middle" x="151" y="-671.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_mc</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge11" class="edge"><title>proc~fida_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M178.279,-680.565C197.457,-685.058 224.158,-690.585 248,-692.921 359.537,-703.853 389.044,-699.695 500,-683.921 508.406,-682.726 517.351,-681.038 525.807,-679.245"/>
<polygon fill="#000000" stroke="#000000" points="526.8,-682.61 535.809,-677.034 525.289,-675.776 526.8,-682.61"/>
</g>
<!-- proc~fida_mc&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge29" class="edge"><title>proc~fida_mc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.124,-673.582C203.235,-673.256 241.411,-672.76 269.517,-672.395"/>
<polygon fill="#000000" stroke="#000000" points="269.794,-675.892 279.748,-672.262 269.703,-668.893 269.794,-675.892"/>
</g>
<!-- proc~fida_mc&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge66" class="edge"><title>proc~fida_mc&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M178.079,-669.674C189.633,-666.657 202.687,-661.544 212,-652.921 241.207,-625.882 225.682,-603.877 248,-570.921 257.947,-556.234 271.795,-541.986 283.465,-531.172"/>
<polygon fill="#000000" stroke="#000000" points="286.037,-533.566 291.122,-524.271 281.351,-528.366 286.037,-533.566"/>
</g>
<!-- proc~npa_weights -->
<g id="proc~~get_fields~~CalledByGraph_node13" class="node"><title>proc~npa_weights</title>
<g id="a_proc~~get_fields~~CalledByGraph_node13"><a xlink:href=".././proc/npa_weights.html" xlink:title="npa_weights">
<polygon fill="#d9534f" stroke="#d9534f" points="487.5,-194.921 414.5,-194.921 414.5,-170.921 487.5,-170.921 487.5,-194.921"/>
<text text-anchor="middle" x="451" y="-180.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_weights</text>
</a>
</g>
</g>
<!-- proc~npa_weights&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge12" class="edge"><title>proc~npa_weights&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M482.275,-195.037C489.086,-199.116 495.594,-204.351 500,-210.921 548.891,-283.842 560.935,-566.003 563.425,-647.663"/>
<polygon fill="#000000" stroke="#000000" points="559.93,-647.917 563.715,-657.813 566.927,-647.717 559.93,-647.917"/>
</g>
<!-- proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_node14" class="node"><title>proc~store_photons</title>
<g id="a_proc~~get_fields~~CalledByGraph_node14"><a xlink:href=".././proc/store_photons.html" xlink:title="store_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="491.5,-483.921 410.5,-483.921 410.5,-459.921 491.5,-459.921 491.5,-483.921"/>
<text text-anchor="middle" x="451" y="-469.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_photons</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge14" class="edge"><title>proc~store_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M458.838,-484.009C477.348,-516.734 528.617,-607.369 552.043,-648.784"/>
<polygon fill="#000000" stroke="#000000" points="549.14,-650.76 557.11,-657.74 555.233,-647.313 549.14,-650.76"/>
</g>
<!-- proc~fida_weights_mc -->
<g id="proc~~get_fields~~CalledByGraph_node15" class="node"><title>proc~fida_weights_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node15"><a xlink:href=".././proc/fida_weights_mc.html" xlink:title="fida_weights_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="197,-839.921 105,-839.921 105,-815.921 197,-815.921 197,-839.921"/>
<text text-anchor="middle" x="151" y="-825.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_weights_mc</text>
</a>
</g>
</g>
<!-- proc~fida_weights_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge15" class="edge"><title>proc~fida_weights_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M197.042,-830.748C279.776,-835.055 451.883,-839.63 500,-806.921 539.036,-780.386 554.809,-723.544 560.74,-692.056"/>
<polygon fill="#000000" stroke="#000000" points="564.213,-692.515 562.45,-682.067 557.313,-691.334 564.213,-692.515"/>
</g>
<!-- proc~fida_weights_mc&#45;&gt;proc~store_fw_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge25" class="edge"><title>proc~fida_weights_mc&#45;&gt;proc~store_fw_photons</title>
<path fill="none" stroke="#000000" d="M197.26,-833.693C249.483,-840.352 335.461,-851.316 392.408,-858.578"/>
<polygon fill="#000000" stroke="#000000" points="391.976,-862.051 402.338,-859.844 392.861,-855.107 391.976,-862.051"/>
</g>
<!-- proc~fida_weights_mc&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge30" class="edge"><title>proc~fida_weights_mc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M164.084,-815.68C190.735,-788.683 254.739,-723.849 286.889,-691.28"/>
<polygon fill="#000000" stroke="#000000" points="289.437,-693.681 293.972,-684.106 284.456,-688.763 289.437,-693.681"/>
</g>
<!-- proc~ndmc -->
<g id="proc~~get_fields~~CalledByGraph_node16" class="node"><title>proc~ndmc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node16"><a xlink:href=".././proc/ndmc.html" xlink:title="ndmc">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-643.921 124,-643.921 124,-619.921 178,-619.921 178,-643.921"/>
<text text-anchor="middle" x="151" y="-629.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ndmc</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge17" class="edge"><title>proc~ndmc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M178.03,-634.172C218.321,-637.67 298.218,-644.66 366,-650.921 421.556,-656.053 485.85,-662.275 525.726,-666.167"/>
<polygon fill="#000000" stroke="#000000" points="525.515,-669.663 535.808,-667.152 526.196,-662.696 525.515,-669.663"/>
</g>
<!-- proc~ndmc&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge32" class="edge"><title>proc~ndmc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.124,-638.707C203.345,-645.258 241.748,-655.233 269.888,-662.542"/>
<polygon fill="#000000" stroke="#000000" points="269.189,-665.976 279.748,-665.103 270.949,-659.201 269.189,-665.976"/>
</g>
<!-- proc~store_nbi_photons -->
<g id="proc~~get_fields~~CalledByGraph_node29" class="node"><title>proc~store_nbi_photons</title>
<g id="a_proc~~get_fields~~CalledByGraph_node29"><a xlink:href=".././proc/store_nbi_photons.html" xlink:title="store_nbi_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="357.5,-603.921 256.5,-603.921 256.5,-579.921 357.5,-579.921 357.5,-603.921"/>
<text text-anchor="middle" x="307" y="-589.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_nbi_photons</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~store_nbi_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge70" class="edge"><title>proc~ndmc&#45;&gt;proc~store_nbi_photons</title>
<path fill="none" stroke="#000000" d="M178.124,-625.136C197.734,-620.043 225.312,-612.879 249.84,-606.508"/>
<polygon fill="#000000" stroke="#000000" points="250.976,-609.829 259.775,-603.928 249.217,-603.054 250.976,-609.829"/>
</g>
<!-- proc~store_npa&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge16" class="edge"><title>proc~store_npa&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M337.671,-134.94C379.91,-126.941 457.007,-119.844 500,-161.921 535.331,-196.5 557.586,-554.581 562.811,-647.824"/>
<polygon fill="#000000" stroke="#000000" points="559.318,-648.05 563.364,-657.842 566.308,-647.665 559.318,-648.05"/>
</g>
<!-- proc~npa_mc -->
<g id="proc~~get_fields~~CalledByGraph_node18" class="node"><title>proc~npa_mc</title>
<g id="a_proc~~get_fields~~CalledByGraph_node18"><a xlink:href=".././proc/npa_mc.html" xlink:title="npa_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-94.9214 124,-94.9214 124,-70.9214 178,-70.9214 178,-94.9214"/>
<text text-anchor="middle" x="151" y="-80.5214" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_mc</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge13" class="edge"><title>proc~npa_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M178.082,-74.1044C242.389,-54.1899 409.839,-13.721 500,-97.9214 540.962,-136.175 559.282,-546.7 563.186,-647.613"/>
<polygon fill="#000000" stroke="#000000" points="559.698,-648.001 563.573,-657.862 566.693,-647.737 559.698,-648.001"/>
</g>
<!-- proc~npa_mc&#45;&gt;proc~store_npa -->
<g id="proc~~get_fields~~CalledByGraph_edge52" class="edge"><title>proc~npa_mc&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M178.087,-91.7498C188.655,-95.4049 200.95,-99.7568 212,-103.921 230.313,-110.823 250.449,-118.898 267.371,-125.824"/>
<polygon fill="#000000" stroke="#000000" points="266.345,-129.186 276.924,-129.752 269.006,-122.712 266.345,-129.186"/>
</g>
<!-- proc~neutron_f -->
<g id="proc~~get_fields~~CalledByGraph_node19" class="node"><title>proc~neutron_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node19"><a xlink:href=".././proc/neutron_f.html" xlink:title="neutron_f">
<polygon fill="#d9534f" stroke="#d9534f" points="480,-35.9214 422,-35.9214 422,-11.9214 480,-11.9214 480,-35.9214"/>
<text text-anchor="middle" x="451" y="-21.5214" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutron_f</text>
</a>
</g>
</g>
<!-- proc~neutron_f&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge18" class="edge"><title>proc~neutron_f&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M480.149,-33.4618C487.762,-37.3897 495.212,-42.7485 500,-49.9214 567.251,-150.664 565.824,-549.353 564.407,-647.837"/>
<polygon fill="#000000" stroke="#000000" points="560.907,-647.797 564.247,-657.852 567.906,-647.909 560.907,-647.797"/>
</g>
<!-- proc~mc_fastion -->
<g id="proc~~get_fields~~CalledByGraph_node20" class="node"><title>proc~mc_fastion</title>
<g id="a_proc~~get_fields~~CalledByGraph_node20"><a xlink:href=".././proc/mc_fastion.html" xlink:title="mc_fastion">
<polygon fill="#d9534f" stroke="#d9534f" points="339,-233.921 275,-233.921 275,-209.921 339,-209.921 339,-233.921"/>
<text text-anchor="middle" x="307" y="-219.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_fastion</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;proc~get_fields -->
<g id="proc~~get_fields~~CalledByGraph_edge19" class="edge"><title>proc~mc_fastion&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M339.019,-226.904C382.542,-235.648 460.788,-258.125 500,-310.921 540.226,-365.084 557.833,-577.901 562.601,-647.652"/>
<polygon fill="#000000" stroke="#000000" points="559.128,-648.172 563.28,-657.919 566.113,-647.71 559.128,-648.172"/>
</g>
<!-- proc~npa_f -->
<g id="proc~~get_fields~~CalledByGraph_node21" class="node"><title>proc~npa_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node21"><a xlink:href=".././proc/npa_f.html" xlink:title="npa_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-178.921 124,-178.921 124,-154.921 178,-154.921 178,-178.921"/>
<text text-anchor="middle" x="151" y="-164.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_f</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~store_npa -->
<g id="proc~~get_fields~~CalledByGraph_edge53" class="edge"><title>proc~npa_f&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M178.124,-162.681C202.246,-158.765 238.424,-152.892 266.15,-148.391"/>
<polygon fill="#000000" stroke="#000000" points="267.01,-151.797 276.32,-146.74 265.888,-144.887 267.01,-151.797"/>
</g>
<!-- proc~npa_f&#45;&gt;proc~mc_fastion -->
<g id="proc~~get_fields~~CalledByGraph_edge58" class="edge"><title>proc~npa_f&#45;&gt;proc~mc_fastion</title>
<path fill="none" stroke="#000000" d="M178.124,-176.251C201.97,-184.768 237.598,-197.492 265.196,-207.348"/>
<polygon fill="#000000" stroke="#000000" points="264.369,-210.77 274.963,-210.837 266.723,-204.177 264.369,-210.77"/>
</g>
<!-- program~fidasim -->
<g id="proc~~get_fields~~CalledByGraph_node22" class="node"><title>program~fidasim</title>
<g id="a_proc~~get_fields~~CalledByGraph_node22"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-496.921 0,-496.921 0,-472.921 54,-472.921 54,-496.921"/>
<text text-anchor="middle" x="27" y="-482.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~make_diagnostic_grids -->
<g id="proc~~get_fields~~CalledByGraph_edge20" class="edge"><title>program~fidasim&#45;&gt;proc~make_diagnostic_grids</title>
<path fill="none" stroke="#000000" d="M28.3066,-497.111C30.0693,-558.431 40.6453,-832.828 90,-898.921 92.9811,-902.914 96.6727,-906.357 100.749,-909.322"/>
<polygon fill="#000000" stroke="#000000" points="99.2042,-912.482 109.551,-914.761 102.884,-906.527 99.2042,-912.482"/>
</g>
<!-- program~fidasim&#45;&gt;proc~cfpd_f -->
<g id="proc~~get_fields~~CalledByGraph_edge21" class="edge"><title>program~fidasim&#45;&gt;proc~cfpd_f</title>
<path fill="none" stroke="#000000" d="M27.8892,-496.948C27.5295,-562.66 29.039,-877.875 90,-947.921 172.046,-1042.2 339.284,-1035.53 413.323,-1027.2"/>
<polygon fill="#000000" stroke="#000000" points="414.039,-1030.63 423.549,-1025.97 413.203,-1023.68 414.039,-1030.63"/>
</g>
<!-- program~fidasim&#45;&gt;proc~neutron_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge34" class="edge"><title>program~fidasim&#45;&gt;proc~neutron_mc</title>
<path fill="none" stroke="#000000" d="M29.2122,-497.125C34.0229,-542.965 53.3166,-703.933 90,-736.921 178.132,-816.177 330.849,-805.482 405.851,-794.186"/>
<polygon fill="#000000" stroke="#000000" points="406.572,-797.616 415.903,-792.598 405.479,-790.702 406.572,-797.616"/>
</g>
<!-- program~fidasim&#45;&gt;proc~pnpa_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge35" class="edge"><title>program~fidasim&#45;&gt;proc~pnpa_mc</title>
<path fill="none" stroke="#000000" d="M28.6225,-472.742C31.6431,-418.2 46.4474,-196.848 90,-145.921 95.8891,-139.035 104.172,-134.406 112.708,-131.294"/>
<polygon fill="#000000" stroke="#000000" points="113.777,-134.628 122.338,-128.387 111.753,-127.927 113.777,-134.628"/>
</g>
<!-- program~fidasim&#45;&gt;proc~pfida_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge38" class="edge"><title>program~fidasim&#45;&gt;proc~pfida_mc</title>
<path fill="none" stroke="#000000" d="M28.6009,-497.106C31.611,-553.779 46.6637,-791.277 90,-848.921 95.9339,-856.815 104.581,-862.668 113.471,-866.965"/>
<polygon fill="#000000" stroke="#000000" points="112.149,-870.206 122.722,-870.899 114.889,-863.764 112.149,-870.206"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_weights_los -->
<g id="proc~~get_fields~~CalledByGraph_edge39" class="edge"><title>program~fidasim&#45;&gt;proc~fida_weights_los</title>
<path fill="none" stroke="#000000" d="M27.9518,-496.971C28.4721,-532.33 34.8378,-636.954 90,-694.921 92.0327,-697.058 94.2948,-698.977 96.716,-700.7"/>
<polygon fill="#000000" stroke="#000000" points="95.066,-703.79 105.46,-705.842 98.6141,-697.756 95.066,-703.79"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge40" class="edge"><title>program~fidasim&#45;&gt;proc~fida_mc</title>
<path fill="none" stroke="#000000" d="M28.9907,-496.947C32.1355,-527.387 44.5552,-608.237 90,-652.921 96.6324,-659.443 105.401,-663.946 114.18,-667.054"/>
<polygon fill="#000000" stroke="#000000" points="113.399,-670.474 123.984,-670.002 115.416,-663.771 113.399,-670.474"/>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_weights -->
<g id="proc~~get_fields~~CalledByGraph_edge41" class="edge"><title>program~fidasim&#45;&gt;proc~npa_weights</title>
<path fill="none" stroke="#000000" d="M29.4931,-472.728C35.1611,-428.378 56.723,-276.5 90,-242.921 133.234,-199.296 317.448,-187.335 404.318,-184.099"/>
<polygon fill="#000000" stroke="#000000" points="404.542,-187.594 414.413,-183.747 404.297,-180.598 404.542,-187.594"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_weights_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge50" class="edge"><title>program~fidasim&#45;&gt;proc~fida_weights_mc</title>
<path fill="none" stroke="#000000" d="M28.8712,-496.937C32.8491,-548.821 50.8047,-753.205 90,-801.921 92.5686,-805.114 95.6056,-807.923 98.9279,-810.394"/>
<polygon fill="#000000" stroke="#000000" points="97.3355,-813.526 107.67,-815.862 101.048,-807.591 97.3355,-813.526"/>
</g>
<!-- program~fidasim&#45;&gt;proc~ndmc -->
<g id="proc~~get_fields~~CalledByGraph_edge51" class="edge"><title>program~fidasim&#45;&gt;proc~ndmc</title>
<path fill="none" stroke="#000000" d="M30.7272,-497.219C36.8925,-522.207 54.2364,-579.23 90,-610.921 96.8415,-616.984 105.537,-621.322 114.17,-624.416"/>
<polygon fill="#000000" stroke="#000000" points="113.201,-627.78 123.789,-627.407 115.28,-621.096 113.201,-627.78"/>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_mc -->
<g id="proc~~get_fields~~CalledByGraph_edge56" class="edge"><title>program~fidasim&#45;&gt;proc~npa_mc</title>
<path fill="none" stroke="#000000" d="M28.3503,-472.842C30.2768,-414.458 41.347,-161.953 90,-103.921 96.1443,-96.5928 105.004,-91.8194 114.036,-88.7111"/>
<polygon fill="#000000" stroke="#000000" points="115.118,-92.0426 123.785,-85.9496 113.21,-85.3075 115.118,-92.0426"/>
</g>
<!-- program~fidasim&#45;&gt;proc~neutron_f -->
<g id="proc~~get_fields~~CalledByGraph_edge57" class="edge"><title>program~fidasim&#45;&gt;proc~neutron_f</title>
<path fill="none" stroke="#000000" d="M27.8701,-472.535C27.4782,-409.002 29.1078,-120.404 90,-61.9214 177.702,22.3095 338.477,0.923989 411.77,-14.5438"/>
<polygon fill="#000000" stroke="#000000" points="411.413,-18.0484 421.93,-16.7697 412.911,-11.2106 411.413,-18.0484"/>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_f -->
<g id="proc~~get_fields~~CalledByGraph_edge60" class="edge"><title>program~fidasim&#45;&gt;proc~npa_f</title>
<path fill="none" stroke="#000000" d="M29.0947,-472.862C33.7908,-423.496 53.6626,-237.35 90,-192.921 96.2946,-185.225 105.304,-179.752 114.435,-175.881"/>
<polygon fill="#000000" stroke="#000000" points="115.71,-179.142 123.885,-172.402 113.292,-172.573 115.71,-179.142"/>
</g>
<!-- proc~cold_spec -->
<g id="proc~~get_fields~~CalledByGraph_node23" class="node"><title>proc~cold_spec</title>
<g id="a_proc~~get_fields~~CalledByGraph_node23"><a xlink:href=".././proc/cold_spec.html" xlink:title="cold_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="337.5,-317.921 276.5,-317.921 276.5,-293.921 337.5,-293.921 337.5,-317.921"/>
<text text-anchor="middle" x="307" y="-303.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cold_spec</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~cold_spec -->
<g id="proc~~get_fields~~CalledByGraph_edge61" class="edge"><title>program~fidasim&#45;&gt;proc~cold_spec</title>
<path fill="none" stroke="#000000" d="M29.5003,-472.788C33.6093,-445.101 47.7145,-377.102 90,-343.921 140.823,-304.041 219.159,-300.331 266.213,-302.365"/>
<polygon fill="#000000" stroke="#000000" points="266.153,-305.867 276.327,-302.912 266.531,-298.877 266.153,-305.867"/>
</g>
<!-- proc~fida_f -->
<g id="proc~~get_fields~~CalledByGraph_node24" class="node"><title>proc~fida_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node24"><a xlink:href=".././proc/fida_f.html" xlink:title="fida_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-475.921 124,-475.921 124,-451.921 178,-451.921 178,-475.921"/>
<text text-anchor="middle" x="151" y="-461.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_f</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_f -->
<g id="proc~~get_fields~~CalledByGraph_edge62" class="edge"><title>program~fidasim&#45;&gt;proc~fida_f</title>
<path fill="none" stroke="#000000" d="M54.1721,-480.416C71.6205,-477.413 94.7864,-473.425 113.97,-470.123"/>
<polygon fill="#000000" stroke="#000000" points="114.61,-473.565 123.871,-468.419 113.422,-466.666 114.61,-473.565"/>
</g>
<!-- proc~halo_spec -->
<g id="proc~~get_fields~~CalledByGraph_node25" class="node"><title>proc~halo_spec</title>
<g id="a_proc~~get_fields~~CalledByGraph_node25"><a xlink:href=".././proc/halo_spec.html" xlink:title="halo_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="337.5,-443.921 276.5,-443.921 276.5,-419.921 337.5,-419.921 337.5,-443.921"/>
<text text-anchor="middle" x="307" y="-429.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">halo_spec</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~halo_spec -->
<g id="proc~~get_fields~~CalledByGraph_edge63" class="edge"><title>program~fidasim&#45;&gt;proc~halo_spec</title>
<path fill="none" stroke="#000000" d="M41.1055,-472.866C52.9172,-462.827 71.2611,-449.197 90,-442.921 149.003,-423.162 222.128,-424.375 266.368,-427.688"/>
<polygon fill="#000000" stroke="#000000" points="266.176,-431.184 276.429,-428.516 266.75,-424.207 266.176,-431.184"/>
</g>
<!-- proc~dcx_spec -->
<g id="proc~~get_fields~~CalledByGraph_node26" class="node"><title>proc~dcx_spec</title>
<g id="a_proc~~get_fields~~CalledByGraph_node26"><a xlink:href=".././proc/dcx_spec.html" xlink:title="dcx_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="336,-401.921 278,-401.921 278,-377.921 336,-377.921 336,-401.921"/>
<text text-anchor="middle" x="307" y="-387.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dcx_spec</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~dcx_spec -->
<g id="proc~~get_fields~~CalledByGraph_edge64" class="edge"><title>program~fidasim&#45;&gt;proc~dcx_spec</title>
<path fill="none" stroke="#000000" d="M35.9902,-472.678C46.4591,-457.75 66.3,-433.017 90,-420.921 146.855,-391.904 222.439,-387.655 267.468,-388.14"/>
<polygon fill="#000000" stroke="#000000" points="267.618,-391.644 277.684,-388.338 267.753,-384.645 267.618,-391.644"/>
</g>
<!-- proc~pfida_f -->
<g id="proc~~get_fields~~CalledByGraph_node27" class="node"><title>proc~pfida_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node27"><a xlink:href=".././proc/pfida_f.html" xlink:title="pfida_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-517.921 124,-517.921 124,-493.921 178,-493.921 178,-517.921"/>
<text text-anchor="middle" x="151" y="-503.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pfida_f</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~pfida_f -->
<g id="proc~~get_fields~~CalledByGraph_edge65" class="edge"><title>program~fidasim&#45;&gt;proc~pfida_f</title>
<path fill="none" stroke="#000000" d="M54.1721,-489.426C71.6205,-492.43 94.7864,-496.417 113.97,-499.72"/>
<polygon fill="#000000" stroke="#000000" points="113.422,-503.177 123.871,-501.424 114.61,-496.278 113.422,-503.177"/>
</g>
<!-- proc~dcx -->
<g id="proc~~get_fields~~CalledByGraph_node30" class="node"><title>proc~dcx</title>
<g id="a_proc~~get_fields~~CalledByGraph_node30"><a xlink:href=".././proc/dcx.html" xlink:title="dcx">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-559.921 124,-559.921 124,-535.921 178,-535.921 178,-559.921"/>
<text text-anchor="middle" x="151" y="-545.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dcx</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~dcx -->
<g id="proc~~get_fields~~CalledByGraph_edge71" class="edge"><title>program~fidasim&#45;&gt;proc~dcx</title>
<path fill="none" stroke="#000000" d="M43.6139,-497.174C55.7484,-506.271 73.2749,-518.509 90,-526.921 97.6402,-530.764 106.153,-534.205 114.309,-537.135"/>
<polygon fill="#000000" stroke="#000000" points="113.405,-540.525 124,-540.448 115.67,-533.901 113.405,-540.525"/>
</g>
<!-- proc~pnpa_f -->
<g id="proc~~get_fields~~CalledByGraph_node31" class="node"><title>proc~pnpa_f</title>
<g id="a_proc~~get_fields~~CalledByGraph_node31"><a xlink:href=".././proc/pnpa_f.html" xlink:title="pnpa_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-275.921 124,-275.921 124,-251.921 178,-251.921 178,-275.921"/>
<text text-anchor="middle" x="151" y="-261.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pnpa_f</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~pnpa_f -->
<g id="proc~~get_fields~~CalledByGraph_edge72" class="edge"><title>program~fidasim&#45;&gt;proc~pnpa_f</title>
<path fill="none" stroke="#000000" d="M28.7716,-472.62C31.4445,-439.743 42.9314,-348.626 90,-293.921 96.5396,-286.321 105.467,-280.44 114.436,-275.981"/>
<polygon fill="#000000" stroke="#000000" points="116,-279.115 123.699,-271.837 113.142,-272.725 116,-279.115"/>
</g>
<!-- proc~nbi_spec -->
<g id="proc~~get_fields~~CalledByGraph_node32" class="node"><title>proc~nbi_spec</title>
<g id="a_proc~~get_fields~~CalledByGraph_node32"><a xlink:href=".././proc/nbi_spec.html" xlink:title="nbi_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="334.5,-359.921 279.5,-359.921 279.5,-335.921 334.5,-335.921 334.5,-359.921"/>
<text text-anchor="middle" x="307" y="-345.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nbi_spec</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~nbi_spec -->
<g id="proc~~get_fields~~CalledByGraph_edge73" class="edge"><title>program~fidasim&#45;&gt;proc~nbi_spec</title>
<path fill="none" stroke="#000000" d="M31.8653,-472.866C39.3688,-451.553 58.0408,-407.446 90,-385.921 144.349,-349.317 223.24,-344.754 269.115,-345.695"/>
<polygon fill="#000000" stroke="#000000" points="269.105,-349.197 279.207,-346.003 269.318,-342.2 269.105,-349.197"/>
</g>
<!-- proc~halo -->
<g id="proc~~get_fields~~CalledByGraph_node33" class="node"><title>proc~halo</title>
<g id="a_proc~~get_fields~~CalledByGraph_node33"><a xlink:href=".././proc/halo.html" xlink:title="halo">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-601.921 124,-601.921 124,-577.921 178,-577.921 178,-601.921"/>
<text text-anchor="middle" x="151" y="-587.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">halo</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~halo -->
<g id="proc~~get_fields~~CalledByGraph_edge74" class="edge"><title>program~fidasim&#45;&gt;proc~halo</title>
<path fill="none" stroke="#000000" d="M33.8933,-497.01C43.3186,-515.14 63.4579,-549.332 90,-568.921 97.1481,-574.197 105.734,-578.231 114.146,-581.283"/>
<polygon fill="#000000" stroke="#000000" points="113.252,-584.673 123.844,-584.43 115.413,-578.015 113.252,-584.673"/>
</g>
<!-- proc~cold_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge42" class="edge"><title>proc~cold_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M337.511,-312.254C347.351,-315.438 357.868,-320.119 366,-326.921 406.299,-360.628 431.542,-418.934 442.918,-450.361"/>
<polygon fill="#000000" stroke="#000000" points="439.65,-451.622 446.245,-459.914 446.261,-449.319 439.65,-451.622"/>
</g>
<!-- proc~fida_f&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge28" class="edge"><title>proc~fida_f&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.039,-467.448C189.867,-470.315 203.159,-475.51 212,-484.921 252.461,-527.994 218.354,-561.799 248,-612.921 256.84,-628.166 270.529,-642.35 282.388,-652.988"/>
<polygon fill="#000000" stroke="#000000" points="280.368,-655.868 290.223,-659.756 284.943,-650.571 280.368,-655.868"/>
</g>
<!-- proc~fida_f&#45;&gt;proc~mc_fastion -->
<g id="proc~~get_fields~~CalledByGraph_edge59" class="edge"><title>proc~fida_f&#45;&gt;proc~mc_fastion</title>
<path fill="none" stroke="#000000" d="M153.849,-451.701C160.057,-414.828 183.518,-303.5 248,-242.921 252.982,-238.241 259.085,-234.589 265.441,-231.744"/>
<polygon fill="#000000" stroke="#000000" points="266.758,-234.987 274.832,-228.126 264.242,-228.455 266.758,-234.987"/>
</g>
<!-- proc~fida_f&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge69" class="edge"><title>proc~fida_f&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M178.124,-472.064C199.811,-478.823 231.243,-488.62 257.516,-496.81"/>
<polygon fill="#000000" stroke="#000000" points="256.714,-500.226 267.302,-499.86 258.797,-493.543 256.714,-500.226"/>
</g>
<!-- proc~halo_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge43" class="edge"><title>proc~halo_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M337.768,-440.307C355.952,-445.429 379.657,-452.107 400.594,-458.004"/>
<polygon fill="#000000" stroke="#000000" points="399.725,-461.396 410.3,-460.738 401.623,-454.658 399.725,-461.396"/>
</g>
<!-- proc~dcx_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge44" class="edge"><title>proc~dcx_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M336.119,-398.323C345.838,-401.687 356.634,-405.953 366,-410.921 388.506,-422.861 411.77,-440.214 428.092,-453.362"/>
<polygon fill="#000000" stroke="#000000" points="426,-456.173 435.953,-459.803 430.436,-450.758 426,-456.173"/>
</g>
<!-- proc~pfida_f&#45;&gt;proc~track_cylindrical -->
<g id="proc~~get_fields~~CalledByGraph_edge24" class="edge"><title>proc~pfida_f&#45;&gt;proc~track_cylindrical</title>
<path fill="none" stroke="#000000" d="M178.294,-509.215C190.181,-512.029 203.449,-517.247 212,-526.921 261.996,-583.486 231.436,-619.268 248,-692.921 266.898,-776.957 290.473,-876.666 300.775,-920"/>
<polygon fill="#000000" stroke="#000000" points="297.377,-920.841 303.097,-929.759 304.187,-919.22 297.377,-920.841"/>
</g>
<!-- proc~pfida_f&#45;&gt;proc~mc_fastion_pass_grid -->
<g id="proc~~get_fields~~CalledByGraph_edge36" class="edge"><title>proc~pfida_f&#45;&gt;proc~mc_fastion_pass_grid</title>
<path fill="none" stroke="#000000" d="M178.142,-502.832C190.142,-500.066 203.55,-494.83 212,-484.921 270.605,-416.2 189.764,-353.956 248,-284.921 248.742,-284.041 249.525,-283.198 250.342,-282.391"/>
<polygon fill="#000000" stroke="#000000" points="252.776,-284.932 258.526,-276.033 248.482,-279.404 252.776,-284.932"/>
</g>
<!-- proc~pfida_f&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge67" class="edge"><title>proc~pfida_f&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M178.124,-506.939C196.364,-507.65 221.497,-508.629 244.657,-509.531"/>
<polygon fill="#000000" stroke="#000000" points="244.652,-513.034 254.78,-509.926 244.924,-506.039 244.652,-513.034"/>
</g>
<!-- proc~store_fida_photons&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge45" class="edge"><title>proc~store_fida_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M350.605,-499.92C366.3,-495.499 384.212,-490.453 400.467,-485.874"/>
<polygon fill="#000000" stroke="#000000" points="401.663,-489.174 410.339,-483.094 399.764,-482.436 401.663,-489.174"/>
</g>
<!-- proc~store_nbi_photons&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge46" class="edge"><title>proc~store_nbi_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M341.232,-579.893C349.702,-576.074 358.518,-571.393 366,-565.921 394.596,-545.007 420.614,-512.958 435.881,-492.217"/>
<polygon fill="#000000" stroke="#000000" points="438.734,-494.245 441.742,-484.087 433.055,-490.152 438.734,-494.245"/>
</g>
<!-- proc~dcx&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge31" class="edge"><title>proc~dcx&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.283,-553.738C189.352,-557.014 201.965,-561.895 212,-568.921 232.697,-583.414 231.126,-594.115 248,-612.921 260.158,-626.472 274.495,-641.068 285.873,-652.352"/>
<polygon fill="#000000" stroke="#000000" points="283.633,-655.058 293.214,-659.581 288.545,-650.071 283.633,-655.058"/>
</g>
<!-- proc~dcx&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge47" class="edge"><title>proc~dcx&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M178.257,-541.524C189.198,-538.166 201.721,-533.381 212,-526.921 231.159,-514.882 227.524,-500.551 248,-490.921 296.146,-468.279 357.799,-465.741 400.26,-467.466"/>
<polygon fill="#000000" stroke="#000000" points="400.19,-470.967 410.353,-467.971 400.54,-463.976 400.19,-470.967"/>
</g>
<!-- proc~pnpa_f&#45;&gt;proc~mc_fastion_pass_grid -->
<g id="proc~~get_fields~~CalledByGraph_edge37" class="edge"><title>proc~pnpa_f&#45;&gt;proc~mc_fastion_pass_grid</title>
<path fill="none" stroke="#000000" d="M178.124,-263.921C194.718,-263.921 217.019,-263.921 238.348,-263.921"/>
<polygon fill="#000000" stroke="#000000" points="238.382,-267.422 248.382,-263.921 238.382,-260.422 238.382,-267.422"/>
</g>
<!-- proc~pnpa_f&#45;&gt;proc~store_npa -->
<g id="proc~~get_fields~~CalledByGraph_edge55" class="edge"><title>proc~pnpa_f&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M167.329,-251.778C194.426,-230.311 250.93,-185.548 282.814,-160.29"/>
<polygon fill="#000000" stroke="#000000" points="285.068,-162.969 290.733,-154.016 280.721,-157.482 285.068,-162.969"/>
</g>
<!-- proc~nbi_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge48" class="edge"><title>proc~nbi_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M334.575,-354.244C344.988,-357.535 356.654,-362.291 366,-368.921 397.262,-391.099 423.321,-427.863 437.767,-450.946"/>
<polygon fill="#000000" stroke="#000000" points="434.868,-452.915 443.06,-459.634 440.846,-449.273 434.868,-452.915"/>
</g>
<!-- proc~halo&#45;&gt;proc~track -->
<g id="proc~~get_fields~~CalledByGraph_edge33" class="edge"><title>proc~halo&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.245,-597.598C188.949,-601.113 201.3,-605.671 212,-610.921 237.029,-623.202 263.492,-640.849 281.94,-654.005"/>
<polygon fill="#000000" stroke="#000000" points="279.91,-656.857 290.065,-659.879 284.012,-651.184 279.91,-656.857"/>
</g>
<!-- proc~halo&#45;&gt;proc~store_photons -->
<g id="proc~~get_fields~~CalledByGraph_edge49" class="edge"><title>proc~halo&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M178.032,-584.246C227.336,-573.292 332.411,-548.907 366,-532.921 389.282,-521.841 412.775,-504.095 428.973,-490.593"/>
<polygon fill="#000000" stroke="#000000" points="431.396,-493.127 436.739,-483.977 426.857,-487.798 431.396,-493.127"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/get_fields.html#src">get_fields</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">get_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="n">ind</span><span class="p">,</span><span class="w"> </span><span class="n">input_coords</span><span class="p">,</span><span class="w"> </span><span class="n">output_coords</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="c">!+ Gets electro-magnetic fields at position `pos` or [[libfida:beam_grid]] indices `ind`</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w">                    </span><span class="kd">::</span><span class="w"> </span><span class="n">fields</span><span class="w"></span>
<span class="w">        </span><span class="c">!+ Electro-magnetic fields at `pos`/`ind`</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">pos</span><span class="w"></span>
<span class="w">        </span><span class="c">!+ Position in beam grid coordinates</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ind</span><span class="w"></span>
<span class="w">        </span><span class="c">!+ [[libfida:beam_grid]] indices</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">input_coords</span><span class="w"></span>
<span class="w">        </span><span class="c">!+ Indicates coordinate system of inputs. Beam grid (0), machine (1) and cylindrical (2)</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">output_coords</span><span class="w"></span>
<span class="w">        </span><span class="c">!+ Indicates coordinate system of outputs. Beam grid (0), machine (1) and cylindrical (2)</span>

<span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">inp</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xyz</span><span class="p">,</span><span class="w"> </span><span class="n">uvw</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">uvw_bfield</span><span class="p">,</span><span class="w"> </span><span class="n">uvw_efield</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xyz_bfield</span><span class="p">,</span><span class="w"> </span><span class="n">xyz_efield</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">phi</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">InterpolCoeffs3D</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">coeffs</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">k2</span><span class="p">,</span><span class="w"> </span><span class="n">mc</span><span class="p">,</span><span class="w"> </span><span class="n">ocs</span><span class="p">,</span><span class="w"> </span><span class="n">ics</span><span class="w"></span>

<span class="w">    </span><span class="n">fields</span><span class="p">%</span><span class="n">in_plasma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">False</span><span class="p">.</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">input_coords</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">ics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input_coords</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span>
<span class="k">        </span><span class="n">ics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">    if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">output_coords</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">ocs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">output_coords</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span>
<span class="k">        </span><span class="n">ocs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">    if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">ind</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">get_position</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">xyz</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">        if</span><span class="p">(</span><span class="n">ics</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">xyz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">xyz_to_uvw</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span><span class="w"> </span><span class="n">uvw</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">        if</span><span class="p">(</span><span class="n">ics</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">uvw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">uvw_to_xyz</span><span class="p">(</span><span class="n">uvw</span><span class="p">,</span><span class="w"> </span><span class="n">xyz</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">    endif</span>

<span class="k">    call </span><span class="n">in_plasma</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span><span class="n">inp</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">coeffs</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">i</span><span class="w"></span>
<span class="w">        </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">j</span><span class="w"></span>
<span class="w">        </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">k</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">inter_grid</span><span class="p">%</span><span class="n">nphi</span><span class="w"> </span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">k2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">inter_grid</span><span class="p">%</span><span class="n">nphi</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">else</span>
<span class="k">            </span><span class="n">k2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>

<span class="k">        </span><span class="n">fields</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b111</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b121</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                 </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b112</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k2</span><span class="p">)</span><span class="w">   </span><span class="o">+</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b122</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                 </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b211</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b221</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                 </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b212</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">coeffs</span><span class="p">%</span><span class="n">b222</span><span class="o">*</span><span class="n">equil</span><span class="p">%</span><span class="n">fields</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k2</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">atan2</span><span class="p">(</span><span class="n">uvw</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">uvw</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">        </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="c">!Convert cylindrical coordinates to uvw</span>
<span class="w">        </span><span class="n">uvw_bfield</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">br</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">bt</span><span class="w"></span>
<span class="w">        </span><span class="n">uvw_bfield</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">br</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">bt</span><span class="w"></span>
<span class="w">        </span><span class="n">uvw_bfield</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fields</span><span class="p">%</span><span class="n">bz</span><span class="w"></span>
<span class="w">        </span><span class="n">uvw_efield</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">er</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">et</span><span class="w"></span>
<span class="w">        </span><span class="n">uvw_efield</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">er</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">fields</span><span class="p">%</span><span class="n">et</span><span class="w"></span>
<span class="w">        </span><span class="n">uvw_efield</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fields</span><span class="p">%</span><span class="n">ez</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">ocs</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">            </span><span class="c">!Represent fields in beam grid coordinates</span>
<span class="w">            </span><span class="n">xyz_bfield</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">matmul</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">inv_basis</span><span class="p">,</span><span class="n">uvw_bfield</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">xyz_efield</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">matmul</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">inv_basis</span><span class="p">,</span><span class="n">uvw_efield</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">fields</span><span class="p">%</span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xyz</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">        if</span><span class="p">(</span><span class="n">ocs</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">xyz_bfield</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uvw_bfield</span><span class="w"></span>
<span class="w">            </span><span class="n">xyz_efield</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uvw_efield</span><span class="w"></span>
<span class="w">            </span><span class="n">fields</span><span class="p">%</span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uvw</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span><span class="w"></span>

<span class="w">        </span><span class="c">!Calculate field directions and magnitudes</span>
<span class="w">        </span><span class="n">fields</span><span class="p">%</span><span class="n">b_abs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">norm2</span><span class="p">(</span><span class="n">xyz_bfield</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">fields</span><span class="p">%</span><span class="n">e_abs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">norm2</span><span class="p">(</span><span class="n">xyz_efield</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">fields</span><span class="p">%</span><span class="n">b_abs</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">)</span><span class="w"> </span><span class="n">fields</span><span class="p">%</span><span class="n">b_norm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xyz_bfield</span><span class="o">/</span><span class="n">fields</span><span class="p">%</span><span class="n">b_abs</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">fields</span><span class="p">%</span><span class="n">e_abs</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">)</span><span class="w"> </span><span class="n">fields</span><span class="p">%</span><span class="n">e_norm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xyz_efield</span><span class="o">/</span><span class="n">fields</span><span class="p">%</span><span class="n">e_abs</span><span class="w"></span>

<span class="w">        </span><span class="k">call </span><span class="n">calc_perp_vectors</span><span class="p">(</span><span class="n">fields</span><span class="p">%</span><span class="n">b_norm</span><span class="p">,</span><span class="n">fields</span><span class="p">%</span><span class="n">a_norm</span><span class="p">,</span><span class="n">fields</span><span class="p">%</span><span class="n">c_norm</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">fields</span><span class="p">%</span><span class="n">uvw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uvw</span><span class="w"></span>
<span class="w">        </span><span class="n">fields</span><span class="p">%</span><span class="n">in_plasma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">True</span><span class="p">.</span><span class="w"></span>
<span class="w">        </span><span class="n">fields</span><span class="p">%</span><span class="n">coords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ocs</span><span class="w"></span>
<span class="w">        </span><span class="n">fields</span><span class="p">%</span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coeffs</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">end subroutine </span><span class="n">get_fields</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>