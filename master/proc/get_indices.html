<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="">
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>get_indices &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>User Guide</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>get_indices
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.1% of total for procedures.">18 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
     <li><a href='../module/libfida.html'>libfida</a></li>
     <li class="active">get_indices</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/get_indices.html#src">get_indices</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public subroutine get_indices(pos, ind)</h2>
    

    <p>Find closests <a href="../module/libfida.html#variable-beam_grid">beam_grid</a> indices <code>ind</code> to position <code>pos</code></p>

    <h3>Arguments</h3>
      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-pos%7E4"></span>real(kind=Float64),</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(3)</td><td>::</td>
  <td><strong>pos</strong></td><td><p>Position [cm]</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ind%7E3"></span>integer(kind=Int32),</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(3)</td><td>::</td>
  <td><strong>ind</strong></td><td><p>Closest indices to position</p></td>
</tr>
</tbody>
</table>

    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~get_indices~~CalledByGraph Pages: 1 -->
<svg id="procget_indicesCalledByGraph" width="598pt" height="650pt"
 viewBox="0.00 0.00 598.00 650.24" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~get_indices~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 646.24)">
<title>proc~~get_indices~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-646.24 594,-646.24 594,4 -4,4"/>
<!-- proc~get_indices -->
<g id="proc~~get_indices~~CalledByGraph_node1" class="node"><title>proc~get_indices</title>
<polygon fill="none" stroke="black" points="589.5,-351.145 522.5,-351.145 522.5,-327.145 589.5,-327.145 589.5,-351.145"/>
<text text-anchor="middle" x="556" y="-336.745" font-family="Helvetica,sans-Serif" font-size="10.50">get_indices</text>
</g>
<!-- proc~track -->
<g id="proc~~get_indices~~CalledByGraph_node2" class="node"><title>proc~track</title>
<g id="a_proc~~get_indices~~CalledByGraph_node2"><a xlink:href=".././proc/track.html" xlink:title="track">
<polygon fill="#d9534f" stroke="#d9534f" points="327,-430.145 273,-430.145 273,-406.145 327,-406.145 327,-430.145"/>
<text text-anchor="middle" x="300" y="-415.745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~get_indices -->
<g id="proc~~get_indices~~CalledByGraph_edge1" class="edge"><title>proc~track&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M327.226,-409.989C371.046,-396.359 459.54,-368.836 512.397,-352.396"/>
<polygon fill="#000000" stroke="#000000" points="513.642,-355.674 522.152,-349.362 511.563,-348.99 513.642,-355.674"/>
</g>
<!-- proc~store_fw_photons -->
<g id="proc~~get_indices~~CalledByGraph_node3" class="node"><title>proc~store_fw_photons</title>
<g id="a_proc~~get_indices~~CalledByGraph_node3"><a xlink:href=".././proc/store_fw_photons.html" xlink:title="store_fw_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="485.5,-533.145 388.5,-533.145 388.5,-509.145 485.5,-509.145 485.5,-533.145"/>
<text text-anchor="middle" x="437" y="-518.745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_fw_photons</text>
</a>
</g>
</g>
<!-- proc~store_fw_photons&#45;&gt;proc~get_indices -->
<g id="proc~~get_indices~~CalledByGraph_edge4" class="edge"><title>proc~store_fw_photons&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M445.858,-508.921C465.507,-478.356 516.954,-398.329 541.54,-360.084"/>
<polygon fill="#000000" stroke="#000000" points="544.712,-361.621 547.176,-351.316 538.824,-357.836 544.712,-361.621"/>
</g>
<!-- proc~npa_mc -->
<g id="proc~~get_indices~~CalledByGraph_node4" class="node"><title>proc~npa_mc</title>
<g id="a_proc~~get_indices~~CalledByGraph_node4"><a xlink:href=".././proc/npa_mc.html" xlink:title="npa_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="464,-616.145 410,-616.145 410,-592.145 464,-592.145 464,-616.145"/>
<text text-anchor="middle" x="437" y="-601.745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_mc</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~get_indices -->
<g id="proc~~get_indices~~CalledByGraph_edge2" class="edge"><title>proc~npa_mc&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M449.648,-591.717C460.321,-579.781 475.945,-560.85 486,-542.145 519.204,-480.375 540.907,-399.576 550.053,-361.212"/>
<polygon fill="#000000" stroke="#000000" points="553.537,-361.684 552.394,-351.151 546.719,-360.098 553.537,-361.684"/>
</g>
<!-- proc~store_photons -->
<g id="proc~~get_indices~~CalledByGraph_node5" class="node"><title>proc~store_photons</title>
<g id="a_proc~~get_indices~~CalledByGraph_node5"><a xlink:href=".././proc/store_photons.html" xlink:title="store_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="477.5,-269.145 396.5,-269.145 396.5,-245.145 477.5,-245.145 477.5,-269.145"/>
<text text-anchor="middle" x="437" y="-254.745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_photons</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_indices -->
<g id="proc~~get_indices~~CalledByGraph_edge6" class="edge"><title>proc~store_photons&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M455.264,-269.245C474.792,-282.931 506.795,-305.36 529.27,-321.113"/>
<polygon fill="#000000" stroke="#000000" points="527.468,-324.123 537.665,-326.996 531.485,-318.391 527.468,-324.123"/>
</g>
<!-- proc~npa_f -->
<g id="proc~~get_indices~~CalledByGraph_node6" class="node"><title>proc~npa_f</title>
<g id="a_proc~~get_indices~~CalledByGraph_node6"><a xlink:href=".././proc/npa_f.html" xlink:title="npa_f">
<polygon fill="#d9534f" stroke="#d9534f" points="464,-127.145 410,-127.145 410,-103.145 464,-103.145 464,-127.145"/>
<text text-anchor="middle" x="437" y="-112.745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_f</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~get_indices -->
<g id="proc~~get_indices~~CalledByGraph_edge3" class="edge"><title>proc~npa_f&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M444.29,-127.189C463.217,-163.424 519.811,-271.775 543.923,-317.938"/>
<polygon fill="#000000" stroke="#000000" points="540.946,-319.799 548.678,-327.043 547.151,-316.559 540.946,-319.799"/>
</g>
<!-- proc~store_photon_birth -->
<g id="proc~~get_indices~~CalledByGraph_node7" class="node"><title>proc~store_photon_birth</title>
<g id="a_proc~~get_indices~~CalledByGraph_node7"><a xlink:href=".././proc/store_photon_birth.html" xlink:title="store_photon_birth">
<polygon fill="#d9534f" stroke="#d9534f" points="351.5,-312.145 248.5,-312.145 248.5,-288.145 351.5,-288.145 351.5,-312.145"/>
<text text-anchor="middle" x="300" y="-297.745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_photon_birth</text>
</a>
</g>
</g>
<!-- proc~store_photon_birth&#45;&gt;proc~get_indices -->
<g id="proc~~get_indices~~CalledByGraph_edge5" class="edge"><title>proc~store_photon_birth&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M351.79,-307.944C398.834,-315.167 468.017,-325.79 512.287,-332.587"/>
<polygon fill="#000000" stroke="#000000" points="512.015,-336.086 522.43,-334.145 513.077,-329.167 512.015,-336.086"/>
</g>
<!-- proc~store_fida_photons -->
<g id="proc~~get_indices~~CalledByGraph_node8" class="node"><title>proc~store_fida_photons</title>
<g id="a_proc~~get_indices~~CalledByGraph_node8"><a xlink:href=".././proc/store_fida_photons.html" xlink:title="store_fida_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="352,-269.145 248,-269.145 248,-245.145 352,-245.145 352,-269.145"/>
<text text-anchor="middle" x="300" y="-254.745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_fida_photons</text>
</a>
</g>
</g>
<!-- proc~store_fida_photons&#45;&gt;proc~store_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge17" class="edge"><title>proc~store_fida_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M352.038,-257.145C363.242,-257.145 375.092,-257.145 386.245,-257.145"/>
<polygon fill="#000000" stroke="#000000" points="386.254,-260.646 396.254,-257.145 386.254,-253.646 386.254,-260.646"/>
</g>
<!-- proc~halo -->
<g id="proc~~get_indices~~CalledByGraph_node9" class="node"><title>proc~halo</title>
<g id="a_proc~~get_indices~~CalledByGraph_node9"><a xlink:href=".././proc/halo.html" xlink:title="halo">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-419.145 124,-419.145 124,-395.145 178,-395.145 178,-419.145"/>
<text text-anchor="middle" x="151" y="-404.745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">halo</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~track -->
<g id="proc~~get_indices~~CalledByGraph_edge12" class="edge"><title>proc~halo&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.281,-409.112C201.797,-410.872 236.498,-413.468 262.668,-415.427"/>
<polygon fill="#000000" stroke="#000000" points="262.714,-418.94 272.947,-416.196 263.236,-411.959 262.714,-418.94"/>
</g>
<!-- proc~halo&#45;&gt;proc~store_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge22" class="edge"><title>proc~halo&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M178.181,-404.554C218.288,-399.589 296.151,-385.948 352,-351.145 382.393,-332.206 408.25,-299.076 422.953,-277.633"/>
<polygon fill="#000000" stroke="#000000" points="425.918,-279.495 428.553,-269.233 420.094,-275.613 425.918,-279.495"/>
</g>
<!-- proc~halo&#45;&gt;proc~store_photon_birth -->
<g id="proc~~get_indices~~CalledByGraph_edge29" class="edge"><title>proc~halo&#45;&gt;proc~store_photon_birth</title>
<path fill="none" stroke="#000000" d="M178.238,-400.719C189.177,-397.356 201.702,-392.575 212,-386.145 240.561,-368.313 267.113,-339.584 283.191,-320.295"/>
<polygon fill="#000000" stroke="#000000" points="286.007,-322.38 289.613,-312.417 280.582,-317.956 286.007,-322.38"/>
</g>
<!-- proc~make_diagnostic_grids -->
<g id="proc~~get_indices~~CalledByGraph_node10" class="node"><title>proc~make_diagnostic_grids</title>
<g id="a_proc~~get_indices~~CalledByGraph_node10"><a xlink:href=".././proc/make_diagnostic_grids.html" xlink:title="make_diagnostic_grids">
<polygon fill="#d9534f" stroke="#d9534f" points="212,-503.145 90,-503.145 90,-479.145 212,-479.145 212,-503.145"/>
<text text-anchor="middle" x="151" y="-488.745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">make_diagnostic_grids</text>
</a>
</g>
</g>
<!-- proc~make_diagnostic_grids&#45;&gt;proc~track -->
<g id="proc~~get_indices~~CalledByGraph_edge7" class="edge"><title>proc~make_diagnostic_grids&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M190.233,-479.067C197.565,-476.386 205.103,-473.373 212,-470.145 233.112,-460.265 255.671,-446.687 272.525,-435.883"/>
<polygon fill="#000000" stroke="#000000" points="274.78,-438.592 281.257,-430.207 270.965,-432.723 274.78,-438.592"/>
</g>
<!-- proc~fida_weights_los -->
<g id="proc~~get_indices~~CalledByGraph_node11" class="node"><title>proc~fida_weights_los</title>
<g id="a_proc~~get_indices~~CalledByGraph_node11"><a xlink:href=".././proc/fida_weights_los.html" xlink:title="fida_weights_los">
<polygon fill="#d9534f" stroke="#d9534f" points="196.5,-461.145 105.5,-461.145 105.5,-437.145 196.5,-437.145 196.5,-461.145"/>
<text text-anchor="middle" x="151" y="-446.745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_weights_los</text>
</a>
</g>
</g>
<!-- proc~fida_weights_los&#45;&gt;proc~track -->
<g id="proc~~get_indices~~CalledByGraph_edge8" class="edge"><title>proc~fida_weights_los&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M196.504,-439.76C217.66,-435.299 242.634,-430.032 262.633,-425.815"/>
<polygon fill="#000000" stroke="#000000" points="263.528,-429.203 272.591,-423.715 262.084,-422.354 263.528,-429.203"/>
</g>
<!-- proc~halo_spec -->
<g id="proc~~get_indices~~CalledByGraph_node12" class="node"><title>proc~halo_spec</title>
<g id="a_proc~~get_indices~~CalledByGraph_node12"><a xlink:href=".././proc/halo_spec.html" xlink:title="halo_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="330.5,-225.145 269.5,-225.145 269.5,-201.145 330.5,-201.145 330.5,-225.145"/>
<text text-anchor="middle" x="300" y="-210.745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">halo_spec</text>
</a>
</g>
</g>
<!-- proc~halo_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge19" class="edge"><title>proc~halo_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M330.626,-222.801C347.757,-228.385 369.7,-235.536 389.122,-241.867"/>
<polygon fill="#000000" stroke="#000000" points="388.123,-245.222 398.716,-244.993 390.292,-238.567 388.123,-245.222"/>
</g>
<!-- proc~pfida_f -->
<g id="proc~~get_indices~~CalledByGraph_node13" class="node"><title>proc~pfida_f</title>
<g id="a_proc~~get_indices~~CalledByGraph_node13"><a xlink:href=".././proc/pfida_f.html" xlink:title="pfida_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-251.145 124,-251.145 124,-227.145 178,-227.145 178,-251.145"/>
<text text-anchor="middle" x="151" y="-236.745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pfida_f</text>
</a>
</g>
</g>
<!-- proc~pfida_f&#45;&gt;proc~store_photon_birth -->
<g id="proc~~get_indices~~CalledByGraph_edge26" class="edge"><title>proc~pfida_f&#45;&gt;proc~store_photon_birth</title>
<path fill="none" stroke="#000000" d="M178.264,-247.531C188.858,-251.122 201.124,-255.545 212,-260.145 228.475,-267.114 231.781,-270.6 248,-278.145 252.145,-280.074 256.503,-282.042 260.854,-283.97"/>
<polygon fill="#000000" stroke="#000000" points="259.717,-287.293 270.282,-288.094 262.522,-280.879 259.717,-287.293"/>
</g>
<!-- proc~pfida_f&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge35" class="edge"><title>proc~pfida_f&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M178.281,-242.363C194.888,-244.397 217.072,-247.113 237.89,-249.663"/>
<polygon fill="#000000" stroke="#000000" points="237.619,-253.155 247.97,-250.897 238.47,-246.207 237.619,-253.155"/>
</g>
<!-- proc~store_nbi_photons -->
<g id="proc~~get_indices~~CalledByGraph_node14" class="node"><title>proc~store_nbi_photons</title>
<g id="a_proc~~get_indices~~CalledByGraph_node14"><a xlink:href=".././proc/store_nbi_photons.html" xlink:title="store_nbi_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="350.5,-503.145 249.5,-503.145 249.5,-479.145 350.5,-479.145 350.5,-503.145"/>
<text text-anchor="middle" x="300" y="-488.745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_nbi_photons</text>
</a>
</g>
</g>
<!-- proc~store_nbi_photons&#45;&gt;proc~store_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge20" class="edge"><title>proc~store_nbi_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M315.348,-479.01C326.401,-469.117 341.514,-454.34 352,-439.145 388.542,-386.193 416.113,-314.804 428.613,-279.223"/>
<polygon fill="#000000" stroke="#000000" points="432.052,-279.985 432.002,-269.39 425.434,-277.704 432.052,-279.985"/>
</g>
<!-- program~fidasim -->
<g id="proc~~get_indices~~CalledByGraph_node15" class="node"><title>program~fidasim</title>
<g id="a_proc~~get_indices~~CalledByGraph_node15"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-314.145 0,-314.145 0,-290.145 54,-290.145 54,-314.145"/>
<text text-anchor="middle" x="27" y="-299.745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_mc -->
<g id="proc~~get_indices~~CalledByGraph_edge16" class="edge"><title>program~fidasim&#45;&gt;proc~npa_mc</title>
<path fill="none" stroke="#000000" d="M28.6332,-314.368C31.5429,-365.227 45.4552,-559.153 90,-596.145 179.254,-670.267 330.705,-637.127 399.753,-616.363"/>
<polygon fill="#000000" stroke="#000000" points="401.198,-619.579 409.716,-613.279 399.128,-612.892 401.198,-619.579"/>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_f -->
<g id="proc~~get_indices~~CalledByGraph_edge25" class="edge"><title>program~fidasim&#45;&gt;proc~npa_f</title>
<path fill="none" stroke="#000000" d="M29.1863,-289.991C33.9036,-244.341 52.9038,-84.1067 90,-52.1454 178.362,23.9853 243.436,5.48677 352,-37.1454 381.397,-48.6892 406.627,-75.8948 421.559,-94.9085"/>
<polygon fill="#000000" stroke="#000000" points="418.846,-97.1235 427.674,-102.982 424.427,-92.8974 418.846,-97.1235"/>
</g>
<!-- program~fidasim&#45;&gt;proc~halo -->
<g id="proc~~get_indices~~CalledByGraph_edge36" class="edge"><title>program~fidasim&#45;&gt;proc~halo</title>
<path fill="none" stroke="#000000" d="M33.8933,-314.234C43.3186,-332.364 63.4579,-366.556 90,-386.145 97.1481,-391.421 105.734,-395.455 114.146,-398.507"/>
<polygon fill="#000000" stroke="#000000" points="113.252,-401.897 123.844,-401.654 115.413,-395.239 113.252,-401.897"/>
</g>
<!-- program~fidasim&#45;&gt;proc~make_diagnostic_grids -->
<g id="proc~~get_indices~~CalledByGraph_edge37" class="edge"><title>program~fidasim&#45;&gt;proc~make_diagnostic_grids</title>
<path fill="none" stroke="#000000" d="M28.9907,-314.171C32.1355,-344.611 44.5552,-425.461 90,-470.145 91.2443,-471.369 92.5639,-472.521 93.9446,-473.607"/>
<polygon fill="#000000" stroke="#000000" points="92.1319,-476.603 102.423,-479.121 95.9484,-470.735 92.1319,-476.603"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_weights_los -->
<g id="proc~~get_indices~~CalledByGraph_edge38" class="edge"><title>program~fidasim&#45;&gt;proc~fida_weights_los</title>
<path fill="none" stroke="#000000" d="M30.7272,-314.443C36.8925,-339.431 54.2364,-396.454 90,-428.145 91.9514,-429.875 94.0536,-431.464 96.2622,-432.923"/>
<polygon fill="#000000" stroke="#000000" points="94.779,-436.104 105.214,-437.937 98.1996,-429.997 94.779,-436.104"/>
</g>
<!-- program~fidasim&#45;&gt;proc~halo_spec -->
<g id="proc~~get_indices~~CalledByGraph_edge39" class="edge"><title>program~fidasim&#45;&gt;proc~halo_spec</title>
<path fill="none" stroke="#000000" d="M29.7265,-290C34.1939,-263.699 48.8114,-201.783 90,-176.145 136.033,-147.492 158.87,-165.317 212,-176.145 222.504,-178.286 244.94,-187.876 264.396,-196.755"/>
<polygon fill="#000000" stroke="#000000" points="263.096,-200.01 273.643,-201.021 266.029,-193.654 263.096,-200.01"/>
</g>
<!-- program~fidasim&#45;&gt;proc~pfida_f -->
<g id="proc~~get_indices~~CalledByGraph_edge40" class="edge"><title>program~fidasim&#45;&gt;proc~pfida_f</title>
<path fill="none" stroke="#000000" d="M43.6139,-289.893C55.7484,-280.796 73.2749,-268.558 90,-260.145 97.6402,-256.302 106.153,-252.862 114.309,-249.932"/>
<polygon fill="#000000" stroke="#000000" points="115.67,-253.166 124,-246.619 113.405,-246.542 115.67,-253.166"/>
</g>
<!-- proc~nbi_spec -->
<g id="proc~~get_indices~~CalledByGraph_node16" class="node"><title>proc~nbi_spec</title>
<g id="a_proc~~get_indices~~CalledByGraph_node16"><a xlink:href=".././proc/nbi_spec.html" xlink:title="nbi_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="327.5,-179.145 272.5,-179.145 272.5,-155.145 327.5,-155.145 327.5,-179.145"/>
<text text-anchor="middle" x="300" y="-164.745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nbi_spec</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~nbi_spec -->
<g id="proc~~get_indices~~CalledByGraph_edge42" class="edge"><title>program~fidasim&#45;&gt;proc~nbi_spec</title>
<path fill="none" stroke="#000000" d="M28.9074,-290.01C31.8077,-260.998 43.614,-187.76 90,-157.145 142.004,-122.823 218.148,-138.984 262.736,-153.386"/>
<polygon fill="#000000" stroke="#000000" points="261.693,-156.728 272.287,-156.601 263.926,-150.094 261.693,-156.728"/>
</g>
<!-- proc~dcx -->
<g id="proc~~get_indices~~CalledByGraph_node17" class="node"><title>proc~dcx</title>
<g id="a_proc~~get_indices~~CalledByGraph_node17"><a xlink:href=".././proc/dcx.html" xlink:title="dcx">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-377.145 124,-377.145 124,-353.145 178,-353.145 178,-377.145"/>
<text text-anchor="middle" x="151" y="-362.745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dcx</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~dcx -->
<g id="proc~~get_indices~~CalledByGraph_edge43" class="edge"><title>program~fidasim&#45;&gt;proc~dcx</title>
<path fill="none" stroke="#000000" d="M43.6139,-314.398C55.7484,-323.495 73.2749,-335.733 90,-344.145 97.6402,-347.988 106.153,-351.429 114.309,-354.359"/>
<polygon fill="#000000" stroke="#000000" points="113.405,-357.749 124,-357.672 115.67,-351.125 113.405,-357.749"/>
</g>
<!-- proc~cold_spec -->
<g id="proc~~get_indices~~CalledByGraph_node18" class="node"><title>proc~cold_spec</title>
<g id="a_proc~~get_indices~~CalledByGraph_node18"><a xlink:href=".././proc/cold_spec.html" xlink:title="cold_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="330.5,-129.145 269.5,-129.145 269.5,-105.145 330.5,-105.145 330.5,-129.145"/>
<text text-anchor="middle" x="300" y="-114.745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cold_spec</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~cold_spec -->
<g id="proc~~get_indices~~CalledByGraph_edge44" class="edge"><title>program~fidasim&#45;&gt;proc~cold_spec</title>
<path fill="none" stroke="#000000" d="M28.2963,-289.769C29.7998,-257.752 38.6622,-171.994 90,-133.145 138.728,-96.2715 213.454,-100.887 259.107,-108.429"/>
<polygon fill="#000000" stroke="#000000" points="258.761,-111.922 269.22,-110.226 259.986,-105.03 258.761,-111.922"/>
</g>
<!-- proc~ndmc -->
<g id="proc~~get_indices~~CalledByGraph_node19" class="node"><title>proc~ndmc</title>
<g id="a_proc~~get_indices~~CalledByGraph_node19"><a xlink:href=".././proc/ndmc.html" xlink:title="ndmc">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-545.145 124,-545.145 124,-521.145 178,-521.145 178,-545.145"/>
<text text-anchor="middle" x="151" y="-530.745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ndmc</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~ndmc -->
<g id="proc~~get_indices~~CalledByGraph_edge45" class="edge"><title>program~fidasim&#45;&gt;proc~ndmc</title>
<path fill="none" stroke="#000000" d="M27.9518,-314.195C28.4721,-349.554 34.8378,-454.178 90,-512.145 96.4121,-518.884 105.105,-523.461 113.883,-526.571"/>
<polygon fill="#000000" stroke="#000000" points="113.129,-529.998 123.712,-529.494 115.125,-523.288 113.129,-529.998"/>
</g>
<!-- proc~dcx_spec -->
<g id="proc~~get_indices~~CalledByGraph_node20" class="node"><title>proc~dcx_spec</title>
<g id="a_proc~~get_indices~~CalledByGraph_node20"><a xlink:href=".././proc/dcx_spec.html" xlink:title="dcx_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="329,-70.1454 271,-70.1454 271,-46.1454 329,-46.1454 329,-70.1454"/>
<text text-anchor="middle" x="300" y="-55.7454" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dcx_spec</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~dcx_spec -->
<g id="proc~~get_indices~~CalledByGraph_edge46" class="edge"><title>program~fidasim&#45;&gt;proc~dcx_spec</title>
<path fill="none" stroke="#000000" d="M27.7538,-289.931C27.7539,-254.652 32.8856,-151.843 90,-100.145 136.839,-57.7488 214.141,-53.2185 260.454,-54.9062"/>
<polygon fill="#000000" stroke="#000000" points="260.527,-58.4137 270.684,-55.3989 260.864,-51.4218 260.527,-58.4137"/>
</g>
<!-- proc~pfida_mc -->
<g id="proc~~get_indices~~CalledByGraph_node21" class="node"><title>proc~pfida_mc</title>
<g id="a_proc~~get_indices~~CalledByGraph_node21"><a xlink:href=".././proc/pfida_mc.html" xlink:title="pfida_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="179,-209.145 123,-209.145 123,-185.145 179,-185.145 179,-209.145"/>
<text text-anchor="middle" x="151" y="-194.745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pfida_mc</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~pfida_mc -->
<g id="proc~~get_indices~~CalledByGraph_edge47" class="edge"><title>program~fidasim&#45;&gt;proc~pfida_mc</title>
<path fill="none" stroke="#000000" d="M33.8933,-290.057C43.3186,-271.927 63.4579,-237.735 90,-218.145 96.881,-213.067 105.094,-209.139 113.202,-206.13"/>
<polygon fill="#000000" stroke="#000000" points="114.553,-209.369 122.943,-202.9 112.35,-202.725 114.553,-209.369"/>
</g>
<!-- proc~fida_f -->
<g id="proc~~get_indices~~CalledByGraph_node22" class="node"><title>proc~fida_f</title>
<g id="a_proc~~get_indices~~CalledByGraph_node22"><a xlink:href=".././proc/fida_f.html" xlink:title="fida_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-293.145 124,-293.145 124,-269.145 178,-269.145 178,-293.145"/>
<text text-anchor="middle" x="151" y="-278.745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_f</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_f -->
<g id="proc~~get_indices~~CalledByGraph_edge48" class="edge"><title>program~fidasim&#45;&gt;proc~fida_f</title>
<path fill="none" stroke="#000000" d="M54.1721,-297.64C71.6205,-294.637 94.7864,-290.649 113.97,-287.347"/>
<polygon fill="#000000" stroke="#000000" points="114.61,-290.789 123.871,-285.643 113.422,-283.89 114.61,-290.789"/>
</g>
<!-- proc~fida_mc -->
<g id="proc~~get_indices~~CalledByGraph_node23" class="node"><title>proc~fida_mc</title>
<g id="a_proc~~get_indices~~CalledByGraph_node23"><a xlink:href=".././proc/fida_mc.html" xlink:title="fida_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-335.145 124,-335.145 124,-311.145 178,-311.145 178,-335.145"/>
<text text-anchor="middle" x="151" y="-320.745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_mc</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_mc -->
<g id="proc~~get_indices~~CalledByGraph_edge49" class="edge"><title>program~fidasim&#45;&gt;proc~fida_mc</title>
<path fill="none" stroke="#000000" d="M54.1721,-306.65C71.6205,-309.654 94.7864,-313.641 113.97,-316.944"/>
<polygon fill="#000000" stroke="#000000" points="113.422,-320.401 123.871,-318.648 114.61,-313.502 113.422,-320.401"/>
</g>
<!-- proc~fida_weights_mc -->
<g id="proc~~get_indices~~CalledByGraph_node24" class="node"><title>proc~fida_weights_mc</title>
<g id="a_proc~~get_indices~~CalledByGraph_node24"><a xlink:href=".././proc/fida_weights_mc.html" xlink:title="fida_weights_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="197,-587.145 105,-587.145 105,-563.145 197,-563.145 197,-587.145"/>
<text text-anchor="middle" x="151" y="-572.745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_weights_mc</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_weights_mc -->
<g id="proc~~get_indices~~CalledByGraph_edge50" class="edge"><title>program~fidasim&#45;&gt;proc~fida_weights_mc</title>
<path fill="none" stroke="#000000" d="M29.4703,-314.438C35.1348,-359.895 56.8944,-517.72 90,-554.145 91.8186,-556.146 93.8386,-557.957 96.0048,-559.595"/>
<polygon fill="#000000" stroke="#000000" points="94.6146,-562.848 104.968,-565.095 98.2758,-556.882 94.6146,-562.848"/>
</g>
<!-- proc~nbi_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge21" class="edge"><title>proc~nbi_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M327.757,-179.001C335.738,-182.87 344.384,-187.401 352,-192.145 374.257,-206.012 397.708,-224.531 414.158,-238.254"/>
<polygon fill="#000000" stroke="#000000" points="412.18,-241.165 422.078,-244.944 416.697,-235.817 412.18,-241.165"/>
</g>
<!-- proc~dcx&#45;&gt;proc~track -->
<g id="proc~~get_indices~~CalledByGraph_edge14" class="edge"><title>proc~dcx&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.021,-374.152C188.58,-377.833 200.885,-382.157 212,-386.145 228.775,-392.166 247.317,-398.965 262.958,-404.744"/>
<polygon fill="#000000" stroke="#000000" points="262.177,-408.187 272.77,-408.375 264.607,-401.622 262.177,-408.187"/>
</g>
<!-- proc~dcx&#45;&gt;proc~store_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge24" class="edge"><title>proc~dcx&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M178.08,-363.026C217.39,-359.049 293.449,-348.269 352,-321.145 376.224,-309.924 400.069,-290.761 416.127,-276.322"/>
<polygon fill="#000000" stroke="#000000" points="418.797,-278.621 423.776,-269.269 414.052,-273.475 418.797,-278.621"/>
</g>
<!-- proc~dcx&#45;&gt;proc~store_photon_birth -->
<g id="proc~~get_indices~~CalledByGraph_edge31" class="edge"><title>proc~dcx&#45;&gt;proc~store_photon_birth</title>
<path fill="none" stroke="#000000" d="M178.274,-356.785C188.87,-353.198 201.135,-348.771 212,-344.145 214.836,-342.938 242.612,-328.859 266.028,-316.948"/>
<polygon fill="#000000" stroke="#000000" points="267.729,-320.009 275.054,-312.354 264.554,-313.77 267.729,-320.009"/>
</g>
<!-- proc~cold_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge23" class="edge"><title>proc~cold_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M326.987,-129.271C335.451,-133.889 344.572,-139.631 352,-146.145 382.475,-172.875 409.076,-212.23 423.797,-236.191"/>
<polygon fill="#000000" stroke="#000000" points="420.856,-238.092 429.013,-244.853 426.853,-234.481 420.856,-238.092"/>
</g>
<!-- proc~ndmc&#45;&gt;proc~track -->
<g id="proc~~get_indices~~CalledByGraph_edge11" class="edge"><title>proc~ndmc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.207,-527.218C189.262,-523.923 201.885,-519.057 212,-512.145 232.299,-498.275 231.383,-488.265 248,-470.145 258.116,-459.115 269.779,-447.169 279.397,-437.511"/>
<polygon fill="#000000" stroke="#000000" points="281.998,-439.86 286.603,-430.318 277.053,-434.906 281.998,-439.86"/>
</g>
<!-- proc~ndmc&#45;&gt;proc~store_nbi_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge41" class="edge"><title>proc~ndmc&#45;&gt;proc~store_nbi_photons</title>
<path fill="none" stroke="#000000" d="M178.281,-525.637C197.357,-520.186 223.793,-512.633 247.065,-505.984"/>
<polygon fill="#000000" stroke="#000000" points="248.16,-509.311 256.814,-503.199 246.237,-502.58 248.16,-509.311"/>
</g>
<!-- proc~dcx_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge18" class="edge"><title>proc~dcx_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M321.612,-70.385C331.664,-77.0798 343.407,-86.0597 352,-96.1454 389.084,-139.671 415.785,-202.335 428.201,-235.173"/>
<polygon fill="#000000" stroke="#000000" points="424.98,-236.554 431.725,-244.724 431.547,-234.13 424.98,-236.554"/>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~store_photon_birth -->
<g id="proc~~get_indices~~CalledByGraph_edge28" class="edge"><title>proc~pfida_mc&#45;&gt;proc~store_photon_birth</title>
<path fill="none" stroke="#000000" d="M179.102,-202.365C190.186,-205.523 202.587,-210.479 212,-218.145 236.112,-237.785 224.596,-257.667 248,-278.145 249.937,-279.84 252.024,-281.42 254.209,-282.892"/>
<polygon fill="#000000" stroke="#000000" points="252.613,-286.013 263.013,-288.04 256.147,-279.97 252.613,-286.013"/>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge32" class="edge"><title>proc~pfida_mc&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M179.061,-206.072C189.435,-209.636 201.337,-213.898 212,-218.145 214.686,-219.215 240.365,-230.739 263.133,-240.984"/>
<polygon fill="#000000" stroke="#000000" points="261.755,-244.202 272.31,-245.115 264.628,-237.819 261.755,-244.202"/>
</g>
<!-- proc~fida_f&#45;&gt;proc~track -->
<g id="proc~~get_indices~~CalledByGraph_edge9" class="edge"><title>proc~fida_f&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.129,-286.673C189.296,-289.911 202.027,-294.843 212,-302.145 246.941,-327.727 274.207,-371.308 288.336,-397.146"/>
<polygon fill="#000000" stroke="#000000" points="285.314,-398.917 293.097,-406.106 291.495,-395.633 285.314,-398.917"/>
</g>
<!-- proc~fida_f&#45;&gt;proc~store_photon_birth -->
<g id="proc~~get_indices~~CalledByGraph_edge27" class="edge"><title>proc~fida_f&#45;&gt;proc~store_photon_birth</title>
<path fill="none" stroke="#000000" d="M178.281,-284.542C194.959,-286.698 217.261,-289.581 238.157,-292.281"/>
<polygon fill="#000000" stroke="#000000" points="237.905,-295.778 248.271,-293.589 238.802,-288.836 237.905,-295.778"/>
</g>
<!-- proc~fida_f&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge33" class="edge"><title>proc~fida_f&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M178.281,-276.855C194.888,-274.143 217.072,-270.521 237.89,-267.123"/>
<polygon fill="#000000" stroke="#000000" points="238.665,-270.543 247.97,-265.477 237.537,-263.634 238.665,-270.543"/>
</g>
<!-- proc~fida_mc&#45;&gt;proc~track -->
<g id="proc~~get_indices~~CalledByGraph_edge13" class="edge"><title>proc~fida_mc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.011,-329.952C188.911,-333.379 201.469,-338.105 212,-344.145 238.016,-359.067 263.659,-382.188 280.289,-398.611"/>
<polygon fill="#000000" stroke="#000000" points="278.163,-401.436 287.691,-406.069 283.131,-396.506 278.163,-401.436"/>
</g>
<!-- proc~fida_mc&#45;&gt;proc~store_photon_birth -->
<g id="proc~~get_indices~~CalledByGraph_edge30" class="edge"><title>proc~fida_mc&#45;&gt;proc~store_photon_birth</title>
<path fill="none" stroke="#000000" d="M178.281,-319.034C194.959,-316.424 217.261,-312.934 238.157,-309.665"/>
<polygon fill="#000000" stroke="#000000" points="238.932,-313.086 248.271,-308.083 237.85,-306.171 238.932,-313.086"/>
</g>
<!-- proc~fida_mc&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge34" class="edge"><title>proc~fida_mc&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M178.226,-315.431C188.927,-311.91 201.281,-307.358 212,-302.145 229.075,-293.842 231.229,-288.046 248,-279.145 251.737,-277.162 255.691,-275.213 259.678,-273.343"/>
<polygon fill="#000000" stroke="#000000" points="261.285,-276.458 268.955,-269.149 258.401,-270.08 261.285,-276.458"/>
</g>
<!-- proc~fida_weights_mc&#45;&gt;proc~track -->
<g id="proc~~get_indices~~CalledByGraph_edge10" class="edge"><title>proc~fida_weights_mc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M197.286,-564.005C202.649,-561.378 207.725,-558.138 212,-554.145 241.684,-526.421 225.392,-503.89 248,-470.145 256.108,-458.043 267.247,-446.303 277.047,-437.049"/>
<polygon fill="#000000" stroke="#000000" points="279.517,-439.533 284.535,-430.202 274.793,-434.367 279.517,-439.533"/>
</g>
<!-- proc~fida_weights_mc&#45;&gt;proc~store_fw_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge15" class="edge"><title>proc~fida_weights_mc&#45;&gt;proc~store_fw_photons</title>
<path fill="none" stroke="#000000" d="M197.001,-566.589C246.078,-557.257 324.765,-542.296 378.337,-532.11"/>
<polygon fill="#000000" stroke="#000000" points="379.197,-535.509 388.367,-530.202 377.889,-528.632 379.197,-535.509"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/get_indices.html#src">get_indices</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">get_indices</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="n">ind</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="c">!+ Find closests [[libfida:beam_grid]] indices `ind` to position `pos`</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w">  </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">pos</span><span class="w"></span>
<span class="w">        </span><span class="c">!+ Position [cm]</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ind</span><span class="w"></span>
<span class="w">        </span><span class="c">!+ Closest indices to position</span>

<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w">  </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mini</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">maxind</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="w"></span>

<span class="w">    </span><span class="n">maxind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nx</span><span class="w"></span>
<span class="w">    </span><span class="n">maxind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ny</span><span class="w"></span>
<span class="w">    </span><span class="n">maxind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nz</span><span class="w"></span>

<span class="w">    </span><span class="n">mini</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">minval</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">xc</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">mini</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">minval</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">yc</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dr</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">mini</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">minval</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">zc</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dr</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="w"></span>
<span class="w">        </span><span class="n">ind</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">floor</span><span class="p">((</span><span class="n">pos</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="n">mini</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">/</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dr</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxind</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">maxind</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">lt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="w">    </span><span class="k">enddo</span>

<span class="k">end subroutine </span><span class="n">get_indices</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>