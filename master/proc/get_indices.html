<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>get_indices &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
               
        
        
            </ul>
        
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>



          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>get_indices
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.1% of total for procedures.">18 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
    
     <li><a href='../module/libfida.html'>libfida</a></li>
    
  
     <li class="active">get_indices</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/get_indices.html#src">get_indices</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine get_indices(pos, ind)
    
    
   
</h2>
    
  


    
    <p>Find closests <a href="../module/libfida.html#variable-beam_grid">beam_grid</a> indices <code>ind</code> to position <code>pos</code></p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pos%7E4"></span>real(kind=Float64),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(3)</td><td>::</td>
  <td><strong>pos</strong></td><td><p>Position [cm]</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ind%7E3"></span>integer(kind=Int32),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(3)</td><td>::</td>
  <td><strong>ind</strong></td><td><p>Closest indices to position</p></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~get_indices~~CalledByGraph Pages: 1 -->
<svg id="procget_indicesCalledByGraph" width="598pt" height="646pt"
 viewBox="0.00 0.00 598.00 646.16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~get_indices~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 642.157)">
<title>proc~~get_indices~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-642.157 594,-642.157 594,4 -4,4"/>
<!-- proc~get_indices -->
<g id="proc~~get_indices~~CalledByGraph_node1" class="node"><title>proc~get_indices</title>
<polygon fill="none" stroke="black" points="589.5,-279.157 522.5,-279.157 522.5,-255.157 589.5,-255.157 589.5,-279.157"/>
<text text-anchor="middle" x="556" y="-264.757" font-family="Helvetica,sans-Serif" font-size="10.50">get_indices</text>
</g>
<!-- proc~track -->
<g id="proc~~get_indices~~CalledByGraph_node2" class="node"><title>proc~track</title>
<g id="a_proc~~get_indices~~CalledByGraph_node2"><a xlink:href=".././proc/track.html" xlink:title="track">
<polygon fill="#d9534f" stroke="#d9534f" points="327,-470.157 273,-470.157 273,-446.157 327,-446.157 327,-470.157"/>
<text text-anchor="middle" x="300" y="-455.757" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~get_indices -->
<g id="proc~~get_indices~~CalledByGraph_edge1" class="edge"><title>proc~track&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M317.554,-445.858C327.541,-438.43 340.513,-428.765 352,-420.157 416.572,-371.768 492.46,-314.452 530.561,-285.645"/>
<polygon fill="#000000" stroke="#000000" points="533.105,-288.11 538.97,-279.286 528.883,-282.526 533.105,-288.11"/>
</g>
<!-- proc~store_photons -->
<g id="proc~~get_indices~~CalledByGraph_node3" class="node"><title>proc~store_photons</title>
<g id="a_proc~~get_indices~~CalledByGraph_node3"><a xlink:href=".././proc/store_photons.html" xlink:title="store_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="477.5,-279.157 396.5,-279.157 396.5,-255.157 477.5,-255.157 477.5,-279.157"/>
<text text-anchor="middle" x="437" y="-264.757" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_photons</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_indices -->
<g id="proc~~get_indices~~CalledByGraph_edge2" class="edge"><title>proc~store_photons&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M477.611,-267.157C488.777,-267.157 500.972,-267.157 512.311,-267.157"/>
<polygon fill="#000000" stroke="#000000" points="512.428,-270.657 522.428,-267.157 512.428,-263.657 512.428,-270.657"/>
</g>
<!-- proc~store_fw_photons -->
<g id="proc~~get_indices~~CalledByGraph_node4" class="node"><title>proc~store_fw_photons</title>
<g id="a_proc~~get_indices~~CalledByGraph_node4"><a xlink:href=".././proc/store_fw_photons.html" xlink:title="store_fw_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="485.5,-507.157 388.5,-507.157 388.5,-483.157 485.5,-483.157 485.5,-507.157"/>
<text text-anchor="middle" x="437" y="-492.757" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_fw_photons</text>
</a>
</g>
</g>
<!-- proc~store_fw_photons&#45;&gt;proc~get_indices -->
<g id="proc~~get_indices~~CalledByGraph_edge3" class="edge"><title>proc~store_fw_photons&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M444.652,-483.134C454.04,-466.096 471.634,-433.908 486,-406.157 507.4,-364.818 531.345,-315.963 544.651,-288.568"/>
<polygon fill="#000000" stroke="#000000" points="547.834,-290.025 549.047,-279.5 541.535,-286.971 547.834,-290.025"/>
</g>
<!-- proc~npa_f -->
<g id="proc~~get_indices~~CalledByGraph_node5" class="node"><title>proc~npa_f</title>
<g id="a_proc~~get_indices~~CalledByGraph_node5"><a xlink:href=".././proc/npa_f.html" xlink:title="npa_f">
<polygon fill="#d9534f" stroke="#d9534f" points="464,-201.157 410,-201.157 410,-177.157 464,-177.157 464,-201.157"/>
<text text-anchor="middle" x="437" y="-186.757" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_f</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~get_indices -->
<g id="proc~~get_indices~~CalledByGraph_edge4" class="edge"><title>proc~npa_f&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M456.025,-201.174C475.293,-214.019 506.05,-234.524 528.166,-249.268"/>
<polygon fill="#000000" stroke="#000000" points="526.5,-252.364 536.762,-254.999 530.383,-246.539 526.5,-252.364"/>
</g>
<!-- proc~npa_mc -->
<g id="proc~~get_indices~~CalledByGraph_node6" class="node"><title>proc~npa_mc</title>
<g id="a_proc~~get_indices~~CalledByGraph_node6"><a xlink:href=".././proc/npa_mc.html" xlink:title="npa_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="464,-86.1574 410,-86.1574 410,-62.1574 464,-62.1574 464,-86.1574"/>
<text text-anchor="middle" x="437" y="-71.7574" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_mc</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~get_indices -->
<g id="proc~~get_indices~~CalledByGraph_edge5" class="edge"><title>proc~npa_mc&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M445.319,-86.2304C464.771,-118.318 517.935,-206.016 542.388,-246.354"/>
<polygon fill="#000000" stroke="#000000" points="539.507,-248.352 547.684,-255.089 545.493,-244.723 539.507,-248.352"/>
</g>
<!-- proc~make_diagnostic_grids -->
<g id="proc~~get_indices~~CalledByGraph_node7" class="node"><title>proc~make_diagnostic_grids</title>
<g id="a_proc~~get_indices~~CalledByGraph_node7"><a xlink:href=".././proc/make_diagnostic_grids.html" xlink:title="make_diagnostic_grids">
<polygon fill="#d9534f" stroke="#d9534f" points="212,-554.157 90,-554.157 90,-530.157 212,-530.157 212,-554.157"/>
<text text-anchor="middle" x="151" y="-539.757" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">make_diagnostic_grids</text>
</a>
</g>
</g>
<!-- proc~make_diagnostic_grids&#45;&gt;proc~track -->
<g id="proc~~get_indices~~CalledByGraph_edge6" class="edge"><title>proc~make_diagnostic_grids&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M191.744,-530.081C198.646,-527.47 205.643,-524.481 212,-521.157 235.643,-508.797 260.031,-490.577 276.947,-476.906"/>
<polygon fill="#000000" stroke="#000000" points="279.568,-479.282 285.069,-470.227 275.122,-473.875 279.568,-479.282"/>
</g>
<!-- proc~fida_weights_los -->
<g id="proc~~get_indices~~CalledByGraph_node8" class="node"><title>proc~fida_weights_los</title>
<g id="a_proc~~get_indices~~CalledByGraph_node8"><a xlink:href=".././proc/fida_weights_los.html" xlink:title="fida_weights_los">
<polygon fill="#d9534f" stroke="#d9534f" points="196.5,-512.157 105.5,-512.157 105.5,-488.157 196.5,-488.157 196.5,-512.157"/>
<text text-anchor="middle" x="151" y="-497.757" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_weights_los</text>
</a>
</g>
</g>
<!-- proc~fida_weights_los&#45;&gt;proc~track -->
<g id="proc~~get_indices~~CalledByGraph_edge7" class="edge"><title>proc~fida_weights_los&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M194.124,-488.122C215.851,-481.914 242.082,-474.42 262.874,-468.479"/>
<polygon fill="#000000" stroke="#000000" points="263.948,-471.812 272.601,-465.7 262.025,-465.082 263.948,-471.812"/>
</g>
<!-- proc~nbi_spec -->
<g id="proc~~get_indices~~CalledByGraph_node9" class="node"><title>proc~nbi_spec</title>
<g id="a_proc~~get_indices~~CalledByGraph_node9"><a xlink:href=".././proc/nbi_spec.html" xlink:title="nbi_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="327.5,-110.157 272.5,-110.157 272.5,-86.1574 327.5,-86.1574 327.5,-110.157"/>
<text text-anchor="middle" x="300" y="-95.7574" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nbi_spec</text>
</a>
</g>
</g>
<!-- proc~nbi_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge14" class="edge"><title>proc~nbi_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M324.678,-110.196C334.096,-115.871 344.46,-123.343 352,-132.157 376.818,-161.172 367.52,-177.934 388,-210.157 396.405,-223.383 407.602,-236.853 417.068,-247.376"/>
<polygon fill="#000000" stroke="#000000" points="414.547,-249.806 423.893,-254.796 419.699,-245.067 414.547,-249.806"/>
</g>
<!-- proc~ndmc -->
<g id="proc~~get_indices~~CalledByGraph_node10" class="node"><title>proc~ndmc</title>
<g id="a_proc~~get_indices~~CalledByGraph_node10"><a xlink:href=".././proc/ndmc.html" xlink:title="ndmc">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-596.157 124,-596.157 124,-572.157 178,-572.157 178,-596.157"/>
<text text-anchor="middle" x="151" y="-581.757" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ndmc</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~track -->
<g id="proc~~get_indices~~CalledByGraph_edge8" class="edge"><title>proc~ndmc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.263,-578.311C189.328,-575.03 201.944,-570.153 212,-563.157 216.422,-560.081 258.543,-508.291 282.515,-478.619"/>
<polygon fill="#000000" stroke="#000000" points="285.473,-480.527 289.03,-470.547 280.026,-476.131 285.473,-480.527"/>
</g>
<!-- proc~store_nbi_photons -->
<g id="proc~~get_indices~~CalledByGraph_node20" class="node"><title>proc~store_nbi_photons</title>
<g id="a_proc~~get_indices~~CalledByGraph_node20"><a xlink:href=".././proc/store_nbi_photons.html" xlink:title="store_nbi_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="350.5,-554.157 249.5,-554.157 249.5,-530.157 350.5,-530.157 350.5,-554.157"/>
<text text-anchor="middle" x="300" y="-539.757" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_nbi_photons</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~store_nbi_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge40" class="edge"><title>proc~ndmc&#45;&gt;proc~store_nbi_photons</title>
<path fill="none" stroke="#000000" d="M178.281,-576.649C197.357,-571.198 223.793,-563.645 247.065,-556.996"/>
<polygon fill="#000000" stroke="#000000" points="248.16,-560.323 256.814,-554.21 246.237,-553.592 248.16,-560.323"/>
</g>
<!-- proc~fida_mc -->
<g id="proc~~get_indices~~CalledByGraph_node11" class="node"><title>proc~fida_mc</title>
<g id="a_proc~~get_indices~~CalledByGraph_node11"><a xlink:href=".././proc/fida_mc.html" xlink:title="fida_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-386.157 124,-386.157 124,-362.157 178,-362.157 178,-386.157"/>
<text text-anchor="middle" x="151" y="-371.757" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_mc</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~track -->
<g id="proc~~get_indices~~CalledByGraph_edge9" class="edge"><title>proc~fida_mc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.085,-381.465C188.88,-384.95 201.339,-389.584 212,-395.157 235.643,-407.518 260.031,-425.738 276.947,-439.409"/>
<polygon fill="#000000" stroke="#000000" points="275.122,-442.439 285.069,-446.088 279.568,-437.033 275.122,-442.439"/>
</g>
<!-- proc~store_fida_photons -->
<g id="proc~~get_indices~~CalledByGraph_node13" class="node"><title>proc~store_fida_photons</title>
<g id="a_proc~~get_indices~~CalledByGraph_node13"><a xlink:href=".././proc/store_fida_photons.html" xlink:title="store_fida_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="352,-302.157 248,-302.157 248,-278.157 352,-278.157 352,-302.157"/>
<text text-anchor="middle" x="300" y="-287.757" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_fida_photons</text>
</a>
</g>
</g>
<!-- proc~fida_mc&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge33" class="edge"><title>proc~fida_mc&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M178.085,-366.85C188.88,-363.365 201.339,-358.731 212,-353.157 224.855,-346.437 254.213,-324.62 275.271,-308.536"/>
<polygon fill="#000000" stroke="#000000" points="277.635,-311.133 283.437,-302.269 273.373,-305.58 277.635,-311.133"/>
</g>
<!-- proc~fida_f -->
<g id="proc~~get_indices~~CalledByGraph_node12" class="node"><title>proc~fida_f</title>
<g id="a_proc~~get_indices~~CalledByGraph_node12"><a xlink:href=".././proc/fida_f.html" xlink:title="fida_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-344.157 124,-344.157 124,-320.157 178,-320.157 178,-344.157"/>
<text text-anchor="middle" x="151" y="-329.757" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_f</text>
</a>
</g>
</g>
<!-- proc~fida_f&#45;&gt;proc~track -->
<g id="proc~~get_indices~~CalledByGraph_edge10" class="edge"><title>proc~fida_f&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.263,-338.004C189.328,-341.285 201.944,-346.162 212,-353.157 244.598,-375.833 271.828,-413.871 286.73,-437.405"/>
<polygon fill="#000000" stroke="#000000" points="283.767,-439.268 291.997,-445.94 289.724,-435.592 283.767,-439.268"/>
</g>
<!-- proc~fida_f&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge34" class="edge"><title>proc~fida_f&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M178.281,-324.649C197.357,-319.198 223.793,-311.645 247.065,-304.996"/>
<polygon fill="#000000" stroke="#000000" points="248.16,-308.323 256.814,-302.21 246.237,-301.592 248.16,-308.323"/>
</g>
<!-- proc~store_fida_photons&#45;&gt;proc~store_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge15" class="edge"><title>proc~store_fida_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M352.038,-281.462C363.242,-279.553 375.092,-277.534 386.245,-275.634"/>
<polygon fill="#000000" stroke="#000000" points="386.984,-279.059 396.254,-273.929 385.808,-272.158 386.984,-279.059"/>
</g>
<!-- proc~halo -->
<g id="proc~~get_indices~~CalledByGraph_node14" class="node"><title>proc~halo</title>
<g id="a_proc~~get_indices~~CalledByGraph_node14"><a xlink:href=".././proc/halo.html" xlink:title="halo">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-470.157 124,-470.157 124,-446.157 178,-446.157 178,-470.157"/>
<text text-anchor="middle" x="151" y="-455.757" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">halo</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~track -->
<g id="proc~~get_indices~~CalledByGraph_edge11" class="edge"><title>proc~halo&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.281,-458.157C201.797,-458.157 236.498,-458.157 262.668,-458.157"/>
<polygon fill="#000000" stroke="#000000" points="262.947,-461.657 272.947,-458.157 262.947,-454.657 262.947,-461.657"/>
</g>
<!-- proc~halo&#45;&gt;proc~store_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge16" class="edge"><title>proc~halo&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M178.017,-450.503C218.593,-437.599 297.891,-408.41 352,-363.157 371.915,-346.502 370.989,-336.769 388,-317.157 397.117,-306.647 407.79,-295.431 416.754,-286.291"/>
<polygon fill="#000000" stroke="#000000" points="419.263,-288.732 423.81,-279.163 414.288,-283.807 419.263,-288.732"/>
</g>
<!-- proc~dcx_spec -->
<g id="proc~~get_indices~~CalledByGraph_node15" class="node"><title>proc~dcx_spec</title>
<g id="a_proc~~get_indices~~CalledByGraph_node15"><a xlink:href=".././proc/dcx_spec.html" xlink:title="dcx_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="329,-258.157 271,-258.157 271,-234.157 329,-234.157 329,-258.157"/>
<text text-anchor="middle" x="300" y="-243.757" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dcx_spec</text>
</a>
</g>
</g>
<!-- proc~dcx_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge18" class="edge"><title>proc~dcx_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M329.3,-250.56C345.816,-253.129 367.123,-256.443 386.349,-259.434"/>
<polygon fill="#000000" stroke="#000000" points="386.054,-262.93 396.473,-261.009 387.13,-256.013 386.054,-262.93"/>
</g>
<!-- proc~cold_spec -->
<g id="proc~~get_indices~~CalledByGraph_node16" class="node"><title>proc~cold_spec</title>
<g id="a_proc~~get_indices~~CalledByGraph_node16"><a xlink:href=".././proc/cold_spec.html" xlink:title="cold_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="330.5,-213.157 269.5,-213.157 269.5,-189.157 330.5,-189.157 330.5,-213.157"/>
<text text-anchor="middle" x="300" y="-198.757" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cold_spec</text>
</a>
</g>
</g>
<!-- proc~cold_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge17" class="edge"><title>proc~cold_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M327.002,-213.248C335.036,-217.022 343.9,-221.227 352,-225.157 368.885,-233.35 387.569,-242.667 403.02,-250.44"/>
<polygon fill="#000000" stroke="#000000" points="401.673,-253.681 412.178,-255.057 404.824,-247.43 401.673,-253.681"/>
</g>
<!-- proc~fida_weights_mc -->
<g id="proc~~get_indices~~CalledByGraph_node17" class="node"><title>proc~fida_weights_mc</title>
<g id="a_proc~~get_indices~~CalledByGraph_node17"><a xlink:href=".././proc/fida_weights_mc.html" xlink:title="fida_weights_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="197,-638.157 105,-638.157 105,-614.157 197,-614.157 197,-638.157"/>
<text text-anchor="middle" x="151" y="-623.757" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_weights_mc</text>
</a>
</g>
</g>
<!-- proc~fida_weights_mc&#45;&gt;proc~track -->
<g id="proc~~get_indices~~CalledByGraph_edge12" class="edge"><title>proc~fida_weights_mc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M197.286,-615.017C202.649,-612.389 207.725,-609.15 212,-605.157 241.684,-577.433 227.023,-555.939 248,-521.157 257.33,-505.688 270.127,-489.891 280.568,-477.985"/>
<polygon fill="#000000" stroke="#000000" points="283.284,-480.199 287.349,-470.416 278.07,-475.529 283.284,-480.199"/>
</g>
<!-- proc~fida_weights_mc&#45;&gt;proc~store_fw_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge22" class="edge"><title>proc~fida_weights_mc&#45;&gt;proc~store_fw_photons</title>
<path fill="none" stroke="#000000" d="M197.211,-617.036C239.051,-607.431 302.128,-589.941 352,-563.157 376.211,-550.155 400.215,-529.771 416.323,-514.709"/>
<polygon fill="#000000" stroke="#000000" points="419.176,-516.824 423.987,-507.385 414.339,-511.764 419.176,-516.824"/>
</g>
<!-- proc~dcx -->
<g id="proc~~get_indices~~CalledByGraph_node18" class="node"><title>proc~dcx</title>
<g id="a_proc~~get_indices~~CalledByGraph_node18"><a xlink:href=".././proc/dcx.html" xlink:title="dcx">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-428.157 124,-428.157 124,-404.157 178,-404.157 178,-428.157"/>
<text text-anchor="middle" x="151" y="-413.757" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dcx</text>
</a>
</g>
</g>
<!-- proc~dcx&#45;&gt;proc~track -->
<g id="proc~~get_indices~~CalledByGraph_edge13" class="edge"><title>proc~dcx&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M178.281,-423.666C201.902,-430.415 236.807,-440.388 263.016,-447.876"/>
<polygon fill="#000000" stroke="#000000" points="262.37,-451.332 272.947,-450.714 264.293,-444.601 262.37,-451.332"/>
</g>
<!-- proc~dcx&#45;&gt;proc~store_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge20" class="edge"><title>proc~dcx&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M178.1,-408.176C188.782,-404.614 201.156,-400.103 212,-395.157 285.879,-361.462 367.455,-311.299 408.778,-284.89"/>
<polygon fill="#000000" stroke="#000000" points="410.921,-287.673 417.442,-279.323 407.137,-281.784 410.921,-287.673"/>
</g>
<!-- program~fidasim -->
<g id="proc~~get_indices~~CalledByGraph_node19" class="node"><title>program~fidasim</title>
<g id="a_proc~~get_indices~~CalledByGraph_node19"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-323.157 0,-323.157 0,-299.157 54,-299.157 54,-323.157"/>
<text text-anchor="middle" x="27" y="-308.757" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_f -->
<g id="proc~~get_indices~~CalledByGraph_edge23" class="edge"><title>program~fidasim&#45;&gt;proc~npa_f</title>
<path fill="none" stroke="#000000" d="M29.7123,-298.979C35.8104,-257.437 57.8371,-122.378 90,-95.1574 179.094,-19.755 247.603,-24.9591 352,-77.1574 389.783,-96.0487 414.98,-140.91 427.266,-167.773"/>
<polygon fill="#000000" stroke="#000000" points="424.129,-169.335 431.342,-177.095 430.543,-166.53 424.129,-169.335"/>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_mc -->
<g id="proc~~get_indices~~CalledByGraph_edge24" class="edge"><title>program~fidasim&#45;&gt;proc~npa_mc</title>
<path fill="none" stroke="#000000" d="M28.7839,-298.992C32.2087,-250.119 47.6301,-69.0652 90,-35.1574 183.343,39.5434 338.967,-24.453 404.931,-57.4291"/>
<polygon fill="#000000" stroke="#000000" points="403.496,-60.626 413.994,-62.0492 406.675,-54.3895 403.496,-60.626"/>
</g>
<!-- program~fidasim&#45;&gt;proc~make_diagnostic_grids -->
<g id="proc~~get_indices~~CalledByGraph_edge25" class="edge"><title>program~fidasim&#45;&gt;proc~make_diagnostic_grids</title>
<path fill="none" stroke="#000000" d="M27.9518,-323.207C28.4721,-358.566 34.8378,-463.189 90,-521.157 91.0461,-522.257 92.1529,-523.298 93.3109,-524.286"/>
<polygon fill="#000000" stroke="#000000" points="91.3859,-527.21 101.595,-530.043 95.3805,-521.462 91.3859,-527.21"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_weights_los -->
<g id="proc~~get_indices~~CalledByGraph_edge26" class="edge"><title>program~fidasim&#45;&gt;proc~fida_weights_los</title>
<path fill="none" stroke="#000000" d="M28.9907,-323.183C32.1355,-353.623 44.5552,-434.473 90,-479.157 92.0657,-481.189 94.3386,-483.024 96.7546,-484.682"/>
<polygon fill="#000000" stroke="#000000" points="95.0122,-487.718 105.426,-489.667 98.5005,-481.649 95.0122,-487.718"/>
</g>
<!-- program~fidasim&#45;&gt;proc~nbi_spec -->
<g id="proc~~get_indices~~CalledByGraph_edge27" class="edge"><title>program~fidasim&#45;&gt;proc~nbi_spec</title>
<path fill="none" stroke="#000000" d="M28.7065,-298.869C31.1844,-267.826 42.1679,-185.77 90,-144.157 138.369,-102.078 216.491,-95.8261 262.279,-96.2211"/>
<polygon fill="#000000" stroke="#000000" points="262.293,-99.722 272.361,-96.4206 262.432,-92.7234 262.293,-99.722"/>
</g>
<!-- program~fidasim&#45;&gt;proc~ndmc -->
<g id="proc~~get_indices~~CalledByGraph_edge28" class="edge"><title>program~fidasim&#45;&gt;proc~ndmc</title>
<path fill="none" stroke="#000000" d="M29.4703,-323.45C35.1348,-368.906 56.8944,-526.731 90,-563.157 96.3777,-570.175 105.233,-574.847 114.185,-577.958"/>
<polygon fill="#000000" stroke="#000000" points="113.244,-581.33 123.823,-580.759 115.197,-574.608 113.244,-581.33"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_mc -->
<g id="proc~~get_indices~~CalledByGraph_edge29" class="edge"><title>program~fidasim&#45;&gt;proc~fida_mc</title>
<path fill="none" stroke="#000000" d="M43.6139,-323.41C55.7484,-332.507 73.2749,-344.745 90,-353.157 97.6402,-357 106.153,-360.441 114.309,-363.371"/>
<polygon fill="#000000" stroke="#000000" points="113.405,-366.76 124,-366.684 115.67,-360.137 113.405,-366.76"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_f -->
<g id="proc~~get_indices~~CalledByGraph_edge30" class="edge"><title>program~fidasim&#45;&gt;proc~fida_f</title>
<path fill="none" stroke="#000000" d="M54.1721,-315.662C71.6205,-318.666 94.7864,-322.653 113.97,-325.955"/>
<polygon fill="#000000" stroke="#000000" points="113.422,-329.413 123.871,-327.66 114.61,-322.514 113.422,-329.413"/>
</g>
<!-- program~fidasim&#45;&gt;proc~halo -->
<g id="proc~~get_indices~~CalledByGraph_edge35" class="edge"><title>program~fidasim&#45;&gt;proc~halo</title>
<path fill="none" stroke="#000000" d="M30.7272,-323.455C36.8925,-348.443 54.2364,-405.466 90,-437.157 96.8415,-443.22 105.537,-447.558 114.17,-450.652"/>
<polygon fill="#000000" stroke="#000000" points="113.201,-454.016 123.789,-453.643 115.28,-447.332 113.201,-454.016"/>
</g>
<!-- program~fidasim&#45;&gt;proc~dcx_spec -->
<g id="proc~~get_indices~~CalledByGraph_edge36" class="edge"><title>program~fidasim&#45;&gt;proc~dcx_spec</title>
<path fill="none" stroke="#000000" d="M32.7541,-298.845C41.0173,-279.407 60.0655,-242.268 90,-227.157 144.616,-199.587 217.506,-216.36 261.198,-231.166"/>
<polygon fill="#000000" stroke="#000000" points="260.259,-234.546 270.854,-234.568 262.585,-227.944 260.259,-234.546"/>
</g>
<!-- program~fidasim&#45;&gt;proc~cold_spec -->
<g id="proc~~get_indices~~CalledByGraph_edge37" class="edge"><title>program~fidasim&#45;&gt;proc~cold_spec</title>
<path fill="none" stroke="#000000" d="M31.2561,-299.001C37.9747,-276.614 55.6994,-229.321 90,-209.157 142.129,-178.513 214.876,-184.352 259.36,-192.176"/>
<polygon fill="#000000" stroke="#000000" points="258.743,-195.622 269.217,-194.025 260.033,-188.742 258.743,-195.622"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_weights_mc -->
<g id="proc~~get_indices~~CalledByGraph_edge38" class="edge"><title>program~fidasim&#45;&gt;proc~fida_weights_mc</title>
<path fill="none" stroke="#000000" d="M28.9967,-323.372C33.3059,-373.363 51.8635,-561.761 90,-605.157 91.7849,-607.188 93.7777,-609.023 95.9222,-610.68"/>
<polygon fill="#000000" stroke="#000000" points="94.4899,-613.912 104.827,-616.233 98.1937,-607.972 94.4899,-613.912"/>
</g>
<!-- program~fidasim&#45;&gt;proc~dcx -->
<g id="proc~~get_indices~~CalledByGraph_edge39" class="edge"><title>program~fidasim&#45;&gt;proc~dcx</title>
<path fill="none" stroke="#000000" d="M33.8933,-323.245C43.3186,-341.376 63.4579,-375.568 90,-395.157 97.1481,-400.433 105.734,-404.467 114.146,-407.519"/>
<polygon fill="#000000" stroke="#000000" points="113.252,-410.909 123.844,-410.666 115.413,-404.251 113.252,-410.909"/>
</g>
<!-- proc~halo_spec -->
<g id="proc~~get_indices~~CalledByGraph_node21" class="node"><title>proc~halo_spec</title>
<g id="a_proc~~get_indices~~CalledByGraph_node21"><a xlink:href=".././proc/halo_spec.html" xlink:title="halo_spec">
<polygon fill="#d9534f" stroke="#d9534f" points="330.5,-165.157 269.5,-165.157 269.5,-141.157 330.5,-141.157 330.5,-165.157"/>
<text text-anchor="middle" x="300" y="-150.757" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">halo_spec</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~halo_spec -->
<g id="proc~~get_indices~~CalledByGraph_edge41" class="edge"><title>program~fidasim&#45;&gt;proc~halo_spec</title>
<path fill="none" stroke="#000000" d="M29.9113,-299.154C34.7473,-273.086 50.0541,-211.302 90,-182.157 139.692,-145.901 214.118,-144.731 259.449,-148.218"/>
<polygon fill="#000000" stroke="#000000" points="259.218,-151.711 269.487,-149.103 259.833,-144.738 259.218,-151.711"/>
</g>
<!-- proc~pfida_mc -->
<g id="proc~~get_indices~~CalledByGraph_node22" class="node"><title>proc~pfida_mc</title>
<g id="a_proc~~get_indices~~CalledByGraph_node22"><a xlink:href=".././proc/pfida_mc.html" xlink:title="pfida_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="179,-302.157 123,-302.157 123,-278.157 179,-278.157 179,-302.157"/>
<text text-anchor="middle" x="151" y="-287.757" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pfida_mc</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~pfida_mc -->
<g id="proc~~get_indices~~CalledByGraph_edge42" class="edge"><title>program~fidasim&#45;&gt;proc~pfida_mc</title>
<path fill="none" stroke="#000000" d="M54.1721,-306.652C71.1857,-303.724 93.6353,-299.859 112.529,-296.607"/>
<polygon fill="#000000" stroke="#000000" points="113.341,-300.019 122.602,-294.873 112.153,-293.121 113.341,-300.019"/>
</g>
<!-- proc~pfida_f -->
<g id="proc~~get_indices~~CalledByGraph_node23" class="node"><title>proc~pfida_f</title>
<g id="a_proc~~get_indices~~CalledByGraph_node23"><a xlink:href=".././proc/pfida_f.html" xlink:title="pfida_f">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-260.157 124,-260.157 124,-236.157 178,-236.157 178,-260.157"/>
<text text-anchor="middle" x="151" y="-245.757" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pfida_f</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~pfida_f -->
<g id="proc~~get_indices~~CalledByGraph_edge43" class="edge"><title>program~fidasim&#45;&gt;proc~pfida_f</title>
<path fill="none" stroke="#000000" d="M43.6139,-298.905C55.7484,-289.807 73.2749,-277.57 90,-269.157 97.6402,-265.314 106.153,-261.874 114.309,-258.944"/>
<polygon fill="#000000" stroke="#000000" points="115.67,-262.178 124,-255.631 113.405,-255.554 115.67,-262.178"/>
</g>
<!-- proc~store_nbi_photons&#45;&gt;proc~store_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge21" class="edge"><title>proc~store_nbi_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M312.767,-529.968C323.984,-517.852 340.781,-498.354 352,-479.157 390.06,-414.033 417.997,-328.415 429.796,-288.883"/>
<polygon fill="#000000" stroke="#000000" points="433.174,-289.804 432.63,-279.223 426.457,-287.834 433.174,-289.804"/>
</g>
<!-- proc~halo_spec&#45;&gt;proc~store_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge19" class="edge"><title>proc~halo_spec&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M327.643,-165.245C335.788,-169.462 344.554,-174.557 352,-180.157 378.336,-199.968 403.955,-228.191 419.836,-247.064"/>
<polygon fill="#000000" stroke="#000000" points="417.343,-249.541 426.415,-255.013 422.735,-245.078 417.343,-249.541"/>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge31" class="edge"><title>proc~pfida_mc&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M179.305,-290.157C195.713,-290.157 217.286,-290.157 237.592,-290.157"/>
<polygon fill="#000000" stroke="#000000" points="237.745,-293.657 247.745,-290.157 237.745,-286.657 237.745,-293.657"/>
</g>
<!-- proc~pfida_f&#45;&gt;proc~store_fida_photons -->
<g id="proc~~get_indices~~CalledByGraph_edge32" class="edge"><title>proc~pfida_f&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M178.281,-255.666C197.357,-261.117 223.793,-268.67 247.065,-275.319"/>
<polygon fill="#000000" stroke="#000000" points="246.237,-278.722 256.814,-278.104 248.16,-271.992 246.237,-278.722"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/get_indices.html#src">get_indices</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">get_indices</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
    <span class="c">!+ Find closests [[libfida:beam_grid]] indices `ind` to position `pos`</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span>  <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">pos</span>
        <span class="c">!+ Position [cm]</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ind</span>
        <span class="c">!+ Closest indices to position</span>

    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span>  <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mini</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">maxind</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>

    <span class="n">maxind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">beam_grid</span><span class="p">%</span><span class="n">nx</span>
    <span class="n">maxind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">beam_grid</span><span class="p">%</span><span class="n">ny</span>
    <span class="n">maxind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">beam_grid</span><span class="p">%</span><span class="n">nz</span>

    <span class="n">mini</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">minval</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">xc</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">mini</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="nb">minval</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">yc</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dr</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">mini</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">minval</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">zc</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dr</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

    <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
        <span class="n">ind</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="nb">floor</span><span class="p">((</span><span class="n">pos</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="n">mini</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">/</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dr</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">ind</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxind</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="n">ind</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">maxind</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">ind</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">lt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="n">ind</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
    <span class="k">enddo</span>

<span class="k">end subroutine </span><span class="n">get_indices</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2021 
                                          </p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            
            
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>