<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="">
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>halo &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>User Guide</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>halo
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.9% of total for procedures.">134 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
     <li><a href='../module/libfida.html'>libfida</a></li>
     <li class="active">halo</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/halo.html#src">halo</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public subroutine halo()</h2>
    

    <p>Calculates halo neutral density and spectra</p>

    <h3>Arguments</h3>
    <em>None</em>
    <br>
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~halo~~CallsGraph Pages: 1 -->
<svg id="prochaloCallsGraph" width="641pt" height="910pt"
 viewBox="0.00 0.00 641.00 909.70" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~halo~~CallsGraph" class="graph" transform="scale(0.690733 0.690733) rotate(0) translate(4 1313)">
<title>proc~~halo~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1313 924,-1313 924,4 -4,4"/>
<!-- proc~halo -->
<g id="proc~~halo~~CallsGraph_node1" class="node"><title>proc~halo</title>
<polygon fill="none" stroke="black" points="54,-718 0,-718 0,-694 54,-694 54,-718"/>
<text text-anchor="middle" x="27" y="-703.6" font-family="Helvetica,sans-Serif" font-size="10.50">halo</text>
</g>
<!-- proc~mc_beam_grid -->
<g id="proc~~halo~~CallsGraph_node2" class="node"><title>proc~mc_beam_grid</title>
<g id="a_proc~~halo~~CallsGraph_node2"><a xlink:href=".././proc/mc_beam_grid.html" xlink:title="mc_beam_grid">
<polygon fill="#d9534f" stroke="#d9534f" points="800,-1301 716,-1301 716,-1277 800,-1277 800,-1301"/>
<text text-anchor="middle" x="758" y="-1286.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_beam_grid</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~mc_beam_grid -->
<g id="proc~~halo~~CallsGraph_edge1" class="edge"><title>proc~halo&#45;&gt;proc~mc_beam_grid</title>
<path fill="none" stroke="#000000" d="M28.3835,-718.045C31.7779,-803.032 63.5932,-1309 340,-1309 340,-1309 340,-1309 497,-1309 569.577,-1309 653.215,-1301.16 705.6,-1295.29"/>
<polygon fill="#000000" stroke="#000000" points="706.107,-1298.76 715.648,-1294.15 705.316,-1291.8 706.107,-1298.76"/>
</g>
<!-- proc~mc_halo -->
<g id="proc~~halo~~CallsGraph_node3" class="node"><title>proc~mc_halo</title>
<g id="a_proc~~halo~~CallsGraph_node3"><a xlink:href=".././proc/mc_halo.html" xlink:title="mc_halo">
<polygon fill="#d9534f" stroke="#d9534f" points="190,-332 136,-332 136,-308 190,-308 190,-332"/>
<text text-anchor="middle" x="163" y="-317.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_halo</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~mc_halo -->
<g id="proc~~halo~~CallsGraph_edge2" class="edge"><title>proc~halo&#45;&gt;proc~mc_halo</title>
<path fill="none" stroke="#000000" d="M28.3779,-693.996C30.4081,-637.104 41.7995,-395.118 90,-341 99.0201,-330.873 112.619,-325.51 125.577,-322.711"/>
<polygon fill="#000000" stroke="#000000" points="126.466,-326.11 135.733,-320.974 125.286,-319.21 126.466,-326.11"/>
</g>
<!-- proc~free_neutral_population -->
<g id="proc~~halo~~CallsGraph_node4" class="node"><title>proc~free_neutral_population</title>
<g id="a_proc~~halo~~CallsGraph_node4"><a xlink:href=".././proc/free_neutral_population.html" xlink:title="free_neutral_population">
<polygon fill="#d9534f" stroke="#d9534f" points="226,-290 100,-290 100,-266 226,-266 226,-290"/>
<text text-anchor="middle" x="163" y="-275.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">free_neutral_population</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~free_neutral_population -->
<g id="proc~~halo~~CallsGraph_edge3" class="edge"><title>proc~halo&#45;&gt;proc~free_neutral_population</title>
<path fill="none" stroke="#000000" d="M28.1494,-693.865C29.1446,-632.841 36.5638,-360.038 90,-299 90.8684,-298.008 91.7807,-297.062 92.7322,-296.159"/>
<polygon fill="#000000" stroke="#000000" points="94.8944,-298.912 100.712,-290.057 90.6423,-293.351 94.8944,-298.912"/>
</g>
<!-- proc~init_neutral_population -->
<g id="proc~~halo~~CallsGraph_node5" class="node"><title>proc~init_neutral_population</title>
<g id="a_proc~~halo~~CallsGraph_node5"><a xlink:href=".././proc/init_neutral_population.html" xlink:title="init_neutral_population">
<polygon fill="#d9534f" stroke="#d9534f" points="223.5,-248 102.5,-248 102.5,-224 223.5,-224 223.5,-248"/>
<text text-anchor="middle" x="163" y="-233.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_neutral_population</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~init_neutral_population -->
<g id="proc~~halo~~CallsGraph_edge16" class="edge"><title>proc~halo&#45;&gt;proc~init_neutral_population</title>
<path fill="none" stroke="#000000" d="M27.9589,-693.926C27.9835,-629.338 31.2535,-325.056 90,-257 91.1991,-255.611 92.4845,-254.311 93.8428,-253.095"/>
<polygon fill="#000000" stroke="#000000" points="96.2455,-255.679 102.33,-247.005 92.1648,-249.991 96.2455,-255.679"/>
</g>
<!-- proc~ind2sub -->
<g id="proc~~halo~~CallsGraph_node6" class="node"><title>proc~ind2sub</title>
<g id="a_proc~~halo~~CallsGraph_node6"><a xlink:href=".././proc/ind2sub.html" xlink:title="ind2sub">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-1000 314,-1000 314,-976 368,-976 368,-1000"/>
<text text-anchor="middle" x="341" y="-985.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ind2sub</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~ind2sub -->
<g id="proc~~halo~~CallsGraph_edge5" class="edge"><title>proc~halo&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M28.9937,-718.192C32.114,-748.23 44.4236,-826.302 90,-867 140.013,-911.66 182.609,-864.439 236,-905 261.373,-924.275 247.067,-947.16 272,-967 281.179,-974.304 292.902,-979.079 304.019,-982.196"/>
<polygon fill="#000000" stroke="#000000" points="303.425,-985.653 313.969,-984.617 305.08,-978.851 303.425,-985.653"/>
</g>
<!-- proc~get_nlaunch -->
<g id="proc~~halo~~CallsGraph_node7" class="node"><title>proc~get_nlaunch</title>
<g id="a_proc~~halo~~CallsGraph_node7"><a xlink:href=".././proc/get_nlaunch.html" xlink:title="get_nlaunch">
<polygon fill="#d9534f" stroke="#d9534f" points="198.5,-858 127.5,-858 127.5,-834 198.5,-834 198.5,-858"/>
<text text-anchor="middle" x="163" y="-843.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_nlaunch</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~get_nlaunch -->
<g id="proc~~halo~~CallsGraph_edge6" class="edge"><title>proc~halo&#45;&gt;proc~get_nlaunch</title>
<path fill="none" stroke="#000000" d="M34.1542,-718.112C44.0683,-736.809 65.0144,-773.139 90,-798 101.854,-809.795 117.012,-820.408 130.36,-828.637"/>
<polygon fill="#000000" stroke="#000000" points="128.867,-831.821 139.248,-833.938 132.453,-825.809 128.867,-831.821"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~halo~~CallsGraph_node8" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~halo~~CallsGraph_node8"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="375,-718 307,-718 307,-694 375,-694 375,-718"/>
<text text-anchor="middle" x="341" y="-703.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~get_plasma -->
<g id="proc~~halo~~CallsGraph_edge7" class="edge"><title>proc~halo&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M54.0643,-706C107.726,-706 231.017,-706 296.799,-706"/>
<polygon fill="#000000" stroke="#000000" points="296.844,-709.5 306.844,-706 296.844,-702.5 296.844,-709.5"/>
</g>
<!-- proc~store_photons -->
<g id="proc~~halo~~CallsGraph_node9" class="node"><title>proc~store_photons</title>
<g id="a_proc~~halo~~CallsGraph_node9"><a xlink:href=".././proc/store_photons.html" xlink:title="store_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="203.5,-533 122.5,-533 122.5,-509 203.5,-509 203.5,-533"/>
<text text-anchor="middle" x="163" y="-518.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_photons</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~store_photons -->
<g id="proc~~halo~~CallsGraph_edge8" class="edge"><title>proc~halo&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M31.3256,-693.733C38.5947,-668.653 57.8676,-610.623 90,-572 101.09,-558.67 116.451,-547.156 130.137,-538.459"/>
<polygon fill="#000000" stroke="#000000" points="132.112,-541.355 138.828,-533.16 128.467,-535.378 132.112,-541.355"/>
</g>
<!-- proc~merge_neutral_populations -->
<g id="proc~~halo~~CallsGraph_node10" class="node"><title>proc~merge_neutral_populations</title>
<g id="a_proc~~halo~~CallsGraph_node10"><a xlink:href=".././proc/merge_neutral_populations.html" xlink:title="merge_neutral_populations">
<polygon fill="#d9534f" stroke="#d9534f" points="234.5,-1060 91.5,-1060 91.5,-1036 234.5,-1036 234.5,-1060"/>
<text text-anchor="middle" x="163" y="-1045.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">merge_neutral_populations</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~merge_neutral_populations -->
<g id="proc~~halo~~CallsGraph_edge9" class="edge"><title>proc~halo&#45;&gt;proc~merge_neutral_populations</title>
<path fill="none" stroke="#000000" d="M28.8019,-718.04C32.4906,-770.02 49.4143,-974.686 90,-1022 92.823,-1025.29 96.0958,-1028.17 99.658,-1030.68"/>
<polygon fill="#000000" stroke="#000000" points="98.0375,-1033.78 108.419,-1035.9 101.622,-1027.77 98.0375,-1033.78"/>
</g>
<!-- proc~parallel_merge_reservoirs -->
<g id="proc~~halo~~CallsGraph_node11" class="node"><title>proc~parallel_merge_reservoirs</title>
<g id="a_proc~~halo~~CallsGraph_node11"><a xlink:href=".././proc/parallel_merge_reservoirs.html" xlink:title="parallel_merge_reservoirs">
<polygon fill="#d9534f" stroke="#d9534f" points="409.5,-1080 272.5,-1080 272.5,-1056 409.5,-1056 409.5,-1080"/>
<text text-anchor="middle" x="341" y="-1065.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_merge_reservoirs</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~parallel_merge_reservoirs -->
<g id="proc~~halo~~CallsGraph_edge10" class="edge"><title>proc~halo&#45;&gt;proc~parallel_merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M28.9994,-718.177C33.2595,-767.14 51.4729,-948.942 90,-989 136.48,-1037.33 172.453,-1005.61 236,-1027 252.428,-1032.53 255.903,-1035.57 272,-1042 280.443,-1045.37 289.509,-1048.9 298.183,-1052.23"/>
<polygon fill="#000000" stroke="#000000" points="297.164,-1055.59 307.754,-1055.89 299.664,-1049.05 297.164,-1055.59"/>
</g>
<!-- proc~store_photon_birth -->
<g id="proc~~halo~~CallsGraph_node12" class="node"><title>proc~store_photon_birth</title>
<g id="a_proc~~halo~~CallsGraph_node12"><a xlink:href=".././proc/store_photon_birth.html" xlink:title="store_photon_birth">
<polygon fill="#d9534f" stroke="#d9534f" points="214.5,-605 111.5,-605 111.5,-581 214.5,-581 214.5,-605"/>
<text text-anchor="middle" x="163" y="-590.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_photon_birth</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~store_photon_birth -->
<g id="proc~~halo~~CallsGraph_edge11" class="edge"><title>proc~halo&#45;&gt;proc~store_photon_birth</title>
<path fill="none" stroke="#000000" d="M36.1227,-693.976C47.0262,-678.478 67.6291,-651.347 90,-633 100.837,-624.112 113.93,-616.166 125.964,-609.744"/>
<polygon fill="#000000" stroke="#000000" points="127.616,-612.83 134.904,-605.14 124.411,-606.607 127.616,-612.83"/>
</g>
<!-- proc~track -->
<g id="proc~~halo~~CallsGraph_node13" class="node"><title>proc~track</title>
<g id="a_proc~~halo~~CallsGraph_node13"><a xlink:href=".././proc/track.html" xlink:title="track">
<polygon fill="#d9534f" stroke="#d9534f" points="190,-666 136,-666 136,-642 190,-642 190,-666"/>
<text text-anchor="middle" x="163" y="-651.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~track -->
<g id="proc~~halo~~CallsGraph_edge12" class="edge"><title>proc~halo&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M54.1547,-695.85C74.7222,-687.869 103.594,-676.665 126.289,-667.858"/>
<polygon fill="#000000" stroke="#000000" points="127.855,-671.005 135.911,-664.124 125.322,-664.479 127.855,-671.005"/>
</g>
<!-- proc~colrad -->
<g id="proc~~halo~~CallsGraph_node14" class="node"><title>proc~colrad</title>
<g id="a_proc~~halo~~CallsGraph_node14"><a xlink:href=".././proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="190,-374 136,-374 136,-350 190,-350 190,-374"/>
<text text-anchor="middle" x="163" y="-359.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~colrad -->
<g id="proc~~halo~~CallsGraph_edge13" class="edge"><title>proc~halo&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M29.2644,-693.847C34.63,-644.078 56.776,-456.18 90,-408 99.0997,-394.804 113.346,-384.552 126.773,-377.11"/>
<polygon fill="#000000" stroke="#000000" points="128.592,-380.11 135.865,-372.405 125.375,-373.893 128.592,-380.11"/>
</g>
<!-- proc~update_neutrals -->
<g id="proc~~halo~~CallsGraph_node15" class="node"><title>proc~update_neutrals</title>
<g id="a_proc~~halo~~CallsGraph_node15"><a xlink:href=".././proc/update_neutrals.html" xlink:title="update_neutrals">
<polygon fill="#d9534f" stroke="#d9534f" points="208,-980 118,-980 118,-956 208,-956 208,-980"/>
<text text-anchor="middle" x="163" y="-965.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_neutrals</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~update_neutrals -->
<g id="proc~~halo~~CallsGraph_edge14" class="edge"><title>proc~halo&#45;&gt;proc~update_neutrals</title>
<path fill="none" stroke="#000000" d="M29.5271,-718.118C35.3141,-762.194 57.2386,-913.173 90,-947 95.1068,-952.273 101.456,-956.242 108.253,-959.225"/>
<polygon fill="#000000" stroke="#000000" points="107.131,-962.542 117.724,-962.713 109.549,-955.973 107.131,-962.542"/>
</g>
<!-- proc~parallel_merge_populations -->
<g id="proc~~halo~~CallsGraph_node16" class="node"><title>proc~parallel_merge_populations</title>
<g id="a_proc~~halo~~CallsGraph_node16"><a xlink:href=".././proc/parallel_merge_populations.html" xlink:title="parallel_merge_populations">
<polygon fill="#d9534f" stroke="#d9534f" points="235.5,-938 90.5,-938 90.5,-914 235.5,-914 235.5,-938"/>
<text text-anchor="middle" x="163" y="-923.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_merge_populations</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~parallel_merge_populations -->
<g id="proc~~halo~~CallsGraph_edge15" class="edge"><title>proc~halo&#45;&gt;proc~parallel_merge_populations</title>
<path fill="none" stroke="#000000" d="M28.3398,-718.317C29.9346,-752.068 38.9715,-847.036 90,-900 93.3397,-903.466 97.1757,-906.472 101.3,-909.079"/>
<polygon fill="#000000" stroke="#000000" points="99.6525,-912.167 110.107,-913.887 103.007,-906.023 99.6525,-912.167"/>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~halo~~CallsGraph_node17" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~halo~~CallsGraph_node17"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="532.5,-850 459.5,-850 459.5,-826 532.5,-826 532.5,-850"/>
<text text-anchor="middle" x="496" y="-835.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;interface~parallel_sum -->
<g id="proc~~halo~~CallsGraph_edge4" class="edge"><title>proc~halo&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M54.229,-712.146C128.944,-729.735 341.875,-780.451 410,-803 426.405,-808.43 444.14,-815.528 459.144,-821.912"/>
<polygon fill="#000000" stroke="#000000" points="458,-825.23 468.568,-825.979 460.773,-818.803 458,-825.23"/>
</g>
<!-- proc~neutral_cx_rate -->
<g id="proc~~halo~~CallsGraph_node18" class="node"><title>proc~neutral_cx_rate</title>
<g id="a_proc~~halo~~CallsGraph_node18"><a xlink:href=".././proc/neutral_cx_rate.html" xlink:title="neutral_cx_rate">
<polygon fill="#d9534f" stroke="#d9534f" points="206.5,-441 119.5,-441 119.5,-417 206.5,-417 206.5,-441"/>
<text text-anchor="middle" x="163" y="-426.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutral_cx_rate</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~neutral_cx_rate -->
<g id="proc~~halo~~CallsGraph_edge17" class="edge"><title>proc~halo&#45;&gt;proc~neutral_cx_rate</title>
<path fill="none" stroke="#000000" d="M29.5588,-693.526C34.1865,-660.036 50.0943,-566.216 90,-500 102.423,-479.385 122.191,-460.487 137.873,-447.38"/>
<polygon fill="#000000" stroke="#000000" points="140.082,-450.094 145.641,-441.075 135.671,-444.659 140.082,-450.094"/>
</g>
<!-- interface~randu -->
<g id="proc~~halo~~CallsGraph_node46" class="node"><title>interface~randu</title>
<g id="a_proc~~halo~~CallsGraph_node46"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="907,-1222 853,-1222 853,-1198 907,-1198 907,-1222"/>
<text text-anchor="middle" x="880" y="-1207.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~mc_beam_grid&#45;&gt;interface~randu -->
<g id="proc~~halo~~CallsGraph_edge18" class="edge"><title>proc~mc_beam_grid&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M777.487,-1276.83C797.453,-1263.69 829.447,-1242.62 852.177,-1227.66"/>
<polygon fill="#000000" stroke="#000000" points="854.261,-1230.48 860.689,-1222.05 850.412,-1224.63 854.261,-1230.48"/>
</g>
<!-- interface~randn -->
<g id="proc~~halo~~CallsGraph_node38" class="node"><title>interface~randn</title>
<g id="a_proc~~halo~~CallsGraph_node38"><a xlink:href=".././interface/randn.html" xlink:title="randn">
<polygon fill="#a7506f" stroke="#a7506f" points="368,-108 314,-108 314,-84 368,-84 368,-108"/>
<text text-anchor="middle" x="341" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randn</text>
</a>
</g>
</g>
<!-- proc~mc_halo&#45;&gt;interface~randn -->
<g id="proc~~halo~~CallsGraph_edge19" class="edge"><title>proc~mc_halo&#45;&gt;interface~randn</title>
<path fill="none" stroke="#000000" d="M190.146,-318.916C205.616,-316.866 224.396,-311.679 236,-299 291.669,-238.172 216.812,-178.264 272,-117 280.187,-107.912 292.211,-102.712 303.881,-99.7526"/>
<polygon fill="#000000" stroke="#000000" points="304.847,-103.127 313.939,-97.6871 303.439,-96.2703 304.847,-103.127"/>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~ind2sub -->
<g id="proc~~halo~~CallsGraph_edge23" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M198.85,-852.14C211.891,-855.961 225.961,-862.117 236,-872 268.177,-903.676 239.088,-936.089 272,-967 280.777,-975.243 292.726,-980.254 304.16,-983.298"/>
<polygon fill="#000000" stroke="#000000" points="303.459,-986.728 313.982,-985.499 304.99,-979.897 303.459,-986.728"/>
</g>
<!-- proc~rng_init -->
<g id="proc~~halo~~CallsGraph_node21" class="node"><title>proc~rng_init</title>
<g id="a_proc~~halo~~CallsGraph_node21"><a xlink:href=".././proc/rng_init.html" xlink:title="rng_init">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-958 314,-958 314,-934 368,-934 368,-958"/>
<text text-anchor="middle" x="341" y="-943.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rng_init</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~rng_init -->
<g id="proc~~halo~~CallsGraph_edge21" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~rng_init</title>
<path fill="none" stroke="#000000" d="M198.509,-856.328C210.665,-860.518 224.227,-865.834 236,-872 266.059,-887.744 297.367,-911.129 317.676,-927.381"/>
<polygon fill="#000000" stroke="#000000" points="315.7,-930.285 325.671,-933.867 320.11,-924.849 315.7,-930.285"/>
</g>
<!-- interface~randind_cdf -->
<g id="proc~~halo~~CallsGraph_node25" class="node"><title>interface~randind_cdf</title>
<g id="a_proc~~halo~~CallsGraph_node25"><a xlink:href=".././interface/randind_cdf.html" xlink:title="randind_cdf">
<polygon fill="#a7506f" stroke="#a7506f" points="375.5,-836 306.5,-836 306.5,-812 375.5,-812 375.5,-836"/>
<text text-anchor="middle" x="341" y="-821.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind_cdf</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;interface~randind_cdf -->
<g id="proc~~halo~~CallsGraph_edge22" class="edge"><title>proc~get_nlaunch&#45;&gt;interface~randind_cdf</title>
<path fill="none" stroke="#000000" d="M198.772,-841.654C226.731,-838.159 266.174,-833.228 296.272,-829.466"/>
<polygon fill="#000000" stroke="#000000" points="297.006,-832.902 306.494,-828.188 296.138,-825.956 297.006,-832.902"/>
</g>
<!-- proc~cumsum -->
<g id="proc~~halo~~CallsGraph_node47" class="node"><title>proc~cumsum</title>
<g id="a_proc~~halo~~CallsGraph_node47"><a xlink:href=".././proc/cumsum.html" xlink:title="cumsum">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-878 314,-878 314,-854 368,-854 368,-878"/>
<text text-anchor="middle" x="341" y="-863.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cumsum</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~cumsum -->
<g id="proc~~halo~~CallsGraph_edge20" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~cumsum</title>
<path fill="none" stroke="#000000" d="M198.772,-849.951C229.061,-853.393 272.827,-858.367 303.59,-861.862"/>
<polygon fill="#000000" stroke="#000000" points="303.554,-865.381 313.886,-863.032 304.345,-858.426 303.554,-865.381"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~halo~~CallsGraph_node23" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~halo~~CallsGraph_node23"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="663,-554 595,-554 595,-530 663,-530 663,-554"/>
<text text-anchor="middle" x="629" y="-539.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~halo~~CallsGraph_edge25" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M375.147,-711.94C418.647,-717.816 495.395,-721.349 546,-685 577.338,-662.49 562.648,-639.381 582,-606 590.836,-590.759 602.419,-574.66 611.752,-562.421"/>
<polygon fill="#000000" stroke="#000000" points="614.718,-564.307 618.078,-554.259 609.185,-560.019 614.718,-564.307"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~halo~~CallsGraph_node29" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~halo~~CallsGraph_node29"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="792,-537 724,-537 724,-513 792,-513 792,-537"/>
<text text-anchor="middle" x="758" y="-522.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~halo~~CallsGraph_edge26" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M375.316,-718.046C418.317,-731.346 493.802,-746.845 546,-714 577.295,-694.308 557.607,-666.786 582,-639 621.034,-594.537 681.405,-560.44 720.054,-541.559"/>
<polygon fill="#000000" stroke="#000000" points="721.879,-544.566 729.386,-537.089 718.856,-538.252 721.879,-544.566"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~halo~~CallsGraph_node39" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~halo~~CallsGraph_node39"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="526.5,-634 465.5,-634 465.5,-610 526.5,-610 526.5,-634"/>
<text text-anchor="middle" x="496" y="-619.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~halo~~CallsGraph_edge27" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M375.125,-699.758C386.782,-696.561 399.567,-691.848 410,-685 430.553,-671.509 426.186,-657.554 446,-643 449.182,-640.663 452.664,-638.521 456.257,-636.576"/>
<polygon fill="#000000" stroke="#000000" points="457.872,-639.682 465.313,-632.141 454.793,-633.396 457.872,-639.682"/>
</g>
<!-- proc~get_position -->
<g id="proc~~halo~~CallsGraph_node43" class="node"><title>proc~get_position</title>
<g id="a_proc~~halo~~CallsGraph_node43"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="531,-676 461,-676 461,-652 531,-652 531,-676"/>
<text text-anchor="middle" x="496" y="-661.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~halo~~CallsGraph_edge24" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M375.199,-696.887C397.445,-690.78 426.977,-682.673 451.152,-676.037"/>
<polygon fill="#000000" stroke="#000000" points="452.09,-679.409 460.807,-673.386 450.237,-672.659 452.09,-679.409"/>
</g>
<!-- proc~get_passive_grid_indices -->
<g id="proc~~halo~~CallsGraph_node19" class="node"><title>proc~get_passive_grid_indices</title>
<g id="a_proc~~halo~~CallsGraph_node19"><a xlink:href=".././proc/get_passive_grid_indices.html" xlink:title="get_passive_grid_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="407.5,-512 274.5,-512 274.5,-488 407.5,-488 407.5,-512"/>
<text text-anchor="middle" x="341" y="-497.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_passive_grid_indices</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_passive_grid_indices -->
<g id="proc~~halo~~CallsGraph_edge28" class="edge"><title>proc~store_photons&#45;&gt;proc~get_passive_grid_indices</title>
<path fill="none" stroke="#000000" d="M203.937,-516.235C221.805,-514.103 243.485,-511.516 264.24,-509.04"/>
<polygon fill="#000000" stroke="#000000" points="264.818,-512.495 274.333,-507.835 263.989,-505.545 264.818,-512.495"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~halo~~CallsGraph_edge32" class="edge"><title>proc~store_photons&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M191.554,-508.91C213.133,-499.779 244.072,-487.424 272,-479 347.784,-456.141 367.301,-449.493 446,-441 547.632,-430.032 581.918,-401.024 676,-441 706.075,-453.779 730.407,-483.801 744.294,-504.265"/>
<polygon fill="#000000" stroke="#000000" points="741.529,-506.433 749.922,-512.898 747.393,-502.61 741.529,-506.433"/>
</g>
<!-- proc~spectrum -->
<g id="proc~~halo~~CallsGraph_node45" class="node"><title>proc~spectrum</title>
<g id="a_proc~~halo~~CallsGraph_node45"><a xlink:href=".././proc/spectrum.html" xlink:title="spectrum">
<polygon fill="#d9534f" stroke="#d9534f" points="369.5,-432 312.5,-432 312.5,-408 369.5,-408 369.5,-432"/>
<text text-anchor="middle" x="341" y="-417.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spectrum</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~spectrum -->
<g id="proc~~halo~~CallsGraph_edge29" class="edge"><title>proc~store_photons&#45;&gt;proc~spectrum</title>
<path fill="none" stroke="#000000" d="M178.986,-508.831C199.18,-492.858 236.679,-464.663 272,-446 281.654,-440.899 292.536,-436.28 302.718,-432.398"/>
<polygon fill="#000000" stroke="#000000" points="304.025,-435.647 312.203,-428.911 301.61,-429.077 304.025,-435.647"/>
</g>
<!-- proc~get_indices -->
<g id="proc~~halo~~CallsGraph_node48" class="node"><title>proc~get_indices</title>
<g id="a_proc~~halo~~CallsGraph_node48"><a xlink:href=".././proc/get_indices.html" xlink:title="get_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="374.5,-596 307.5,-596 307.5,-572 374.5,-572 374.5,-596"/>
<text text-anchor="middle" x="341" y="-581.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_indices</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_indices -->
<g id="proc~~halo~~CallsGraph_edge30" class="edge"><title>proc~store_photons&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M193.585,-533.162C215.17,-541.875 245.213,-553.668 272,-563 280.219,-565.863 289.063,-568.74 297.566,-571.407"/>
<polygon fill="#000000" stroke="#000000" points="296.745,-574.817 307.333,-574.428 298.813,-568.13 296.745,-574.817"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~halo~~CallsGraph_node49" class="node"><title>proc~get_fields</title>
<g id="a_proc~~halo~~CallsGraph_node49"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="370,-554 312,-554 312,-530 370,-530 370,-554"/>
<text text-anchor="middle" x="341" y="-539.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_fields -->
<g id="proc~~halo~~CallsGraph_edge31" class="edge"><title>proc~store_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M203.937,-525.765C233.294,-529.268 272.944,-533.999 301.867,-537.45"/>
<polygon fill="#000000" stroke="#000000" points="301.654,-540.949 311.998,-538.659 302.483,-533.999 301.654,-540.949"/>
</g>
<!-- proc~merge_neutral_populations&#45;&gt;proc~ind2sub -->
<g id="proc~~halo~~CallsGraph_edge33" class="edge"><title>proc~merge_neutral_populations&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M199.616,-1035.86C230.028,-1025.49 273.564,-1010.65 304.067,-1000.25"/>
<polygon fill="#000000" stroke="#000000" points="305.538,-1003.45 313.874,-996.907 303.279,-996.821 305.538,-1003.45"/>
</g>
<!-- proc~merge_reservoirs -->
<g id="proc~~halo~~CallsGraph_node32" class="node"><title>proc~merge_reservoirs</title>
<g id="a_proc~~halo~~CallsGraph_node32"><a xlink:href=".././proc/merge_reservoirs.html" xlink:title="merge_reservoirs">
<polygon fill="#d9534f" stroke="#d9534f" points="544.5,-1202 447.5,-1202 447.5,-1178 544.5,-1178 544.5,-1202"/>
<text text-anchor="middle" x="496" y="-1187.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">merge_reservoirs</text>
</a>
</g>
</g>
<!-- proc~merge_neutral_populations&#45;&gt;proc~merge_reservoirs -->
<g id="proc~~halo~~CallsGraph_edge34" class="edge"><title>proc~merge_neutral_populations&#45;&gt;proc~merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M192.221,-1060.11C251.825,-1085.68 390.546,-1145.19 457.509,-1173.92"/>
<polygon fill="#000000" stroke="#000000" points="456.281,-1177.2 466.851,-1177.92 459.04,-1170.76 456.281,-1177.2"/>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;interface~parallel_sum -->
<g id="proc~~halo~~CallsGraph_edge39" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M359.912,-1055.99C374.928,-1045.16 396.086,-1028.06 410,-1009 433.947,-976.192 428.008,-961.415 446,-925 457.403,-901.921 472.065,-876.342 482.368,-858.93"/>
<polygon fill="#000000" stroke="#000000" points="485.479,-860.546 487.595,-850.165 479.467,-856.961 485.479,-860.546"/>
</g>
<!-- proc~init_reservoir -->
<g id="proc~~halo~~CallsGraph_node22" class="node"><title>proc~init_reservoir</title>
<g id="a_proc~~halo~~CallsGraph_node22"><a xlink:href=".././proc/init_reservoir.html" xlink:title="init_reservoir">
<polygon fill="#d9534f" stroke="#d9534f" points="795,-1202 721,-1202 721,-1178 795,-1178 795,-1202"/>
<text text-anchor="middle" x="758" y="-1187.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_reservoir</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~init_reservoir -->
<g id="proc~~halo~~CallsGraph_edge38" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M384.095,-1080.04C393.023,-1083.52 402.121,-1087.81 410,-1093 429.43,-1105.8 425.583,-1119.85 446,-1131 490.969,-1155.56 635.446,-1175.65 710.599,-1184.74"/>
<polygon fill="#000000" stroke="#000000" points="710.381,-1188.24 720.726,-1185.95 711.212,-1181.29 710.381,-1188.24"/>
</g>
<!-- proc~my_rank -->
<g id="proc~~halo~~CallsGraph_node26" class="node"><title>proc~my_rank</title>
<g id="a_proc~~halo~~CallsGraph_node26"><a xlink:href=".././proc/my_rank.html" xlink:title="my_rank">
<polygon fill="#d94e8f" stroke="#d94e8f" points="523,-1080 469,-1080 469,-1056 523,-1056 523,-1080"/>
<text text-anchor="middle" x="496" y="-1065.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">my_rank</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~my_rank -->
<g id="proc~~halo~~CallsGraph_edge35" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~my_rank</title>
<path fill="none" stroke="#000000" d="M409.553,-1068C426.431,-1068 443.897,-1068 458.605,-1068"/>
<polygon fill="#000000" stroke="#000000" points="458.78,-1071.5 468.78,-1068 458.78,-1064.5 458.78,-1071.5"/>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~merge_reservoirs -->
<g id="proc~~halo~~CallsGraph_edge37" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M354.281,-1080.09C377.368,-1102.69 426.655,-1150.29 446,-1164 450.518,-1167.2 455.478,-1170.28 460.454,-1173.12"/>
<polygon fill="#000000" stroke="#000000" points="458.881,-1176.25 469.336,-1177.97 462.234,-1170.11 458.881,-1176.25"/>
</g>
<!-- proc~num_ranks -->
<g id="proc~~halo~~CallsGraph_node44" class="node"><title>proc~num_ranks</title>
<g id="a_proc~~halo~~CallsGraph_node44"><a xlink:href=".././proc/num_ranks.html" xlink:title="num_ranks">
<polygon fill="#d94e8f" stroke="#d94e8f" points="529,-1122 463,-1122 463,-1098 529,-1098 529,-1122"/>
<text text-anchor="middle" x="496" y="-1107.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">num_ranks</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~num_ranks -->
<g id="proc~~halo~~CallsGraph_edge36" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~num_ranks</title>
<path fill="none" stroke="#000000" d="M385.844,-1080.04C406.94,-1085.83 432.115,-1092.74 452.969,-1098.46"/>
<polygon fill="#000000" stroke="#000000" points="452.253,-1101.89 462.823,-1101.17 454.106,-1095.14 452.253,-1101.89"/>
</g>
<!-- proc~store_photon_birth&#45;&gt;proc~get_passive_grid_indices -->
<g id="proc~~halo~~CallsGraph_edge40" class="edge"><title>proc~store_photon_birth&#45;&gt;proc~get_passive_grid_indices</title>
<path fill="none" stroke="#000000" d="M180.795,-580.935C206.191,-562.841 253.378,-529.853 272,-521 276.064,-519.068 280.349,-517.26 284.708,-515.581"/>
<polygon fill="#000000" stroke="#000000" points="286.098,-518.801 294.315,-512.112 283.721,-512.217 286.098,-518.801"/>
</g>
<!-- proc~update_reservoir -->
<g id="proc~~halo~~CallsGraph_node35" class="node"><title>proc~update_reservoir</title>
<g id="a_proc~~halo~~CallsGraph_node35"><a xlink:href=".././proc/update_reservoir.html" xlink:title="update_reservoir">
<polygon fill="#d9534f" stroke="#d9534f" points="676,-1122 582,-1122 582,-1098 676,-1098 676,-1122"/>
<text text-anchor="middle" x="629" y="-1107.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_reservoir</text>
</a>
</g>
</g>
<!-- proc~store_photon_birth&#45;&gt;proc~update_reservoir -->
<g id="proc~~halo~~CallsGraph_edge41" class="edge"><title>proc~store_photon_birth&#45;&gt;proc~update_reservoir</title>
<path fill="none" stroke="#000000" d="M196.386,-605.076C210.14,-611.572 225.41,-620.796 236,-633 265.321,-666.789 242.617,-693.266 272,-727 317.989,-779.799 358.836,-755.199 410,-803 431.62,-823.199 425.204,-837.953 446,-859 483.427,-896.881 515.74,-881.181 546,-925 587.419,-984.977 538.055,-1026.85 582,-1085 583.85,-1087.45 586.011,-1089.68 588.37,-1091.72"/>
<polygon fill="#000000" stroke="#000000" points="586.821,-1094.92 596.984,-1097.91 590.905,-1089.23 586.821,-1094.92"/>
</g>
<!-- proc~store_photon_birth&#45;&gt;proc~get_indices -->
<g id="proc~~halo~~CallsGraph_edge42" class="edge"><title>proc~store_photon_birth&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M214.906,-590.397C240.934,-589.066 272.261,-587.464 297.054,-586.196"/>
<polygon fill="#000000" stroke="#000000" points="297.437,-589.681 307.245,-585.675 297.08,-582.69 297.437,-589.681"/>
</g>
<!-- proc~track&#45;&gt;proc~get_plasma -->
<g id="proc~~halo~~CallsGraph_edge44" class="edge"><title>proc~track&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M190.349,-661.785C218.506,-670.104 263.586,-683.423 296.918,-693.271"/>
<polygon fill="#000000" stroke="#000000" points="296.272,-696.73 306.854,-696.207 298.255,-690.017 296.272,-696.73"/>
</g>
<!-- proc~doppler_stark -->
<g id="proc~~halo~~CallsGraph_node33" class="node"><title>proc~doppler_stark</title>
<g id="a_proc~~halo~~CallsGraph_node33"><a xlink:href=".././proc/doppler_stark.html" xlink:title="doppler_stark">
<polygon fill="#d9534f" stroke="#d9534f" points="380,-676 302,-676 302,-652 380,-652 380,-676"/>
<text text-anchor="middle" x="341" y="-661.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">doppler_stark</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~doppler_stark -->
<g id="proc~~halo~~CallsGraph_edge43" class="edge"><title>proc~track&#45;&gt;proc~doppler_stark</title>
<path fill="none" stroke="#000000" d="M190.349,-655.497C217,-657.011 258.813,-659.387 291.474,-661.243"/>
<polygon fill="#000000" stroke="#000000" points="291.543,-664.752 301.726,-661.825 291.941,-657.764 291.543,-664.752"/>
</g>
<!-- proc~track&#45;&gt;proc~in_plasma -->
<g id="proc~~halo~~CallsGraph_edge47" class="edge"><title>proc~track&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M190.183,-651.277C212.051,-649.016 244.052,-645.739 272,-643 336.134,-636.714 410.68,-629.767 455.285,-625.648"/>
<polygon fill="#000000" stroke="#000000" points="455.778,-629.118 465.414,-624.714 455.135,-622.147 455.778,-629.118"/>
</g>
<!-- proc~track&#45;&gt;proc~get_indices -->
<g id="proc~~halo~~CallsGraph_edge45" class="edge"><title>proc~track&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M190.125,-643.172C211.958,-634.166 243.941,-621.079 272,-610 280.633,-606.591 289.909,-602.999 298.749,-599.608"/>
<polygon fill="#000000" stroke="#000000" points="300.027,-602.867 308.118,-596.027 297.527,-596.328 300.027,-602.867"/>
</g>
<!-- proc~track&#45;&gt;proc~get_fields -->
<g id="proc~~halo~~CallsGraph_edge46" class="edge"><title>proc~track&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M190.128,-643.008C204.662,-636.072 222.487,-626.132 236,-614 256.645,-595.464 249.546,-579.297 272,-563 280.866,-556.565 291.747,-552.069 302.185,-548.94"/>
<polygon fill="#000000" stroke="#000000" points="303.209,-552.289 311.975,-546.34 301.412,-545.523 303.209,-552.289"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~halo~~CallsGraph_node36" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~halo~~CallsGraph_node36"><a xlink:href=".././proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="385,-348 297,-348 297,-324 385,-324 385,-348"/>
<text text-anchor="middle" x="341" y="-333.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~halo~~CallsGraph_edge48" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M190.349,-358.108C215.702,-354.362 254.776,-348.59 286.64,-343.883"/>
<polygon fill="#000000" stroke="#000000" points="287.324,-347.32 296.705,-342.396 286.301,-340.395 287.324,-347.32"/>
</g>
<!-- proc~eigen -->
<g id="proc~~halo~~CallsGraph_node37" class="node"><title>proc~eigen</title>
<g id="a_proc~~halo~~CallsGraph_node37"><a xlink:href=".././proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-150 314,-150 314,-126 368,-126 368,-150"/>
<text text-anchor="middle" x="341" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~halo~~CallsGraph_edge50" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M190.276,-359.825C205.218,-357.355 223.402,-352.109 236,-341 266.159,-314.406 254.063,-293.987 272,-258 289.744,-222.4 313.092,-182.475 327.3,-158.827"/>
<polygon fill="#000000" stroke="#000000" points="330.437,-160.402 332.613,-150.033 324.446,-156.782 330.437,-160.402"/>
</g>
<!-- proc~linsolve -->
<g id="proc~~halo~~CallsGraph_node41" class="node"><title>proc~linsolve</title>
<g id="a_proc~~halo~~CallsGraph_node41"><a xlink:href=".././proc/linsolve.html" xlink:title="linsolve">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-291 314,-291 314,-267 368,-267 368,-291"/>
<text text-anchor="middle" x="341" y="-276.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linsolve</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~linsolve -->
<g id="proc~~halo~~CallsGraph_edge49" class="edge"><title>proc~colrad&#45;&gt;proc~linsolve</title>
<path fill="none" stroke="#000000" d="M190.117,-356.663C204.148,-353.239 221.494,-348.09 236,-341 253.732,-332.333 255.238,-325.42 272,-315 282.901,-308.223 295.2,-301.461 306.311,-295.658"/>
<polygon fill="#000000" stroke="#000000" points="308.016,-298.717 315.308,-291.03 304.814,-292.492 308.016,-298.717"/>
</g>
<!-- proc~update_neutrals&#45;&gt;proc~update_reservoir -->
<g id="proc~~halo~~CallsGraph_edge51" class="edge"><title>proc~update_neutrals&#45;&gt;proc~update_reservoir</title>
<path fill="none" stroke="#000000" d="M208.212,-975.816C217.59,-978.194 227.283,-981.212 236,-985 253.636,-992.664 254.023,-1002.17 272,-1009 386.936,-1052.64 436.674,-990.761 546,-1047 566.688,-1057.64 563.552,-1070.83 582,-1085 585.584,-1087.75 589.51,-1090.38 593.512,-1092.83"/>
<polygon fill="#000000" stroke="#000000" points="591.872,-1095.92 602.286,-1097.87 595.36,-1089.85 591.872,-1095.92"/>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;proc~ind2sub -->
<g id="proc~~halo~~CallsGraph_edge54" class="edge"><title>proc~parallel_merge_populations&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M211.005,-938.062C219.442,-940.69 228.069,-943.69 236,-947 252.891,-954.051 255.165,-959.816 272,-967 282.162,-971.336 293.522,-975.205 304.003,-978.405"/>
<polygon fill="#000000" stroke="#000000" points="303.133,-981.797 313.714,-981.26 305.108,-975.081 303.133,-981.797"/>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;proc~parallel_merge_reservoirs -->
<g id="proc~~halo~~CallsGraph_edge53" class="edge"><title>proc~parallel_merge_populations&#45;&gt;proc~parallel_merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M221.07,-938.086C226.402,-940.53 231.489,-943.468 236,-947 261.089,-966.643 251.69,-984.448 272,-1009 284.623,-1024.26 301.408,-1038.87 315.143,-1049.73"/>
<polygon fill="#000000" stroke="#000000" points="313.183,-1052.64 323.237,-1055.98 317.462,-1047.1 313.183,-1052.64"/>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;interface~parallel_sum -->
<g id="proc~~halo~~CallsGraph_edge52" class="edge"><title>proc~parallel_merge_populations&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M235.676,-921.571C285.681,-916.824 353.336,-907.049 410,-887 431.407,-879.426 453.569,-866.452 469.895,-855.757"/>
<polygon fill="#000000" stroke="#000000" points="471.971,-858.578 478.322,-850.098 468.069,-852.767 471.971,-858.578"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~halo~~CallsGraph_node20" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~halo~~CallsGraph_node20"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="673,-790 585,-790 585,-766 673,-766 673,-790"/>
<text text-anchor="middle" x="629" y="-775.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~halo~~CallsGraph_edge57" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M523.51,-825.858C543.308,-816.79 570.578,-804.3 592.295,-794.353"/>
<polygon fill="#000000" stroke="#000000" points="593.895,-797.47 601.53,-790.124 590.98,-791.106 593.895,-797.47"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~halo~~CallsGraph_node24" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~halo~~CallsGraph_node24"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="803.5,-690 712.5,-690 712.5,-666 803.5,-666 803.5,-690"/>
<text text-anchor="middle" x="758" y="-675.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~halo~~CallsGraph_edge64" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M502.514,-825.768C513.84,-802.08 542.059,-749.916 582,-723 617.787,-698.883 665.647,-687.691 702.269,-682.497"/>
<polygon fill="#000000" stroke="#000000" points="702.821,-685.955 712.282,-681.186 701.912,-679.014 702.821,-685.955"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_node27" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~halo~~CallsGraph_node27"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="803.5,-986 712.5,-986 712.5,-962 803.5,-962 803.5,-986"/>
<text text-anchor="middle" x="758" y="-971.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_edge55" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M527.975,-850.009C534.596,-853.705 541.07,-858.332 546,-864 576.726,-899.326 544.514,-934.95 582,-963 615.864,-988.34 664.517,-989.415 701.931,-985.099"/>
<polygon fill="#000000" stroke="#000000" points="702.705,-988.527 712.164,-983.755 701.793,-981.587 702.705,-988.527"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~halo~~CallsGraph_node28" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~halo~~CallsGraph_node28"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-1034 583.5,-1034 583.5,-1010 674.5,-1010 674.5,-1034"/>
<text text-anchor="middle" x="629" y="-1019.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~halo~~CallsGraph_edge61" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M528.828,-850.009C535.253,-853.671 541.429,-858.284 546,-864 583.981,-911.489 544.654,-948.01 582,-996 584.335,-999 587.119,-1001.71 590.145,-1004.15"/>
<polygon fill="#000000" stroke="#000000" points="588.362,-1007.17 598.582,-1009.96 592.335,-1001.4 588.362,-1007.17"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~halo~~CallsGraph_node30" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~halo~~CallsGraph_node30"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="802,-812 714,-812 714,-788 802,-788 802,-812"/>
<text text-anchor="middle" x="758" y="-797.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~halo~~CallsGraph_edge62" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.607,-832.796C576.715,-826.349 652.278,-815.305 703.404,-807.833"/>
<polygon fill="#000000" stroke="#000000" points="704.216,-811.252 713.604,-806.342 703.203,-804.326 704.216,-811.252"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~halo~~CallsGraph_node31" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~halo~~CallsGraph_node31"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="802,-732 714,-732 714,-708 802,-708 802,-732"/>
<text text-anchor="middle" x="758" y="-717.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~halo~~CallsGraph_edge63" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M505.973,-825.943C520.062,-807.936 549.176,-774.291 582,-757 619.76,-737.109 667.413,-727.912 703.455,-723.658"/>
<polygon fill="#000000" stroke="#000000" points="704.205,-727.098 713.768,-722.538 703.448,-720.139 704.205,-727.098"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~halo~~CallsGraph_node34" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~halo~~CallsGraph_node34"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="673,-870 585,-870 585,-846 673,-846 673,-870"/>
<text text-anchor="middle" x="629" y="-855.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~halo~~CallsGraph_edge56" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.796,-843.465C545.72,-845.438 560.6,-847.71 574.699,-849.862"/>
<polygon fill="#000000" stroke="#000000" points="574.374,-853.353 584.788,-851.403 575.431,-846.434 574.374,-853.353"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~halo~~CallsGraph_node40" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~halo~~CallsGraph_node40"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-954 583.5,-954 583.5,-930 674.5,-930 674.5,-954"/>
<text text-anchor="middle" x="629" y="-939.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~halo~~CallsGraph_edge60" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M525.857,-850.127C532.927,-853.922 540.139,-858.565 546,-864 567.971,-884.373 559.432,-901.291 582,-921 583.318,-922.151 584.71,-923.251 586.157,-924.299"/>
<polygon fill="#000000" stroke="#000000" points="584.56,-927.429 594.896,-929.756 588.268,-921.491 584.56,-927.429"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~halo~~CallsGraph_node42" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~halo~~CallsGraph_node42"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-912 583.5,-912 583.5,-888 674.5,-888 674.5,-912"/>
<text text-anchor="middle" x="629" y="-897.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~halo~~CallsGraph_edge58" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M521.853,-850.159C538.766,-858.391 561.681,-869.463 582,-879 585.196,-880.5 588.524,-882.047 591.862,-883.59"/>
<polygon fill="#000000" stroke="#000000" points="590.651,-886.885 601.199,-887.88 593.574,-880.525 590.651,-886.885"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~halo~~CallsGraph_node50" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~halo~~CallsGraph_node50"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-1076 583.5,-1076 583.5,-1052 674.5,-1052 674.5,-1076"/>
<text text-anchor="middle" x="629" y="-1061.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~halo~~CallsGraph_edge59" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M529.625,-850.076C535.849,-853.704 541.74,-858.287 546,-864 594.508,-929.054 531.576,-979.419 582,-1043 582.597,-1043.75 583.226,-1044.48 583.885,-1045.18"/>
<polygon fill="#000000" stroke="#000000" points="581.935,-1048.11 591.877,-1051.77 586.389,-1042.71 581.935,-1048.11"/>
</g>
<!-- proc~bb_cx_rates -->
<g id="proc~~halo~~CallsGraph_node51" class="node"><title>proc~bb_cx_rates</title>
<g id="a_proc~~halo~~CallsGraph_node51"><a xlink:href=".././proc/bb_cx_rates.html" xlink:title="bb_cx_rates">
<polygon fill="#d9534f" stroke="#d9534f" points="376.5,-390 305.5,-390 305.5,-366 376.5,-366 376.5,-390"/>
<text text-anchor="middle" x="341" y="-375.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bb_cx_rates</text>
</a>
</g>
</g>
<!-- proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates -->
<g id="proc~~halo~~CallsGraph_edge65" class="edge"><title>proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates</title>
<path fill="none" stroke="#000000" d="M205.71,-416.914C232.779,-409.07 268.018,-398.858 295.605,-390.864"/>
<polygon fill="#000000" stroke="#000000" points="296.763,-394.173 305.394,-388.028 294.815,-387.45 296.763,-394.173"/>
</g>
<!-- proc~xyz_to_cyl -->
<g id="proc~~halo~~CallsGraph_node56" class="node"><title>proc~xyz_to_cyl</title>
<g id="a_proc~~halo~~CallsGraph_node56"><a xlink:href=".././proc/xyz_to_cyl.html" xlink:title="xyz_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="527,-474 465,-474 465,-450 527,-450 527,-474"/>
<text text-anchor="middle" x="496" y="-459.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_cyl</text>
</a>
</g>
</g>
<!-- proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl -->
<g id="proc~~halo~~CallsGraph_edge66" class="edge"><title>proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl</title>
<path fill="none" stroke="#000000" d="M390.41,-487.977C411.136,-482.829 435.055,-476.888 454.785,-471.988"/>
<polygon fill="#000000" stroke="#000000" points="455.819,-475.338 464.681,-469.53 454.132,-468.544 455.819,-475.338"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~halo~~CallsGraph_edge67" class="edge"><title>proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M673.351,-785.51C683.16,-787.209 693.684,-789.032 703.844,-790.792"/>
<polygon fill="#000000" stroke="#000000" points="703.394,-794.266 713.844,-792.524 704.589,-787.369 703.394,-794.266"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_node61" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="919.5,-889 840.5,-889 840.5,-865 919.5,-865 919.5,-889"/>
<text text-anchor="middle" x="880" y="-874.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge68" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M673.192,-768.112C709.961,-761.984 763.16,-758.681 804,-779 836.058,-794.949 858.223,-831.841 869.749,-855.533"/>
<polygon fill="#000000" stroke="#000000" points="866.655,-857.179 874.036,-864.78 873.005,-854.235 866.655,-857.179"/>
</g>
<!-- proc~rng_init&#45;&gt;proc~my_rank -->
<g id="proc~~halo~~CallsGraph_edge70" class="edge"><title>proc~rng_init&#45;&gt;proc~my_rank</title>
<path fill="none" stroke="#000000" d="M368.062,-950.392C381.403,-953.512 397.436,-958.672 410,-967 441.731,-988.034 468.072,-1024.3 482.657,-1047.17"/>
<polygon fill="#000000" stroke="#000000" points="479.755,-1049.13 488,-1055.78 485.705,-1045.44 479.755,-1049.13"/>
</g>
<!-- proc~rng_seed -->
<g id="proc~~halo~~CallsGraph_node67" class="node"><title>proc~rng_seed</title>
<g id="a_proc~~halo~~CallsGraph_node67"><a xlink:href=".././proc/rng_seed.html" xlink:title="rng_seed">
<polygon fill="#d94e8f" stroke="#d94e8f" points="525,-958 467,-958 467,-934 525,-934 525,-958"/>
<text text-anchor="middle" x="496" y="-943.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rng_seed</text>
</a>
</g>
</g>
<!-- proc~rng_init&#45;&gt;proc~rng_seed -->
<g id="proc~~halo~~CallsGraph_edge69" class="edge"><title>proc~rng_init&#45;&gt;proc~rng_seed</title>
<path fill="none" stroke="#000000" d="M368.302,-946C392.697,-946 429.285,-946 456.88,-946"/>
<polygon fill="#000000" stroke="#000000" points="456.972,-949.5 466.972,-946 456.972,-942.5 456.972,-949.5"/>
</g>
<!-- proc~init_reservoir&#45;&gt;interface~randu -->
<g id="proc~~halo~~CallsGraph_edge71" class="edge"><title>proc~init_reservoir&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M795.004,-1196C810.149,-1198.52 827.736,-1201.46 842.892,-1203.98"/>
<polygon fill="#000000" stroke="#000000" points="842.497,-1207.46 852.936,-1205.66 843.648,-1200.56 842.497,-1207.46"/>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge72" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M792.351,-690.057C796.614,-692.561 800.651,-695.522 804,-699 847.422,-744.097 867.398,-818.081 875.032,-854.838"/>
<polygon fill="#000000" stroke="#000000" points="871.661,-855.836 877.018,-864.977 878.531,-854.491 871.661,-855.836"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_edge73" class="edge"><title>proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M737.828,-986.014C730.784,-994.972 737.508,-1004 758,-1004 770.487,-1004 777.862,-1000.65 780.124,-996.001"/>
<polygon fill="#000000" stroke="#000000" points="783.526,-995.157 778.172,-986.014 776.656,-996.5 783.526,-995.157"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge74" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M782.55,-961.772C789.664,-957.718 797.347,-952.964 804,-948 824.927,-932.388 846.313,-911.564 860.865,-896.509"/>
<polygon fill="#000000" stroke="#000000" points="863.447,-898.874 867.813,-889.221 858.38,-894.044 863.447,-898.874"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_edge75" class="edge"><title>proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M662.047,-1009.89C678.292,-1003.75 698.209,-996.22 715.6,-989.647"/>
<polygon fill="#000000" stroke="#000000" points="716.846,-992.918 724.963,-986.109 714.371,-986.37 716.846,-992.918"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge76" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M674.636,-1030.98C712.057,-1036.02 765.411,-1037.15 804,-1013 845.095,-987.279 865.461,-930.6 873.944,-899.138"/>
<polygon fill="#000000" stroke="#000000" points="877.41,-899.706 876.463,-889.153 870.623,-897.993 877.41,-899.706"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~halo~~CallsGraph_edge77" class="edge"><title>proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M737.828,-812.014C730.784,-820.972 737.508,-830 758,-830 770.487,-830 777.862,-826.647 780.124,-822.001"/>
<polygon fill="#000000" stroke="#000000" points="783.526,-821.157 778.172,-812.014 776.656,-822.5 783.526,-821.157"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge78" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M777.75,-812.031C797.536,-824.727 828.921,-844.866 851.505,-859.357"/>
<polygon fill="#000000" stroke="#000000" points="849.679,-862.344 859.986,-864.799 853.459,-856.453 849.679,-862.344"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge79" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M785.401,-732.167C791.968,-735.985 798.651,-740.63 804,-746 836.142,-778.27 859.21,-827.102 870.709,-855.135"/>
<polygon fill="#000000" stroke="#000000" points="867.598,-856.783 874.545,-864.782 874.103,-854.197 867.598,-856.783"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;proc~init_reservoir -->
<g id="proc~~halo~~CallsGraph_edge80" class="edge"><title>proc~merge_reservoirs&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M544.688,-1190C591.982,-1190 663.966,-1190 710.751,-1190"/>
<polygon fill="#000000" stroke="#000000" points="710.912,-1193.5 720.912,-1190 710.912,-1186.5 710.912,-1193.5"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;proc~update_reservoir -->
<g id="proc~~halo~~CallsGraph_edge82" class="edge"><title>proc~merge_reservoirs&#45;&gt;proc~update_reservoir</title>
<path fill="none" stroke="#000000" d="M516.896,-1177.85C538.953,-1164.38 574.706,-1142.55 599.679,-1127.3"/>
<polygon fill="#000000" stroke="#000000" points="601.636,-1130.2 608.346,-1122 597.987,-1124.23 601.636,-1130.2"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;interface~randu -->
<g id="proc~~halo~~CallsGraph_edge83" class="edge"><title>proc~merge_reservoirs&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M544.527,-1198.77C556.706,-1200.76 569.808,-1202.67 582,-1204 675.441,-1214.18 786.368,-1212.91 842.523,-1211.33"/>
<polygon fill="#000000" stroke="#000000" points="842.789,-1214.82 852.679,-1211.02 842.578,-1207.82 842.789,-1214.82"/>
</g>
<!-- float -->
<g id="proc~~halo~~CallsGraph_node52" class="node"><title>float</title>
<polygon fill="#777777" stroke="#777777" points="656,-1281 602,-1281 602,-1257 656,-1257 656,-1281"/>
<text text-anchor="middle" x="629" y="-1266.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">float</text>
</g>
<!-- proc~merge_reservoirs&#45;&gt;float -->
<g id="proc~~halo~~CallsGraph_edge81" class="edge"><title>proc~merge_reservoirs&#45;&gt;float</title>
<path fill="none" stroke="#000000" d="M515.763,-1202.02C532.892,-1212.92 558.974,-1229.32 582,-1243 586.831,-1245.87 591.983,-1248.85 597.027,-1251.73"/>
<polygon fill="#000000" stroke="#000000" points="595.469,-1254.87 605.895,-1256.76 598.92,-1248.78 595.469,-1254.87"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~halo~~CallsGraph_edge84" class="edge"><title>proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M656.314,-845.982C675.216,-837.35 700.904,-825.618 721.603,-816.166"/>
<polygon fill="#000000" stroke="#000000" points="723.077,-819.34 730.719,-812.002 720.169,-812.973 723.077,-819.34"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge85" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M673.088,-861.288C716.828,-864.625 784.44,-869.785 830.146,-873.272"/>
<polygon fill="#000000" stroke="#000000" points="829.883,-876.762 840.12,-874.033 830.416,-869.783 829.883,-876.762"/>
</g>
<!-- proc~update_reservoir&#45;&gt;proc~init_reservoir -->
<g id="proc~~halo~~CallsGraph_edge86" class="edge"><title>proc~update_reservoir&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M652.857,-1122.05C660.37,-1126.24 668.671,-1131.12 676,-1136 692.868,-1147.24 695.185,-1152.68 712,-1164 716.379,-1166.95 721.106,-1169.91 725.794,-1172.72"/>
<polygon fill="#000000" stroke="#000000" points="724.259,-1175.87 734.659,-1177.89 727.79,-1169.83 724.259,-1175.87"/>
</g>
<!-- proc~update_reservoir&#45;&gt;interface~randu -->
<g id="proc~~halo~~CallsGraph_edge88" class="edge"><title>proc~update_reservoir&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M672.257,-1122.08C707.98,-1132.82 760.188,-1149.77 804,-1169 819.677,-1175.88 836.457,-1184.89 850.162,-1192.71"/>
<polygon fill="#000000" stroke="#000000" points="848.699,-1195.9 859.107,-1197.89 852.209,-1189.85 848.699,-1195.9"/>
</g>
<!-- interface~randind -->
<g id="proc~~halo~~CallsGraph_node57" class="node"><title>interface~randind</title>
<g id="a_proc~~halo~~CallsGraph_node57"><a xlink:href=".././interface/randind.html" xlink:title="randind">
<polygon fill="#a7506f" stroke="#a7506f" points="785,-1122 731,-1122 731,-1098 785,-1098 785,-1122"/>
<text text-anchor="middle" x="758" y="-1107.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind</text>
</a>
</g>
</g>
<!-- proc~update_reservoir&#45;&gt;interface~randind -->
<g id="proc~~halo~~CallsGraph_edge87" class="edge"><title>proc~update_reservoir&#45;&gt;interface~randind</title>
<path fill="none" stroke="#000000" d="M676.209,-1110C690.903,-1110 706.935,-1110 720.815,-1110"/>
<polygon fill="#000000" stroke="#000000" points="720.952,-1113.5 730.952,-1110 720.952,-1106.5 720.952,-1113.5"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~halo~~CallsGraph_node68" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~halo~~CallsGraph_node68"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="667.5,-394 590.5,-394 590.5,-370 667.5,-370 667.5,-394"/>
<text text-anchor="middle" x="629" y="-379.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~halo~~CallsGraph_edge89" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M385.127,-342.936C437.61,-351.378 525.941,-365.585 580.378,-374.341"/>
<polygon fill="#000000" stroke="#000000" points="580.033,-377.83 590.462,-375.962 581.145,-370.919 580.033,-377.83"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~halo~~CallsGraph_node53" class="node"><title>proc~elmhes</title>
<g id="a_proc~~halo~~CallsGraph_node53"><a xlink:href=".././proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="523,-24 469,-24 469,-0 523,-0 523,-24"/>
<text text-anchor="middle" x="496" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~halo~~CallsGraph_edge90" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M368.176,-135.246C382.038,-132.58 398.519,-127.331 410,-117 440.193,-89.8313 417.279,-61.7209 446,-33 449.927,-29.0733 454.704,-25.8337 459.718,-23.1748"/>
<polygon fill="#000000" stroke="#000000" points="461.227,-26.3337 468.866,-18.9929 458.316,-19.9674 461.227,-26.3337"/>
</g>
<!-- proc~balance -->
<g id="proc~~halo~~CallsGraph_node58" class="node"><title>proc~balance</title>
<g id="a_proc~~halo~~CallsGraph_node58"><a xlink:href=".././proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="523,-66 469,-66 469,-42 523,-42 523,-66"/>
<text text-anchor="middle" x="496" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~halo~~CallsGraph_edge91" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M368.031,-133.561C381.364,-130.429 397.398,-125.272 410,-117 430.553,-103.509 426.186,-89.5544 446,-75 450.182,-71.9283 454.882,-69.1948 459.673,-66.7988"/>
<polygon fill="#000000" stroke="#000000" points="461.233,-69.9342 468.886,-62.6067 458.334,-63.5628 461.233,-69.9342"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~halo~~CallsGraph_node59" class="node"><title>proc~hqr2</title>
<g id="a_proc~~halo~~CallsGraph_node59"><a xlink:href=".././proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="523,-192 469,-192 469,-168 523,-168 523,-192"/>
<text text-anchor="middle" x="496" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~halo~~CallsGraph_edge92" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M368.302,-145.22C393.337,-152.092 431.213,-162.49 459.034,-170.127"/>
<polygon fill="#000000" stroke="#000000" points="458.216,-173.532 468.786,-172.804 460.069,-166.782 458.216,-173.532"/>
</g>
<!-- proc~balback -->
<g id="proc~~halo~~CallsGraph_node62" class="node"><title>proc~balback</title>
<g id="a_proc~~halo~~CallsGraph_node62"><a xlink:href=".././proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="523,-150 469,-150 469,-126 523,-126 523,-150"/>
<text text-anchor="middle" x="496" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~halo~~CallsGraph_edge93" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M368.302,-138C393.227,-138 430.881,-138 458.667,-138"/>
<polygon fill="#000000" stroke="#000000" points="458.786,-141.5 468.786,-138 458.786,-134.5 458.786,-141.5"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~halo~~CallsGraph_node63" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~halo~~CallsGraph_node63"><a xlink:href=".././proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="523,-108 469,-108 469,-84 523,-84 523,-108"/>
<text text-anchor="middle" x="496" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~halo~~CallsGraph_edge94" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M368.302,-130.78C393.337,-123.908 431.213,-113.51 459.034,-105.873"/>
<polygon fill="#000000" stroke="#000000" points="460.069,-109.218 468.786,-103.196 458.216,-102.468 460.069,-109.218"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~halo~~CallsGraph_edge95" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M521.651,-609.983C529.592,-605.833 538.32,-600.971 546,-596 563.016,-584.986 565.132,-579.239 582,-568 586.58,-564.948 591.541,-561.898 596.451,-559.018"/>
<polygon fill="#000000" stroke="#000000" points="598.197,-562.051 605.143,-554.051 594.724,-555.974 598.197,-562.051"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~halo~~CallsGraph_node54" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~halo~~CallsGraph_node54"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="790.5,-625 725.5,-625 725.5,-601 790.5,-601 790.5,-625"/>
<text text-anchor="middle" x="758" y="-610.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~halo~~CallsGraph_edge97" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M526.572,-620.976C572.865,-619.374 662.6,-616.268 715.391,-614.44"/>
<polygon fill="#000000" stroke="#000000" points="715.56,-617.937 725.433,-614.093 715.318,-610.941 715.56,-617.937"/>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~halo~~CallsGraph_edge96" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M509.542,-609.981C520.578,-598.768 536.35,-581.092 546,-563 572.606,-513.119 556.166,-491.286 582,-441 589.284,-426.822 600.155,-412.679 609.5,-401.796"/>
<polygon fill="#000000" stroke="#000000" points="612.252,-403.968 616.265,-394.162 607.013,-399.325 612.252,-403.968"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_edge98" class="edge"><title>proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M674.775,-953.282C683.691,-955.528 693.148,-957.911 702.351,-960.23"/>
<polygon fill="#000000" stroke="#000000" points="701.649,-963.663 712.201,-962.712 703.359,-956.875 701.649,-963.663"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge99" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M674.637,-932.97C709.964,-925.528 760.432,-914.239 804,-902 814.314,-899.103 825.311,-895.648 835.615,-892.245"/>
<polygon fill="#000000" stroke="#000000" points="836.869,-895.516 845.238,-889.019 834.644,-888.88 836.869,-895.516"/>
</g>
<!-- dgetrs -->
<g id="proc~~halo~~CallsGraph_node55" class="node"><title>dgetrs</title>
<polygon fill="#777777" stroke="#777777" points="523,-318 469,-318 469,-294 523,-294 523,-318"/>
<text text-anchor="middle" x="496" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrs</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrs -->
<g id="proc~~halo~~CallsGraph_edge101" class="edge"><title>proc~linsolve&#45;&gt;dgetrs</title>
<path fill="none" stroke="#000000" d="M368.302,-283.641C393.227,-288.04 430.881,-294.685 458.667,-299.588"/>
<polygon fill="#000000" stroke="#000000" points="458.33,-303.083 468.786,-301.374 459.546,-296.189 458.33,-303.083"/>
</g>
<!-- proc~matinv -->
<g id="proc~~halo~~CallsGraph_node60" class="node"><title>proc~matinv</title>
<g id="a_proc~~halo~~CallsGraph_node60"><a xlink:href=".././proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="523,-276 469,-276 469,-252 523,-252 523,-276"/>
<text text-anchor="middle" x="496" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~linsolve&#45;&gt;proc~matinv -->
<g id="proc~~halo~~CallsGraph_edge102" class="edge"><title>proc~linsolve&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M368.302,-276.421C393.227,-273.978 430.881,-270.286 458.667,-267.562"/>
<polygon fill="#000000" stroke="#000000" points="459.175,-271.029 468.786,-266.57 458.492,-264.063 459.175,-271.029"/>
</g>
<!-- dgetrf -->
<g id="proc~~halo~~CallsGraph_node66" class="node"><title>dgetrf</title>
<polygon fill="#777777" stroke="#777777" points="523,-234 469,-234 469,-210 523,-210 523,-234"/>
<text text-anchor="middle" x="496" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrf</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrf -->
<g id="proc~~halo~~CallsGraph_edge100" class="edge"><title>proc~linsolve&#45;&gt;dgetrf</title>
<path fill="none" stroke="#000000" d="M368.302,-269.201C393.447,-259.834 431.546,-245.64 459.399,-235.263"/>
<polygon fill="#000000" stroke="#000000" points="460.637,-238.537 468.786,-231.766 458.193,-231.977 460.637,-238.537"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_edge103" class="edge"><title>proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M658.552,-912.222C664.404,-914.952 670.465,-917.948 676,-921 695.192,-931.58 715.85,-945.134 731.5,-955.887"/>
<polygon fill="#000000" stroke="#000000" points="729.877,-959.021 740.087,-961.851 733.87,-953.271 729.877,-959.021"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge104" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M674.516,-895.888C718.251,-891.848 784.821,-885.699 830.031,-881.523"/>
<polygon fill="#000000" stroke="#000000" points="830.55,-884.99 840.186,-880.585 829.906,-878.02 830.55,-884.99"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~halo~~CallsGraph_node64" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~halo~~CallsGraph_node64"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="660,-672 598,-672 598,-648 660,-648 660,-672"/>
<text text-anchor="middle" x="629" y="-657.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~halo~~CallsGraph_edge105" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M531.077,-662.959C548.314,-662.433 569.356,-661.791 587.425,-661.239"/>
<polygon fill="#000000" stroke="#000000" points="587.78,-664.73 597.668,-660.926 587.566,-657.733 587.78,-664.73"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~halo~~CallsGraph_edge110" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M370.019,-549.237C390.821,-554.222 419.973,-560.399 446,-563 490.224,-567.42 501.904,-568.557 546,-563 558.885,-561.376 572.646,-558.371 585.143,-555.131"/>
<polygon fill="#000000" stroke="#000000" points="586.114,-558.495 594.853,-552.505 584.286,-551.738 586.114,-558.495"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~halo~~CallsGraph_edge109" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M370.019,-534.763C390.821,-529.778 419.973,-523.601 446,-521 541.037,-511.501 653.214,-517.038 713.476,-521.368"/>
<polygon fill="#000000" stroke="#000000" points="713.523,-524.881 723.754,-522.131 714.041,-517.9 713.523,-524.881"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~halo~~CallsGraph_edge108" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M370.278,-547.747C382.961,-551.061 397.782,-555.992 410,-563 428.828,-573.799 428.271,-583.479 446,-596 450.523,-599.194 455.486,-602.265 460.464,-605.108"/>
<polygon fill="#000000" stroke="#000000" points="458.892,-608.237 469.347,-609.953 462.244,-602.092 458.892,-608.237"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~halo~~CallsGraph_edge106" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M370.114,-545.24C383.514,-548.041 398.982,-553.264 410,-563 439.216,-588.819 418.184,-615.679 446,-643 447.849,-644.816 449.879,-646.486 452.03,-648.02"/>
<polygon fill="#000000" stroke="#000000" points="450.414,-651.132 460.787,-653.286 454.021,-645.133 450.414,-651.132"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~halo~~CallsGraph_node65" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~halo~~CallsGraph_node65"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="546,-554 446,-554 446,-530 546,-530 546,-554"/>
<text text-anchor="middle" x="496" y="-539.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~halo~~CallsGraph_edge107" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M370.063,-542C388.391,-542 413.022,-542 435.569,-542"/>
<polygon fill="#000000" stroke="#000000" points="435.751,-545.5 445.751,-542 435.751,-538.5 435.751,-545.5"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_edge111" class="edge"><title>proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M659.84,-1051.84C665.358,-1049.19 670.964,-1046.21 676,-1043 698.692,-1028.55 721.776,-1008.22 737.465,-993.365"/>
<polygon fill="#000000" stroke="#000000" points="740.175,-995.614 744.954,-986.159 735.321,-990.571 740.175,-995.614"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge112" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M674.785,-1068.06C712.806,-1069.13 766.941,-1064.78 804,-1037 849.409,-1002.96 868.354,-934.576 875.37,-899.251"/>
<polygon fill="#000000" stroke="#000000" points="878.884,-899.497 877.248,-889.029 871.999,-898.232 878.884,-899.497"/>
</g>
<!-- proc~bb_cx_rates&#45;&gt;interface~interpol_coeff -->
<g id="proc~~halo~~CallsGraph_edge113" class="edge"><title>proc~bb_cx_rates&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M376.783,-378.486C427.655,-379.198 522.531,-380.525 580.008,-381.329"/>
<polygon fill="#000000" stroke="#000000" points="580.238,-384.832 590.286,-381.473 580.336,-377.833 580.238,-384.832"/>
</g>
<!-- proc~rswap -->
<g id="proc~~halo~~CallsGraph_node72" class="node"><title>proc~rswap</title>
<g id="a_proc~~halo~~CallsGraph_node72"><a xlink:href=".././proc/rswap.html" xlink:title="RSWAP">
<polygon fill="#d9534f" stroke="#d9534f" points="656,-66 602,-66 602,-42 656,-42 656,-66"/>
<text text-anchor="middle" x="629" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RSWAP</text>
</a>
</g>
</g>
<!-- proc~elmhes&#45;&gt;proc~rswap -->
<g id="proc~~halo~~CallsGraph_edge114" class="edge"><title>proc~elmhes&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M523.195,-20.3984C543.008,-26.7508 570.436,-35.5444 592.263,-42.5424"/>
<polygon fill="#000000" stroke="#000000" points="591.259,-45.896 601.85,-45.6162 593.396,-39.2302 591.259,-45.896"/>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~halo~~CallsGraph_edge115" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M516.896,-474.15C538.953,-487.62 574.706,-509.454 599.679,-524.704"/>
<polygon fill="#000000" stroke="#000000" points="597.987,-527.773 608.346,-529.998 601.636,-521.799 597.987,-527.773"/>
</g>
<!-- proc~uvw_to_cyl -->
<g id="proc~~halo~~CallsGraph_node73" class="node"><title>proc~uvw_to_cyl</title>
<g id="a_proc~~halo~~CallsGraph_node73"><a xlink:href=".././proc/uvw_to_cyl.html" xlink:title="uvw_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="661.5,-474 596.5,-474 596.5,-450 661.5,-450 661.5,-474"/>
<text text-anchor="middle" x="629" y="-459.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_cyl</text>
</a>
</g>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl -->
<g id="proc~~halo~~CallsGraph_edge116" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl</title>
<path fill="none" stroke="#000000" d="M527.054,-462C544.598,-462 566.998,-462 586.238,-462"/>
<polygon fill="#000000" stroke="#000000" points="586.259,-465.5 596.259,-462 586.258,-458.5 586.259,-465.5"/>
</g>
<!-- proc~balance&#45;&gt;proc~rswap -->
<g id="proc~~halo~~CallsGraph_edge117" class="edge"><title>proc~balance&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M523.195,-54C542.83,-54 569.943,-54 591.672,-54"/>
<polygon fill="#000000" stroke="#000000" points="591.85,-57.5001 601.85,-54 591.85,-50.5001 591.85,-57.5001"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~halo~~CallsGraph_node70" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~halo~~CallsGraph_node70"><a xlink:href=".././proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="656,-192 602,-192 602,-168 656,-168 656,-192"/>
<text text-anchor="middle" x="629" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~halo~~CallsGraph_edge118" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M523.195,-180C542.83,-180 569.943,-180 591.672,-180"/>
<polygon fill="#000000" stroke="#000000" points="591.85,-183.5 601.85,-180 591.85,-176.5 591.85,-183.5"/>
</g>
<!-- proc~lubksb -->
<g id="proc~~halo~~CallsGraph_node69" class="node"><title>proc~lubksb</title>
<g id="a_proc~~halo~~CallsGraph_node69"><a xlink:href=".././proc/lubksb.html" xlink:title="lubksb">
<polygon fill="#d9534f" stroke="#d9534f" points="656,-307 602,-307 602,-283 656,-283 656,-307"/>
<text text-anchor="middle" x="629" y="-292.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lubksb</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~lubksb -->
<g id="proc~~halo~~CallsGraph_edge120" class="edge"><title>proc~matinv&#45;&gt;proc~lubksb</title>
<path fill="none" stroke="#000000" d="M523.195,-270.199C542.919,-274.866 570.189,-281.32 591.968,-286.473"/>
<polygon fill="#000000" stroke="#000000" points="591.313,-289.915 601.85,-288.812 592.925,-283.103 591.313,-289.915"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~halo~~CallsGraph_node71" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~halo~~CallsGraph_node71"><a xlink:href=".././proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="656,-265 602,-265 602,-241 656,-241 656,-265"/>
<text text-anchor="middle" x="629" y="-250.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~halo~~CallsGraph_edge119" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M523.195,-261.8C542.83,-260.152 569.943,-257.875 591.672,-256.05"/>
<polygon fill="#000000" stroke="#000000" points="592.178,-259.52 601.85,-255.196 591.593,-252.545 592.178,-259.52"/>
</g>
<!-- proc~balback&#45;&gt;proc~rswap -->
<g id="proc~~halo~~CallsGraph_edge121" class="edge"><title>proc~balback&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M523.024,-128.273C530.623,-125.057 538.813,-121.211 546,-117 568.028,-104.093 590.887,-86.085 606.856,-72.6259"/>
<polygon fill="#000000" stroke="#000000" points="609.215,-75.214 614.538,-66.0534 604.664,-69.8951 609.215,-75.214"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~halo~~CallsGraph_edge123" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M656.089,-647.737C662.953,-643.867 670.085,-639.22 676,-634 691.643,-620.194 724.374,-573.376 743.087,-545.793"/>
<polygon fill="#000000" stroke="#000000" points="746.158,-547.499 748.851,-537.252 740.356,-543.583 746.158,-547.499"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~halo~~CallsGraph_edge122" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M660.097,-648.862C676.76,-642.695 697.714,-634.941 715.87,-628.221"/>
<polygon fill="#000000" stroke="#000000" points="717.183,-631.468 725.347,-624.714 714.753,-624.903 717.183,-631.468"/>
</g>
<!-- proc~comdiv -->
<g id="proc~~halo~~CallsGraph_node74" class="node"><title>proc~comdiv</title>
<g id="a_proc~~halo~~CallsGraph_node74"><a xlink:href=".././proc/comdiv.html" xlink:title="Comdiv">
<polygon fill="#d9534f" stroke="#d9534f" points="785,-192 731,-192 731,-168 785,-168 785,-192"/>
<text text-anchor="middle" x="758" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Comdiv</text>
</a>
</g>
</g>
<!-- proc~hqrvec&#45;&gt;proc~comdiv -->
<g id="proc~~halo~~CallsGraph_edge124" class="edge"><title>proc~hqrvec&#45;&gt;proc~comdiv</title>
<path fill="none" stroke="#000000" d="M656.007,-180C674.631,-180 699.959,-180 720.591,-180"/>
<polygon fill="#000000" stroke="#000000" points="720.592,-183.5 730.592,-180 720.591,-176.5 720.592,-183.5"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~halo~~CallsGraph_node75" class="node"><title>proc~outerprod</title>
<g id="a_proc~~halo~~CallsGraph_node75"><a xlink:href=".././proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="787.5,-286 728.5,-286 728.5,-262 787.5,-262 787.5,-286"/>
<text text-anchor="middle" x="758" y="-271.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~halo~~CallsGraph_edge126" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M656.007,-257.3C673.928,-260.264 698.057,-264.253 718.235,-267.59"/>
<polygon fill="#000000" stroke="#000000" points="717.937,-271.088 728.374,-269.267 719.079,-264.182 717.937,-271.088"/>
</g>
<!-- proc~swap -->
<g id="proc~~halo~~CallsGraph_node76" class="node"><title>proc~swap</title>
<g id="a_proc~~halo~~CallsGraph_node76"><a xlink:href=".././proc/swap.html" xlink:title="swap">
<polygon fill="#d9534f" stroke="#d9534f" points="785,-244 731,-244 731,-220 785,-220 785,-244"/>
<text text-anchor="middle" x="758" y="-229.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swap</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~swap -->
<g id="proc~~halo~~CallsGraph_edge125" class="edge"><title>proc~ludcmp&#45;&gt;proc~swap</title>
<path fill="none" stroke="#000000" d="M656.007,-248.7C674.631,-245.62 699.959,-241.432 720.591,-238.02"/>
<polygon fill="#000000" stroke="#000000" points="721.297,-241.451 730.592,-236.367 720.154,-234.545 721.297,-241.451"/>
</g>
</g>
</svg>
</div><script>var panprochaloCallsGraph = svgPanZoom('#prochaloCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~halo~~CalledByGraph Pages: 1 -->
<svg id="prochaloCalledByGraph" width="152pt" height="32pt"
 viewBox="0.00 0.00 152.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~halo~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~halo~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 148,-28 148,4 -4,4"/>
<!-- proc~halo -->
<g id="proc~~halo~~CalledByGraph_node1" class="node"><title>proc~halo</title>
<polygon fill="none" stroke="black" points="144,-24 90,-24 90,-0 144,-0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">halo</text>
</g>
<!-- program~fidasim -->
<g id="proc~~halo~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~halo~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~halo -->
<g id="proc~~halo~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~halo</title>
<path fill="none" stroke="#000000" d="M54.4029,-12C62.3932,-12 71.3106,-12 79.8241,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.919,-15.5001 89.919,-12 79.919,-8.5001 79.919,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/halo.html#src">halo</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">halo</span><span class="w"></span>
<span class="w">    </span><span class="c">!+ Calculates halo neutral density and spectra</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ic</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">ncell</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ihalo</span><span class="w"> </span><span class="c">!! counter</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ri</span><span class="w">    </span><span class="c">!! start position</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">vihalo</span><span class="c">!! velocity bulk plasma ion</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ind</span><span class="p">,</span><span class="w"> </span><span class="n">tind</span><span class="w">    </span><span class="c">!! actual cell</span>
<span class="w">    </span><span class="c">!! Determination of the CX probability</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">plasma</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">denn</span><span class="w">    </span><span class="c">!!  neutral dens (n=1-4)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rates</span><span class="w">    </span><span class="c">!! CX rates</span>
<span class="w">    </span><span class="c">!! Collisiional radiative model along track</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">states</span><span class="w">  </span><span class="c">! Density of n-states</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ntrack</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">ParticleTrack</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ntrack</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tracks</span><span class="w">  </span><span class="c">!! Particle Tracks</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="k">is</span>
<span class="k">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tot_denn</span><span class="p">,</span><span class="w"> </span><span class="n">photons</span><span class="w">  </span><span class="c">!! photon flux</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cell_ind</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nx</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ny</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nz</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">papprox</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nx</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ny</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nz</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nlaunch</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">local_iter_dens</span><span class="w"></span>

<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">NeutralPopulation</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cur_pop</span><span class="p">,</span><span class="w"> </span><span class="n">prev_pop</span><span class="w"></span>
<span class="w">    </span><span class="c">!! Halo iteration</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">hh</span><span class="p">,</span><span class="w"> </span><span class="n">n_halo</span><span class="w"> </span><span class="c">!! counters</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dcx_dens</span><span class="p">,</span><span class="w"> </span><span class="n">halo_iter_dens</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">seed_dcx</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">prev_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="c">! previous iteration</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cur_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="c">! current iteration</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fi_correction</span><span class="w"></span>

<span class="w">    </span><span class="c">!! Initialize Neutral Population</span>
<span class="w">    </span><span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">halo</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">dcx_dens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">dcx</span><span class="p">%</span><span class="n">dens</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">prev_type</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dcx_dens</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">dcx_dens</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;HALO: Density of DCX-neutrals is zero&#39;</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">        stop</span>
<span class="k">    endif</span>
<span class="k">    </span><span class="n">n_halo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inputs</span><span class="p">%</span><span class="n">n_halo</span><span class="w"></span>

<span class="w">    </span><span class="c">!! Allocate previous neutral populations</span>
<span class="w">    </span><span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">prev_pop</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">prev_pop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neut</span><span class="p">%</span><span class="n">dcx</span><span class="w"></span>

<span class="w">    </span><span class="n">seed_dcx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"></span>
<span class="w">    </span><span class="n">iterations</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">hh</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">200</span><span class="w"></span>
<span class="w">        </span><span class="c">!! Allocate/Reallocate current population</span>
<span class="w">        </span><span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">cur_pop</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">cur_type</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.d0</span><span class="w"></span>

<span class="w">        </span><span class="c">!! Calculate how many mc markers to launch in each cell</span>
<span class="w">        </span><span class="n">papprox</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.d0</span><span class="w"></span>
<span class="w">        </span><span class="n">cell_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">        </span><span class="n">ncell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">        </span><span class="k">do </span><span class="n">ic</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">ind2sub</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">ic</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">ind</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">plasma</span><span class="p">%</span><span class="n">in_plasma</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="k">            </span><span class="n">tot_denn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">prev_pop</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="n">papprox</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="n">tot_denn</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">plasma</span><span class="p">%</span><span class="n">deni</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">papprox</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                </span><span class="n">ncell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ncell</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                </span><span class="n">cell_ind</span><span class="p">(</span><span class="n">ncell</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ic</span><span class="w"></span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">        enddo</span>
<span class="k">        call </span><span class="n">get_nlaunch</span><span class="p">(</span><span class="n">n_halo</span><span class="p">,</span><span class="w"> </span><span class="n">papprox</span><span class="p">,</span><span class="w"> </span><span class="n">nlaunch</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i10,&quot; --- Seed/DCX: &quot;,f5.3)&#39;</span><span class="p">)</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">nlaunch</span><span class="p">),</span><span class="w"> </span><span class="n">seed_dcx</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span><span class="w"></span>

<span class="w">        </span><span class="c">!$OMP PARALLEL DO schedule(dynamic,1) private(i,j,k,ic,ihalo,ii,jj,kk,it,is,ind,vihalo, &amp;</span>
<span class="w">        </span><span class="c">!$OMP&amp; ri,tracks,ntrack,rates,denn,states,photons,plasma,tind,fi_correction)</span>
<span class="w">        </span><span class="n">loop_over_cells</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">ic</span><span class="o">=</span><span class="n">istart</span><span class="p">,</span><span class="n">ncell</span><span class="p">,</span><span class="n">istep</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">ind2sub</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">cell_ind</span><span class="p">(</span><span class="n">ic</span><span class="p">),</span><span class="n">ind</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">loop_over_species</span><span class="p">:</span><span class="w"> </span><span class="k">do is</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n_thermal</span><span class="w"> </span><span class="c">!This loop has to come first</span>
<span class="w">                </span><span class="c">!! Loop over the markers</span>
<span class="w">                </span><span class="n">loop_over_halos</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">ihalo</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="c">!! Calculate ri,vhalo and track</span>
<span class="w">                    </span><span class="k">call </span><span class="n">mc_beam_grid</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="w"> </span><span class="n">ri</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">mc_halo</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="w"> </span><span class="n">thermal_mass</span><span class="p">(</span><span class="k">is</span><span class="p">),</span><span class="w"> </span><span class="n">vihalo</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">track</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">vihalo</span><span class="p">,</span><span class="n">tracks</span><span class="p">,</span><span class="n">ntrack</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="n">ntrack</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">cycle </span><span class="n">loop_over_halos</span><span class="w"></span>

<span class="w">                    </span><span class="c">!! Get plasma parameters at particle location</span>
<span class="w">                    </span><span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="c">!! Calculate CX probability</span>
<span class="w">                    </span><span class="n">tind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tracks</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">ind</span><span class="w"></span>
<span class="w">                    </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tind</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="n">jj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tind</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="n">kk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">neutral_cx_rate</span><span class="p">(</span><span class="n">prev_pop</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">),</span><span class="w"> </span><span class="n">prev_pop</span><span class="p">%</span><span class="n">res</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">),</span><span class="w"> </span><span class="n">vihalo</span><span class="p">,</span><span class="w"> </span><span class="n">rates</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span><span class="k">cycle </span><span class="n">loop_over_halos</span><span class="w"></span>

<span class="w">                    </span><span class="c">!! Get plasma parameters at mean point in cell</span>
<span class="w">                    </span><span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="o">=</span><span class="n">tracks</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">pos</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="c">!! Weight CX rates by ion source density</span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="n">beam_mass</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">thermal_mass</span><span class="p">(</span><span class="k">is</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        </span><span class="n">states</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rates</span><span class="o">*</span><span class="p">(</span><span class="n">plasma</span><span class="p">%</span><span class="n">deni</span><span class="p">(</span><span class="k">is</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">plasma</span><span class="p">%</span><span class="n">denf</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">loop_over_halos</span><span class="w"></span>
<span class="w">                        </span><span class="n">fi_correction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="n">plasma</span><span class="p">%</span><span class="n">deni</span><span class="p">(</span><span class="k">is</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">plasma</span><span class="p">%</span><span class="n">deni</span><span class="p">(</span><span class="k">is</span><span class="p">)</span><span class="o">+</span><span class="n">plasma</span><span class="p">%</span><span class="n">denf</span><span class="p">),</span><span class="mf">0.d0</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">else</span>
<span class="k">                        </span><span class="n">states</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rates</span><span class="o">*</span><span class="n">plasma</span><span class="p">%</span><span class="n">deni</span><span class="p">(</span><span class="k">is</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">loop_over_halos</span><span class="w"></span>
<span class="w">                        </span><span class="n">fi_correction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.d0</span><span class="w"></span>
<span class="w">                    </span><span class="k">endif</span>

<span class="k">                    </span><span class="n">loop_along_track</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">it</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ntrack</span><span class="w"></span>
<span class="w">                        </span><span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">tracks</span><span class="p">(</span><span class="n">it</span><span class="p">)%</span><span class="n">pos</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">plasma</span><span class="p">%</span><span class="n">in_plasma</span><span class="p">)</span><span class="w"> </span><span class="k">exit </span><span class="n">loop_along_track</span><span class="w"></span>
<span class="w">                        </span><span class="k">call </span><span class="n">colrad</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">thermal_mass</span><span class="p">(</span><span class="k">is</span><span class="p">),</span><span class="n">vihalo</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">it</span><span class="p">)%</span><span class="nb">time</span><span class="p">,</span><span class="n">states</span><span class="p">,</span><span class="n">denn</span><span class="p">,</span><span class="n">photons</span><span class="p">)</span><span class="w"></span>

<span class="w">                        </span><span class="c">!! Store Neutrals</span>
<span class="w">                        </span><span class="k">call </span><span class="n">update_neutrals</span><span class="p">(</span><span class="n">cur_pop</span><span class="p">,</span><span class="w"> </span><span class="n">tracks</span><span class="p">(</span><span class="n">it</span><span class="p">)%</span><span class="n">ind</span><span class="p">,</span><span class="w"> </span><span class="n">vihalo</span><span class="p">,</span><span class="w"> </span><span class="n">denn</span><span class="o">/</span><span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="w"></span>

<span class="w">                        </span><span class="n">photons</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fi_correction</span><span class="o">*</span><span class="n">photons</span><span class="w"> </span><span class="c">!! Correct for including fast-ions in states</span>

<span class="w">                        </span><span class="k">if</span><span class="p">((</span><span class="n">photons</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_halo</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                            call </span><span class="n">store_photons</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="n">it</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span><span class="n">vihalo</span><span class="p">,</span><span class="n">thermal_lambda0</span><span class="p">(</span><span class="k">is</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                                               </span><span class="n">photons</span><span class="o">/</span><span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">spec</span><span class="p">%</span><span class="n">halo</span><span class="p">(:,:,:,</span><span class="k">is</span><span class="p">),</span><span class="n">spec</span><span class="p">%</span><span class="n">halostokes</span><span class="p">(:,:,:,:,</span><span class="k">is</span><span class="p">))</span><span class="w"></span>
<span class="w">                        </span><span class="k">endif</span>

<span class="k">                        if</span><span class="p">((</span><span class="n">photons</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_res</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                            call </span><span class="n">store_photon_birth</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="n">photons</span><span class="o">/</span><span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="w"> </span><span class="n">spatres</span><span class="p">%</span><span class="n">halo</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">endif</span>
<span class="k">                    enddo </span><span class="n">loop_along_track</span><span class="w"></span>
<span class="w">                </span><span class="k">enddo </span><span class="n">loop_over_halos</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo </span><span class="n">loop_over_species</span><span class="w"></span>
<span class="w">        </span><span class="k">enddo </span><span class="n">loop_over_cells</span><span class="w"></span>
<span class="w">        </span><span class="c">!$OMP END PARALLEL DO</span>

<span class="cp">#ifdef _MPI</span>
<span class="w">        </span><span class="c">!! Combine densities</span>
<span class="w">        </span><span class="k">call </span><span class="n">parallel_merge_populations</span><span class="p">(</span><span class="n">cur_pop</span><span class="p">)</span><span class="w"></span>
<span class="cp">#endif</span>
<span class="w">        </span><span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">cur_type</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">cur_pop</span><span class="p">%</span><span class="n">dens</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">cur_type</span><span class="p">)</span><span class="o">/</span><span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">prev_type</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">1.0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;HALO: Halo generation density exceeded seed density. This shouldn&#39;t happen.&quot;</span><span class="w"></span>
<span class="w">            </span><span class="k">exit </span><span class="n">iterations</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span><span class="w"></span>

<span class="w">        </span><span class="c">!! Set current generation to previous generation</span>
<span class="w">        </span><span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">prev_type</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">cur_type</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">prev_pop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cur_pop</span><span class="w"></span>

<span class="w">        </span><span class="c">!! merge current population with halo population</span>
<span class="w">        </span><span class="k">call </span><span class="n">merge_neutral_populations</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">halo</span><span class="p">,</span><span class="w"> </span><span class="n">cur_pop</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">seed_dcx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">cur_type</span><span class="p">)</span><span class="o">/</span><span class="n">dcx_dens</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">seed_dcx</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;NAN (Halo generation)/DCX. Exiting...&quot;</span><span class="w"></span>
<span class="w">            </span><span class="k">stop</span>
<span class="k">        endif</span>
<span class="k">        </span><span class="n">n_halo</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_halo</span><span class="o">*</span><span class="n">seed_dcx</span><span class="p">,</span><span class="n">Int64</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">seed_dcx</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mf">0.01</span><span class="p">)</span><span class="w"> </span><span class="k">exit </span><span class="n">iterations</span><span class="w"></span>
<span class="w">    </span><span class="k">enddo </span><span class="n">iterations</span><span class="w"></span>

<span class="w">    </span><span class="k">call </span><span class="n">free_neutral_population</span><span class="p">(</span><span class="n">cur_pop</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">free_neutral_population</span><span class="p">(</span><span class="n">prev_pop</span><span class="p">)</span><span class="w"></span>

<span class="cp">#ifdef _MPI</span>
<span class="w">    </span><span class="c">!! Combine Spectra</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_halo</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">halo</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>
<span class="k">    if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_res</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        do </span><span class="n">jj</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">spec_chords</span><span class="p">%</span><span class="n">nchan</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">parallel_merge_reservoirs</span><span class="p">(</span><span class="n">spatres</span><span class="p">%</span><span class="n">halo</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">enddo</span>
<span class="k">    endif</span><span class="w"></span>
<span class="cp">#endif</span>

<span class="k">end subroutine </span><span class="n">halo</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>