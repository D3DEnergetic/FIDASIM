<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>halo &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
               
        
        
            </ul>
        
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>



          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>halo
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.9% of total for procedures.">123 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
    
     <li><a href='../module/libfida.html'>libfida</a></li>
    
  
     <li class="active">halo</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/halo.html#src">halo</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine halo()
    
    
   
</h2>
    
  


    
    <p>Calculates halo neutral density and spectra</p>
    

    <h3>Arguments</h3>
    
    <em>None</em>
    <br>
    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~halo~~CallsGraph Pages: 1 -->
<svg id="prochaloCallsGraph" width="641pt" height="1010pt"
 viewBox="0.00 0.00 641.00 1009.99" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~halo~~CallsGraph" class="graph" transform="scale(0.690733 0.690733) rotate(0) translate(4 1458.2)">
<title>proc~~halo~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1458.2 924,-1458.2 924,4 -4,4"/>
<!-- proc~halo -->
<g id="proc~~halo~~CallsGraph_node1" class="node"><title>proc~halo</title>
<polygon fill="none" stroke="black" points="54,-331 0,-331 0,-307 54,-307 54,-331"/>
<text text-anchor="middle" x="27" y="-316.6" font-family="Helvetica,sans-Serif" font-size="10.50">halo</text>
</g>
<!-- proc~track -->
<g id="proc~~halo~~CallsGraph_node2" class="node"><title>proc~track</title>
<g id="a_proc~~halo~~CallsGraph_node2"><a xlink:href=".././proc/track.html" xlink:title="track">
<polygon fill="#d9534f" stroke="#d9534f" points="190,-1177 136,-1177 136,-1153 190,-1153 190,-1177"/>
<text text-anchor="middle" x="163" y="-1162.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~track -->
<g id="proc~~halo~~CallsGraph_edge1" class="edge"><title>proc~halo&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M28.5389,-331.112C32.2058,-411.674 54.4183,-870.944 90,-1006 103.664,-1057.86 132.85,-1114.01 149.564,-1143.73"/>
<polygon fill="#000000" stroke="#000000" points="146.716,-1145.81 154.713,-1152.76 152.795,-1142.34 146.716,-1145.81"/>
</g>
<!-- proc~store_photons -->
<g id="proc~~halo~~CallsGraph_node3" class="node"><title>proc~store_photons</title>
<g id="a_proc~~halo~~CallsGraph_node3"><a xlink:href=".././proc/store_photons.html" xlink:title="store_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="203.5,-1317 122.5,-1317 122.5,-1293 203.5,-1293 203.5,-1317"/>
<text text-anchor="middle" x="163" y="-1302.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_photons</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~store_photons -->
<g id="proc~~halo~~CallsGraph_edge2" class="edge"><title>proc~halo&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M28.091,-331.234C28.8962,-423.918 36.1169,-1016.48 90,-1186 102.011,-1223.79 128.236,-1262.06 145.499,-1284.65"/>
<polygon fill="#000000" stroke="#000000" points="142.933,-1287.05 151.846,-1292.77 148.45,-1282.74 142.933,-1287.05"/>
</g>
<!-- proc~mc_beam_grid -->
<g id="proc~~halo~~CallsGraph_node4" class="node"><title>proc~mc_beam_grid</title>
<g id="a_proc~~halo~~CallsGraph_node4"><a xlink:href=".././proc/mc_beam_grid.html" xlink:title="mc_beam_grid">
<polygon fill="#d9534f" stroke="#d9534f" points="800,-188 716,-188 716,-164 800,-164 800,-188"/>
<text text-anchor="middle" x="758" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_beam_grid</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~mc_beam_grid -->
<g id="proc~~halo~~CallsGraph_edge3" class="edge"><title>proc~halo&#45;&gt;proc~mc_beam_grid</title>
<path fill="none" stroke="#000000" d="M29.9912,-306.936C34.9199,-281.413 50.2949,-222.229 90,-197 141.388,-164.348 558.095,-171.159 705.537,-174.641"/>
<polygon fill="#000000" stroke="#000000" points="705.597,-178.143 715.679,-174.885 705.766,-171.145 705.597,-178.143"/>
</g>
<!-- proc~colrad -->
<g id="proc~~halo~~CallsGraph_node5" class="node"><title>proc~colrad</title>
<g id="a_proc~~halo~~CallsGraph_node5"><a xlink:href=".././proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="190,-886 136,-886 136,-862 190,-862 190,-886"/>
<text text-anchor="middle" x="163" y="-871.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~colrad -->
<g id="proc~~halo~~CallsGraph_edge4" class="edge"><title>proc~halo&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M28.09,-331.015C28.8122,-382.665 35.1601,-590.393 90,-749 103.715,-788.667 130.33,-829.969 147.077,-853.765"/>
<polygon fill="#000000" stroke="#000000" points="144.297,-855.895 152.965,-861.988 149.989,-851.82 144.297,-855.895"/>
</g>
<!-- proc~ind2sub -->
<g id="proc~~halo~~CallsGraph_node6" class="node"><title>proc~ind2sub</title>
<g id="a_proc~~halo~~CallsGraph_node6"><a xlink:href=".././proc/ind2sub.html" xlink:title="ind2sub">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-270 314,-270 314,-246 368,-246 368,-270"/>
<text text-anchor="middle" x="341" y="-255.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ind2sub</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~ind2sub -->
<g id="proc~~halo~~CallsGraph_edge5" class="edge"><title>proc~halo&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M41.6156,-306.664C53.4653,-296.739 71.5864,-283.423 90,-277 162.559,-251.689 253.938,-252.252 303.671,-255.04"/>
<polygon fill="#000000" stroke="#000000" points="303.723,-258.55 313.922,-255.68 304.159,-251.564 303.723,-258.55"/>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~halo~~CallsGraph_node7" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~halo~~CallsGraph_node7"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="532.5,-548 459.5,-548 459.5,-524 532.5,-524 532.5,-548"/>
<text text-anchor="middle" x="496" y="-533.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;interface~parallel_sum -->
<g id="proc~~halo~~CallsGraph_edge6" class="edge"><title>proc~halo&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M44.8139,-331.041C57.1233,-339.695 74.3413,-351.468 90,-361 168.655,-408.878 187.673,-423.015 272,-460 331.848,-486.249 403.857,-509.337 449.534,-522.985"/>
<polygon fill="#000000" stroke="#000000" points="448.565,-526.349 459.148,-525.834 450.554,-519.637 448.565,-526.349"/>
</g>
<!-- proc~get_nlaunch -->
<g id="proc~~halo~~CallsGraph_node8" class="node"><title>proc~get_nlaunch</title>
<g id="a_proc~~halo~~CallsGraph_node8"><a xlink:href=".././proc/get_nlaunch.html" xlink:title="get_nlaunch">
<polygon fill="#d9534f" stroke="#d9534f" points="198.5,-150 127.5,-150 127.5,-126 198.5,-126 198.5,-150"/>
<text text-anchor="middle" x="163" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_nlaunch</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~get_nlaunch -->
<g id="proc~~halo~~CallsGraph_edge7" class="edge"><title>proc~halo&#45;&gt;proc~get_nlaunch</title>
<path fill="none" stroke="#000000" d="M29.4932,-306.651C33.6389,-277.672 47.9054,-204.689 90,-164 97.6759,-156.58 107.624,-151.257 117.662,-147.445"/>
<polygon fill="#000000" stroke="#000000" points="118.873,-150.731 127.243,-144.234 116.649,-144.094 118.873,-150.731"/>
</g>
<!-- proc~mc_halo -->
<g id="proc~~halo~~CallsGraph_node9" class="node"><title>proc~mc_halo</title>
<g id="a_proc~~halo~~CallsGraph_node9"><a xlink:href=".././proc/mc_halo.html" xlink:title="mc_halo">
<polygon fill="#d9534f" stroke="#d9534f" points="190,-108 136,-108 136,-84 190,-84 190,-108"/>
<text text-anchor="middle" x="163" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_halo</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~mc_halo -->
<g id="proc~~halo~~CallsGraph_edge8" class="edge"><title>proc~halo&#45;&gt;proc~mc_halo</title>
<path fill="none" stroke="#000000" d="M27.9817,-306.517C28.6302,-271.404 35.4078,-170.833 90,-117 99.5836,-107.55 113.167,-102.307 125.957,-99.4154"/>
<polygon fill="#000000" stroke="#000000" points="126.757,-102.827 135.953,-97.5646 125.482,-95.9438 126.757,-102.827"/>
</g>
<!-- proc~merge_neutral_populations -->
<g id="proc~~halo~~CallsGraph_node10" class="node"><title>proc~merge_neutral_populations</title>
<g id="a_proc~~halo~~CallsGraph_node10"><a xlink:href=".././proc/merge_neutral_populations.html" xlink:title="merge_neutral_populations">
<polygon fill="#d9534f" stroke="#d9534f" points="234.5,-310 91.5,-310 91.5,-286 234.5,-286 234.5,-310"/>
<text text-anchor="middle" x="163" y="-295.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">merge_neutral_populations</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~merge_neutral_populations -->
<g id="proc~~halo~~CallsGraph_edge9" class="edge"><title>proc~halo&#45;&gt;proc~merge_neutral_populations</title>
<path fill="none" stroke="#000000" d="M54.1547,-314.901C62.2662,-313.63 71.6694,-312.156 81.4759,-310.619"/>
<polygon fill="#000000" stroke="#000000" points="82.0465,-314.073 91.384,-309.067 80.9627,-307.157 82.0465,-314.073"/>
</g>
<!-- proc~init_neutral_population -->
<g id="proc~~halo~~CallsGraph_node11" class="node"><title>proc~init_neutral_population</title>
<g id="a_proc~~halo~~CallsGraph_node11"><a xlink:href=".././proc/init_neutral_population.html" xlink:title="init_neutral_population">
<polygon fill="#d9534f" stroke="#d9534f" points="223.5,-66 102.5,-66 102.5,-42 223.5,-42 223.5,-66"/>
<text text-anchor="middle" x="163" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_neutral_population</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~init_neutral_population -->
<g id="proc~~halo~~CallsGraph_edge10" class="edge"><title>proc~halo&#45;&gt;proc~init_neutral_population</title>
<path fill="none" stroke="#000000" d="M29.5052,-306.733C35.2156,-262.113 56.9068,-109.271 90,-75 91.2437,-73.7121 92.5614,-72.5019 93.9418,-71.3649"/>
<polygon fill="#000000" stroke="#000000" points="96.1213,-74.1165 102.451,-65.6202 92.2046,-68.3148 96.1213,-74.1165"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~halo~~CallsGraph_node12" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~halo~~CallsGraph_node12"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="375,-1156 307,-1156 307,-1132 375,-1132 375,-1156"/>
<text text-anchor="middle" x="341" y="-1141.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~get_plasma -->
<g id="proc~~halo~~CallsGraph_edge11" class="edge"><title>proc~halo&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M28.2208,-331.41C29.7041,-405.55 39.7524,-790.262 90,-895 141.454,-1002.25 258.697,-1090.07 312.314,-1126.22"/>
<polygon fill="#000000" stroke="#000000" points="310.391,-1129.14 320.655,-1131.77 314.27,-1123.32 310.391,-1129.14"/>
</g>
<!-- proc~update_neutrals -->
<g id="proc~~halo~~CallsGraph_node13" class="node"><title>proc~update_neutrals</title>
<g id="a_proc~~halo~~CallsGraph_node13"><a xlink:href=".././proc/update_neutrals.html" xlink:title="update_neutrals">
<polygon fill="#d9534f" stroke="#d9534f" points="208,-230 118,-230 118,-206 208,-206 208,-230"/>
<text text-anchor="middle" x="163" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_neutrals</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~update_neutrals -->
<g id="proc~~halo~~CallsGraph_edge14" class="edge"><title>proc~halo&#45;&gt;proc~update_neutrals</title>
<path fill="none" stroke="#000000" d="M35.0828,-306.898C45.2692,-290.475 65.5469,-261.21 90,-244 95.6226,-240.043 101.913,-236.623 108.372,-233.686"/>
<polygon fill="#000000" stroke="#000000" points="110.011,-236.795 117.897,-229.72 107.32,-230.332 110.011,-236.795"/>
</g>
<!-- proc~neutral_cx_rate -->
<g id="proc~~halo~~CallsGraph_node14" class="node"><title>proc~neutral_cx_rate</title>
<g id="a_proc~~halo~~CallsGraph_node14"><a xlink:href=".././proc/neutral_cx_rate.html" xlink:title="neutral_cx_rate">
<polygon fill="#d9534f" stroke="#d9534f" points="206.5,-740 119.5,-740 119.5,-716 206.5,-716 206.5,-740"/>
<text text-anchor="middle" x="163" y="-725.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutral_cx_rate</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~neutral_cx_rate -->
<g id="proc~~halo~~CallsGraph_edge13" class="edge"><title>proc~halo&#45;&gt;proc~neutral_cx_rate</title>
<path fill="none" stroke="#000000" d="M31.6297,-331.282C40.9666,-362.76 66.7195,-448.85 90,-520 112.376,-588.387 140.788,-668.702 154.251,-706.4"/>
<polygon fill="#000000" stroke="#000000" points="150.971,-707.621 157.635,-715.858 157.562,-705.263 150.971,-707.621"/>
</g>
<!-- proc~parallel_merge_populations -->
<g id="proc~~halo~~CallsGraph_node15" class="node"><title>proc~parallel_merge_populations</title>
<g id="a_proc~~halo~~CallsGraph_node15"><a xlink:href=".././proc/parallel_merge_populations.html" xlink:title="parallel_merge_populations">
<polygon fill="#d9534f" stroke="#d9534f" points="235.5,-352 90.5,-352 90.5,-328 235.5,-328 235.5,-352"/>
<text text-anchor="middle" x="163" y="-337.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_merge_populations</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~parallel_merge_populations -->
<g id="proc~~halo~~CallsGraph_edge12" class="edge"><title>proc~halo&#45;&gt;proc~parallel_merge_populations</title>
<path fill="none" stroke="#000000" d="M54.1547,-323.099C61.9556,-324.321 70.9512,-325.731 80.3512,-327.204"/>
<polygon fill="#000000" stroke="#000000" points="79.839,-330.667 90.2604,-328.757 80.9229,-323.751 79.839,-330.667"/>
</g>
<!-- proc~track&#45;&gt;proc~get_plasma -->
<g id="proc~~halo~~CallsGraph_edge16" class="edge"><title>proc~track&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M190.349,-1161.86C218.506,-1158.5 263.586,-1153.12 296.918,-1149.14"/>
<polygon fill="#000000" stroke="#000000" points="297.339,-1152.62 306.854,-1147.95 296.509,-1145.66 297.339,-1152.62"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~halo~~CallsGraph_node23" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~halo~~CallsGraph_node23"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="526.5,-1116 465.5,-1116 465.5,-1092 526.5,-1092 526.5,-1116"/>
<text text-anchor="middle" x="496" y="-1101.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~in_plasma -->
<g id="proc~~halo~~CallsGraph_edge15" class="edge"><title>proc~track&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M189.095,-1152.87C210.577,-1143.07 242.604,-1129.82 272,-1123 334.899,-1108.41 410.105,-1104.75 455.136,-1103.99"/>
<polygon fill="#000000" stroke="#000000" points="455.409,-1107.48 465.362,-1103.85 455.317,-1100.48 455.409,-1107.48"/>
</g>
<!-- proc~get_indices -->
<g id="proc~~halo~~CallsGraph_node29" class="node"><title>proc~get_indices</title>
<g id="a_proc~~halo~~CallsGraph_node29"><a xlink:href=".././proc/get_indices.html" xlink:title="get_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="374.5,-1296 307.5,-1296 307.5,-1272 374.5,-1272 374.5,-1296"/>
<text text-anchor="middle" x="341" y="-1281.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_indices</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~get_indices -->
<g id="proc~~halo~~CallsGraph_edge18" class="edge"><title>proc~track&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M174.06,-1177.08C191.788,-1197.62 230.65,-1239.42 272,-1263 279.877,-1267.49 288.825,-1271.13 297.583,-1274.04"/>
<polygon fill="#000000" stroke="#000000" points="296.738,-1277.44 307.324,-1277.03 298.787,-1270.75 296.738,-1277.44"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~halo~~CallsGraph_node43" class="node"><title>proc~get_fields</title>
<g id="a_proc~~halo~~CallsGraph_node43"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="370,-1254 312,-1254 312,-1230 370,-1230 370,-1254"/>
<text text-anchor="middle" x="341" y="-1239.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~get_fields -->
<g id="proc~~halo~~CallsGraph_edge17" class="edge"><title>proc~track&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M190.349,-1176.53C220.198,-1189.59 269.066,-1210.97 302.795,-1225.72"/>
<polygon fill="#000000" stroke="#000000" points="301.743,-1229.08 312.308,-1229.88 304.549,-1222.67 301.743,-1229.08"/>
</g>
<!-- proc~doppler_stark -->
<g id="proc~~halo~~CallsGraph_node46" class="node"><title>proc~doppler_stark</title>
<g id="a_proc~~halo~~CallsGraph_node46"><a xlink:href=".././proc/doppler_stark.html" xlink:title="doppler_stark">
<polygon fill="#d9534f" stroke="#d9534f" points="380,-1198 302,-1198 302,-1174 380,-1174 380,-1198"/>
<text text-anchor="middle" x="341" y="-1183.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">doppler_stark</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~doppler_stark -->
<g id="proc~~halo~~CallsGraph_edge19" class="edge"><title>proc~track&#45;&gt;proc~doppler_stark</title>
<path fill="none" stroke="#000000" d="M190.349,-1168.14C217,-1171.32 258.813,-1176.31 291.474,-1180.21"/>
<polygon fill="#000000" stroke="#000000" points="291.382,-1183.72 301.726,-1181.43 292.211,-1176.77 291.382,-1183.72"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~halo~~CallsGraph_node16" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~halo~~CallsGraph_node16"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="792,-1292 724,-1292 724,-1268 792,-1268 792,-1292"/>
<text text-anchor="middle" x="758" y="-1277.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~halo~~CallsGraph_edge21" class="edge"><title>proc~store_photons&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M174.862,-1317.13C192.879,-1336.3 231.04,-1373.08 272,-1389 439.462,-1454.08 517.836,-1488.22 676,-1403 715.693,-1381.61 739.137,-1331.33 749.883,-1302.1"/>
<polygon fill="#000000" stroke="#000000" points="753.285,-1302.98 753.274,-1292.38 746.675,-1300.67 753.285,-1302.98"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_indices -->
<g id="proc~~halo~~CallsGraph_edge24" class="edge"><title>proc~store_photons&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M203.937,-1300.23C231.758,-1296.92 268.824,-1292.49 297.243,-1289.1"/>
<polygon fill="#000000" stroke="#000000" points="297.774,-1292.56 307.289,-1287.9 296.945,-1285.61 297.774,-1292.56"/>
</g>
<!-- proc~get_passive_grid_indices -->
<g id="proc~~halo~~CallsGraph_node31" class="node"><title>proc~get_passive_grid_indices</title>
<g id="a_proc~~halo~~CallsGraph_node31"><a xlink:href=".././proc/get_passive_grid_indices.html" xlink:title="get_passive_grid_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="407.5,-1338 274.5,-1338 274.5,-1314 407.5,-1314 407.5,-1338"/>
<text text-anchor="middle" x="341" y="-1323.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_passive_grid_indices</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_passive_grid_indices -->
<g id="proc~~halo~~CallsGraph_edge20" class="edge"><title>proc~store_photons&#45;&gt;proc~get_passive_grid_indices</title>
<path fill="none" stroke="#000000" d="M203.937,-1309.77C221.805,-1311.9 243.485,-1314.48 264.24,-1316.96"/>
<polygon fill="#000000" stroke="#000000" points="263.989,-1320.46 274.333,-1318.16 264.818,-1313.5 263.989,-1320.46"/>
</g>
<!-- proc~spectrum -->
<g id="proc~~halo~~CallsGraph_node36" class="node"><title>proc~spectrum</title>
<g id="a_proc~~halo~~CallsGraph_node36"><a xlink:href=".././proc/spectrum.html" xlink:title="spectrum">
<polygon fill="#d9534f" stroke="#d9534f" points="369.5,-1380 312.5,-1380 312.5,-1356 369.5,-1356 369.5,-1380"/>
<text text-anchor="middle" x="341" y="-1365.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spectrum</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~spectrum -->
<g id="proc~~halo~~CallsGraph_edge22" class="edge"><title>proc~store_photons&#45;&gt;proc~spectrum</title>
<path fill="none" stroke="#000000" d="M193.585,-1317.16C215.17,-1325.87 245.213,-1337.67 272,-1347 281.889,-1350.44 292.683,-1353.91 302.698,-1357.01"/>
<polygon fill="#000000" stroke="#000000" points="301.807,-1360.39 312.393,-1359.96 303.849,-1353.7 301.807,-1360.39"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_fields -->
<g id="proc~~halo~~CallsGraph_edge23" class="edge"><title>proc~store_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M193.585,-1292.84C215.17,-1284.13 245.213,-1272.33 272,-1263 281.714,-1259.62 292.301,-1256.21 302.166,-1253.16"/>
<polygon fill="#000000" stroke="#000000" points="303.19,-1256.51 311.732,-1250.24 301.145,-1249.81 303.19,-1256.51"/>
</g>
<!-- interface~randu -->
<g id="proc~~halo~~CallsGraph_node17" class="node"><title>interface~randu</title>
<g id="a_proc~~halo~~CallsGraph_node17"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="907,-269 853,-269 853,-245 907,-245 907,-269"/>
<text text-anchor="middle" x="880" y="-254.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~mc_beam_grid&#45;&gt;interface~randu -->
<g id="proc~~halo~~CallsGraph_edge25" class="edge"><title>proc~mc_beam_grid&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M781.262,-188.225C788.605,-192.425 796.747,-197.265 804,-202 821.745,-213.584 841.008,-227.746 855.568,-238.798"/>
<polygon fill="#000000" stroke="#000000" points="853.481,-241.608 863.55,-244.903 857.733,-236.048 853.481,-241.608"/>
</g>
<!-- proc~linsolve -->
<g id="proc~~halo~~CallsGraph_node32" class="node"><title>proc~linsolve</title>
<g id="a_proc~~halo~~CallsGraph_node32"><a xlink:href=".././proc/linsolve.html" xlink:title="linsolve">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-964 314,-964 314,-940 368,-940 368,-964"/>
<text text-anchor="middle" x="341" y="-949.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linsolve</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~linsolve -->
<g id="proc~~halo~~CallsGraph_edge26" class="edge"><title>proc~colrad&#45;&gt;proc~linsolve</title>
<path fill="none" stroke="#000000" d="M190.349,-885.677C220.635,-899.1 270.499,-921.198 304.264,-936.163"/>
<polygon fill="#000000" stroke="#000000" points="303.198,-939.518 313.759,-940.37 306.034,-933.119 303.198,-939.518"/>
</g>
<!-- proc~eigen -->
<g id="proc~~halo~~CallsGraph_node39" class="node"><title>proc~eigen</title>
<g id="a_proc~~halo~~CallsGraph_node39"><a xlink:href=".././proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-809 314,-809 314,-785 368,-785 368,-809"/>
<text text-anchor="middle" x="341" y="-794.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~halo~~CallsGraph_edge27" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M190.349,-862.472C220.635,-849.222 270.499,-827.407 304.264,-812.634"/>
<polygon fill="#000000" stroke="#000000" points="306,-815.695 313.759,-808.481 303.194,-809.282 306,-815.695"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~halo~~CallsGraph_node45" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~halo~~CallsGraph_node45"><a xlink:href=".././proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="385,-1056 297,-1056 297,-1032 385,-1032 385,-1056"/>
<text text-anchor="middle" x="341" y="-1041.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~halo~~CallsGraph_edge28" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M176.657,-886.226C206.848,-915.387 283.284,-989.217 319.876,-1024.56"/>
<polygon fill="#000000" stroke="#000000" points="317.833,-1027.45 327.457,-1031.88 322.696,-1022.42 317.833,-1027.45"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_node18" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~halo~~CallsGraph_node18"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="803.5,-494 712.5,-494 712.5,-470 803.5,-470 803.5,-494"/>
<text text-anchor="middle" x="758" y="-479.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_edge31" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.879,-526.665C547.998,-522.854 565.81,-518.523 582,-515 622.144,-506.263 667.764,-497.705 702.359,-491.494"/>
<polygon fill="#000000" stroke="#000000" points="703.037,-494.929 712.266,-489.725 701.806,-488.037 703.037,-494.929"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~halo~~CallsGraph_node19" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~halo~~CallsGraph_node19"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-590 583.5,-590 583.5,-566 674.5,-566 674.5,-590"/>
<text text-anchor="middle" x="629" y="-575.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~halo~~CallsGraph_edge32" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.796,-547.477C547.602,-552.223 564.976,-557.794 580.801,-562.867"/>
<polygon fill="#000000" stroke="#000000" points="579.826,-566.23 590.417,-565.95 581.963,-559.564 579.826,-566.23"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~halo~~CallsGraph_node21" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~halo~~CallsGraph_node21"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-548 583.5,-548 583.5,-524 674.5,-524 674.5,-548"/>
<text text-anchor="middle" x="629" y="-533.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~halo~~CallsGraph_edge35" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.796,-536C545.232,-536 559.48,-536 573.1,-536"/>
<polygon fill="#000000" stroke="#000000" points="573.352,-539.5 583.352,-536 573.352,-532.5 573.352,-539.5"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~halo~~CallsGraph_node22" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~halo~~CallsGraph_node22"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="802,-752 714,-752 714,-728 802,-728 802,-752"/>
<text text-anchor="middle" x="758" y="-737.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~halo~~CallsGraph_edge30" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M500.949,-548.017C513.312,-584.888 552.222,-695.233 582,-717 616.823,-742.455 666.262,-746.871 703.714,-745.688"/>
<polygon fill="#000000" stroke="#000000" points="704.109,-749.174 713.938,-745.219 703.788,-742.181 704.109,-749.174"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~halo~~CallsGraph_node27" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~halo~~CallsGraph_node27"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="802,-672 714,-672 714,-648 802,-648 802,-672"/>
<text text-anchor="middle" x="758" y="-657.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~halo~~CallsGraph_edge37" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M505.356,-548.167C519.048,-567.107 548.149,-603.396 582,-622 619.569,-642.648 667.438,-652.077 703.611,-656.383"/>
<polygon fill="#000000" stroke="#000000" points="703.639,-659.907 713.96,-657.514 704.4,-652.948 703.639,-659.907"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~halo~~CallsGraph_node28" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~halo~~CallsGraph_node28"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="673,-788 585,-788 585,-764 673,-764 673,-788"/>
<text text-anchor="middle" x="629" y="-773.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~halo~~CallsGraph_edge38" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M501.325,-548.249C516.582,-591.257 567.745,-733.656 582,-750 584.638,-753.025 587.718,-755.775 591.011,-758.256"/>
<polygon fill="#000000" stroke="#000000" points="589.237,-761.278 599.509,-763.873 593.096,-755.439 589.237,-761.278"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~halo~~CallsGraph_node35" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~halo~~CallsGraph_node35"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="803.5,-630 712.5,-630 712.5,-606 803.5,-606 803.5,-630"/>
<text text-anchor="middle" x="758" y="-615.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~halo~~CallsGraph_edge33" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M508.946,-548.179C524.322,-563.006 552.579,-587.487 582,-599 620.335,-614.001 666.78,-618.476 702.186,-619.349"/>
<polygon fill="#000000" stroke="#000000" points="702.276,-622.85 712.33,-619.509 702.387,-615.851 702.276,-622.85"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~halo~~CallsGraph_node37" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~halo~~CallsGraph_node37"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="673,-708 585,-708 585,-684 673,-684 673,-708"/>
<text text-anchor="middle" x="629" y="-693.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~halo~~CallsGraph_edge34" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M502.195,-548.114C513.532,-573.414 542.661,-632.611 582,-670 585.142,-672.986 588.691,-675.756 592.39,-678.287"/>
<polygon fill="#000000" stroke="#000000" points="590.832,-681.44 601.172,-683.75 594.53,-675.496 590.832,-681.44"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~halo~~CallsGraph_node40" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~halo~~CallsGraph_node40"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-468 583.5,-468 583.5,-444 674.5,-444 674.5,-468"/>
<text text-anchor="middle" x="629" y="-453.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~halo~~CallsGraph_edge29" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515.4,-523.925C532.502,-512.793 558.76,-495.937 582,-482 586.819,-479.11 591.965,-476.115 597.006,-473.23"/>
<polygon fill="#000000" stroke="#000000" points="598.9,-476.18 605.873,-468.203 595.447,-470.09 598.9,-476.18"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~halo~~CallsGraph_node44" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~halo~~CallsGraph_node44"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-426 583.5,-426 583.5,-402 674.5,-402 674.5,-426"/>
<text text-anchor="middle" x="629" y="-411.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~halo~~CallsGraph_edge36" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M504.544,-523.925C517.933,-503.317 547.693,-461.066 582,-435 583.761,-433.662 585.62,-432.384 587.542,-431.168"/>
<polygon fill="#000000" stroke="#000000" points="589.281,-434.205 596.254,-426.228 585.829,-428.116 589.281,-434.205"/>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~ind2sub -->
<g id="proc~~halo~~CallsGraph_edge39" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M181.844,-150.167C213.023,-171.424 277.541,-215.415 313.799,-240.135"/>
<polygon fill="#000000" stroke="#000000" points="312.136,-243.238 322.37,-245.98 316.079,-237.454 312.136,-243.238"/>
</g>
<!-- proc~cumsum -->
<g id="proc~~halo~~CallsGraph_node26" class="node"><title>proc~cumsum</title>
<g id="a_proc~~halo~~CallsGraph_node26"><a xlink:href=".././proc/cumsum.html" xlink:title="cumsum">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-108 314,-108 314,-84 368,-84 368,-108"/>
<text text-anchor="middle" x="341" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cumsum</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~cumsum -->
<g id="proc~~halo~~CallsGraph_edge42" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~cumsum</title>
<path fill="none" stroke="#000000" d="M198.772,-129.702C229.194,-122.442 273.209,-111.939 303.992,-104.593"/>
<polygon fill="#000000" stroke="#000000" points="304.971,-107.958 313.886,-102.232 303.346,-101.149 304.971,-107.958"/>
</g>
<!-- interface~randind_cdf -->
<g id="proc~~halo~~CallsGraph_node30" class="node"><title>interface~randind_cdf</title>
<g id="a_proc~~halo~~CallsGraph_node30"><a xlink:href=".././interface/randind_cdf.html" xlink:title="randind_cdf">
<polygon fill="#a7506f" stroke="#a7506f" points="375.5,-66 306.5,-66 306.5,-42 375.5,-42 375.5,-66"/>
<text text-anchor="middle" x="341" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind_cdf</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;interface~randind_cdf -->
<g id="proc~~halo~~CallsGraph_edge40" class="edge"><title>proc~get_nlaunch&#45;&gt;interface~randind_cdf</title>
<path fill="none" stroke="#000000" d="M198.702,-132.162C211.143,-128.997 224.84,-124.2 236,-117 256.659,-103.671 251.447,-88.4909 272,-75 279.43,-70.1232 288.053,-66.329 296.612,-63.3941"/>
<polygon fill="#000000" stroke="#000000" points="297.663,-66.7328 306.181,-60.4336 295.594,-60.0455 297.663,-66.7328"/>
</g>
<!-- proc~rng_init -->
<g id="proc~~halo~~CallsGraph_node34" class="node"><title>proc~rng_init</title>
<g id="a_proc~~halo~~CallsGraph_node34"><a xlink:href=".././proc/rng_init.html" xlink:title="rng_init">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-150 314,-150 314,-126 368,-126 368,-150"/>
<text text-anchor="middle" x="341" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rng_init</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~rng_init -->
<g id="proc~~halo~~CallsGraph_edge41" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~rng_init</title>
<path fill="none" stroke="#000000" d="M198.772,-138C229.061,-138 272.827,-138 303.59,-138"/>
<polygon fill="#000000" stroke="#000000" points="303.886,-141.5 313.886,-138 303.885,-134.5 303.886,-141.5"/>
</g>
<!-- interface~randn -->
<g id="proc~~halo~~CallsGraph_node33" class="node"><title>interface~randn</title>
<g id="a_proc~~halo~~CallsGraph_node33"><a xlink:href=".././interface/randn.html" xlink:title="randn">
<polygon fill="#a7506f" stroke="#a7506f" points="368,-24 314,-24 314,-0 368,-0 368,-24"/>
<text text-anchor="middle" x="341" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randn</text>
</a>
</g>
</g>
<!-- proc~mc_halo&#45;&gt;interface~randn -->
<g id="proc~~halo~~CallsGraph_edge43" class="edge"><title>proc~mc_halo&#45;&gt;interface~randn</title>
<path fill="none" stroke="#000000" d="M190.179,-92.1349C204.557,-89.1207 222.214,-83.8945 236,-75 256.659,-61.6712 251.447,-46.4909 272,-33 281.648,-26.667 293.309,-22.1598 304.228,-18.989"/>
<polygon fill="#000000" stroke="#000000" points="305.182,-22.3574 313.969,-16.4388 303.409,-15.5856 305.182,-22.3574"/>
</g>
<!-- proc~merge_neutral_populations&#45;&gt;proc~ind2sub -->
<g id="proc~~halo~~CallsGraph_edge44" class="edge"><title>proc~merge_neutral_populations&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M216.806,-285.999C244.927,-279.607 278.79,-271.911 303.89,-266.207"/>
<polygon fill="#000000" stroke="#000000" points="304.753,-269.6 313.728,-263.971 303.201,-262.774 304.753,-269.6"/>
</g>
<!-- proc~merge_reservoirs -->
<g id="proc~~halo~~CallsGraph_node20" class="node"><title>proc~merge_reservoirs</title>
<g id="a_proc~~halo~~CallsGraph_node20"><a xlink:href=".././proc/merge_reservoirs.html" xlink:title="merge_reservoirs">
<polygon fill="#d9534f" stroke="#d9534f" points="544.5,-310 447.5,-310 447.5,-286 544.5,-286 544.5,-310"/>
<text text-anchor="middle" x="496" y="-295.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">merge_reservoirs</text>
</a>
</g>
</g>
<!-- proc~merge_neutral_populations&#45;&gt;proc~merge_reservoirs -->
<g id="proc~~halo~~CallsGraph_edge45" class="edge"><title>proc~merge_neutral_populations&#45;&gt;proc~merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M234.602,-298C295.016,-298 380.912,-298 437.284,-298"/>
<polygon fill="#000000" stroke="#000000" points="437.453,-301.5 447.453,-298 437.453,-294.5 437.453,-301.5"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~halo~~CallsGraph_edge48" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M375.447,-1139.29C438.743,-1132.09 578.434,-1124.45 676,-1180 708.423,-1198.46 733.013,-1235.39 746.192,-1258.83"/>
<polygon fill="#000000" stroke="#000000" points="743.14,-1260.55 750.98,-1267.67 749.295,-1257.21 743.14,-1260.55"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~halo~~CallsGraph_edge46" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M375.199,-1135.32C398.836,-1129.14 430.696,-1120.81 455.619,-1114.3"/>
<polygon fill="#000000" stroke="#000000" points="456.696,-1117.63 465.486,-1111.72 454.926,-1110.86 456.696,-1117.63"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~halo~~CallsGraph_node25" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~halo~~CallsGraph_node25"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="663,-1213 595,-1213 595,-1189 663,-1189 663,-1213"/>
<text text-anchor="middle" x="629" y="-1198.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~halo~~CallsGraph_edge47" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M375.087,-1150.59C426.965,-1160.93 527.441,-1180.96 584.904,-1192.41"/>
<polygon fill="#000000" stroke="#000000" points="584.278,-1195.85 594.769,-1194.38 585.646,-1188.99 584.278,-1195.85"/>
</g>
<!-- proc~get_position -->
<g id="proc~~halo~~CallsGraph_node42" class="node"><title>proc~get_position</title>
<g id="a_proc~~halo~~CallsGraph_node42"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="531,-1272 461,-1272 461,-1248 531,-1248 531,-1272"/>
<text text-anchor="middle" x="496" y="-1257.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~halo~~CallsGraph_edge49" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M375.045,-1150.36C386.695,-1153.57 399.495,-1158.26 410,-1165 426.082,-1175.31 459.131,-1214.92 478.948,-1239.62"/>
<polygon fill="#000000" stroke="#000000" points="476.388,-1242.03 485.357,-1247.67 481.862,-1237.66 476.388,-1242.03"/>
</g>
<!-- proc~update_reservoir -->
<g id="proc~~halo~~CallsGraph_node24" class="node"><title>proc~update_reservoir</title>
<g id="a_proc~~halo~~CallsGraph_node24"><a xlink:href=".././proc/update_reservoir.html" xlink:title="update_reservoir">
<polygon fill="#d9534f" stroke="#d9534f" points="676,-228 582,-228 582,-204 676,-204 676,-228"/>
<text text-anchor="middle" x="629" y="-213.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_reservoir</text>
</a>
</g>
</g>
<!-- proc~update_neutrals&#45;&gt;proc~update_reservoir -->
<g id="proc~~halo~~CallsGraph_edge50" class="edge"><title>proc~update_neutrals&#45;&gt;proc~update_reservoir</title>
<path fill="none" stroke="#000000" d="M208.07,-217.81C292.779,-217.445 478.203,-216.646 571.711,-216.243"/>
<polygon fill="#000000" stroke="#000000" points="571.844,-219.742 581.829,-216.199 571.814,-212.742 571.844,-219.742"/>
</g>
<!-- proc~bb_cx_rates -->
<g id="proc~~halo~~CallsGraph_node41" class="node"><title>proc~bb_cx_rates</title>
<g id="a_proc~~halo~~CallsGraph_node41"><a xlink:href=".././proc/bb_cx_rates.html" xlink:title="bb_cx_rates">
<polygon fill="#d9534f" stroke="#d9534f" points="376.5,-882 305.5,-882 305.5,-858 376.5,-858 376.5,-882"/>
<text text-anchor="middle" x="341" y="-867.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bb_cx_rates</text>
</a>
</g>
</g>
<!-- proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates -->
<g id="proc~~halo~~CallsGraph_edge51" class="edge"><title>proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates</title>
<path fill="none" stroke="#000000" d="M178.168,-740.13C198.66,-757.6 237.859,-790.74 272,-818 286.386,-829.486 302.77,-842.031 315.851,-851.921"/>
<polygon fill="#000000" stroke="#000000" points="313.823,-854.776 323.916,-857.999 318.037,-849.185 313.823,-854.776"/>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;proc~ind2sub -->
<g id="proc~~halo~~CallsGraph_edge54" class="edge"><title>proc~parallel_merge_populations&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M211.453,-327.971C219.761,-325.355 228.228,-322.351 236,-319 263.794,-307.015 293.371,-289.107 313.849,-275.791"/>
<polygon fill="#000000" stroke="#000000" points="315.884,-278.641 322.307,-270.215 312.031,-272.797 315.884,-278.641"/>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;interface~parallel_sum -->
<g id="proc~~halo~~CallsGraph_edge52" class="edge"><title>proc~parallel_merge_populations&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M184.706,-352.261C241.614,-385.958 400.51,-480.048 466.108,-518.892"/>
<polygon fill="#000000" stroke="#000000" points="464.337,-521.911 474.725,-523.994 467.904,-515.887 464.337,-521.911"/>
</g>
<!-- proc~parallel_merge_reservoirs -->
<g id="proc~~halo~~CallsGraph_node38" class="node"><title>proc~parallel_merge_reservoirs</title>
<g id="a_proc~~halo~~CallsGraph_node38"><a xlink:href=".././proc/parallel_merge_reservoirs.html" xlink:title="parallel_merge_reservoirs">
<polygon fill="#d9534f" stroke="#d9534f" points="409.5,-352 272.5,-352 272.5,-328 409.5,-328 409.5,-352"/>
<text text-anchor="middle" x="341" y="-337.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_merge_reservoirs</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;proc~parallel_merge_reservoirs -->
<g id="proc~~halo~~CallsGraph_edge53" class="edge"><title>proc~parallel_merge_populations&#45;&gt;proc~parallel_merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M235.586,-340C244.437,-340 253.517,-340 262.452,-340"/>
<polygon fill="#000000" stroke="#000000" points="262.457,-343.5 272.457,-340 262.457,-336.5 262.457,-343.5"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_edge56" class="edge"><title>proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M737.828,-494.014C730.784,-502.972 737.508,-512 758,-512 770.487,-512 777.862,-508.647 780.124,-504.001"/>
<polygon fill="#000000" stroke="#000000" points="783.526,-503.157 778.172,-494.014 776.656,-504.5 783.526,-503.157"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_node63" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="919.5,-610 840.5,-610 840.5,-586 919.5,-586 919.5,-610"/>
<text text-anchor="middle" x="880" y="-595.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge55" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M771.842,-494.414C792.683,-514.56 834.031,-554.53 858.828,-578.5"/>
<polygon fill="#000000" stroke="#000000" points="856.628,-581.241 866.25,-585.675 861.493,-576.209 856.628,-581.241"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_edge58" class="edge"><title>proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M660.435,-565.776C665.784,-563.164 671.178,-560.212 676,-557 699.988,-541.022 723.746,-517.933 739.266,-501.603"/>
<polygon fill="#000000" stroke="#000000" points="741.921,-503.888 746.188,-494.19 736.805,-499.11 741.921,-503.888"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge57" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M674.516,-581.576C718.251,-585.088 784.821,-590.435 830.031,-594.067"/>
<polygon fill="#000000" stroke="#000000" points="829.937,-597.57 840.186,-594.882 830.498,-590.593 829.937,-597.57"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;interface~randu -->
<g id="proc~~halo~~CallsGraph_edge59" class="edge"><title>proc~merge_reservoirs&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M534.727,-310.085C594.018,-327.01 711.758,-352.19 804,-319 827.203,-310.651 848.33,-291.666 862.204,-276.888"/>
<polygon fill="#000000" stroke="#000000" points="865.035,-278.975 869.133,-269.205 859.836,-274.287 865.035,-278.975"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;proc~update_reservoir -->
<g id="proc~~halo~~CallsGraph_edge62" class="edge"><title>proc~merge_reservoirs&#45;&gt;proc~update_reservoir</title>
<path fill="none" stroke="#000000" d="M530.474,-285.978C535.884,-283.39 541.259,-280.395 546,-277 565.446,-263.075 562.718,-251.151 582,-237 583.84,-235.65 585.781,-234.357 587.783,-233.124"/>
<polygon fill="#000000" stroke="#000000" points="589.781,-236.018 596.831,-228.109 586.388,-229.895 589.781,-236.018"/>
</g>
<!-- float -->
<g id="proc~~halo~~CallsGraph_node48" class="node"><title>float</title>
<polygon fill="#777777" stroke="#777777" points="656,-270 602,-270 602,-246 656,-246 656,-270"/>
<text text-anchor="middle" x="629" y="-255.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">float</text>
</g>
<!-- proc~merge_reservoirs&#45;&gt;float -->
<g id="proc~~halo~~CallsGraph_edge61" class="edge"><title>proc~merge_reservoirs&#45;&gt;float</title>
<path fill="none" stroke="#000000" d="M536.304,-285.999C554.07,-280.574 574.915,-274.209 592.237,-268.92"/>
<polygon fill="#000000" stroke="#000000" points="593.437,-272.213 601.979,-265.945 591.393,-265.518 593.437,-272.213"/>
</g>
<!-- proc~init_reservoir -->
<g id="proc~~halo~~CallsGraph_node54" class="node"><title>proc~init_reservoir</title>
<g id="a_proc~~halo~~CallsGraph_node54"><a xlink:href=".././proc/init_reservoir.html" xlink:title="init_reservoir">
<polygon fill="#d9534f" stroke="#d9534f" points="795,-310 721,-310 721,-286 795,-286 795,-310"/>
<text text-anchor="middle" x="758" y="-295.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_reservoir</text>
</a>
</g>
</g>
<!-- proc~merge_reservoirs&#45;&gt;proc~init_reservoir -->
<g id="proc~~halo~~CallsGraph_edge60" class="edge"><title>proc~merge_reservoirs&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M544.688,-298C591.982,-298 663.966,-298 710.751,-298"/>
<polygon fill="#000000" stroke="#000000" points="710.912,-301.5 720.912,-298 710.912,-294.5 710.912,-301.5"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_edge64" class="edge"><title>proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M658.501,-523.881C676.476,-516.239 699.891,-506.282 719.382,-497.995"/>
<polygon fill="#000000" stroke="#000000" points="720.761,-501.212 728.594,-494.078 718.022,-494.77 720.761,-501.212"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge63" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M674.516,-547.084C718.343,-557.997 785.101,-574.62 830.316,-585.878"/>
<polygon fill="#000000" stroke="#000000" points="829.636,-589.315 840.186,-588.335 831.328,-582.523 829.636,-589.315"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~halo~~CallsGraph_edge66" class="edge"><title>proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M737.828,-752.014C730.784,-760.972 737.508,-770 758,-770 770.487,-770 777.862,-766.647 780.124,-762.001"/>
<polygon fill="#000000" stroke="#000000" points="783.526,-761.157 778.172,-752.014 776.656,-762.5 783.526,-761.157"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge65" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M784.739,-727.906C791.454,-724.037 798.378,-719.348 804,-714 833.453,-685.985 856.783,-644.215 869.186,-619.186"/>
<polygon fill="#000000" stroke="#000000" points="872.341,-620.702 873.537,-610.175 866.037,-617.658 872.341,-620.702"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~halo~~CallsGraph_edge67" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M513.326,-1116.09C535.88,-1132.79 576.764,-1163.06 603.13,-1182.58"/>
<polygon fill="#000000" stroke="#000000" points="601.348,-1185.62 611.468,-1188.76 605.514,-1179.99 601.348,-1185.62"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~halo~~CallsGraph_node61" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~halo~~CallsGraph_node61"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="667.5,-1076 590.5,-1076 590.5,-1052 667.5,-1052 667.5,-1076"/>
<text text-anchor="middle" x="629" y="-1061.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~halo~~CallsGraph_edge68" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M526.726,-1094.92C542.649,-1090.06 562.642,-1083.96 580.648,-1078.46"/>
<polygon fill="#000000" stroke="#000000" points="581.867,-1081.75 590.409,-1075.48 579.822,-1075.05 581.867,-1081.75"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~halo~~CallsGraph_node65" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~halo~~CallsGraph_node65"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="790.5,-1183 725.5,-1183 725.5,-1159 790.5,-1159 790.5,-1183"/>
<text text-anchor="middle" x="758" y="-1168.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~halo~~CallsGraph_edge69" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M526.798,-1105.38C562.868,-1107.72 625.102,-1113.9 676,-1130 694.293,-1135.79 713.505,-1145.34 728.625,-1153.77"/>
<polygon fill="#000000" stroke="#000000" points="727.048,-1156.9 737.465,-1158.83 730.525,-1150.83 727.048,-1156.9"/>
</g>
<!-- proc~update_reservoir&#45;&gt;interface~randu -->
<g id="proc~~halo~~CallsGraph_edge70" class="edge"><title>proc~update_reservoir&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M676.132,-218.809C711.397,-221.492 761.088,-226.433 804,-235 816.891,-237.574 830.766,-241.35 843.034,-245.05"/>
<polygon fill="#000000" stroke="#000000" points="842.316,-248.492 852.904,-248.112 844.39,-241.806 842.316,-248.492"/>
</g>
<!-- proc~update_reservoir&#45;&gt;proc~init_reservoir -->
<g id="proc~~halo~~CallsGraph_edge71" class="edge"><title>proc~update_reservoir&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M661.169,-228.109C666.331,-230.701 671.47,-233.676 676,-237 695.282,-251.151 692.777,-262.768 712,-277 713.802,-278.334 715.701,-279.613 717.661,-280.836"/>
<polygon fill="#000000" stroke="#000000" points="716.084,-283.964 726.515,-285.822 719.519,-277.865 716.084,-283.964"/>
</g>
<!-- interface~randind -->
<g id="proc~~halo~~CallsGraph_node60" class="node"><title>interface~randind</title>
<g id="a_proc~~halo~~CallsGraph_node60"><a xlink:href=".././interface/randind.html" xlink:title="randind">
<polygon fill="#a7506f" stroke="#a7506f" points="785,-268 731,-268 731,-244 785,-244 785,-268"/>
<text text-anchor="middle" x="758" y="-253.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind</text>
</a>
</g>
</g>
<!-- proc~update_reservoir&#45;&gt;interface~randind -->
<g id="proc~~halo~~CallsGraph_edge72" class="edge"><title>proc~update_reservoir&#45;&gt;interface~randind</title>
<path fill="none" stroke="#000000" d="M668.104,-228.001C684.925,-233.299 704.592,-239.494 721.145,-244.707"/>
<polygon fill="#000000" stroke="#000000" points="720.406,-248.144 730.996,-247.81 722.509,-241.467 720.406,-248.144"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge73" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M785.786,-647.841C791.813,-645.011 798.154,-641.958 804,-639 818.954,-631.433 835.31,-622.563 848.921,-615.012"/>
<polygon fill="#000000" stroke="#000000" points="850.828,-617.957 857.855,-610.028 847.417,-611.844 850.828,-617.957"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~halo~~CallsGraph_edge75" class="edge"><title>proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M672.642,-763.912C682.904,-761.004 693.984,-757.863 704.632,-754.844"/>
<polygon fill="#000000" stroke="#000000" points="705.588,-758.212 714.254,-752.117 703.678,-751.477 705.588,-758.212"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge74" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M667.04,-788.005C704.797,-797.818 763.428,-806.106 804,-779 858.032,-742.902 873.188,-659.884 877.4,-620.076"/>
<polygon fill="#000000" stroke="#000000" points="880.89,-620.348 878.322,-610.069 873.92,-619.706 880.89,-620.348"/>
</g>
<!-- proc~xyz_to_cyl -->
<g id="proc~~halo~~CallsGraph_node49" class="node"><title>proc~xyz_to_cyl</title>
<g id="a_proc~~halo~~CallsGraph_node49"><a xlink:href=".././proc/xyz_to_cyl.html" xlink:title="xyz_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="527,-1394 465,-1394 465,-1370 527,-1370 527,-1394"/>
<text text-anchor="middle" x="496" y="-1379.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_cyl</text>
</a>
</g>
</g>
<!-- proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl -->
<g id="proc~~halo~~CallsGraph_edge76" class="edge"><title>proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl</title>
<path fill="none" stroke="#000000" d="M383.193,-1338.06C392.084,-1340.85 401.396,-1343.91 410,-1347 419.208,-1350.31 439.098,-1358.48 457.323,-1366.09"/>
<polygon fill="#000000" stroke="#000000" points="456.061,-1369.36 466.636,-1370 458.766,-1362.9 456.061,-1369.36"/>
</g>
<!-- dgetrs -->
<g id="proc~~halo~~CallsGraph_node47" class="node"><title>dgetrs</title>
<polygon fill="#777777" stroke="#777777" points="523,-1036 469,-1036 469,-1012 523,-1012 523,-1036"/>
<text text-anchor="middle" x="496" y="-1021.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrs</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrs -->
<g id="proc~~halo~~CallsGraph_edge79" class="edge"><title>proc~linsolve&#45;&gt;dgetrs</title>
<path fill="none" stroke="#000000" d="M365.793,-964.098C386.766,-974.658 418.221,-990.246 446,-1003 450.395,-1005.02 455.037,-1007.09 459.642,-1009.1"/>
<polygon fill="#000000" stroke="#000000" points="458.385,-1012.37 468.953,-1013.13 461.164,-1005.95 458.385,-1012.37"/>
</g>
<!-- proc~matinv -->
<g id="proc~~halo~~CallsGraph_node55" class="node"><title>proc~matinv</title>
<g id="a_proc~~halo~~CallsGraph_node55"><a xlink:href=".././proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="523,-914 469,-914 469,-890 523,-890 523,-914"/>
<text text-anchor="middle" x="496" y="-899.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~linsolve&#45;&gt;proc~matinv -->
<g id="proc~~halo~~CallsGraph_edge77" class="edge"><title>proc~linsolve&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M368.302,-943.405C393.337,-935.223 431.213,-922.845 459.034,-913.754"/>
<polygon fill="#000000" stroke="#000000" points="460.368,-917 468.786,-910.567 458.193,-910.346 460.368,-917"/>
</g>
<!-- dgetrf -->
<g id="proc~~halo~~CallsGraph_node64" class="node"><title>dgetrf</title>
<polygon fill="#777777" stroke="#777777" points="523,-994 469,-994 469,-970 523,-970 523,-994"/>
<text text-anchor="middle" x="496" y="-979.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrf</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrf -->
<g id="proc~~halo~~CallsGraph_edge78" class="edge"><title>proc~linsolve&#45;&gt;dgetrf</title>
<path fill="none" stroke="#000000" d="M368.302,-957.157C393.227,-962.044 430.881,-969.428 458.667,-974.876"/>
<polygon fill="#000000" stroke="#000000" points="458.299,-978.37 468.786,-976.86 459.646,-971.501 458.299,-978.37"/>
</g>
<!-- proc~rng_seed -->
<g id="proc~~halo~~CallsGraph_node50" class="node"><title>proc~rng_seed</title>
<g id="a_proc~~halo~~CallsGraph_node50"><a xlink:href=".././proc/rng_seed.html" xlink:title="rng_seed">
<polygon fill="#d94e8f" stroke="#d94e8f" points="525,-150 467,-150 467,-126 525,-126 525,-150"/>
<text text-anchor="middle" x="496" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rng_seed</text>
</a>
</g>
</g>
<!-- proc~rng_init&#45;&gt;proc~rng_seed -->
<g id="proc~~halo~~CallsGraph_edge80" class="edge"><title>proc~rng_init&#45;&gt;proc~rng_seed</title>
<path fill="none" stroke="#000000" d="M368.302,-138C392.697,-138 429.285,-138 456.88,-138"/>
<polygon fill="#000000" stroke="#000000" points="456.972,-141.5 466.972,-138 456.972,-134.5 456.972,-141.5"/>
</g>
<!-- proc~my_rank -->
<g id="proc~~halo~~CallsGraph_node51" class="node"><title>proc~my_rank</title>
<g id="a_proc~~halo~~CallsGraph_node51"><a xlink:href=".././proc/my_rank.html" xlink:title="my_rank">
<polygon fill="#d94e8f" stroke="#d94e8f" points="523,-268 469,-268 469,-244 523,-244 523,-268"/>
<text text-anchor="middle" x="496" y="-253.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">my_rank</text>
</a>
</g>
</g>
<!-- proc~rng_init&#45;&gt;proc~my_rank -->
<g id="proc~~halo~~CallsGraph_edge81" class="edge"><title>proc~rng_init&#45;&gt;proc~my_rank</title>
<path fill="none" stroke="#000000" d="M357.797,-150.184C384.596,-170.852 439.133,-212.913 470.782,-237.322"/>
<polygon fill="#000000" stroke="#000000" points="469.003,-240.37 479.059,-243.706 473.278,-234.827 469.003,-240.37"/>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge82" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M803.684,-610.553C812.305,-609.116 821.378,-607.604 830.124,-606.146"/>
<polygon fill="#000000" stroke="#000000" points="830.906,-609.564 840.195,-604.468 829.755,-602.659 830.906,-609.564"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~halo~~CallsGraph_edge84" class="edge"><title>proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M664.703,-708.023C679.543,-713.165 697.045,-719.228 712.797,-724.685"/>
<polygon fill="#000000" stroke="#000000" points="711.744,-728.025 722.339,-727.991 714.035,-721.41 711.744,-728.025"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge83" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M673.109,-700.778C709.826,-702.925 762.996,-701.366 804,-681 831.629,-667.277 853.846,-638.629 866.731,-618.861"/>
<polygon fill="#000000" stroke="#000000" points="869.793,-620.564 872.134,-610.231 863.86,-616.849 869.793,-620.564"/>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;interface~parallel_sum -->
<g id="proc~~halo~~CallsGraph_edge88" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M351.765,-352.041C365.046,-368.455 389.499,-398.809 410,-425 434.698,-456.553 462.89,-493.571 479.798,-515.884"/>
<polygon fill="#000000" stroke="#000000" points="477.074,-518.084 485.901,-523.945 482.656,-513.859 477.074,-518.084"/>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~merge_reservoirs -->
<g id="proc~~halo~~CallsGraph_edge89" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M385.844,-327.964C403.129,-323.219 423.153,-317.723 441.294,-312.743"/>
<polygon fill="#000000" stroke="#000000" points="442.433,-316.06 451.15,-310.037 440.58,-309.309 442.433,-316.06"/>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~my_rank -->
<g id="proc~~halo~~CallsGraph_edge85" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~my_rank</title>
<path fill="none" stroke="#000000" d="M360.338,-327.814C380.772,-314.492 415.021,-292.923 446,-277 450.301,-274.789 454.888,-272.606 459.464,-270.532"/>
<polygon fill="#000000" stroke="#000000" points="461.002,-273.679 468.748,-266.451 458.185,-267.271 461.002,-273.679"/>
</g>
<!-- proc~num_ranks -->
<g id="proc~~halo~~CallsGraph_node53" class="node"><title>proc~num_ranks</title>
<g id="a_proc~~halo~~CallsGraph_node53"><a xlink:href=".././proc/num_ranks.html" xlink:title="num_ranks">
<polygon fill="#d94e8f" stroke="#d94e8f" points="529,-352 463,-352 463,-328 529,-328 529,-352"/>
<text text-anchor="middle" x="496" y="-337.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">num_ranks</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~num_ranks -->
<g id="proc~~halo~~CallsGraph_edge86" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~num_ranks</title>
<path fill="none" stroke="#000000" d="M409.553,-340C424.208,-340 439.306,-340 452.658,-340"/>
<polygon fill="#000000" stroke="#000000" points="452.95,-343.5 462.949,-340 452.949,-336.5 452.95,-343.5"/>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~init_reservoir -->
<g id="proc~~halo~~CallsGraph_edge87" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M391.158,-352.017C408.389,-355.671 427.946,-359.195 446,-361 490.224,-365.42 502.022,-367.425 546,-361 607.286,-352.046 675.509,-329.193 717.343,-313.62"/>
<polygon fill="#000000" stroke="#000000" points="718.755,-316.828 726.878,-310.025 716.286,-310.277 718.755,-316.828"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~halo~~CallsGraph_node56" class="node"><title>proc~elmhes</title>
<g id="a_proc~~halo~~CallsGraph_node56"><a xlink:href=".././proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="523,-872 469,-872 469,-848 523,-848 523,-872"/>
<text text-anchor="middle" x="496" y="-857.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~halo~~CallsGraph_edge90" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M368.302,-807.83C393.447,-818.184 431.546,-833.872 459.399,-845.341"/>
<polygon fill="#000000" stroke="#000000" points="458.207,-848.635 468.786,-849.206 460.872,-842.162 458.207,-848.635"/>
</g>
<!-- proc~balance -->
<g id="proc~~halo~~CallsGraph_node57" class="node"><title>proc~balance</title>
<g id="a_proc~~halo~~CallsGraph_node57"><a xlink:href=".././proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="523,-788 469,-788 469,-764 523,-764 523,-788"/>
<text text-anchor="middle" x="496" y="-773.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~halo~~CallsGraph_edge91" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M368.302,-793.39C393.227,-789.969 430.881,-784.801 458.667,-780.987"/>
<polygon fill="#000000" stroke="#000000" points="459.355,-784.425 468.786,-779.598 458.403,-777.49 459.355,-784.425"/>
</g>
<!-- proc~balback -->
<g id="proc~~halo~~CallsGraph_node58" class="node"><title>proc~balback</title>
<g id="a_proc~~halo~~CallsGraph_node58"><a xlink:href=".././proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="523,-746 469,-746 469,-722 523,-722 523,-746"/>
<text text-anchor="middle" x="496" y="-731.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~halo~~CallsGraph_edge92" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M368.302,-786.17C393.447,-775.816 431.546,-760.128 459.399,-748.659"/>
<polygon fill="#000000" stroke="#000000" points="460.872,-751.838 468.786,-744.794 458.207,-745.365 460.872,-751.838"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~halo~~CallsGraph_node59" class="node"><title>proc~hqr2</title>
<g id="a_proc~~halo~~CallsGraph_node59"><a xlink:href=".././proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="523,-704 469,-704 469,-680 523,-680 523,-704"/>
<text text-anchor="middle" x="496" y="-689.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~halo~~CallsGraph_edge93" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M354.594,-784.885C373.336,-767.327 410.214,-734.556 446,-713 450.237,-710.448 454.839,-708.046 459.471,-705.844"/>
<polygon fill="#000000" stroke="#000000" points="461.214,-708.898 468.911,-701.617 458.354,-702.509 461.214,-708.898"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~halo~~CallsGraph_node66" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~halo~~CallsGraph_node66"><a xlink:href=".././proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="523,-830 469,-830 469,-806 523,-806 523,-830"/>
<text text-anchor="middle" x="496" y="-815.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~halo~~CallsGraph_edge94" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M368.302,-800.61C393.227,-804.031 430.881,-809.199 458.667,-813.013"/>
<polygon fill="#000000" stroke="#000000" points="458.403,-816.51 468.786,-814.402 459.355,-809.575 458.403,-816.51"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_edge96" class="edge"><title>proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M674.775,-465.167C683.691,-466.992 693.148,-468.928 702.351,-470.812"/>
<polygon fill="#000000" stroke="#000000" points="701.702,-474.252 712.201,-472.829 703.106,-467.394 701.702,-474.252"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge95" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M674.533,-445.749C711.891,-439.699 765.209,-437.253 804,-461 845.581,-486.455 865.75,-543.734 874.073,-575.578"/>
<polygon fill="#000000" stroke="#000000" points="870.769,-576.801 876.539,-585.687 877.57,-575.142 870.769,-576.801"/>
</g>
<!-- proc~bb_cx_rates&#45;&gt;interface~interpol_coeff -->
<g id="proc~~halo~~CallsGraph_edge97" class="edge"><title>proc~bb_cx_rates&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M363.98,-882.079C384.802,-893.311 417.099,-910.189 446,-923 489.467,-942.267 507.604,-932.959 546,-961 576.662,-983.393 602.058,-1020.09 616.111,-1043.1"/>
<polygon fill="#000000" stroke="#000000" points="613.14,-1044.96 621.259,-1051.76 619.157,-1041.38 613.14,-1044.96"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~halo~~CallsGraph_node62" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~halo~~CallsGraph_node62"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="660,-1272 598,-1272 598,-1248 660,-1248 660,-1272"/>
<text text-anchor="middle" x="629" y="-1257.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~halo~~CallsGraph_edge98" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M531.077,-1260C548.314,-1260 569.356,-1260 587.425,-1260"/>
<polygon fill="#000000" stroke="#000000" points="587.668,-1263.5 597.668,-1260 587.668,-1256.5 587.668,-1263.5"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~halo~~CallsGraph_edge99" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M370.151,-1249.57C382.536,-1253.18 397.157,-1257.85 410,-1263 426.602,-1269.66 428.59,-1276.89 446,-1281 539.389,-1303.05 652.995,-1294 713.741,-1286.41"/>
<polygon fill="#000000" stroke="#000000" points="714.273,-1289.87 723.739,-1285.11 713.372,-1282.93 714.273,-1289.87"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~halo~~CallsGraph_edge100" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M370.006,-1230.72C382.919,-1224.75 398.005,-1216.66 410,-1207 439.834,-1182.97 466.567,-1147.05 481.772,-1124.6"/>
<polygon fill="#000000" stroke="#000000" points="484.764,-1126.42 487.379,-1116.15 478.932,-1122.55 484.764,-1126.42"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~halo~~CallsGraph_edge102" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M370.205,-1237.96C420.325,-1230.77 525.202,-1215.74 584.582,-1207.22"/>
<polygon fill="#000000" stroke="#000000" points="585.362,-1210.65 594.765,-1205.76 584.369,-1203.72 585.362,-1210.65"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~halo~~CallsGraph_edge103" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M370.063,-1245.3C392.682,-1247.96 424.899,-1251.75 450.952,-1254.82"/>
<polygon fill="#000000" stroke="#000000" points="450.624,-1258.3 460.964,-1256 451.442,-1251.35 450.624,-1258.3"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~halo~~CallsGraph_node52" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~halo~~CallsGraph_node52"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="546,-1352 446,-1352 446,-1328 546,-1328 546,-1352"/>
<text text-anchor="middle" x="496" y="-1337.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~halo~~CallsGraph_edge101" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M370.025,-1246.34C383.091,-1249.39 398.301,-1254.51 410,-1263 432.454,-1279.3 425.178,-1295.66 446,-1314 449.648,-1317.21 453.761,-1320.17 458.016,-1322.84"/>
<polygon fill="#000000" stroke="#000000" points="456.431,-1325.97 466.842,-1327.94 459.93,-1319.91 456.431,-1325.97"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_edge105" class="edge"><title>proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M657.454,-426.003C663.611,-428.841 670.073,-431.937 676,-435 693.702,-444.149 713.02,-455.311 728.35,-464.461"/>
<polygon fill="#000000" stroke="#000000" points="726.955,-467.706 737.329,-469.862 730.564,-461.708 726.955,-467.706"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge104" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M674.706,-408.715C712.678,-406.646 766.784,-409.686 804,-437 850.183,-470.895 868.834,-540.385 875.591,-575.956"/>
<polygon fill="#000000" stroke="#000000" points="872.148,-576.585 877.324,-585.83 879.043,-575.375 872.148,-576.585"/>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~halo~~CallsGraph_edge106" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M385.127,-1047.02C437.61,-1050.69 525.941,-1056.86 580.378,-1060.67"/>
<polygon fill="#000000" stroke="#000000" points="580.243,-1064.17 590.462,-1061.37 580.731,-1057.19 580.243,-1064.17"/>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~halo~~CallsGraph_edge108" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M527.152,-1373.95C534.12,-1370.87 540.959,-1366.67 546,-1361 583.55,-1318.74 550.846,-1286.18 582,-1239 586.736,-1231.83 593.234,-1225.31 599.854,-1219.78"/>
<polygon fill="#000000" stroke="#000000" points="602.422,-1222.22 608.182,-1213.33 598.134,-1216.69 602.422,-1222.22"/>
</g>
<!-- proc~uvw_to_cyl -->
<g id="proc~~halo~~CallsGraph_node67" class="node"><title>proc~uvw_to_cyl</title>
<g id="a_proc~~halo~~CallsGraph_node67"><a xlink:href=".././proc/uvw_to_cyl.html" xlink:title="uvw_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="661.5,-1394 596.5,-1394 596.5,-1370 661.5,-1370 661.5,-1394"/>
<text text-anchor="middle" x="629" y="-1379.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_cyl</text>
</a>
</g>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl -->
<g id="proc~~halo~~CallsGraph_edge107" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl</title>
<path fill="none" stroke="#000000" d="M527.054,-1382C544.598,-1382 566.998,-1382 586.238,-1382"/>
<polygon fill="#000000" stroke="#000000" points="586.259,-1385.5 596.259,-1382 586.258,-1378.5 586.259,-1385.5"/>
</g>
<!-- proc~init_reservoir&#45;&gt;interface~randu -->
<g id="proc~~halo~~CallsGraph_edge109" class="edge"><title>proc~init_reservoir&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M794.355,-285.92C809.667,-280.689 827.571,-274.571 842.96,-269.314"/>
<polygon fill="#000000" stroke="#000000" points="844.325,-272.546 852.656,-266.001 842.062,-265.922 844.325,-272.546"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~halo~~CallsGraph_node70" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~halo~~CallsGraph_node70"><a xlink:href=".././proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="656,-956 602,-956 602,-932 656,-932 656,-956"/>
<text text-anchor="middle" x="629" y="-941.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~halo~~CallsGraph_edge111" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M523.195,-910.398C543.008,-916.751 570.436,-925.544 592.263,-932.542"/>
<polygon fill="#000000" stroke="#000000" points="591.259,-935.896 601.85,-935.616 593.396,-929.23 591.259,-935.896"/>
</g>
<!-- proc~lubksb -->
<g id="proc~~halo~~CallsGraph_node71" class="node"><title>proc~lubksb</title>
<g id="a_proc~~halo~~CallsGraph_node71"><a xlink:href=".././proc/lubksb.html" xlink:title="lubksb">
<polygon fill="#d9534f" stroke="#d9534f" points="656,-914 602,-914 602,-890 656,-890 656,-914"/>
<text text-anchor="middle" x="629" y="-899.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lubksb</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~lubksb -->
<g id="proc~~halo~~CallsGraph_edge110" class="edge"><title>proc~matinv&#45;&gt;proc~lubksb</title>
<path fill="none" stroke="#000000" d="M523.195,-902C542.83,-902 569.943,-902 591.672,-902"/>
<polygon fill="#000000" stroke="#000000" points="591.85,-905.5 601.85,-902 591.85,-898.5 591.85,-905.5"/>
</g>
<!-- proc~rswap -->
<g id="proc~~halo~~CallsGraph_node69" class="node"><title>proc~rswap</title>
<g id="a_proc~~halo~~CallsGraph_node69"><a xlink:href=".././proc/rswap.html" xlink:title="RSWAP">
<polygon fill="#d9534f" stroke="#d9534f" points="656,-872 602,-872 602,-848 656,-848 656,-872"/>
<text text-anchor="middle" x="629" y="-857.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RSWAP</text>
</a>
</g>
</g>
<!-- proc~elmhes&#45;&gt;proc~rswap -->
<g id="proc~~halo~~CallsGraph_edge112" class="edge"><title>proc~elmhes&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M523.195,-860C542.83,-860 569.943,-860 591.672,-860"/>
<polygon fill="#000000" stroke="#000000" points="591.85,-863.5 601.85,-860 591.85,-856.5 591.85,-863.5"/>
</g>
<!-- proc~balance&#45;&gt;proc~rswap -->
<g id="proc~~halo~~CallsGraph_edge113" class="edge"><title>proc~balance&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M523.114,-784.607C530.879,-787.829 539.138,-791.959 546,-797 565.814,-811.554 562.357,-824.215 582,-839 585.222,-841.425 588.769,-843.656 592.42,-845.685"/>
<polygon fill="#000000" stroke="#000000" points="591.082,-848.929 601.587,-850.305 594.232,-842.678 591.082,-848.929"/>
</g>
<!-- proc~balback&#45;&gt;proc~rswap -->
<g id="proc~~halo~~CallsGraph_edge114" class="edge"><title>proc~balback&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M523.134,-740.993C531.256,-744.194 539.717,-748.717 546,-755 574.721,-783.721 553.617,-809.945 582,-839 585.037,-842.108 588.619,-844.8 592.422,-847.12"/>
<polygon fill="#000000" stroke="#000000" points="591.06,-850.356 601.545,-851.878 594.297,-844.15 591.06,-850.356"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~halo~~CallsGraph_node68" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~halo~~CallsGraph_node68"><a xlink:href=".././proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="656,-830 602,-830 602,-806 656,-806 656,-830"/>
<text text-anchor="middle" x="629" y="-815.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~halo~~CallsGraph_edge115" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M523.134,-698.993C531.256,-702.194 539.717,-706.717 546,-713 574.721,-741.721 553.617,-767.945 582,-797 585.037,-800.108 588.619,-802.8 592.422,-805.12"/>
<polygon fill="#000000" stroke="#000000" points="591.06,-808.356 601.545,-809.878 594.297,-802.15 591.06,-808.356"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~halo~~CallsGraph_edge116" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M660.097,-1264.74C676.162,-1267.27 696.215,-1270.43 713.904,-1273.21"/>
<polygon fill="#000000" stroke="#000000" points="713.575,-1276.7 723.997,-1274.8 714.664,-1269.79 713.575,-1276.7"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~halo~~CallsGraph_edge117" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M647.128,-1248C668.81,-1232.8 706.353,-1206.49 731.433,-1188.92"/>
<polygon fill="#000000" stroke="#000000" points="733.557,-1191.7 739.738,-1183.1 729.54,-1185.97 733.557,-1191.7"/>
</g>
<!-- proc~comdiv -->
<g id="proc~~halo~~CallsGraph_node73" class="node"><title>proc~comdiv</title>
<g id="a_proc~~halo~~CallsGraph_node73"><a xlink:href=".././proc/comdiv.html" xlink:title="Comdiv">
<polygon fill="#d9534f" stroke="#d9534f" points="785,-850 731,-850 731,-826 785,-826 785,-850"/>
<text text-anchor="middle" x="758" y="-835.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Comdiv</text>
</a>
</g>
</g>
<!-- proc~hqrvec&#45;&gt;proc~comdiv -->
<g id="proc~~halo~~CallsGraph_edge118" class="edge"><title>proc~hqrvec&#45;&gt;proc~comdiv</title>
<path fill="none" stroke="#000000" d="M656.007,-822.096C674.631,-825.029 699.959,-829.017 720.591,-832.266"/>
<polygon fill="#000000" stroke="#000000" points="720.169,-835.743 730.592,-833.841 721.258,-828.828 720.169,-835.743"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~halo~~CallsGraph_node72" class="node"><title>proc~outerprod</title>
<g id="a_proc~~halo~~CallsGraph_node72"><a xlink:href=".././proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="787.5,-935 728.5,-935 728.5,-911 787.5,-911 787.5,-935"/>
<text text-anchor="middle" x="758" y="-920.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~halo~~CallsGraph_edge119" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M656.007,-939.7C673.928,-936.736 698.057,-932.747 718.235,-929.41"/>
<polygon fill="#000000" stroke="#000000" points="719.079,-932.818 728.374,-927.733 717.937,-925.912 719.079,-932.818"/>
</g>
<!-- proc~swap -->
<g id="proc~~halo~~CallsGraph_node74" class="node"><title>proc~swap</title>
<g id="a_proc~~halo~~CallsGraph_node74"><a xlink:href=".././proc/swap.html" xlink:title="swap">
<polygon fill="#d9534f" stroke="#d9534f" points="785,-977 731,-977 731,-953 785,-953 785,-977"/>
<text text-anchor="middle" x="758" y="-962.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swap</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~swap -->
<g id="proc~~halo~~CallsGraph_edge120" class="edge"><title>proc~ludcmp&#45;&gt;proc~swap</title>
<path fill="none" stroke="#000000" d="M656.007,-948.3C674.631,-951.38 699.959,-955.568 720.591,-958.98"/>
<polygon fill="#000000" stroke="#000000" points="720.154,-962.455 730.592,-960.633 721.297,-955.549 720.154,-962.455"/>
</g>
</g>
</svg>
</div><script>var panprochaloCallsGraph = svgPanZoom('#prochaloCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~halo~~CalledByGraph Pages: 1 -->
<svg id="prochaloCalledByGraph" width="152pt" height="32pt"
 viewBox="0.00 0.00 152.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~halo~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~halo~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 148,-28 148,4 -4,4"/>
<!-- proc~halo -->
<g id="proc~~halo~~CalledByGraph_node1" class="node"><title>proc~halo</title>
<polygon fill="none" stroke="black" points="144,-24 90,-24 90,-0 144,-0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">halo</text>
</g>
<!-- program~fidasim -->
<g id="proc~~halo~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~halo~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~halo -->
<g id="proc~~halo~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~halo</title>
<path fill="none" stroke="#000000" d="M54.4029,-12C62.3932,-12 71.3106,-12 79.8241,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.919,-15.5001 89.919,-12 79.919,-8.5001 79.919,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/halo.html#src">halo</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">halo</span>
    <span class="c">!+ Calculates halo neutral density and spectra</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ic</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">ncell</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">Int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ihalo</span> <span class="c">!! counter</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ri</span>    <span class="c">!! start position</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vihalo</span><span class="c">!! velocity bulk plasma ion</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ind</span><span class="p">,</span> <span class="n">tind</span>    <span class="c">!! actual cell</span>
    <span class="c">!! Determination of the CX probability</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span> <span class="kd">::</span> <span class="n">plasma</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">denn</span>    <span class="c">!!  neutral dens (n=1-4)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rates</span>    <span class="c">!! CX rates</span>
    <span class="c">!! Collisiional radiative model along track</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">states</span>  <span class="c">! Density of n-states</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ntrack</span>
    <span class="k">type</span><span class="p">(</span><span class="n">ParticleTrack</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ntrack</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tracks</span>  <span class="c">!! Particle Tracks</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="k">is</span>
<span class="k">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tot_denn</span><span class="p">,</span> <span class="n">photons</span>  <span class="c">!! photon flux</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cell_ind</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nx</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ny</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nz</span><span class="p">)</span> <span class="kd">::</span> <span class="n">papprox</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nx</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ny</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nz</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nlaunch</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">local_iter_dens</span>

    <span class="k">type</span><span class="p">(</span><span class="n">NeutralPopulation</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cur_pop</span><span class="p">,</span> <span class="n">prev_pop</span>
    <span class="c">!! Halo iteration</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">Int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hh</span><span class="p">,</span> <span class="n">n_halo</span> <span class="c">!! counters</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dcx_dens</span><span class="p">,</span> <span class="n">halo_iter_dens</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">seed_dcx</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">prev_type</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c">! previous iteration</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">cur_type</span> <span class="o">=</span> <span class="mi">2</span> <span class="c">! current iteration</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fi_correction</span>

    <span class="c">!! Initialize Neutral Population</span>
    <span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">halo</span><span class="p">)</span>

    <span class="n">dcx_dens</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">dcx</span><span class="p">%</span><span class="n">dens</span><span class="p">)</span>

    <span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">prev_type</span><span class="p">)</span> <span class="o">=</span> <span class="n">dcx_dens</span>
    <span class="k">if</span><span class="p">(</span><span class="n">dcx_dens</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s1">&#39;HALO: Density of DCX-neutrals is zero&#39;</span>
        <span class="k">endif</span>
<span class="k">        stop</span>
<span class="k">    endif</span>
<span class="k">    </span><span class="n">n_halo</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">%</span><span class="n">n_halo</span>

    <span class="c">!! Allocate previous neutral populations</span>
    <span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">prev_pop</span><span class="p">)</span>
    <span class="n">prev_pop</span> <span class="o">=</span> <span class="n">neut</span><span class="p">%</span><span class="n">dcx</span>

    <span class="n">seed_dcx</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">iterations</span><span class="p">:</span> <span class="k">do </span><span class="n">hh</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">200</span>
        <span class="c">!! Allocate/Reallocate current population</span>
        <span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">cur_pop</span><span class="p">)</span>
        <span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">cur_type</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.d0</span>

        <span class="c">!! Calculate how many mc markers to launch in each cell</span>
        <span class="n">papprox</span> <span class="o">=</span> <span class="mf">0.d0</span>
        <span class="n">cell_ind</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">ncell</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">do </span><span class="n">ic</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span>
            <span class="k">call </span><span class="n">ind2sub</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">ic</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span> <span class="n">j</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

            <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">ind</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span>
            <span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">plasma</span><span class="p">%</span><span class="n">in_plasma</span><span class="p">)</span> <span class="k">cycle</span>
<span class="k">            </span><span class="n">tot_denn</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">prev_pop</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
            <span class="n">papprox</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">=</span> <span class="n">tot_denn</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">plasma</span><span class="p">%</span><span class="n">deni</span><span class="p">)</span>
            <span class="k">if</span><span class="p">(</span><span class="n">papprox</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                </span><span class="n">ncell</span> <span class="o">=</span> <span class="n">ncell</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">cell_ind</span><span class="p">(</span><span class="n">ncell</span><span class="p">)</span> <span class="o">=</span> <span class="n">ic</span>
            <span class="k">endif</span>
<span class="k">        enddo</span>
<span class="k">        call </span><span class="n">get_nlaunch</span><span class="p">(</span><span class="n">n_halo</span><span class="p">,</span> <span class="n">papprox</span><span class="p">,</span> <span class="n">nlaunch</span><span class="p">)</span>

        <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i10,&quot; --- Seed/DCX: &quot;,f5.3)&#39;</span><span class="p">)</span> <span class="nb">sum</span><span class="p">(</span><span class="n">nlaunch</span><span class="p">),</span> <span class="n">seed_dcx</span>
        <span class="k">endif</span>

        <span class="c">!$OMP PARALLEL DO schedule(dynamic,1) private(i,j,k,ic,ihalo,ii,jj,kk,it,is,ind,vihalo, &amp;</span>
        <span class="c">!$OMP&amp; ri,tracks,ntrack,rates,denn,states,photons,plasma,tind,fi_correction)</span>
        <span class="n">loop_over_cells</span><span class="p">:</span> <span class="k">do </span><span class="n">ic</span><span class="o">=</span><span class="n">istart</span><span class="p">,</span><span class="n">ncell</span><span class="p">,</span><span class="n">istep</span>
            <span class="k">call </span><span class="n">ind2sub</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">cell_ind</span><span class="p">(</span><span class="n">ic</span><span class="p">),</span><span class="n">ind</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span> <span class="n">j</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">loop_over_species</span><span class="p">:</span> <span class="k">do is</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n_thermal</span> <span class="c">!This loop has to come first</span>
                <span class="c">!! Loop over the markers</span>
                <span class="n">loop_over_halos</span><span class="p">:</span> <span class="k">do </span><span class="n">ihalo</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
                    <span class="c">!! Calculate ri,vhalo and track</span>
                    <span class="k">call </span><span class="n">mc_beam_grid</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">ri</span><span class="p">)</span>
                    <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">)</span>
                    <span class="k">call </span><span class="n">mc_halo</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span> <span class="n">thermal_mass</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="n">vihalo</span><span class="p">)</span>
                    <span class="k">call </span><span class="n">track</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">vihalo</span><span class="p">,</span><span class="n">tracks</span><span class="p">,</span><span class="n">ntrack</span><span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">ntrack</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">cycle </span><span class="n">loop_over_halos</span>

                    <span class="c">!! Get plasma parameters at particle location</span>
                    <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">)</span>

                    <span class="c">!! Calculate CX probability</span>
                    <span class="n">tind</span> <span class="o">=</span> <span class="n">tracks</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">ind</span>
                    <span class="n">ii</span> <span class="o">=</span> <span class="n">tind</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">jj</span> <span class="o">=</span> <span class="n">tind</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">kk</span> <span class="o">=</span> <span class="n">tind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                    <span class="k">call </span><span class="n">neutral_cx_rate</span><span class="p">(</span><span class="n">prev_pop</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">),</span> <span class="n">prev_pop</span><span class="p">%</span><span class="n">res</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">),</span> <span class="n">vihalo</span><span class="p">,</span> <span class="n">rates</span><span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span><span class="k">cycle </span><span class="n">loop_over_halos</span>

                    <span class="c">!! Get plasma parameters at mean point in cell</span>
                    <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">tracks</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">pos</span><span class="p">)</span>

                    <span class="c">!! Weight CX rates by ion source density</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">beam_mass</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">thermal_mass</span><span class="p">(</span><span class="k">is</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                        </span><span class="n">states</span> <span class="o">=</span> <span class="n">rates</span><span class="o">*</span><span class="p">(</span><span class="n">plasma</span><span class="p">%</span><span class="n">deni</span><span class="p">(</span><span class="k">is</span><span class="p">)</span> <span class="o">+</span> <span class="n">plasma</span><span class="p">%</span><span class="n">denf</span><span class="p">)</span>
                        <span class="n">fi_correction</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">plasma</span><span class="p">%</span><span class="n">deni</span><span class="p">(</span><span class="k">is</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">plasma</span><span class="p">%</span><span class="n">deni</span><span class="p">(</span><span class="k">is</span><span class="p">)</span><span class="o">+</span><span class="n">plasma</span><span class="p">%</span><span class="n">denf</span><span class="p">),</span><span class="mf">0.d0</span><span class="p">)</span>
                    <span class="k">else</span>
<span class="k">                        </span><span class="n">states</span> <span class="o">=</span> <span class="n">rates</span><span class="o">*</span><span class="n">plasma</span><span class="p">%</span><span class="n">deni</span><span class="p">(</span><span class="k">is</span><span class="p">)</span>
                        <span class="n">fi_correction</span> <span class="o">=</span> <span class="mf">1.d0</span>
                    <span class="k">endif</span>
<span class="k">                    if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">loop_over_halos</span>

                    <span class="n">loop_along_track</span><span class="p">:</span> <span class="k">do </span><span class="n">it</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ntrack</span>
                        <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">tracks</span><span class="p">(</span><span class="n">it</span><span class="p">)%</span><span class="n">pos</span><span class="p">)</span>
                        <span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">plasma</span><span class="p">%</span><span class="n">in_plasma</span><span class="p">)</span> <span class="k">exit </span><span class="n">loop_along_track</span>
                        <span class="k">call </span><span class="n">colrad</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">thermal_mass</span><span class="p">(</span><span class="k">is</span><span class="p">),</span><span class="n">vihalo</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">it</span><span class="p">)%</span><span class="nb">time</span><span class="p">,</span><span class="n">states</span><span class="p">,</span><span class="n">denn</span><span class="p">,</span><span class="n">photons</span><span class="p">)</span>

                        <span class="c">!! Store Neutrals</span>
                        <span class="k">call </span><span class="n">update_neutrals</span><span class="p">(</span><span class="n">cur_pop</span><span class="p">,</span> <span class="n">tracks</span><span class="p">(</span><span class="n">it</span><span class="p">)%</span><span class="n">ind</span><span class="p">,</span> <span class="n">vihalo</span><span class="p">,</span> <span class="n">denn</span><span class="o">/</span><span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>

                        <span class="k">if</span><span class="p">((</span><span class="n">photons</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_halo</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                            </span><span class="n">photons</span> <span class="o">=</span> <span class="n">fi_correction</span><span class="o">*</span><span class="n">photons</span> <span class="c">!! Correct for including fast-ions in states</span>
                            <span class="k">call </span><span class="n">store_photons</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="n">it</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span><span class="n">vihalo</span><span class="p">,</span><span class="n">thermal_lambda0</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="p">&amp;</span>
                                               <span class="n">photons</span><span class="o">/</span><span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">spec</span><span class="p">%</span><span class="n">halo</span><span class="p">(:,:,:,</span><span class="k">is</span><span class="p">),</span><span class="n">spec</span><span class="p">%</span><span class="n">halostokes</span><span class="p">(:,:,:,:,</span><span class="k">is</span><span class="p">))</span>
                        <span class="k">endif</span>
<span class="k">                    enddo </span><span class="n">loop_along_track</span>
                <span class="k">enddo </span><span class="n">loop_over_halos</span>
            <span class="k">enddo </span><span class="n">loop_over_species</span>
        <span class="k">enddo </span><span class="n">loop_over_cells</span>
        <span class="c">!$OMP END PARALLEL DO</span>

<span class="cp">#ifdef _MPI</span>
        <span class="c">!! Combine densities</span>
        <span class="k">call </span><span class="n">parallel_merge_populations</span><span class="p">(</span><span class="n">cur_pop</span><span class="p">)</span>
<span class="cp">#endif</span>
        <span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">cur_type</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">cur_pop</span><span class="p">%</span><span class="n">dens</span><span class="p">)</span>

        <span class="k">if</span><span class="p">(</span><span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">cur_type</span><span class="p">)</span><span class="o">/</span><span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">prev_type</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">1.0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s2">&quot;HALO: Halo generation density exceeded seed density. This shouldn&#39;t happen.&quot;</span>
            <span class="k">exit </span><span class="n">iterations</span>
        <span class="k">endif</span>

        <span class="c">!! Set current generation to previous generation</span>
        <span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">prev_type</span><span class="p">)</span> <span class="o">=</span> <span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">cur_type</span><span class="p">)</span>
        <span class="n">prev_pop</span> <span class="o">=</span> <span class="n">cur_pop</span>

        <span class="c">!! merge current population with halo population</span>
        <span class="k">call </span><span class="n">merge_neutral_populations</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">halo</span><span class="p">,</span> <span class="n">cur_pop</span><span class="p">)</span>

        <span class="n">seed_dcx</span> <span class="o">=</span> <span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">cur_type</span><span class="p">)</span><span class="o">/</span><span class="n">dcx_dens</span>
        <span class="k">if</span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">seed_dcx</span><span class="p">))</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s2">&quot;NAN (Halo generation)/DCX. Exiting...&quot;</span>
            <span class="k">stop</span>
<span class="k">        endif</span>
<span class="k">        </span><span class="n">n_halo</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_halo</span><span class="o">*</span><span class="n">seed_dcx</span><span class="p">,</span><span class="n">Int64</span><span class="p">)</span>

        <span class="k">if</span><span class="p">(</span><span class="n">seed_dcx</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mf">0.01</span><span class="p">)</span> <span class="k">exit </span><span class="n">iterations</span>
    <span class="k">enddo </span><span class="n">iterations</span>

<span class="cp">#ifdef _MPI</span>
    <span class="c">!! Combine Spectra</span>
    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_halo</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">halo</span><span class="p">)</span>
    <span class="k">endif</span>
<span class="cp">#endif</span>

<span class="k">end subroutine </span><span class="n">halo</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2021 
                                          </p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            
            
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>