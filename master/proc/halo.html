<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>halo &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
               
        
        
            </ul>
        
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>



          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>halo
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.9% of total for procedures.">123 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
    
     <li><a href='../module/libfida.html'>libfida</a></li>
    
  
     <li class="active">halo</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/halo.html#src">halo</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine halo()
    
    
   
</h2>
    
  


    
    <p>Calculates halo neutral density and spectra</p>
    

    <h3>Arguments</h3>
    
    <em>None</em>
    <br>
    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~halo~~CallsGraph Pages: 1 -->
<svg id="prochaloCallsGraph" width="641pt" height="978pt"
 viewBox="0.00 0.00 641.00 977.85" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~halo~~CallsGraph" class="graph" transform="scale(0.690733 0.690733) rotate(0) translate(4 1411.67)">
<title>proc~~halo~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1411.67 924,-1411.67 924,4 -4,4"/>
<!-- proc~halo -->
<g id="proc~~halo~~CallsGraph_node1" class="node"><title>proc~halo</title>
<polygon fill="none" stroke="black" points="54,-665 0,-665 0,-641 54,-641 54,-665"/>
<text text-anchor="middle" x="27" y="-650.6" font-family="Helvetica,sans-Serif" font-size="10.50">halo</text>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~halo~~CallsGraph_node2" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~halo~~CallsGraph_node2"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="532.5,-282 459.5,-282 459.5,-258 532.5,-258 532.5,-282"/>
<text text-anchor="middle" x="496" y="-267.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;interface~parallel_sum -->
<g id="proc~~halo~~CallsGraph_edge1" class="edge"><title>proc~halo&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M28.8881,-640.667C32.8225,-589.3 50.2725,-392.934 90,-348 181.173,-244.877 363.785,-252.645 449.103,-262.913"/>
<polygon fill="#000000" stroke="#000000" points="448.895,-266.414 459.257,-264.203 449.778,-259.47 448.895,-266.414"/>
</g>
<!-- proc~neutral_cx_rate -->
<g id="proc~~halo~~CallsGraph_node3" class="node"><title>proc~neutral_cx_rate</title>
<g id="a_proc~~halo~~CallsGraph_node3"><a xlink:href=".././proc/neutral_cx_rate.html" xlink:title="neutral_cx_rate">
<polygon fill="#d9534f" stroke="#d9534f" points="206.5,-947 119.5,-947 119.5,-923 206.5,-923 206.5,-947"/>
<text text-anchor="middle" x="163" y="-932.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutral_cx_rate</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~neutral_cx_rate -->
<g id="proc~~halo~~CallsGraph_edge2" class="edge"><title>proc~halo&#45;&gt;proc~neutral_cx_rate</title>
<path fill="none" stroke="#000000" d="M28.8221,-665.166C31.7172,-700.536 43.9138,-805.31 90,-876 100.846,-892.636 117.869,-906.895 132.64,-917.226"/>
<polygon fill="#000000" stroke="#000000" points="130.759,-920.179 141.013,-922.843 134.659,-914.366 130.759,-920.179"/>
</g>
<!-- proc~mc_halo -->
<g id="proc~~halo~~CallsGraph_node4" class="node"><title>proc~mc_halo</title>
<g id="a_proc~~halo~~CallsGraph_node4"><a xlink:href=".././proc/mc_halo.html" xlink:title="mc_halo">
<polygon fill="#d9534f" stroke="#d9534f" points="190,-1195 136,-1195 136,-1171 190,-1171 190,-1195"/>
<text text-anchor="middle" x="163" y="-1180.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_halo</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~mc_halo -->
<g id="proc~~halo~~CallsGraph_edge3" class="edge"><title>proc~halo&#45;&gt;proc~mc_halo</title>
<path fill="none" stroke="#000000" d="M28.8725,-665.057C33.4809,-727.008 56.067,-1009.71 90,-1090 102.063,-1118.54 125.126,-1145.93 141.908,-1163.5"/>
<polygon fill="#000000" stroke="#000000" points="139.615,-1166.16 149.115,-1170.85 144.613,-1161.25 139.615,-1166.16"/>
</g>
<!-- proc~ind2sub -->
<g id="proc~~halo~~CallsGraph_node5" class="node"><title>proc~ind2sub</title>
<g id="a_proc~~halo~~CallsGraph_node5"><a xlink:href=".././proc/ind2sub.html" xlink:title="ind2sub">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-442 314,-442 314,-418 368,-418 368,-442"/>
<text text-anchor="middle" x="341" y="-427.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ind2sub</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~ind2sub -->
<g id="proc~~halo~~CallsGraph_edge5" class="edge"><title>proc~halo&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M28.9995,-640.86C32.1333,-610.955 44.4711,-533.254 90,-493 106.074,-478.788 238.317,-450.523 303.692,-437.229"/>
<polygon fill="#000000" stroke="#000000" points="304.475,-440.642 313.582,-435.228 303.087,-433.781 304.475,-440.642"/>
</g>
<!-- proc~mc_beam_grid -->
<g id="proc~~halo~~CallsGraph_node6" class="node"><title>proc~mc_beam_grid</title>
<g id="a_proc~~halo~~CallsGraph_node6"><a xlink:href=".././proc/mc_beam_grid.html" xlink:title="mc_beam_grid">
<polygon fill="#d9534f" stroke="#d9534f" points="205,-1382 121,-1382 121,-1358 205,-1358 205,-1382"/>
<text text-anchor="middle" x="163" y="-1367.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_beam_grid</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~mc_beam_grid -->
<g id="proc~~halo~~CallsGraph_edge4" class="edge"><title>proc~halo&#45;&gt;proc~mc_beam_grid</title>
<path fill="none" stroke="#000000" d="M28.0449,-665.267C28.5394,-725.307 33.9344,-993.793 90,-1204 104.537,-1258.5 134.105,-1318.22 150.465,-1349.02"/>
<polygon fill="#000000" stroke="#000000" points="147.456,-1350.81 155.277,-1357.96 153.62,-1347.49 147.456,-1350.81"/>
</g>
<!-- proc~colrad -->
<g id="proc~~halo~~CallsGraph_node7" class="node"><title>proc~colrad</title>
<g id="a_proc~~halo~~CallsGraph_node7"><a xlink:href=".././proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="190,-1081 136,-1081 136,-1057 190,-1057 190,-1081"/>
<text text-anchor="middle" x="163" y="-1066.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~colrad -->
<g id="proc~~halo~~CallsGraph_edge6" class="edge"><title>proc~halo&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M28.8812,-665.007C32.2642,-706.694 46.4893,-848.492 90,-956 104.19,-991.061 129.4,-1027.17 145.907,-1048.85"/>
<polygon fill="#000000" stroke="#000000" points="143.291,-1051.19 152.183,-1056.95 148.825,-1046.9 143.291,-1051.19"/>
</g>
<!-- proc~update_neutrals -->
<g id="proc~~halo~~CallsGraph_node8" class="node"><title>proc~update_neutrals</title>
<g id="a_proc~~halo~~CallsGraph_node8"><a xlink:href=".././proc/update_neutrals.html" xlink:title="update_neutrals">
<polygon fill="#d9534f" stroke="#d9534f" points="208,-626 118,-626 118,-602 208,-602 208,-626"/>
<text text-anchor="middle" x="163" y="-611.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_neutrals</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~update_neutrals -->
<g id="proc~~halo~~CallsGraph_edge7" class="edge"><title>proc~halo&#45;&gt;proc~update_neutrals</title>
<path fill="none" stroke="#000000" d="M54.1547,-645.388C70.3135,-640.685 91.5981,-634.49 110.986,-628.847"/>
<polygon fill="#000000" stroke="#000000" points="111.993,-632.2 120.616,-626.044 110.037,-625.478 111.993,-632.2"/>
</g>
<!-- proc~merge_neutral_populations -->
<g id="proc~~halo~~CallsGraph_node9" class="node"><title>proc~merge_neutral_populations</title>
<g id="a_proc~~halo~~CallsGraph_node9"><a xlink:href=".././proc/merge_neutral_populations.html" xlink:title="merge_neutral_populations">
<polygon fill="#d9534f" stroke="#d9534f" points="234.5,-442 91.5,-442 91.5,-418 234.5,-418 234.5,-442"/>
<text text-anchor="middle" x="163" y="-427.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">merge_neutral_populations</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~merge_neutral_populations -->
<g id="proc~~halo~~CallsGraph_edge8" class="edge"><title>proc~halo&#45;&gt;proc~merge_neutral_populations</title>
<path fill="none" stroke="#000000" d="M28.3875,-640.686C30.1045,-606.931 39.4245,-511.869 90,-458 94.1167,-453.615 99.0004,-449.907 104.256,-446.774"/>
<polygon fill="#000000" stroke="#000000" points="106.128,-449.746 113.383,-442.025 102.896,-443.536 106.128,-449.746"/>
</g>
<!-- proc~track -->
<g id="proc~~halo~~CallsGraph_node10" class="node"><title>proc~track</title>
<g id="a_proc~~halo~~CallsGraph_node10"><a xlink:href=".././proc/track.html" xlink:title="track">
<polygon fill="#d9534f" stroke="#d9534f" points="190,-833 136,-833 136,-809 190,-809 190,-833"/>
<text text-anchor="middle" x="163" y="-818.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~track -->
<g id="proc~~halo~~CallsGraph_edge9" class="edge"><title>proc~halo&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M37.6369,-665.082C60.3188,-693.519 117.286,-764.941 145.558,-800.386"/>
<polygon fill="#000000" stroke="#000000" points="143.117,-802.939 152.089,-808.574 148.589,-798.574 143.117,-802.939"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~halo~~CallsGraph_node11" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~halo~~CallsGraph_node11"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="375,-896 307,-896 307,-872 375,-872 375,-896"/>
<text text-anchor="middle" x="341" y="-881.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~get_plasma -->
<g id="proc~~halo~~CallsGraph_edge10" class="edge"><title>proc~halo&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M27.968,-665.015C28.5805,-698.751 35.2723,-794.948 90,-842 147.844,-891.732 241.965,-893.374 296.721,-889.248"/>
<polygon fill="#000000" stroke="#000000" points="297.131,-892.726 306.798,-888.39 296.537,-885.751 297.131,-892.726"/>
</g>
<!-- proc~store_photons -->
<g id="proc~~halo~~CallsGraph_node12" class="node"><title>proc~store_photons</title>
<g id="a_proc~~halo~~CallsGraph_node12"><a xlink:href=".././proc/store_photons.html" xlink:title="store_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="203.5,-707 122.5,-707 122.5,-683 203.5,-683 203.5,-707"/>
<text text-anchor="middle" x="163" y="-692.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_photons</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~store_photons -->
<g id="proc~~halo~~CallsGraph_edge11" class="edge"><title>proc~halo&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M54.1547,-661.198C71.1073,-666.511 93.7016,-673.593 113.829,-679.902"/>
<polygon fill="#000000" stroke="#000000" points="112.886,-683.274 123.475,-682.925 114.98,-676.594 112.886,-683.274"/>
</g>
<!-- proc~get_nlaunch -->
<g id="proc~~halo~~CallsGraph_node13" class="node"><title>proc~get_nlaunch</title>
<g id="a_proc~~halo~~CallsGraph_node13"><a xlink:href=".././proc/get_nlaunch.html" xlink:title="get_nlaunch">
<polygon fill="#d9534f" stroke="#d9534f" points="198.5,-526 127.5,-526 127.5,-502 198.5,-502 198.5,-526"/>
<text text-anchor="middle" x="163" y="-511.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_nlaunch</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~get_nlaunch -->
<g id="proc~~halo~~CallsGraph_edge12" class="edge"><title>proc~halo&#45;&gt;proc~get_nlaunch</title>
<path fill="none" stroke="#000000" d="M39.8916,-640.665C63.1937,-616.493 115.03,-562.722 143.087,-533.619"/>
<polygon fill="#000000" stroke="#000000" points="145.906,-535.738 150.326,-526.109 140.866,-530.879 145.906,-535.738"/>
</g>
<!-- proc~parallel_merge_populations -->
<g id="proc~~halo~~CallsGraph_node14" class="node"><title>proc~parallel_merge_populations</title>
<g id="a_proc~~halo~~CallsGraph_node14"><a xlink:href=".././proc/parallel_merge_populations.html" xlink:title="parallel_merge_populations">
<polygon fill="#d9534f" stroke="#d9534f" points="235.5,-381 90.5,-381 90.5,-357 235.5,-357 235.5,-381"/>
<text text-anchor="middle" x="163" y="-366.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_merge_populations</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~parallel_merge_populations -->
<g id="proc~~halo~~CallsGraph_edge13" class="edge"><title>proc~halo&#45;&gt;proc~parallel_merge_populations</title>
<path fill="none" stroke="#000000" d="M27.8522,-640.903C27.9963,-602.693 33.1961,-482.758 90,-409 97.498,-399.264 108.076,-391.557 118.82,-385.614"/>
<polygon fill="#000000" stroke="#000000" points="120.498,-388.687 127.821,-381.031 117.322,-382.449 120.498,-388.687"/>
</g>
<!-- proc~init_neutral_population -->
<g id="proc~~halo~~CallsGraph_node15" class="node"><title>proc~init_neutral_population</title>
<g id="a_proc~~halo~~CallsGraph_node15"><a xlink:href=".././proc/init_neutral_population.html" xlink:title="init_neutral_population">
<polygon fill="#d9534f" stroke="#d9534f" points="223.5,-244 102.5,-244 102.5,-220 223.5,-220 223.5,-244"/>
<text text-anchor="middle" x="163" y="-229.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_neutral_population</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~init_neutral_population -->
<g id="proc~~halo~~CallsGraph_edge14" class="edge"><title>proc~halo&#45;&gt;proc~init_neutral_population</title>
<path fill="none" stroke="#000000" d="M28.2867,-640.889C29.9334,-581.184 39.961,-318.632 90,-258 92.6369,-254.805 95.6992,-252.002 99.0442,-249.544"/>
<polygon fill="#000000" stroke="#000000" points="101.18,-252.339 107.86,-244.116 97.5095,-246.379 101.18,-252.339"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~halo~~CallsGraph_node17" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~halo~~CallsGraph_node17"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="803.5,-24 712.5,-24 712.5,-0 803.5,-0 803.5,-24"/>
<text text-anchor="middle" x="758" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~halo~~CallsGraph_edge19" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M497.706,-257.797C500.586,-219.975 514.775,-103.855 582,-47 615.085,-19.0187 664.249,-11.1641 702.049,-9.79675"/>
<polygon fill="#000000" stroke="#000000" points="702.466,-13.2886 712.387,-9.57176 702.313,-6.29027 702.466,-13.2886"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~halo~~CallsGraph_node20" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~halo~~CallsGraph_node20"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-282 583.5,-282 583.5,-258 674.5,-258 674.5,-282"/>
<text text-anchor="middle" x="629" y="-267.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~halo~~CallsGraph_edge22" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.796,-270C545.232,-270 559.48,-270 573.1,-270"/>
<polygon fill="#000000" stroke="#000000" points="573.352,-273.5 583.352,-270 573.352,-266.5 573.352,-273.5"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~halo~~CallsGraph_node21" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~halo~~CallsGraph_node21"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-240 583.5,-240 583.5,-216 674.5,-216 674.5,-240"/>
<text text-anchor="middle" x="629" y="-225.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~halo~~CallsGraph_edge15" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.796,-258.523C547.602,-253.777 564.976,-248.206 580.801,-243.133"/>
<polygon fill="#000000" stroke="#000000" points="581.963,-246.436 590.417,-240.05 579.826,-239.77 581.963,-246.436"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~halo~~CallsGraph_node22" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~halo~~CallsGraph_node22"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="802,-202 714,-202 714,-178 802,-178 802,-202"/>
<text text-anchor="middle" x="758" y="-187.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~halo~~CallsGraph_edge18" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M508.925,-257.767C524.28,-242.885 552.514,-218.346 582,-207 620.894,-192.034 668.074,-188.195 703.642,-187.873"/>
<polygon fill="#000000" stroke="#000000" points="703.816,-191.373 713.816,-187.873 703.816,-184.373 703.816,-191.373"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~halo~~CallsGraph_node32" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~halo~~CallsGraph_node32"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="673,-160 585,-160 585,-136 673,-136 673,-160"/>
<text text-anchor="middle" x="629" y="-145.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~halo~~CallsGraph_edge16" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M505.6,-257.921C519.852,-238.503 549.985,-199.904 582,-174 585.811,-170.917 590.035,-167.988 594.334,-165.283"/>
<polygon fill="#000000" stroke="#000000" points="596.328,-168.17 603.155,-160.068 592.765,-162.144 596.328,-168.17"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~halo~~CallsGraph_node33" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~halo~~CallsGraph_node33"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="673,-80 585,-80 585,-56 673,-56 673,-80"/>
<text text-anchor="middle" x="629" y="-65.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~halo~~CallsGraph_edge17" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M500.112,-257.87C508.538,-227.08 534.425,-144.749 582,-94 584.894,-90.9131 588.238,-88.0945 591.777,-85.5477"/>
<polygon fill="#000000" stroke="#000000" points="593.74,-88.4469 600.265,-80.1003 589.959,-82.5556 593.74,-88.4469"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~halo~~CallsGraph_node37" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~halo~~CallsGraph_node37"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-404 583.5,-404 583.5,-380 674.5,-380 674.5,-404"/>
<text text-anchor="middle" x="629" y="-389.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~halo~~CallsGraph_edge23" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.095,-282.136C529.122,-308.596 579.719,-369.267 582,-371 583.761,-372.338 585.62,-373.616 587.542,-374.832"/>
<polygon fill="#000000" stroke="#000000" points="585.829,-377.884 596.254,-379.772 589.281,-371.795 585.829,-377.884"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~halo~~CallsGraph_node38" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~halo~~CallsGraph_node38"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="802,-104 714,-104 714,-80 802,-80 802,-104"/>
<text text-anchor="middle" x="758" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~halo~~CallsGraph_edge21" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M500.523,-257.679C509.24,-229.566 534.617,-160.538 582,-127 617.484,-101.884 666.64,-93.7858 703.823,-91.5954"/>
<polygon fill="#000000" stroke="#000000" points="704.144,-95.0843 713.971,-91.125 703.82,-88.0919 704.144,-95.0843"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~halo~~CallsGraph_node39" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~halo~~CallsGraph_node39"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-362 583.5,-362 583.5,-338 674.5,-338 674.5,-362"/>
<text text-anchor="middle" x="629" y="-347.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~halo~~CallsGraph_edge24" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515.4,-282.075C532.502,-293.207 558.76,-310.063 582,-324 586.819,-326.89 591.965,-329.885 597.006,-332.77"/>
<polygon fill="#000000" stroke="#000000" points="595.447,-335.91 605.873,-337.797 598.9,-329.82 595.447,-335.91"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_node40" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~halo~~CallsGraph_node40"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="803.5,-320 712.5,-320 712.5,-296 803.5,-296 803.5,-320"/>
<text text-anchor="middle" x="758" y="-305.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_edge20" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.739,-280.056C547.835,-283.983 565.669,-288.205 582,-291 621.809,-297.814 667.216,-302.126 701.799,-304.701"/>
<polygon fill="#000000" stroke="#000000" points="701.942,-308.221 712.167,-305.446 702.443,-301.238 701.942,-308.221"/>
</g>
<!-- proc~bb_cx_rates -->
<g id="proc~~halo~~CallsGraph_node41" class="node"><title>proc~bb_cx_rates</title>
<g id="a_proc~~halo~~CallsGraph_node41"><a xlink:href=".././proc/bb_cx_rates.html" xlink:title="bb_cx_rates">
<polygon fill="#d9534f" stroke="#d9534f" points="376.5,-999 305.5,-999 305.5,-975 376.5,-975 376.5,-999"/>
<text text-anchor="middle" x="341" y="-984.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bb_cx_rates</text>
</a>
</g>
</g>
<!-- proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates -->
<g id="proc~~halo~~CallsGraph_edge25" class="edge"><title>proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates</title>
<path fill="none" stroke="#000000" d="M204.82,-947.061C231.952,-955.077 267.58,-965.603 295.447,-973.837"/>
<polygon fill="#000000" stroke="#000000" points="294.751,-977.281 305.333,-976.758 296.735,-970.567 294.751,-977.281"/>
</g>
<!-- interface~randn -->
<g id="proc~~halo~~CallsGraph_node43" class="node"><title>interface~randn</title>
<g id="a_proc~~halo~~CallsGraph_node43"><a xlink:href=".././interface/randn.html" xlink:title="randn">
<polygon fill="#a7506f" stroke="#a7506f" points="368,-1334 314,-1334 314,-1310 368,-1310 368,-1334"/>
<text text-anchor="middle" x="341" y="-1319.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randn</text>
</a>
</g>
</g>
<!-- proc~mc_halo&#45;&gt;interface~randn -->
<g id="proc~~halo~~CallsGraph_edge26" class="edge"><title>proc~mc_halo&#45;&gt;interface~randn</title>
<path fill="none" stroke="#000000" d="M171.927,-1195.34C187.931,-1219.27 226.484,-1272.17 272,-1301 281.67,-1307.12 293.246,-1311.57 304.083,-1314.74"/>
<polygon fill="#000000" stroke="#000000" points="303.187,-1318.12 313.751,-1317.31 304.987,-1311.36 303.187,-1318.12"/>
</g>
<!-- interface~randu -->
<g id="proc~~halo~~CallsGraph_node44" class="node"><title>interface~randu</title>
<g id="a_proc~~halo~~CallsGraph_node44"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="907,-561 853,-561 853,-537 907,-537 907,-561"/>
<text text-anchor="middle" x="880" y="-546.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~mc_beam_grid&#45;&gt;interface~randu -->
<g id="proc~~halo~~CallsGraph_edge27" class="edge"><title>proc~mc_beam_grid&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M205.143,-1376.96C267.595,-1386.91 390.152,-1404 495,-1404 495,-1404 495,-1404 630,-1404 709.35,-1404 751.779,-1423.74 804,-1364 857.671,-1302.6 875.397,-695.852 878.483,-571.283"/>
<polygon fill="#000000" stroke="#000000" points="881.988,-571.139 878.73,-561.058 874.99,-570.97 881.988,-571.139"/>
</g>
<!-- proc~linsolve -->
<g id="proc~~halo~~CallsGraph_node16" class="node"><title>proc~linsolve</title>
<g id="a_proc~~halo~~CallsGraph_node16"><a xlink:href=".././proc/linsolve.html" xlink:title="linsolve">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-1292 314,-1292 314,-1268 368,-1268 368,-1292"/>
<text text-anchor="middle" x="341" y="-1277.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linsolve</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~linsolve -->
<g id="proc~~halo~~CallsGraph_edge28" class="edge"><title>proc~colrad&#45;&gt;proc~linsolve</title>
<path fill="none" stroke="#000000" d="M174.223,-1081.26C203.454,-1116.3 287.583,-1217.16 323.465,-1260.18"/>
<polygon fill="#000000" stroke="#000000" points="320.875,-1262.54 329.968,-1267.97 326.25,-1258.05 320.875,-1262.54"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~halo~~CallsGraph_node34" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~halo~~CallsGraph_node34"><a xlink:href=".././proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="385,-1047 297,-1047 297,-1023 385,-1023 385,-1047"/>
<text text-anchor="middle" x="341" y="-1032.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~halo~~CallsGraph_edge30" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M190.349,-1063.91C215.702,-1059.01 254.776,-1051.46 286.64,-1045.31"/>
<polygon fill="#000000" stroke="#000000" points="287.551,-1048.7 296.705,-1043.36 286.223,-1041.82 287.551,-1048.7"/>
</g>
<!-- proc~eigen -->
<g id="proc~~halo~~CallsGraph_node46" class="node"><title>proc~eigen</title>
<g id="a_proc~~halo~~CallsGraph_node46"><a xlink:href=".././proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-1145 314,-1145 314,-1121 368,-1121 368,-1145"/>
<text text-anchor="middle" x="341" y="-1130.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~halo~~CallsGraph_edge29" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M190.349,-1078.58C220.635,-1089.59 270.499,-1107.73 304.264,-1120.01"/>
<polygon fill="#000000" stroke="#000000" points="303.165,-1123.33 313.759,-1123.46 305.557,-1116.75 303.165,-1123.33"/>
</g>
<!-- proc~update_reservoir -->
<g id="proc~~halo~~CallsGraph_node19" class="node"><title>proc~update_reservoir</title>
<g id="a_proc~~halo~~CallsGraph_node19"><a xlink:href=".././proc/update_reservoir.html" xlink:title="update_reservoir">
<polygon fill="#d9534f" stroke="#d9534f" points="676,-602 582,-602 582,-578 676,-578 676,-602"/>
<text text-anchor="middle" x="629" y="-587.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_reservoir</text>
</a>
</g>
</g>
<!-- proc~update_neutrals&#45;&gt;proc~update_reservoir -->
<g id="proc~~halo~~CallsGraph_edge31" class="edge"><title>proc~update_neutrals&#45;&gt;proc~update_reservoir</title>
<path fill="none" stroke="#000000" d="M208.07,-611.721C292.779,-607.339 478.203,-597.748 571.711,-592.912"/>
<polygon fill="#000000" stroke="#000000" points="572.023,-596.4 581.829,-592.388 571.662,-589.409 572.023,-596.4"/>
</g>
<!-- proc~merge_neutral_populations&#45;&gt;proc~ind2sub -->
<g id="proc~~halo~~CallsGraph_edge33" class="edge"><title>proc~merge_neutral_populations&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M234.572,-430C258.243,-430 283.666,-430 303.616,-430"/>
<polygon fill="#000000" stroke="#000000" points="303.8,-433.5 313.8,-430 303.8,-426.5 303.8,-433.5"/>
</g>
<!-- proc~merge_reservoirs -->
<g id="proc~~halo~~CallsGraph_node18" class="node"><title>proc~merge_reservoirs</title>
<g id="a_proc~~halo~~CallsGraph_node18"><a xlink:href=".././proc/merge_reservoirs.html" xlink:title="merge_reservoirs">
<polygon fill="#d9534f" stroke="#d9534f" points="544.5,-484 447.5,-484 447.5,-460 544.5,-460 544.5,-484"/>
<text text-anchor="middle" x="496" y="-469.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">merge_reservoirs</text>
</a>
</g>
</g>
<!-- proc~merge_neutral_populations&#45;&gt;proc~merge_reservoirs -->
<g id="proc~~halo~~CallsGraph_edge32" class="edge"><title>proc~merge_neutral_populations&#45;&gt;proc~merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M196.568,-417.878C245.148,-401.814 338.527,-378.82 410,-409 431.137,-417.925 427.644,-432.234 446,-446 450.225,-449.169 454.889,-452.173 459.61,-454.938"/>
<polygon fill="#000000" stroke="#000000" points="458.212,-458.165 468.657,-459.941 461.599,-452.039 458.212,-458.165"/>
</g>
<!-- proc~track&#45;&gt;proc~get_plasma -->
<g id="proc~~halo~~CallsGraph_edge38" class="edge"><title>proc~track&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M190.081,-830.523C203.794,-835.595 220.855,-842.008 236,-848 252.117,-854.377 255.701,-857.103 272,-863 280.1,-865.931 288.832,-868.823 297.25,-871.48"/>
<polygon fill="#000000" stroke="#000000" points="296.345,-874.863 306.932,-874.479 298.416,-868.177 296.345,-874.863"/>
</g>
<!-- proc~get_indices -->
<g id="proc~~halo~~CallsGraph_node23" class="node"><title>proc~get_indices</title>
<g id="a_proc~~halo~~CallsGraph_node23"><a xlink:href=".././proc/get_indices.html" xlink:title="get_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="374.5,-812 307.5,-812 307.5,-788 374.5,-788 374.5,-812"/>
<text text-anchor="middle" x="341" y="-797.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_indices</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~get_indices -->
<g id="proc~~halo~~CallsGraph_edge34" class="edge"><title>proc~track&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M190.349,-817.856C218.68,-814.476 264.143,-809.051 297.534,-805.067"/>
<polygon fill="#000000" stroke="#000000" points="297.962,-808.541 307.477,-803.881 297.133,-801.59 297.962,-808.541"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~halo~~CallsGraph_node25" class="node"><title>proc~get_fields</title>
<g id="a_proc~~halo~~CallsGraph_node25"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="370,-770 312,-770 312,-746 370,-746 370,-770"/>
<text text-anchor="middle" x="341" y="-755.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~get_fields -->
<g id="proc~~halo~~CallsGraph_edge35" class="edge"><title>proc~track&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M190.434,-810.112C212.179,-801.302 243.883,-788.795 272,-779 281.714,-775.616 292.301,-772.212 302.166,-769.159"/>
<polygon fill="#000000" stroke="#000000" points="303.19,-772.506 311.732,-766.237 301.145,-765.812 303.19,-772.506"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~halo~~CallsGraph_node29" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~halo~~CallsGraph_node29"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="526.5,-964 465.5,-964 465.5,-940 526.5,-940 526.5,-964"/>
<text text-anchor="middle" x="496" y="-949.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~in_plasma -->
<g id="proc~~halo~~CallsGraph_edge37" class="edge"><title>proc~track&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M175.718,-833.133C194.323,-851.643 232.568,-886.706 272,-905 332.102,-932.884 408.993,-944.399 454.992,-949.029"/>
<polygon fill="#000000" stroke="#000000" points="454.871,-952.533 465.156,-949.99 455.53,-945.564 454.871,-952.533"/>
</g>
<!-- proc~doppler_stark -->
<g id="proc~~halo~~CallsGraph_node42" class="node"><title>proc~doppler_stark</title>
<g id="a_proc~~halo~~CallsGraph_node42"><a xlink:href=".././proc/doppler_stark.html" xlink:title="doppler_stark">
<polygon fill="#d9534f" stroke="#d9534f" points="380,-854 302,-854 302,-830 380,-830 380,-854"/>
<text text-anchor="middle" x="341" y="-839.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">doppler_stark</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~doppler_stark -->
<g id="proc~~halo~~CallsGraph_edge36" class="edge"><title>proc~track&#45;&gt;proc~doppler_stark</title>
<path fill="none" stroke="#000000" d="M190.349,-824.144C217,-827.324 258.813,-832.313 291.474,-836.21"/>
<polygon fill="#000000" stroke="#000000" points="291.382,-839.724 301.726,-837.433 292.211,-832.773 291.382,-839.724"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~halo~~CallsGraph_edge41" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M369.001,-896.001C393.865,-907.051 430.954,-923.535 458.46,-935.76"/>
<polygon fill="#000000" stroke="#000000" points="457.195,-939.028 467.754,-939.891 460.038,-932.631 457.195,-939.028"/>
</g>
<!-- proc~get_position -->
<g id="proc~~halo~~CallsGraph_node30" class="node"><title>proc~get_position</title>
<g id="a_proc~~halo~~CallsGraph_node30"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="531,-846 461,-846 461,-822 531,-822 531,-846"/>
<text text-anchor="middle" x="496" y="-831.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~halo~~CallsGraph_edge42" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M375.265,-873.94C386.336,-870.535 398.719,-866.665 410,-863 423.353,-858.661 437.829,-853.787 450.986,-849.29"/>
<polygon fill="#000000" stroke="#000000" points="452.426,-852.496 460.749,-845.941 450.155,-845.875 452.426,-852.496"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~halo~~CallsGraph_node31" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~halo~~CallsGraph_node31"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="792,-805 724,-805 724,-781 792,-781 792,-805"/>
<text text-anchor="middle" x="758" y="-790.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~halo~~CallsGraph_edge39" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M375.162,-888.652C448.8,-898.382 623.577,-918.001 676,-893 710.03,-876.771 734.392,-838.486 747.046,-814.274"/>
<polygon fill="#000000" stroke="#000000" points="750.26,-815.672 751.604,-805.163 743.999,-812.54 750.26,-815.672"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~halo~~CallsGraph_node36" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~halo~~CallsGraph_node36"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="663,-884 595,-884 595,-860 663,-860 663,-884"/>
<text text-anchor="middle" x="629" y="-869.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~halo~~CallsGraph_edge40" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M375.087,-882.612C426.858,-880.44 527.026,-876.237 584.547,-873.823"/>
<polygon fill="#000000" stroke="#000000" points="584.925,-877.311 594.769,-873.394 584.631,-870.317 584.925,-877.311"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_indices -->
<g id="proc~~halo~~CallsGraph_edge43" class="edge"><title>proc~store_photons&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M176.56,-707.29C195.67,-725.369 233.87,-759.135 272,-779 279.962,-783.148 288.881,-786.633 297.574,-789.497"/>
<polygon fill="#000000" stroke="#000000" points="296.642,-792.872 307.229,-792.469 298.701,-786.182 296.642,-792.872"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_fields -->
<g id="proc~~halo~~CallsGraph_edge44" class="edge"><title>proc~store_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M193.585,-707.162C215.17,-715.875 245.213,-727.668 272,-737 281.714,-740.384 292.301,-743.788 302.166,-746.841"/>
<polygon fill="#000000" stroke="#000000" points="301.145,-750.188 311.732,-749.763 303.19,-743.494 301.145,-750.188"/>
</g>
<!-- proc~spectrum -->
<g id="proc~~halo~~CallsGraph_node26" class="node"><title>proc~spectrum</title>
<g id="a_proc~~halo~~CallsGraph_node26"><a xlink:href=".././proc/spectrum.html" xlink:title="spectrum">
<polygon fill="#d9534f" stroke="#d9534f" points="369.5,-686 312.5,-686 312.5,-662 369.5,-662 369.5,-686"/>
<text text-anchor="middle" x="341" y="-671.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spectrum</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~spectrum -->
<g id="proc~~halo~~CallsGraph_edge45" class="edge"><title>proc~store_photons&#45;&gt;proc~spectrum</title>
<path fill="none" stroke="#000000" d="M203.937,-690.235C233.384,-686.721 273.188,-681.972 302.134,-678.518"/>
<polygon fill="#000000" stroke="#000000" points="302.752,-681.969 312.267,-677.309 301.923,-675.019 302.752,-681.969"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~halo~~CallsGraph_edge47" class="edge"><title>proc~store_photons&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M187.689,-682.83C209.079,-672.569 241.747,-658.675 272,-653 360.238,-636.446 598.23,-608.147 676,-653 720.146,-678.461 742.408,-738.182 751.628,-770.792"/>
<polygon fill="#000000" stroke="#000000" points="748.316,-771.958 754.267,-780.723 755.081,-770.159 748.316,-771.958"/>
</g>
<!-- proc~get_passive_grid_indices -->
<g id="proc~~halo~~CallsGraph_node45" class="node"><title>proc~get_passive_grid_indices</title>
<g id="a_proc~~halo~~CallsGraph_node45"><a xlink:href=".././proc/get_passive_grid_indices.html" xlink:title="get_passive_grid_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="407.5,-728 274.5,-728 274.5,-704 407.5,-704 407.5,-728"/>
<text text-anchor="middle" x="341" y="-713.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_passive_grid_indices</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_passive_grid_indices -->
<g id="proc~~halo~~CallsGraph_edge46" class="edge"><title>proc~store_photons&#45;&gt;proc~get_passive_grid_indices</title>
<path fill="none" stroke="#000000" d="M203.937,-699.765C221.805,-701.897 243.485,-704.484 264.24,-706.96"/>
<polygon fill="#000000" stroke="#000000" points="263.989,-710.455 274.333,-708.165 264.818,-703.505 263.989,-710.455"/>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~ind2sub -->
<g id="proc~~halo~~CallsGraph_edge48" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M198.688,-503.689C210.993,-499.225 224.604,-493.322 236,-486 254.774,-473.937 252.808,-462.385 272,-451 281.744,-445.22 293.232,-440.886 303.964,-437.704"/>
<polygon fill="#000000" stroke="#000000" points="305.207,-440.994 313.941,-434.997 303.373,-434.238 305.207,-440.994"/>
</g>
<!-- proc~cumsum -->
<g id="proc~~halo~~CallsGraph_node24" class="node"><title>proc~cumsum</title>
<g id="a_proc~~halo~~CallsGraph_node24"><a xlink:href=".././proc/cumsum.html" xlink:title="cumsum">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-484 314,-484 314,-460 368,-460 368,-484"/>
<text text-anchor="middle" x="341" y="-469.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cumsum</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~cumsum -->
<g id="proc~~halo~~CallsGraph_edge50" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~cumsum</title>
<path fill="none" stroke="#000000" d="M198.772,-505.702C229.194,-498.442 273.209,-487.939 303.992,-480.593"/>
<polygon fill="#000000" stroke="#000000" points="304.971,-483.958 313.886,-478.232 303.346,-477.149 304.971,-483.958"/>
</g>
<!-- interface~randind_cdf -->
<g id="proc~~halo~~CallsGraph_node27" class="node"><title>interface~randind_cdf</title>
<g id="a_proc~~halo~~CallsGraph_node27"><a xlink:href=".././interface/randind_cdf.html" xlink:title="randind_cdf">
<polygon fill="#a7506f" stroke="#a7506f" points="375.5,-568 306.5,-568 306.5,-544 375.5,-544 375.5,-568"/>
<text text-anchor="middle" x="341" y="-553.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind_cdf</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;interface~randind_cdf -->
<g id="proc~~halo~~CallsGraph_edge51" class="edge"><title>proc~get_nlaunch&#45;&gt;interface~randind_cdf</title>
<path fill="none" stroke="#000000" d="M198.772,-522.298C226.853,-528.999 266.518,-538.465 296.666,-545.659"/>
<polygon fill="#000000" stroke="#000000" points="295.955,-549.088 306.494,-548.004 297.58,-542.279 295.955,-549.088"/>
</g>
<!-- proc~rng_init -->
<g id="proc~~halo~~CallsGraph_node35" class="node"><title>proc~rng_init</title>
<g id="a_proc~~halo~~CallsGraph_node35"><a xlink:href=".././proc/rng_init.html" xlink:title="rng_init">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-526 314,-526 314,-502 368,-502 368,-526"/>
<text text-anchor="middle" x="341" y="-511.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rng_init</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~rng_init -->
<g id="proc~~halo~~CallsGraph_edge49" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~rng_init</title>
<path fill="none" stroke="#000000" d="M198.772,-514C229.061,-514 272.827,-514 303.59,-514"/>
<polygon fill="#000000" stroke="#000000" points="303.886,-517.5 313.886,-514 303.885,-510.5 303.886,-517.5"/>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;interface~parallel_sum -->
<g id="proc~~halo~~CallsGraph_edge52" class="edge"><title>proc~parallel_merge_populations&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M194.453,-356.829C215.941,-348.462 245.504,-337.39 272,-329 332.695,-309.78 404.005,-291.678 449.34,-280.718"/>
<polygon fill="#000000" stroke="#000000" points="450.259,-284.097 459.164,-278.356 448.623,-277.291 450.259,-284.097"/>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;proc~ind2sub -->
<g id="proc~~halo~~CallsGraph_edge54" class="edge"><title>proc~parallel_merge_populations&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M198.772,-381.052C229.326,-391.641 273.592,-406.984 304.393,-417.659"/>
<polygon fill="#000000" stroke="#000000" points="303.291,-420.981 313.886,-420.949 305.583,-414.367 303.291,-420.981"/>
</g>
<!-- proc~parallel_merge_reservoirs -->
<g id="proc~~halo~~CallsGraph_node28" class="node"><title>proc~parallel_merge_reservoirs</title>
<g id="a_proc~~halo~~CallsGraph_node28"><a xlink:href=".././proc/parallel_merge_reservoirs.html" xlink:title="parallel_merge_reservoirs">
<polygon fill="#d9534f" stroke="#d9534f" points="409.5,-362 272.5,-362 272.5,-338 409.5,-338 409.5,-362"/>
<text text-anchor="middle" x="341" y="-347.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_merge_reservoirs</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;proc~parallel_merge_reservoirs -->
<g id="proc~~halo~~CallsGraph_edge53" class="edge"><title>proc~parallel_merge_populations&#45;&gt;proc~parallel_merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M235.586,-361.272C244.437,-360.316 253.517,-359.336 262.452,-358.372"/>
<polygon fill="#000000" stroke="#000000" points="262.891,-361.845 272.457,-357.292 262.139,-354.885 262.891,-361.845"/>
</g>
<!-- proc~matinv -->
<g id="proc~~halo~~CallsGraph_node50" class="node"><title>proc~matinv</title>
<g id="a_proc~~halo~~CallsGraph_node50"><a xlink:href=".././proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="523,-1376 469,-1376 469,-1352 523,-1352 523,-1376"/>
<text text-anchor="middle" x="496" y="-1361.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~linsolve&#45;&gt;proc~matinv -->
<g id="proc~~halo~~CallsGraph_edge57" class="edge"><title>proc~linsolve&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M368.031,-1284.44C381.364,-1287.57 397.398,-1292.73 410,-1301 430.553,-1314.49 426.186,-1328.45 446,-1343 450.182,-1346.07 454.882,-1348.81 459.673,-1351.2"/>
<polygon fill="#000000" stroke="#000000" points="458.334,-1354.44 468.886,-1355.39 461.233,-1348.07 458.334,-1354.44"/>
</g>
<!-- dgetrs -->
<g id="proc~~halo~~CallsGraph_node54" class="node"><title>dgetrs</title>
<polygon fill="#777777" stroke="#777777" points="523,-1334 469,-1334 469,-1310 523,-1310 523,-1334"/>
<text text-anchor="middle" x="496" y="-1319.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrs</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrs -->
<g id="proc~~halo~~CallsGraph_edge56" class="edge"><title>proc~linsolve&#45;&gt;dgetrs</title>
<path fill="none" stroke="#000000" d="M368.302,-1287.22C393.337,-1294.09 431.213,-1304.49 459.034,-1312.13"/>
<polygon fill="#000000" stroke="#000000" points="458.216,-1315.53 468.786,-1314.8 460.069,-1308.78 458.216,-1315.53"/>
</g>
<!-- dgetrf -->
<g id="proc~~halo~~CallsGraph_node59" class="node"><title>dgetrf</title>
<polygon fill="#777777" stroke="#777777" points="523,-1292 469,-1292 469,-1268 523,-1268 523,-1292"/>
<text text-anchor="middle" x="496" y="-1277.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrf</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrf -->
<g id="proc~~halo~~CallsGraph_edge55" class="edge"><title>proc~linsolve&#45;&gt;dgetrf</title>
<path fill="none" stroke="#000000" d="M368.302,-1280C393.227,-1280 430.881,-1280 458.667,-1280"/>
<polygon fill="#000000" stroke="#000000" points="458.786,-1283.5 468.786,-1280 458.786,-1276.5 458.786,-1283.5"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_node51" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="919.5,-222 840.5,-222 840.5,-198 919.5,-198 919.5,-222"/>
<text text-anchor="middle" x="880" y="-207.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge58" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M786.276,-24.0585C792.683,-27.8313 799.071,-32.4819 804,-38 844.119,-82.9175 865.407,-152.662 874.14,-187.949"/>
<polygon fill="#000000" stroke="#000000" points="870.745,-188.803 876.453,-197.728 877.557,-187.191 870.745,-188.803"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;proc~update_reservoir -->
<g id="proc~~halo~~CallsGraph_edge62" class="edge"><title>proc~merge_reservoirs&#45;&gt;proc~update_reservoir</title>
<path fill="none" stroke="#000000" d="M533.655,-484.115C538.139,-486.594 542.4,-489.533 546,-493 572.919,-518.929 555.386,-542.759 582,-569 583.094,-570.079 584.253,-571.108 585.464,-572.09"/>
<polygon fill="#000000" stroke="#000000" points="583.806,-575.193 594.051,-577.895 587.727,-569.395 583.806,-575.193"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;interface~randu -->
<g id="proc~~halo~~CallsGraph_edge60" class="edge"><title>proc~merge_reservoirs&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M544.565,-479.662C605.105,-489.683 712.785,-508.402 804,-529 816.734,-531.876 830.571,-535.439 842.852,-538.757"/>
<polygon fill="#000000" stroke="#000000" points="842.174,-542.201 852.743,-541.467 844.024,-535.449 842.174,-542.201"/>
</g>
<!-- float -->
<g id="proc~~halo~~CallsGraph_node63" class="node"><title>float</title>
<polygon fill="#777777" stroke="#777777" points="656,-560 602,-560 602,-536 656,-536 656,-560"/>
<text text-anchor="middle" x="629" y="-545.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">float</text>
</g>
<!-- proc~merge_reservoirs&#45;&gt;float -->
<g id="proc~~halo~~CallsGraph_edge59" class="edge"><title>proc~merge_reservoirs&#45;&gt;float</title>
<path fill="none" stroke="#000000" d="M528.739,-484.094C534.621,-486.754 540.607,-489.756 546,-493 563.606,-503.59 565,-510.462 582,-522 586.348,-524.951 591.053,-527.883 595.738,-530.657"/>
<polygon fill="#000000" stroke="#000000" points="594.208,-533.814 604.623,-535.76 597.695,-527.744 594.208,-533.814"/>
</g>
<!-- proc~init_reservoir -->
<g id="proc~~halo~~CallsGraph_node66" class="node"><title>proc~init_reservoir</title>
<g id="a_proc~~halo~~CallsGraph_node66"><a xlink:href=".././proc/init_reservoir.html" xlink:title="init_reservoir">
<polygon fill="#d9534f" stroke="#d9534f" points="795,-480 721,-480 721,-456 795,-456 795,-480"/>
<text text-anchor="middle" x="758" y="-465.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_reservoir</text>
</a>
</g>
</g>
<!-- proc~merge_reservoirs&#45;&gt;proc~init_reservoir -->
<g id="proc~~halo~~CallsGraph_edge61" class="edge"><title>proc~merge_reservoirs&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M544.688,-471.266C591.982,-470.539 663.966,-469.431 710.751,-468.712"/>
<polygon fill="#000000" stroke="#000000" points="710.967,-472.209 720.912,-468.555 710.859,-465.21 710.967,-472.209"/>
</g>
<!-- proc~update_reservoir&#45;&gt;interface~randu -->
<g id="proc~~halo~~CallsGraph_edge64" class="edge"><title>proc~update_reservoir&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M676.132,-587.191C711.397,-584.508 761.088,-579.567 804,-571 816.891,-568.426 830.766,-564.65 843.034,-560.95"/>
<polygon fill="#000000" stroke="#000000" points="844.39,-564.194 852.904,-557.888 842.316,-557.508 844.39,-564.194"/>
</g>
<!-- interface~randind -->
<g id="proc~~halo~~CallsGraph_node58" class="node"><title>interface~randind</title>
<g id="a_proc~~halo~~CallsGraph_node58"><a xlink:href=".././interface/randind.html" xlink:title="randind">
<polygon fill="#a7506f" stroke="#a7506f" points="785,-562 731,-562 731,-538 785,-538 785,-562"/>
<text text-anchor="middle" x="758" y="-547.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind</text>
</a>
</g>
</g>
<!-- proc~update_reservoir&#45;&gt;interface~randind -->
<g id="proc~~halo~~CallsGraph_edge63" class="edge"><title>proc~update_reservoir&#45;&gt;interface~randind</title>
<path fill="none" stroke="#000000" d="M668.104,-577.999C684.925,-572.701 704.592,-566.506 721.145,-561.293"/>
<polygon fill="#000000" stroke="#000000" points="722.509,-564.533 730.996,-558.19 720.406,-557.856 722.509,-564.533"/>
</g>
<!-- proc~update_reservoir&#45;&gt;proc~init_reservoir -->
<g id="proc~~halo~~CallsGraph_edge65" class="edge"><title>proc~update_reservoir&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M661.813,-577.86C666.793,-575.3 671.705,-572.344 676,-569 691.468,-556.956 723.464,-514.433 742.282,-488.558"/>
<polygon fill="#000000" stroke="#000000" points="745.318,-490.332 748.34,-480.178 739.645,-486.231 745.318,-490.332"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_edge66" class="edge"><title>proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M670.184,-282.023C681.881,-285.524 694.805,-289.39 707.027,-293.047"/>
<polygon fill="#000000" stroke="#000000" points="706.058,-296.411 716.642,-295.924 708.065,-289.705 706.058,-296.411"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge67" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M674.593,-261.641C709.895,-254.754 760.351,-244.31 804,-233 813.101,-230.642 822.747,-227.883 831.983,-225.111"/>
<polygon fill="#000000" stroke="#000000" points="833.255,-228.382 841.798,-222.116 831.212,-221.687 833.255,-228.382"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_edge68" class="edge"><title>proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M658.673,-240.008C664.517,-242.754 670.543,-245.811 676,-249 696.658,-261.073 718.498,-277.203 734.287,-289.545"/>
<polygon fill="#000000" stroke="#000000" points="732.378,-292.498 742.391,-295.963 736.724,-287.011 732.378,-292.498"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge69" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M674.516,-224.782C718.251,-221.62 784.821,-216.808 830.031,-213.54"/>
<polygon fill="#000000" stroke="#000000" points="830.464,-217.018 840.186,-212.806 829.959,-210.036 830.464,-217.018"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge70" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M802.323,-197.22C811.298,-198.716 820.813,-200.302 829.976,-201.829"/>
<polygon fill="#000000" stroke="#000000" points="829.683,-205.329 840.122,-203.52 830.834,-198.424 829.683,-205.329"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~halo~~CallsGraph_edge72" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M370.033,-761.333C383.413,-764.157 398.888,-769.372 410,-779 438.247,-803.475 429.573,-821.428 446,-855 458.84,-881.241 474.074,-911.224 484.108,-930.823"/>
<polygon fill="#000000" stroke="#000000" points="481.034,-932.499 488.712,-939.8 487.262,-929.305 481.034,-932.499"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~halo~~CallsGraph_edge73" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M370.077,-764.11C382.719,-767.498 397.564,-772.386 410,-779 428.139,-788.648 428.848,-796.689 446,-808 450.723,-811.115 455.859,-814.169 460.97,-817.027"/>
<polygon fill="#000000" stroke="#000000" points="459.585,-820.257 470.047,-821.929 462.911,-814.097 459.585,-820.257"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~halo~~CallsGraph_edge75" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M370.075,-759.431C409.431,-761.518 483.229,-765.73 546,-771 604.148,-775.882 671.141,-783.148 713.757,-787.977"/>
<polygon fill="#000000" stroke="#000000" points="713.451,-791.465 723.783,-789.119 714.243,-784.509 713.451,-791.465"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~halo~~CallsGraph_edge74" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M370.271,-760.72C411.478,-765.724 489.297,-779.173 546,-813 565.979,-824.919 563.07,-837.476 582,-851 583.857,-852.327 585.812,-853.601 587.825,-854.819"/>
<polygon fill="#000000" stroke="#000000" points="586.451,-858.057 596.902,-859.793 589.814,-851.918 586.451,-858.057"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~halo~~CallsGraph_node52" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~halo~~CallsGraph_node52"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="546,-728 446,-728 446,-704 546,-704 546,-728"/>
<text text-anchor="middle" x="496" y="-713.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~halo~~CallsGraph_edge71" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M370.063,-750.297C390.004,-744.822 417.405,-737.301 441.465,-730.696"/>
<polygon fill="#000000" stroke="#000000" points="442.475,-734.048 451.192,-728.026 440.622,-727.298 442.475,-734.048"/>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;interface~parallel_sum -->
<g id="proc~~halo~~CallsGraph_edge76" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M377.523,-337.955C388.16,-333.941 399.723,-329.164 410,-324 430.958,-313.47 453.293,-299.147 469.807,-287.898"/>
<polygon fill="#000000" stroke="#000000" points="472.096,-290.57 478.336,-282.008 468.118,-284.81 472.096,-290.57"/>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~merge_reservoirs -->
<g id="proc~~halo~~CallsGraph_edge78" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M387.445,-362.037C395.57,-365.61 403.504,-370.181 410,-376 436.058,-399.343 421.422,-421.104 446,-446 449.168,-449.209 452.817,-452.114 456.665,-454.719"/>
<polygon fill="#000000" stroke="#000000" points="454.928,-457.759 465.295,-459.944 458.553,-451.771 454.928,-457.759"/>
</g>
<!-- proc~my_rank -->
<g id="proc~~halo~~CallsGraph_node49" class="node"><title>proc~my_rank</title>
<g id="a_proc~~halo~~CallsGraph_node49"><a xlink:href=".././proc/my_rank.html" xlink:title="my_rank">
<polygon fill="#d94e8f" stroke="#d94e8f" points="523,-526 469,-526 469,-502 523,-502 523,-526"/>
<text text-anchor="middle" x="496" y="-511.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">my_rank</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~my_rank -->
<g id="proc~~halo~~CallsGraph_edge77" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~my_rank</title>
<path fill="none" stroke="#000000" d="M359.912,-362.014C374.928,-372.835 396.086,-389.937 410,-409 433.947,-441.808 417.279,-464.279 446,-493 449.927,-496.927 454.704,-500.166 459.718,-502.825"/>
<polygon fill="#000000" stroke="#000000" points="458.316,-506.033 468.866,-507.007 461.227,-499.666 458.316,-506.033"/>
</g>
<!-- proc~num_ranks -->
<g id="proc~~halo~~CallsGraph_node65" class="node"><title>proc~num_ranks</title>
<g id="a_proc~~halo~~CallsGraph_node65"><a xlink:href=".././proc/num_ranks.html" xlink:title="num_ranks">
<polygon fill="#d94e8f" stroke="#d94e8f" points="529,-362 463,-362 463,-338 529,-338 529,-362"/>
<text text-anchor="middle" x="496" y="-347.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">num_ranks</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~num_ranks -->
<g id="proc~~halo~~CallsGraph_edge79" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~num_ranks</title>
<path fill="none" stroke="#000000" d="M409.553,-350C424.208,-350 439.306,-350 452.658,-350"/>
<polygon fill="#000000" stroke="#000000" points="452.95,-353.5 462.949,-350 452.949,-346.5 452.95,-353.5"/>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~init_reservoir -->
<g id="proc~~halo~~CallsGraph_edge80" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M384.462,-362.074C462.913,-384.38 629.936,-431.871 710.981,-454.915"/>
<polygon fill="#000000" stroke="#000000" points="710.319,-458.365 720.895,-457.734 712.233,-451.632 710.319,-458.365"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~halo~~CallsGraph_edge81" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M516.896,-939.85C538.953,-926.38 574.706,-904.546 599.679,-889.296"/>
<polygon fill="#000000" stroke="#000000" points="601.636,-892.201 608.346,-884.002 597.987,-886.227 601.636,-892.201"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~halo~~CallsGraph_node57" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~halo~~CallsGraph_node57"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="667.5,-1004 590.5,-1004 590.5,-980 667.5,-980 667.5,-1004"/>
<text text-anchor="middle" x="629" y="-989.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~halo~~CallsGraph_edge83" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M526.726,-961.077C542.649,-965.939 562.642,-972.043 580.648,-977.541"/>
<polygon fill="#000000" stroke="#000000" points="579.822,-980.949 590.409,-980.522 581.867,-974.254 579.822,-980.949"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~halo~~CallsGraph_node64" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~halo~~CallsGraph_node64"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="790.5,-902 725.5,-902 725.5,-878 790.5,-878 790.5,-902"/>
<text text-anchor="middle" x="758" y="-887.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~halo~~CallsGraph_edge82" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M526.666,-950.185C562.606,-947.42 624.713,-940.816 676,-926 692.736,-921.165 710.51,-913.567 725.131,-906.594"/>
<polygon fill="#000000" stroke="#000000" points="726.796,-909.676 734.241,-902.138 723.72,-903.388 726.796,-909.676"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~halo~~CallsGraph_node60" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~halo~~CallsGraph_node60"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="660,-842 598,-842 598,-818 660,-818 660,-842"/>
<text text-anchor="middle" x="629" y="-827.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~halo~~CallsGraph_edge84" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M531.077,-832.959C548.314,-832.433 569.356,-831.791 587.425,-831.239"/>
<polygon fill="#000000" stroke="#000000" points="587.78,-834.73 597.668,-830.926 587.566,-827.733 587.78,-834.73"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~halo~~CallsGraph_edge85" class="edge"><title>proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M657.245,-135.987C675.617,-127.885 700.079,-117.099 720.181,-108.235"/>
<polygon fill="#000000" stroke="#000000" points="721.624,-111.424 729.362,-104.187 718.8,-105.019 721.624,-111.424"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge86" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M673.155,-148.686C708.966,-150.318 760.827,-155.161 804,-169 821.156,-174.499 838.908,-184.004 852.832,-192.478"/>
<polygon fill="#000000" stroke="#000000" points="851.054,-195.494 861.384,-197.845 854.775,-189.565 851.054,-195.494"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~halo~~CallsGraph_edge87" class="edge"><title>proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M673.351,-76.1923C683.16,-78.0459 693.684,-80.0347 703.844,-81.9549"/>
<polygon fill="#000000" stroke="#000000" points="703.368,-85.4268 713.844,-83.8446 704.668,-78.5485 703.368,-85.4268"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge88" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M673.025,-57.3305C710.427,-50.5699 764.639,-47.0504 804,-71 846.513,-96.8675 866.442,-155.916 874.442,-188.1"/>
<polygon fill="#000000" stroke="#000000" points="871.045,-188.947 876.713,-197.898 877.864,-187.366 871.045,-188.947"/>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~halo~~CallsGraph_edge89" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M385.127,-1028.52C437.61,-1020.63 525.941,-1007.34 580.378,-999.16"/>
<polygon fill="#000000" stroke="#000000" points="581.094,-1002.59 590.462,-997.644 580.053,-995.67 581.094,-1002.59"/>
</g>
<!-- proc~rng_init&#45;&gt;proc~my_rank -->
<g id="proc~~halo~~CallsGraph_edge91" class="edge"><title>proc~rng_init&#45;&gt;proc~my_rank</title>
<path fill="none" stroke="#000000" d="M368.302,-514C393.227,-514 430.881,-514 458.667,-514"/>
<polygon fill="#000000" stroke="#000000" points="458.786,-517.5 468.786,-514 458.786,-510.5 458.786,-517.5"/>
</g>
<!-- proc~rng_seed -->
<g id="proc~~halo~~CallsGraph_node53" class="node"><title>proc~rng_seed</title>
<g id="a_proc~~halo~~CallsGraph_node53"><a xlink:href=".././proc/rng_seed.html" xlink:title="rng_seed">
<polygon fill="#d94e8f" stroke="#d94e8f" points="525,-568 467,-568 467,-544 525,-544 525,-568"/>
<text text-anchor="middle" x="496" y="-553.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rng_seed</text>
</a>
</g>
</g>
<!-- proc~rng_init&#45;&gt;proc~rng_seed -->
<g id="proc~~halo~~CallsGraph_edge90" class="edge"><title>proc~rng_init&#45;&gt;proc~rng_seed</title>
<path fill="none" stroke="#000000" d="M368.302,-521.22C392.804,-527.946 429.607,-538.049 457.245,-545.636"/>
<polygon fill="#000000" stroke="#000000" points="456.402,-549.034 466.972,-548.306 458.255,-542.284 456.402,-549.034"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_edge92" class="edge"><title>proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M659.239,-379.894C664.923,-377.197 670.744,-374.184 676,-371 697.54,-357.952 719.989,-340.104 735.776,-326.736"/>
<polygon fill="#000000" stroke="#000000" points="738.078,-329.373 743.384,-320.203 733.517,-324.063 738.078,-329.373"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge93" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M674.656,-397.888C712.596,-400.45 766.683,-398.064 804,-371 850.374,-337.367 868.939,-267.758 875.634,-232.103"/>
<polygon fill="#000000" stroke="#000000" points="879.091,-232.655 877.349,-222.205 872.193,-231.461 879.091,-232.655"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~halo~~CallsGraph_edge94" class="edge"><title>proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M737.828,-104.014C730.784,-112.972 737.508,-122 758,-122 770.487,-122 777.862,-118.647 780.124,-114.001"/>
<polygon fill="#000000" stroke="#000000" points="783.526,-113.157 778.172,-104.014 776.656,-114.5 783.526,-113.157"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge95" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M771.623,-104.313C780.652,-113.127 793.087,-125.281 804,-136 822.892,-154.556 844.401,-175.789 859.526,-190.738"/>
<polygon fill="#000000" stroke="#000000" points="857.233,-193.393 866.806,-197.935 862.155,-188.415 857.233,-193.393"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_edge96" class="edge"><title>proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M666.393,-337.964C680.21,-333.395 696.134,-328.129 710.741,-323.298"/>
<polygon fill="#000000" stroke="#000000" points="712.206,-326.5 720.602,-320.037 710.008,-319.854 712.206,-326.5"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge97" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M674.841,-360.939C712.141,-367.441 765.213,-370.439 804,-347 845.727,-321.784 865.837,-264.408 874.112,-232.486"/>
<polygon fill="#000000" stroke="#000000" points="877.614,-232.893 876.561,-222.35 870.81,-231.248 877.614,-232.893"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_edge98" class="edge"><title>proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M737.828,-320.014C730.784,-328.972 737.508,-338 758,-338 770.487,-338 777.862,-334.647 780.124,-330.001"/>
<polygon fill="#000000" stroke="#000000" points="783.526,-329.157 778.172,-320.014 776.656,-330.5 783.526,-329.157"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge99" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M782.572,-295.8C789.686,-291.747 797.364,-286.987 804,-282 825.135,-266.117 846.636,-244.84 861.167,-229.54"/>
<polygon fill="#000000" stroke="#000000" points="863.811,-231.837 868.091,-222.144 858.701,-227.052 863.811,-231.837"/>
</g>
<!-- proc~bb_cx_rates&#45;&gt;interface~interpol_coeff -->
<g id="proc~~halo~~CallsGraph_edge100" class="edge"><title>proc~bb_cx_rates&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M376.783,-987.608C427.655,-988.497 522.531,-990.156 580.008,-991.161"/>
<polygon fill="#000000" stroke="#000000" points="580.226,-994.665 590.286,-991.341 580.349,-987.666 580.226,-994.665"/>
</g>
<!-- proc~xyz_to_cyl -->
<g id="proc~~halo~~CallsGraph_node47" class="node"><title>proc~xyz_to_cyl</title>
<g id="a_proc~~halo~~CallsGraph_node47"><a xlink:href=".././proc/xyz_to_cyl.html" xlink:title="xyz_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="527,-686 465,-686 465,-662 527,-662 527,-686"/>
<text text-anchor="middle" x="496" y="-671.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_cyl</text>
</a>
</g>
</g>
<!-- proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl -->
<g id="proc~~halo~~CallsGraph_edge101" class="edge"><title>proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl</title>
<path fill="none" stroke="#000000" d="M385.844,-703.964C407.646,-697.98 433.804,-690.799 455.047,-684.967"/>
<polygon fill="#000000" stroke="#000000" points="456.017,-688.331 464.734,-682.308 454.164,-681.581 456.017,-688.331"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~halo~~CallsGraph_node48" class="node"><title>proc~hqr2</title>
<g id="a_proc~~halo~~CallsGraph_node48"><a xlink:href=".././proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="523,-1250 469,-1250 469,-1226 523,-1226 523,-1250"/>
<text text-anchor="middle" x="496" y="-1235.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~halo~~CallsGraph_edge102" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M354.594,-1145.11C373.336,-1162.67 410.214,-1195.44 446,-1217 450.237,-1219.55 454.839,-1221.95 459.471,-1224.16"/>
<polygon fill="#000000" stroke="#000000" points="458.354,-1227.49 468.911,-1228.38 461.214,-1221.1 458.354,-1227.49"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~halo~~CallsGraph_node55" class="node"><title>proc~elmhes</title>
<g id="a_proc~~halo~~CallsGraph_node55"><a xlink:href=".././proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="523,-1166 469,-1166 469,-1142 523,-1142 523,-1166"/>
<text text-anchor="middle" x="496" y="-1151.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~halo~~CallsGraph_edge103" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M368.302,-1136.61C393.227,-1140.03 430.881,-1145.2 458.667,-1149.01"/>
<polygon fill="#000000" stroke="#000000" points="458.403,-1152.51 468.786,-1150.4 459.355,-1145.57 458.403,-1152.51"/>
</g>
<!-- proc~balance -->
<g id="proc~~halo~~CallsGraph_node56" class="node"><title>proc~balance</title>
<g id="a_proc~~halo~~CallsGraph_node56"><a xlink:href=".././proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="523,-1208 469,-1208 469,-1184 523,-1184 523,-1208"/>
<text text-anchor="middle" x="496" y="-1193.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~halo~~CallsGraph_edge104" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M368.302,-1143.83C393.447,-1154.18 431.546,-1169.87 459.399,-1181.34"/>
<polygon fill="#000000" stroke="#000000" points="458.207,-1184.63 468.786,-1185.21 460.872,-1178.16 458.207,-1184.63"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~halo~~CallsGraph_node61" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~halo~~CallsGraph_node61"><a xlink:href=".././proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="523,-1124 469,-1124 469,-1100 523,-1100 523,-1124"/>
<text text-anchor="middle" x="496" y="-1109.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~halo~~CallsGraph_edge105" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M368.302,-1129.39C393.227,-1125.97 430.881,-1120.8 458.667,-1116.99"/>
<polygon fill="#000000" stroke="#000000" points="459.355,-1120.43 468.786,-1115.6 458.403,-1113.49 459.355,-1120.43"/>
</g>
<!-- proc~balback -->
<g id="proc~~halo~~CallsGraph_node62" class="node"><title>proc~balback</title>
<g id="a_proc~~halo~~CallsGraph_node62"><a xlink:href=".././proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="523,-1082 469,-1082 469,-1058 523,-1058 523,-1082"/>
<text text-anchor="middle" x="496" y="-1067.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~halo~~CallsGraph_edge106" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M368.302,-1122.17C393.447,-1111.82 431.546,-1096.13 459.399,-1084.66"/>
<polygon fill="#000000" stroke="#000000" points="460.872,-1087.84 468.786,-1080.79 458.207,-1081.37 460.872,-1087.84"/>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~halo~~CallsGraph_edge107" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M527.137,-681.735C534.19,-684.827 541.073,-689.107 546,-695 591.641,-749.59 537,-795.881 582,-851 583.291,-852.581 584.727,-854.048 586.27,-855.409"/>
<polygon fill="#000000" stroke="#000000" points="584.528,-858.463 594.718,-861.363 588.56,-852.741 584.528,-858.463"/>
</g>
<!-- proc~uvw_to_cyl -->
<g id="proc~~halo~~CallsGraph_node69" class="node"><title>proc~uvw_to_cyl</title>
<g id="a_proc~~halo~~CallsGraph_node69"><a xlink:href=".././proc/uvw_to_cyl.html" xlink:title="uvw_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="661.5,-686 596.5,-686 596.5,-662 661.5,-662 661.5,-686"/>
<text text-anchor="middle" x="629" y="-671.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_cyl</text>
</a>
</g>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl -->
<g id="proc~~halo~~CallsGraph_edge108" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl</title>
<path fill="none" stroke="#000000" d="M527.054,-674C544.598,-674 566.998,-674 586.238,-674"/>
<polygon fill="#000000" stroke="#000000" points="586.259,-677.5 596.259,-674 586.258,-670.5 586.259,-677.5"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~halo~~CallsGraph_node71" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~halo~~CallsGraph_node71"><a xlink:href=".././proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="656,-1250 602,-1250 602,-1226 656,-1226 656,-1250"/>
<text text-anchor="middle" x="629" y="-1235.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~halo~~CallsGraph_edge109" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M523.195,-1238C542.83,-1238 569.943,-1238 591.672,-1238"/>
<polygon fill="#000000" stroke="#000000" points="591.85,-1241.5 601.85,-1238 591.85,-1234.5 591.85,-1241.5"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~halo~~CallsGraph_node67" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~halo~~CallsGraph_node67"><a xlink:href=".././proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="656,-1334 602,-1334 602,-1310 656,-1310 656,-1334"/>
<text text-anchor="middle" x="629" y="-1319.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~halo~~CallsGraph_edge111" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M523.195,-1355.6C543.008,-1349.25 570.436,-1340.46 592.263,-1333.46"/>
<polygon fill="#000000" stroke="#000000" points="593.396,-1336.77 601.85,-1330.38 591.259,-1330.1 593.396,-1336.77"/>
</g>
<!-- proc~lubksb -->
<g id="proc~~halo~~CallsGraph_node70" class="node"><title>proc~lubksb</title>
<g id="a_proc~~halo~~CallsGraph_node70"><a xlink:href=".././proc/lubksb.html" xlink:title="lubksb">
<polygon fill="#d9534f" stroke="#d9534f" points="656,-1376 602,-1376 602,-1352 656,-1352 656,-1376"/>
<text text-anchor="middle" x="629" y="-1361.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lubksb</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~lubksb -->
<g id="proc~~halo~~CallsGraph_edge110" class="edge"><title>proc~matinv&#45;&gt;proc~lubksb</title>
<path fill="none" stroke="#000000" d="M523.195,-1364C542.83,-1364 569.943,-1364 591.672,-1364"/>
<polygon fill="#000000" stroke="#000000" points="591.85,-1367.5 601.85,-1364 591.85,-1360.5 591.85,-1367.5"/>
</g>
<!-- proc~rswap -->
<g id="proc~~halo~~CallsGraph_node68" class="node"><title>proc~rswap</title>
<g id="a_proc~~halo~~CallsGraph_node68"><a xlink:href=".././proc/rswap.html" xlink:title="RSWAP">
<polygon fill="#d9534f" stroke="#d9534f" points="656,-1166 602,-1166 602,-1142 656,-1142 656,-1166"/>
<text text-anchor="middle" x="629" y="-1151.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RSWAP</text>
</a>
</g>
</g>
<!-- proc~elmhes&#45;&gt;proc~rswap -->
<g id="proc~~halo~~CallsGraph_edge112" class="edge"><title>proc~elmhes&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M523.195,-1154C542.83,-1154 569.943,-1154 591.672,-1154"/>
<polygon fill="#000000" stroke="#000000" points="591.85,-1157.5 601.85,-1154 591.85,-1150.5 591.85,-1157.5"/>
</g>
<!-- proc~balance&#45;&gt;proc~rswap -->
<g id="proc~~halo~~CallsGraph_edge113" class="edge"><title>proc~balance&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M523.195,-1187.6C543.008,-1181.25 570.436,-1172.46 592.263,-1165.46"/>
<polygon fill="#000000" stroke="#000000" points="593.396,-1168.77 601.85,-1162.38 591.259,-1162.1 593.396,-1168.77"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~halo~~CallsGraph_edge115" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M660.097,-821.232C676.162,-816.551 696.215,-810.709 713.904,-805.556"/>
<polygon fill="#000000" stroke="#000000" points="715.376,-808.772 723.997,-802.615 713.418,-802.052 715.376,-808.772"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~halo~~CallsGraph_edge114" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M656.799,-842.123C663.108,-845.007 669.8,-848.093 676,-851 691.533,-858.284 708.661,-866.503 723.15,-873.512"/>
<polygon fill="#000000" stroke="#000000" points="721.722,-876.709 732.247,-877.92 724.774,-870.409 721.722,-876.709"/>
</g>
<!-- proc~balback&#45;&gt;proc~rswap -->
<g id="proc~~halo~~CallsGraph_edge116" class="edge"><title>proc~balback&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M523.024,-1079.73C530.623,-1082.94 538.813,-1086.79 546,-1091 568.028,-1103.91 590.887,-1121.91 606.856,-1135.37"/>
<polygon fill="#000000" stroke="#000000" points="604.664,-1138.1 614.538,-1141.95 609.215,-1132.79 604.664,-1138.1"/>
</g>
<!-- proc~init_reservoir&#45;&gt;interface~randu -->
<g id="proc~~halo~~CallsGraph_edge117" class="edge"><title>proc~init_reservoir&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M781.262,-480.225C788.605,-484.425 796.747,-489.265 804,-494 821.745,-505.584 841.008,-519.746 855.568,-530.798"/>
<polygon fill="#000000" stroke="#000000" points="853.481,-533.608 863.55,-536.903 857.733,-528.048 853.481,-533.608"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~halo~~CallsGraph_node72" class="node"><title>proc~outerprod</title>
<g id="a_proc~~halo~~CallsGraph_node72"><a xlink:href=".././proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="787.5,-1355 728.5,-1355 728.5,-1331 787.5,-1331 787.5,-1355"/>
<text text-anchor="middle" x="758" y="-1340.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~halo~~CallsGraph_edge118" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M656.007,-1326.3C673.928,-1329.26 698.057,-1333.25 718.235,-1336.59"/>
<polygon fill="#000000" stroke="#000000" points="717.937,-1340.09 728.374,-1338.27 719.079,-1333.18 717.937,-1340.09"/>
</g>
<!-- proc~swap -->
<g id="proc~~halo~~CallsGraph_node73" class="node"><title>proc~swap</title>
<g id="a_proc~~halo~~CallsGraph_node73"><a xlink:href=".././proc/swap.html" xlink:title="swap">
<polygon fill="#d9534f" stroke="#d9534f" points="785,-1313 731,-1313 731,-1289 785,-1289 785,-1313"/>
<text text-anchor="middle" x="758" y="-1298.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swap</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~swap -->
<g id="proc~~halo~~CallsGraph_edge119" class="edge"><title>proc~ludcmp&#45;&gt;proc~swap</title>
<path fill="none" stroke="#000000" d="M656.007,-1317.7C674.631,-1314.62 699.959,-1310.43 720.591,-1307.02"/>
<polygon fill="#000000" stroke="#000000" points="721.297,-1310.45 730.592,-1305.37 720.154,-1303.55 721.297,-1310.45"/>
</g>
<!-- proc~comdiv -->
<g id="proc~~halo~~CallsGraph_node74" class="node"><title>proc~comdiv</title>
<g id="a_proc~~halo~~CallsGraph_node74"><a xlink:href=".././proc/comdiv.html" xlink:title="Comdiv">
<polygon fill="#d9534f" stroke="#d9534f" points="785,-1250 731,-1250 731,-1226 785,-1226 785,-1250"/>
<text text-anchor="middle" x="758" y="-1235.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Comdiv</text>
</a>
</g>
</g>
<!-- proc~hqrvec&#45;&gt;proc~comdiv -->
<g id="proc~~halo~~CallsGraph_edge120" class="edge"><title>proc~hqrvec&#45;&gt;proc~comdiv</title>
<path fill="none" stroke="#000000" d="M656.007,-1238C674.631,-1238 699.959,-1238 720.591,-1238"/>
<polygon fill="#000000" stroke="#000000" points="720.592,-1241.5 730.592,-1238 720.591,-1234.5 720.592,-1241.5"/>
</g>
</g>
</svg>
</div><script>var panprochaloCallsGraph = svgPanZoom('#prochaloCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~halo~~CalledByGraph Pages: 1 -->
<svg id="prochaloCalledByGraph" width="152pt" height="32pt"
 viewBox="0.00 0.00 152.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~halo~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~halo~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 148,-28 148,4 -4,4"/>
<!-- proc~halo -->
<g id="proc~~halo~~CalledByGraph_node1" class="node"><title>proc~halo</title>
<polygon fill="none" stroke="black" points="144,-24 90,-24 90,-0 144,-0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">halo</text>
</g>
<!-- program~fidasim -->
<g id="proc~~halo~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~halo~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~halo -->
<g id="proc~~halo~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~halo</title>
<path fill="none" stroke="#000000" d="M54.4029,-12C62.3932,-12 71.3106,-12 79.8241,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.919,-15.5001 89.919,-12 79.919,-8.5001 79.919,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/halo.html#src">halo</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">halo</span>
    <span class="c">!+ Calculates halo neutral density and spectra</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ic</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">ncell</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">Int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ihalo</span> <span class="c">!! counter</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ri</span>    <span class="c">!! start position</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vihalo</span><span class="c">!! velocity bulk plasma ion</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ind</span><span class="p">,</span> <span class="n">tind</span>    <span class="c">!! actual cell</span>
    <span class="c">!! Determination of the CX probability</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span> <span class="kd">::</span> <span class="n">plasma</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">denn</span>    <span class="c">!!  neutral dens (n=1-4)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rates</span>    <span class="c">!! CX rates</span>
    <span class="c">!! Collisiional radiative model along track</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">states</span>  <span class="c">! Density of n-states</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ntrack</span>
    <span class="k">type</span><span class="p">(</span><span class="n">ParticleTrack</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ntrack</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tracks</span>  <span class="c">!! Particle Tracks</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="k">is</span>
<span class="k">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tot_denn</span><span class="p">,</span> <span class="n">photons</span>  <span class="c">!! photon flux</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cell_ind</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nx</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ny</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nz</span><span class="p">)</span> <span class="kd">::</span> <span class="n">papprox</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nx</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ny</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nz</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nlaunch</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">local_iter_dens</span>

    <span class="k">type</span><span class="p">(</span><span class="n">NeutralPopulation</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cur_pop</span><span class="p">,</span> <span class="n">prev_pop</span>
    <span class="c">!! Halo iteration</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">Int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hh</span><span class="p">,</span> <span class="n">n_halo</span> <span class="c">!! counters</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dcx_dens</span><span class="p">,</span> <span class="n">halo_iter_dens</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">seed_dcx</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">prev_type</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c">! previous iteration</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">cur_type</span> <span class="o">=</span> <span class="mi">2</span> <span class="c">! current iteration</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fi_correction</span>

    <span class="c">!! Initialize Neutral Population</span>
    <span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">halo</span><span class="p">)</span>

    <span class="n">dcx_dens</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">dcx</span><span class="p">%</span><span class="n">dens</span><span class="p">)</span>

    <span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">prev_type</span><span class="p">)</span> <span class="o">=</span> <span class="n">dcx_dens</span>
    <span class="k">if</span><span class="p">(</span><span class="n">dcx_dens</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s1">&#39;HALO: Density of DCX-neutrals is zero&#39;</span>
        <span class="k">endif</span>
<span class="k">        stop</span>
<span class="k">    endif</span>
<span class="k">    </span><span class="n">n_halo</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">%</span><span class="n">n_halo</span>

    <span class="c">!! Allocate previous neutral populations</span>
    <span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">prev_pop</span><span class="p">)</span>
    <span class="n">prev_pop</span> <span class="o">=</span> <span class="n">neut</span><span class="p">%</span><span class="n">dcx</span>

    <span class="n">seed_dcx</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">iterations</span><span class="p">:</span> <span class="k">do </span><span class="n">hh</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">200</span>
        <span class="c">!! Allocate/Reallocate current population</span>
        <span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">cur_pop</span><span class="p">)</span>
        <span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">cur_type</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.d0</span>

        <span class="c">!! Calculate how many mc markers to launch in each cell</span>
        <span class="n">papprox</span> <span class="o">=</span> <span class="mf">0.d0</span>
        <span class="n">cell_ind</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">ncell</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">do </span><span class="n">ic</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span>
            <span class="k">call </span><span class="n">ind2sub</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">ic</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span> <span class="n">j</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

            <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">ind</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span>
            <span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">plasma</span><span class="p">%</span><span class="n">in_plasma</span><span class="p">)</span> <span class="k">cycle</span>
<span class="k">            </span><span class="n">tot_denn</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">prev_pop</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
            <span class="n">papprox</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">=</span> <span class="n">tot_denn</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">plasma</span><span class="p">%</span><span class="n">deni</span><span class="p">)</span>
            <span class="k">if</span><span class="p">(</span><span class="n">papprox</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                </span><span class="n">ncell</span> <span class="o">=</span> <span class="n">ncell</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">cell_ind</span><span class="p">(</span><span class="n">ncell</span><span class="p">)</span> <span class="o">=</span> <span class="n">ic</span>
            <span class="k">endif</span>
<span class="k">        enddo</span>
<span class="k">        call </span><span class="n">get_nlaunch</span><span class="p">(</span><span class="n">n_halo</span><span class="p">,</span> <span class="n">papprox</span><span class="p">,</span> <span class="n">nlaunch</span><span class="p">)</span>

        <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i10,&quot; --- Seed/DCX: &quot;,f5.3)&#39;</span><span class="p">)</span> <span class="nb">sum</span><span class="p">(</span><span class="n">nlaunch</span><span class="p">),</span> <span class="n">seed_dcx</span>
        <span class="k">endif</span>

        <span class="c">!$OMP PARALLEL DO schedule(dynamic,1) private(i,j,k,ic,ihalo,ii,jj,kk,it,is,ind,vihalo, &amp;</span>
        <span class="c">!$OMP&amp; ri,tracks,ntrack,rates,denn,states,photons,plasma,tind,fi_correction)</span>
        <span class="n">loop_over_cells</span><span class="p">:</span> <span class="k">do </span><span class="n">ic</span><span class="o">=</span><span class="n">istart</span><span class="p">,</span><span class="n">ncell</span><span class="p">,</span><span class="n">istep</span>
            <span class="k">call </span><span class="n">ind2sub</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">cell_ind</span><span class="p">(</span><span class="n">ic</span><span class="p">),</span><span class="n">ind</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span> <span class="n">j</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">loop_over_species</span><span class="p">:</span> <span class="k">do is</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n_thermal</span> <span class="c">!This loop has to come first</span>
                <span class="c">!! Loop over the markers</span>
                <span class="n">loop_over_halos</span><span class="p">:</span> <span class="k">do </span><span class="n">ihalo</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
                    <span class="c">!! Calculate ri,vhalo and track</span>
                    <span class="k">call </span><span class="n">mc_beam_grid</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">ri</span><span class="p">)</span>
                    <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">)</span>
                    <span class="k">call </span><span class="n">mc_halo</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span> <span class="n">thermal_mass</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="n">vihalo</span><span class="p">)</span>
                    <span class="k">call </span><span class="n">track</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">vihalo</span><span class="p">,</span><span class="n">tracks</span><span class="p">,</span><span class="n">ntrack</span><span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">ntrack</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">cycle </span><span class="n">loop_over_halos</span>

                    <span class="c">!! Get plasma parameters at particle location</span>
                    <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">)</span>

                    <span class="c">!! Calculate CX probability</span>
                    <span class="n">tind</span> <span class="o">=</span> <span class="n">tracks</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">ind</span>
                    <span class="n">ii</span> <span class="o">=</span> <span class="n">tind</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">jj</span> <span class="o">=</span> <span class="n">tind</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">kk</span> <span class="o">=</span> <span class="n">tind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                    <span class="k">call </span><span class="n">neutral_cx_rate</span><span class="p">(</span><span class="n">prev_pop</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">),</span> <span class="n">prev_pop</span><span class="p">%</span><span class="n">res</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">),</span> <span class="n">vihalo</span><span class="p">,</span> <span class="n">rates</span><span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span><span class="k">cycle </span><span class="n">loop_over_halos</span>

                    <span class="c">!! Get plasma parameters at mean point in cell</span>
                    <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">tracks</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">pos</span><span class="p">)</span>

                    <span class="c">!! Weight CX rates by ion source density</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">beam_mass</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">thermal_mass</span><span class="p">(</span><span class="k">is</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                        </span><span class="n">states</span> <span class="o">=</span> <span class="n">rates</span><span class="o">*</span><span class="p">(</span><span class="n">plasma</span><span class="p">%</span><span class="n">deni</span><span class="p">(</span><span class="k">is</span><span class="p">)</span> <span class="o">+</span> <span class="n">plasma</span><span class="p">%</span><span class="n">denf</span><span class="p">)</span>
                        <span class="n">fi_correction</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">plasma</span><span class="p">%</span><span class="n">deni</span><span class="p">(</span><span class="k">is</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">plasma</span><span class="p">%</span><span class="n">deni</span><span class="p">(</span><span class="k">is</span><span class="p">)</span><span class="o">+</span><span class="n">plasma</span><span class="p">%</span><span class="n">denf</span><span class="p">),</span><span class="mf">0.d0</span><span class="p">)</span>
                    <span class="k">else</span>
<span class="k">                        </span><span class="n">states</span> <span class="o">=</span> <span class="n">rates</span><span class="o">*</span><span class="n">plasma</span><span class="p">%</span><span class="n">deni</span><span class="p">(</span><span class="k">is</span><span class="p">)</span>
                        <span class="n">fi_correction</span> <span class="o">=</span> <span class="mf">1.d0</span>
                    <span class="k">endif</span>
<span class="k">                    if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">loop_over_halos</span>

                    <span class="n">loop_along_track</span><span class="p">:</span> <span class="k">do </span><span class="n">it</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ntrack</span>
                        <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">tracks</span><span class="p">(</span><span class="n">it</span><span class="p">)%</span><span class="n">pos</span><span class="p">)</span>
                        <span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">plasma</span><span class="p">%</span><span class="n">in_plasma</span><span class="p">)</span> <span class="k">exit </span><span class="n">loop_along_track</span>
                        <span class="k">call </span><span class="n">colrad</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">thermal_mass</span><span class="p">(</span><span class="k">is</span><span class="p">),</span><span class="n">vihalo</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">it</span><span class="p">)%</span><span class="nb">time</span><span class="p">,</span><span class="n">states</span><span class="p">,</span><span class="n">denn</span><span class="p">,</span><span class="n">photons</span><span class="p">)</span>

                        <span class="c">!! Store Neutrals</span>
                        <span class="k">call </span><span class="n">update_neutrals</span><span class="p">(</span><span class="n">cur_pop</span><span class="p">,</span> <span class="n">tracks</span><span class="p">(</span><span class="n">it</span><span class="p">)%</span><span class="n">ind</span><span class="p">,</span> <span class="n">vihalo</span><span class="p">,</span> <span class="n">denn</span><span class="o">/</span><span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>

                        <span class="k">if</span><span class="p">((</span><span class="n">photons</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_halo</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                            </span><span class="n">photons</span> <span class="o">=</span> <span class="n">fi_correction</span><span class="o">*</span><span class="n">photons</span> <span class="c">!! Correct for including fast-ions in states</span>
                            <span class="k">call </span><span class="n">store_photons</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="n">it</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span><span class="n">vihalo</span><span class="p">,</span><span class="n">thermal_lambda0</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="p">&amp;</span>
                                               <span class="n">photons</span><span class="o">/</span><span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">spec</span><span class="p">%</span><span class="n">halo</span><span class="p">(:,:,:,</span><span class="k">is</span><span class="p">),</span><span class="n">spec</span><span class="p">%</span><span class="n">halostokes</span><span class="p">(:,:,:,:,</span><span class="k">is</span><span class="p">))</span>
                        <span class="k">endif</span>
<span class="k">                    enddo </span><span class="n">loop_along_track</span>
                <span class="k">enddo </span><span class="n">loop_over_halos</span>
            <span class="k">enddo </span><span class="n">loop_over_species</span>
        <span class="k">enddo </span><span class="n">loop_over_cells</span>
        <span class="c">!$OMP END PARALLEL DO</span>

<span class="cp">#ifdef _MPI</span>
        <span class="c">!! Combine densities</span>
        <span class="k">call </span><span class="n">parallel_merge_populations</span><span class="p">(</span><span class="n">cur_pop</span><span class="p">)</span>
<span class="cp">#endif</span>
        <span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">cur_type</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">cur_pop</span><span class="p">%</span><span class="n">dens</span><span class="p">)</span>

        <span class="k">if</span><span class="p">(</span><span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">cur_type</span><span class="p">)</span><span class="o">/</span><span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">prev_type</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">1.0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s2">&quot;HALO: Halo generation density exceeded seed density. This shouldn&#39;t happen.&quot;</span>
            <span class="k">exit </span><span class="n">iterations</span>
        <span class="k">endif</span>

        <span class="c">!! Set current generation to previous generation</span>
        <span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">prev_type</span><span class="p">)</span> <span class="o">=</span> <span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">cur_type</span><span class="p">)</span>
        <span class="n">prev_pop</span> <span class="o">=</span> <span class="n">cur_pop</span>

        <span class="c">!! merge current population with halo population</span>
        <span class="k">call </span><span class="n">merge_neutral_populations</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">halo</span><span class="p">,</span> <span class="n">cur_pop</span><span class="p">)</span>

        <span class="n">seed_dcx</span> <span class="o">=</span> <span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">cur_type</span><span class="p">)</span><span class="o">/</span><span class="n">dcx_dens</span>
        <span class="k">if</span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">seed_dcx</span><span class="p">))</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s2">&quot;NAN (Halo generation)/DCX. Exiting...&quot;</span>
            <span class="k">stop</span>
<span class="k">        endif</span>
<span class="k">        </span><span class="n">n_halo</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_halo</span><span class="o">*</span><span class="n">seed_dcx</span><span class="p">,</span><span class="n">Int64</span><span class="p">)</span>

        <span class="k">if</span><span class="p">(</span><span class="n">seed_dcx</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mf">0.01</span><span class="p">)</span> <span class="k">exit </span><span class="n">iterations</span>
    <span class="k">enddo </span><span class="n">iterations</span>

<span class="cp">#ifdef _MPI</span>
    <span class="c">!! Combine Spectra</span>
    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_halo</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">halo</span><span class="p">)</span>
    <span class="k">endif</span>
<span class="cp">#endif</span>

<span class="k">end subroutine </span><span class="n">halo</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2021 
                                          </p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            
            
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>