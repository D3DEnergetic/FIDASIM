<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="">
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>halo &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>User Guide</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>halo
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.9% of total for procedures.">126 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
     <li><a href='../module/libfida.html'>libfida</a></li>
     <li class="active">halo</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/halo.html#src">halo</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public subroutine halo()</h2>
    

    <p>Calculates halo neutral density and spectra</p>

    <h3>Arguments</h3>
    <em>None</em>
    <br>
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~halo~~CallsGraph Pages: 1 -->
<svg id="prochaloCallsGraph" width="641pt" height="1011pt"
 viewBox="0.00 0.00 641.00 1011.23" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~halo~~CallsGraph" class="graph" transform="scale(0.690733 0.690733) rotate(0) translate(4 1460)">
<title>proc~~halo~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1460 924,-1460 924,4 -4,4"/>
<!-- proc~halo -->
<g id="proc~~halo~~CallsGraph_node1" class="node"><title>proc~halo</title>
<polygon fill="none" stroke="black" points="54,-729 0,-729 0,-705 54,-705 54,-729"/>
<text text-anchor="middle" x="27" y="-714.6" font-family="Helvetica,sans-Serif" font-size="10.50">halo</text>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~halo~~CallsGraph_node2" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~halo~~CallsGraph_node2"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="532.5,-1210 459.5,-1210 459.5,-1186 532.5,-1186 532.5,-1210"/>
<text text-anchor="middle" x="496" y="-1195.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;interface~parallel_sum -->
<g id="proc~~halo~~CallsGraph_edge1" class="edge"><title>proc~halo&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M28.4021,-729.181C30.5432,-786.922 42.3663,-1032.6 90,-1089 180.43,-1196.07 363.816,-1203.75 449.263,-1200.97"/>
<polygon fill="#000000" stroke="#000000" points="449.574,-1204.47 459.43,-1200.58 449.302,-1197.47 449.574,-1204.47"/>
</g>
<!-- proc~init_neutral_population -->
<g id="proc~~halo~~CallsGraph_node3" class="node"><title>proc~init_neutral_population</title>
<g id="a_proc~~halo~~CallsGraph_node3"><a xlink:href=".././proc/init_neutral_population.html" xlink:title="init_neutral_population">
<polygon fill="#d9534f" stroke="#d9534f" points="223.5,-729 102.5,-729 102.5,-705 223.5,-705 223.5,-729"/>
<text text-anchor="middle" x="163" y="-714.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_neutral_population</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~init_neutral_population -->
<g id="proc~~halo~~CallsGraph_edge2" class="edge"><title>proc~halo&#45;&gt;proc~init_neutral_population</title>
<path fill="none" stroke="#000000" d="M54.1547,-717C65.1403,-717 78.4949,-717 92.0121,-717"/>
<polygon fill="#000000" stroke="#000000" points="92.3439,-720.5 102.344,-717 92.3438,-713.5 92.3439,-720.5"/>
</g>
<!-- proc~colrad -->
<g id="proc~~halo~~CallsGraph_node4" class="node"><title>proc~colrad</title>
<g id="a_proc~~halo~~CallsGraph_node4"><a xlink:href=".././proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="190,-632 136,-632 136,-608 190,-608 190,-632"/>
<text text-anchor="middle" x="163" y="-617.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~colrad -->
<g id="proc~~halo~~CallsGraph_edge3" class="edge"><title>proc~halo&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M44.7003,-704.911C67.8706,-688.138 109.954,-657.675 136.912,-638.161"/>
<polygon fill="#000000" stroke="#000000" points="139.041,-640.94 145.089,-632.241 134.937,-635.27 139.041,-640.94"/>
</g>
<!-- proc~track -->
<g id="proc~~halo~~CallsGraph_node5" class="node"><title>proc~track</title>
<g id="a_proc~~halo~~CallsGraph_node5"><a xlink:href=".././proc/track.html" xlink:title="track">
<polygon fill="#d9534f" stroke="#d9534f" points="190,-326 136,-326 136,-302 190,-302 190,-326"/>
<text text-anchor="middle" x="163" y="-311.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~track -->
<g id="proc~~halo~~CallsGraph_edge4" class="edge"><title>proc~halo&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M28.0988,-704.925C28.9056,-661.052 35.673,-506.855 90,-396 102.108,-371.293 123.652,-348.227 140.027,-332.893"/>
<polygon fill="#000000" stroke="#000000" points="142.547,-335.332 147.587,-326.013 137.836,-330.155 142.547,-335.332"/>
</g>
<!-- proc~mc_halo -->
<g id="proc~~halo~~CallsGraph_node6" class="node"><title>proc~mc_halo</title>
<g id="a_proc~~halo~~CallsGraph_node6"><a xlink:href=".././proc/mc_halo.html" xlink:title="mc_halo">
<polygon fill="#d9534f" stroke="#d9534f" points="190,-179 136,-179 136,-155 190,-155 190,-179"/>
<text text-anchor="middle" x="163" y="-164.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_halo</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~mc_halo -->
<g id="proc~~halo~~CallsGraph_edge5" class="edge"><title>proc~halo&#45;&gt;proc~mc_halo</title>
<path fill="none" stroke="#000000" d="M28.6455,-704.515C32.686,-628.414 55.4487,-228.868 90,-188 98.8223,-177.565 112.511,-172.156 125.594,-169.407"/>
<polygon fill="#000000" stroke="#000000" points="126.549,-172.797 135.851,-167.726 125.417,-165.889 126.549,-172.797"/>
</g>
<!-- proc~neutral_cx_rate -->
<g id="proc~~halo~~CallsGraph_node7" class="node"><title>proc~neutral_cx_rate</title>
<g id="a_proc~~halo~~CallsGraph_node7"><a xlink:href=".././proc/neutral_cx_rate.html" xlink:title="neutral_cx_rate">
<polygon fill="#d9534f" stroke="#d9534f" points="206.5,-547 119.5,-547 119.5,-523 206.5,-523 206.5,-547"/>
<text text-anchor="middle" x="163" y="-532.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutral_cx_rate</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~neutral_cx_rate -->
<g id="proc~~halo~~CallsGraph_edge15" class="edge"><title>proc~halo&#45;&gt;proc~neutral_cx_rate</title>
<path fill="none" stroke="#000000" d="M32.6933,-704.774C41.6553,-682.363 62.7615,-633.811 90,-599 103.526,-581.714 122.107,-565.331 137.005,-553.468"/>
<polygon fill="#000000" stroke="#000000" points="139.537,-555.933 145.285,-547.033 135.241,-550.406 139.537,-555.933"/>
</g>
<!-- proc~parallel_merge_populations -->
<g id="proc~~halo~~CallsGraph_node8" class="node"><title>proc~parallel_merge_populations</title>
<g id="a_proc~~halo~~CallsGraph_node8"><a xlink:href=".././proc/parallel_merge_populations.html" xlink:title="parallel_merge_populations">
<polygon fill="#d9534f" stroke="#d9534f" points="235.5,-1080 90.5,-1080 90.5,-1056 235.5,-1056 235.5,-1080"/>
<text text-anchor="middle" x="163" y="-1065.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_merge_populations</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~parallel_merge_populations -->
<g id="proc~~halo~~CallsGraph_edge7" class="edge"><title>proc~halo&#45;&gt;proc~parallel_merge_populations</title>
<path fill="none" stroke="#000000" d="M29.0529,-729.041C33.7177,-780.118 53.9036,-978.517 90,-1028 97.0394,-1037.65 107.151,-1045.26 117.58,-1051.14"/>
<polygon fill="#000000" stroke="#000000" points="116.264,-1054.4 126.757,-1055.86 119.468,-1048.17 116.264,-1054.4"/>
</g>
<!-- proc~get_nlaunch -->
<g id="proc~~halo~~CallsGraph_node9" class="node"><title>proc~get_nlaunch</title>
<g id="a_proc~~halo~~CallsGraph_node9"><a xlink:href=".././proc/get_nlaunch.html" xlink:title="get_nlaunch">
<polygon fill="#d9534f" stroke="#d9534f" points="198.5,-935 127.5,-935 127.5,-911 198.5,-911 198.5,-935"/>
<text text-anchor="middle" x="163" y="-920.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_nlaunch</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~get_nlaunch -->
<g id="proc~~halo~~CallsGraph_edge8" class="edge"><title>proc~halo&#45;&gt;proc~get_nlaunch</title>
<path fill="none" stroke="#000000" d="M30.9454,-729.051C37.8436,-755.511 57.0073,-819.846 90,-864 102.049,-880.125 119.417,-894.525 134.076,-905.063"/>
<polygon fill="#000000" stroke="#000000" points="132.125,-907.969 142.334,-910.804 136.122,-902.222 132.125,-907.969"/>
</g>
<!-- proc~update_neutrals -->
<g id="proc~~halo~~CallsGraph_node10" class="node"><title>proc~update_neutrals</title>
<g id="a_proc~~halo~~CallsGraph_node10"><a xlink:href=".././proc/update_neutrals.html" xlink:title="update_neutrals">
<polygon fill="#d9534f" stroke="#d9534f" points="208,-855 118,-855 118,-831 208,-831 208,-855"/>
<text text-anchor="middle" x="163" y="-840.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_neutrals</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~update_neutrals -->
<g id="proc~~halo~~CallsGraph_edge9" class="edge"><title>proc~halo&#45;&gt;proc~update_neutrals</title>
<path fill="none" stroke="#000000" d="M32.4848,-729.3C40.7142,-750.222 60.1671,-792.817 90,-817 95.4105,-821.386 101.623,-825.065 108.083,-828.144"/>
<polygon fill="#000000" stroke="#000000" points="107.088,-831.525 117.659,-832.238 109.839,-825.089 107.088,-831.525"/>
</g>
<!-- proc~free_neutral_population -->
<g id="proc~~halo~~CallsGraph_node11" class="node"><title>proc~free_neutral_population</title>
<g id="a_proc~~halo~~CallsGraph_node11"><a xlink:href=".././proc/free_neutral_population.html" xlink:title="free_neutral_population">
<polygon fill="#d9534f" stroke="#d9534f" points="226,-137 100,-137 100,-113 226,-113 226,-137"/>
<text text-anchor="middle" x="163" y="-122.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">free_neutral_population</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~free_neutral_population -->
<g id="proc~~halo~~CallsGraph_edge10" class="edge"><title>proc~halo&#45;&gt;proc~free_neutral_population</title>
<path fill="none" stroke="#000000" d="M28.519,-704.826C31.9804,-626.07 52.7291,-190.468 90,-146 90.7319,-145.127 91.4978,-144.289 92.2947,-143.485"/>
<polygon fill="#000000" stroke="#000000" points="94.6115,-146.113 100.215,-137.121 90.2269,-140.656 94.6115,-146.113"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~halo~~CallsGraph_node12" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~halo~~CallsGraph_node12"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="375,-347 307,-347 307,-323 375,-323 375,-347"/>
<text text-anchor="middle" x="341" y="-332.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~get_plasma -->
<g id="proc~~halo~~CallsGraph_edge11" class="edge"><title>proc~halo&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M29.0054,-704.832C32.3014,-671.356 45.2829,-576.252 90,-514 146.554,-435.269 248.672,-378.164 303.254,-351.62"/>
<polygon fill="#000000" stroke="#000000" points="305.041,-354.645 312.551,-347.172 302.02,-348.331 305.041,-354.645"/>
</g>
<!-- proc~store_photons -->
<g id="proc~~halo~~CallsGraph_node13" class="node"><title>proc~store_photons</title>
<g id="a_proc~~halo~~CallsGraph_node13"><a xlink:href=".././proc/store_photons.html" xlink:title="store_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="203.5,-221 122.5,-221 122.5,-197 203.5,-197 203.5,-221"/>
<text text-anchor="middle" x="163" y="-206.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_photons</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~store_photons -->
<g id="proc~~halo~~CallsGraph_edge12" class="edge"><title>proc~halo&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M28.8606,-704.869C33.3301,-643.792 55.0378,-369.859 90,-293 101.619,-267.458 123.425,-243.712 140.007,-228.03"/>
<polygon fill="#000000" stroke="#000000" points="142.659,-230.347 147.66,-221.007 137.926,-225.19 142.659,-230.347"/>
</g>
<!-- proc~ind2sub -->
<g id="proc~~halo~~CallsGraph_node14" class="node"><title>proc~ind2sub</title>
<g id="a_proc~~halo~~CallsGraph_node14"><a xlink:href=".././proc/ind2sub.html" xlink:title="ind2sub">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-1019 314,-1019 314,-995 368,-995 368,-1019"/>
<text text-anchor="middle" x="341" y="-1004.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ind2sub</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~ind2sub -->
<g id="proc~~halo~~CallsGraph_edge13" class="edge"><title>proc~halo&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M27.3925,-729.171C26.2133,-766.936 28.0102,-883.223 90,-944 105.359,-959.058 238.596,-987.021 304.036,-1000.02"/>
<polygon fill="#000000" stroke="#000000" points="303.439,-1003.47 313.928,-1001.97 304.795,-996.603 303.439,-1003.47"/>
</g>
<!-- proc~mc_beam_grid -->
<g id="proc~~halo~~CallsGraph_node15" class="node"><title>proc~mc_beam_grid</title>
<g id="a_proc~~halo~~CallsGraph_node15"><a xlink:href=".././proc/mc_beam_grid.html" xlink:title="mc_beam_grid">
<polygon fill="#d9534f" stroke="#d9534f" points="800,-834 716,-834 716,-810 800,-810 800,-834"/>
<text text-anchor="middle" x="758" y="-819.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_beam_grid</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~mc_beam_grid -->
<g id="proc~~halo~~CallsGraph_edge14" class="edge"><title>proc~halo&#45;&gt;proc~mc_beam_grid</title>
<path fill="none" stroke="#000000" d="M54.2934,-726.853C65.2277,-730.702 78.1188,-734.921 90,-738 245.694,-778.351 286.334,-783.617 446,-803 536.865,-814.031 643.485,-818.78 705.333,-820.733"/>
<polygon fill="#000000" stroke="#000000" points="705.504,-824.24 715.606,-821.044 705.717,-817.243 705.504,-824.24"/>
</g>
<!-- proc~merge_neutral_populations -->
<g id="proc~~halo~~CallsGraph_node16" class="node"><title>proc~merge_neutral_populations</title>
<g id="a_proc~~halo~~CallsGraph_node16"><a xlink:href=".././proc/merge_neutral_populations.html" xlink:title="merge_neutral_populations">
<polygon fill="#d9534f" stroke="#d9534f" points="234.5,-1019 91.5,-1019 91.5,-995 234.5,-995 234.5,-1019"/>
<text text-anchor="middle" x="163" y="-1004.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">merge_neutral_populations</text>
</a>
</g>
</g>
<!-- proc~halo&#45;&gt;proc~merge_neutral_populations -->
<g id="proc~~halo~~CallsGraph_edge6" class="edge"><title>proc~halo&#45;&gt;proc~merge_neutral_populations</title>
<path fill="none" stroke="#000000" d="M29.3679,-729.099C34.8161,-775.35 56.323,-940.302 90,-979 93.6869,-983.237 98.0942,-986.836 102.887,-989.894"/>
<polygon fill="#000000" stroke="#000000" points="101.412,-993.077 111.86,-994.834 104.788,-986.945 101.412,-993.077"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~halo~~CallsGraph_node17" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~halo~~CallsGraph_node17"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="673,-1170 585,-1170 585,-1146 673,-1146 673,-1170"/>
<text text-anchor="middle" x="629" y="-1155.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~halo~~CallsGraph_edge16" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.796,-1187.07C546.965,-1182.74 563.486,-1177.7 578.75,-1173.04"/>
<polygon fill="#000000" stroke="#000000" points="580.021,-1176.31 588.562,-1170.04 577.976,-1169.61 580.021,-1176.31"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~halo~~CallsGraph_node20" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~halo~~CallsGraph_node20"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-1334 583.5,-1334 583.5,-1310 674.5,-1310 674.5,-1334"/>
<text text-anchor="middle" x="629" y="-1319.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~halo~~CallsGraph_edge21" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M504.487,-1210.32C517.789,-1231.35 547.421,-1274.46 582,-1301 583.754,-1302.35 585.608,-1303.63 587.526,-1304.85"/>
<polygon fill="#000000" stroke="#000000" points="585.805,-1307.9 596.227,-1309.81 589.269,-1301.82 585.805,-1307.9"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~halo~~CallsGraph_node21" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~halo~~CallsGraph_node21"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-1292 583.5,-1292 583.5,-1268 674.5,-1268 674.5,-1292"/>
<text text-anchor="middle" x="629" y="-1277.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~halo~~CallsGraph_edge25" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M512.058,-1210.18C528.593,-1223.23 556.229,-1244.06 582,-1259 584.649,-1260.54 587.43,-1262.04 590.257,-1263.5"/>
<polygon fill="#000000" stroke="#000000" points="588.825,-1266.7 599.344,-1267.96 591.911,-1260.41 588.825,-1266.7"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~halo~~CallsGraph_node24" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~halo~~CallsGraph_node24"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="802,-1078 714,-1078 714,-1054 802,-1054 802,-1078"/>
<text text-anchor="middle" x="758" y="-1063.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~halo~~CallsGraph_edge17" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M505.093,-1185.83C518.634,-1166.46 547.789,-1128.8 582,-1109 619.337,-1087.39 667.223,-1076.58 703.463,-1071.21"/>
<polygon fill="#000000" stroke="#000000" points="704.408,-1074.62 713.833,-1069.78 703.447,-1067.68 704.408,-1074.62"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~halo~~CallsGraph_node25" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~halo~~CallsGraph_node25"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-1456 583.5,-1456 583.5,-1432 674.5,-1432 674.5,-1456"/>
<text text-anchor="middle" x="629" y="-1441.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~halo~~CallsGraph_edge19" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M498.344,-1210.18C503.012,-1247 521.68,-1358.49 582,-1423 582.911,-1423.97 583.875,-1424.91 584.884,-1425.8"/>
<polygon fill="#000000" stroke="#000000" points="583.165,-1428.87 593.325,-1431.88 587.255,-1423.19 583.165,-1428.87"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~halo~~CallsGraph_node27" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~halo~~CallsGraph_node27"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="673,-1250 585,-1250 585,-1226 673,-1226 673,-1250"/>
<text text-anchor="middle" x="629" y="-1235.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~halo~~CallsGraph_edge22" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.796,-1208.93C546.965,-1213.26 563.486,-1218.3 578.75,-1222.96"/>
<polygon fill="#000000" stroke="#000000" points="577.976,-1226.39 588.562,-1225.96 580.021,-1219.69 577.976,-1226.39"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~halo~~CallsGraph_node28" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~halo~~CallsGraph_node28"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="802,-1200 714,-1200 714,-1176 802,-1176 802,-1200"/>
<text text-anchor="middle" x="758" y="-1185.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~halo~~CallsGraph_edge24" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.607,-1196.63C576.715,-1194.93 652.278,-1192.03 703.404,-1190.06"/>
<polygon fill="#000000" stroke="#000000" points="703.746,-1193.55 713.604,-1189.67 703.477,-1186.56 703.746,-1193.55"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_node37" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~halo~~CallsGraph_node37"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="803.5,-1374 712.5,-1374 712.5,-1350 803.5,-1350 803.5,-1374"/>
<text text-anchor="middle" x="758" y="-1359.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_edge23" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M500.145,-1210.36C508.201,-1239.21 532.514,-1310.98 582,-1343 617.412,-1365.92 665.509,-1369.65 702.319,-1368.21"/>
<polygon fill="#000000" stroke="#000000" points="702.58,-1371.71 712.382,-1367.69 702.213,-1364.72 702.58,-1371.71"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~halo~~CallsGraph_node40" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~halo~~CallsGraph_node40"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="803.5,-1120 712.5,-1120 712.5,-1096 803.5,-1096 803.5,-1120"/>
<text text-anchor="middle" x="758" y="-1105.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~halo~~CallsGraph_edge18" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M509.677,-1185.98C525.355,-1171.85 553.48,-1148.84 582,-1137 620.316,-1121.1 666.761,-1113.9 702.173,-1110.65"/>
<polygon fill="#000000" stroke="#000000" points="702.646,-1114.13 712.318,-1109.8 702.061,-1107.15 702.646,-1114.13"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~halo~~CallsGraph_node42" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~halo~~CallsGraph_node42"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-1414 583.5,-1414 583.5,-1390 674.5,-1390 674.5,-1414"/>
<text text-anchor="middle" x="629" y="-1399.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~halo~~CallsGraph_edge20" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M500.073,-1210.27C508.408,-1241.41 534.099,-1324.68 582,-1376 584.887,-1379.09 588.227,-1381.92 591.763,-1384.47"/>
<polygon fill="#000000" stroke="#000000" points="589.943,-1387.46 600.249,-1389.92 593.726,-1381.57 589.943,-1387.46"/>
</g>
<!-- proc~linsolve -->
<g id="proc~~halo~~CallsGraph_node22" class="node"><title>proc~linsolve</title>
<g id="a_proc~~halo~~CallsGraph_node22"><a xlink:href=".././proc/linsolve.html" xlink:title="linsolve">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-731 314,-731 314,-707 368,-707 368,-731"/>
<text text-anchor="middle" x="341" y="-716.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linsolve</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~linsolve -->
<g id="proc~~halo~~CallsGraph_edge28" class="edge"><title>proc~colrad&#45;&gt;proc~linsolve</title>
<path fill="none" stroke="#000000" d="M185.581,-632.139C216.674,-649.629 274.213,-681.995 309.598,-701.899"/>
<polygon fill="#000000" stroke="#000000" points="308.086,-705.064 318.518,-706.916 311.518,-698.963 308.086,-705.064"/>
</g>
<!-- proc~eigen -->
<g id="proc~~halo~~CallsGraph_node34" class="node"><title>proc~eigen</title>
<g id="a_proc~~halo~~CallsGraph_node34"><a xlink:href=".././proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-605 314,-605 314,-581 368,-581 368,-605"/>
<text text-anchor="middle" x="341" y="-590.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~halo~~CallsGraph_edge27" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M190.349,-615.958C220.505,-611.332 270.071,-603.728 303.829,-598.549"/>
<polygon fill="#000000" stroke="#000000" points="304.405,-602.002 313.759,-597.026 303.344,-595.083 304.405,-602.002"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~halo~~CallsGraph_node41" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~halo~~CallsGraph_node41"><a xlink:href=".././proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="385,-536 297,-536 297,-512 385,-512 385,-536"/>
<text text-anchor="middle" x="341" y="-521.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~halo~~CallsGraph_edge26" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M186.291,-607.842C217.368,-590.89 273.847,-560.084 309.008,-540.905"/>
<polygon fill="#000000" stroke="#000000" points="310.788,-543.921 317.89,-536.06 307.435,-537.776 310.788,-543.921"/>
</g>
<!-- proc~track&#45;&gt;proc~get_plasma -->
<g id="proc~~halo~~CallsGraph_edge32" class="edge"><title>proc~track&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M190.349,-317.144C218.506,-320.504 263.586,-325.882 296.918,-329.86"/>
<polygon fill="#000000" stroke="#000000" points="296.509,-333.336 306.854,-331.045 297.339,-326.385 296.509,-333.336"/>
</g>
<!-- proc~doppler_stark -->
<g id="proc~~halo~~CallsGraph_node19" class="node"><title>proc~doppler_stark</title>
<g id="a_proc~~halo~~CallsGraph_node19"><a xlink:href=".././proc/doppler_stark.html" xlink:title="doppler_stark">
<polygon fill="#d9534f" stroke="#d9534f" points="380,-305 302,-305 302,-281 380,-281 380,-305"/>
<text text-anchor="middle" x="341" y="-290.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">doppler_stark</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~doppler_stark -->
<g id="proc~~halo~~CallsGraph_edge30" class="edge"><title>proc~track&#45;&gt;proc~doppler_stark</title>
<path fill="none" stroke="#000000" d="M190.349,-310.856C217,-307.676 258.813,-302.687 291.474,-298.79"/>
<polygon fill="#000000" stroke="#000000" points="292.211,-302.227 301.726,-297.567 291.382,-295.276 292.211,-302.227"/>
</g>
<!-- proc~get_indices -->
<g id="proc~~halo~~CallsGraph_node33" class="node"><title>proc~get_indices</title>
<g id="a_proc~~halo~~CallsGraph_node33"><a xlink:href=".././proc/get_indices.html" xlink:title="get_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="374.5,-221 307.5,-221 307.5,-197 374.5,-197 374.5,-221"/>
<text text-anchor="middle" x="341" y="-206.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_indices</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~get_indices -->
<g id="proc~~halo~~CallsGraph_edge29" class="edge"><title>proc~track&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M176.56,-301.71C195.67,-283.631 233.87,-249.865 272,-230 279.962,-225.852 288.881,-222.367 297.574,-219.503"/>
<polygon fill="#000000" stroke="#000000" points="298.701,-222.818 307.229,-216.531 296.642,-216.128 298.701,-222.818"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~halo~~CallsGraph_node43" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~halo~~CallsGraph_node43"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="526.5,-382 465.5,-382 465.5,-358 526.5,-358 526.5,-382"/>
<text text-anchor="middle" x="496" y="-367.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~in_plasma -->
<g id="proc~~halo~~CallsGraph_edge31" class="edge"><title>proc~track&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M188.629,-326.103C210.089,-336.027 242.333,-349.466 272,-356 334.954,-369.866 410.143,-371.629 455.156,-371.16"/>
<polygon fill="#000000" stroke="#000000" points="455.431,-374.656 465.378,-371.009 455.327,-367.657 455.431,-374.656"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~halo~~CallsGraph_node46" class="node"><title>proc~get_fields</title>
<g id="a_proc~~halo~~CallsGraph_node46"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="370,-263 312,-263 312,-239 370,-239 370,-263"/>
<text text-anchor="middle" x="341" y="-248.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~get_fields -->
<g id="proc~~halo~~CallsGraph_edge33" class="edge"><title>proc~track&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M190.434,-303.112C212.179,-294.302 243.883,-281.795 272,-272 281.714,-268.616 292.301,-265.212 302.166,-262.159"/>
<polygon fill="#000000" stroke="#000000" points="303.19,-265.506 311.732,-259.237 301.145,-258.812 303.19,-265.506"/>
</g>
<!-- interface~randn -->
<g id="proc~~halo~~CallsGraph_node35" class="node"><title>interface~randn</title>
<g id="a_proc~~halo~~CallsGraph_node35"><a xlink:href=".././interface/randn.html" xlink:title="randn">
<polygon fill="#a7506f" stroke="#a7506f" points="368,-24 314,-24 314,-0 368,-0 368,-24"/>
<text text-anchor="middle" x="341" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randn</text>
</a>
</g>
</g>
<!-- proc~mc_halo&#45;&gt;interface~randn -->
<g id="proc~~halo~~CallsGraph_edge34" class="edge"><title>proc~mc_halo&#45;&gt;interface~randn</title>
<path fill="none" stroke="#000000" d="M190.294,-165.278C205.429,-162.972 223.806,-157.74 236,-146 272.45,-110.908 237.009,-74.5459 272,-38 280.518,-29.1033 292.405,-23.2123 303.862,-19.328"/>
<polygon fill="#000000" stroke="#000000" points="305.13,-22.6027 313.724,-16.4058 303.141,-15.8912 305.13,-22.6027"/>
</g>
<!-- proc~bb_cx_rates -->
<g id="proc~~halo~~CallsGraph_node23" class="node"><title>proc~bb_cx_rates</title>
<g id="a_proc~~halo~~CallsGraph_node23"><a xlink:href=".././proc/bb_cx_rates.html" xlink:title="bb_cx_rates">
<polygon fill="#d9534f" stroke="#d9534f" points="376.5,-461 305.5,-461 305.5,-437 376.5,-437 376.5,-461"/>
<text text-anchor="middle" x="341" y="-446.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bb_cx_rates</text>
</a>
</g>
</g>
<!-- proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates -->
<g id="proc~~halo~~CallsGraph_edge35" class="edge"><title>proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates</title>
<path fill="none" stroke="#000000" d="M188.843,-522.861C219.504,-507.879 271.784,-482.333 306.11,-465.56"/>
<polygon fill="#000000" stroke="#000000" points="307.835,-468.613 315.283,-461.078 304.762,-462.323 307.835,-468.613"/>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;interface~parallel_sum -->
<g id="proc~~halo~~CallsGraph_edge36" class="edge"><title>proc~parallel_merge_populations&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M194.842,-1080.11C254.958,-1103.72 387.768,-1155.88 454.73,-1182.18"/>
<polygon fill="#000000" stroke="#000000" points="453.528,-1185.47 464.115,-1185.87 456.087,-1178.96 453.528,-1185.47"/>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;proc~ind2sub -->
<g id="proc~~halo~~CallsGraph_edge38" class="edge"><title>proc~parallel_merge_populations&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M198.772,-1055.95C229.326,-1045.36 273.592,-1030.02 304.393,-1019.34"/>
<polygon fill="#000000" stroke="#000000" points="305.583,-1022.63 313.886,-1016.05 303.291,-1016.02 305.583,-1022.63"/>
</g>
<!-- proc~parallel_merge_reservoirs -->
<g id="proc~~halo~~CallsGraph_node38" class="node"><title>proc~parallel_merge_reservoirs</title>
<g id="a_proc~~halo~~CallsGraph_node38"><a xlink:href=".././proc/parallel_merge_reservoirs.html" xlink:title="parallel_merge_reservoirs">
<polygon fill="#d9534f" stroke="#d9534f" points="409.5,-1099 272.5,-1099 272.5,-1075 409.5,-1075 409.5,-1099"/>
<text text-anchor="middle" x="341" y="-1084.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_merge_reservoirs</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;proc~parallel_merge_reservoirs -->
<g id="proc~~halo~~CallsGraph_edge37" class="edge"><title>proc~parallel_merge_populations&#45;&gt;proc~parallel_merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M235.586,-1075.73C244.437,-1076.68 253.517,-1077.66 262.452,-1078.63"/>
<polygon fill="#000000" stroke="#000000" points="262.139,-1082.11 272.457,-1079.71 262.891,-1075.16 262.139,-1082.11"/>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~ind2sub -->
<g id="proc~~halo~~CallsGraph_edge40" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M198.688,-933.311C210.993,-937.775 224.604,-943.678 236,-951 254.774,-963.063 252.808,-974.615 272,-986 281.744,-991.78 293.232,-996.114 303.964,-999.296"/>
<polygon fill="#000000" stroke="#000000" points="303.373,-1002.76 313.941,-1002 305.207,-996.006 303.373,-1002.76"/>
</g>
<!-- interface~randind_cdf -->
<g id="proc~~halo~~CallsGraph_node30" class="node"><title>interface~randind_cdf</title>
<g id="a_proc~~halo~~CallsGraph_node30"><a xlink:href=".././interface/randind_cdf.html" xlink:title="randind_cdf">
<polygon fill="#a7506f" stroke="#a7506f" points="375.5,-977 306.5,-977 306.5,-953 375.5,-953 375.5,-977"/>
<text text-anchor="middle" x="341" y="-962.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind_cdf</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;interface~randind_cdf -->
<g id="proc~~halo~~CallsGraph_edge42" class="edge"><title>proc~get_nlaunch&#45;&gt;interface~randind_cdf</title>
<path fill="none" stroke="#000000" d="M198.772,-931.298C226.853,-937.999 266.518,-947.465 296.666,-954.659"/>
<polygon fill="#000000" stroke="#000000" points="295.955,-958.088 306.494,-957.004 297.58,-951.279 295.955,-958.088"/>
</g>
<!-- proc~rng_init -->
<g id="proc~~halo~~CallsGraph_node44" class="node"><title>proc~rng_init</title>
<g id="a_proc~~halo~~CallsGraph_node44"><a xlink:href=".././proc/rng_init.html" xlink:title="rng_init">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-935 314,-935 314,-911 368,-911 368,-935"/>
<text text-anchor="middle" x="341" y="-920.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rng_init</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~rng_init -->
<g id="proc~~halo~~CallsGraph_edge39" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~rng_init</title>
<path fill="none" stroke="#000000" d="M198.772,-923C229.061,-923 272.827,-923 303.59,-923"/>
<polygon fill="#000000" stroke="#000000" points="303.886,-926.5 313.886,-923 303.885,-919.5 303.886,-926.5"/>
</g>
<!-- proc~cumsum -->
<g id="proc~~halo~~CallsGraph_node45" class="node"><title>proc~cumsum</title>
<g id="a_proc~~halo~~CallsGraph_node45"><a xlink:href=".././proc/cumsum.html" xlink:title="cumsum">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-893 314,-893 314,-869 368,-869 368,-893"/>
<text text-anchor="middle" x="341" y="-878.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cumsum</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~cumsum -->
<g id="proc~~halo~~CallsGraph_edge41" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~cumsum</title>
<path fill="none" stroke="#000000" d="M198.772,-914.702C229.194,-907.442 273.209,-896.939 303.992,-889.593"/>
<polygon fill="#000000" stroke="#000000" points="304.971,-892.958 313.886,-887.232 303.346,-886.149 304.971,-892.958"/>
</g>
<!-- proc~update_reservoir -->
<g id="proc~~halo~~CallsGraph_node18" class="node"><title>proc~update_reservoir</title>
<g id="a_proc~~halo~~CallsGraph_node18"><a xlink:href=".././proc/update_reservoir.html" xlink:title="update_reservoir">
<polygon fill="#d9534f" stroke="#d9534f" points="676,-896 582,-896 582,-872 676,-872 676,-896"/>
<text text-anchor="middle" x="629" y="-881.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_reservoir</text>
</a>
</g>
</g>
<!-- proc~update_neutrals&#45;&gt;proc~update_reservoir -->
<g id="proc~~halo~~CallsGraph_edge43" class="edge"><title>proc~update_neutrals&#45;&gt;proc~update_reservoir</title>
<path fill="none" stroke="#000000" d="M208.036,-845.502C257.292,-848.426 339.432,-853.68 410,-860 464.946,-864.921 527.525,-871.959 571.497,-877.142"/>
<polygon fill="#000000" stroke="#000000" points="571.358,-880.65 581.701,-878.351 572.182,-873.698 571.358,-880.65"/>
</g>
<!-- proc~get_position -->
<g id="proc~~halo~~CallsGraph_node26" class="node"><title>proc~get_position</title>
<g id="a_proc~~halo~~CallsGraph_node26"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="531,-302 461,-302 461,-278 531,-278 531,-302"/>
<text text-anchor="middle" x="496" y="-287.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~halo~~CallsGraph_edge45" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M375.199,-325.236C397.445,-318.693 426.977,-310.007 451.152,-302.896"/>
<polygon fill="#000000" stroke="#000000" points="452.201,-306.236 460.807,-300.057 450.225,-299.521 452.201,-306.236"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~halo~~CallsGraph_node31" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~halo~~CallsGraph_node31"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="663,-243 595,-243 595,-219 663,-219 663,-243"/>
<text text-anchor="middle" x="629" y="-228.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~halo~~CallsGraph_edge44" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M375.254,-328.951C386.925,-325.774 399.685,-321.024 410,-314 431.171,-299.585 424.177,-282.408 446,-269 488.359,-242.974 545.627,-234.51 584.531,-231.896"/>
<polygon fill="#000000" stroke="#000000" points="585.203,-235.364 594.99,-231.304 584.808,-228.375 585.203,-235.364"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~halo~~CallsGraph_edge47" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M375.199,-342.594C398.836,-348.002 430.696,-355.29 455.619,-360.991"/>
<polygon fill="#000000" stroke="#000000" points="454.957,-364.43 465.486,-363.248 456.518,-357.606 454.957,-364.43"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~halo~~CallsGraph_node47" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~halo~~CallsGraph_node47"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="792,-202 724,-202 724,-178 792,-178 792,-202"/>
<text text-anchor="middle" x="758" y="-187.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~halo~~CallsGraph_edge46" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M375.106,-334.23C415.968,-332.571 487.255,-327.358 546,-311 607.124,-293.979 621.568,-284.604 676,-252 697.15,-239.331 719.252,-222.105 735.015,-209.026"/>
<polygon fill="#000000" stroke="#000000" points="737.678,-211.359 743.074,-202.241 733.17,-206.004 737.678,-211.359"/>
</g>
<!-- proc~get_passive_grid_indices -->
<g id="proc~~halo~~CallsGraph_node32" class="node"><title>proc~get_passive_grid_indices</title>
<g id="a_proc~~halo~~CallsGraph_node32"><a xlink:href=".././proc/get_passive_grid_indices.html" xlink:title="get_passive_grid_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="407.5,-137 274.5,-137 274.5,-113 407.5,-113 407.5,-137"/>
<text text-anchor="middle" x="341" y="-122.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_passive_grid_indices</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_passive_grid_indices -->
<g id="proc~~halo~~CallsGraph_edge48" class="edge"><title>proc~store_photons&#45;&gt;proc~get_passive_grid_indices</title>
<path fill="none" stroke="#000000" d="M203.512,-201.87C214.593,-198.735 226.262,-194.283 236,-188 256.659,-174.671 251.447,-159.491 272,-146 274.602,-144.292 277.35,-142.717 280.19,-141.266"/>
<polygon fill="#000000" stroke="#000000" points="281.85,-144.356 289.51,-137.036 278.957,-137.982 281.85,-144.356"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_indices -->
<g id="proc~~halo~~CallsGraph_edge49" class="edge"><title>proc~store_photons&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M203.937,-209C231.758,-209 268.824,-209 297.243,-209"/>
<polygon fill="#000000" stroke="#000000" points="297.289,-212.5 307.289,-209 297.289,-205.5 297.289,-212.5"/>
</g>
<!-- proc~spectrum -->
<g id="proc~~halo~~CallsGraph_node36" class="node"><title>proc~spectrum</title>
<g id="a_proc~~halo~~CallsGraph_node36"><a xlink:href=".././proc/spectrum.html" xlink:title="spectrum">
<polygon fill="#d9534f" stroke="#d9534f" points="369.5,-179 312.5,-179 312.5,-155 369.5,-155 369.5,-179"/>
<text text-anchor="middle" x="341" y="-164.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spectrum</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~spectrum -->
<g id="proc~~halo~~CallsGraph_edge50" class="edge"><title>proc~store_photons&#45;&gt;proc~spectrum</title>
<path fill="none" stroke="#000000" d="M203.937,-199.47C233.513,-192.412 273.538,-182.86 302.514,-175.946"/>
<polygon fill="#000000" stroke="#000000" points="303.353,-179.344 312.267,-173.618 301.728,-172.535 303.353,-179.344"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_fields -->
<g id="proc~~halo~~CallsGraph_edge51" class="edge"><title>proc~store_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M203.937,-218.53C233.422,-225.567 273.292,-235.081 302.247,-241.991"/>
<polygon fill="#000000" stroke="#000000" points="301.459,-245.401 311.998,-244.318 303.084,-238.592 301.459,-245.401"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~halo~~CallsGraph_edge52" class="edge"><title>proc~store_photons&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M203.746,-203.966C215.211,-200.888 227.032,-195.942 236,-188 266.406,-161.07 240.615,-129.783 272,-104 333.091,-53.8134 367.371,-75.2675 446,-67 547.686,-56.3081 586.459,-22.6367 676,-72 714.012,-92.9558 737.863,-140.255 749.18,-168.189"/>
<polygon fill="#000000" stroke="#000000" points="746.043,-169.781 752.907,-177.852 752.574,-167.262 746.043,-169.781"/>
</g>
<!-- interface~randu -->
<g id="proc~~halo~~CallsGraph_node29" class="node"><title>interface~randu</title>
<g id="a_proc~~halo~~CallsGraph_node29"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="907,-936 853,-936 853,-912 907,-912 907,-936"/>
<text text-anchor="middle" x="880" y="-921.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~mc_beam_grid&#45;&gt;interface~randu -->
<g id="proc~~halo~~CallsGraph_edge53" class="edge"><title>proc~mc_beam_grid&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M789.446,-834.231C794.501,-836.81 799.542,-839.748 804,-843 827.817,-860.374 850.092,-886.115 864.078,-903.894"/>
<polygon fill="#000000" stroke="#000000" points="861.375,-906.122 870.248,-911.911 866.922,-901.852 861.375,-906.122"/>
</g>
<!-- proc~merge_neutral_populations&#45;&gt;proc~ind2sub -->
<g id="proc~~halo~~CallsGraph_edge55" class="edge"><title>proc~merge_neutral_populations&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M234.572,-1007C258.243,-1007 283.666,-1007 303.616,-1007"/>
<polygon fill="#000000" stroke="#000000" points="303.8,-1010.5 313.8,-1007 303.8,-1003.5 303.8,-1010.5"/>
</g>
<!-- proc~merge_reservoirs -->
<g id="proc~~halo~~CallsGraph_node39" class="node"><title>proc~merge_reservoirs</title>
<g id="a_proc~~halo~~CallsGraph_node39"><a xlink:href=".././proc/merge_reservoirs.html" xlink:title="merge_reservoirs">
<polygon fill="#d9534f" stroke="#d9534f" points="544.5,-1014 447.5,-1014 447.5,-990 544.5,-990 544.5,-1014"/>
<text text-anchor="middle" x="496" y="-999.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">merge_reservoirs</text>
</a>
</g>
</g>
<!-- proc~merge_neutral_populations&#45;&gt;proc~merge_reservoirs -->
<g id="proc~~halo~~CallsGraph_edge54" class="edge"><title>proc~merge_neutral_populations&#45;&gt;proc~merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M215.071,-1019.02C232.967,-1022.67 253.272,-1026.2 272,-1028 333.051,-1033.88 349.341,-1037.07 410,-1028 424.615,-1025.81 440.189,-1021.63 453.96,-1017.24"/>
<polygon fill="#000000" stroke="#000000" points="455.238,-1020.5 463.629,-1014.04 453.036,-1013.86 455.238,-1020.5"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~halo~~CallsGraph_edge56" class="edge"><title>proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M673.351,-1168.24C683.16,-1170.56 693.684,-1173.04 703.844,-1175.44"/>
<polygon fill="#000000" stroke="#000000" points="703.308,-1178.91 713.844,-1177.81 704.917,-1172.1 703.308,-1178.91"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_node51" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="919.5,-1277 840.5,-1277 840.5,-1253 919.5,-1253 919.5,-1277"/>
<text text-anchor="middle" x="880" y="-1262.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge57" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M673.04,-1150.6C709.956,-1146.42 763.45,-1145.65 804,-1167 835.683,-1183.68 857.963,-1220.35 869.614,-1243.8"/>
<polygon fill="#000000" stroke="#000000" points="866.504,-1245.41 873.953,-1252.94 872.828,-1242.41 866.504,-1245.41"/>
</g>
<!-- proc~update_reservoir&#45;&gt;interface~randu -->
<g id="proc~~halo~~CallsGraph_edge59" class="edge"><title>proc~update_reservoir&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M676.251,-891.43C724.427,-899.169 798.89,-911.131 842.903,-918.201"/>
<polygon fill="#000000" stroke="#000000" points="842.444,-921.672 852.873,-919.803 843.554,-914.761 842.444,-921.672"/>
</g>
<!-- interface~randind -->
<g id="proc~~halo~~CallsGraph_node55" class="node"><title>interface~randind</title>
<g id="a_proc~~halo~~CallsGraph_node55"><a xlink:href=".././interface/randind.html" xlink:title="randind">
<polygon fill="#a7506f" stroke="#a7506f" points="785,-876 731,-876 731,-852 785,-852 785,-876"/>
<text text-anchor="middle" x="758" y="-861.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind</text>
</a>
</g>
</g>
<!-- proc~update_reservoir&#45;&gt;interface~randind -->
<g id="proc~~halo~~CallsGraph_edge60" class="edge"><title>proc~update_reservoir&#45;&gt;interface~randind</title>
<path fill="none" stroke="#000000" d="M676.209,-876.723C690.903,-874.409 706.935,-871.884 720.815,-869.698"/>
<polygon fill="#000000" stroke="#000000" points="721.619,-873.115 730.952,-868.102 720.53,-866.2 721.619,-873.115"/>
</g>
<!-- proc~init_reservoir -->
<g id="proc~~halo~~CallsGraph_node58" class="node"><title>proc~init_reservoir</title>
<g id="a_proc~~halo~~CallsGraph_node58"><a xlink:href=".././proc/init_reservoir.html" xlink:title="init_reservoir">
<polygon fill="#d9534f" stroke="#d9534f" points="795,-956 721,-956 721,-932 795,-932 795,-956"/>
<text text-anchor="middle" x="758" y="-941.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_reservoir</text>
</a>
</g>
</g>
<!-- proc~update_reservoir&#45;&gt;proc~init_reservoir -->
<g id="proc~~halo~~CallsGraph_edge58" class="edge"><title>proc~update_reservoir&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M655.7,-896.142C674.808,-905.169 701.095,-917.588 722.102,-927.513"/>
<polygon fill="#000000" stroke="#000000" points="720.801,-930.769 731.338,-931.876 723.791,-924.44 720.801,-930.769"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_edge61" class="edge"><title>proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M668.104,-1334C680.921,-1338.04 695.391,-1342.6 708.876,-1346.84"/>
<polygon fill="#000000" stroke="#000000" points="707.894,-1350.2 718.484,-1349.87 709.997,-1343.53 707.894,-1350.2"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge62" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M674.529,-1313.67C709.796,-1306.85 760.237,-1296.64 804,-1286 812.592,-1283.91 821.687,-1281.52 830.469,-1279.12"/>
<polygon fill="#000000" stroke="#000000" points="831.508,-1282.46 840.208,-1276.41 829.636,-1275.71 831.508,-1282.46"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_edge63" class="edge"><title>proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M659.2,-1292.17C664.887,-1294.86 670.719,-1297.86 676,-1301 697.06,-1313.53 719.17,-1330.48 734.959,-1343.32"/>
<polygon fill="#000000" stroke="#000000" points="733.093,-1346.32 743.033,-1349.99 737.548,-1340.92 733.093,-1346.32"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge64" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M674.516,-1277.32C718.251,-1274.68 784.821,-1270.67 830.031,-1267.95"/>
<polygon fill="#000000" stroke="#000000" points="830.414,-1271.43 840.186,-1267.34 829.993,-1264.45 830.414,-1271.43"/>
</g>
<!-- dgetrf -->
<g id="proc~~halo~~CallsGraph_node52" class="node"><title>dgetrf</title>
<polygon fill="#777777" stroke="#777777" points="523,-752 469,-752 469,-728 523,-728 523,-752"/>
<text text-anchor="middle" x="496" y="-737.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrf</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrf -->
<g id="proc~~halo~~CallsGraph_edge67" class="edge"><title>proc~linsolve&#45;&gt;dgetrf</title>
<path fill="none" stroke="#000000" d="M368.302,-722.61C393.227,-726.031 430.881,-731.199 458.667,-735.013"/>
<polygon fill="#000000" stroke="#000000" points="458.403,-738.51 468.786,-736.402 459.355,-731.575 458.403,-738.51"/>
</g>
<!-- proc~matinv -->
<g id="proc~~halo~~CallsGraph_node60" class="node"><title>proc~matinv</title>
<g id="a_proc~~halo~~CallsGraph_node60"><a xlink:href=".././proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="523,-794 469,-794 469,-770 523,-770 523,-794"/>
<text text-anchor="middle" x="496" y="-779.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~linsolve&#45;&gt;proc~matinv -->
<g id="proc~~halo~~CallsGraph_edge65" class="edge"><title>proc~linsolve&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M368.302,-729.83C393.447,-740.184 431.546,-755.872 459.399,-767.341"/>
<polygon fill="#000000" stroke="#000000" points="458.207,-770.635 468.786,-771.206 460.872,-764.162 458.207,-770.635"/>
</g>
<!-- dgetrs -->
<g id="proc~~halo~~CallsGraph_node66" class="node"><title>dgetrs</title>
<polygon fill="#777777" stroke="#777777" points="523,-710 469,-710 469,-686 523,-686 523,-710"/>
<text text-anchor="middle" x="496" y="-695.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrs</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrs -->
<g id="proc~~halo~~CallsGraph_edge66" class="edge"><title>proc~linsolve&#45;&gt;dgetrs</title>
<path fill="none" stroke="#000000" d="M368.302,-715.39C393.227,-711.969 430.881,-706.801 458.667,-702.987"/>
<polygon fill="#000000" stroke="#000000" points="459.355,-706.425 468.786,-701.598 458.403,-699.49 459.355,-706.425"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~halo~~CallsGraph_node67" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~halo~~CallsGraph_node67"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="667.5,-422 590.5,-422 590.5,-398 667.5,-398 667.5,-422"/>
<text text-anchor="middle" x="629" y="-407.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~bb_cx_rates&#45;&gt;interface~interpol_coeff -->
<g id="proc~~halo~~CallsGraph_edge68" class="edge"><title>proc~bb_cx_rates&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M376.652,-443.895C396.869,-440.943 422.869,-437.193 446,-434 491.596,-427.706 543.67,-420.875 580.401,-416.116"/>
<polygon fill="#000000" stroke="#000000" points="580.868,-419.585 590.337,-414.831 579.97,-412.643 580.868,-419.585"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge69" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M792.351,-1078.06C796.614,-1080.56 800.651,-1083.52 804,-1087 847.422,-1132.1 867.398,-1206.08 875.032,-1242.84"/>
<polygon fill="#000000" stroke="#000000" points="871.661,-1243.84 877.018,-1252.98 878.531,-1242.49 871.661,-1243.84"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_edge70" class="edge"><title>proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M659.2,-1431.83C664.887,-1429.14 670.719,-1426.14 676,-1423 697.06,-1410.47 719.17,-1393.52 734.959,-1380.68"/>
<polygon fill="#000000" stroke="#000000" points="737.548,-1383.08 743.033,-1374.01 733.093,-1377.68 737.548,-1383.08"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge71" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M674.607,-1449.82C712.516,-1452.34 766.586,-1449.93 804,-1423 849.365,-1390.35 868.268,-1322.96 875.309,-1287.67"/>
<polygon fill="#000000" stroke="#000000" points="878.826,-1287.9 877.197,-1277.43 871.942,-1286.63 878.826,-1287.9"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~halo~~CallsGraph_node49" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~halo~~CallsGraph_node49"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="660,-342 598,-342 598,-318 660,-318 660,-342"/>
<text text-anchor="middle" x="629" y="-327.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~halo~~CallsGraph_edge72" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M531.077,-300.405C548.475,-305.718 569.75,-312.214 587.931,-317.765"/>
<polygon fill="#000000" stroke="#000000" points="587.082,-321.165 597.668,-320.738 589.126,-314.471 587.082,-321.165"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~halo~~CallsGraph_edge73" class="edge"><title>proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M660.743,-1225.9C677.467,-1219.31 698.365,-1211.08 716.412,-1203.98"/>
<polygon fill="#000000" stroke="#000000" points="718.077,-1207.09 726.1,-1200.17 715.513,-1200.57 718.077,-1207.09"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge74" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M673.088,-1242.67C716.828,-1247.42 784.44,-1254.75 830.146,-1259.7"/>
<polygon fill="#000000" stroke="#000000" points="829.801,-1263.19 840.12,-1260.78 830.556,-1256.23 829.801,-1263.19"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~halo~~CallsGraph_edge75" class="edge"><title>proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M737.828,-1200.01C730.784,-1208.97 737.508,-1218 758,-1218 770.487,-1218 777.862,-1214.65 780.124,-1210"/>
<polygon fill="#000000" stroke="#000000" points="783.526,-1209.16 778.172,-1200.01 776.656,-1210.5 783.526,-1209.16"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge76" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M777.75,-1200.03C797.536,-1212.73 828.921,-1232.87 851.505,-1247.36"/>
<polygon fill="#000000" stroke="#000000" points="849.679,-1250.34 859.986,-1252.8 853.459,-1244.45 849.679,-1250.34"/>
</g>
<!-- proc~xyz_to_cyl -->
<g id="proc~~halo~~CallsGraph_node61" class="node"><title>proc~xyz_to_cyl</title>
<g id="a_proc~~halo~~CallsGraph_node61"><a xlink:href=".././proc/xyz_to_cyl.html" xlink:title="xyz_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="527,-142 465,-142 465,-118 527,-118 527,-142"/>
<text text-anchor="middle" x="496" y="-127.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_cyl</text>
</a>
</g>
</g>
<!-- proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl -->
<g id="proc~~halo~~CallsGraph_edge77" class="edge"><title>proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl</title>
<path fill="none" stroke="#000000" d="M407.774,-127.149C423.806,-127.673 440.48,-128.218 454.903,-128.69"/>
<polygon fill="#000000" stroke="#000000" points="454.857,-132.19 464.966,-129.018 455.086,-125.194 454.857,-132.19"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~halo~~CallsGraph_node48" class="node"><title>proc~hqr2</title>
<g id="a_proc~~halo~~CallsGraph_node48"><a xlink:href=".././proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="523,-542 469,-542 469,-518 523,-518 523,-542"/>
<text text-anchor="middle" x="496" y="-527.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~halo~~CallsGraph_edge78" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M368.302,-582.17C393.447,-571.816 431.546,-556.128 459.399,-544.659"/>
<polygon fill="#000000" stroke="#000000" points="460.872,-547.838 468.786,-540.794 458.207,-541.365 460.872,-547.838"/>
</g>
<!-- proc~balback -->
<g id="proc~~halo~~CallsGraph_node53" class="node"><title>proc~balback</title>
<g id="a_proc~~halo~~CallsGraph_node53"><a xlink:href=".././proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="523,-626 469,-626 469,-602 523,-602 523,-626"/>
<text text-anchor="middle" x="496" y="-611.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~halo~~CallsGraph_edge79" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M368.302,-596.61C393.227,-600.031 430.881,-605.199 458.667,-609.013"/>
<polygon fill="#000000" stroke="#000000" points="458.403,-612.51 468.786,-610.402 459.355,-605.575 458.403,-612.51"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~halo~~CallsGraph_node54" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~halo~~CallsGraph_node54"><a xlink:href=".././proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="523,-500 469,-500 469,-476 523,-476 523,-500"/>
<text text-anchor="middle" x="496" y="-485.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~halo~~CallsGraph_edge80" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M360.813,-580.981C374.83,-571.73 394.196,-558.313 410,-545 427.306,-530.422 427.263,-521.686 446,-509 450.25,-506.123 454.958,-503.507 459.726,-501.173"/>
<polygon fill="#000000" stroke="#000000" points="461.195,-504.35 468.865,-497.041 458.311,-497.972 461.195,-504.35"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~halo~~CallsGraph_node57" class="node"><title>proc~elmhes</title>
<g id="a_proc~~halo~~CallsGraph_node57"><a xlink:href=".././proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="523,-668 469,-668 469,-644 523,-644 523,-668"/>
<text text-anchor="middle" x="496" y="-653.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~halo~~CallsGraph_edge81" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M368.302,-603.83C393.447,-614.184 431.546,-629.872 459.399,-641.341"/>
<polygon fill="#000000" stroke="#000000" points="458.207,-644.635 468.786,-645.206 460.872,-638.162 458.207,-644.635"/>
</g>
<!-- proc~balance -->
<g id="proc~~halo~~CallsGraph_node62" class="node"><title>proc~balance</title>
<g id="a_proc~~halo~~CallsGraph_node62"><a xlink:href=".././proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="523,-584 469,-584 469,-560 523,-560 523,-584"/>
<text text-anchor="middle" x="496" y="-569.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~halo~~CallsGraph_edge82" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M368.302,-589.39C393.227,-585.969 430.881,-580.801 458.667,-576.987"/>
<polygon fill="#000000" stroke="#000000" points="459.355,-580.425 468.786,-575.598 458.403,-573.49 459.355,-580.425"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_edge83" class="edge"><title>proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M737.828,-1374.01C730.784,-1382.97 737.508,-1392 758,-1392 770.487,-1392 777.862,-1388.65 780.124,-1384"/>
<polygon fill="#000000" stroke="#000000" points="783.526,-1383.16 778.172,-1374.01 776.656,-1384.5 783.526,-1383.16"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge84" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M782.55,-1349.77C789.664,-1345.72 797.347,-1340.96 804,-1336 824.927,-1320.39 846.313,-1299.56 860.865,-1284.51"/>
<polygon fill="#000000" stroke="#000000" points="863.447,-1286.87 867.813,-1277.22 858.38,-1282.04 863.447,-1286.87"/>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;interface~parallel_sum -->
<g id="proc~~halo~~CallsGraph_edge85" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M361.02,-1099.04C374.801,-1107.89 393.783,-1120.36 410,-1132 431.458,-1147.4 455.135,-1165.91 472.039,-1179.41"/>
<polygon fill="#000000" stroke="#000000" points="470.222,-1182.44 480.213,-1185.97 474.603,-1176.98 470.222,-1182.44"/>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~merge_reservoirs -->
<g id="proc~~halo~~CallsGraph_edge89" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M380.965,-1074.98C390.791,-1071.19 401.076,-1066.52 410,-1061 428.463,-1049.59 428.271,-1040.52 446,-1028 450.523,-1024.81 455.486,-1021.73 460.464,-1018.89"/>
<polygon fill="#000000" stroke="#000000" points="462.244,-1021.91 469.347,-1014.05 458.892,-1015.76 462.244,-1021.91"/>
</g>
<!-- proc~my_rank -->
<g id="proc~~halo~~CallsGraph_node56" class="node"><title>proc~my_rank</title>
<g id="a_proc~~halo~~CallsGraph_node56"><a xlink:href=".././proc/my_rank.html" xlink:title="my_rank">
<polygon fill="#d94e8f" stroke="#d94e8f" points="523,-972 469,-972 469,-948 523,-948 523,-972"/>
<text text-anchor="middle" x="496" y="-957.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">my_rank</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~my_rank -->
<g id="proc~~halo~~CallsGraph_edge86" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~my_rank</title>
<path fill="none" stroke="#000000" d="M357.65,-1074.94C371.973,-1063.55 393.4,-1045.65 410,-1028 428.03,-1008.84 425.23,-997.154 446,-981 450.14,-977.78 454.849,-974.956 459.671,-972.512"/>
<polygon fill="#000000" stroke="#000000" points="461.319,-975.607 468.965,-968.272 458.414,-969.238 461.319,-975.607"/>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~init_reservoir -->
<g id="proc~~halo~~CallsGraph_edge87" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M390.743,-1074.94C456.602,-1058.01 577.143,-1024.77 676,-985 693.195,-978.082 711.684,-968.869 726.65,-960.928"/>
<polygon fill="#000000" stroke="#000000" points="728.324,-964.002 735.471,-956.181 725.006,-957.839 728.324,-964.002"/>
</g>
<!-- proc~num_ranks -->
<g id="proc~~halo~~CallsGraph_node65" class="node"><title>proc~num_ranks</title>
<g id="a_proc~~halo~~CallsGraph_node65"><a xlink:href=".././proc/num_ranks.html" xlink:title="num_ranks">
<polygon fill="#d94e8f" stroke="#d94e8f" points="529,-1099 463,-1099 463,-1075 529,-1075 529,-1099"/>
<text text-anchor="middle" x="496" y="-1084.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">num_ranks</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~num_ranks -->
<g id="proc~~halo~~CallsGraph_edge88" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~num_ranks</title>
<path fill="none" stroke="#000000" d="M409.553,-1087C424.208,-1087 439.306,-1087 452.658,-1087"/>
<polygon fill="#000000" stroke="#000000" points="452.95,-1090.5 462.949,-1087 452.949,-1083.5 452.95,-1090.5"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;proc~update_reservoir -->
<g id="proc~~halo~~CallsGraph_edge93" class="edge"><title>proc~merge_reservoirs&#45;&gt;proc~update_reservoir</title>
<path fill="none" stroke="#000000" d="M533.569,-989.794C538.066,-987.329 542.354,-984.418 546,-981 571.81,-956.801 557.554,-935.576 582,-910 584.924,-906.941 588.287,-904.141 591.837,-901.604"/>
<polygon fill="#000000" stroke="#000000" points="593.798,-904.505 600.339,-896.17 590.028,-898.607 593.798,-904.505"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;interface~randu -->
<g id="proc~~halo~~CallsGraph_edge91" class="edge"><title>proc~merge_reservoirs&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M544.624,-1002.29C606.148,-1001.31 715.812,-994.974 804,-965 820.942,-959.241 838.565,-949.811 852.467,-941.445"/>
<polygon fill="#000000" stroke="#000000" points="854.36,-944.39 861.021,-936.151 850.676,-938.438 854.36,-944.39"/>
</g>
<!-- float -->
<g id="proc~~halo~~CallsGraph_node50" class="node"><title>float</title>
<polygon fill="#777777" stroke="#777777" points="656,-976 602,-976 602,-952 656,-952 656,-976"/>
<text text-anchor="middle" x="629" y="-961.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">float</text>
</g>
<!-- proc~merge_reservoirs&#45;&gt;float -->
<g id="proc~~halo~~CallsGraph_edge92" class="edge"><title>proc~merge_reservoirs&#45;&gt;float</title>
<path fill="none" stroke="#000000" d="M538.449,-989.977C555.582,-985.007 575.264,-979.297 591.805,-974.499"/>
<polygon fill="#000000" stroke="#000000" points="593.019,-977.792 601.648,-971.644 591.069,-971.069 593.019,-977.792"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;proc~init_reservoir -->
<g id="proc~~halo~~CallsGraph_edge90" class="edge"><title>proc~merge_reservoirs&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M530.143,-989.996C535.648,-987.393 541.14,-984.387 546,-981 565.087,-967.698 560.629,-952.192 582,-943 622.946,-925.388 674.434,-928.29 710.935,-933.979"/>
<polygon fill="#000000" stroke="#000000" points="710.368,-937.432 720.811,-935.642 711.531,-930.53 710.368,-937.432"/>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge94" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M785.401,-1120.17C791.968,-1123.98 798.651,-1128.63 804,-1134 836.142,-1166.27 859.21,-1215.1 870.709,-1243.13"/>
<polygon fill="#000000" stroke="#000000" points="867.598,-1244.78 874.545,-1252.78 874.103,-1242.2 867.598,-1244.78"/>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~halo~~CallsGraph_edge95" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M361.355,-511.873C381.815,-499.42 415.31,-480.064 446,-467 458.603,-461.635 530.95,-439.392 580.544,-424.331"/>
<polygon fill="#000000" stroke="#000000" points="581.581,-427.674 590.135,-421.421 579.549,-420.975 581.581,-427.674"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~halo~~CallsGraph_edge96" class="edge"><title>proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M668.104,-1390C680.921,-1385.96 695.391,-1381.4 708.876,-1377.16"/>
<polygon fill="#000000" stroke="#000000" points="709.997,-1380.47 718.484,-1374.13 707.894,-1373.8 709.997,-1380.47"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~halo~~CallsGraph_edge97" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M674.757,-1413.54C712.005,-1420.52 765.048,-1424.15 804,-1401 845.674,-1376.23 865.806,-1319.17 874.098,-1287.39"/>
<polygon fill="#000000" stroke="#000000" points="877.59,-1287.84 876.553,-1277.3 870.788,-1286.19 877.59,-1287.84"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~halo~~CallsGraph_edge99" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M508.625,-357.665C531.406,-333.493 582.082,-279.722 609.51,-250.619"/>
<polygon fill="#000000" stroke="#000000" points="612.276,-252.787 616.588,-243.109 607.182,-247.986 612.276,-252.787"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~halo~~CallsGraph_node64" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~halo~~CallsGraph_node64"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="790.5,-362 725.5,-362 725.5,-338 790.5,-338 790.5,-362"/>
<text text-anchor="middle" x="758" y="-347.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~halo~~CallsGraph_edge98" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M526.572,-367.725C572.865,-364.164 662.6,-357.262 715.391,-353.201"/>
<polygon fill="#000000" stroke="#000000" points="715.731,-356.685 725.433,-352.428 715.194,-349.706 715.731,-356.685"/>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~halo~~CallsGraph_edge100" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M526.726,-379.077C542.649,-383.939 562.642,-390.043 580.648,-395.541"/>
<polygon fill="#000000" stroke="#000000" points="579.822,-398.949 590.409,-398.522 581.867,-392.254 579.822,-398.949"/>
</g>
<!-- proc~rng_init&#45;&gt;proc~my_rank -->
<g id="proc~~halo~~CallsGraph_edge101" class="edge"><title>proc~rng_init&#45;&gt;proc~my_rank</title>
<path fill="none" stroke="#000000" d="M368.302,-929.361C393.337,-935.415 431.213,-944.574 459.034,-951.302"/>
<polygon fill="#000000" stroke="#000000" points="458.243,-954.712 468.786,-953.661 459.889,-947.908 458.243,-954.712"/>
</g>
<!-- proc~rng_seed -->
<g id="proc~~halo~~CallsGraph_node59" class="node"><title>proc~rng_seed</title>
<g id="a_proc~~halo~~CallsGraph_node59"><a xlink:href=".././proc/rng_seed.html" xlink:title="rng_seed">
<polygon fill="#d94e8f" stroke="#d94e8f" points="525,-930 467,-930 467,-906 525,-906 525,-930"/>
<text text-anchor="middle" x="496" y="-915.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rng_seed</text>
</a>
</g>
</g>
<!-- proc~rng_init&#45;&gt;proc~rng_seed -->
<g id="proc~~halo~~CallsGraph_edge102" class="edge"><title>proc~rng_init&#45;&gt;proc~rng_seed</title>
<path fill="none" stroke="#000000" d="M368.302,-922.14C392.697,-921.343 429.285,-920.148 456.88,-919.246"/>
<polygon fill="#000000" stroke="#000000" points="457.092,-922.741 466.972,-918.916 456.863,-915.745 457.092,-922.741"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~halo~~CallsGraph_edge104" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M370.063,-258.153C392.682,-263.919 424.899,-272.131 450.952,-278.772"/>
<polygon fill="#000000" stroke="#000000" points="450.41,-282.246 460.964,-281.324 452.139,-275.463 450.41,-282.246"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~halo~~CallsGraph_edge103" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M370.148,-246.039C391.015,-242.582 420.19,-238.208 446,-236 493.153,-231.965 547.404,-230.94 584.322,-230.784"/>
<polygon fill="#000000" stroke="#000000" points="584.732,-234.283 594.724,-230.761 584.716,-227.283 584.732,-234.283"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~halo~~CallsGraph_edge105" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M370.331,-256.03C383.168,-259.212 398.099,-264.238 410,-272 414.231,-274.76 454.291,-321.798 477.875,-349.687"/>
<polygon fill="#000000" stroke="#000000" points="475.48,-352.276 484.607,-357.657 480.828,-347.759 475.48,-352.276"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~halo~~CallsGraph_edge107" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M370.012,-248.505C383.717,-245.899 399.483,-240.626 410,-230 449.468,-190.121 401.024,-142.543 446,-109 527.943,-47.8871 581.559,-69.8812 676,-109 705.317,-121.144 729.556,-149.617 743.657,-169.346"/>
<polygon fill="#000000" stroke="#000000" points="740.855,-171.448 749.405,-177.705 746.623,-167.482 740.855,-171.448"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~halo~~CallsGraph_node63" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~halo~~CallsGraph_node63"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="546,-184 446,-184 446,-160 546,-160 546,-184"/>
<text text-anchor="middle" x="496" y="-169.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~halo~~CallsGraph_edge106" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M370.229,-245.166C382.901,-241.835 397.728,-236.914 410,-230 428.651,-219.492 428.42,-210.215 446,-198 450.547,-194.84 455.524,-191.788 460.508,-188.955"/>
<polygon fill="#000000" stroke="#000000" points="462.287,-191.972 469.395,-184.115 458.939,-185.824 462.287,-191.972"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~halo~~CallsGraph_node71" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~halo~~CallsGraph_node71"><a xlink:href=".././proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="656,-542 602,-542 602,-518 656,-518 656,-542"/>
<text text-anchor="middle" x="629" y="-527.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~halo~~CallsGraph_edge108" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M523.195,-530C542.83,-530 569.943,-530 591.672,-530"/>
<polygon fill="#000000" stroke="#000000" points="591.85,-533.5 601.85,-530 591.85,-526.5 591.85,-533.5"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~halo~~CallsGraph_edge110" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M656.163,-317.82C663.027,-313.951 670.141,-309.283 676,-304 706.404,-276.585 731.897,-235.828 745.758,-211.197"/>
<polygon fill="#000000" stroke="#000000" points="748.893,-212.759 750.647,-202.31 742.76,-209.385 748.893,-212.759"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~halo~~CallsGraph_edge109" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M660.097,-334.74C676.607,-337.34 697.328,-340.603 715.367,-343.444"/>
<polygon fill="#000000" stroke="#000000" points="714.924,-346.917 725.347,-345.015 716.013,-340.002 714.924,-346.917"/>
</g>
<!-- proc~rswap -->
<g id="proc~~halo~~CallsGraph_node69" class="node"><title>proc~rswap</title>
<g id="a_proc~~halo~~CallsGraph_node69"><a xlink:href=".././proc/rswap.html" xlink:title="RSWAP">
<polygon fill="#d9534f" stroke="#d9534f" points="656,-626 602,-626 602,-602 656,-602 656,-626"/>
<text text-anchor="middle" x="629" y="-611.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RSWAP</text>
</a>
</g>
</g>
<!-- proc~balback&#45;&gt;proc~rswap -->
<g id="proc~~halo~~CallsGraph_edge111" class="edge"><title>proc~balback&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M523.195,-614C542.83,-614 569.943,-614 591.672,-614"/>
<polygon fill="#000000" stroke="#000000" points="591.85,-617.5 601.85,-614 591.85,-610.5 591.85,-617.5"/>
</g>
<!-- proc~elmhes&#45;&gt;proc~rswap -->
<g id="proc~~halo~~CallsGraph_edge112" class="edge"><title>proc~elmhes&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M523.195,-647.602C543.008,-641.249 570.436,-632.456 592.263,-625.458"/>
<polygon fill="#000000" stroke="#000000" points="593.396,-628.77 601.85,-622.384 591.259,-622.104 593.396,-628.77"/>
</g>
<!-- proc~init_reservoir&#45;&gt;interface~randu -->
<g id="proc~~halo~~CallsGraph_edge113" class="edge"><title>proc~init_reservoir&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M795.004,-937.999C810.149,-935.475 827.736,-932.544 842.892,-930.018"/>
<polygon fill="#000000" stroke="#000000" points="843.648,-933.44 852.936,-928.344 842.497,-926.536 843.648,-933.44"/>
</g>
<!-- proc~lubksb -->
<g id="proc~~halo~~CallsGraph_node68" class="node"><title>proc~lubksb</title>
<g id="a_proc~~halo~~CallsGraph_node68"><a xlink:href=".././proc/lubksb.html" xlink:title="lubksb">
<polygon fill="#d9534f" stroke="#d9534f" points="656,-794 602,-794 602,-770 656,-770 656,-794"/>
<text text-anchor="middle" x="629" y="-779.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lubksb</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~lubksb -->
<g id="proc~~halo~~CallsGraph_edge115" class="edge"><title>proc~matinv&#45;&gt;proc~lubksb</title>
<path fill="none" stroke="#000000" d="M523.195,-782C542.83,-782 569.943,-782 591.672,-782"/>
<polygon fill="#000000" stroke="#000000" points="591.85,-785.5 601.85,-782 591.85,-778.5 591.85,-785.5"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~halo~~CallsGraph_node72" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~halo~~CallsGraph_node72"><a xlink:href=".././proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="656,-752 602,-752 602,-728 656,-728 656,-752"/>
<text text-anchor="middle" x="629" y="-737.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~halo~~CallsGraph_edge114" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M523.195,-773.602C543.008,-767.249 570.436,-758.456 592.263,-751.458"/>
<polygon fill="#000000" stroke="#000000" points="593.396,-754.77 601.85,-748.384 591.259,-748.104 593.396,-754.77"/>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~halo~~CallsGraph_edge116" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M527.191,-140.866C533.632,-143.745 540.228,-147.144 546,-151 571.298,-167.901 595.641,-193.168 611.138,-210.768"/>
<polygon fill="#000000" stroke="#000000" points="608.818,-213.437 618,-218.723 614.118,-208.865 608.818,-213.437"/>
</g>
<!-- proc~uvw_to_cyl -->
<g id="proc~~halo~~CallsGraph_node70" class="node"><title>proc~uvw_to_cyl</title>
<g id="a_proc~~halo~~CallsGraph_node70"><a xlink:href=".././proc/uvw_to_cyl.html" xlink:title="uvw_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="661.5,-142 596.5,-142 596.5,-118 661.5,-118 661.5,-142"/>
<text text-anchor="middle" x="629" y="-127.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_cyl</text>
</a>
</g>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl -->
<g id="proc~~halo~~CallsGraph_edge117" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl</title>
<path fill="none" stroke="#000000" d="M527.054,-130C544.598,-130 566.998,-130 586.238,-130"/>
<polygon fill="#000000" stroke="#000000" points="586.259,-133.5 596.259,-130 586.258,-126.5 586.259,-133.5"/>
</g>
<!-- proc~balance&#45;&gt;proc~rswap -->
<g id="proc~~halo~~CallsGraph_edge118" class="edge"><title>proc~balance&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M523.195,-580.398C543.008,-586.751 570.436,-595.544 592.263,-602.542"/>
<polygon fill="#000000" stroke="#000000" points="591.259,-605.896 601.85,-605.616 593.396,-599.23 591.259,-605.896"/>
</g>
<!-- proc~comdiv -->
<g id="proc~~halo~~CallsGraph_node75" class="node"><title>proc~comdiv</title>
<g id="a_proc~~halo~~CallsGraph_node75"><a xlink:href=".././proc/comdiv.html" xlink:title="Comdiv">
<polygon fill="#d9534f" stroke="#d9534f" points="785,-542 731,-542 731,-518 785,-518 785,-542"/>
<text text-anchor="middle" x="758" y="-527.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Comdiv</text>
</a>
</g>
</g>
<!-- proc~hqrvec&#45;&gt;proc~comdiv -->
<g id="proc~~halo~~CallsGraph_edge119" class="edge"><title>proc~hqrvec&#45;&gt;proc~comdiv</title>
<path fill="none" stroke="#000000" d="M656.007,-530C674.631,-530 699.959,-530 720.591,-530"/>
<polygon fill="#000000" stroke="#000000" points="720.592,-533.5 730.592,-530 720.591,-526.5 720.592,-533.5"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~halo~~CallsGraph_node73" class="node"><title>proc~outerprod</title>
<g id="a_proc~~halo~~CallsGraph_node73"><a xlink:href=".././proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="787.5,-730 728.5,-730 728.5,-706 787.5,-706 787.5,-730"/>
<text text-anchor="middle" x="758" y="-715.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~halo~~CallsGraph_edge121" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M656.007,-735.495C674.01,-732.376 698.278,-728.172 718.513,-724.667"/>
<polygon fill="#000000" stroke="#000000" points="719.118,-728.114 728.374,-722.959 717.923,-721.217 719.118,-728.114"/>
</g>
<!-- proc~swap -->
<g id="proc~~halo~~CallsGraph_node74" class="node"><title>proc~swap</title>
<g id="a_proc~~halo~~CallsGraph_node74"><a xlink:href=".././proc/swap.html" xlink:title="swap">
<polygon fill="#d9534f" stroke="#d9534f" points="785,-772 731,-772 731,-748 785,-748 785,-772"/>
<text text-anchor="middle" x="758" y="-757.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swap</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~swap -->
<g id="proc~~halo~~CallsGraph_edge120" class="edge"><title>proc~ludcmp&#45;&gt;proc~swap</title>
<path fill="none" stroke="#000000" d="M656.007,-744.096C674.631,-747.029 699.959,-751.017 720.591,-754.266"/>
<polygon fill="#000000" stroke="#000000" points="720.169,-757.743 730.592,-755.841 721.258,-750.828 720.169,-757.743"/>
</g>
</g>
</svg>
</div><script>var panprochaloCallsGraph = svgPanZoom('#prochaloCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~halo~~CalledByGraph Pages: 1 -->
<svg id="prochaloCalledByGraph" width="152pt" height="32pt"
 viewBox="0.00 0.00 152.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~halo~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~halo~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 148,-28 148,4 -4,4"/>
<!-- proc~halo -->
<g id="proc~~halo~~CalledByGraph_node1" class="node"><title>proc~halo</title>
<polygon fill="none" stroke="black" points="144,-24 90,-24 90,-0 144,-0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">halo</text>
</g>
<!-- program~fidasim -->
<g id="proc~~halo~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~halo~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~halo -->
<g id="proc~~halo~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~halo</title>
<path fill="none" stroke="#000000" d="M54.4029,-12C62.3932,-12 71.3106,-12 79.8241,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.919,-15.5001 89.919,-12 79.919,-8.5001 79.919,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/halo.html#src">halo</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">halo</span><span class="w"></span>
<span class="w">    </span><span class="c">!+ Calculates halo neutral density and spectra</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ic</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">ncell</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ihalo</span><span class="w"> </span><span class="c">!! counter</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ri</span><span class="w">    </span><span class="c">!! start position</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">vihalo</span><span class="c">!! velocity bulk plasma ion</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ind</span><span class="p">,</span><span class="w"> </span><span class="n">tind</span><span class="w">    </span><span class="c">!! actual cell</span>
<span class="w">    </span><span class="c">!! Determination of the CX probability</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">plasma</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">denn</span><span class="w">    </span><span class="c">!!  neutral dens (n=1-4)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rates</span><span class="w">    </span><span class="c">!! CX rates</span>
<span class="w">    </span><span class="c">!! Collisiional radiative model along track</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">states</span><span class="w">  </span><span class="c">! Density of n-states</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ntrack</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">ParticleTrack</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ntrack</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tracks</span><span class="w">  </span><span class="c">!! Particle Tracks</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="k">is</span>
<span class="k">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tot_denn</span><span class="p">,</span><span class="w"> </span><span class="n">photons</span><span class="w">  </span><span class="c">!! photon flux</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cell_ind</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nx</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ny</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nz</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">papprox</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nx</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ny</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nz</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nlaunch</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">local_iter_dens</span><span class="w"></span>

<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">NeutralPopulation</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cur_pop</span><span class="p">,</span><span class="w"> </span><span class="n">prev_pop</span><span class="w"></span>
<span class="w">    </span><span class="c">!! Halo iteration</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">hh</span><span class="p">,</span><span class="w"> </span><span class="n">n_halo</span><span class="w"> </span><span class="c">!! counters</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dcx_dens</span><span class="p">,</span><span class="w"> </span><span class="n">halo_iter_dens</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">seed_dcx</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">prev_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="c">! previous iteration</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cur_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="c">! current iteration</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fi_correction</span><span class="w"></span>

<span class="w">    </span><span class="c">!! Initialize Neutral Population</span>
<span class="w">    </span><span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">halo</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">dcx_dens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">dcx</span><span class="p">%</span><span class="n">dens</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">prev_type</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dcx_dens</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">dcx_dens</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;HALO: Density of DCX-neutrals is zero&#39;</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">        stop</span>
<span class="k">    endif</span>
<span class="k">    </span><span class="n">n_halo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inputs</span><span class="p">%</span><span class="n">n_halo</span><span class="w"></span>

<span class="w">    </span><span class="c">!! Allocate previous neutral populations</span>
<span class="w">    </span><span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">prev_pop</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">prev_pop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neut</span><span class="p">%</span><span class="n">dcx</span><span class="w"></span>

<span class="w">    </span><span class="n">seed_dcx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"></span>
<span class="w">    </span><span class="n">iterations</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">hh</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">200</span><span class="w"></span>
<span class="w">        </span><span class="c">!! Allocate/Reallocate current population</span>
<span class="w">        </span><span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">cur_pop</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">cur_type</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.d0</span><span class="w"></span>

<span class="w">        </span><span class="c">!! Calculate how many mc markers to launch in each cell</span>
<span class="w">        </span><span class="n">papprox</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.d0</span><span class="w"></span>
<span class="w">        </span><span class="n">cell_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">        </span><span class="n">ncell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">        </span><span class="k">do </span><span class="n">ic</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">ind2sub</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">ic</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">ind</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">plasma</span><span class="p">%</span><span class="n">in_plasma</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="k">            </span><span class="n">tot_denn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">prev_pop</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="n">papprox</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="n">tot_denn</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">plasma</span><span class="p">%</span><span class="n">deni</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">papprox</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                </span><span class="n">ncell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ncell</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                </span><span class="n">cell_ind</span><span class="p">(</span><span class="n">ncell</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ic</span><span class="w"></span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">        enddo</span>
<span class="k">        call </span><span class="n">get_nlaunch</span><span class="p">(</span><span class="n">n_halo</span><span class="p">,</span><span class="w"> </span><span class="n">papprox</span><span class="p">,</span><span class="w"> </span><span class="n">nlaunch</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i10,&quot; --- Seed/DCX: &quot;,f5.3)&#39;</span><span class="p">)</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">nlaunch</span><span class="p">),</span><span class="w"> </span><span class="n">seed_dcx</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span><span class="w"></span>

<span class="w">        </span><span class="c">!$OMP PARALLEL DO schedule(dynamic,1) private(i,j,k,ic,ihalo,ii,jj,kk,it,is,ind,vihalo, &amp;</span>
<span class="w">        </span><span class="c">!$OMP&amp; ri,tracks,ntrack,rates,denn,states,photons,plasma,tind,fi_correction)</span>
<span class="w">        </span><span class="n">loop_over_cells</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">ic</span><span class="o">=</span><span class="n">istart</span><span class="p">,</span><span class="n">ncell</span><span class="p">,</span><span class="n">istep</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">ind2sub</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">cell_ind</span><span class="p">(</span><span class="n">ic</span><span class="p">),</span><span class="n">ind</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">loop_over_species</span><span class="p">:</span><span class="w"> </span><span class="k">do is</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n_thermal</span><span class="w"> </span><span class="c">!This loop has to come first</span>
<span class="w">                </span><span class="c">!! Loop over the markers</span>
<span class="w">                </span><span class="n">loop_over_halos</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">ihalo</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="c">!! Calculate ri,vhalo and track</span>
<span class="w">                    </span><span class="k">call </span><span class="n">mc_beam_grid</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="w"> </span><span class="n">ri</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">mc_halo</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="w"> </span><span class="n">thermal_mass</span><span class="p">(</span><span class="k">is</span><span class="p">),</span><span class="w"> </span><span class="n">vihalo</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">track</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">vihalo</span><span class="p">,</span><span class="n">tracks</span><span class="p">,</span><span class="n">ntrack</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="n">ntrack</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">cycle </span><span class="n">loop_over_halos</span><span class="w"></span>

<span class="w">                    </span><span class="c">!! Get plasma parameters at particle location</span>
<span class="w">                    </span><span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="c">!! Calculate CX probability</span>
<span class="w">                    </span><span class="n">tind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tracks</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">ind</span><span class="w"></span>
<span class="w">                    </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tind</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="n">jj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tind</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="n">kk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">neutral_cx_rate</span><span class="p">(</span><span class="n">prev_pop</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">),</span><span class="w"> </span><span class="n">prev_pop</span><span class="p">%</span><span class="n">res</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">),</span><span class="w"> </span><span class="n">vihalo</span><span class="p">,</span><span class="w"> </span><span class="n">rates</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span><span class="k">cycle </span><span class="n">loop_over_halos</span><span class="w"></span>

<span class="w">                    </span><span class="c">!! Get plasma parameters at mean point in cell</span>
<span class="w">                    </span><span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="o">=</span><span class="n">tracks</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">pos</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="c">!! Weight CX rates by ion source density</span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="n">beam_mass</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">thermal_mass</span><span class="p">(</span><span class="k">is</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        </span><span class="n">states</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rates</span><span class="o">*</span><span class="p">(</span><span class="n">plasma</span><span class="p">%</span><span class="n">deni</span><span class="p">(</span><span class="k">is</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">plasma</span><span class="p">%</span><span class="n">denf</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">loop_over_halos</span><span class="w"></span>
<span class="w">                        </span><span class="n">fi_correction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="n">plasma</span><span class="p">%</span><span class="n">deni</span><span class="p">(</span><span class="k">is</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">plasma</span><span class="p">%</span><span class="n">deni</span><span class="p">(</span><span class="k">is</span><span class="p">)</span><span class="o">+</span><span class="n">plasma</span><span class="p">%</span><span class="n">denf</span><span class="p">),</span><span class="mf">0.d0</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">else</span>
<span class="k">                        </span><span class="n">states</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rates</span><span class="o">*</span><span class="n">plasma</span><span class="p">%</span><span class="n">deni</span><span class="p">(</span><span class="k">is</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">loop_over_halos</span><span class="w"></span>
<span class="w">                        </span><span class="n">fi_correction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.d0</span><span class="w"></span>
<span class="w">                    </span><span class="k">endif</span>

<span class="k">                    </span><span class="n">loop_along_track</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">it</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ntrack</span><span class="w"></span>
<span class="w">                        </span><span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">tracks</span><span class="p">(</span><span class="n">it</span><span class="p">)%</span><span class="n">pos</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">plasma</span><span class="p">%</span><span class="n">in_plasma</span><span class="p">)</span><span class="w"> </span><span class="k">exit </span><span class="n">loop_along_track</span><span class="w"></span>
<span class="w">                        </span><span class="k">call </span><span class="n">colrad</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">thermal_mass</span><span class="p">(</span><span class="k">is</span><span class="p">),</span><span class="n">vihalo</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">it</span><span class="p">)%</span><span class="nb">time</span><span class="p">,</span><span class="n">states</span><span class="p">,</span><span class="n">denn</span><span class="p">,</span><span class="n">photons</span><span class="p">)</span><span class="w"></span>

<span class="w">                        </span><span class="c">!! Store Neutrals</span>
<span class="w">                        </span><span class="k">call </span><span class="n">update_neutrals</span><span class="p">(</span><span class="n">cur_pop</span><span class="p">,</span><span class="w"> </span><span class="n">tracks</span><span class="p">(</span><span class="n">it</span><span class="p">)%</span><span class="n">ind</span><span class="p">,</span><span class="w"> </span><span class="n">vihalo</span><span class="p">,</span><span class="w"> </span><span class="n">denn</span><span class="o">/</span><span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="w"></span>

<span class="w">                        </span><span class="k">if</span><span class="p">((</span><span class="n">photons</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_halo</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                            </span><span class="n">photons</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fi_correction</span><span class="o">*</span><span class="n">photons</span><span class="w"> </span><span class="c">!! Correct for including fast-ions in states</span>
<span class="w">                            </span><span class="k">call </span><span class="n">store_photons</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="n">it</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span><span class="n">vihalo</span><span class="p">,</span><span class="n">thermal_lambda0</span><span class="p">(</span><span class="k">is</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                                               </span><span class="n">photons</span><span class="o">/</span><span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">spec</span><span class="p">%</span><span class="n">halo</span><span class="p">(:,:,:,</span><span class="k">is</span><span class="p">),</span><span class="n">spec</span><span class="p">%</span><span class="n">halostokes</span><span class="p">(:,:,:,:,</span><span class="k">is</span><span class="p">))</span><span class="w"></span>
<span class="w">                        </span><span class="k">endif</span>
<span class="k">                    enddo </span><span class="n">loop_along_track</span><span class="w"></span>
<span class="w">                </span><span class="k">enddo </span><span class="n">loop_over_halos</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo </span><span class="n">loop_over_species</span><span class="w"></span>
<span class="w">        </span><span class="k">enddo </span><span class="n">loop_over_cells</span><span class="w"></span>
<span class="w">        </span><span class="c">!$OMP END PARALLEL DO</span>

<span class="cp">#ifdef _MPI</span>
<span class="w">        </span><span class="c">!! Combine densities</span>
<span class="w">        </span><span class="k">call </span><span class="n">parallel_merge_populations</span><span class="p">(</span><span class="n">cur_pop</span><span class="p">)</span><span class="w"></span>
<span class="cp">#endif</span>
<span class="w">        </span><span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">cur_type</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">cur_pop</span><span class="p">%</span><span class="n">dens</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">cur_type</span><span class="p">)</span><span class="o">/</span><span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">prev_type</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">1.0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;HALO: Halo generation density exceeded seed density. This shouldn&#39;t happen.&quot;</span><span class="w"></span>
<span class="w">            </span><span class="k">exit </span><span class="n">iterations</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span><span class="w"></span>

<span class="w">        </span><span class="c">!! Set current generation to previous generation</span>
<span class="w">        </span><span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">prev_type</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">cur_type</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">prev_pop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cur_pop</span><span class="w"></span>

<span class="w">        </span><span class="c">!! merge current population with halo population</span>
<span class="w">        </span><span class="k">call </span><span class="n">merge_neutral_populations</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">halo</span><span class="p">,</span><span class="w"> </span><span class="n">cur_pop</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">seed_dcx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">halo_iter_dens</span><span class="p">(</span><span class="n">cur_type</span><span class="p">)</span><span class="o">/</span><span class="n">dcx_dens</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">seed_dcx</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;NAN (Halo generation)/DCX. Exiting...&quot;</span><span class="w"></span>
<span class="w">            </span><span class="k">stop</span>
<span class="k">        endif</span>
<span class="k">        </span><span class="n">n_halo</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_halo</span><span class="o">*</span><span class="n">seed_dcx</span><span class="p">,</span><span class="n">Int64</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">seed_dcx</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mf">0.01</span><span class="p">)</span><span class="w"> </span><span class="k">exit </span><span class="n">iterations</span><span class="w"></span>
<span class="w">    </span><span class="k">enddo </span><span class="n">iterations</span><span class="w"></span>

<span class="w">    </span><span class="k">call </span><span class="n">free_neutral_population</span><span class="p">(</span><span class="n">cur_pop</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">free_neutral_population</span><span class="p">(</span><span class="n">prev_pop</span><span class="p">)</span><span class="w"></span>

<span class="cp">#ifdef _MPI</span>
<span class="w">    </span><span class="c">!! Combine Spectra</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_halo</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">halo</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span><span class="w"></span>
<span class="cp">#endif</span>

<span class="k">end subroutine </span><span class="n">halo</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>