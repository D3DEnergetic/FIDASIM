<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="">
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>ndmc &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>User Guide</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>ndmc
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.7% of total for procedures.">94 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
     <li><a href='../module/libfida.html'>libfida</a></li>
     <li class="active">ndmc</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/ndmc.html#src">ndmc</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public subroutine ndmc()</h2>
    

    <p>Calculates neutral beam deposition and spectra</p>

    <h3>Arguments</h3>
    <em>None</em>
    <br>
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~ndmc~~CallsGraph Pages: 1 -->
<svg id="procndmcCallsGraph" width="641pt" height="1020pt"
 viewBox="0.00 0.00 641.00 1019.83" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~ndmc~~CallsGraph" class="graph" transform="scale(0.66219 0.66219) rotate(0) translate(4 1536.09)">
<title>proc~~ndmc~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1536.09 964,-1536.09 964,4 -4,4"/>
<!-- proc~ndmc -->
<g id="proc~~ndmc~~CallsGraph_node1" class="node"><title>proc~ndmc</title>
<polygon fill="none" stroke="black" points="54,-813.086 0,-813.086 0,-789.086 54,-789.086 54,-813.086"/>
<text text-anchor="middle" x="27" y="-798.686" font-family="Helvetica,sans-Serif" font-size="10.50">ndmc</text>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_node2" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~ndmc~~CallsGraph_node2"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="549.5,-271.086 476.5,-271.086 476.5,-247.086 549.5,-247.086 549.5,-271.086"/>
<text text-anchor="middle" x="513" y="-256.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_edge1" class="edge"><title>proc~ndmc&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M28.5817,-789.07C31.5933,-730.963 46.9643,-479.336 90,-416.086 175.761,-290.042 375.773,-264.926 466.183,-260.112"/>
<polygon fill="#000000" stroke="#000000" points="466.568,-263.598 476.392,-259.631 466.239,-256.606 466.568,-263.598"/>
</g>
<!-- proc~init_neutral_population -->
<g id="proc~~ndmc~~CallsGraph_node3" class="node"><title>proc~init_neutral_population</title>
<g id="a_proc~~ndmc~~CallsGraph_node3"><a xlink:href=".././proc/init_neutral_population.html" xlink:title="init_neutral_population">
<polygon fill="#d9534f" stroke="#d9534f" points="223.5,-1032.09 102.5,-1032.09 102.5,-1008.09 223.5,-1008.09 223.5,-1032.09"/>
<text text-anchor="middle" x="163" y="-1017.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_neutral_population</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~init_neutral_population -->
<g id="proc~~ndmc~~CallsGraph_edge2" class="edge"><title>proc~ndmc&#45;&gt;proc~init_neutral_population</title>
<path fill="none" stroke="#000000" d="M28.3608,-813.342C30.0093,-846.922 39.1705,-941.409 90,-994.086 93.3423,-997.55 97.1801,-1000.55 101.306,-1003.16"/>
<polygon fill="#000000" stroke="#000000" points="99.6597,-1006.25 110.114,-1007.97 103.013,-1000.1 99.6597,-1006.25"/>
</g>
<!-- proc~colrad -->
<g id="proc~~ndmc~~CallsGraph_node4" class="node"><title>proc~colrad</title>
<g id="a_proc~~ndmc~~CallsGraph_node4"><a xlink:href=".././proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="190,-1249.09 136,-1249.09 136,-1225.09 190,-1225.09 190,-1249.09"/>
<text text-anchor="middle" x="163" y="-1234.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~colrad -->
<g id="proc~~ndmc~~CallsGraph_edge3" class="edge"><title>proc~ndmc&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M30.6789,-813.192C38.6064,-848.584 63.0838,-954.815 90,-1041.09 110.047,-1105.34 138.889,-1179.49 153.223,-1215.38"/>
<polygon fill="#000000" stroke="#000000" points="150.048,-1216.87 157.021,-1224.85 156.545,-1214.27 150.048,-1216.87"/>
</g>
<!-- interface~randu -->
<g id="proc~~ndmc~~CallsGraph_node5" class="node"><title>interface~randu</title>
<g id="a_proc~~ndmc~~CallsGraph_node5"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="947,-592.086 893,-592.086 893,-568.086 947,-568.086 947,-592.086"/>
<text text-anchor="middle" x="920" y="-577.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge14" class="edge"><title>proc~ndmc&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M33.479,-788.922C42.4899,-770.371 62.2468,-735.252 90,-717.086 185.353,-654.674 226.037,-660.086 340,-660.086 340,-660.086 340,-660.086 667,-660.086 746.119,-660.086 770.97,-671.523 844,-641.086 866.352,-631.771 887.332,-613.579 901.387,-599.476"/>
<polygon fill="#000000" stroke="#000000" points="904.032,-601.775 908.447,-592.144 898.99,-596.92 904.032,-601.775"/>
</g>
<!-- proc~track -->
<g id="proc~~ndmc~~CallsGraph_node6" class="node"><title>proc~track</title>
<g id="a_proc~~ndmc~~CallsGraph_node6"><a xlink:href=".././proc/track.html" xlink:title="track">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-914.086 314,-914.086 314,-890.086 368,-890.086 368,-914.086"/>
<text text-anchor="middle" x="341" y="-899.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~track -->
<g id="proc~~ndmc~~CallsGraph_edge4" class="edge"><title>proc~ndmc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M34.0613,-813.195C43.4328,-830.481 63.1952,-861.726 90,-876.086 158.41,-912.735 252.428,-911.011 303.456,-906.543"/>
<polygon fill="#000000" stroke="#000000" points="304.049,-910.002 313.668,-905.561 303.378,-903.034 304.049,-910.002"/>
</g>
<!-- proc~mc_nbi -->
<g id="proc~~ndmc~~CallsGraph_node7" class="node"><title>proc~mc_nbi</title>
<g id="a_proc~~ndmc~~CallsGraph_node7"><a xlink:href=".././proc/mc_nbi.html" xlink:title="mc_nbi">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-1078.09 314,-1078.09 314,-1054.09 368,-1054.09 368,-1078.09"/>
<text text-anchor="middle" x="341" y="-1063.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_nbi</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~mc_nbi -->
<g id="proc~~ndmc~~CallsGraph_edge5" class="edge"><title>proc~ndmc&#45;&gt;proc~mc_nbi</title>
<path fill="none" stroke="#000000" d="M29.2768,-813.174C32.9974,-842.226 46.4872,-916.486 90,-956.086 140.028,-1001.62 174.495,-970.926 236,-999.086 265.219,-1012.46 295.81,-1033.09 316.188,-1047.92"/>
<polygon fill="#000000" stroke="#000000" points="314.139,-1050.76 324.262,-1053.89 318.298,-1045.13 314.139,-1050.76"/>
</g>
<!-- proc~store_births -->
<g id="proc~~ndmc~~CallsGraph_node8" class="node"><title>proc~store_births</title>
<g id="a_proc~~ndmc~~CallsGraph_node8"><a xlink:href=".././proc/store_births.html" xlink:title="store_births">
<polygon fill="#d9534f" stroke="#d9534f" points="197.5,-834.086 128.5,-834.086 128.5,-810.086 197.5,-810.086 197.5,-834.086"/>
<text text-anchor="middle" x="163" y="-819.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_births</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~store_births -->
<g id="proc~~ndmc~~CallsGraph_edge6" class="edge"><title>proc~ndmc&#45;&gt;proc~store_births</title>
<path fill="none" stroke="#000000" d="M54.1547,-805.185C72.3509,-808.037 97.0469,-811.907 118.215,-815.225"/>
<polygon fill="#000000" stroke="#000000" points="117.858,-818.711 128.279,-816.802 118.942,-811.796 117.858,-818.711"/>
</g>
<!-- interface~randind -->
<g id="proc~~ndmc~~CallsGraph_node9" class="node"><title>interface~randind</title>
<g id="a_proc~~ndmc~~CallsGraph_node9"><a xlink:href=".././interface/randind.html" xlink:title="randind">
<polygon fill="#a7506f" stroke="#a7506f" points="825,-632.086 771,-632.086 771,-608.086 825,-608.086 825,-632.086"/>
<text text-anchor="middle" x="798" y="-617.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;interface~randind -->
<g id="proc~~ndmc~~CallsGraph_edge7" class="edge"><title>proc~ndmc&#45;&gt;interface~randind</title>
<path fill="none" stroke="#000000" d="M28.7782,-788.887C31.4066,-758.915 42.6825,-681.537 90,-646.086 179.331,-579.158 228.378,-622.086 340,-622.086 340,-622.086 340,-622.086 514,-622.086 602.67,-622.086 706.964,-621.092 760.787,-620.506"/>
<polygon fill="#000000" stroke="#000000" points="760.899,-624.005 770.859,-620.394 760.821,-617.005 760.899,-624.005"/>
</g>
<!-- proc~gyro_step -->
<g id="proc~~ndmc~~CallsGraph_node10" class="node"><title>proc~gyro_step</title>
<g id="a_proc~~ndmc~~CallsGraph_node10"><a xlink:href=".././proc/gyro_step.html" xlink:title="gyro_step">
<polygon fill="#d9534f" stroke="#d9534f" points="193,-750.086 133,-750.086 133,-726.086 193,-726.086 193,-750.086"/>
<text text-anchor="middle" x="163" y="-735.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_step</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~gyro_step -->
<g id="proc~~ndmc~~CallsGraph_edge9" class="edge"><title>proc~ndmc&#45;&gt;proc~gyro_step</title>
<path fill="none" stroke="#000000" d="M42.9899,-788.961C55.0727,-779.689 72.8231,-767.165 90,-759.086 100.374,-754.207 112.129,-750.2 123.088,-747.043"/>
<polygon fill="#000000" stroke="#000000" points="124.137,-750.385 132.866,-744.381 122.298,-743.631 124.137,-750.385"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~ndmc~~CallsGraph_node11" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~ndmc~~CallsGraph_node11"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="547,-960.086 479,-960.086 479,-936.086 547,-936.086 547,-960.086"/>
<text text-anchor="middle" x="513" y="-945.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~get_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge10" class="edge"><title>proc~ndmc&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M31.2643,-813.391C37.9964,-836.086 55.7428,-884.21 90,-906.086 151.979,-945.665 374.186,-949.049 468.824,-948.626"/>
<polygon fill="#000000" stroke="#000000" points="468.936,-952.126 478.914,-948.564 468.893,-945.126 468.936,-952.126"/>
</g>
<!-- proc~store_nbi_photons -->
<g id="proc~~ndmc~~CallsGraph_node12" class="node"><title>proc~store_nbi_photons</title>
<g id="a_proc~~ndmc~~CallsGraph_node12"><a xlink:href=".././proc/store_nbi_photons.html" xlink:title="store_nbi_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="213.5,-792.086 112.5,-792.086 112.5,-768.086 213.5,-768.086 213.5,-792.086"/>
<text text-anchor="middle" x="163" y="-777.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_nbi_photons</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~store_nbi_photons -->
<g id="proc~~ndmc~~CallsGraph_edge11" class="edge"><title>proc~ndmc&#45;&gt;proc~store_nbi_photons</title>
<path fill="none" stroke="#000000" d="M54.1547,-796.988C67.8417,-794.843 85.2063,-792.121 101.981,-789.492"/>
<polygon fill="#000000" stroke="#000000" points="102.973,-792.88 112.311,-787.873 101.89,-785.964 102.973,-792.88"/>
</g>
<!-- proc~store_neutrals -->
<g id="proc~~ndmc~~CallsGraph_node13" class="node"><title>proc~store_neutrals</title>
<g id="a_proc~~ndmc~~CallsGraph_node13"><a xlink:href=".././proc/store_neutrals.html" xlink:title="store_neutrals">
<polygon fill="#d9534f" stroke="#d9534f" points="203.5,-594.086 122.5,-594.086 122.5,-570.086 203.5,-570.086 203.5,-594.086"/>
<text text-anchor="middle" x="163" y="-579.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_neutrals</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~store_neutrals -->
<g id="proc~~ndmc~~CallsGraph_edge12" class="edge"><title>proc~ndmc&#45;&gt;proc~store_neutrals</title>
<path fill="none" stroke="#000000" d="M28.3608,-788.831C30.0093,-755.251 39.1705,-660.764 90,-608.086 96.3026,-601.555 104.367,-596.657 112.804,-592.988"/>
<polygon fill="#000000" stroke="#000000" points="114.305,-596.162 122.415,-589.344 111.823,-589.616 114.305,-596.162"/>
</g>
<!-- proc~parallel_merge_populations -->
<g id="proc~~ndmc~~CallsGraph_node14" class="node"><title>proc~parallel_merge_populations</title>
<g id="a_proc~~ndmc~~CallsGraph_node14"><a xlink:href=".././proc/parallel_merge_populations.html" xlink:title="parallel_merge_populations">
<polygon fill="#d9534f" stroke="#d9534f" points="235.5,-449.086 90.5,-449.086 90.5,-425.086 235.5,-425.086 235.5,-449.086"/>
<text text-anchor="middle" x="163" y="-434.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_merge_populations</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~parallel_merge_populations -->
<g id="proc~~ndmc~~CallsGraph_edge13" class="edge"><title>proc~ndmc&#45;&gt;proc~parallel_merge_populations</title>
<path fill="none" stroke="#000000" d="M29.9201,-788.979C35.8548,-753.145 55.6068,-644.891 90,-561.086 105.77,-522.661 131.568,-481.649 147.624,-457.746"/>
<polygon fill="#000000" stroke="#000000" points="150.723,-459.413 153.457,-449.177 144.936,-455.474 150.723,-459.413"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_node15" class="node"><title>proc~get_fields</title>
<g id="a_proc~~ndmc~~CallsGraph_node15"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="542,-876.086 484,-876.086 484,-852.086 542,-852.086 542,-876.086"/>
<text text-anchor="middle" x="513" y="-861.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_edge8" class="edge"><title>proc~ndmc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M41.1037,-813.148C52.9143,-823.19 71.2575,-836.822 90,-843.086 225.218,-888.281 398.36,-876.956 473.901,-868.881"/>
<polygon fill="#000000" stroke="#000000" points="474.346,-872.353 483.898,-867.77 473.573,-865.396 474.346,-872.353"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~ndmc~~CallsGraph_node16" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~ndmc~~CallsGraph_node16"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="710,-31.0864 622,-31.0864 622,-7.08637 710,-7.08637 710,-31.0864"/>
<text text-anchor="middle" x="666" y="-16.6864" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~ndmc~~CallsGraph_edge15" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M516.905,-246.887C525.877,-211.521 556.214,-107.503 616,-45.0864 618.998,-41.9568 622.456,-39.124 626.119,-36.5805"/>
<polygon fill="#000000" stroke="#000000" points="628.237,-39.387 634.921,-31.1669 624.57,-33.4244 628.237,-39.387"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~ndmc~~CallsGraph_node19" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~ndmc~~CallsGraph_node19"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="711.5,-393.086 620.5,-393.086 620.5,-369.086 711.5,-369.086 711.5,-393.086"/>
<text text-anchor="middle" x="666" y="-378.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~ndmc~~CallsGraph_edge20" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M523.541,-271.14C540.346,-291.713 577.139,-333.916 616,-360.086 618.261,-361.609 620.65,-363.059 623.109,-364.434"/>
<polygon fill="#000000" stroke="#000000" points="621.707,-367.648 632.206,-369.072 624.887,-361.412 621.707,-367.648"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~ndmc~~CallsGraph_node23" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~ndmc~~CallsGraph_node23"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="711.5,-351.086 620.5,-351.086 620.5,-327.086 711.5,-327.086 711.5,-351.086"/>
<text text-anchor="middle" x="666" y="-336.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~ndmc~~CallsGraph_edge24" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M536.934,-271.237C562.692,-284.884 604.656,-307.116 633.484,-322.389"/>
<polygon fill="#000000" stroke="#000000" points="631.87,-325.495 642.345,-327.084 635.147,-319.309 631.87,-325.495"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~ndmc~~CallsGraph_node25" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~ndmc~~CallsGraph_node25"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="842,-193.086 754,-193.086 754,-169.086 842,-169.086 842,-193.086"/>
<text text-anchor="middle" x="798" y="-178.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~ndmc~~CallsGraph_edge16" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M528.428,-247.064C547.24,-232.157 581.797,-207.344 616,-196.086 657.476,-182.434 707.043,-179.163 743.812,-179.036"/>
<polygon fill="#000000" stroke="#000000" points="743.811,-182.536 753.825,-179.078 743.84,-175.536 743.811,-182.536"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~ndmc~~CallsGraph_node26" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~ndmc~~CallsGraph_node26"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="711.5,-271.086 620.5,-271.086 620.5,-247.086 711.5,-247.086 711.5,-271.086"/>
<text text-anchor="middle" x="666" y="-256.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~ndmc~~CallsGraph_edge18" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M549.785,-259.086C567.757,-259.086 589.927,-259.086 610.004,-259.086"/>
<polygon fill="#000000" stroke="#000000" points="610.279,-262.586 620.279,-259.086 610.279,-255.586 610.279,-262.586"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~ndmc~~CallsGraph_node28" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~ndmc~~CallsGraph_node28"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="710,-111.086 622,-111.086 622,-87.0864 710,-87.0864 710,-111.086"/>
<text text-anchor="middle" x="666" y="-96.6864" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~ndmc~~CallsGraph_edge21" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M520.76,-246.955C535.361,-221.622 572.097,-162.367 616,-125.086 619.748,-121.903 623.951,-118.956 628.277,-116.276"/>
<polygon fill="#000000" stroke="#000000" points="630.28,-119.163 637.226,-111.163 626.807,-113.085 630.28,-119.163"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_node29" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~ndmc~~CallsGraph_node29"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="842,-53.0864 754,-53.0864 754,-29.0864 842,-29.0864 842,-53.0864"/>
<text text-anchor="middle" x="798" y="-38.6864" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_edge23" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M517.018,-247.042C525.925,-214.142 555.361,-122.265 616,-78.0864 653.004,-51.1272 705.016,-42.7289 743.795,-40.5745"/>
<polygon fill="#000000" stroke="#000000" points="744.015,-44.0683 753.854,-40.1377 743.712,-37.0749 744.015,-44.0683"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_node34" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~ndmc~~CallsGraph_node34"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="843.5,-311.086 752.5,-311.086 752.5,-287.086 843.5,-287.086 843.5,-311.086"/>
<text text-anchor="middle" x="798" y="-296.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge22" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M549.719,-267.339C569.222,-271.617 593.846,-276.652 616,-280.086 658.059,-286.607 705.97,-291.526 741.929,-294.724"/>
<polygon fill="#000000" stroke="#000000" points="741.945,-298.238 752.212,-295.62 742.553,-291.265 741.945,-298.238"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~ndmc~~CallsGraph_node36" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~ndmc~~CallsGraph_node36"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="843.5,-151.086 752.5,-151.086 752.5,-127.086 843.5,-127.086 843.5,-151.086"/>
<text text-anchor="middle" x="798" y="-136.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~ndmc~~CallsGraph_edge17" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M524.941,-247.051C542.344,-228.699 578.242,-193.971 616,-176.086 655.875,-157.199 705.162,-147.927 742.23,-143.389"/>
<polygon fill="#000000" stroke="#000000" points="742.807,-146.846 752.343,-142.231 742.01,-139.892 742.807,-146.846"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~ndmc~~CallsGraph_node38" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~ndmc~~CallsGraph_node38"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="711.5,-229.086 620.5,-229.086 620.5,-205.086 711.5,-205.086 711.5,-229.086"/>
<text text-anchor="middle" x="666" y="-214.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~ndmc~~CallsGraph_edge19" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M549.785,-249.133C568.297,-243.984 591.263,-237.596 611.807,-231.882"/>
<polygon fill="#000000" stroke="#000000" points="612.972,-235.191 621.668,-229.139 611.096,-228.447 612.972,-235.191"/>
</g>
<!-- proc~linsolve -->
<g id="proc~~ndmc~~CallsGraph_node24" class="node"><title>proc~linsolve</title>
<g id="a_proc~~ndmc~~CallsGraph_node24"><a xlink:href=".././proc/linsolve.html" xlink:title="linsolve">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-1260.09 314,-1260.09 314,-1236.09 368,-1236.09 368,-1260.09"/>
<text text-anchor="middle" x="341" y="-1245.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linsolve</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~linsolve -->
<g id="proc~~ndmc~~CallsGraph_edge27" class="edge"><title>proc~colrad&#45;&gt;proc~linsolve</title>
<path fill="none" stroke="#000000" d="M190.349,-1238.73C220.375,-1240.61 269.645,-1243.69 303.391,-1245.8"/>
<polygon fill="#000000" stroke="#000000" points="303.56,-1249.32 313.759,-1246.45 303.997,-1242.33 303.56,-1249.32"/>
</g>
<!-- proc~eigen -->
<g id="proc~~ndmc~~CallsGraph_node32" class="node"><title>proc~eigen</title>
<g id="a_proc~~ndmc~~CallsGraph_node32"><a xlink:href=".././proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-1427.09 314,-1427.09 314,-1403.09 368,-1403.09 368,-1427.09"/>
<text text-anchor="middle" x="341" y="-1412.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~ndmc~~CallsGraph_edge26" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M176.097,-1249.32C206.115,-1279.68 284.215,-1358.67 320.697,-1395.56"/>
<polygon fill="#000000" stroke="#000000" points="318.298,-1398.12 327.818,-1402.77 323.276,-1393.19 318.298,-1398.12"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~ndmc~~CallsGraph_node37" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~ndmc~~CallsGraph_node37"><a xlink:href=".././proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="385,-1208.09 297,-1208.09 297,-1184.09 385,-1184.09 385,-1208.09"/>
<text text-anchor="middle" x="341" y="-1193.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~ndmc~~CallsGraph_edge25" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M190.349,-1230.95C215.702,-1225.04 254.776,-1215.94 286.64,-1208.52"/>
<polygon fill="#000000" stroke="#000000" points="287.76,-1211.85 296.705,-1206.17 286.172,-1205.03 287.76,-1211.85"/>
</g>
<!-- proc~track&#45;&gt;proc~get_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge31" class="edge"><title>proc~track&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M368.19,-909.173C394.999,-916.427 437.118,-927.824 468.859,-936.413"/>
<polygon fill="#000000" stroke="#000000" points="468.2,-939.86 478.767,-939.094 470.029,-933.103 468.2,-939.86"/>
</g>
<!-- proc~track&#45;&gt;proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_edge32" class="edge"><title>proc~track&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M368.19,-896.232C396.428,-889.92 441.651,-879.811 473.841,-872.616"/>
<polygon fill="#000000" stroke="#000000" points="474.801,-875.988 483.797,-870.391 473.274,-869.156 474.801,-875.988"/>
</g>
<!-- proc~doppler_stark -->
<g id="proc~~ndmc~~CallsGraph_node17" class="node"><title>proc~doppler_stark</title>
<g id="a_proc~~ndmc~~CallsGraph_node17"><a xlink:href=".././proc/doppler_stark.html" xlink:title="doppler_stark">
<polygon fill="#d9534f" stroke="#d9534f" points="552,-918.086 474,-918.086 474,-894.086 552,-894.086 552,-918.086"/>
<text text-anchor="middle" x="513" y="-903.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">doppler_stark</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~doppler_stark -->
<g id="proc~~ndmc~~CallsGraph_edge29" class="edge"><title>proc~track&#45;&gt;proc~doppler_stark</title>
<path fill="none" stroke="#000000" d="M368.19,-902.703C393.544,-903.299 432.592,-904.218 463.604,-904.948"/>
<polygon fill="#000000" stroke="#000000" points="463.702,-908.451 473.782,-905.187 463.867,-901.453 463.702,-908.451"/>
</g>
<!-- proc~get_indices -->
<g id="proc~~ndmc~~CallsGraph_node31" class="node"><title>proc~get_indices</title>
<g id="a_proc~~ndmc~~CallsGraph_node31"><a xlink:href=".././proc/get_indices.html" xlink:title="get_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="546.5,-834.086 479.5,-834.086 479.5,-810.086 546.5,-810.086 546.5,-834.086"/>
<text text-anchor="middle" x="513" y="-819.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_indices</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~get_indices -->
<g id="proc~~ndmc~~CallsGraph_edge28" class="edge"><title>proc~track&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M360.554,-889.986C380.897,-877.1 414.805,-856.72 446,-843.086 453.52,-839.8 461.721,-836.773 469.706,-834.101"/>
<polygon fill="#000000" stroke="#000000" points="470.829,-837.417 479.278,-831.024 468.687,-830.752 470.829,-837.417"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_node39" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~ndmc~~CallsGraph_node39"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="696.5,-1040.09 635.5,-1040.09 635.5,-1016.09 696.5,-1016.09 696.5,-1040.09"/>
<text text-anchor="middle" x="666" y="-1025.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge30" class="edge"><title>proc~track&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M357.337,-914.153C376.894,-929.006 412.234,-954.099 446,-969.086 505.934,-995.689 580.564,-1012.65 625.409,-1021.25"/>
<polygon fill="#000000" stroke="#000000" points="624.852,-1024.71 635.326,-1023.11 626.142,-1017.83 624.852,-1024.71"/>
</g>
<!-- proc~mc_nbi&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge35" class="edge"><title>proc~mc_nbi&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M368.281,-1059.27C389.177,-1054.22 419.24,-1047.76 446,-1045.09 505.26,-1039.16 520.536,-1041.79 580,-1045.09 596.074,-1045.98 599.926,-1048.2 616,-1049.09 660.376,-1051.54 680.312,-1075.58 716,-1049.09 760.37,-1016.15 714.887,-971.024 752,-930.086 781.713,-897.311 815.247,-925.708 844,-892.086 882,-847.652 908.106,-666.339 916.276,-602.475"/>
<polygon fill="#000000" stroke="#000000" points="919.781,-602.654 917.553,-592.297 912.835,-601.783 919.781,-602.654"/>
</g>
<!-- proc~grid_intersect -->
<g id="proc~~ndmc~~CallsGraph_node22" class="node"><title>proc~grid_intersect</title>
<g id="a_proc~~ndmc~~CallsGraph_node22"><a xlink:href=".././proc/grid_intersect.html" xlink:title="grid_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="551.5,-1158.09 474.5,-1158.09 474.5,-1134.09 551.5,-1134.09 551.5,-1158.09"/>
<text text-anchor="middle" x="513" y="-1143.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">grid_intersect</text>
</a>
</g>
</g>
<!-- proc~mc_nbi&#45;&gt;proc~grid_intersect -->
<g id="proc~~ndmc~~CallsGraph_edge33" class="edge"><title>proc~mc_nbi&#45;&gt;proc~grid_intersect</title>
<path fill="none" stroke="#000000" d="M363.587,-1078.13C384.399,-1089.54 416.928,-1106.86 446,-1120.09 453.734,-1123.61 462.094,-1127.12 470.18,-1130.37"/>
<polygon fill="#000000" stroke="#000000" points="468.907,-1133.63 479.493,-1134.05 471.481,-1127.12 468.907,-1133.63"/>
</g>
<!-- interface~randn -->
<g id="proc~~ndmc~~CallsGraph_node33" class="node"><title>interface~randn</title>
<g id="a_proc~~ndmc~~CallsGraph_node33"><a xlink:href=".././interface/randn.html" xlink:title="randn">
<polygon fill="#a7506f" stroke="#a7506f" points="540,-1078.09 486,-1078.09 486,-1054.09 540,-1054.09 540,-1078.09"/>
<text text-anchor="middle" x="513" y="-1063.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randn</text>
</a>
</g>
</g>
<!-- proc~mc_nbi&#45;&gt;interface~randn -->
<g id="proc~~ndmc~~CallsGraph_edge34" class="edge"><title>proc~mc_nbi&#45;&gt;interface~randn</title>
<path fill="none" stroke="#000000" d="M368.19,-1066.09C396.892,-1066.09 443.14,-1066.09 475.416,-1066.09"/>
<polygon fill="#000000" stroke="#000000" points="475.78,-1069.59 485.78,-1066.09 475.78,-1062.59 475.78,-1069.59"/>
</g>
<!-- proc~mc_nbi&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge36" class="edge"><title>proc~mc_nbi&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M368.059,-1074.78C412.606,-1088.26 505.777,-1110.32 580,-1087.09 604.963,-1079.27 629.03,-1061.26 645.142,-1047.18"/>
<polygon fill="#000000" stroke="#000000" points="647.737,-1049.55 652.806,-1040.25 643.041,-1044.36 647.737,-1049.55"/>
</g>
<!-- proc~cross_product -->
<g id="proc~~ndmc~~CallsGraph_node18" class="node"><title>proc~cross_product</title>
<g id="a_proc~~ndmc~~CallsGraph_node18"><a xlink:href=".././proc/cross_product.html" xlink:title="cross_product">
<polygon fill="#d94e8f" stroke="#d94e8f" points="381,-750.086 301,-750.086 301,-726.086 381,-726.086 381,-750.086"/>
<text text-anchor="middle" x="341" y="-735.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cross_product</text>
</a>
</g>
</g>
<!-- proc~gyro_step&#45;&gt;proc~cross_product -->
<g id="proc~~ndmc~~CallsGraph_edge37" class="edge"><title>proc~gyro_step&#45;&gt;proc~cross_product</title>
<path fill="none" stroke="#000000" d="M193.063,-738.086C219.466,-738.086 258.97,-738.086 290.37,-738.086"/>
<polygon fill="#000000" stroke="#000000" points="290.677,-741.586 300.677,-738.086 290.677,-734.586 290.677,-741.586"/>
</g>
<!-- proc~get_position -->
<g id="proc~~ndmc~~CallsGraph_node27" class="node"><title>proc~get_position</title>
<g id="a_proc~~ndmc~~CallsGraph_node27"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="701,-960.086 631,-960.086 631,-936.086 701,-936.086 701,-960.086"/>
<text text-anchor="middle" x="666" y="-945.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~ndmc~~CallsGraph_edge39" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M547.138,-948.086C568.766,-948.086 597.252,-948.086 620.801,-948.086"/>
<polygon fill="#000000" stroke="#000000" points="620.893,-951.586 630.893,-948.086 620.893,-944.586 620.893,-951.586"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_node30" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~ndmc~~CallsGraph_node30"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="832,-883.086 764,-883.086 764,-859.086 832,-859.086 832,-883.086"/>
<text text-anchor="middle" x="798" y="-868.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge38" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M547.018,-939.103C598.322,-925.143 697.179,-898.246 753.995,-882.787"/>
<polygon fill="#000000" stroke="#000000" points="755.025,-886.134 763.755,-880.132 753.187,-879.38 755.025,-886.134"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge41" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M547.081,-958.998C557.88,-963.111 569.729,-968.231 580,-974.086 597.609,-984.126 598.984,-991.072 616,-1002.09 620.8,-1005.19 626.01,-1008.26 631.18,-1011.13"/>
<polygon fill="#000000" stroke="#000000" points="629.885,-1014.41 640.349,-1016.07 633.203,-1008.25 629.885,-1014.41"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_node42" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~ndmc~~CallsGraph_node42"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="954,-903.086 886,-903.086 886,-879.086 954,-879.086 954,-903.086"/>
<text text-anchor="middle" x="920" y="-888.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge40" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M547.291,-956.529C567.106,-961.155 592.825,-966.467 616,-969.086 716.701,-980.468 751.135,-1012.66 844,-972.086 871.896,-959.898 894.049,-931.65 906.846,-911.964"/>
<polygon fill="#000000" stroke="#000000" points="909.893,-913.693 912.207,-903.354 903.951,-909.993 909.893,-913.693"/>
</g>
<!-- proc~store_photons -->
<g id="proc~~ndmc~~CallsGraph_node21" class="node"><title>proc~store_photons</title>
<g id="a_proc~~ndmc~~CallsGraph_node21"><a xlink:href=".././proc/store_photons.html" xlink:title="store_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="381.5,-792.086 300.5,-792.086 300.5,-768.086 381.5,-768.086 381.5,-792.086"/>
<text text-anchor="middle" x="341" y="-777.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_photons</text>
</a>
</g>
</g>
<!-- proc~store_nbi_photons&#45;&gt;proc~store_photons -->
<g id="proc~~ndmc~~CallsGraph_edge42" class="edge"><title>proc~store_nbi_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M213.964,-780.086C237.778,-780.086 266.193,-780.086 290.01,-780.086"/>
<polygon fill="#000000" stroke="#000000" points="290.252,-783.586 300.252,-780.086 290.252,-776.586 290.252,-783.586"/>
</g>
<!-- proc~update_neutrals -->
<g id="proc~~ndmc~~CallsGraph_node40" class="node"><title>proc~update_neutrals</title>
<g id="a_proc~~ndmc~~CallsGraph_node40"><a xlink:href=".././proc/update_neutrals.html" xlink:title="update_neutrals">
<polygon fill="#d9534f" stroke="#d9534f" points="386,-594.086 296,-594.086 296,-570.086 386,-570.086 386,-594.086"/>
<text text-anchor="middle" x="341" y="-579.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_neutrals</text>
</a>
</g>
</g>
<!-- proc~store_neutrals&#45;&gt;proc~update_neutrals -->
<g id="proc~~ndmc~~CallsGraph_edge43" class="edge"><title>proc~store_neutrals&#45;&gt;proc~update_neutrals</title>
<path fill="none" stroke="#000000" d="M203.937,-582.086C228.112,-582.086 259.267,-582.086 285.664,-582.086"/>
<polygon fill="#000000" stroke="#000000" points="285.897,-585.586 295.896,-582.086 285.896,-578.586 285.897,-585.586"/>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_edge44" class="edge"><title>proc~parallel_merge_populations&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M187.646,-424.992C248.28,-393.977 409.417,-311.557 479.114,-275.907"/>
<polygon fill="#000000" stroke="#000000" points="481.012,-278.868 488.322,-271.198 477.825,-272.636 481.012,-278.868"/>
</g>
<!-- proc~parallel_merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_node35" class="node"><title>proc~parallel_merge_reservoirs</title>
<g id="a_proc~~ndmc~~CallsGraph_node35"><a xlink:href=".././proc/parallel_merge_reservoirs.html" xlink:title="parallel_merge_reservoirs">
<polygon fill="#d9534f" stroke="#d9534f" points="409.5,-470.086 272.5,-470.086 272.5,-446.086 409.5,-446.086 409.5,-470.086"/>
<text text-anchor="middle" x="341" y="-455.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_merge_reservoirs</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;proc~parallel_merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_edge45" class="edge"><title>proc~parallel_merge_populations&#45;&gt;proc~parallel_merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M235.586,-445.628C244.437,-446.684 253.517,-447.767 262.452,-448.833"/>
<polygon fill="#000000" stroke="#000000" points="262.113,-452.318 272.457,-450.027 262.942,-445.367 262.113,-452.318"/>
</g>
<!-- proc~ind2sub -->
<g id="proc~~ndmc~~CallsGraph_node41" class="node"><title>proc~ind2sub</title>
<g id="a_proc~~ndmc~~CallsGraph_node41"><a xlink:href=".././proc/ind2sub.html" xlink:title="ind2sub">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-428.086 314,-428.086 314,-404.086 368,-404.086 368,-428.086"/>
<text text-anchor="middle" x="341" y="-413.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ind2sub</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;proc~ind2sub -->
<g id="proc~~ndmc~~CallsGraph_edge46" class="edge"><title>proc~parallel_merge_populations&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M235.586,-428.545C258.98,-425.753 283.98,-422.771 303.65,-420.424"/>
<polygon fill="#000000" stroke="#000000" points="304.184,-423.885 313.699,-419.225 303.354,-416.934 304.184,-423.885"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~ndmc~~CallsGraph_node20" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~ndmc~~CallsGraph_node20"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="716,-804.086 616,-804.086 616,-780.086 716,-780.086 716,-804.086"/>
<text text-anchor="middle" x="666" y="-789.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~ndmc~~CallsGraph_edge50" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M542.011,-857.181C554.027,-853.713 568.026,-848.982 580,-843.086 597.476,-834.482 599.367,-828.225 616,-818.086 621.057,-815.004 626.512,-811.902 631.883,-808.967"/>
<polygon fill="#000000" stroke="#000000" points="633.589,-812.024 640.755,-804.221 630.286,-805.852 633.589,-812.024"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~ndmc~~CallsGraph_edge48" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M542.1,-870.814C554.132,-874.251 568.118,-879.007 580,-885.086 603.394,-897.056 627.186,-915.323 643.626,-929.11"/>
<polygon fill="#000000" stroke="#000000" points="641.637,-932.014 651.512,-935.854 646.187,-926.695 641.637,-932.014"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge47" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M542.17,-864.783C591.76,-866.01 694.944,-868.562 753.664,-870.014"/>
<polygon fill="#000000" stroke="#000000" points="753.655,-873.515 763.739,-870.264 753.829,-866.517 753.655,-873.515"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge49" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M542.029,-867.574C554.901,-870.433 569.582,-875.632 580,-885.086 610.077,-912.383 594.805,-934.437 616,-969.086 624.526,-983.025 636.138,-997.158 645.918,-1008.1"/>
<polygon fill="#000000" stroke="#000000" points="643.622,-1010.77 652.958,-1015.78 648.784,-1006.04 643.622,-1010.77"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge51" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M542.382,-857.46C600.207,-845.135 735.383,-822.336 844,-850.086 861.927,-854.667 880.183,-864.511 894.195,-873.406"/>
<polygon fill="#000000" stroke="#000000" points="892.47,-876.461 902.744,-879.049 896.326,-870.619 892.47,-876.461"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_edge52" class="edge"><title>proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M710.288,-26.4121C721.033,-28.2304 732.671,-30.2 743.829,-32.0882"/>
<polygon fill="#000000" stroke="#000000" points="743.457,-35.5749 753.901,-33.7927 744.625,-28.6731 743.457,-35.5749"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_node46" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="959.5,-213.086 880.5,-213.086 880.5,-189.086 959.5,-189.086 959.5,-213.086"/>
<text text-anchor="middle" x="920" y="-198.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge53" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M709.454,-7.02253C747.921,1.24685 804.469,6.4852 844,-20.0864 897.93,-56.3369 913.136,-139.28 917.381,-179.04"/>
<polygon fill="#000000" stroke="#000000" points="913.899,-179.401 918.31,-189.034 920.869,-178.753 913.899,-179.401"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge54" class="edge"><title>proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M698.135,-369.082C704.191,-366.377 710.394,-363.335 716,-360.086 737.205,-347.799 759.302,-330.835 775.049,-317.916"/>
<polygon fill="#000000" stroke="#000000" points="777.656,-320.3 783.098,-311.21 773.175,-314.921 777.656,-320.3"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge55" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M711.603,-387.726C750.192,-391 805.665,-389.505 844,-362.086 890.594,-328.759 909.06,-259.013 915.684,-223.258"/>
<polygon fill="#000000" stroke="#000000" points="919.146,-223.777 917.378,-213.331 912.246,-222.6 919.146,-223.777"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_edge59" class="edge"><title>proc~store_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M358.972,-792.102C379.012,-805.871 413.71,-828.42 446,-843.086 454.844,-847.103 464.678,-850.676 473.997,-853.685"/>
<polygon fill="#000000" stroke="#000000" points="473.248,-857.117 483.836,-856.724 475.314,-850.429 473.248,-857.117"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_indices -->
<g id="proc~~ndmc~~CallsGraph_edge57" class="edge"><title>proc~store_photons&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M381.857,-789.934C408.138,-796.426 442.529,-804.923 469.357,-811.551"/>
<polygon fill="#000000" stroke="#000000" points="468.689,-814.991 479.236,-813.992 470.368,-808.195 468.689,-814.991"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge60" class="edge"><title>proc~store_photons&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M381.78,-770.041C465.006,-749.774 654.845,-707.676 716,-729.086 797.555,-757.639 870.765,-834.224 902.422,-870.929"/>
<polygon fill="#000000" stroke="#000000" points="900.081,-873.58 909.218,-878.943 905.419,-869.052 900.081,-873.58"/>
</g>
<!-- proc~get_passive_grid_indices -->
<g id="proc~~ndmc~~CallsGraph_node44" class="node"><title>proc~get_passive_grid_indices</title>
<g id="a_proc~~ndmc~~CallsGraph_node44"><a xlink:href=".././proc/get_passive_grid_indices.html" xlink:title="get_passive_grid_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="579.5,-792.086 446.5,-792.086 446.5,-768.086 579.5,-768.086 579.5,-792.086"/>
<text text-anchor="middle" x="513" y="-777.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_passive_grid_indices</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_passive_grid_indices -->
<g id="proc~~ndmc~~CallsGraph_edge56" class="edge"><title>proc~store_photons&#45;&gt;proc~get_passive_grid_indices</title>
<path fill="none" stroke="#000000" d="M381.857,-780.086C398.162,-780.086 417.589,-780.086 436.395,-780.086"/>
<polygon fill="#000000" stroke="#000000" points="436.452,-783.586 446.452,-780.086 436.452,-776.586 436.452,-783.586"/>
</g>
<!-- proc~spectrum -->
<g id="proc~~ndmc~~CallsGraph_node55" class="node"><title>proc~spectrum</title>
<g id="a_proc~~ndmc~~CallsGraph_node55"><a xlink:href=".././proc/spectrum.html" xlink:title="spectrum">
<polygon fill="#d9534f" stroke="#d9534f" points="541.5,-712.086 484.5,-712.086 484.5,-688.086 541.5,-688.086 541.5,-712.086"/>
<text text-anchor="middle" x="513" y="-697.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spectrum</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~spectrum -->
<g id="proc~~ndmc~~CallsGraph_edge58" class="edge"><title>proc~store_photons&#45;&gt;proc~spectrum</title>
<path fill="none" stroke="#000000" d="M381.714,-771.044C391.323,-767.996 401.318,-764.066 410,-759.086 428.828,-748.288 427.594,-737.59 446,-726.086 454.851,-720.555 465.075,-715.836 474.793,-711.998"/>
<polygon fill="#000000" stroke="#000000" points="476.13,-715.235 484.272,-708.457 473.68,-708.678 476.13,-715.235"/>
</g>
<!-- proc~in_passive_grid -->
<g id="proc~~ndmc~~CallsGraph_node50" class="node"><title>proc~in_passive_grid</title>
<g id="a_proc~~ndmc~~CallsGraph_node50"><a xlink:href=".././proc/in_passive_grid.html" xlink:title="in_passive_grid">
<polygon fill="#d94e8f" stroke="#d94e8f" points="709.5,-1153.09 622.5,-1153.09 622.5,-1129.09 709.5,-1129.09 709.5,-1153.09"/>
<text text-anchor="middle" x="666" y="-1138.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_passive_grid</text>
</a>
</g>
</g>
<!-- proc~grid_intersect&#45;&gt;proc~in_passive_grid -->
<g id="proc~~ndmc~~CallsGraph_edge61" class="edge"><title>proc~grid_intersect&#45;&gt;proc~in_passive_grid</title>
<path fill="none" stroke="#000000" d="M551.714,-1144.84C570.013,-1144.23 592.303,-1143.49 612.254,-1142.83"/>
<polygon fill="#000000" stroke="#000000" points="612.562,-1146.32 622.44,-1142.5 612.33,-1139.33 612.562,-1146.32"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge62" class="edge"><title>proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M706.004,-327.085C719.124,-323.048 733.935,-318.491 747.739,-314.244"/>
<polygon fill="#000000" stroke="#000000" points="749.045,-317.504 757.574,-311.217 746.987,-310.813 749.045,-317.504"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge63" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M711.791,-350.715C749.728,-357.932 804.148,-361.855 844,-338.086 886.055,-313.004 906.098,-255.136 914.258,-223.219"/>
<polygon fill="#000000" stroke="#000000" points="917.666,-224.014 916.584,-213.474 910.858,-222.388 917.666,-224.014"/>
</g>
<!-- dgetrf -->
<g id="proc~~ndmc~~CallsGraph_node47" class="node"><title>dgetrf</title>
<polygon fill="#777777" stroke="#777777" points="540,-1238.09 486,-1238.09 486,-1214.09 540,-1214.09 540,-1238.09"/>
<text text-anchor="middle" x="513" y="-1223.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrf</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrf -->
<g id="proc~~ndmc~~CallsGraph_edge66" class="edge"><title>proc~linsolve&#45;&gt;dgetrf</title>
<path fill="none" stroke="#000000" d="M368.19,-1244.7C397.016,-1240.97 443.543,-1234.95 475.836,-1230.77"/>
<polygon fill="#000000" stroke="#000000" points="476.312,-1234.23 485.78,-1229.48 475.414,-1227.29 476.312,-1234.23"/>
</g>
<!-- proc~matinv -->
<g id="proc~~ndmc~~CallsGraph_node56" class="node"><title>proc~matinv</title>
<g id="a_proc~~ndmc~~CallsGraph_node56"><a xlink:href=".././proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-1322.09 486,-1322.09 486,-1298.09 540,-1298.09 540,-1322.09"/>
<text text-anchor="middle" x="513" y="-1307.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~linsolve&#45;&gt;proc~matinv -->
<g id="proc~~ndmc~~CallsGraph_edge64" class="edge"><title>proc~linsolve&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M368.316,-1259.03C389.231,-1267.59 419.303,-1279.59 446,-1289.09 455.669,-1292.53 466.228,-1296.01 476.007,-1299.12"/>
<polygon fill="#000000" stroke="#000000" points="475.257,-1302.55 485.847,-1302.21 477.356,-1295.87 475.257,-1302.55"/>
</g>
<!-- dgetrs -->
<g id="proc~~ndmc~~CallsGraph_node61" class="node"><title>dgetrs</title>
<polygon fill="#777777" stroke="#777777" points="540,-1280.09 486,-1280.09 486,-1256.09 540,-1256.09 540,-1280.09"/>
<text text-anchor="middle" x="513" y="-1265.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrs</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrs -->
<g id="proc~~ndmc~~CallsGraph_edge65" class="edge"><title>proc~linsolve&#45;&gt;dgetrs</title>
<path fill="none" stroke="#000000" d="M368.19,-1251.17C397.016,-1254.56 443.543,-1260.03 475.836,-1263.83"/>
<polygon fill="#000000" stroke="#000000" points="475.44,-1267.31 485.78,-1265 476.258,-1260.36 475.44,-1267.31"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge67" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M842.323,-188.307C851.298,-189.803 860.813,-191.389 869.976,-192.916"/>
<polygon fill="#000000" stroke="#000000" points="869.683,-196.415 880.122,-194.607 870.834,-189.51 869.683,-196.415"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge68" class="edge"><title>proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M706.004,-271.088C719.124,-275.125 733.935,-279.682 747.739,-283.929"/>
<polygon fill="#000000" stroke="#000000" points="746.987,-287.36 757.574,-286.955 749.045,-280.669 746.987,-287.36"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge69" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M711.606,-251.097C747.537,-244.401 799.257,-234.178 844,-223.086 852.612,-220.951 861.719,-218.472 870.504,-215.963"/>
<polygon fill="#000000" stroke="#000000" points="871.617,-219.284 880.244,-213.134 869.664,-212.562 871.617,-219.284"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_node45" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~ndmc~~CallsGraph_node45"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="829,-963.086 767,-963.086 767,-939.086 829,-939.086 829,-963.086"/>
<text text-anchor="middle" x="798" y="-948.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge70" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M701.156,-948.875C718.135,-949.266 738.77,-949.743 756.537,-950.153"/>
<polygon fill="#000000" stroke="#000000" points="756.54,-953.654 766.618,-950.385 756.702,-946.655 756.54,-953.654"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_edge71" class="edge"><title>proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M693.936,-87.0687C713.284,-78.4365 739.579,-66.7048 760.767,-57.2521"/>
<polygon fill="#000000" stroke="#000000" points="762.392,-60.3594 770.098,-53.0886 759.54,-53.9668 762.392,-60.3594"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge72" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M710.18,-95.3818C747.596,-94.0524 802.148,-96.7501 844,-118.086 871.484,-132.098 893.736,-160.676 906.668,-180.351"/>
<polygon fill="#000000" stroke="#000000" points="903.792,-182.352 912.094,-188.935 909.709,-178.612 903.792,-182.352"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_edge73" class="edge"><title>proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M777.828,-53.1003C770.784,-62.058 777.508,-71.0864 798,-71.0864 810.487,-71.0864 817.862,-67.7338 820.124,-63.0876"/>
<polygon fill="#000000" stroke="#000000" points="823.526,-62.243 818.172,-53.1003 816.656,-63.586 823.526,-62.243"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge74" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M813.194,-53.4426C822.483,-61.8823 834.595,-73.5812 844,-85.0864 869.346,-116.092 893.538,-156.007 907.297,-180.014"/>
<polygon fill="#000000" stroke="#000000" points="904.393,-181.988 912.366,-188.966 910.484,-178.539 904.393,-181.988"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~ndmc~~CallsGraph_node43" class="node"><title>proc~hqr2</title>
<g id="a_proc~~ndmc~~CallsGraph_node43"><a xlink:href=".././proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-1406.09 486,-1406.09 486,-1382.09 540,-1382.09 540,-1406.09"/>
<text text-anchor="middle" x="513" y="-1391.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~ndmc~~CallsGraph_edge75" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M368.19,-1411.85C397.016,-1408.29 443.543,-1402.54 475.836,-1398.55"/>
<polygon fill="#000000" stroke="#000000" points="476.285,-1402.02 485.78,-1397.33 475.427,-1395.08 476.285,-1402.02"/>
</g>
<!-- proc~balback -->
<g id="proc~~ndmc~~CallsGraph_node49" class="node"><title>proc~balback</title>
<g id="a_proc~~ndmc~~CallsGraph_node49"><a xlink:href=".././proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-1532.09 486,-1532.09 486,-1508.09 540,-1508.09 540,-1532.09"/>
<text text-anchor="middle" x="513" y="-1517.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~ndmc~~CallsGraph_edge76" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M354.024,-1427.36C372.336,-1445.43 409.008,-1479.18 446,-1499.09 455.291,-1504.09 465.967,-1508.13 475.988,-1511.28"/>
<polygon fill="#000000" stroke="#000000" points="475.132,-1514.67 485.713,-1514.13 477.105,-1507.96 475.132,-1514.67"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~ndmc~~CallsGraph_node51" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~ndmc~~CallsGraph_node51"><a xlink:href=".././proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-1364.09 486,-1364.09 486,-1340.09 540,-1340.09 540,-1364.09"/>
<text text-anchor="middle" x="513" y="-1349.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~ndmc~~CallsGraph_edge77" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M368.289,-1403.83C389.189,-1395.03 419.255,-1382.73 446,-1373.09 455.655,-1369.61 466.208,-1366.11 475.988,-1363"/>
<polygon fill="#000000" stroke="#000000" points="477.335,-1366.25 485.829,-1359.91 475.24,-1359.57 477.335,-1366.25"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~ndmc~~CallsGraph_node53" class="node"><title>proc~elmhes</title>
<g id="a_proc~~ndmc~~CallsGraph_node53"><a xlink:href=".././proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-1490.09 486,-1490.09 486,-1466.09 540,-1466.09 540,-1490.09"/>
<text text-anchor="middle" x="513" y="-1475.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~ndmc~~CallsGraph_edge78" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M368.289,-1426.35C389.189,-1435.14 419.255,-1447.45 446,-1457.09 455.655,-1460.57 466.208,-1464.06 475.988,-1467.17"/>
<polygon fill="#000000" stroke="#000000" points="475.24,-1470.61 485.829,-1470.26 477.335,-1463.93 475.24,-1470.61"/>
</g>
<!-- proc~balance -->
<g id="proc~~ndmc~~CallsGraph_node57" class="node"><title>proc~balance</title>
<g id="a_proc~~ndmc~~CallsGraph_node57"><a xlink:href=".././proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-1448.09 486,-1448.09 486,-1424.09 540,-1424.09 540,-1448.09"/>
<text text-anchor="middle" x="513" y="-1433.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~ndmc~~CallsGraph_edge79" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M368.19,-1418.32C397.016,-1421.88 443.543,-1427.63 475.836,-1431.62"/>
<polygon fill="#000000" stroke="#000000" points="475.427,-1435.09 485.78,-1432.85 476.285,-1428.15 475.427,-1435.09"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge80" class="edge"><title>proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M777.828,-311.1C770.784,-320.058 777.508,-329.086 798,-329.086 810.487,-329.086 817.862,-325.734 820.124,-321.088"/>
<polygon fill="#000000" stroke="#000000" points="823.526,-320.243 818.172,-311.1 816.656,-321.586 823.526,-320.243"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge81" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M822.572,-286.886C829.686,-282.834 837.364,-278.073 844,-273.086 865.135,-257.204 886.636,-235.926 901.167,-220.627"/>
<polygon fill="#000000" stroke="#000000" points="903.811,-222.923 908.091,-213.231 898.701,-218.139 903.811,-222.923"/>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_edge82" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M395.245,-446.047C400.525,-443.591 405.563,-440.638 410,-437.086 462.388,-395.154 492.912,-318.534 505.378,-280.994"/>
<polygon fill="#000000" stroke="#000000" points="508.833,-281.681 508.546,-271.09 502.166,-279.548 508.833,-281.681"/>
</g>
<!-- proc~my_rank -->
<g id="proc~~ndmc~~CallsGraph_node52" class="node"><title>proc~my_rank</title>
<g id="a_proc~~ndmc~~CallsGraph_node52"><a xlink:href=".././proc/my_rank.html" xlink:title="my_rank">
<polygon fill="#d94e8f" stroke="#d94e8f" points="540,-512.086 486,-512.086 486,-488.086 540,-488.086 540,-512.086"/>
<text text-anchor="middle" x="513" y="-497.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">my_rank</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~my_rank -->
<g id="proc~~ndmc~~CallsGraph_edge83" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~my_rank</title>
<path fill="none" stroke="#000000" d="M390.715,-470.122C417.965,-476.854 451.34,-485.1 476.176,-491.236"/>
<polygon fill="#000000" stroke="#000000" points="475.37,-494.642 485.917,-493.642 477.049,-487.846 475.37,-494.642"/>
</g>
<!-- proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_node54" class="node"><title>proc~init_reservoir</title>
<g id="a_proc~~ndmc~~CallsGraph_node54"><a xlink:href=".././proc/init_reservoir.html" xlink:title="init_reservoir">
<polygon fill="#d9534f" stroke="#d9534f" points="835,-514.086 761,-514.086 761,-490.086 835,-490.086 835,-514.086"/>
<text text-anchor="middle" x="798" y="-499.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_reservoir</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge84" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M386.454,-446.027C458.14,-428.814 602.69,-403.411 716,-443.086 739.552,-451.333 762.141,-468.861 777.452,-482.681"/>
<polygon fill="#000000" stroke="#000000" points="775.473,-485.622 785.169,-489.894 780.253,-480.508 775.473,-485.622"/>
</g>
<!-- proc~num_ranks -->
<g id="proc~~ndmc~~CallsGraph_node59" class="node"><title>proc~num_ranks</title>
<g id="a_proc~~ndmc~~CallsGraph_node59"><a xlink:href=".././proc/num_ranks.html" xlink:title="num_ranks">
<polygon fill="#d94e8f" stroke="#d94e8f" points="546,-470.086 480,-470.086 480,-446.086 546,-446.086 546,-470.086"/>
<text text-anchor="middle" x="513" y="-455.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">num_ranks</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~num_ranks -->
<g id="proc~~ndmc~~CallsGraph_edge85" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~num_ranks</title>
<path fill="none" stroke="#000000" d="M409.677,-458.086C429.956,-458.086 451.609,-458.086 469.75,-458.086"/>
<polygon fill="#000000" stroke="#000000" points="469.988,-461.586 479.988,-458.086 469.988,-454.586 469.988,-461.586"/>
</g>
<!-- proc~merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_node60" class="node"><title>proc~merge_reservoirs</title>
<g id="a_proc~~ndmc~~CallsGraph_node60"><a xlink:href=".././proc/merge_reservoirs.html" xlink:title="merge_reservoirs">
<polygon fill="#d9534f" stroke="#d9534f" points="561.5,-554.086 464.5,-554.086 464.5,-530.086 561.5,-530.086 561.5,-554.086"/>
<text text-anchor="middle" x="513" y="-539.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">merge_reservoirs</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_edge86" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M358.972,-470.102C379.012,-483.871 413.71,-506.42 446,-521.086 450.29,-523.035 454.814,-524.879 459.398,-526.605"/>
<polygon fill="#000000" stroke="#000000" points="458.245,-529.91 468.839,-529.978 460.599,-523.318 458.245,-529.91"/>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge87" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M825.786,-151.245C831.813,-154.075 838.154,-157.128 844,-160.086 858.954,-167.653 875.31,-176.523 888.921,-184.074"/>
<polygon fill="#000000" stroke="#000000" points="887.417,-187.242 897.855,-189.058 890.828,-181.13 887.417,-187.242"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~ndmc~~CallsGraph_node62" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~ndmc~~CallsGraph_node62"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="836.5,-1177.09 759.5,-1177.09 759.5,-1153.09 836.5,-1153.09 836.5,-1177.09"/>
<text text-anchor="middle" x="798" y="-1162.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~ndmc~~CallsGraph_edge88" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M385.215,-1193.14C470.567,-1187.33 660.189,-1174.41 749.163,-1168.35"/>
<polygon fill="#000000" stroke="#000000" points="749.506,-1171.83 759.245,-1167.66 749.03,-1164.85 749.506,-1171.83"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge89" class="edge"><title>proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M698.135,-229.09C704.191,-231.796 710.394,-234.838 716,-238.086 737.205,-250.374 759.302,-267.338 775.049,-280.257"/>
<polygon fill="#000000" stroke="#000000" points="773.175,-283.251 783.098,-286.963 777.656,-277.873 773.175,-283.251"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge90" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M711.762,-214.244C756.337,-211.414 824.56,-207.083 870.427,-204.17"/>
<polygon fill="#000000" stroke="#000000" points="870.672,-207.662 880.43,-203.535 870.229,-200.676 870.672,-207.662"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge92" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M678.391,-1016.07C688.934,-1004.58 704.645,-986.479 716,-969.086 735.558,-939.128 727.476,-923.135 752,-897.086 754.774,-894.14 757.956,-891.429 761.32,-888.96"/>
<polygon fill="#000000" stroke="#000000" points="763.473,-891.733 769.922,-883.327 759.639,-885.877 763.473,-891.733"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_node58" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~ndmc~~CallsGraph_node58"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="952.5,-1023.09 887.5,-1023.09 887.5,-999.086 952.5,-999.086 952.5,-1023.09"/>
<text text-anchor="middle" x="920" y="-1008.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge91" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M696.525,-1038.91C731.99,-1050.36 793.073,-1065.1 844,-1052.09 861.927,-1047.51 880.183,-1037.66 894.195,-1028.77"/>
<polygon fill="#000000" stroke="#000000" points="896.326,-1031.55 902.744,-1023.12 892.47,-1025.71 896.326,-1031.55"/>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~ndmc~~CallsGraph_edge93" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M673.144,-1040.15C685.36,-1063.1 714.761,-1113.51 752,-1144.09 753.549,-1145.36 755.188,-1146.57 756.888,-1147.73"/>
<polygon fill="#000000" stroke="#000000" points="755.377,-1150.9 765.757,-1153.03 758.968,-1144.9 755.377,-1150.9"/>
</g>
<!-- proc~update_reservoir -->
<g id="proc~~ndmc~~CallsGraph_node48" class="node"><title>proc~update_reservoir</title>
<g id="a_proc~~ndmc~~CallsGraph_node48"><a xlink:href=".././proc/update_reservoir.html" xlink:title="update_reservoir">
<polygon fill="#d9534f" stroke="#d9534f" points="713,-594.086 619,-594.086 619,-570.086 713,-570.086 713,-594.086"/>
<text text-anchor="middle" x="666" y="-579.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_reservoir</text>
</a>
</g>
</g>
<!-- proc~update_neutrals&#45;&gt;proc~update_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge94" class="edge"><title>proc~update_neutrals&#45;&gt;proc~update_reservoir</title>
<path fill="none" stroke="#000000" d="M386.235,-582.086C444.09,-582.086 545.508,-582.086 608.76,-582.086"/>
<polygon fill="#000000" stroke="#000000" points="608.955,-585.586 618.955,-582.086 608.955,-578.586 608.955,-585.586"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~ndmc~~CallsGraph_node68" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~ndmc~~CallsGraph_node68"><a xlink:href=".././proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="693,-1406.09 639,-1406.09 639,-1382.09 693,-1382.09 693,-1406.09"/>
<text text-anchor="middle" x="666" y="-1391.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~ndmc~~CallsGraph_edge95" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M540.302,-1394.09C564.769,-1394.09 601.446,-1394.09 628.696,-1394.09"/>
<polygon fill="#000000" stroke="#000000" points="628.999,-1397.59 638.999,-1394.09 628.999,-1390.59 628.999,-1397.59"/>
</g>
<!-- proc~xyz_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_node70" class="node"><title>proc~xyz_to_cyl</title>
<g id="a_proc~~ndmc~~CallsGraph_node70"><a xlink:href=".././proc/xyz_to_cyl.html" xlink:title="xyz_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="697,-762.086 635,-762.086 635,-738.086 697,-738.086 697,-762.086"/>
<text text-anchor="middle" x="666" y="-747.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_cyl</text>
</a>
</g>
</g>
<!-- proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_edge96" class="edge"><title>proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl</title>
<path fill="none" stroke="#000000" d="M574.547,-768.057C591.347,-764.719 609.176,-761.177 624.524,-758.128"/>
<polygon fill="#000000" stroke="#000000" points="625.583,-761.486 634.71,-756.104 624.219,-754.62 625.583,-761.486"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge98" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M823.284,-938.944C841.257,-929.958 865.953,-917.61 885.757,-907.708"/>
<polygon fill="#000000" stroke="#000000" points="887.373,-910.813 894.752,-903.21 884.243,-904.552 887.373,-910.813"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge97" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M823.284,-963.228C841.257,-972.215 865.953,-984.563 885.757,-994.465"/>
<polygon fill="#000000" stroke="#000000" points="884.243,-997.621 894.752,-998.963 887.373,-991.36 884.243,-997.621"/>
</g>
<!-- proc~update_reservoir&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge100" class="edge"><title>proc~update_reservoir&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M713.221,-581.72C762.024,-581.332 837.953,-580.73 882.652,-580.375"/>
<polygon fill="#000000" stroke="#000000" points="882.799,-583.874 892.771,-580.295 882.743,-576.874 882.799,-583.874"/>
</g>
<!-- proc~update_reservoir&#45;&gt;interface~randind -->
<g id="proc~~ndmc~~CallsGraph_edge101" class="edge"><title>proc~update_reservoir&#45;&gt;interface~randind</title>
<path fill="none" stroke="#000000" d="M708.133,-594.11C725.135,-599.08 744.667,-604.789 761.082,-609.587"/>
<polygon fill="#000000" stroke="#000000" points="760.269,-612.996 770.849,-612.442 762.233,-606.277 760.269,-612.996"/>
</g>
<!-- proc~update_reservoir&#45;&gt;proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge99" class="edge"><title>proc~update_reservoir&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M686.744,-569.936C708.632,-556.466 744.113,-534.632 768.895,-519.382"/>
<polygon fill="#000000" stroke="#000000" points="770.814,-522.311 777.496,-514.089 767.145,-516.349 770.814,-522.311"/>
</g>
<!-- proc~rswap -->
<g id="proc~~ndmc~~CallsGraph_node65" class="node"><title>proc~rswap</title>
<g id="a_proc~~ndmc~~CallsGraph_node65"><a xlink:href=".././proc/rswap.html" xlink:title="RSWAP">
<polygon fill="#d9534f" stroke="#d9534f" points="693,-1490.09 639,-1490.09 639,-1466.09 693,-1466.09 693,-1490.09"/>
<text text-anchor="middle" x="666" y="-1475.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RSWAP</text>
</a>
</g>
</g>
<!-- proc~balback&#45;&gt;proc~rswap -->
<g id="proc~~ndmc~~CallsGraph_edge102" class="edge"><title>proc~balback&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M540.302,-1512.77C564.878,-1505.93 601.771,-1495.67 629.057,-1488.08"/>
<polygon fill="#000000" stroke="#000000" points="630.303,-1491.37 638.999,-1485.32 628.427,-1484.63 630.303,-1491.37"/>
</g>
<!-- proc~approx_le -->
<g id="proc~~ndmc~~CallsGraph_node66" class="node"><title>proc~approx_le</title>
<g id="a_proc~~ndmc~~CallsGraph_node66"><a xlink:href=".././proc/approx_le.html" xlink:title="approx_le">
<polygon fill="#d94e8f" stroke="#d94e8f" points="828,-1135.09 768,-1135.09 768,-1111.09 828,-1111.09 828,-1135.09"/>
<text text-anchor="middle" x="798" y="-1120.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_le</text>
</a>
</g>
</g>
<!-- proc~in_passive_grid&#45;&gt;proc~approx_le -->
<g id="proc~~ndmc~~CallsGraph_edge103" class="edge"><title>proc~in_passive_grid&#45;&gt;proc~approx_le</title>
<path fill="none" stroke="#000000" d="M709.567,-1135.19C725.09,-1133.04 742.558,-1130.62 757.776,-1128.52"/>
<polygon fill="#000000" stroke="#000000" points="758.476,-1131.95 767.901,-1127.12 757.516,-1125.02 758.476,-1131.95"/>
</g>
<!-- proc~uvw_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_node67" class="node"><title>proc~uvw_to_cyl</title>
<g id="a_proc~~ndmc~~CallsGraph_node67"><a xlink:href=".././proc/uvw_to_cyl.html" xlink:title="uvw_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="830.5,-1043.09 765.5,-1043.09 765.5,-1019.09 830.5,-1019.09 830.5,-1043.09"/>
<text text-anchor="middle" x="798" y="-1028.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_cyl</text>
</a>
</g>
</g>
<!-- proc~in_passive_grid&#45;&gt;proc~uvw_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_edge105" class="edge"><title>proc~in_passive_grid&#45;&gt;proc~uvw_to_cyl</title>
<path fill="none" stroke="#000000" d="M681.409,-1128.89C704.055,-1109.73 748.142,-1072.43 774.842,-1049.84"/>
<polygon fill="#000000" stroke="#000000" points="777.153,-1052.46 782.526,-1043.33 772.632,-1047.12 777.153,-1052.46"/>
</g>
<!-- proc~approx_ge -->
<g id="proc~~ndmc~~CallsGraph_node71" class="node"><title>proc~approx_ge</title>
<g id="a_proc~~ndmc~~CallsGraph_node71"><a xlink:href=".././proc/approx_ge.html" xlink:title="approx_ge">
<polygon fill="#d94e8f" stroke="#d94e8f" points="830,-1219.09 766,-1219.09 766,-1195.09 830,-1195.09 830,-1219.09"/>
<text text-anchor="middle" x="798" y="-1204.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_ge</text>
</a>
</g>
</g>
<!-- proc~in_passive_grid&#45;&gt;proc~approx_ge -->
<g id="proc~~ndmc~~CallsGraph_edge104" class="edge"><title>proc~in_passive_grid&#45;&gt;proc~approx_ge</title>
<path fill="none" stroke="#000000" d="M689.212,-1153.24C706.27,-1162.47 730.474,-1175.37 752,-1186.09 754.933,-1187.55 757.987,-1189.03 761.061,-1190.51"/>
<polygon fill="#000000" stroke="#000000" points="759.709,-1193.74 770.244,-1194.87 762.709,-1187.42 759.709,-1193.74"/>
</g>
<!-- proc~elmhes&#45;&gt;proc~rswap -->
<g id="proc~~ndmc~~CallsGraph_edge106" class="edge"><title>proc~elmhes&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M540.302,-1478.09C564.769,-1478.09 601.446,-1478.09 628.696,-1478.09"/>
<polygon fill="#000000" stroke="#000000" points="628.999,-1481.59 638.999,-1478.09 628.999,-1474.59 628.999,-1481.59"/>
</g>
<!-- proc~init_reservoir&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge107" class="edge"><title>proc~init_reservoir&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M820.731,-514.162C828.187,-518.432 836.532,-523.351 844,-528.086 860.954,-538.836 879.498,-551.683 893.905,-561.918"/>
<polygon fill="#000000" stroke="#000000" points="892.119,-564.943 902.289,-567.911 896.189,-559.248 892.119,-564.943"/>
</g>
<!-- proc~lubksb -->
<g id="proc~~ndmc~~CallsGraph_node63" class="node"><title>proc~lubksb</title>
<g id="a_proc~~ndmc~~CallsGraph_node63"><a xlink:href=".././proc/lubksb.html" xlink:title="lubksb">
<polygon fill="#d9534f" stroke="#d9534f" points="693,-1348.09 639,-1348.09 639,-1324.09 693,-1324.09 693,-1348.09"/>
<text text-anchor="middle" x="666" y="-1333.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lubksb</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~lubksb -->
<g id="proc~~ndmc~~CallsGraph_edge109" class="edge"><title>proc~matinv&#45;&gt;proc~lubksb</title>
<path fill="none" stroke="#000000" d="M540.302,-1314.62C564.878,-1318.85 601.771,-1325.2 629.057,-1329.9"/>
<polygon fill="#000000" stroke="#000000" points="628.55,-1333.36 638.999,-1331.61 629.738,-1326.46 628.55,-1333.36"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~ndmc~~CallsGraph_node69" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~ndmc~~CallsGraph_node69"><a xlink:href=".././proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="693,-1306.09 639,-1306.09 639,-1282.09 693,-1282.09 693,-1306.09"/>
<text text-anchor="middle" x="666" y="-1291.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~ndmc~~CallsGraph_edge108" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M540.302,-1307.3C564.769,-1304.71 601.446,-1300.82 628.696,-1297.93"/>
<polygon fill="#000000" stroke="#000000" points="629.424,-1301.38 638.999,-1296.84 628.686,-1294.41 629.424,-1301.38"/>
</g>
<!-- proc~balance&#45;&gt;proc~rswap -->
<g id="proc~~ndmc~~CallsGraph_edge110" class="edge"><title>proc~balance&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M540.302,-1443.4C564.878,-1450.24 601.771,-1460.5 629.057,-1468.09"/>
<polygon fill="#000000" stroke="#000000" points="628.427,-1471.55 638.999,-1470.85 630.303,-1464.8 628.427,-1471.55"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge112" class="edge"><title>proc~merge_reservoirs&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M561.65,-546.557C643.561,-554.243 809.319,-569.795 882.671,-576.678"/>
<polygon fill="#000000" stroke="#000000" points="882.518,-580.179 892.801,-577.628 883.172,-573.209 882.518,-580.179"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;proc~update_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge114" class="edge"><title>proc~merge_reservoirs&#45;&gt;proc~update_reservoir</title>
<path fill="none" stroke="#000000" d="M559.305,-554.088C575.06,-558.261 592.915,-562.991 609.406,-567.359"/>
<polygon fill="#000000" stroke="#000000" points="608.903,-570.847 619.466,-570.024 610.696,-564.08 608.903,-570.847"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge111" class="edge"><title>proc~merge_reservoirs&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M561.687,-535.346C614.409,-527.894 698.754,-515.973 750.851,-508.609"/>
<polygon fill="#000000" stroke="#000000" points="751.41,-512.065 760.821,-507.2 750.43,-505.134 751.41,-512.065"/>
</g>
<!-- float -->
<g id="proc~~ndmc~~CallsGraph_node64" class="node"><title>float</title>
<polygon fill="#777777" stroke="#777777" points="693,-476.086 639,-476.086 639,-452.086 693,-452.086 693,-476.086"/>
<text text-anchor="middle" x="666" y="-461.686" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">float</text>
</g>
<!-- proc~merge_reservoirs&#45;&gt;float -->
<g id="proc~~ndmc~~CallsGraph_edge113" class="edge"><title>proc~merge_reservoirs&#45;&gt;float</title>
<path fill="none" stroke="#000000" d="M560.096,-530.066C566.962,-527.527 573.807,-524.546 580,-521.086 598.433,-510.788 598.566,-501.998 616,-490.086 620.622,-486.929 625.671,-483.864 630.715,-481.014"/>
<polygon fill="#000000" stroke="#000000" points="632.576,-483.987 639.696,-476.141 629.237,-477.834 632.576,-483.987"/>
</g>
<!-- proc~approx_eq -->
<g id="proc~~ndmc~~CallsGraph_node74" class="node"><title>proc~approx_eq</title>
<g id="a_proc~~ndmc~~CallsGraph_node74"><a xlink:href=".././proc/approx_eq.html" xlink:title="approx_eq">
<polygon fill="#d94e8f" stroke="#d94e8f" points="952,-1177.09 888,-1177.09 888,-1153.09 952,-1153.09 952,-1177.09"/>
<text text-anchor="middle" x="920" y="-1162.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_eq</text>
</a>
</g>
</g>
<!-- proc~approx_le&#45;&gt;proc~approx_eq -->
<g id="proc~~ndmc~~CallsGraph_edge115" class="edge"><title>proc~approx_le&#45;&gt;proc~approx_eq</title>
<path fill="none" stroke="#000000" d="M828.049,-1133.25C842.984,-1138.48 861.442,-1144.94 877.819,-1150.67"/>
<polygon fill="#000000" stroke="#000000" points="877.102,-1154.13 887.697,-1154.13 879.414,-1147.52 877.102,-1154.13"/>
</g>
<!-- proc~comdiv -->
<g id="proc~~ndmc~~CallsGraph_node75" class="node"><title>proc~comdiv</title>
<g id="a_proc~~ndmc~~CallsGraph_node75"><a xlink:href=".././proc/comdiv.html" xlink:title="Comdiv">
<polygon fill="#d9534f" stroke="#d9534f" points="825,-1406.09 771,-1406.09 771,-1382.09 825,-1382.09 825,-1406.09"/>
<text text-anchor="middle" x="798" y="-1391.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Comdiv</text>
</a>
</g>
</g>
<!-- proc~hqrvec&#45;&gt;proc~comdiv -->
<g id="proc~~ndmc~~CallsGraph_edge116" class="edge"><title>proc~hqrvec&#45;&gt;proc~comdiv</title>
<path fill="none" stroke="#000000" d="M693.307,-1394.09C712.69,-1394.09 739.29,-1394.09 760.695,-1394.09"/>
<polygon fill="#000000" stroke="#000000" points="760.732,-1397.59 770.732,-1394.09 760.732,-1390.59 760.732,-1397.59"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~ndmc~~CallsGraph_node72" class="node"><title>proc~outerprod</title>
<g id="a_proc~~ndmc~~CallsGraph_node72"><a xlink:href=".././proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="827.5,-1273.09 768.5,-1273.09 768.5,-1249.09 827.5,-1249.09 827.5,-1273.09"/>
<text text-anchor="middle" x="798" y="-1258.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~ndmc~~CallsGraph_edge118" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M693.307,-1287.41C712.053,-1282.65 737.548,-1276.18 758.566,-1270.84"/>
<polygon fill="#000000" stroke="#000000" points="759.645,-1274.18 768.476,-1268.33 757.922,-1267.4 759.645,-1274.18"/>
</g>
<!-- proc~swap -->
<g id="proc~~ndmc~~CallsGraph_node73" class="node"><title>proc~swap</title>
<g id="a_proc~~ndmc~~CallsGraph_node73"><a xlink:href=".././proc/swap.html" xlink:title="swap">
<polygon fill="#d9534f" stroke="#d9534f" points="825,-1315.09 771,-1315.09 771,-1291.09 825,-1291.09 825,-1315.09"/>
<text text-anchor="middle" x="798" y="-1300.69" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swap</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~swap -->
<g id="proc~~ndmc~~CallsGraph_edge117" class="edge"><title>proc~ludcmp&#45;&gt;proc~swap</title>
<path fill="none" stroke="#000000" d="M693.307,-1295.91C712.69,-1297.25 739.29,-1299.09 760.695,-1300.57"/>
<polygon fill="#000000" stroke="#000000" points="760.514,-1304.07 770.732,-1301.27 760.997,-1297.09 760.514,-1304.07"/>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge119" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M697.03,-760.225C703.618,-763.176 710.316,-766.788 716,-771.086 745.315,-793.253 770.401,-828.223 784.589,-850.389"/>
<polygon fill="#000000" stroke="#000000" points="781.718,-852.4 789.982,-859.03 787.656,-848.694 781.718,-852.4"/>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_edge120" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl</title>
<path fill="none" stroke="#000000" d="M697.084,-757.545C704.224,-760.647 711.163,-765 716,-771.086 772.469,-842.134 715.458,-889.013 752,-972.086 758.283,-986.369 768.694,-1000.34 777.921,-1011.11"/>
<polygon fill="#000000" stroke="#000000" points="775.39,-1013.53 784.658,-1018.66 780.614,-1008.87 775.39,-1013.53"/>
</g>
<!-- proc~approx_ge&#45;&gt;proc~approx_eq -->
<g id="proc~~ndmc~~CallsGraph_edge121" class="edge"><title>proc~approx_ge&#45;&gt;proc~approx_eq</title>
<path fill="none" stroke="#000000" d="M830.215,-1196.16C844.938,-1191.01 862.69,-1184.79 878.439,-1179.28"/>
<polygon fill="#000000" stroke="#000000" points="879.659,-1182.56 887.941,-1175.96 877.346,-1175.96 879.659,-1182.56"/>
</g>
</g>
</svg>
</div><script>var panprocndmcCallsGraph = svgPanZoom('#procndmcCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~ndmc~~CalledByGraph Pages: 1 -->
<svg id="procndmcCalledByGraph" width="152pt" height="32pt"
 viewBox="0.00 0.00 152.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~ndmc~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~ndmc~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 148,-28 148,4 -4,4"/>
<!-- proc~ndmc -->
<g id="proc~~ndmc~~CalledByGraph_node1" class="node"><title>proc~ndmc</title>
<polygon fill="none" stroke="black" points="144,-24 90,-24 90,-0 144,-0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">ndmc</text>
</g>
<!-- program~fidasim -->
<g id="proc~~ndmc~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~ndmc~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~ndmc -->
<g id="proc~~ndmc~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~ndmc</title>
<path fill="none" stroke="#000000" d="M54.4029,-12C62.3932,-12 71.3106,-12 79.8241,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.919,-15.5001 89.919,-12 79.919,-8.5001 79.919,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/ndmc.html#src">ndmc</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">ndmc</span><span class="w"></span>
<span class="w">    </span><span class="c">!+ Calculates neutral beam deposition and spectra</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">neut_type</span><span class="w"> </span><span class="c">!! full half third energy</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">nlaunch</span><span class="w">   </span><span class="c">!! nr. of markers</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">nneutrals</span><span class="w"> </span><span class="c">!! # NBI particles</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">vnbi</span><span class="w"> </span><span class="c">!! velocities(full..)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rnbi</span><span class="w"> </span><span class="c">!! initial position</span>

<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">jj</span><span class="p">,</span><span class="w"> </span><span class="n">ii</span><span class="p">,</span><span class="w"> </span><span class="n">kk</span><span class="p">,</span><span class="w"> </span><span class="n">cnt</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ntrack</span><span class="p">,</span><span class="w"> </span><span class="n">ic</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">ParticleTrack</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ntrack</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tracks</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">plasma</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fields</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">states</span><span class="p">,</span><span class="w"> </span><span class="n">dens</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">photons</span><span class="p">,</span><span class="w"> </span><span class="n">iflux</span><span class="p">,</span><span class="n">flux_tot</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ind</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ri</span><span class="p">,</span><span class="n">ri_gc</span><span class="p">,</span><span class="n">r_gyro</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">randomu</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">randi</span><span class="w"></span>
<span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">err</span><span class="w"></span>

<span class="w">    </span><span class="c">!! Initialize Neutral Population</span>
<span class="w">    </span><span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">half</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">third</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i10)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of birth markers: 3 x&quot;,i10)&#39;</span><span class="p">)</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="o">*</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_birth</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">    endif</span><span class="w"></span>

<span class="w">    </span><span class="c">!! # of injected neutrals = NBI power/energy_per_particle</span>
<span class="w">    </span><span class="n">nneutrals</span><span class="o">=</span><span class="mf">1.d6</span><span class="o">*</span><span class="n">nbi</span><span class="p">%</span><span class="n">pinj</span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.d3</span><span class="o">*</span><span class="n">nbi</span><span class="p">%</span><span class="n">einj</span><span class="o">*</span><span class="n">e0</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="o">*</span><span class="p">(</span><span class="w"> </span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="o">+</span><span class="w">  </span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.d0</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="o">+</span><span class="w">  </span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mf">3.d0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">nlaunch</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="c">!$OMP PARALLEL DO schedule(guided) &amp;</span>
<span class="w">    </span><span class="c">!$OMP&amp; private(vnbi,rnbi,tracks,ntrack,plasma,fields,randi,flux_tot, &amp;</span>
<span class="w">    </span><span class="c">!$OMP&amp; states,dens,iflux,photons,neut_type,jj,ii,kk,ind,err,ri,ri_gc,r_gyro)</span>
<span class="w">    </span><span class="n">loop_over_markers</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">ii</span><span class="o">=</span><span class="n">istart</span><span class="p">,</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="p">,</span><span class="n">istep</span><span class="w"></span>
<span class="w">        </span><span class="n">energy_fractions</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">neut_type</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="w"></span>
<span class="w">            </span><span class="c">!! (type = 1: full energy, =2: half energy, =3: third energy</span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="n">neut_type</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">energy_fractions</span><span class="w"></span>

<span class="w">            </span><span class="k">call </span><span class="n">mc_nbi</span><span class="p">(</span><span class="n">vnbi</span><span class="p">,</span><span class="n">neut_type</span><span class="p">,</span><span class="n">rnbi</span><span class="p">,</span><span class="n">err</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">energy_fractions</span><span class="w"></span>

<span class="w">            </span><span class="k">call </span><span class="n">track</span><span class="p">(</span><span class="n">rnbi</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">tracks</span><span class="p">,</span><span class="n">ntrack</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">ntrack</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">energy_fractions</span><span class="w"></span>

<span class="w">            </span><span class="c">!! Solve collisional radiative model along track</span>
<span class="w">            </span><span class="n">flux_tot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.d0</span><span class="w"></span>
<span class="w">            </span><span class="n">states</span><span class="o">=</span><span class="mf">0.d0</span><span class="w"></span>
<span class="w">            </span><span class="n">states</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">nneutrals</span><span class="o">*</span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="n">neut_type</span><span class="p">)</span><span class="o">/</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="w"></span>
<span class="w">            </span><span class="n">loop_along_track</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">jj</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ntrack</span><span class="w"></span>
<span class="w">                </span><span class="n">iflux</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="n">ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">ind</span><span class="w"></span>
<span class="w">                </span><span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">call </span><span class="n">colrad</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">beam_mass</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="nb">time</span><span class="p">,</span><span class="n">states</span><span class="p">,</span><span class="n">dens</span><span class="p">,</span><span class="n">photons</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="n">dens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dens</span><span class="o">/</span><span class="n">nlaunch</span><span class="w"></span>
<span class="w">                </span><span class="k">call </span><span class="n">store_neutrals</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">neut_type</span><span class="p">,</span><span class="n">dens</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">flux</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">iflux</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">))</span><span class="o">/</span><span class="n">nlaunch</span><span class="w"></span>
<span class="w">                </span><span class="n">flux_tot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">flux_tot</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">flux</span><span class="o">*</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    call </span><span class="n">store_births</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">neut_type</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">flux</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">endif</span>

<span class="k">                if</span><span class="p">((</span><span class="n">photons</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_bes</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    call </span><span class="n">store_nbi_photons</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">beam_lambda0</span><span class="p">,</span><span class="w"> </span><span class="n">photons</span><span class="o">/</span><span class="n">nlaunch</span><span class="p">,</span><span class="n">neut_type</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">endif</span>
<span class="k">            enddo </span><span class="n">loop_along_track</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">((</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">flux_tot</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">                </span><span class="c">!! Sample according to deposited flux along neutral trajectory</span>
<span class="w">                </span><span class="c">!$OMP CRITICAL(ndmc_birth)</span>
<span class="w">                </span><span class="k">do </span><span class="n">kk</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_birth</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">randind</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ntrack</span><span class="p">)%</span><span class="n">flux</span><span class="p">,</span><span class="n">randi</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">randu</span><span class="p">(</span><span class="n">randomu</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">neut_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neut_type</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">energy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbi</span><span class="p">%</span><span class="n">einj</span><span class="o">/</span><span class="kt">real</span><span class="p">(</span><span class="n">neut_type</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">flux_tot</span><span class="o">/</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_birth</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tracks</span><span class="p">(</span><span class="n">randi</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">ind</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">vi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vnbi</span><span class="w"></span>
<span class="w">                    </span><span class="n">ri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tracks</span><span class="p">(</span><span class="n">randi</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">pos</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">vnbi</span><span class="o">*</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="n">randi</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="nb">time</span><span class="o">*</span><span class="p">(</span><span class="n">randomu</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">))</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">ri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ri</span><span class="w"></span>

<span class="w">                    </span><span class="k">call </span><span class="n">get_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">pitch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dot_product</span><span class="p">(</span><span class="n">fields</span><span class="p">%</span><span class="n">b_norm</span><span class="p">,</span><span class="n">vnbi</span><span class="o">/</span><span class="nb">norm2</span><span class="p">(</span><span class="n">vnbi</span><span class="p">))</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">gyro_step</span><span class="p">(</span><span class="n">vnbi</span><span class="p">,</span><span class="n">fields</span><span class="p">,</span><span class="n">beam_mass</span><span class="p">,</span><span class="n">r_gyro</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">ri_gc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ri</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r_gyro</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                </span><span class="k">enddo</span><span class="w"></span>
<span class="w">                </span><span class="c">!$OMP END CRITICAL(ndmc_birth)</span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">        enddo </span><span class="n">energy_fractions</span><span class="w"></span>
<span class="w">    </span><span class="k">enddo </span><span class="n">loop_over_markers</span><span class="w"></span>
<span class="w">    </span><span class="c">!$OMP END PARALLEL DO</span>

<span class="cp">#ifdef _MPI</span>
<span class="w">    </span><span class="c">!! Combine beam neutrals</span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_merge_populations</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_merge_populations</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">half</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_merge_populations</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">third</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">nbi_outside</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">dens</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span><span class="w"></span>
<span class="w">    </span><span class="c">!! Combine spectra</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_bes</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">full</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">half</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">third</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span><span class="w"></span>
<span class="cp">#endif</span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">nbi_outside</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="k">        if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T4,a, f6.2,a)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Percent of markers outside the grid: &#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                                  </span><span class="mi">10</span><span class="mf">0.</span><span class="o">*</span><span class="n">nbi_outside</span><span class="o">/</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="p">),</span><span class="s1">&#39;%&#39;</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">        if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">%</span><span class="n">dens</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">stop</span><span class="w"> </span><span class="s1">&#39;Beam does not intersect the grid!&#39;</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">end subroutine </span><span class="n">ndmc</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>