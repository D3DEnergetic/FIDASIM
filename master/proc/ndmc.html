<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>ndmc &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>ndmc
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.7% of total for procedures.">94 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
    
     <li><a href='../module/libfida.html'>libfida</a></li>
    
  
     <li class="active">ndmc</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/ndmc.html#src">ndmc</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine ndmc()
    
    
   
</h2>
    
  


    
    <p>Calculates neutral beam deposition and spectra</p>
    

    <h3>Arguments</h3>
    
    <em>None</em>
    <br>
    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~ndmc~~CallsGraph Pages: 1 -->
<svg id="procndmcCallsGraph" width="641pt" height="650pt"
 viewBox="0.00 0.00 641.00 649.85" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~ndmc~~CallsGraph" class="graph" transform="scale(0.712222 0.712222) rotate(0) translate(4 908.428)">
<title>proc~~ndmc~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-908.428 896,-908.428 896,4 -4,4"/>
<!-- proc~ndmc -->
<g id="proc~~ndmc~~CallsGraph_node1" class="node"><title>proc~ndmc</title>
<polygon fill="none" stroke="black" points="54,-267.428 0,-267.428 0,-243.428 54,-243.428 54,-267.428"/>
<text text-anchor="middle" x="27" y="-253.028" font-family="Helvetica,sans-Serif" font-size="10.50">ndmc</text>
</g>
<!-- proc~gyro_step -->
<g id="proc~~ndmc~~CallsGraph_node2" class="node"><title>proc~gyro_step</title>
<g id="a_proc~~ndmc~~CallsGraph_node2"><a xlink:href=".././proc/gyro_step.html" xlink:title="gyro_step">
<polygon fill="#d9534f" stroke="#d9534f" points="193,-670.428 133,-670.428 133,-646.428 193,-646.428 193,-670.428"/>
<text text-anchor="middle" x="163" y="-656.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_step</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~gyro_step -->
<g id="proc~~ndmc~~CallsGraph_edge1" class="edge"><title>proc~ndmc&#45;&gt;proc~gyro_step</title>
<path fill="none" stroke="#000000" d="M30.1448,-267.645C36.773,-304.337 58.4035,-416.521 90,-505.428 107.311,-554.138 134.874,-608.229 150.395,-637.251"/>
<polygon fill="#000000" stroke="#000000" points="147.334,-638.95 155.164,-646.088 153.494,-635.626 147.334,-638.95"/>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_node3" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~ndmc~~CallsGraph_node3"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="532.5,-516.428 459.5,-516.428 459.5,-492.428 532.5,-492.428 532.5,-516.428"/>
<text text-anchor="middle" x="496" y="-502.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_edge2" class="edge"><title>proc~ndmc&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M49.3699,-267.511C61.2523,-274.138 76.3541,-282.409 90,-289.428 230.356,-361.621 274.26,-362.889 410,-443.428 431.816,-456.372 455.126,-473.347 471.807,-486.103"/>
<polygon fill="#000000" stroke="#000000" points="469.83,-488.999 479.883,-492.345 474.111,-483.46 469.83,-488.999"/>
</g>
<!-- interface~randu -->
<g id="proc~~ndmc~~CallsGraph_node4" class="node"><title>interface~randu</title>
<g id="a_proc~~ndmc~~CallsGraph_node4"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="887,-744.428 833,-744.428 833,-720.428 887,-720.428 887,-744.428"/>
<text text-anchor="middle" x="860" y="-730.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge3" class="edge"><title>proc~ndmc&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M54.2607,-258.251C107.888,-263.764 233.887,-275.428 340,-275.428 340,-275.428 340,-275.428 630,-275.428 826.791,-275.428 854.48,-618.327 858.367,-710.077"/>
<polygon fill="#000000" stroke="#000000" points="854.874,-710.339 858.74,-720.204 861.87,-710.082 854.874,-710.339"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_node5" class="node"><title>proc~get_fields</title>
<g id="a_proc~~ndmc~~CallsGraph_node5"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="370,-83.4275 312,-83.4275 312,-59.4275 370,-59.4275 370,-83.4275"/>
<text text-anchor="middle" x="341" y="-69.0275" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_edge4" class="edge"><title>proc~ndmc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M32.1315,-243.171C39.9396,-221.924 58.9232,-178.335 90,-155.428 143.972,-115.643 175.076,-145.428 236,-117.428 253.7,-109.293 254.487,-100.958 272,-92.4275 281.414,-87.8421 292.048,-83.9912 302.061,-80.891"/>
<polygon fill="#000000" stroke="#000000" points="303.186,-84.2089 311.801,-78.0417 301.22,-77.4905 303.186,-84.2089"/>
</g>
<!-- proc~parallel_merge_populations -->
<g id="proc~~ndmc~~CallsGraph_node6" class="node"><title>proc~parallel_merge_populations</title>
<g id="a_proc~~ndmc~~CallsGraph_node6"><a xlink:href=".././proc/parallel_merge_populations.html" xlink:title="parallel_merge_populations">
<polygon fill="#d9534f" stroke="#d9534f" points="235.5,-496.428 90.5,-496.428 90.5,-472.428 235.5,-472.428 235.5,-496.428"/>
<text text-anchor="middle" x="163" y="-482.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_merge_populations</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~parallel_merge_populations -->
<g id="proc~~ndmc~~CallsGraph_edge5" class="edge"><title>proc~ndmc&#45;&gt;proc~parallel_merge_populations</title>
<path fill="none" stroke="#000000" d="M31.5815,-267.587C39.5994,-293.739 60.6222,-356.743 90,-403.428 104.64,-426.692 126.019,-449.783 141.678,-465.322"/>
<polygon fill="#000000" stroke="#000000" points="139.246,-467.839 148.85,-472.311 144.131,-462.825 139.246,-467.839"/>
</g>
<!-- proc~mc_nbi -->
<g id="proc~~ndmc~~CallsGraph_node7" class="node"><title>proc~mc_nbi</title>
<g id="a_proc~~ndmc~~CallsGraph_node7"><a xlink:href=".././proc/mc_nbi.html" xlink:title="mc_nbi">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-247.428 314,-247.428 314,-223.428 368,-223.428 368,-247.428"/>
<text text-anchor="middle" x="341" y="-233.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_nbi</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~mc_nbi -->
<g id="proc~~ndmc~~CallsGraph_edge6" class="edge"><title>proc~ndmc&#45;&gt;proc~mc_nbi</title>
<path fill="none" stroke="#000000" d="M54.0643,-253.757C109.697,-250.191 240.166,-241.827 303.807,-237.748"/>
<polygon fill="#000000" stroke="#000000" points="304.035,-241.24 313.79,-237.108 303.587,-234.255 304.035,-241.24"/>
</g>
<!-- proc~track -->
<g id="proc~~ndmc~~CallsGraph_node8" class="node"><title>proc~track</title>
<g id="a_proc~~ndmc~~CallsGraph_node8"><a xlink:href=".././proc/track.html" xlink:title="track">
<polygon fill="#d9534f" stroke="#d9534f" points="190,-188.428 136,-188.428 136,-164.428 190,-164.428 190,-188.428"/>
<text text-anchor="middle" x="163" y="-174.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~track -->
<g id="proc~~ndmc~~CallsGraph_edge7" class="edge"><title>proc~ndmc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M48.6438,-243.257C71.1361,-229.997 107.299,-208.676 132.719,-193.69"/>
<polygon fill="#000000" stroke="#000000" points="134.716,-196.576 141.553,-188.482 131.161,-190.546 134.716,-196.576"/>
</g>
<!-- proc~init_neutral_population -->
<g id="proc~~ndmc~~CallsGraph_node9" class="node"><title>proc~init_neutral_population</title>
<g id="a_proc~~ndmc~~CallsGraph_node9"><a xlink:href=".././proc/init_neutral_population.html" xlink:title="init_neutral_population">
<polygon fill="#d9534f" stroke="#d9534f" points="223.5,-108.428 102.5,-108.428 102.5,-84.4275 223.5,-84.4275 223.5,-108.428"/>
<text text-anchor="middle" x="163" y="-94.0275" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_neutral_population</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~init_neutral_population -->
<g id="proc~~ndmc~~CallsGraph_edge8" class="edge"><title>proc~ndmc&#45;&gt;proc~init_neutral_population</title>
<path fill="none" stroke="#000000" d="M30.3722,-243.281C36.041,-217.41 52.769,-156.461 90,-122.428 93.8854,-118.876 98.2921,-115.801 102.966,-113.14"/>
<polygon fill="#000000" stroke="#000000" points="104.835,-116.118 112.216,-108.517 101.706,-109.857 104.835,-116.118"/>
</g>
<!-- proc~cross_product -->
<g id="proc~~ndmc~~CallsGraph_node25" class="node"><title>proc~cross_product</title>
<g id="a_proc~~ndmc~~CallsGraph_node25"><a xlink:href=".././proc/cross_product.html" xlink:title="cross_product">
<polygon fill="#d94e8f" stroke="#d94e8f" points="381,-782.428 301,-782.428 301,-758.428 381,-758.428 381,-782.428"/>
<text text-anchor="middle" x="341" y="-768.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cross_product</text>
</a>
</g>
</g>
<!-- proc~gyro_step&#45;&gt;proc~cross_product -->
<g id="proc~~ndmc~~CallsGraph_edge9" class="edge"><title>proc~gyro_step&#45;&gt;proc~cross_product</title>
<path fill="none" stroke="#000000" d="M175.128,-670.527C193.517,-689.845 232.19,-727.687 272,-749.428 277.974,-752.69 284.527,-755.521 291.132,-757.955"/>
<polygon fill="#000000" stroke="#000000" points="290.19,-761.332 300.785,-761.241 292.446,-754.705 290.19,-761.332"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_node10" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~ndmc~~CallsGraph_node10"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="673,-411.428 585,-411.428 585,-387.428 673,-387.428 673,-411.428"/>
<text text-anchor="middle" x="629" y="-397.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_edge11" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M506.899,-492.22C521.725,-474.547 551.26,-441.633 582,-420.428 584.087,-418.988 586.288,-417.606 588.551,-416.287"/>
<polygon fill="#000000" stroke="#000000" points="590.303,-419.319 597.477,-411.523 587.007,-413.144 590.303,-419.319"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~ndmc~~CallsGraph_node11" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~ndmc~~CallsGraph_node11"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="673,-369.428 585,-369.428 585,-345.428 673,-345.428 673,-369.428"/>
<text text-anchor="middle" x="629" y="-355.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~ndmc~~CallsGraph_edge16" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M502.315,-492.417C513.676,-467.956 542.536,-411.856 582,-378.428 583.507,-377.151 585.105,-375.936 586.765,-374.783"/>
<polygon fill="#000000" stroke="#000000" points="588.72,-377.691 595.464,-369.52 585.096,-371.702 588.72,-377.691"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~ndmc~~CallsGraph_node12" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~ndmc~~CallsGraph_node12"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-327.428 583.5,-327.428 583.5,-303.428 674.5,-303.428 674.5,-327.428"/>
<text text-anchor="middle" x="629" y="-313.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~ndmc~~CallsGraph_edge17" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M500.144,-492.167C508.488,-461.876 533.912,-382.623 582,-336.428 583.108,-335.363 584.279,-334.346 585.5,-333.375"/>
<polygon fill="#000000" stroke="#000000" points="587.756,-336.078 594.132,-327.616 583.871,-330.255 587.756,-336.078"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~ndmc~~CallsGraph_node13" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~ndmc~~CallsGraph_node13"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="673,-705.428 585,-705.428 585,-681.428 673,-681.428 673,-705.428"/>
<text text-anchor="middle" x="629" y="-691.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~ndmc~~CallsGraph_edge14" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M500.144,-516.688C508.488,-546.979 533.912,-626.232 582,-672.428 583.108,-673.492 584.279,-674.509 585.5,-675.48"/>
<polygon fill="#000000" stroke="#000000" points="583.871,-678.6 594.132,-681.239 587.756,-672.777 583.871,-678.6"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~ndmc~~CallsGraph_node16" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~ndmc~~CallsGraph_node16"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-663.428 583.5,-663.428 583.5,-639.428 674.5,-639.428 674.5,-663.428"/>
<text text-anchor="middle" x="629" y="-649.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~ndmc~~CallsGraph_edge15" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M502.315,-516.438C513.676,-540.899 542.536,-596.999 582,-630.428 583.507,-631.704 585.105,-632.919 586.765,-634.072"/>
<polygon fill="#000000" stroke="#000000" points="585.096,-637.153 595.464,-639.335 588.72,-631.164 585.096,-637.153"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_node19" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~ndmc~~CallsGraph_node19"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-621.428 583.5,-621.428 583.5,-597.428 674.5,-597.428 674.5,-621.428"/>
<text text-anchor="middle" x="629" y="-607.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge10" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M506.899,-516.635C521.725,-534.308 551.26,-567.222 582,-588.428 584.087,-589.867 586.288,-591.249 588.551,-592.568"/>
<polygon fill="#000000" stroke="#000000" points="587.007,-595.711 597.477,-597.332 590.303,-589.536 587.007,-595.711"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~ndmc~~CallsGraph_node21" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~ndmc~~CallsGraph_node21"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-579.428 583.5,-579.428 583.5,-555.428 674.5,-555.428 674.5,-579.428"/>
<text text-anchor="middle" x="629" y="-565.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~ndmc~~CallsGraph_edge13" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M521.086,-516.574C538.051,-525.069 561.335,-536.608 582,-546.428 585.189,-547.943 588.511,-549.5 591.847,-551.05"/>
<polygon fill="#000000" stroke="#000000" points="590.632,-554.344 601.179,-555.351 593.562,-547.986 590.632,-554.344"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~ndmc~~CallsGraph_node23" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~ndmc~~CallsGraph_node23"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-537.428 583.5,-537.428 583.5,-513.428 674.5,-513.428 674.5,-537.428"/>
<text text-anchor="middle" x="629" y="-523.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~ndmc~~CallsGraph_edge12" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.796,-510.166C545.232,-512.159 559.48,-514.443 573.1,-516.627"/>
<polygon fill="#000000" stroke="#000000" points="572.924,-520.143 583.352,-518.27 574.032,-513.231 572.924,-520.143"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~ndmc~~CallsGraph_node28" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~ndmc~~CallsGraph_node28"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="674.5,-495.428 583.5,-495.428 583.5,-471.428 674.5,-471.428 674.5,-495.428"/>
<text text-anchor="middle" x="629" y="-481.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~ndmc~~CallsGraph_edge18" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.796,-498.689C545.232,-496.696 559.48,-494.412 573.1,-492.228"/>
<polygon fill="#000000" stroke="#000000" points="574.032,-495.624 583.352,-490.585 572.924,-488.712 574.032,-495.624"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~ndmc~~CallsGraph_node29" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~ndmc~~CallsGraph_node29"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="673,-453.428 585,-453.428 585,-429.428 673,-429.428 673,-453.428"/>
<text text-anchor="middle" x="629" y="-439.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~ndmc~~CallsGraph_edge19" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M521.086,-492.281C538.051,-483.786 561.335,-472.247 582,-462.428 585.189,-460.912 588.511,-459.355 591.847,-457.806"/>
<polygon fill="#000000" stroke="#000000" points="593.562,-460.869 601.179,-453.504 590.632,-454.511 593.562,-460.869"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_node14" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~ndmc~~CallsGraph_node14"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="526.5,-125.428 465.5,-125.428 465.5,-101.428 526.5,-101.428 526.5,-125.428"/>
<text text-anchor="middle" x="496" y="-111.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge22" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M370.063,-79.131C394.006,-85.7037 428.703,-95.2285 455.46,-102.574"/>
<polygon fill="#000000" stroke="#000000" points="454.718,-105.999 465.287,-105.271 456.571,-99.2487 454.718,-105.999"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_node26" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~ndmc~~CallsGraph_node26"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="663,-26.4275 595,-26.4275 595,-2.42752 663,-2.42752 663,-26.4275"/>
<text text-anchor="middle" x="629" y="-12.0275" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge21" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M356.286,-59.218C375.291,-43.8611 410.622,-18.3072 446,-8.42752 492.063,4.43617 547.24,0.00168017 584.674,-5.77899"/>
<polygon fill="#000000" stroke="#000000" points="584.305,-9.26513 594.74,-7.43188 585.439,-2.35764 584.305,-9.26513"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~ndmc~~CallsGraph_node27" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~ndmc~~CallsGraph_node27"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="546,-83.4275 446,-83.4275 446,-59.4275 546,-59.4275 546,-83.4275"/>
<text text-anchor="middle" x="496" y="-69.0275" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~ndmc~~CallsGraph_edge20" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M370.063,-71.4275C388.391,-71.4275 413.022,-71.4275 435.569,-71.4275"/>
<polygon fill="#000000" stroke="#000000" points="435.751,-74.9276 445.751,-71.4275 435.751,-67.9276 435.751,-74.9276"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_node30" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~ndmc~~CallsGraph_node30"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="530,-41.4275 462,-41.4275 462,-17.4275 530,-17.4275 530,-41.4275"/>
<text text-anchor="middle" x="496" y="-27.0275" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge23" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M370.063,-63.7241C393.011,-57.4244 425.84,-48.4127 452.087,-41.2076"/>
<polygon fill="#000000" stroke="#000000" points="453.073,-44.5665 461.789,-38.5441 451.22,-37.8162 453.073,-44.5665"/>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_edge24" class="edge"><title>proc~parallel_merge_populations&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M235.822,-488.767C300.663,-492.685 394.108,-498.331 449.288,-501.665"/>
<polygon fill="#000000" stroke="#000000" points="449.269,-505.171 459.462,-502.28 449.691,-498.183 449.269,-505.171"/>
</g>
<!-- proc~ind2sub -->
<g id="proc~~ndmc~~CallsGraph_node22" class="node"><title>proc~ind2sub</title>
<g id="a_proc~~ndmc~~CallsGraph_node22"><a xlink:href=".././proc/ind2sub.html" xlink:title="ind2sub">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-476.428 314,-476.428 314,-452.428 368,-452.428 368,-476.428"/>
<text text-anchor="middle" x="341" y="-462.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ind2sub</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;proc~ind2sub -->
<g id="proc~~ndmc~~CallsGraph_edge26" class="edge"><title>proc~parallel_merge_populations&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M235.586,-476.293C258.98,-473.634 283.98,-470.793 303.65,-468.558"/>
<polygon fill="#000000" stroke="#000000" points="304.158,-472.023 313.699,-467.416 303.367,-465.068 304.158,-472.023"/>
</g>
<!-- proc~parallel_merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_node24" class="node"><title>proc~parallel_merge_reservoirs</title>
<g id="a_proc~~ndmc~~CallsGraph_node24"><a xlink:href=".././proc/parallel_merge_reservoirs.html" xlink:title="parallel_merge_reservoirs">
<polygon fill="#d9534f" stroke="#d9534f" points="409.5,-740.428 272.5,-740.428 272.5,-716.428 409.5,-716.428 409.5,-740.428"/>
<text text-anchor="middle" x="341" y="-726.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_merge_reservoirs</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;proc~parallel_merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_edge25" class="edge"><title>proc~parallel_merge_populations&#45;&gt;proc~parallel_merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M172.728,-496.528C200.936,-535.635 289.869,-658.928 325.261,-707.994"/>
<polygon fill="#000000" stroke="#000000" points="322.531,-710.192 331.219,-716.254 328.208,-706.097 322.531,-710.192"/>
</g>
<!-- proc~mc_nbi&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge27" class="edge"><title>proc~mc_nbi&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M368.166,-232.832C454.765,-224.848 730.082,-204.48 792,-261.428 858.761,-322.829 860.284,-625.574 859.37,-710.337"/>
<polygon fill="#000000" stroke="#000000" points="855.869,-710.349 859.237,-720.394 862.869,-710.441 855.869,-710.349"/>
</g>
<!-- proc~mc_nbi&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge28" class="edge"><title>proc~mc_nbi&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M368.065,-230.378C381.893,-226.58 398.378,-220.13 410,-209.428 437.199,-184.381 419.304,-160.009 446,-134.428 449.082,-131.474 452.645,-128.903 456.414,-126.673"/>
<polygon fill="#000000" stroke="#000000" points="458.134,-129.724 465.456,-122.067 454.957,-123.487 458.134,-129.724"/>
</g>
<!-- proc~grid_intersect -->
<g id="proc~~ndmc~~CallsGraph_node17" class="node"><title>proc~grid_intersect</title>
<g id="a_proc~~ndmc~~CallsGraph_node17"><a xlink:href=".././proc/grid_intersect.html" xlink:title="grid_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="534.5,-209.428 457.5,-209.428 457.5,-185.428 534.5,-185.428 534.5,-209.428"/>
<text text-anchor="middle" x="496" y="-195.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">grid_intersect</text>
</a>
</g>
</g>
<!-- proc~mc_nbi&#45;&gt;proc~grid_intersect -->
<g id="proc~~ndmc~~CallsGraph_edge29" class="edge"><title>proc~mc_nbi&#45;&gt;proc~grid_intersect</title>
<path fill="none" stroke="#000000" d="M368.302,-228.895C390.045,-223.495 421.475,-215.689 447.59,-209.202"/>
<polygon fill="#000000" stroke="#000000" points="448.446,-212.596 457.308,-206.789 446.759,-205.803 448.446,-212.596"/>
</g>
<!-- interface~randn -->
<g id="proc~~ndmc~~CallsGraph_node18" class="node"><title>interface~randn</title>
<g id="a_proc~~ndmc~~CallsGraph_node18"><a xlink:href=".././interface/randn.html" xlink:title="randn">
<polygon fill="#a7506f" stroke="#a7506f" points="523,-167.428 469,-167.428 469,-143.428 523,-143.428 523,-167.428"/>
<text text-anchor="middle" x="496" y="-153.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randn</text>
</a>
</g>
</g>
<!-- proc~mc_nbi&#45;&gt;interface~randn -->
<g id="proc~~ndmc~~CallsGraph_edge30" class="edge"><title>proc~mc_nbi&#45;&gt;interface~randn</title>
<path fill="none" stroke="#000000" d="M368.26,-227.962C381.351,-223.612 397.098,-217.401 410,-209.428 428.463,-198.016 427.767,-188.203 446,-176.428 450.311,-173.643 455.054,-171.08 459.839,-168.772"/>
<polygon fill="#000000" stroke="#000000" points="461.304,-171.951 468.99,-164.659 458.434,-165.566 461.304,-171.951"/>
</g>
<!-- proc~track&#45;&gt;proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_edge33" class="edge"><title>proc~track&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M190.087,-171.459C204.782,-167.636 222.782,-161.136 236,-150.428 259.574,-131.328 247.984,-110.967 272,-92.4275 280.672,-85.7332 291.494,-81.1569 301.936,-78.0345"/>
<polygon fill="#000000" stroke="#000000" points="302.962,-81.384 311.749,-75.4647 301.188,-74.6123 302.962,-81.384"/>
</g>
<!-- proc~track&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge32" class="edge"><title>proc~track&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M190.29,-183.273C237.005,-193.997 336.472,-210.246 410,-176.428 432.336,-166.154 426.186,-148.982 446,-134.428 449.182,-132.09 452.664,-129.949 456.257,-128.003"/>
<polygon fill="#000000" stroke="#000000" points="457.872,-131.11 465.313,-123.568 454.793,-124.823 457.872,-131.11"/>
</g>
<!-- proc~doppler_stark -->
<g id="proc~~ndmc~~CallsGraph_node15" class="node"><title>proc~doppler_stark</title>
<g id="a_proc~~ndmc~~CallsGraph_node15"><a xlink:href=".././proc/doppler_stark.html" xlink:title="doppler_stark">
<polygon fill="#d9534f" stroke="#d9534f" points="380,-167.428 302,-167.428 302,-143.428 380,-143.428 380,-167.428"/>
<text text-anchor="middle" x="341" y="-153.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">doppler_stark</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~doppler_stark -->
<g id="proc~~ndmc~~CallsGraph_edge34" class="edge"><title>proc~track&#45;&gt;proc~doppler_stark</title>
<path fill="none" stroke="#000000" d="M190.349,-173.284C217,-170.104 258.813,-165.115 291.474,-161.218"/>
<polygon fill="#000000" stroke="#000000" points="292.211,-164.655 301.726,-159.994 291.382,-157.704 292.211,-164.655"/>
</g>
<!-- proc~get_indices -->
<g id="proc~~ndmc~~CallsGraph_node20" class="node"><title>proc~get_indices</title>
<g id="a_proc~~ndmc~~CallsGraph_node20"><a xlink:href=".././proc/get_indices.html" xlink:title="get_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="374.5,-125.428 307.5,-125.428 307.5,-101.428 374.5,-101.428 374.5,-125.428"/>
<text text-anchor="middle" x="341" y="-111.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_indices</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~get_indices -->
<g id="proc~~ndmc~~CallsGraph_edge31" class="edge"><title>proc~track&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M190.165,-167.487C203.9,-162.666 220.957,-156.477 236,-150.428 252.245,-143.894 255.606,-140.577 272,-134.428 280.149,-131.371 288.961,-128.406 297.455,-125.715"/>
<polygon fill="#000000" stroke="#000000" points="298.704,-128.992 307.221,-122.691 296.634,-122.305 298.704,-128.992"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_node31" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="791.5,-516.428 712.5,-516.428 712.5,-492.428 791.5,-492.428 791.5,-516.428"/>
<text text-anchor="middle" x="752" y="-502.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge35" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M661.18,-411.521C666.341,-414.115 671.477,-417.094 676,-420.428 700.456,-438.45 722.856,-465.543 736.685,-484.054"/>
<polygon fill="#000000" stroke="#000000" points="733.861,-486.121 742.585,-492.133 739.514,-481.993 733.861,-486.121"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge36" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M663.184,-369.581C667.775,-372.091 672.209,-375.028 676,-378.428 708.937,-407.968 731.72,-455.472 742.955,-482.933"/>
<polygon fill="#000000" stroke="#000000" points="739.764,-484.382 746.693,-492.398 746.275,-481.811 739.764,-484.382"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge37" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M664.021,-327.461C668.39,-329.968 672.538,-332.937 676,-336.428 717.401,-378.177 738.041,-446.749 746.37,-481.983"/>
<polygon fill="#000000" stroke="#000000" points="743.052,-483.182 748.653,-492.176 749.883,-481.652 743.052,-483.182"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge38" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M664.021,-681.394C668.39,-678.887 672.538,-675.918 676,-672.428 717.401,-630.678 738.041,-562.106 746.37,-526.872"/>
<polygon fill="#000000" stroke="#000000" points="749.883,-527.203 748.653,-516.679 743.052,-525.673 749.883,-527.203"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge39" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M526.64,-102.736C533.245,-99.8111 540.049,-96.3488 546,-92.4275 559.529,-83.5122 589.661,-53.7092 609.388,-33.633"/>
<polygon fill="#000000" stroke="#000000" points="611.894,-36.076 616.382,-26.4787 606.889,-31.1824 611.894,-36.076"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~ndmc~~CallsGraph_node32" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~ndmc~~CallsGraph_node32"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="667.5,-136.428 590.5,-136.428 590.5,-112.428 667.5,-112.428 667.5,-136.428"/>
<text text-anchor="middle" x="629" y="-122.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~ndmc~~CallsGraph_edge40" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M526.726,-115.924C542.576,-117.254 562.457,-118.924 580.398,-120.43"/>
<polygon fill="#000000" stroke="#000000" points="580.151,-123.922 590.409,-121.271 580.737,-116.946 580.151,-123.922"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_node38" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~ndmc~~CallsGraph_node38"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="661.5,-94.4275 596.5,-94.4275 596.5,-70.4275 661.5,-70.4275 661.5,-94.4275"/>
<text text-anchor="middle" x="629" y="-80.0275" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge41" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M526.726,-106.393C544.34,-102.225 566.932,-96.8787 586.308,-92.2937"/>
<polygon fill="#000000" stroke="#000000" points="587.178,-95.6845 596.103,-89.9757 585.566,-88.8726 587.178,-95.6845"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge42" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M663.184,-639.274C667.775,-636.764 672.209,-633.827 676,-630.428 708.937,-600.888 731.72,-553.384 742.955,-525.922"/>
<polygon fill="#000000" stroke="#000000" points="746.275,-527.044 746.693,-516.457 739.764,-524.473 746.275,-527.044"/>
</g>
<!-- proc~in_passive_grid -->
<g id="proc~~ndmc~~CallsGraph_node34" class="node"><title>proc~in_passive_grid</title>
<g id="a_proc~~ndmc~~CallsGraph_node34"><a xlink:href=".././proc/in_passive_grid.html" xlink:title="in_passive_grid">
<polygon fill="#d94e8f" stroke="#d94e8f" points="672.5,-188.428 585.5,-188.428 585.5,-164.428 672.5,-164.428 672.5,-188.428"/>
<text text-anchor="middle" x="629" y="-174.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_passive_grid</text>
</a>
</g>
</g>
<!-- proc~grid_intersect&#45;&gt;proc~in_passive_grid -->
<g id="proc~~ndmc~~CallsGraph_edge43" class="edge"><title>proc~grid_intersect&#45;&gt;proc~in_passive_grid</title>
<path fill="none" stroke="#000000" d="M534.539,-191.41C547.192,-189.382 561.557,-187.079 575.165,-184.897"/>
<polygon fill="#000000" stroke="#000000" points="576.062,-188.298 585.382,-183.259 574.954,-181.386 576.062,-188.298"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge44" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M661.18,-597.334C666.341,-594.74 671.477,-591.761 676,-588.428 700.456,-570.405 722.856,-543.312 736.685,-524.801"/>
<polygon fill="#000000" stroke="#000000" points="739.514,-526.862 742.585,-516.722 733.861,-522.734 739.514,-526.862"/>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge45" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M657.419,-555.357C663.578,-552.522 670.05,-549.445 676,-546.428 691.248,-538.694 707.868,-529.471 721.579,-521.641"/>
<polygon fill="#000000" stroke="#000000" points="723.632,-524.498 730.554,-516.477 720.141,-518.43 723.632,-524.498"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge46" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M674.712,-517.668C683.712,-516.106 693.213,-514.457 702.34,-512.873"/>
<polygon fill="#000000" stroke="#000000" points="703.185,-516.278 712.439,-511.12 701.988,-509.381 703.185,-516.278"/>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_edge47" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M350.226,-716.384C375.08,-679.997 449.605,-570.888 480.909,-525.057"/>
<polygon fill="#000000" stroke="#000000" points="483.983,-526.762 486.733,-516.53 478.203,-522.814 483.983,-526.762"/>
</g>
<!-- proc~merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_node33" class="node"><title>proc~merge_reservoirs</title>
<g id="a_proc~~ndmc~~CallsGraph_node33"><a xlink:href=".././proc/merge_reservoirs.html" xlink:title="merge_reservoirs">
<polygon fill="#d9534f" stroke="#d9534f" points="544.5,-864.428 447.5,-864.428 447.5,-840.428 544.5,-840.428 544.5,-864.428"/>
<text text-anchor="middle" x="496" y="-850.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">merge_reservoirs</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_edge48" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M396.654,-740.505C401.483,-742.95 406.035,-745.891 410,-749.428 439.704,-775.92 417.732,-803.407 446,-831.428 447.22,-832.637 448.521,-833.781 449.884,-834.864"/>
<polygon fill="#000000" stroke="#000000" points="447.982,-837.802 458.251,-840.408 451.849,-831.967 447.982,-837.802"/>
</g>
<!-- proc~num_ranks -->
<g id="proc~~ndmc~~CallsGraph_node35" class="node"><title>proc~num_ranks</title>
<g id="a_proc~~ndmc~~CallsGraph_node35"><a xlink:href=".././proc/num_ranks.html" xlink:title="num_ranks">
<polygon fill="#d94e8f" stroke="#d94e8f" points="529,-822.428 463,-822.428 463,-798.428 529,-798.428 529,-822.428"/>
<text text-anchor="middle" x="496" y="-808.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">num_ranks</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~num_ranks -->
<g id="proc~~ndmc~~CallsGraph_edge49" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~num_ranks</title>
<path fill="none" stroke="#000000" d="M392.055,-740.447C398.335,-742.934 404.482,-745.901 410,-749.428 430.152,-762.309 426.554,-775.503 446,-789.428 448.479,-791.202 451.13,-792.868 453.87,-794.423"/>
<polygon fill="#000000" stroke="#000000" points="452.319,-797.562 462.814,-799.014 455.515,-791.334 452.319,-797.562"/>
</g>
<!-- proc~my_rank -->
<g id="proc~~ndmc~~CallsGraph_node36" class="node"><title>proc~my_rank</title>
<g id="a_proc~~ndmc~~CallsGraph_node36"><a xlink:href=".././proc/my_rank.html" xlink:title="my_rank">
<polygon fill="#d94e8f" stroke="#d94e8f" points="523,-780.428 469,-780.428 469,-756.428 523,-756.428 523,-780.428"/>
<text text-anchor="middle" x="496" y="-766.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">my_rank</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~my_rank -->
<g id="proc~~ndmc~~CallsGraph_edge50" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~my_rank</title>
<path fill="none" stroke="#000000" d="M387.905,-740.429C410.598,-746.362 437.592,-753.419 458.801,-758.964"/>
<polygon fill="#000000" stroke="#000000" points="458.144,-762.409 468.704,-761.553 459.914,-755.637 458.144,-762.409"/>
</g>
<!-- proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_node37" class="node"><title>proc~init_reservoir</title>
<g id="a_proc~~ndmc~~CallsGraph_node37"><a xlink:href=".././proc/init_reservoir.html" xlink:title="init_reservoir">
<polygon fill="#d9534f" stroke="#d9534f" points="789,-744.428 715,-744.428 715,-720.428 789,-720.428 789,-744.428"/>
<text text-anchor="middle" x="752" y="-730.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_reservoir</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge51" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M409.538,-729.088C492.904,-729.903 632.471,-731.268 704.641,-731.974"/>
<polygon fill="#000000" stroke="#000000" points="704.752,-735.475 714.785,-732.073 704.82,-728.476 704.752,-735.475"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge52" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M674.712,-491.187C683.712,-492.749 693.213,-494.398 702.34,-495.982"/>
<polygon fill="#000000" stroke="#000000" points="701.988,-499.474 712.439,-497.735 703.185,-492.577 701.988,-499.474"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge53" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M657.419,-453.498C663.578,-456.333 670.05,-459.41 676,-462.428 691.248,-470.161 707.868,-479.384 721.579,-487.215"/>
<polygon fill="#000000" stroke="#000000" points="720.141,-490.425 730.554,-492.378 723.632,-484.357 720.141,-490.425"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge54" class="edge"><title>proc~merge_reservoirs&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M544.623,-861.598C606.206,-870.863 714.714,-878.162 792,-833.428 822.436,-815.811 841.687,-778.15 851.386,-754.125"/>
<polygon fill="#000000" stroke="#000000" points="854.664,-755.352 854.963,-744.761 848.125,-752.854 854.664,-755.352"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge57" class="edge"><title>proc~merge_reservoirs&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M530.767,-840.331C536.086,-837.766 541.355,-834.797 546,-831.428 565.629,-817.189 561.856,-803.928 582,-790.428 619.525,-765.279 669.045,-749.974 704.77,-741.451"/>
<polygon fill="#000000" stroke="#000000" points="705.957,-744.77 714.921,-739.122 704.392,-737.947 705.957,-744.77"/>
</g>
<!-- proc~update_reservoir -->
<g id="proc~~ndmc~~CallsGraph_node40" class="node"><title>proc~update_reservoir</title>
<g id="a_proc~~ndmc~~CallsGraph_node40"><a xlink:href=".././proc/update_reservoir.html" xlink:title="update_reservoir">
<polygon fill="#d9534f" stroke="#d9534f" points="676,-823.428 582,-823.428 582,-799.428 676,-799.428 676,-823.428"/>
<text text-anchor="middle" x="629" y="-809.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_reservoir</text>
</a>
</g>
</g>
<!-- proc~merge_reservoirs&#45;&gt;proc~update_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge55" class="edge"><title>proc~merge_reservoirs&#45;&gt;proc~update_reservoir</title>
<path fill="none" stroke="#000000" d="M535.596,-840.348C549.332,-836.049 564.978,-831.152 579.441,-826.625"/>
<polygon fill="#000000" stroke="#000000" points="580.729,-829.89 589.227,-823.562 578.638,-823.209 580.729,-829.89"/>
</g>
<!-- float -->
<g id="proc~~ndmc~~CallsGraph_node41" class="node"><title>float</title>
<polygon fill="#777777" stroke="#777777" points="656,-904.428 602,-904.428 602,-880.428 656,-880.428 656,-904.428"/>
<text text-anchor="middle" x="629" y="-890.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">float</text>
</g>
<!-- proc~merge_reservoirs&#45;&gt;float -->
<g id="proc~~ndmc~~CallsGraph_edge56" class="edge"><title>proc~merge_reservoirs&#45;&gt;float</title>
<path fill="none" stroke="#000000" d="M536.304,-864.429C554.07,-869.854 574.915,-876.218 592.237,-881.508"/>
<polygon fill="#000000" stroke="#000000" points="591.393,-884.909 601.979,-884.482 593.437,-878.214 591.393,-884.909"/>
</g>
<!-- proc~approx_ge -->
<g id="proc~~ndmc~~CallsGraph_node39" class="node"><title>proc~approx_ge</title>
<g id="a_proc~~ndmc~~CallsGraph_node39"><a xlink:href=".././proc/approx_ge.html" xlink:title="approx_ge">
<polygon fill="#d94e8f" stroke="#d94e8f" points="784,-167.428 720,-167.428 720,-143.428 784,-143.428 784,-167.428"/>
<text text-anchor="middle" x="752" y="-153.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_ge</text>
</a>
</g>
</g>
<!-- proc~in_passive_grid&#45;&gt;proc~approx_ge -->
<g id="proc~~ndmc~~CallsGraph_edge59" class="edge"><title>proc~in_passive_grid&#45;&gt;proc~approx_ge</title>
<path fill="none" stroke="#000000" d="M672.66,-169.024C684.659,-166.941 697.685,-164.681 709.608,-162.611"/>
<polygon fill="#000000" stroke="#000000" points="710.494,-166.01 719.749,-160.851 709.297,-159.113 710.494,-166.01"/>
</g>
<!-- proc~approx_le -->
<g id="proc~~ndmc~~CallsGraph_node42" class="node"><title>proc~approx_le</title>
<g id="a_proc~~ndmc~~CallsGraph_node42"><a xlink:href=".././proc/approx_le.html" xlink:title="approx_le">
<polygon fill="#d94e8f" stroke="#d94e8f" points="782,-125.428 722,-125.428 722,-101.428 782,-101.428 782,-125.428"/>
<text text-anchor="middle" x="752" y="-111.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_le</text>
</a>
</g>
</g>
<!-- proc~in_passive_grid&#45;&gt;proc~approx_le -->
<g id="proc~~ndmc~~CallsGraph_edge58" class="edge"><title>proc~in_passive_grid&#45;&gt;proc~approx_le</title>
<path fill="none" stroke="#000000" d="M653.33,-164.28C671.911,-154.606 698.128,-140.956 718.723,-130.233"/>
<polygon fill="#000000" stroke="#000000" points="720.488,-133.26 727.742,-125.537 717.255,-127.051 720.488,-133.26"/>
</g>
<!-- proc~uvw_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_node43" class="node"><title>proc~uvw_to_cyl</title>
<g id="a_proc~~ndmc~~CallsGraph_node43"><a xlink:href=".././proc/uvw_to_cyl.html" xlink:title="uvw_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="784.5,-209.428 719.5,-209.428 719.5,-185.428 784.5,-185.428 784.5,-209.428"/>
<text text-anchor="middle" x="752" y="-195.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_cyl</text>
</a>
</g>
</g>
<!-- proc~in_passive_grid&#45;&gt;proc~uvw_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_edge60" class="edge"><title>proc~in_passive_grid&#45;&gt;proc~uvw_to_cyl</title>
<path fill="none" stroke="#000000" d="M672.66,-183.831C684.553,-185.895 697.457,-188.135 709.294,-190.189"/>
<polygon fill="#000000" stroke="#000000" points="708.919,-193.676 719.37,-191.938 710.116,-186.78 708.919,-193.676"/>
</g>
<!-- proc~init_reservoir&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge61" class="edge"><title>proc~init_reservoir&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M789.183,-732.428C799.888,-732.428 811.615,-732.428 822.35,-732.428"/>
<polygon fill="#000000" stroke="#000000" points="822.68,-735.928 832.68,-732.428 822.68,-728.928 822.68,-735.928"/>
</g>
<!-- proc~approx_eq -->
<g id="proc~~ndmc~~CallsGraph_node44" class="node"><title>proc~approx_eq</title>
<g id="a_proc~~ndmc~~CallsGraph_node44"><a xlink:href=".././proc/approx_eq.html" xlink:title="approx_eq">
<polygon fill="#d94e8f" stroke="#d94e8f" points="892,-146.428 828,-146.428 828,-122.428 892,-122.428 892,-146.428"/>
<text text-anchor="middle" x="860" y="-132.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_eq</text>
</a>
</g>
</g>
<!-- proc~approx_ge&#45;&gt;proc~approx_eq -->
<g id="proc~~ndmc~~CallsGraph_edge62" class="edge"><title>proc~approx_ge&#45;&gt;proc~approx_eq</title>
<path fill="none" stroke="#000000" d="M784.23,-149.24C794.797,-147.147 806.761,-144.777 817.972,-142.556"/>
<polygon fill="#000000" stroke="#000000" points="818.864,-145.947 827.993,-140.57 817.503,-139.081 818.864,-145.947"/>
</g>
<!-- proc~update_reservoir&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge63" class="edge"><title>proc~update_reservoir&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M665.279,-799.257C708.229,-784.44 780.348,-759.561 823.429,-744.699"/>
<polygon fill="#000000" stroke="#000000" points="824.629,-747.987 832.941,-741.417 822.346,-741.37 824.629,-747.987"/>
</g>
<!-- proc~update_reservoir&#45;&gt;proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge65" class="edge"><title>proc~update_reservoir&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M652.807,-799.301C660.317,-795.107 668.629,-790.246 676,-785.428 692.74,-774.484 695.673,-769.979 712,-758.428 715.764,-755.765 719.772,-753.007 723.731,-750.327"/>
<polygon fill="#000000" stroke="#000000" points="725.847,-753.122 732.21,-744.651 721.953,-747.306 725.847,-753.122"/>
</g>
<!-- interface~randind -->
<g id="proc~~ndmc~~CallsGraph_node45" class="node"><title>interface~randind</title>
<g id="a_proc~~ndmc~~CallsGraph_node45"><a xlink:href=".././interface/randind.html" xlink:title="randind">
<polygon fill="#a7506f" stroke="#a7506f" points="779,-824.428 725,-824.428 725,-800.428 779,-800.428 779,-824.428"/>
<text text-anchor="middle" x="752" y="-810.028" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind</text>
</a>
</g>
</g>
<!-- proc~update_reservoir&#45;&gt;interface~randind -->
<g id="proc~~ndmc~~CallsGraph_edge64" class="edge"><title>proc~update_reservoir&#45;&gt;interface~randind</title>
<path fill="none" stroke="#000000" d="M676.09,-811.808C688.797,-811.913 702.405,-812.026 714.489,-812.126"/>
<polygon fill="#000000" stroke="#000000" points="714.626,-815.627 724.655,-812.21 714.684,-808.627 714.626,-815.627"/>
</g>
<!-- proc~approx_le&#45;&gt;proc~approx_eq -->
<g id="proc~~ndmc~~CallsGraph_edge66" class="edge"><title>proc~approx_le&#45;&gt;proc~approx_eq</title>
<path fill="none" stroke="#000000" d="M782.246,-119.221C793.241,-121.4 805.957,-123.919 817.837,-126.273"/>
<polygon fill="#000000" stroke="#000000" points="817.508,-129.775 827.997,-128.286 818.868,-122.909 817.508,-129.775"/>
</g>
</g>
</svg>
</div><script>var panprocndmcCallsGraph = svgPanZoom('#procndmcCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~ndmc~~CalledByGraph Pages: 1 -->
<svg id="procndmcCalledByGraph" width="152pt" height="32pt"
 viewBox="0.00 0.00 152.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~ndmc~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~ndmc~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 148,-28 148,4 -4,4"/>
<!-- proc~ndmc -->
<g id="proc~~ndmc~~CalledByGraph_node1" class="node"><title>proc~ndmc</title>
<polygon fill="none" stroke="black" points="144,-24 90,-24 90,-0 144,-0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">ndmc</text>
</g>
<!-- program~fidasim -->
<g id="proc~~ndmc~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~ndmc~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~ndmc -->
<g id="proc~~ndmc~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~ndmc</title>
<path fill="none" stroke="#000000" d="M54.4029,-12C62.3932,-12 71.3106,-12 79.8241,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.919,-15.5001 89.919,-12 79.919,-8.5001 79.919,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/ndmc.html#src">ndmc</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">ndmc</span>
    <span class="c">!+ Calculates neutral beam deposition and spectra</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">neut_type</span> <span class="c">!! full half third energy</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">nlaunch</span>   <span class="c">!! nr. of markers</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">nneutrals</span> <span class="c">!! # NBI particles</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vnbi</span> <span class="c">!! velocities(full..)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rnbi</span> <span class="c">!! initial position</span>

    <span class="kt">integer</span><span class="p">(</span><span class="n">Int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">jj</span><span class="p">,</span> <span class="n">ii</span><span class="p">,</span> <span class="n">kk</span><span class="p">,</span> <span class="n">cnt</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ntrack</span><span class="p">,</span> <span class="n">ic</span>
    <span class="k">type</span><span class="p">(</span><span class="n">ParticleTrack</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ntrack</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tracks</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span> <span class="kd">::</span> <span class="n">plasma</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fields</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">states</span><span class="p">,</span> <span class="n">dens</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">photons</span><span class="p">,</span> <span class="n">iflux</span><span class="p">,</span><span class="n">flux_tot</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ind</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ri</span><span class="p">,</span><span class="n">ri_gc</span><span class="p">,</span><span class="n">r_gyro</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">randomu</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">randi</span>
    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">err</span>

    <span class="c">!! Initialize Neutral Population</span>
    <span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">)</span>
    <span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">half</span><span class="p">)</span>
    <span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">third</span><span class="p">)</span>

    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i10)&#39;</span><span class="p">)</span> <span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span>
        <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of birth markers: 3 x&quot;,i10)&#39;</span><span class="p">)</span> <span class="nb">int</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="o">*</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_birth</span><span class="p">)</span>
        <span class="n">endif</span>
    <span class="n">endif</span>

    <span class="c">!! # of injected neutrals = NBI power/energy_per_particle</span>
    <span class="n">nneutrals</span><span class="o">=</span><span class="mf">1.d6</span><span class="o">*</span><span class="n">nbi</span><span class="p">%</span><span class="n">pinj</span><span class="o">/</span> <span class="p">(</span><span class="mf">1.d3</span><span class="o">*</span><span class="n">nbi</span><span class="p">%</span><span class="n">einj</span><span class="o">*</span><span class="n">e0</span> <span class="p">&amp;</span>
         <span class="o">*</span><span class="p">(</span> <span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>      <span class="p">&amp;</span>
         <span class="o">+</span>  <span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.d0</span> <span class="p">&amp;</span>
         <span class="o">+</span>  <span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mf">3.d0</span> <span class="p">)</span> <span class="p">)</span>

    <span class="n">nlaunch</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="p">)</span>
    <span class="c">!$OMP PARALLEL DO schedule(guided) &amp;</span>
    <span class="c">!$OMP&amp; private(vnbi,rnbi,tracks,ntrack,plasma,fields,randi,flux_tot, &amp;</span>
    <span class="c">!$OMP&amp; states,dens,iflux,photons,neut_type,jj,ii,kk,ind,err,ri,ri_gc,r_gyro)</span>
    <span class="n">loop_over_markers</span><span class="p">:</span> <span class="k">do </span><span class="n">ii</span><span class="o">=</span><span class="n">istart</span><span class="p">,</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="p">,</span><span class="n">istep</span>
        <span class="n">energy_fractions</span><span class="p">:</span> <span class="k">do </span><span class="n">neut_type</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
            <span class="c">!! (type = 1: full energy, =2: half energy, =3: third energy</span>
            <span class="k">if</span><span class="p">(</span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="n">neut_type</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">energy_fractions</span>

            <span class="k">call </span><span class="n">mc_nbi</span><span class="p">(</span><span class="n">vnbi</span><span class="p">,</span><span class="n">neut_type</span><span class="p">,</span><span class="n">rnbi</span><span class="p">,</span><span class="n">err</span><span class="p">)</span>
            <span class="k">if</span><span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="k">cycle </span><span class="n">energy_fractions</span>

            <span class="k">call </span><span class="n">track</span><span class="p">(</span><span class="n">rnbi</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">tracks</span><span class="p">,</span><span class="n">ntrack</span><span class="p">)</span>
            <span class="k">if</span><span class="p">(</span><span class="n">ntrack</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">energy_fractions</span>

            <span class="c">!! Solve collisional radiative model along track</span>
            <span class="n">flux_tot</span> <span class="o">=</span> <span class="mf">0.d0</span>
            <span class="n">states</span><span class="o">=</span><span class="mf">0.d0</span>
            <span class="n">states</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">nneutrals</span><span class="o">*</span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="n">neut_type</span><span class="p">)</span><span class="o">/</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span>
            <span class="n">loop_along_track</span><span class="p">:</span> <span class="k">do </span><span class="n">jj</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ntrack</span>
                <span class="n">iflux</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">)</span>
                <span class="n">ind</span> <span class="o">=</span> <span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">ind</span>
                <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">)</span>

                <span class="k">call </span><span class="n">colrad</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">beam_mass</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="nb">time</span><span class="p">,</span><span class="n">states</span><span class="p">,</span><span class="n">dens</span><span class="p">,</span><span class="n">photons</span><span class="p">)</span>
                <span class="n">dens</span> <span class="o">=</span> <span class="n">dens</span><span class="o">/</span><span class="n">nlaunch</span>
                <span class="k">call </span><span class="n">store_neutrals</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">neut_type</span><span class="p">,</span><span class="n">dens</span><span class="p">)</span>
                <span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">flux</span> <span class="o">=</span> <span class="p">(</span><span class="n">iflux</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">))</span><span class="o">/</span><span class="n">nlaunch</span>
                <span class="n">flux_tot</span> <span class="o">=</span> <span class="n">flux_tot</span> <span class="o">+</span> <span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">flux</span><span class="o">*</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span>

                <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                    call </span><span class="n">store_births</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">neut_type</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">flux</span><span class="p">)</span>
                <span class="n">endif</span>

                <span class="k">if</span><span class="p">((</span><span class="n">photons</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_bes</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                    call </span><span class="n">store_nbi_photons</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">beam_lambda0</span><span class="p">,</span> <span class="n">photons</span><span class="o">/</span><span class="n">nlaunch</span><span class="p">,</span><span class="n">neut_type</span><span class="p">)</span>
                <span class="n">endif</span>
            <span class="n">enddo</span> <span class="n">loop_along_track</span>
            <span class="k">if</span><span class="p">((</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">flux_tot</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">))</span> <span class="k">then</span>
                <span class="c">!! Sample according to deposited flux along neutral trajectory</span>
                <span class="c">!$OMP CRITICAL(ndmc_birth)</span>
                <span class="k">do </span><span class="n">kk</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_birth</span>
                    <span class="k">call </span><span class="n">randind</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ntrack</span><span class="p">)%</span><span class="n">flux</span><span class="p">,</span><span class="n">randi</span><span class="p">)</span>
                    <span class="k">call </span><span class="n">randu</span><span class="p">(</span><span class="n">randomu</span><span class="p">)</span>
                    <span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">neut_type</span> <span class="o">=</span> <span class="n">neut_type</span>
                    <span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">energy</span> <span class="o">=</span> <span class="n">nbi</span><span class="p">%</span><span class="n">einj</span><span class="o">/</span><span class="kt">real</span><span class="p">(</span><span class="n">neut_type</span><span class="p">)</span>
                    <span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">weight</span> <span class="o">=</span> <span class="n">flux_tot</span><span class="o">/</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_birth</span>
                    <span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">ind</span> <span class="o">=</span> <span class="n">tracks</span><span class="p">(</span><span class="n">randi</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">ind</span>
                    <span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">vi</span> <span class="o">=</span> <span class="n">vnbi</span>
                    <span class="n">ri</span> <span class="o">=</span> <span class="n">tracks</span><span class="p">(</span><span class="n">randi</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">pos</span> <span class="o">+</span> <span class="n">vnbi</span><span class="o">*</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="n">randi</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="nb">time</span><span class="o">*</span><span class="p">(</span><span class="n">randomu</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
                    <span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">ri</span> <span class="o">=</span> <span class="n">ri</span>

                    <span class="k">call </span><span class="n">get_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">)</span>
                    <span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">pitch</span> <span class="o">=</span> <span class="nb">dot_product</span><span class="p">(</span><span class="n">fields</span><span class="p">%</span><span class="n">b_norm</span><span class="p">,</span><span class="n">vnbi</span><span class="o">/</span><span class="nb">norm2</span><span class="p">(</span><span class="n">vnbi</span><span class="p">))</span>
                    <span class="k">call </span><span class="n">gyro_step</span><span class="p">(</span><span class="n">vnbi</span><span class="p">,</span><span class="n">fields</span><span class="p">,</span><span class="n">beam_mass</span><span class="p">,</span><span class="n">r_gyro</span><span class="p">)</span>
                    <span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">ri_gc</span> <span class="o">=</span> <span class="n">ri</span> <span class="o">+</span> <span class="n">r_gyro</span>
                    <span class="n">birth</span><span class="p">%</span><span class="n">cnt</span> <span class="o">=</span> <span class="n">birth</span><span class="p">%</span><span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">enddo</span>
                <span class="c">!$OMP END CRITICAL(ndmc_birth)</span>
            <span class="n">endif</span>
        <span class="n">enddo</span> <span class="n">energy_fractions</span>
    <span class="n">enddo</span> <span class="n">loop_over_markers</span>
    <span class="c">!$OMP END PARALLEL DO</span>

<span class="cp">#ifdef _MPI</span>
    <span class="c">!! Combine beam neutrals</span>
    <span class="k">call </span><span class="n">parallel_merge_populations</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">)</span>
    <span class="k">call </span><span class="n">parallel_merge_populations</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">half</span><span class="p">)</span>
    <span class="k">call </span><span class="n">parallel_merge_populations</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">third</span><span class="p">)</span>

    <span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">nbi_outside</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">dens</span><span class="p">)</span>
    <span class="n">endif</span>
    <span class="c">!! Combine spectra</span>
    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_bes</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">full</span><span class="p">)</span>
        <span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">half</span><span class="p">)</span>
        <span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">third</span><span class="p">)</span>
    <span class="n">endif</span>
<span class="cp">#endif</span>

    <span class="k">if</span><span class="p">(</span><span class="n">nbi_outside</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="k">        if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T4,a, f6.2,a)&#39;</span><span class="p">)</span> <span class="s1">&#39;Percent of markers outside the grid: &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
                                  <span class="mi">10</span><span class="mf">0.</span><span class="o">*</span><span class="n">nbi_outside</span><span class="o">/</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="p">),</span><span class="s1">&#39;%&#39;</span>
        <span class="n">endif</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">%</span><span class="n">dens</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span> <span class="s1">&#39;Beam does not intersect the grid!&#39;</span>
    <span class="n">endif</span>

<span class="k">end subroutine </span><span class="n">ndmc</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> FIDASIM was developed by Luke Stagner</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>