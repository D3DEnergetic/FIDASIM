<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="">
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>ndmc &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>User Guide</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>ndmc
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.7% of total for procedures.">94 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
     <li><a href='../module/libfida.html'>libfida</a></li>
     <li class="active">ndmc</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/ndmc.html#src">ndmc</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public subroutine ndmc()</h2>
    

    <p>Calculates neutral beam deposition and spectra</p>

    <h3>Arguments</h3>
    <em>None</em>
    <br>
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~ndmc~~CallsGraph Pages: 1 -->
<svg id="procndmcCallsGraph" width="641pt" height="1067pt"
 viewBox="0.00 0.00 641.00 1067.21" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~ndmc~~CallsGraph" class="graph" transform="scale(0.66219 0.66219) rotate(0) translate(4 1607.64)">
<title>proc~~ndmc~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1607.64 964,-1607.64 964,4 -4,4"/>
<!-- proc~ndmc -->
<g id="proc~~ndmc~~CallsGraph_node1" class="node"><title>proc~ndmc</title>
<polygon fill="none" stroke="black" points="54,-1105.64 0,-1105.64 0,-1081.64 54,-1081.64 54,-1105.64"/>
<text text-anchor="middle" x="27" y="-1091.24" font-family="Helvetica,sans-Serif" font-size="10.50">ndmc</text>
</g>
<!-- proc~init_neutral_population -->
<g id="proc~~ndmc~~CallsGraph_node2" class="node"><title>proc~init_neutral_population</title>
<g id="a_proc~~ndmc~~CallsGraph_node2"><a xlink:href=".././proc/init_neutral_population.html" xlink:title="init_neutral_population">
<polygon fill="#d9534f" stroke="#d9534f" points="223.5,-1367.64 102.5,-1367.64 102.5,-1343.64 223.5,-1343.64 223.5,-1367.64"/>
<text text-anchor="middle" x="163" y="-1353.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_neutral_population</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~init_neutral_population -->
<g id="proc~~ndmc~~CallsGraph_edge14" class="edge"><title>proc~ndmc&#45;&gt;proc~init_neutral_population</title>
<path fill="none" stroke="#000000" d="M27.5071,-1105.74C26.6266,-1143.89 29.1187,-1263.05 90,-1329.64 93.1104,-1333.05 96.6999,-1336 100.581,-1338.57"/>
<polygon fill="#000000" stroke="#000000" points="99.0461,-1341.73 109.473,-1343.61 102.495,-1335.64 99.0461,-1341.73"/>
</g>
<!-- proc~mc_nbi -->
<g id="proc~~ndmc~~CallsGraph_node3" class="node"><title>proc~mc_nbi</title>
<g id="a_proc~~ndmc~~CallsGraph_node3"><a xlink:href=".././proc/mc_nbi.html" xlink:title="mc_nbi">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-1479.64 314,-1479.64 314,-1455.64 368,-1455.64 368,-1479.64"/>
<text text-anchor="middle" x="341" y="-1465.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_nbi</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~mc_nbi -->
<g id="proc~~ndmc~~CallsGraph_edge2" class="edge"><title>proc~ndmc&#45;&gt;proc~mc_nbi</title>
<path fill="none" stroke="#000000" d="M27.8762,-1105.76C28.2079,-1140.79 34.1488,-1243.08 90,-1296.64 138.392,-1343.05 179.947,-1297.85 236,-1334.64 279.81,-1363.4 313.153,-1416.86 329.281,-1446.49"/>
<polygon fill="#000000" stroke="#000000" points="326.308,-1448.36 334.081,-1455.56 332.495,-1445.08 326.308,-1448.36"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~ndmc~~CallsGraph_node4" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~ndmc~~CallsGraph_node4"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="547,-1115.64 479,-1115.64 479,-1091.64 547,-1091.64 547,-1115.64"/>
<text text-anchor="middle" x="513" y="-1101.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~get_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge3" class="edge"><title>proc~ndmc&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M54.0219,-1094.18C132.927,-1095.81 370.1,-1100.71 468.491,-1102.74"/>
<polygon fill="#000000" stroke="#000000" points="468.609,-1106.25 478.679,-1102.96 468.754,-1099.25 468.609,-1106.25"/>
</g>
<!-- proc~store_births -->
<g id="proc~~ndmc~~CallsGraph_node5" class="node"><title>proc~store_births</title>
<g id="a_proc~~ndmc~~CallsGraph_node5"><a xlink:href=".././proc/store_births.html" xlink:title="store_births">
<polygon fill="#d9534f" stroke="#d9534f" points="197.5,-1245.64 128.5,-1245.64 128.5,-1221.64 197.5,-1221.64 197.5,-1245.64"/>
<text text-anchor="middle" x="163" y="-1231.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_births</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~store_births -->
<g id="proc~~ndmc~~CallsGraph_edge4" class="edge"><title>proc~ndmc&#45;&gt;proc~store_births</title>
<path fill="none" stroke="#000000" d="M31.4234,-1105.81C38.5255,-1128.91 57.0141,-1179.31 90,-1207.64 98.1751,-1214.66 108.395,-1219.85 118.544,-1223.65"/>
<polygon fill="#000000" stroke="#000000" points="117.59,-1227.02 128.184,-1226.89 119.819,-1220.39 117.59,-1227.02"/>
</g>
<!-- proc~store_neutrals -->
<g id="proc~~ndmc~~CallsGraph_node6" class="node"><title>proc~store_neutrals</title>
<g id="a_proc~~ndmc~~CallsGraph_node6"><a xlink:href=".././proc/store_neutrals.html" xlink:title="store_neutrals">
<polygon fill="#d9534f" stroke="#d9534f" points="203.5,-593.643 122.5,-593.643 122.5,-569.643 203.5,-569.643 203.5,-593.643"/>
<text text-anchor="middle" x="163" y="-579.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_neutrals</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~store_neutrals -->
<g id="proc~~ndmc~~CallsGraph_edge5" class="edge"><title>proc~ndmc&#45;&gt;proc~store_neutrals</title>
<path fill="none" stroke="#000000" d="M27.8934,-1081.55C27.5351,-1014 28.9633,-683.809 90,-607.643 95.8591,-600.332 103.952,-595.076 112.603,-591.297"/>
<polygon fill="#000000" stroke="#000000" points="113.981,-594.519 122.131,-587.75 111.538,-587.959 113.981,-594.519"/>
</g>
<!-- proc~store_nbi_photons -->
<g id="proc~~ndmc~~CallsGraph_node7" class="node"><title>proc~store_nbi_photons</title>
<g id="a_proc~~ndmc~~CallsGraph_node7"><a xlink:href=".././proc/store_nbi_photons.html" xlink:title="store_nbi_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="213.5,-1287.64 112.5,-1287.64 112.5,-1263.64 213.5,-1263.64 213.5,-1287.64"/>
<text text-anchor="middle" x="163" y="-1273.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_nbi_photons</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~store_nbi_photons -->
<g id="proc~~ndmc~~CallsGraph_edge6" class="edge"><title>proc~ndmc&#45;&gt;proc~store_nbi_photons</title>
<path fill="none" stroke="#000000" d="M29.0677,-1105.75C32.3571,-1135.6 45.022,-1213.28 90,-1254.64 93.8548,-1258.19 98.2755,-1261.14 102.989,-1263.59"/>
<polygon fill="#000000" stroke="#000000" points="101.782,-1266.88 112.343,-1267.72 104.611,-1260.48 101.782,-1266.88"/>
</g>
<!-- interface~randind -->
<g id="proc~~ndmc~~CallsGraph_node8" class="node"><title>interface~randind</title>
<g id="a_proc~~ndmc~~CallsGraph_node8"><a xlink:href=".././interface/randind.html" xlink:title="randind">
<polygon fill="#a7506f" stroke="#a7506f" points="825,-631.643 771,-631.643 771,-607.643 825,-607.643 825,-631.643"/>
<text text-anchor="middle" x="798" y="-617.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;interface~randind -->
<g id="proc~~ndmc~~CallsGraph_edge7" class="edge"><title>proc~ndmc&#45;&gt;interface~randind</title>
<path fill="none" stroke="#000000" d="M29.7776,-1081.5C41.3353,-1007.62 112.6,-621.643 340,-621.643 340,-621.643 340,-621.643 514,-621.643 602.67,-621.643 706.964,-620.65 760.787,-620.063"/>
<polygon fill="#000000" stroke="#000000" points="760.899,-623.562 770.859,-619.952 760.821,-616.563 760.899,-623.562"/>
</g>
<!-- proc~gyro_step -->
<g id="proc~~ndmc~~CallsGraph_node9" class="node"><title>proc~gyro_step</title>
<g id="a_proc~~ndmc~~CallsGraph_node9"><a xlink:href=".././proc/gyro_step.html" xlink:title="gyro_step">
<polygon fill="#d9534f" stroke="#d9534f" points="193,-1085.64 133,-1085.64 133,-1061.64 193,-1061.64 193,-1085.64"/>
<text text-anchor="middle" x="163" y="-1071.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_step</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~gyro_step -->
<g id="proc~~ndmc~~CallsGraph_edge8" class="edge"><title>proc~ndmc&#45;&gt;proc~gyro_step</title>
<path fill="none" stroke="#000000" d="M54.1547,-1089.74C73.6172,-1086.83 100.516,-1082.82 122.58,-1079.53"/>
<polygon fill="#000000" stroke="#000000" points="123.276,-1082.96 132.65,-1078.02 122.243,-1076.04 123.276,-1082.96"/>
</g>
<!-- proc~track -->
<g id="proc~~ndmc~~CallsGraph_node10" class="node"><title>proc~track</title>
<g id="a_proc~~ndmc~~CallsGraph_node10"><a xlink:href=".././proc/track.html" xlink:title="track">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-1165.64 314,-1165.64 314,-1141.64 368,-1141.64 368,-1165.64"/>
<text text-anchor="middle" x="341" y="-1151.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~track -->
<g id="proc~~ndmc~~CallsGraph_edge9" class="edge"><title>proc~ndmc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M45.5922,-1105.77C57.5611,-1113.38 74.0631,-1122.67 90,-1127.64 163.344,-1150.54 254.066,-1154.24 303.562,-1154.32"/>
<polygon fill="#000000" stroke="#000000" points="303.781,-1157.82 313.768,-1154.28 303.756,-1150.82 303.781,-1157.82"/>
</g>
<!-- proc~colrad -->
<g id="proc~~ndmc~~CallsGraph_node11" class="node"><title>proc~colrad</title>
<g id="a_proc~~ndmc~~CallsGraph_node11"><a xlink:href=".././proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="190,-955.643 136,-955.643 136,-931.643 190,-931.643 190,-955.643"/>
<text text-anchor="middle" x="163" y="-941.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~colrad -->
<g id="proc~~ndmc~~CallsGraph_edge10" class="edge"><title>proc~ndmc&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M37.872,-1081.4C49.9232,-1066.57 71.044,-1040.92 90,-1019.64 107.505,-1000 128.236,-978.269 142.947,-963.094"/>
<polygon fill="#000000" stroke="#000000" points="145.577,-965.41 150.042,-955.802 140.56,-960.528 145.577,-965.41"/>
</g>
<!-- interface~randu -->
<g id="proc~~ndmc~~CallsGraph_node12" class="node"><title>interface~randu</title>
<g id="a_proc~~ndmc~~CallsGraph_node12"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="947,-590.643 893,-590.643 893,-566.643 947,-566.643 947,-590.643"/>
<text text-anchor="middle" x="920" y="-576.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge11" class="edge"><title>proc~ndmc&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M41.6678,-1081.6C53.5494,-1071.92 71.688,-1058.92 90,-1052.64 195.417,-1016.53 228.568,-1033.64 340,-1033.64 340,-1033.64 340,-1033.64 667,-1033.64 867.24,-1033.64 909.661,-692.244 917.428,-600.896"/>
<polygon fill="#000000" stroke="#000000" points="920.926,-601.059 918.227,-590.814 913.947,-600.505 920.926,-601.059"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_node13" class="node"><title>proc~get_fields</title>
<g id="a_proc~~ndmc~~CallsGraph_node13"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="542,-1279.64 484,-1279.64 484,-1255.64 542,-1255.64 542,-1279.64"/>
<text text-anchor="middle" x="513" y="-1265.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_edge12" class="edge"><title>proc~ndmc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M37.5835,-1106.12C48.7276,-1119.78 68.3776,-1141.37 90,-1153.64 157.039,-1191.71 383.467,-1241.16 474.067,-1259.95"/>
<polygon fill="#000000" stroke="#000000" points="473.419,-1263.39 483.92,-1261.98 474.834,-1256.53 473.419,-1263.39"/>
</g>
<!-- proc~parallel_merge_populations -->
<g id="proc~~ndmc~~CallsGraph_node14" class="node"><title>proc~parallel_merge_populations</title>
<g id="a_proc~~ndmc~~CallsGraph_node14"><a xlink:href=".././proc/parallel_merge_populations.html" xlink:title="parallel_merge_populations">
<polygon fill="#d9534f" stroke="#d9534f" points="235.5,-452.643 90.5,-452.643 90.5,-428.643 235.5,-428.643 235.5,-452.643"/>
<text text-anchor="middle" x="163" y="-438.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_merge_populations</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~parallel_merge_populations -->
<g id="proc~~ndmc~~CallsGraph_edge13" class="edge"><title>proc~ndmc&#45;&gt;proc~parallel_merge_populations</title>
<path fill="none" stroke="#000000" d="M28.7203,-1081.4C32.9415,-1011.48 55.476,-662.061 90,-560.643 102.925,-522.674 129.122,-483.773 146.098,-460.931"/>
<polygon fill="#000000" stroke="#000000" points="149.068,-462.807 152.319,-452.724 143.489,-458.579 149.068,-462.807"/>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_node15" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~ndmc~~CallsGraph_node15"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="549.5,-273.643 476.5,-273.643 476.5,-249.643 549.5,-249.643 549.5,-273.643"/>
<text text-anchor="middle" x="513" y="-259.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_edge1" class="edge"><title>proc~ndmc&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M28.4624,-1081.41C31.816,-994.981 53.3221,-477.957 90,-419.643 171.515,-290.045 375.028,-266.257 466.367,-262.241"/>
<polygon fill="#000000" stroke="#000000" points="466.555,-265.737 476.415,-261.86 466.289,-258.742 466.555,-265.737"/>
</g>
<!-- proc~mc_nbi&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge15" class="edge"><title>proc~mc_nbi&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M368.146,-1469.89C432.237,-1474.15 600.356,-1477.66 716,-1410.64 788.098,-1368.86 809.302,-1349.41 844,-1273.64 900.924,-1149.35 915.742,-705.563 918.479,-600.881"/>
<polygon fill="#000000" stroke="#000000" points="921.979,-600.905 918.731,-590.821 914.981,-600.73 921.979,-600.905"/>
</g>
<!-- interface~randn -->
<g id="proc~~ndmc~~CallsGraph_node30" class="node"><title>interface~randn</title>
<g id="a_proc~~ndmc~~CallsGraph_node30"><a xlink:href=".././interface/randn.html" xlink:title="randn">
<polygon fill="#a7506f" stroke="#a7506f" points="540,-1519.64 486,-1519.64 486,-1495.64 540,-1495.64 540,-1519.64"/>
<text text-anchor="middle" x="513" y="-1505.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randn</text>
</a>
</g>
</g>
<!-- proc~mc_nbi&#45;&gt;interface~randn -->
<g id="proc~~ndmc~~CallsGraph_edge16" class="edge"><title>proc~mc_nbi&#45;&gt;interface~randn</title>
<path fill="none" stroke="#000000" d="M368.19,-1473.81C397.016,-1480.59 443.543,-1491.54 475.836,-1499.13"/>
<polygon fill="#000000" stroke="#000000" points="475.244,-1502.59 485.78,-1501.47 476.848,-1495.78 475.244,-1502.59"/>
</g>
<!-- proc~grid_intersect -->
<g id="proc~~ndmc~~CallsGraph_node31" class="node"><title>proc~grid_intersect</title>
<g id="a_proc~~ndmc~~CallsGraph_node31"><a xlink:href=".././proc/grid_intersect.html" xlink:title="grid_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="551.5,-1561.64 474.5,-1561.64 474.5,-1537.64 551.5,-1537.64 551.5,-1561.64"/>
<text text-anchor="middle" x="513" y="-1547.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">grid_intersect</text>
</a>
</g>
</g>
<!-- proc~mc_nbi&#45;&gt;proc~grid_intersect -->
<g id="proc~~ndmc~~CallsGraph_edge18" class="edge"><title>proc~mc_nbi&#45;&gt;proc~grid_intersect</title>
<path fill="none" stroke="#000000" d="M359.756,-1479.72C379.955,-1493.05 414.262,-1514.5 446,-1528.64 451.91,-1531.28 458.252,-1533.73 464.583,-1535.97"/>
<polygon fill="#000000" stroke="#000000" points="463.864,-1539.42 474.458,-1539.29 466.097,-1532.78 463.864,-1539.42"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_node32" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~ndmc~~CallsGraph_node32"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="696.5,-1203.64 635.5,-1203.64 635.5,-1179.64 696.5,-1179.64 696.5,-1203.64"/>
<text text-anchor="middle" x="666" y="-1189.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~mc_nbi&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge17" class="edge"><title>proc~mc_nbi&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M368.204,-1463.03C426.975,-1452.45 565.326,-1426.15 580,-1410.64 641.476,-1345.68 560.256,-1282.59 616,-1212.64 618.868,-1209.04 622.47,-1206.05 626.413,-1203.57"/>
<polygon fill="#000000" stroke="#000000" points="628.167,-1206.6 635.437,-1198.89 624.948,-1200.38 628.167,-1206.6"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_node18" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~ndmc~~CallsGraph_node18"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="832,-1264.64 764,-1264.64 764,-1240.64 832,-1240.64 832,-1264.64"/>
<text text-anchor="middle" x="798" y="-1250.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge20" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M547.424,-1113.64C601.041,-1129.85 701.725,-1161 716,-1170.64 736.372,-1184.41 734.773,-1195.1 752,-1212.64 759.1,-1219.87 767.275,-1227.36 774.694,-1233.88"/>
<polygon fill="#000000" stroke="#000000" points="772.506,-1236.61 782.359,-1240.51 777.086,-1231.32 772.506,-1236.61"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_node22" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~ndmc~~CallsGraph_node22"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="954,-1263.64 886,-1263.64 886,-1239.64 954,-1239.64 954,-1263.64"/>
<text text-anchor="middle" x="920" y="-1249.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge21" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M547.272,-1094.73C587.926,-1085.38 658.405,-1074.13 716,-1090.64 799.261,-1114.52 872.122,-1193.57 903.12,-1231.28"/>
<polygon fill="#000000" stroke="#000000" points="900.749,-1233.92 909.752,-1239.51 906.198,-1229.52 900.749,-1233.92"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge22" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M547.119,-1110.4C558.154,-1113.6 570.138,-1118.19 580,-1124.64 600.295,-1137.92 596.978,-1150.6 616,-1165.64 620.051,-1168.85 624.555,-1171.85 629.144,-1174.59"/>
<polygon fill="#000000" stroke="#000000" points="627.543,-1177.71 637.978,-1179.54 630.963,-1171.6 627.543,-1177.71"/>
</g>
<!-- proc~get_position -->
<g id="proc~~ndmc~~CallsGraph_node37" class="node"><title>proc~get_position</title>
<g id="a_proc~~ndmc~~CallsGraph_node37"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="701,-1123.64 631,-1123.64 631,-1099.64 701,-1099.64 701,-1123.64"/>
<text text-anchor="middle" x="666" y="-1109.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~ndmc~~CallsGraph_edge19" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M547.138,-1105.4C568.766,-1106.54 597.252,-1108.05 620.801,-1109.3"/>
<polygon fill="#000000" stroke="#000000" points="620.722,-1112.8 630.893,-1109.84 621.093,-1105.81 620.722,-1112.8"/>
</g>
<!-- proc~update_neutrals -->
<g id="proc~~ndmc~~CallsGraph_node39" class="node"><title>proc~update_neutrals</title>
<g id="a_proc~~ndmc~~CallsGraph_node39"><a xlink:href=".././proc/update_neutrals.html" xlink:title="update_neutrals">
<polygon fill="#d9534f" stroke="#d9534f" points="386,-593.643 296,-593.643 296,-569.643 386,-569.643 386,-593.643"/>
<text text-anchor="middle" x="341" y="-579.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_neutrals</text>
</a>
</g>
</g>
<!-- proc~store_neutrals&#45;&gt;proc~update_neutrals -->
<g id="proc~~ndmc~~CallsGraph_edge23" class="edge"><title>proc~store_neutrals&#45;&gt;proc~update_neutrals</title>
<path fill="none" stroke="#000000" d="M203.937,-581.643C228.112,-581.643 259.267,-581.643 285.664,-581.643"/>
<polygon fill="#000000" stroke="#000000" points="285.897,-585.144 295.896,-581.643 285.896,-578.144 285.897,-585.144"/>
</g>
<!-- proc~store_photons -->
<g id="proc~~ndmc~~CallsGraph_node38" class="node"><title>proc~store_photons</title>
<g id="a_proc~~ndmc~~CallsGraph_node38"><a xlink:href=".././proc/store_photons.html" xlink:title="store_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="381.5,-1304.64 300.5,-1304.64 300.5,-1280.64 381.5,-1280.64 381.5,-1304.64"/>
<text text-anchor="middle" x="341" y="-1290.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_photons</text>
</a>
</g>
</g>
<!-- proc~store_nbi_photons&#45;&gt;proc~store_photons -->
<g id="proc~~ndmc~~CallsGraph_edge24" class="edge"><title>proc~store_nbi_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M213.964,-1280.47C237.778,-1282.77 266.193,-1285.51 290.01,-1287.81"/>
<polygon fill="#000000" stroke="#000000" points="289.962,-1291.33 300.252,-1288.8 290.635,-1284.36 289.962,-1291.33"/>
</g>
<!-- proc~cross_product -->
<g id="proc~~ndmc~~CallsGraph_node42" class="node"><title>proc~cross_product</title>
<g id="a_proc~~ndmc~~CallsGraph_node42"><a xlink:href=".././proc/cross_product.html" xlink:title="cross_product">
<polygon fill="#d94e8f" stroke="#d94e8f" points="381,-1085.64 301,-1085.64 301,-1061.64 381,-1061.64 381,-1085.64"/>
<text text-anchor="middle" x="341" y="-1071.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cross_product</text>
</a>
</g>
</g>
<!-- proc~gyro_step&#45;&gt;proc~cross_product -->
<g id="proc~~ndmc~~CallsGraph_edge25" class="edge"><title>proc~gyro_step&#45;&gt;proc~cross_product</title>
<path fill="none" stroke="#000000" d="M193.063,-1073.64C219.466,-1073.64 258.97,-1073.64 290.37,-1073.64"/>
<polygon fill="#000000" stroke="#000000" points="290.677,-1077.14 300.677,-1073.64 290.677,-1070.14 290.677,-1077.14"/>
</g>
<!-- proc~track&#45;&gt;proc~get_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge27" class="edge"><title>proc~track&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M368.19,-1145.94C394.999,-1138.06 437.118,-1125.67 468.859,-1116.33"/>
<polygon fill="#000000" stroke="#000000" points="470.161,-1119.6 478.767,-1113.42 468.186,-1112.88 470.161,-1119.6"/>
</g>
<!-- proc~track&#45;&gt;proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_edge29" class="edge"><title>proc~track&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M368.207,-1159C381.911,-1162.87 398.233,-1169.29 410,-1179.64 435.381,-1201.97 419.991,-1225.05 446,-1246.64 453.979,-1253.27 464.074,-1257.81 473.952,-1260.93"/>
<polygon fill="#000000" stroke="#000000" points="473.103,-1264.32 483.673,-1263.59 474.952,-1257.57 473.103,-1264.32"/>
</g>
<!-- proc~doppler_stark -->
<g id="proc~~ndmc~~CallsGraph_node25" class="node"><title>proc~doppler_stark</title>
<g id="a_proc~~ndmc~~CallsGraph_node25"><a xlink:href=".././proc/doppler_stark.html" xlink:title="doppler_stark">
<polygon fill="#d9534f" stroke="#d9534f" points="552,-1157.64 474,-1157.64 474,-1133.64 552,-1133.64 552,-1157.64"/>
<text text-anchor="middle" x="513" y="-1143.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">doppler_stark</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~doppler_stark -->
<g id="proc~~ndmc~~CallsGraph_edge26" class="edge"><title>proc~track&#45;&gt;proc~doppler_stark</title>
<path fill="none" stroke="#000000" d="M368.19,-1152.41C393.544,-1151.22 432.592,-1149.38 463.604,-1147.92"/>
<polygon fill="#000000" stroke="#000000" points="463.957,-1151.41 473.782,-1147.44 463.628,-1144.42 463.957,-1151.41"/>
</g>
<!-- proc~track&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge30" class="edge"><title>proc~track&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M368.062,-1156.98C389.092,-1159.65 419.441,-1163.47 446,-1166.64 508.615,-1174.13 581.363,-1182.34 625.254,-1187.24"/>
<polygon fill="#000000" stroke="#000000" points="624.907,-1190.72 635.233,-1188.35 625.682,-1183.76 624.907,-1190.72"/>
</g>
<!-- proc~get_indices -->
<g id="proc~~ndmc~~CallsGraph_node40" class="node"><title>proc~get_indices</title>
<g id="a_proc~~ndmc~~CallsGraph_node40"><a xlink:href=".././proc/get_indices.html" xlink:title="get_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="546.5,-1237.64 479.5,-1237.64 479.5,-1213.64 546.5,-1213.64 546.5,-1237.64"/>
<text text-anchor="middle" x="513" y="-1223.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_indices</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~get_indices -->
<g id="proc~~ndmc~~CallsGraph_edge28" class="edge"><title>proc~track&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M368.192,-1162.67C380.978,-1167.33 396.482,-1173.34 410,-1179.64 426.59,-1187.38 429.449,-1191.83 446,-1199.64 453.684,-1203.27 462.02,-1206.83 470.1,-1210.1"/>
<polygon fill="#000000" stroke="#000000" points="468.825,-1213.36 479.411,-1213.79 471.401,-1206.85 468.825,-1213.36"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~ndmc~~CallsGraph_node27" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~ndmc~~CallsGraph_node27"><a xlink:href=".././proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="385,-1005.64 297,-1005.64 297,-981.643 385,-981.643 385,-1005.64"/>
<text text-anchor="middle" x="341" y="-991.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~ndmc~~CallsGraph_edge31" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M190.349,-951.129C216.073,-958.437 255.921,-969.757 288.032,-978.88"/>
<polygon fill="#000000" stroke="#000000" points="287.149,-982.267 297.725,-981.633 289.062,-975.534 287.149,-982.267"/>
</g>
<!-- proc~eigen -->
<g id="proc~~ndmc~~CallsGraph_node28" class="node"><title>proc~eigen</title>
<g id="a_proc~~ndmc~~CallsGraph_node28"><a xlink:href=".././proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-904.643 314,-904.643 314,-880.643 368,-880.643 368,-904.643"/>
<text text-anchor="middle" x="341" y="-890.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~ndmc~~CallsGraph_edge33" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M190.349,-936.008C220.505,-927.27 270.071,-912.907 303.829,-903.125"/>
<polygon fill="#000000" stroke="#000000" points="305.128,-906.392 313.759,-900.247 303.18,-899.669 305.128,-906.392"/>
</g>
<!-- proc~linsolve -->
<g id="proc~~ndmc~~CallsGraph_node36" class="node"><title>proc~linsolve</title>
<g id="a_proc~~ndmc~~CallsGraph_node36"><a xlink:href=".././proc/linsolve.html" xlink:title="linsolve">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-736.643 314,-736.643 314,-712.643 368,-712.643 368,-736.643"/>
<text text-anchor="middle" x="341" y="-722.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linsolve</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~linsolve -->
<g id="proc~~ndmc~~CallsGraph_edge32" class="edge"><title>proc~colrad&#45;&gt;proc~linsolve</title>
<path fill="none" stroke="#000000" d="M173.713,-931.557C202.561,-895.661 287.951,-789.409 323.832,-744.761"/>
<polygon fill="#000000" stroke="#000000" points="326.781,-746.68 330.317,-736.692 321.324,-742.295 326.781,-746.68"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~ndmc~~CallsGraph_node17" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~ndmc~~CallsGraph_node17"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="716,-1245.64 616,-1245.64 616,-1221.64 716,-1221.64 716,-1245.64"/>
<text text-anchor="middle" x="666" y="-1231.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~ndmc~~CallsGraph_edge35" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M542.048,-1261.33C559.947,-1257.3 583.829,-1251.92 605.783,-1246.98"/>
<polygon fill="#000000" stroke="#000000" points="606.719,-1250.35 615.706,-1244.74 605.181,-1243.53 606.719,-1250.35"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge38" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M542.17,-1266.15C591.76,-1263.52 694.944,-1258.05 753.664,-1254.94"/>
<polygon fill="#000000" stroke="#000000" points="753.938,-1258.43 763.739,-1254.41 753.568,-1251.44 753.938,-1258.43"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge37" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M542.002,-1271.16C599.135,-1277.67 733.114,-1289.57 844,-1273.64 854.586,-1272.12 865.762,-1269.45 876.162,-1266.49"/>
<polygon fill="#000000" stroke="#000000" points="877.279,-1269.81 885.85,-1263.58 875.266,-1263.1 877.279,-1269.81"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge36" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M542.141,-1261.67C554.314,-1258.35 568.397,-1253.48 580,-1246.64 598.961,-1235.47 597.602,-1224.72 616,-1212.64 619.165,-1210.57 622.57,-1208.62 626.057,-1206.81"/>
<polygon fill="#000000" stroke="#000000" points="627.86,-1209.82 635.371,-1202.35 624.839,-1203.51 627.86,-1209.82"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~ndmc~~CallsGraph_edge34" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M542.204,-1263.91C554.962,-1260.99 569.497,-1255.82 580,-1246.64 608.143,-1222.05 595.903,-1202.16 616,-1170.64 624.786,-1156.87 636.409,-1142.74 646.129,-1131.77"/>
<polygon fill="#000000" stroke="#000000" points="649,-1133.81 653.113,-1124.05 643.809,-1129.11 649,-1133.81"/>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_edge39" class="edge"><title>proc~parallel_merge_populations&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M187.374,-428.621C247.776,-397.552 409.203,-314.519 479.043,-278.595"/>
<polygon fill="#000000" stroke="#000000" points="480.978,-281.536 488.27,-273.849 477.776,-275.311 480.978,-281.536"/>
</g>
<!-- proc~parallel_merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_node29" class="node"><title>proc~parallel_merge_reservoirs</title>
<g id="a_proc~~ndmc~~CallsGraph_node29"><a xlink:href=".././proc/parallel_merge_reservoirs.html" xlink:title="parallel_merge_reservoirs">
<polygon fill="#d9534f" stroke="#d9534f" points="409.5,-473.643 272.5,-473.643 272.5,-449.643 409.5,-449.643 409.5,-473.643"/>
<text text-anchor="middle" x="341" y="-459.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_merge_reservoirs</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;proc~parallel_merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_edge40" class="edge"><title>proc~parallel_merge_populations&#45;&gt;proc~parallel_merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M235.586,-449.185C244.437,-450.241 253.517,-451.324 262.452,-452.391"/>
<polygon fill="#000000" stroke="#000000" points="262.113,-455.875 272.457,-453.584 262.942,-448.924 262.113,-455.875"/>
</g>
<!-- proc~ind2sub -->
<g id="proc~~ndmc~~CallsGraph_node34" class="node"><title>proc~ind2sub</title>
<g id="a_proc~~ndmc~~CallsGraph_node34"><a xlink:href=".././proc/ind2sub.html" xlink:title="ind2sub">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-431.643 314,-431.643 314,-407.643 368,-407.643 368,-431.643"/>
<text text-anchor="middle" x="341" y="-417.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ind2sub</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;proc~ind2sub -->
<g id="proc~~ndmc~~CallsGraph_edge41" class="edge"><title>proc~parallel_merge_populations&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M235.586,-432.102C258.98,-429.311 283.98,-426.328 303.65,-423.981"/>
<polygon fill="#000000" stroke="#000000" points="304.184,-427.442 313.699,-422.782 303.354,-420.491 304.184,-427.442"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~ndmc~~CallsGraph_node16" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~ndmc~~CallsGraph_node16"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="710,-29.6435 622,-29.6435 622,-5.64345 710,-5.64345 710,-29.6435"/>
<text text-anchor="middle" x="666" y="-15.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~ndmc~~CallsGraph_edge44" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M516.777,-249.472C525.489,-213.694 555.385,-107.38 616,-43.6435 618.986,-40.5031 622.437,-37.6635 626.096,-35.1158"/>
<polygon fill="#000000" stroke="#000000" points="628.215,-37.9218 634.893,-29.697 624.543,-31.9618 628.215,-37.9218"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~ndmc~~CallsGraph_node19" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~ndmc~~CallsGraph_node19"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="843.5,-405.643 752.5,-405.643 752.5,-381.643 843.5,-381.643 843.5,-405.643"/>
<text text-anchor="middle" x="798" y="-391.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~ndmc~~CallsGraph_edge51" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M524.586,-273.939C541.782,-293.109 577.733,-329.956 616,-349.643 655.559,-369.995 704.869,-381.18 742.027,-387.173"/>
<polygon fill="#000000" stroke="#000000" points="741.752,-390.672 752.167,-388.729 742.813,-383.752 741.752,-390.672"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_node20" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~ndmc~~CallsGraph_node20"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="843.5,-227.643 752.5,-227.643 752.5,-203.643 843.5,-203.643 843.5,-227.643"/>
<text text-anchor="middle" x="798" y="-213.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge42" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M549.767,-253.679C569.283,-249.485 593.905,-244.44 616,-240.643 658.113,-233.408 706.021,-226.865 741.966,-222.289"/>
<polygon fill="#000000" stroke="#000000" points="742.76,-225.717 752.244,-220.993 741.884,-218.772 742.76,-225.717"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~ndmc~~CallsGraph_node21" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~ndmc~~CallsGraph_node21"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="711.5,-315.643 620.5,-315.643 620.5,-291.643 711.5,-291.643 711.5,-315.643"/>
<text text-anchor="middle" x="666" y="-301.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~ndmc~~CallsGraph_edge48" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M549.785,-271.597C568.297,-276.746 591.263,-283.134 611.807,-288.848"/>
<polygon fill="#000000" stroke="#000000" points="611.096,-292.283 621.668,-291.591 612.972,-285.539 611.096,-292.283"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_node23" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~ndmc~~CallsGraph_node23"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="842,-53.6435 754,-53.6435 754,-29.6435 842,-29.6435 842,-53.6435"/>
<text text-anchor="middle" x="798" y="-39.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_edge49" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M516.907,-249.304C525.531,-215.602 554.312,-121.524 616,-76.6435 652.944,-49.7659 704.963,-41.98 743.76,-40.3515"/>
<polygon fill="#000000" stroke="#000000" points="743.932,-43.848 753.824,-40.0532 743.724,-36.8511 743.932,-43.848"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~ndmc~~CallsGraph_node24" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~ndmc~~CallsGraph_node24"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="842,-363.643 754,-363.643 754,-339.643 842,-339.643 842,-363.643"/>
<text text-anchor="middle" x="798" y="-349.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~ndmc~~CallsGraph_edge50" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M529.213,-273.824C548.293,-288.414 582.575,-312.416 616,-324.643 657.319,-339.758 706.899,-346.421 743.713,-349.354"/>
<polygon fill="#000000" stroke="#000000" points="743.511,-352.848 753.74,-350.086 744.021,-345.867 743.511,-352.848"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~ndmc~~CallsGraph_node26" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~ndmc~~CallsGraph_node26"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="710,-109.643 622,-109.643 622,-85.6435 710,-85.6435 710,-109.643"/>
<text text-anchor="middle" x="666" y="-95.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~ndmc~~CallsGraph_edge43" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M519.689,-249.601C532.964,-222.661 568.501,-156.901 616,-118.643 617.728,-117.252 619.561,-115.937 621.466,-114.696"/>
<polygon fill="#000000" stroke="#000000" points="623.218,-117.726 630.163,-109.726 619.745,-111.649 623.218,-117.726"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~ndmc~~CallsGraph_node33" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~ndmc~~CallsGraph_node33"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="711.5,-193.643 620.5,-193.643 620.5,-169.643 711.5,-169.643 711.5,-193.643"/>
<text text-anchor="middle" x="666" y="-179.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~ndmc~~CallsGraph_edge47" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M536.934,-249.493C562.692,-235.846 604.656,-213.614 633.484,-198.34"/>
<polygon fill="#000000" stroke="#000000" points="635.147,-201.42 642.345,-193.646 631.87,-195.235 635.147,-201.42"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~ndmc~~CallsGraph_node35" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~ndmc~~CallsGraph_node35"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="711.5,-151.643 620.5,-151.643 620.5,-127.643 711.5,-127.643 711.5,-151.643"/>
<text text-anchor="middle" x="666" y="-137.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~ndmc~~CallsGraph_edge45" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M523.541,-249.59C540.346,-229.017 577.139,-186.814 616,-160.643 618.261,-159.121 620.65,-157.67 623.109,-156.296"/>
<polygon fill="#000000" stroke="#000000" points="624.887,-159.318 632.206,-151.658 621.707,-153.082 624.887,-159.318"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~ndmc~~CallsGraph_node41" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~ndmc~~CallsGraph_node41"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="711.5,-273.643 620.5,-273.643 620.5,-249.643 711.5,-249.643 711.5,-273.643"/>
<text text-anchor="middle" x="666" y="-259.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~ndmc~~CallsGraph_edge46" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M549.785,-261.643C567.757,-261.643 589.927,-261.643 610.004,-261.643"/>
<polygon fill="#000000" stroke="#000000" points="610.279,-265.144 620.279,-261.643 610.279,-258.144 610.279,-265.144"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_edge52" class="edge"><title>proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M710.288,-25.6351C721.033,-27.6187 732.671,-29.7674 743.829,-31.8273"/>
<polygon fill="#000000" stroke="#000000" points="743.432,-35.313 753.901,-33.6867 744.703,-28.4293 743.432,-35.313"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_node56" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="959.5,-207.643 880.5,-207.643 880.5,-183.643 959.5,-183.643 959.5,-207.643"/>
<text text-anchor="middle" x="920" y="-193.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge53" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M710.194,-6.12501C748.638,1.47049 804.709,5.74501 844,-20.6435 895.948,-55.5327 912.079,-134.522 916.959,-173.307"/>
<polygon fill="#000000" stroke="#000000" points="913.512,-173.986 918.098,-183.537 920.469,-173.21 913.512,-173.986"/>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge54" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M832.344,-381.58C836.609,-379.077 840.648,-376.118 844,-372.643 887.05,-328.023 907.115,-254.948 914.884,-218.217"/>
<polygon fill="#000000" stroke="#000000" points="918.387,-218.548 916.912,-208.057 911.522,-217.178 918.387,-218.548"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge55" class="edge"><title>proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M777.828,-227.657C770.784,-236.615 777.508,-245.643 798,-245.643 810.487,-245.643 817.862,-242.291 820.124,-237.645"/>
<polygon fill="#000000" stroke="#000000" points="823.526,-236.8 818.172,-227.657 816.656,-238.143 823.526,-236.8"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge56" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M843.684,-208.196C852.305,-206.759 861.378,-205.247 870.124,-203.789"/>
<polygon fill="#000000" stroke="#000000" points="870.906,-207.207 880.195,-202.111 869.755,-200.303 870.906,-207.207"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge57" class="edge"><title>proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M698.773,-291.606C704.653,-288.941 710.628,-285.922 716,-282.643 738.551,-268.88 761.499,-249.257 777.184,-234.804"/>
<polygon fill="#000000" stroke="#000000" points="779.781,-237.167 784.684,-227.775 774.994,-232.059 779.781,-237.167"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge58" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M711.721,-304.826C749.119,-304.004 802.807,-298.489 844,-276.643 870.602,-262.536 892.801,-235.234 905.982,-216.248"/>
<polygon fill="#000000" stroke="#000000" points="908.89,-218.195 911.547,-207.939 903.074,-214.3 908.89,-218.195"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_edge59" class="edge"><title>proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M777.828,-53.6573C770.784,-62.6151 777.508,-71.6435 798,-71.6435 810.487,-71.6435 817.862,-68.2909 820.124,-63.6447"/>
<polygon fill="#000000" stroke="#000000" points="823.526,-62.8001 818.172,-53.6573 816.656,-64.1431 823.526,-62.8001"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge60" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M812.695,-53.7045C821.995,-62.2037 834.315,-74.0868 844,-85.6435 868.423,-114.785 892.426,-151.895 906.465,-174.7"/>
<polygon fill="#000000" stroke="#000000" points="903.654,-176.812 911.844,-183.532 909.632,-173.171 903.654,-176.812"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge61" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M825.389,-339.464C831.956,-335.647 838.642,-331.004 844,-325.643 876.011,-293.612 899.125,-245.156 910.669,-217.339"/>
<polygon fill="#000000" stroke="#000000" points="914.035,-218.35 914.521,-207.766 907.541,-215.737 914.035,-218.35"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_edge62" class="edge"><title>proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M694.888,-85.63C713.695,-77.5288 738.735,-66.7424 759.311,-57.8786"/>
<polygon fill="#000000" stroke="#000000" points="760.91,-61.001 768.709,-53.8302 758.14,-54.5721 760.91,-61.001"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge63" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M710.325,-109.555C746.64,-120.077 799.535,-136.67 844,-155.643 859.55,-162.278 876.202,-170.986 889.856,-178.581"/>
<polygon fill="#000000" stroke="#000000" points="888.351,-181.751 898.779,-183.624 891.795,-175.657 888.351,-181.751"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~ndmc~~CallsGraph_node62" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~ndmc~~CallsGraph_node62"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="836.5,-1085.64 759.5,-1085.64 759.5,-1061.64 836.5,-1061.64 836.5,-1085.64"/>
<text text-anchor="middle" x="798" y="-1071.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~ndmc~~CallsGraph_edge64" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M385.256,-1000.68C454.973,-1012.1 596.475,-1035.62 716,-1057.64 726.793,-1059.63 738.375,-1061.86 749.309,-1064.01"/>
<polygon fill="#000000" stroke="#000000" points="748.638,-1067.45 759.127,-1065.95 749.996,-1060.58 748.638,-1067.45"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~ndmc~~CallsGraph_node43" class="node"><title>proc~elmhes</title>
<g id="a_proc~~ndmc~~CallsGraph_node43"><a xlink:href=".././proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-883.643 486,-883.643 486,-859.643 540,-859.643 540,-883.643"/>
<text text-anchor="middle" x="513" y="-869.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~ndmc~~CallsGraph_edge65" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M368.19,-889.408C397.016,-885.847 443.543,-880.1 475.836,-876.111"/>
<polygon fill="#000000" stroke="#000000" points="476.285,-879.582 485.78,-874.882 475.427,-872.635 476.285,-879.582"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~ndmc~~CallsGraph_node51" class="node"><title>proc~hqr2</title>
<g id="a_proc~~ndmc~~CallsGraph_node51"><a xlink:href=".././proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-799.643 486,-799.643 486,-775.643 540,-775.643 540,-799.643"/>
<text text-anchor="middle" x="513" y="-785.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~ndmc~~CallsGraph_edge67" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M354.024,-880.365C372.336,-862.3 409.008,-828.552 446,-808.643 455.291,-803.643 465.967,-799.603 475.988,-796.453"/>
<polygon fill="#000000" stroke="#000000" points="477.105,-799.773 485.713,-793.597 475.132,-793.056 477.105,-799.773"/>
</g>
<!-- proc~balance -->
<g id="proc~~ndmc~~CallsGraph_node52" class="node"><title>proc~balance</title>
<g id="a_proc~~ndmc~~CallsGraph_node52"><a xlink:href=".././proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-841.643 486,-841.643 486,-817.643 540,-817.643 540,-841.643"/>
<text text-anchor="middle" x="513" y="-827.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~ndmc~~CallsGraph_edge66" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M368.289,-881.383C389.189,-872.588 419.255,-860.283 446,-850.643 455.655,-847.164 466.208,-843.67 475.988,-840.558"/>
<polygon fill="#000000" stroke="#000000" points="477.335,-843.804 485.829,-837.47 475.24,-837.125 477.335,-843.804"/>
</g>
<!-- proc~balback -->
<g id="proc~~ndmc~~CallsGraph_node57" class="node"><title>proc~balback</title>
<g id="a_proc~~ndmc~~CallsGraph_node57"><a xlink:href=".././proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-967.643 486,-967.643 486,-943.643 540,-943.643 540,-967.643"/>
<text text-anchor="middle" x="513" y="-953.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~ndmc~~CallsGraph_edge68" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M368.289,-903.904C389.189,-912.698 419.255,-925.004 446,-934.643 455.655,-938.123 466.208,-941.617 475.988,-944.729"/>
<polygon fill="#000000" stroke="#000000" points="475.24,-948.162 485.829,-947.816 477.335,-941.483 475.24,-948.162"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~ndmc~~CallsGraph_node58" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~ndmc~~CallsGraph_node58"><a xlink:href=".././proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-925.643 486,-925.643 486,-901.643 540,-901.643 540,-925.643"/>
<text text-anchor="middle" x="513" y="-911.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~ndmc~~CallsGraph_edge69" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M368.19,-895.879C397.016,-899.44 443.543,-905.187 475.836,-909.176"/>
<polygon fill="#000000" stroke="#000000" points="475.427,-912.652 485.78,-910.405 476.285,-905.705 475.427,-912.652"/>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_edge74" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M395.253,-449.614C400.532,-447.157 405.567,-444.2 410,-440.643 437.312,-418.729 482.515,-325.622 502.263,-283.046"/>
<polygon fill="#000000" stroke="#000000" points="505.497,-284.391 506.5,-273.843 499.139,-281.463 505.497,-284.391"/>
</g>
<!-- proc~my_rank -->
<g id="proc~~ndmc~~CallsGraph_node44" class="node"><title>proc~my_rank</title>
<g id="a_proc~~ndmc~~CallsGraph_node44"><a xlink:href=".././proc/my_rank.html" xlink:title="my_rank">
<polygon fill="#d94e8f" stroke="#d94e8f" points="540,-555.643 486,-555.643 486,-531.643 540,-531.643 540,-555.643"/>
<text text-anchor="middle" x="513" y="-541.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">my_rank</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~my_rank -->
<g id="proc~~ndmc~~CallsGraph_edge70" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~my_rank</title>
<path fill="none" stroke="#000000" d="M359.756,-473.716C379.955,-487.049 414.262,-508.498 446,-522.643 455.555,-526.902 466.238,-530.691 476.179,-533.839"/>
<polygon fill="#000000" stroke="#000000" points="475.218,-537.205 485.804,-536.766 477.255,-530.507 475.218,-537.205"/>
</g>
<!-- proc~num_ranks -->
<g id="proc~~ndmc~~CallsGraph_node45" class="node"><title>proc~num_ranks</title>
<g id="a_proc~~ndmc~~CallsGraph_node45"><a xlink:href=".././proc/num_ranks.html" xlink:title="num_ranks">
<polygon fill="#d94e8f" stroke="#d94e8f" points="546,-513.643 480,-513.643 480,-489.643 546,-489.643 546,-513.643"/>
<text text-anchor="middle" x="513" y="-499.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">num_ranks</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~num_ranks -->
<g id="proc~~ndmc~~CallsGraph_edge71" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~num_ranks</title>
<path fill="none" stroke="#000000" d="M393.006,-473.645C417.542,-479.418 446.602,-486.256 469.863,-491.729"/>
<polygon fill="#000000" stroke="#000000" points="469.239,-495.177 479.774,-494.061 470.842,-488.364 469.239,-495.177"/>
</g>
<!-- proc~merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_node46" class="node"><title>proc~merge_reservoirs</title>
<g id="a_proc~~ndmc~~CallsGraph_node46"><a xlink:href=".././proc/merge_reservoirs.html" xlink:title="merge_reservoirs">
<polygon fill="#d9534f" stroke="#d9534f" points="561.5,-433.643 464.5,-433.643 464.5,-409.643 561.5,-409.643 561.5,-433.643"/>
<text text-anchor="middle" x="513" y="-419.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">merge_reservoirs</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_edge72" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M393.006,-449.642C412.333,-445.095 434.467,-439.887 454.362,-435.205"/>
<polygon fill="#000000" stroke="#000000" points="455.298,-438.581 464.23,-432.883 453.694,-431.767 455.298,-438.581"/>
</g>
<!-- proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_node48" class="node"><title>proc~init_reservoir</title>
<g id="a_proc~~ndmc~~CallsGraph_node48"><a xlink:href=".././proc/init_reservoir.html" xlink:title="init_reservoir">
<polygon fill="#d9534f" stroke="#d9534f" points="835,-549.643 761,-549.643 761,-525.643 835,-525.643 835,-549.643"/>
<text text-anchor="middle" x="798" y="-535.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_reservoir</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge73" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M409.54,-456.626C458.542,-455.432 525.507,-458.948 580,-480.643 599.088,-488.243 597.205,-501.345 616,-509.643 659.073,-528.662 712.876,-535.047 750.584,-537.051"/>
<polygon fill="#000000" stroke="#000000" points="750.624,-540.556 760.771,-537.506 750.937,-533.563 750.624,-540.556"/>
</g>
<!-- proc~in_passive_grid -->
<g id="proc~~ndmc~~CallsGraph_node59" class="node"><title>proc~in_passive_grid</title>
<g id="a_proc~~ndmc~~CallsGraph_node59"><a xlink:href=".././proc/in_passive_grid.html" xlink:title="in_passive_grid">
<polygon fill="#d94e8f" stroke="#d94e8f" points="709.5,-1561.64 622.5,-1561.64 622.5,-1537.64 709.5,-1537.64 709.5,-1561.64"/>
<text text-anchor="middle" x="666" y="-1547.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_passive_grid</text>
</a>
</g>
</g>
<!-- proc~grid_intersect&#45;&gt;proc~in_passive_grid -->
<g id="proc~~ndmc~~CallsGraph_edge75" class="edge"><title>proc~grid_intersect&#45;&gt;proc~in_passive_grid</title>
<path fill="none" stroke="#000000" d="M551.714,-1549.64C570.013,-1549.64 592.303,-1549.64 612.254,-1549.64"/>
<polygon fill="#000000" stroke="#000000" points="612.44,-1553.14 622.44,-1549.64 612.44,-1546.14 612.44,-1553.14"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge76" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M695.874,-1203.71C702.516,-1206.57 709.528,-1209.66 716,-1212.64 732.008,-1220.02 749.571,-1228.63 764.239,-1235.97"/>
<polygon fill="#000000" stroke="#000000" points="762.908,-1239.21 773.415,-1240.58 766.052,-1232.96 762.908,-1239.21"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_node47" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~ndmc~~CallsGraph_node47"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="952.5,-1164.64 887.5,-1164.64 887.5,-1140.64 952.5,-1140.64 952.5,-1164.64"/>
<text text-anchor="middle" x="920" y="-1150.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge78" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M696.687,-1183.27C712.916,-1178.95 733.438,-1173.92 752,-1170.64 794.42,-1163.15 843.489,-1158.31 877.41,-1155.56"/>
<polygon fill="#000000" stroke="#000000" points="877.732,-1159.05 887.427,-1154.77 877.183,-1152.07 877.732,-1159.05"/>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~ndmc~~CallsGraph_edge77" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M676.211,-1179.53C690.838,-1160.83 720.918,-1124.49 752,-1099.64 755.766,-1096.63 759.92,-1093.75 764.137,-1091.06"/>
<polygon fill="#000000" stroke="#000000" points="766.011,-1094.02 772.776,-1085.87 762.402,-1088.02 766.011,-1094.02"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge79" class="edge"><title>proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M711.739,-193.344C721.646,-195.935 732.251,-198.709 742.498,-201.389"/>
<polygon fill="#000000" stroke="#000000" points="741.619,-204.777 752.179,-203.921 743.39,-198.005 741.619,-204.777"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge80" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M711.762,-184.13C756.337,-186.607 824.56,-190.397 870.427,-192.945"/>
<polygon fill="#000000" stroke="#000000" points="870.252,-196.441 880.43,-193.501 870.64,-189.451 870.252,-196.441"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge81" class="edge"><title>proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M697.752,-151.751C703.899,-154.469 710.235,-157.489 716,-160.643 736.005,-171.59 757.287,-186.168 773.015,-197.565"/>
<polygon fill="#000000" stroke="#000000" points="771.004,-200.431 781.137,-203.526 775.146,-194.788 771.004,-200.431"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge82" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M711.762,-149.591C756.337,-159.496 824.56,-174.657 870.427,-184.849"/>
<polygon fill="#000000" stroke="#000000" points="869.909,-188.32 880.43,-187.072 871.428,-181.486 869.909,-188.32"/>
</g>
<!-- dgetrs -->
<g id="proc~~ndmc~~CallsGraph_node49" class="node"><title>dgetrs</title>
<polygon fill="#777777" stroke="#777777" points="540,-757.643 486,-757.643 486,-733.643 540,-733.643 540,-757.643"/>
<text text-anchor="middle" x="513" y="-743.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrs</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrs -->
<g id="proc~~ndmc~~CallsGraph_edge84" class="edge"><title>proc~linsolve&#45;&gt;dgetrs</title>
<path fill="none" stroke="#000000" d="M368.19,-727.879C397.016,-731.44 443.543,-737.187 475.836,-741.176"/>
<polygon fill="#000000" stroke="#000000" points="475.427,-744.652 485.78,-742.405 476.285,-737.705 475.427,-744.652"/>
</g>
<!-- proc~matinv -->
<g id="proc~~ndmc~~CallsGraph_node53" class="node"><title>proc~matinv</title>
<g id="a_proc~~ndmc~~CallsGraph_node53"><a xlink:href=".././proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-673.643 486,-673.643 486,-649.643 540,-649.643 540,-673.643"/>
<text text-anchor="middle" x="513" y="-659.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~linsolve&#45;&gt;proc~matinv -->
<g id="proc~~ndmc~~CallsGraph_edge85" class="edge"><title>proc~linsolve&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M368.289,-713.383C389.189,-704.588 419.255,-692.283 446,-682.643 455.655,-679.164 466.208,-675.67 475.988,-672.558"/>
<polygon fill="#000000" stroke="#000000" points="477.335,-675.804 485.829,-669.47 475.24,-669.125 477.335,-675.804"/>
</g>
<!-- dgetrf -->
<g id="proc~~ndmc~~CallsGraph_node61" class="node"><title>dgetrf</title>
<polygon fill="#777777" stroke="#777777" points="540,-715.643 486,-715.643 486,-691.643 540,-691.643 540,-715.643"/>
<text text-anchor="middle" x="513" y="-701.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrf</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrf -->
<g id="proc~~ndmc~~CallsGraph_edge83" class="edge"><title>proc~linsolve&#45;&gt;dgetrf</title>
<path fill="none" stroke="#000000" d="M368.19,-721.408C397.016,-717.847 443.543,-712.1 475.836,-708.111"/>
<polygon fill="#000000" stroke="#000000" points="476.285,-711.582 485.78,-706.882 475.427,-704.635 476.285,-711.582"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_node60" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~ndmc~~CallsGraph_node60"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="829,-1203.64 767,-1203.64 767,-1179.64 829,-1179.64 829,-1203.64"/>
<text text-anchor="middle" x="798" y="-1189.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge86" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M691.651,-1123.66C699.592,-1127.81 708.32,-1132.67 716,-1137.64 733.016,-1148.66 735.185,-1154.32 752,-1165.64 756.379,-1168.59 761.106,-1171.55 765.794,-1174.36"/>
<polygon fill="#000000" stroke="#000000" points="764.259,-1177.52 774.659,-1179.54 767.79,-1171.47 764.259,-1177.52"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_edge90" class="edge"><title>proc~store_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M381.857,-1286.78C409.617,-1282.7 446.426,-1277.29 473.813,-1273.26"/>
<polygon fill="#000000" stroke="#000000" points="474.425,-1276.71 483.809,-1271.79 473.407,-1269.78 474.425,-1276.71"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge91" class="edge"><title>proc~store_photons&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M367.373,-1304.77C388.013,-1313.92 418.174,-1325.72 446,-1330.64 621.06,-1361.62 674.964,-1345.71 844,-1290.64 860.326,-1285.32 877.395,-1276.72 891.118,-1268.95"/>
<polygon fill="#000000" stroke="#000000" points="893.158,-1271.81 900.033,-1263.75 889.631,-1265.76 893.158,-1271.81"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_indices -->
<g id="proc~~ndmc~~CallsGraph_edge89" class="edge"><title>proc~store_photons&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M367.323,-1280.52C388.186,-1270.75 418.677,-1257 446,-1246.64 453.511,-1243.8 461.595,-1241.01 469.443,-1238.44"/>
<polygon fill="#000000" stroke="#000000" points="470.741,-1241.7 479.196,-1235.31 468.605,-1235.03 470.741,-1241.7"/>
</g>
<!-- proc~get_passive_grid_indices -->
<g id="proc~~ndmc~~CallsGraph_node50" class="node"><title>proc~get_passive_grid_indices</title>
<g id="a_proc~~ndmc~~CallsGraph_node50"><a xlink:href=".././proc/get_passive_grid_indices.html" xlink:title="get_passive_grid_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="579.5,-1401.64 446.5,-1401.64 446.5,-1377.64 579.5,-1377.64 579.5,-1401.64"/>
<text text-anchor="middle" x="513" y="-1387.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_passive_grid_indices</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_passive_grid_indices -->
<g id="proc~~ndmc~~CallsGraph_edge87" class="edge"><title>proc~store_photons&#45;&gt;proc~get_passive_grid_indices</title>
<path fill="none" stroke="#000000" d="M357.511,-1304.87C377.247,-1320.04 412.772,-1346.04 446,-1363.64 452.887,-1367.29 460.402,-1370.72 467.813,-1373.83"/>
<polygon fill="#000000" stroke="#000000" points="466.508,-1377.07 477.091,-1377.57 469.127,-1370.58 466.508,-1377.07"/>
</g>
<!-- proc~spectrum -->
<g id="proc~~ndmc~~CallsGraph_node54" class="node"><title>proc~spectrum</title>
<g id="a_proc~~ndmc~~CallsGraph_node54"><a xlink:href=".././proc/spectrum.html" xlink:title="spectrum">
<polygon fill="#d9534f" stroke="#d9534f" points="541.5,-1321.64 484.5,-1321.64 484.5,-1297.64 541.5,-1297.64 541.5,-1321.64"/>
<text text-anchor="middle" x="513" y="-1307.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spectrum</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~spectrum -->
<g id="proc~~ndmc~~CallsGraph_edge88" class="edge"><title>proc~store_photons&#45;&gt;proc~spectrum</title>
<path fill="none" stroke="#000000" d="M381.857,-1296.63C409.791,-1299.42 446.888,-1303.13 474.327,-1305.88"/>
<polygon fill="#000000" stroke="#000000" points="474.033,-1309.36 484.331,-1306.88 474.729,-1302.4 474.033,-1309.36"/>
</g>
<!-- proc~update_reservoir -->
<g id="proc~~ndmc~~CallsGraph_node55" class="node"><title>proc~update_reservoir</title>
<g id="a_proc~~ndmc~~CallsGraph_node55"><a xlink:href=".././proc/update_reservoir.html" xlink:title="update_reservoir">
<polygon fill="#d9534f" stroke="#d9534f" points="713,-590.643 619,-590.643 619,-566.643 713,-566.643 713,-590.643"/>
<text text-anchor="middle" x="666" y="-576.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_reservoir</text>
</a>
</g>
</g>
<!-- proc~update_neutrals&#45;&gt;proc~update_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge92" class="edge"><title>proc~update_neutrals&#45;&gt;proc~update_reservoir</title>
<path fill="none" stroke="#000000" d="M386.235,-581.233C444.09,-580.695 545.508,-579.753 608.76,-579.166"/>
<polygon fill="#000000" stroke="#000000" points="608.988,-582.664 618.955,-579.071 608.922,-575.664 608.988,-582.664"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge93" class="edge"><title>proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M701.156,-249.557C717.129,-243.905 736.337,-237.109 753.35,-231.089"/>
<polygon fill="#000000" stroke="#000000" points="754.812,-234.284 763.072,-227.649 752.477,-227.685 754.812,-234.284"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge94" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M711.752,-267.33C748.452,-270.26 801.148,-270.434 844,-254.643 866.298,-246.427 887.154,-228.896 901.184,-215.067"/>
<polygon fill="#000000" stroke="#000000" points="903.753,-217.445 908.242,-207.848 898.748,-212.552 903.753,-217.445"/>
</g>
<!-- proc~rswap -->
<g id="proc~~ndmc~~CallsGraph_node69" class="node"><title>proc~rswap</title>
<g id="a_proc~~ndmc~~CallsGraph_node69"><a xlink:href=".././proc/rswap.html" xlink:title="RSWAP">
<polygon fill="#d9534f" stroke="#d9534f" points="693,-883.643 639,-883.643 639,-859.643 693,-859.643 693,-883.643"/>
<text text-anchor="middle" x="666" y="-869.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RSWAP</text>
</a>
</g>
</g>
<!-- proc~elmhes&#45;&gt;proc~rswap -->
<g id="proc~~ndmc~~CallsGraph_edge95" class="edge"><title>proc~elmhes&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M540.302,-871.643C564.769,-871.643 601.446,-871.643 628.696,-871.643"/>
<polygon fill="#000000" stroke="#000000" points="628.999,-875.144 638.999,-871.643 628.999,-868.144 628.999,-875.144"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge99" class="edge"><title>proc~merge_reservoirs&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M561.704,-432.649C640.73,-451.331 794.96,-489.828 844,-516.643 865.011,-528.132 885.749,-545.907 900.074,-559.484"/>
<polygon fill="#000000" stroke="#000000" points="897.719,-562.077 907.333,-566.529 902.594,-557.053 897.719,-562.077"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge96" class="edge"><title>proc~merge_reservoirs&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M550.144,-433.738C560.088,-437.634 570.692,-442.337 580,-447.643 597.609,-457.683 598.168,-466.005 616,-475.643 659.454,-499.131 713.501,-516.252 751.171,-526.478"/>
<polygon fill="#000000" stroke="#000000" points="750.294,-529.866 760.858,-529.054 752.093,-523.102 750.294,-529.866"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;proc~update_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge98" class="edge"><title>proc~merge_reservoirs&#45;&gt;proc~update_reservoir</title>
<path fill="none" stroke="#000000" d="M528.642,-433.8C542.346,-445.391 563.174,-463.563 580,-480.643 605.309,-506.334 632.212,-538.228 648.813,-558.513"/>
<polygon fill="#000000" stroke="#000000" points="646.238,-560.894 655.263,-566.444 651.669,-556.477 646.238,-560.894"/>
</g>
<!-- float -->
<g id="proc~~ndmc~~CallsGraph_node63" class="node"><title>float</title>
<polygon fill="#777777" stroke="#777777" points="693,-433.643 639,-433.643 639,-409.643 693,-409.643 693,-433.643"/>
<text text-anchor="middle" x="666" y="-419.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">float</text>
</g>
<!-- proc~merge_reservoirs&#45;&gt;float -->
<g id="proc~~ndmc~~CallsGraph_edge97" class="edge"><title>proc~merge_reservoirs&#45;&gt;float</title>
<path fill="none" stroke="#000000" d="M561.777,-421.643C583.31,-421.643 608.336,-421.643 628.353,-421.643"/>
<polygon fill="#000000" stroke="#000000" points="628.611,-425.144 638.611,-421.643 628.611,-418.144 628.611,-425.144"/>
</g>
<!-- proc~init_reservoir&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge100" class="edge"><title>proc~init_reservoir&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M834.355,-549.723C849.667,-554.955 867.571,-561.072 882.96,-566.33"/>
<polygon fill="#000000" stroke="#000000" points="882.062,-569.721 892.656,-569.643 884.325,-563.097 882.062,-569.721"/>
</g>
<!-- proc~xyz_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_node65" class="node"><title>proc~xyz_to_cyl</title>
<g id="a_proc~~ndmc~~CallsGraph_node65"><a xlink:href=".././proc/xyz_to_cyl.html" xlink:title="xyz_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="697,-1401.64 635,-1401.64 635,-1377.64 697,-1377.64 697,-1401.64"/>
<text text-anchor="middle" x="666" y="-1387.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_cyl</text>
</a>
</g>
</g>
<!-- proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_edge101" class="edge"><title>proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl</title>
<path fill="none" stroke="#000000" d="M579.792,-1389.64C595.118,-1389.64 610.987,-1389.64 624.816,-1389.64"/>
<polygon fill="#000000" stroke="#000000" points="624.95,-1393.14 634.95,-1389.64 624.95,-1386.14 624.95,-1393.14"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~ndmc~~CallsGraph_node66" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~ndmc~~CallsGraph_node66"><a xlink:href=".././proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="693,-799.643 639,-799.643 639,-775.643 693,-775.643 693,-799.643"/>
<text text-anchor="middle" x="666" y="-785.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~ndmc~~CallsGraph_edge102" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M540.302,-787.643C564.769,-787.643 601.446,-787.643 628.696,-787.643"/>
<polygon fill="#000000" stroke="#000000" points="628.999,-791.144 638.999,-787.643 628.999,-784.144 628.999,-791.144"/>
</g>
<!-- proc~balance&#45;&gt;proc~rswap -->
<g id="proc~~ndmc~~CallsGraph_edge103" class="edge"><title>proc~balance&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M540.302,-836.959C564.878,-843.795 601.771,-854.057 629.057,-861.646"/>
<polygon fill="#000000" stroke="#000000" points="628.427,-865.104 638.999,-864.411 630.303,-858.36 628.427,-865.104"/>
</g>
<!-- proc~lubksb -->
<g id="proc~~ndmc~~CallsGraph_node64" class="node"><title>proc~lubksb</title>
<g id="a_proc~~ndmc~~CallsGraph_node64"><a xlink:href=".././proc/lubksb.html" xlink:title="lubksb">
<polygon fill="#d9534f" stroke="#d9534f" points="693,-715.643 639,-715.643 639,-691.643 693,-691.643 693,-715.643"/>
<text text-anchor="middle" x="666" y="-701.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lubksb</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~lubksb -->
<g id="proc~~ndmc~~CallsGraph_edge105" class="edge"><title>proc~matinv&#45;&gt;proc~lubksb</title>
<path fill="none" stroke="#000000" d="M540.302,-668.959C564.878,-675.795 601.771,-686.057 629.057,-693.646"/>
<polygon fill="#000000" stroke="#000000" points="628.427,-697.104 638.999,-696.411 630.303,-690.36 628.427,-697.104"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~ndmc~~CallsGraph_node70" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~ndmc~~CallsGraph_node70"><a xlink:href=".././proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="693,-673.643 639,-673.643 639,-649.643 693,-649.643 693,-673.643"/>
<text text-anchor="middle" x="666" y="-659.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~ndmc~~CallsGraph_edge104" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M540.302,-661.643C564.769,-661.643 601.446,-661.643 628.696,-661.643"/>
<polygon fill="#000000" stroke="#000000" points="628.999,-665.144 638.999,-661.643 628.999,-658.144 628.999,-665.144"/>
</g>
<!-- proc~update_reservoir&#45;&gt;interface~randind -->
<g id="proc~~ndmc~~CallsGraph_edge107" class="edge"><title>proc~update_reservoir&#45;&gt;interface~randind</title>
<path fill="none" stroke="#000000" d="M705.301,-590.723C722.957,-596.291 743.793,-602.863 761.139,-608.333"/>
<polygon fill="#000000" stroke="#000000" points="760.308,-611.741 770.898,-611.411 762.414,-605.065 760.308,-611.741"/>
</g>
<!-- proc~update_reservoir&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge108" class="edge"><title>proc~update_reservoir&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M713.221,-578.643C762.024,-578.643 837.953,-578.643 882.652,-578.643"/>
<polygon fill="#000000" stroke="#000000" points="882.771,-582.144 892.771,-578.643 882.771,-575.144 882.771,-582.144"/>
</g>
<!-- proc~update_reservoir&#45;&gt;proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge106" class="edge"><title>proc~update_reservoir&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M705.301,-566.564C719.678,-562.03 736.163,-556.83 751.156,-552.102"/>
<polygon fill="#000000" stroke="#000000" points="752.271,-555.42 760.755,-549.074 750.166,-548.744 752.271,-555.42"/>
</g>
<!-- proc~balback&#45;&gt;proc~rswap -->
<g id="proc~~ndmc~~CallsGraph_edge109" class="edge"><title>proc~balback&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M540.166,-949.461C552.614,-945.989 567.476,-941.052 580,-934.643 603.394,-922.674 627.186,-904.407 643.626,-890.62"/>
<polygon fill="#000000" stroke="#000000" points="646.187,-893.035 651.512,-883.876 641.637,-887.716 646.187,-893.035"/>
</g>
<!-- proc~approx_le -->
<g id="proc~~ndmc~~CallsGraph_node67" class="node"><title>proc~approx_le</title>
<g id="a_proc~~ndmc~~CallsGraph_node67"><a xlink:href=".././proc/approx_le.html" xlink:title="approx_le">
<polygon fill="#d94e8f" stroke="#d94e8f" points="828,-1561.64 768,-1561.64 768,-1537.64 828,-1537.64 828,-1561.64"/>
<text text-anchor="middle" x="798" y="-1547.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_le</text>
</a>
</g>
</g>
<!-- proc~in_passive_grid&#45;&gt;proc~approx_le -->
<g id="proc~~ndmc~~CallsGraph_edge111" class="edge"><title>proc~in_passive_grid&#45;&gt;proc~approx_le</title>
<path fill="none" stroke="#000000" d="M709.567,-1549.64C725.09,-1549.64 742.558,-1549.64 757.776,-1549.64"/>
<polygon fill="#000000" stroke="#000000" points="757.901,-1553.14 767.901,-1549.64 757.901,-1546.14 757.901,-1553.14"/>
</g>
<!-- proc~approx_ge -->
<g id="proc~~ndmc~~CallsGraph_node68" class="node"><title>proc~approx_ge</title>
<g id="a_proc~~ndmc~~CallsGraph_node68"><a xlink:href=".././proc/approx_ge.html" xlink:title="approx_ge">
<polygon fill="#d94e8f" stroke="#d94e8f" points="830,-1603.64 766,-1603.64 766,-1579.64 830,-1579.64 830,-1603.64"/>
<text text-anchor="middle" x="798" y="-1589.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_ge</text>
</a>
</g>
</g>
<!-- proc~in_passive_grid&#45;&gt;proc~approx_ge -->
<g id="proc~~ndmc~~CallsGraph_edge112" class="edge"><title>proc~in_passive_grid&#45;&gt;proc~approx_ge</title>
<path fill="none" stroke="#000000" d="M704.253,-1561.68C720.407,-1566.9 739.377,-1573.03 755.937,-1578.38"/>
<polygon fill="#000000" stroke="#000000" points="755.298,-1581.85 765.89,-1581.59 757.45,-1575.19 755.298,-1581.85"/>
</g>
<!-- proc~uvw_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_node71" class="node"><title>proc~uvw_to_cyl</title>
<g id="a_proc~~ndmc~~CallsGraph_node71"><a xlink:href=".././proc/uvw_to_cyl.html" xlink:title="uvw_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="830.5,-1519.64 765.5,-1519.64 765.5,-1495.64 830.5,-1495.64 830.5,-1519.64"/>
<text text-anchor="middle" x="798" y="-1505.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_cyl</text>
</a>
</g>
</g>
<!-- proc~in_passive_grid&#45;&gt;proc~uvw_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_edge110" class="edge"><title>proc~in_passive_grid&#45;&gt;proc~uvw_to_cyl</title>
<path fill="none" stroke="#000000" d="M704.253,-1537.61C720.283,-1532.43 739.085,-1526.35 755.555,-1521.03"/>
<polygon fill="#000000" stroke="#000000" points="757.022,-1524.24 765.462,-1517.83 754.87,-1517.58 757.022,-1524.24"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge114" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M823.284,-1203.79C841.257,-1212.77 865.953,-1225.12 885.757,-1235.02"/>
<polygon fill="#000000" stroke="#000000" points="884.243,-1238.18 894.752,-1239.52 887.373,-1231.92 884.243,-1238.18"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge113" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M829.281,-1181.8C844.001,-1177.02 861.913,-1171.2 877.85,-1166.02"/>
<polygon fill="#000000" stroke="#000000" points="879.043,-1169.31 887.471,-1162.89 876.879,-1162.65 879.043,-1169.31"/>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge115" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M678.537,-1377.49C701.03,-1353.78 750.928,-1301.2 778.239,-1272.41"/>
<polygon fill="#000000" stroke="#000000" points="780.958,-1274.63 785.302,-1264.97 775.88,-1269.82 780.958,-1274.63"/>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_edge116" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl</title>
<path fill="none" stroke="#000000" d="M680.423,-1401.83C702.998,-1422.32 748.741,-1463.84 775.729,-1488.34"/>
<polygon fill="#000000" stroke="#000000" points="773.699,-1491.22 783.456,-1495.35 778.403,-1486.04 773.699,-1491.22"/>
</g>
<!-- proc~comdiv -->
<g id="proc~~ndmc~~CallsGraph_node72" class="node"><title>proc~comdiv</title>
<g id="a_proc~~ndmc~~CallsGraph_node72"><a xlink:href=".././proc/comdiv.html" xlink:title="Comdiv">
<polygon fill="#d9534f" stroke="#d9534f" points="825,-799.643 771,-799.643 771,-775.643 825,-775.643 825,-799.643"/>
<text text-anchor="middle" x="798" y="-785.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Comdiv</text>
</a>
</g>
</g>
<!-- proc~hqrvec&#45;&gt;proc~comdiv -->
<g id="proc~~ndmc~~CallsGraph_edge117" class="edge"><title>proc~hqrvec&#45;&gt;proc~comdiv</title>
<path fill="none" stroke="#000000" d="M693.307,-787.643C712.69,-787.643 739.29,-787.643 760.695,-787.643"/>
<polygon fill="#000000" stroke="#000000" points="760.732,-791.144 770.732,-787.643 760.732,-784.144 760.732,-791.144"/>
</g>
<!-- proc~approx_eq -->
<g id="proc~~ndmc~~CallsGraph_node73" class="node"><title>proc~approx_eq</title>
<g id="a_proc~~ndmc~~CallsGraph_node73"><a xlink:href=".././proc/approx_eq.html" xlink:title="approx_eq">
<polygon fill="#d94e8f" stroke="#d94e8f" points="952,-1582.64 888,-1582.64 888,-1558.64 952,-1558.64 952,-1582.64"/>
<text text-anchor="middle" x="920" y="-1568.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_eq</text>
</a>
</g>
</g>
<!-- proc~approx_le&#45;&gt;proc~approx_eq -->
<g id="proc~~ndmc~~CallsGraph_edge118" class="edge"><title>proc~approx_le&#45;&gt;proc~approx_eq</title>
<path fill="none" stroke="#000000" d="M828.049,-1554.73C842.984,-1557.34 861.442,-1560.57 877.819,-1563.44"/>
<polygon fill="#000000" stroke="#000000" points="877.243,-1566.89 887.697,-1565.17 878.45,-1559.99 877.243,-1566.89"/>
</g>
<!-- proc~approx_ge&#45;&gt;proc~approx_eq -->
<g id="proc~~ndmc~~CallsGraph_edge119" class="edge"><title>proc~approx_ge&#45;&gt;proc~approx_eq</title>
<path fill="none" stroke="#000000" d="M830.215,-1586.18C844.799,-1583.63 862.355,-1580.56 877.993,-1577.82"/>
<polygon fill="#000000" stroke="#000000" points="878.694,-1581.25 887.941,-1576.08 877.487,-1574.36 878.694,-1581.25"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~ndmc~~CallsGraph_node74" class="node"><title>proc~outerprod</title>
<g id="a_proc~~ndmc~~CallsGraph_node74"><a xlink:href=".././proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="827.5,-673.643 768.5,-673.643 768.5,-649.643 827.5,-649.643 827.5,-673.643"/>
<text text-anchor="middle" x="798" y="-659.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~ndmc~~CallsGraph_edge121" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M693.307,-661.643C711.967,-661.643 737.316,-661.643 758.28,-661.643"/>
<polygon fill="#000000" stroke="#000000" points="758.476,-665.144 768.476,-661.643 758.476,-658.144 758.476,-665.144"/>
</g>
<!-- proc~swap -->
<g id="proc~~ndmc~~CallsGraph_node75" class="node"><title>proc~swap</title>
<g id="a_proc~~ndmc~~CallsGraph_node75"><a xlink:href=".././proc/swap.html" xlink:title="swap">
<polygon fill="#d9534f" stroke="#d9534f" points="825,-715.643 771,-715.643 771,-691.643 825,-691.643 825,-715.643"/>
<text text-anchor="middle" x="798" y="-701.243" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swap</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~swap -->
<g id="proc~~ndmc~~CallsGraph_edge120" class="edge"><title>proc~ludcmp&#45;&gt;proc~swap</title>
<path fill="none" stroke="#000000" d="M693.307,-670.143C712.778,-676.433 739.532,-685.077 760.987,-692.008"/>
<polygon fill="#000000" stroke="#000000" points="760.14,-695.413 770.732,-695.157 762.292,-688.752 760.14,-695.413"/>
</g>
</g>
</svg>
</div><script>var panprocndmcCallsGraph = svgPanZoom('#procndmcCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~ndmc~~CalledByGraph Pages: 1 -->
<svg id="procndmcCalledByGraph" width="152pt" height="32pt"
 viewBox="0.00 0.00 152.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~ndmc~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~ndmc~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 148,-28 148,4 -4,4"/>
<!-- proc~ndmc -->
<g id="proc~~ndmc~~CalledByGraph_node1" class="node"><title>proc~ndmc</title>
<polygon fill="none" stroke="black" points="144,-24 90,-24 90,-0 144,-0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">ndmc</text>
</g>
<!-- program~fidasim -->
<g id="proc~~ndmc~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~ndmc~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~ndmc -->
<g id="proc~~ndmc~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~ndmc</title>
<path fill="none" stroke="#000000" d="M54.4029,-12C62.3932,-12 71.3106,-12 79.8241,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.919,-15.5001 89.919,-12 79.919,-8.5001 79.919,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/ndmc.html#src">ndmc</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">ndmc</span><span class="w"></span>
<span class="w">    </span><span class="c">!+ Calculates neutral beam deposition and spectra</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">neut_type</span><span class="w"> </span><span class="c">!! full half third energy</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">nlaunch</span><span class="w">   </span><span class="c">!! nr. of markers</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">nneutrals</span><span class="w"> </span><span class="c">!! # NBI particles</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">vnbi</span><span class="w"> </span><span class="c">!! velocities(full..)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rnbi</span><span class="w"> </span><span class="c">!! initial position</span>

<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">jj</span><span class="p">,</span><span class="w"> </span><span class="n">ii</span><span class="p">,</span><span class="w"> </span><span class="n">kk</span><span class="p">,</span><span class="w"> </span><span class="n">cnt</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ntrack</span><span class="p">,</span><span class="w"> </span><span class="n">ic</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">ParticleTrack</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ntrack</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tracks</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">plasma</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fields</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">states</span><span class="p">,</span><span class="w"> </span><span class="n">dens</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">photons</span><span class="p">,</span><span class="w"> </span><span class="n">iflux</span><span class="p">,</span><span class="n">flux_tot</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ind</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ri</span><span class="p">,</span><span class="n">ri_gc</span><span class="p">,</span><span class="n">r_gyro</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">randomu</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">randi</span><span class="w"></span>
<span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">err</span><span class="w"></span>

<span class="w">    </span><span class="c">!! Initialize Neutral Population</span>
<span class="w">    </span><span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">half</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">third</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i10)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of birth markers: 3 x&quot;,i10)&#39;</span><span class="p">)</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="o">*</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_birth</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">    endif</span><span class="w"></span>

<span class="w">    </span><span class="c">!! # of injected neutrals = NBI power/energy_per_particle</span>
<span class="w">    </span><span class="n">nneutrals</span><span class="o">=</span><span class="mf">1.d6</span><span class="o">*</span><span class="n">nbi</span><span class="p">%</span><span class="n">pinj</span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.d3</span><span class="o">*</span><span class="n">nbi</span><span class="p">%</span><span class="n">einj</span><span class="o">*</span><span class="n">e0</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="o">*</span><span class="p">(</span><span class="w"> </span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="o">+</span><span class="w">  </span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.d0</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="o">+</span><span class="w">  </span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mf">3.d0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">nlaunch</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="c">!$OMP PARALLEL DO schedule(guided) &amp;</span>
<span class="w">    </span><span class="c">!$OMP&amp; private(vnbi,rnbi,tracks,ntrack,plasma,fields,randi,flux_tot, &amp;</span>
<span class="w">    </span><span class="c">!$OMP&amp; states,dens,iflux,photons,neut_type,jj,ii,kk,ind,err,ri,ri_gc,r_gyro)</span>
<span class="w">    </span><span class="n">loop_over_markers</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">ii</span><span class="o">=</span><span class="n">istart</span><span class="p">,</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="p">,</span><span class="n">istep</span><span class="w"></span>
<span class="w">        </span><span class="n">energy_fractions</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">neut_type</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="w"></span>
<span class="w">            </span><span class="c">!! (type = 1: full energy, =2: half energy, =3: third energy</span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="n">neut_type</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">energy_fractions</span><span class="w"></span>

<span class="w">            </span><span class="k">call </span><span class="n">mc_nbi</span><span class="p">(</span><span class="n">vnbi</span><span class="p">,</span><span class="n">neut_type</span><span class="p">,</span><span class="n">rnbi</span><span class="p">,</span><span class="n">err</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">energy_fractions</span><span class="w"></span>

<span class="w">            </span><span class="k">call </span><span class="n">track</span><span class="p">(</span><span class="n">rnbi</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">tracks</span><span class="p">,</span><span class="n">ntrack</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">ntrack</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">energy_fractions</span><span class="w"></span>

<span class="w">            </span><span class="c">!! Solve collisional radiative model along track</span>
<span class="w">            </span><span class="n">flux_tot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.d0</span><span class="w"></span>
<span class="w">            </span><span class="n">states</span><span class="o">=</span><span class="mf">0.d0</span><span class="w"></span>
<span class="w">            </span><span class="n">states</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">nneutrals</span><span class="o">*</span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="n">neut_type</span><span class="p">)</span><span class="o">/</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="w"></span>
<span class="w">            </span><span class="n">loop_along_track</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">jj</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ntrack</span><span class="w"></span>
<span class="w">                </span><span class="n">iflux</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="n">ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">ind</span><span class="w"></span>
<span class="w">                </span><span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">call </span><span class="n">colrad</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">beam_mass</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="nb">time</span><span class="p">,</span><span class="n">states</span><span class="p">,</span><span class="n">dens</span><span class="p">,</span><span class="n">photons</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="n">dens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dens</span><span class="o">/</span><span class="n">nlaunch</span><span class="w"></span>
<span class="w">                </span><span class="k">call </span><span class="n">store_neutrals</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">neut_type</span><span class="p">,</span><span class="n">dens</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">flux</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">iflux</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">))</span><span class="o">/</span><span class="n">nlaunch</span><span class="w"></span>
<span class="w">                </span><span class="n">flux_tot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">flux_tot</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">flux</span><span class="o">*</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    call </span><span class="n">store_births</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">neut_type</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">flux</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">endif</span>

<span class="k">                if</span><span class="p">((</span><span class="n">photons</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_bes</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    call </span><span class="n">store_nbi_photons</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">beam_lambda0</span><span class="p">,</span><span class="w"> </span><span class="n">photons</span><span class="o">/</span><span class="n">nlaunch</span><span class="p">,</span><span class="n">neut_type</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">endif</span>
<span class="k">            enddo </span><span class="n">loop_along_track</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">((</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">flux_tot</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">                </span><span class="c">!! Sample according to deposited flux along neutral trajectory</span>
<span class="w">                </span><span class="c">!$OMP CRITICAL(ndmc_birth)</span>
<span class="w">                </span><span class="k">do </span><span class="n">kk</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_birth</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">randind</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ntrack</span><span class="p">)%</span><span class="n">flux</span><span class="p">,</span><span class="n">randi</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">randu</span><span class="p">(</span><span class="n">randomu</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">neut_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neut_type</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">energy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbi</span><span class="p">%</span><span class="n">einj</span><span class="o">/</span><span class="kt">real</span><span class="p">(</span><span class="n">neut_type</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">flux_tot</span><span class="o">/</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_birth</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tracks</span><span class="p">(</span><span class="n">randi</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">ind</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">vi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vnbi</span><span class="w"></span>
<span class="w">                    </span><span class="n">ri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tracks</span><span class="p">(</span><span class="n">randi</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">pos</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">vnbi</span><span class="o">*</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="n">randi</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="nb">time</span><span class="o">*</span><span class="p">(</span><span class="n">randomu</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">))</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">ri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ri</span><span class="w"></span>

<span class="w">                    </span><span class="k">call </span><span class="n">get_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">pitch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dot_product</span><span class="p">(</span><span class="n">fields</span><span class="p">%</span><span class="n">b_norm</span><span class="p">,</span><span class="n">vnbi</span><span class="o">/</span><span class="nb">norm2</span><span class="p">(</span><span class="n">vnbi</span><span class="p">))</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">gyro_step</span><span class="p">(</span><span class="n">vnbi</span><span class="p">,</span><span class="n">fields</span><span class="p">,</span><span class="n">beam_mass</span><span class="p">,</span><span class="n">r_gyro</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">ri_gc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ri</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r_gyro</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                </span><span class="k">enddo</span><span class="w"></span>
<span class="w">                </span><span class="c">!$OMP END CRITICAL(ndmc_birth)</span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">        enddo </span><span class="n">energy_fractions</span><span class="w"></span>
<span class="w">    </span><span class="k">enddo </span><span class="n">loop_over_markers</span><span class="w"></span>
<span class="w">    </span><span class="c">!$OMP END PARALLEL DO</span>

<span class="cp">#ifdef _MPI</span>
<span class="w">    </span><span class="c">!! Combine beam neutrals</span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_merge_populations</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_merge_populations</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">half</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_merge_populations</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">third</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">nbi_outside</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">dens</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span><span class="w"></span>
<span class="w">    </span><span class="c">!! Combine spectra</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_bes</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">full</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">half</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">third</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span><span class="w"></span>
<span class="cp">#endif</span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">nbi_outside</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="k">        if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T4,a, f6.2,a)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Percent of markers outside the grid: &#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                                  </span><span class="mi">10</span><span class="mf">0.</span><span class="o">*</span><span class="n">nbi_outside</span><span class="o">/</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="p">),</span><span class="s1">&#39;%&#39;</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">        if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">%</span><span class="n">dens</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">stop</span><span class="w"> </span><span class="s1">&#39;Beam does not intersect the grid!&#39;</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">end subroutine </span><span class="n">ndmc</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>