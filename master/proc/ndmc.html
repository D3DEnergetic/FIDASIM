<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="">
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>ndmc &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>User Guide</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>ndmc
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.7% of total for procedures.">94 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
     <li><a href='../module/libfida.html'>libfida</a></li>
     <li class="active">ndmc</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/ndmc.html#src">ndmc</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public subroutine ndmc()</h2>
    

    <p>Calculates neutral beam deposition and spectra</p>

    <h3>Arguments</h3>
    <em>None</em>
    <br>
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~ndmc~~CallsGraph Pages: 1 -->
<svg id="procndmcCallsGraph" width="641pt" height="1036pt"
 viewBox="0.00 0.00 641.00 1036.44" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~ndmc~~CallsGraph" class="graph" transform="scale(0.66219 0.66219) rotate(0) translate(4 1561.16)">
<title>proc~~ndmc~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1561.16 964,-1561.16 964,4 -4,4"/>
<!-- proc~ndmc -->
<g id="proc~~ndmc~~CallsGraph_node1" class="node"><title>proc~ndmc</title>
<polygon fill="none" stroke="black" points="54,-737.999 0,-737.999 0,-713.999 54,-713.999 54,-737.999"/>
<text text-anchor="middle" x="27" y="-723.599" font-family="Helvetica,sans-Serif" font-size="10.50">ndmc</text>
</g>
<!-- proc~store_neutrals -->
<g id="proc~~ndmc~~CallsGraph_node2" class="node"><title>proc~store_neutrals</title>
<g id="a_proc~~ndmc~~CallsGraph_node2"><a xlink:href=".././proc/store_neutrals.html" xlink:title="store_neutrals">
<polygon fill="#d9534f" stroke="#d9534f" points="203.5,-556.999 122.5,-556.999 122.5,-532.999 203.5,-532.999 203.5,-556.999"/>
<text text-anchor="middle" x="163" y="-542.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_neutrals</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~store_neutrals -->
<g id="proc~~ndmc~~CallsGraph_edge1" class="edge"><title>proc~ndmc&#45;&gt;proc~store_neutrals</title>
<path fill="none" stroke="#000000" d="M29.0925,-713.962C32.4384,-684.292 45.2222,-607.087 90,-565.999 96.4129,-560.114 104.386,-555.871 112.667,-552.813"/>
<polygon fill="#000000" stroke="#000000" points="113.961,-556.075 122.454,-549.741 111.865,-549.396 113.961,-556.075"/>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_node3" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~ndmc~~CallsGraph_node3"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="549.5,-272.999 476.5,-272.999 476.5,-248.999 549.5,-248.999 549.5,-272.999"/>
<text text-anchor="middle" x="513" y="-258.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_edge2" class="edge"><title>proc~ndmc&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M28.6289,-713.588C30.9627,-679.506 41.7131,-583.079 90,-523.999 148.272,-452.701 186.605,-459.448 272,-424.999 330.996,-401.199 356.77,-421.835 410,-386.999 451.5,-359.84 484.198,-310.366 500.548,-282.169"/>
<polygon fill="#000000" stroke="#000000" points="503.769,-283.583 505.636,-273.154 497.673,-280.142 503.769,-283.583"/>
</g>
<!-- proc~store_nbi_photons -->
<g id="proc~~ndmc~~CallsGraph_node4" class="node"><title>proc~store_nbi_photons</title>
<g id="a_proc~~ndmc~~CallsGraph_node4"><a xlink:href=".././proc/store_nbi_photons.html" xlink:title="store_nbi_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="213.5,-1414 112.5,-1414 112.5,-1390 213.5,-1390 213.5,-1414"/>
<text text-anchor="middle" x="163" y="-1399.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_nbi_photons</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~store_nbi_photons -->
<g id="proc~~ndmc~~CallsGraph_edge3" class="edge"><title>proc~ndmc&#45;&gt;proc~store_nbi_photons</title>
<path fill="none" stroke="#000000" d="M28.3937,-738.117C31.2387,-822.652 49.6938,-1322.38 90,-1375 93.6403,-1379.75 98.2146,-1383.67 103.284,-1386.89"/>
<polygon fill="#000000" stroke="#000000" points="101.741,-1390.04 112.205,-1391.7 105.061,-1383.88 101.741,-1390.04"/>
</g>
<!-- interface~randu -->
<g id="proc~~ndmc~~CallsGraph_node5" class="node"><title>interface~randu</title>
<g id="a_proc~~ndmc~~CallsGraph_node5"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="947,-596.999 893,-596.999 893,-572.999 947,-572.999 947,-596.999"/>
<text text-anchor="middle" x="920" y="-582.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge4" class="edge"><title>proc~ndmc&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M41.0294,-738.292C52.7925,-748.482 71.1075,-762.202 90,-767.999 152.035,-787.032 171.231,-771.938 236,-767.999 372.674,-759.686 725.592,-736.761 844,-667.999 870.532,-652.591 892.88,-624.591 906.103,-605.408"/>
<polygon fill="#000000" stroke="#000000" points="909.045,-607.305 911.68,-597.043 903.221,-603.422 909.045,-607.305"/>
</g>
<!-- proc~track -->
<g id="proc~~ndmc~~CallsGraph_node6" class="node"><title>proc~track</title>
<g id="a_proc~~ndmc~~CallsGraph_node6"><a xlink:href=".././proc/track.html" xlink:title="track">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-1311 314,-1311 314,-1287 368,-1287 368,-1311"/>
<text text-anchor="middle" x="341" y="-1296.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~track -->
<g id="proc~~ndmc~~CallsGraph_edge5" class="edge"><title>proc~ndmc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M28.4591,-738.235C30.4413,-779.396 40.5864,-915.764 90,-1014 148.853,-1131 267.262,-1238.31 317.082,-1280.3"/>
<polygon fill="#000000" stroke="#000000" points="315.095,-1283.2 325.015,-1286.92 319.581,-1277.82 315.095,-1283.2"/>
</g>
<!-- interface~randind -->
<g id="proc~~ndmc~~CallsGraph_node7" class="node"><title>interface~randind</title>
<g id="a_proc~~ndmc~~CallsGraph_node7"><a xlink:href=".././interface/randind.html" xlink:title="randind">
<polygon fill="#a7506f" stroke="#a7506f" points="825,-636.999 771,-636.999 771,-612.999 825,-612.999 825,-636.999"/>
<text text-anchor="middle" x="798" y="-622.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;interface~randind -->
<g id="proc~~ndmc~~CallsGraph_edge6" class="edge"><title>proc~ndmc&#45;&gt;interface~randind</title>
<path fill="none" stroke="#000000" d="M35.9834,-713.742C46.4454,-698.8 66.2791,-674.054 90,-661.999 190.02,-611.169 227.805,-626.999 340,-626.999 340,-626.999 340,-626.999 514,-626.999 602.67,-626.999 706.964,-626.005 760.787,-625.418"/>
<polygon fill="#000000" stroke="#000000" points="760.899,-628.917 770.859,-625.307 760.821,-621.918 760.899,-628.917"/>
</g>
<!-- proc~init_neutral_population -->
<g id="proc~~ndmc~~CallsGraph_node8" class="node"><title>proc~init_neutral_population</title>
<g id="a_proc~~ndmc~~CallsGraph_node8"><a xlink:href=".././proc/init_neutral_population.html" xlink:title="init_neutral_population">
<polygon fill="#d9534f" stroke="#d9534f" points="223.5,-758.999 102.5,-758.999 102.5,-734.999 223.5,-734.999 223.5,-758.999"/>
<text text-anchor="middle" x="163" y="-744.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_neutral_population</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~init_neutral_population -->
<g id="proc~~ndmc~~CallsGraph_edge7" class="edge"><title>proc~ndmc&#45;&gt;proc~init_neutral_population</title>
<path fill="none" stroke="#000000" d="M54.1547,-730.098C65.248,-731.836 78.757,-733.953 92.4097,-736.093"/>
<polygon fill="#000000" stroke="#000000" points="91.9225,-739.559 102.344,-737.65 93.0064,-732.643 91.9225,-739.559"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_node9" class="node"><title>proc~get_fields</title>
<g id="a_proc~~ndmc~~CallsGraph_node9"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="542,-1499 484,-1499 484,-1475 542,-1475 542,-1499"/>
<text text-anchor="middle" x="513" y="-1484.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_edge8" class="edge"><title>proc~ndmc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M28.1963,-738.25C29.7345,-827.128 41.1153,-1371 90,-1423 191.117,-1530.57 390.434,-1509.47 473.863,-1494.82"/>
<polygon fill="#000000" stroke="#000000" points="474.705,-1498.23 483.915,-1492.99 473.449,-1491.34 474.705,-1498.23"/>
</g>
<!-- proc~gyro_step -->
<g id="proc~~ndmc~~CallsGraph_node10" class="node"><title>proc~gyro_step</title>
<g id="a_proc~~ndmc~~CallsGraph_node10"><a xlink:href=".././proc/gyro_step.html" xlink:title="gyro_step">
<polygon fill="#d9534f" stroke="#d9534f" points="193,-716.999 133,-716.999 133,-692.999 193,-692.999 193,-716.999"/>
<text text-anchor="middle" x="163" y="-702.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_step</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~gyro_step -->
<g id="proc~~ndmc~~CallsGraph_edge9" class="edge"><title>proc~ndmc&#45;&gt;proc~gyro_step</title>
<path fill="none" stroke="#000000" d="M54.1547,-721.9C73.6172,-718.85 100.516,-714.634 122.58,-711.177"/>
<polygon fill="#000000" stroke="#000000" points="123.313,-714.604 132.65,-709.598 122.229,-707.689 123.313,-714.604"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~ndmc~~CallsGraph_node11" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~ndmc~~CallsGraph_node11"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="547,-1415 479,-1415 479,-1391 547,-1391 547,-1415"/>
<text text-anchor="middle" x="513" y="-1400.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~get_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge10" class="edge"><title>proc~ndmc&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M28.9542,-738.088C33.7122,-796.584 56.0049,-1050.31 90,-1121 141.944,-1229.01 172.15,-1253.7 272,-1320 334.023,-1361.18 418.649,-1384.15 469.071,-1395.01"/>
<polygon fill="#000000" stroke="#000000" points="468.482,-1398.46 478.987,-1397.09 469.916,-1391.61 468.482,-1398.46"/>
</g>
<!-- proc~store_births -->
<g id="proc~~ndmc~~CallsGraph_node12" class="node"><title>proc~store_births</title>
<g id="a_proc~~ndmc~~CallsGraph_node12"><a xlink:href=".././proc/store_births.html" xlink:title="store_births">
<polygon fill="#d9534f" stroke="#d9534f" points="197.5,-598.999 128.5,-598.999 128.5,-574.999 197.5,-574.999 197.5,-598.999"/>
<text text-anchor="middle" x="163" y="-584.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_births</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~store_births -->
<g id="proc~~ndmc~~CallsGraph_edge11" class="edge"><title>proc~ndmc&#45;&gt;proc~store_births</title>
<path fill="none" stroke="#000000" d="M31.4544,-713.938C38.6097,-691.044 57.1851,-641.076 90,-612.999 98.1881,-605.993 108.413,-600.816 118.562,-597.014"/>
<polygon fill="#000000" stroke="#000000" points="119.837,-600.277 128.201,-593.774 117.607,-593.642 119.837,-600.277"/>
</g>
<!-- proc~colrad -->
<g id="proc~~ndmc~~CallsGraph_node13" class="node"><title>proc~colrad</title>
<g id="a_proc~~ndmc~~CallsGraph_node13"><a xlink:href=".././proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="190,-1005 136,-1005 136,-980.999 190,-980.999 190,-1005"/>
<text text-anchor="middle" x="163" y="-990.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~colrad -->
<g id="proc~~ndmc~~CallsGraph_edge12" class="edge"><title>proc~ndmc&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M34.1059,-738.165C55.0774,-779.952 124.347,-917.974 151.216,-971.511"/>
<polygon fill="#000000" stroke="#000000" points="148.245,-973.393 155.858,-980.761 154.501,-970.253 148.245,-973.393"/>
</g>
<!-- proc~mc_nbi -->
<g id="proc~~ndmc~~CallsGraph_node14" class="node"><title>proc~mc_nbi</title>
<g id="a_proc~~ndmc~~CallsGraph_node14"><a xlink:href=".././proc/mc_nbi.html" xlink:title="mc_nbi">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-687.999 314,-687.999 314,-663.999 368,-663.999 368,-687.999"/>
<text text-anchor="middle" x="341" y="-673.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_nbi</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~mc_nbi -->
<g id="proc~~ndmc~~CallsGraph_edge13" class="edge"><title>proc~ndmc&#45;&gt;proc~mc_nbi</title>
<path fill="none" stroke="#000000" d="M41.0765,-713.855C52.8697,-703.76 71.2027,-690.097 90,-683.999 162.884,-660.354 254.065,-665.503 303.695,-670.987"/>
<polygon fill="#000000" stroke="#000000" points="303.294,-674.463 313.633,-672.152 304.109,-667.511 303.294,-674.463"/>
</g>
<!-- proc~parallel_merge_populations -->
<g id="proc~~ndmc~~CallsGraph_node15" class="node"><title>proc~parallel_merge_populations</title>
<g id="a_proc~~ndmc~~CallsGraph_node15"><a xlink:href=".././proc/parallel_merge_populations.html" xlink:title="parallel_merge_populations">
<polygon fill="#d9534f" stroke="#d9534f" points="235.5,-377.999 90.5,-377.999 90.5,-353.999 235.5,-353.999 235.5,-377.999"/>
<text text-anchor="middle" x="163" y="-363.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_merge_populations</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~parallel_merge_populations -->
<g id="proc~~ndmc~~CallsGraph_edge14" class="edge"><title>proc~ndmc&#45;&gt;proc~parallel_merge_populations</title>
<path fill="none" stroke="#000000" d="M28.6817,-713.645C31.9127,-659.334 47.3457,-442.241 90,-391.999 92.8062,-388.693 96.0664,-385.808 99.6195,-383.29"/>
<polygon fill="#000000" stroke="#000000" points="101.583,-386.194 108.366,-378.054 97.9877,-380.188 101.583,-386.194"/>
</g>
<!-- proc~update_neutrals -->
<g id="proc~~ndmc~~CallsGraph_node19" class="node"><title>proc~update_neutrals</title>
<g id="a_proc~~ndmc~~CallsGraph_node19"><a xlink:href=".././proc/update_neutrals.html" xlink:title="update_neutrals">
<polygon fill="#d9534f" stroke="#d9534f" points="386,-577.999 296,-577.999 296,-553.999 386,-553.999 386,-577.999"/>
<text text-anchor="middle" x="341" y="-563.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_neutrals</text>
</a>
</g>
</g>
<!-- proc~store_neutrals&#45;&gt;proc~update_neutrals -->
<g id="proc~~ndmc~~CallsGraph_edge15" class="edge"><title>proc~store_neutrals&#45;&gt;proc~update_neutrals</title>
<path fill="none" stroke="#000000" d="M203.937,-549.764C228.112,-552.648 259.267,-556.366 285.664,-559.515"/>
<polygon fill="#000000" stroke="#000000" points="285.552,-563.027 295.896,-560.736 286.382,-556.076 285.552,-563.027"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~ndmc~~CallsGraph_node16" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~ndmc~~CallsGraph_node16"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="711.5,-312.999 620.5,-312.999 620.5,-288.999 711.5,-288.999 711.5,-312.999"/>
<text text-anchor="middle" x="666" y="-298.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~ndmc~~CallsGraph_edge18" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M549.785,-270.478C567.922,-275.283 590.335,-281.22 610.556,-286.577"/>
<polygon fill="#000000" stroke="#000000" points="609.716,-289.975 620.279,-289.152 611.509,-283.208 609.716,-289.975"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~ndmc~~CallsGraph_node17" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~ndmc~~CallsGraph_node17"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="842,-150.999 754,-150.999 754,-126.999 842,-126.999 842,-150.999"/>
<text text-anchor="middle" x="798" y="-136.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~ndmc~~CallsGraph_edge19" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M521.769,-248.825C536.843,-226.389 572.437,-178.904 616,-157.999 655.838,-138.881 706.167,-134.981 743.635,-135.377"/>
<polygon fill="#000000" stroke="#000000" points="743.77,-138.88 753.842,-135.593 743.919,-131.882 743.77,-138.88"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_node18" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~ndmc~~CallsGraph_node18"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="842,-52.9987 754,-52.9987 754,-28.9987 842,-28.9987 842,-52.9987"/>
<text text-anchor="middle" x="798" y="-38.5987" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_edge21" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M516.975,-248.824C525.773,-215.567 554.957,-122.691 616,-77.9987 652.941,-50.9529 704.96,-42.5646 743.758,-40.4359"/>
<polygon fill="#000000" stroke="#000000" points="743.981,-43.9297 753.822,-40.0064 743.682,-36.9361 743.981,-43.9297"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~ndmc~~CallsGraph_node22" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~ndmc~~CallsGraph_node22"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="710,-30.9987 622,-30.9987 622,-6.9987 710,-6.9987 710,-30.9987"/>
<text text-anchor="middle" x="666" y="-16.5987" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~ndmc~~CallsGraph_edge17" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M516.809,-248.939C525.611,-213.489 555.729,-108.15 616,-44.9987 618.992,-41.8637 622.446,-39.0275 626.108,-36.4819"/>
<polygon fill="#000000" stroke="#000000" points="628.226,-39.2881 634.907,-31.0656 624.556,-33.3268 628.226,-39.2881"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_node23" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~ndmc~~CallsGraph_node23"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="843.5,-268.999 752.5,-268.999 752.5,-244.999 843.5,-244.999 843.5,-268.999"/>
<text text-anchor="middle" x="798" y="-254.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge20" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M549.556,-260.496C597.911,-259.813 684.889,-258.583 741.776,-257.779"/>
<polygon fill="#000000" stroke="#000000" points="742.082,-261.275 752.032,-257.634 741.984,-254.276 742.082,-261.275"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~ndmc~~CallsGraph_node24" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~ndmc~~CallsGraph_node24"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="711.5,-232.999 620.5,-232.999 620.5,-208.999 711.5,-208.999 711.5,-232.999"/>
<text text-anchor="middle" x="666" y="-218.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~ndmc~~CallsGraph_edge22" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M549.785,-251.519C567.922,-246.715 590.335,-240.778 610.556,-235.421"/>
<polygon fill="#000000" stroke="#000000" points="611.509,-238.789 620.279,-232.845 609.716,-232.023 611.509,-238.789"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~ndmc~~CallsGraph_node29" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~ndmc~~CallsGraph_node29"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="710,-110.999 622,-110.999 622,-86.9987 710,-86.9987 710,-110.999"/>
<text text-anchor="middle" x="666" y="-96.5987" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~ndmc~~CallsGraph_edge25" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M520.715,-248.679C535.231,-222.955 571.815,-162.79 616,-124.999 619.737,-121.802 623.933,-118.847 628.255,-116.163"/>
<polygon fill="#000000" stroke="#000000" points="630.259,-119.049 637.201,-111.046 626.783,-112.973 630.259,-119.049"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~ndmc~~CallsGraph_node30" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~ndmc~~CallsGraph_node30"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="711.5,-190.999 620.5,-190.999 620.5,-166.999 711.5,-166.999 711.5,-190.999"/>
<text text-anchor="middle" x="666" y="-176.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~ndmc~~CallsGraph_edge16" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.374,-248.987C552.476,-236.09 585.86,-215.382 616,-199.999 619.145,-198.393 622.442,-196.8 625.774,-195.251"/>
<polygon fill="#000000" stroke="#000000" points="627.481,-198.321 635.166,-191.028 624.61,-191.937 627.481,-198.321"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~ndmc~~CallsGraph_node34" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~ndmc~~CallsGraph_node34"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="711.5,-354.999 620.5,-354.999 620.5,-330.999 711.5,-330.999 711.5,-354.999"/>
<text text-anchor="middle" x="666" y="-340.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~ndmc~~CallsGraph_edge23" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.374,-273.01C552.476,-285.907 585.86,-306.615 616,-321.999 619.145,-323.604 622.442,-325.198 625.774,-326.747"/>
<polygon fill="#000000" stroke="#000000" points="624.61,-330.061 635.166,-330.969 627.481,-323.676 624.61,-330.061"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~ndmc~~CallsGraph_node36" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~ndmc~~CallsGraph_node36"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="843.5,-404.999 752.5,-404.999 752.5,-380.999 843.5,-380.999 843.5,-404.999"/>
<text text-anchor="middle" x="798" y="-390.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~ndmc~~CallsGraph_edge24" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M522.119,-273.299C537.509,-295.509 573.244,-342.034 616,-363.999 655.071,-384.071 704.626,-390.929 742.002,-392.987"/>
<polygon fill="#000000" stroke="#000000" points="742.055,-396.493 752.202,-393.447 742.37,-389.5 742.055,-396.493"/>
</g>
<!-- proc~store_photons -->
<g id="proc~~ndmc~~CallsGraph_node41" class="node"><title>proc~store_photons</title>
<g id="a_proc~~ndmc~~CallsGraph_node41"><a xlink:href=".././proc/store_photons.html" xlink:title="store_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="381.5,-1414 300.5,-1414 300.5,-1390 381.5,-1390 381.5,-1414"/>
<text text-anchor="middle" x="341" y="-1399.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_photons</text>
</a>
</g>
</g>
<!-- proc~store_nbi_photons&#45;&gt;proc~store_photons -->
<g id="proc~~ndmc~~CallsGraph_edge26" class="edge"><title>proc~store_nbi_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M213.964,-1402C237.778,-1402 266.193,-1402 290.01,-1402"/>
<polygon fill="#000000" stroke="#000000" points="290.252,-1405.5 300.252,-1402 290.252,-1398.5 290.252,-1405.5"/>
</g>
<!-- proc~track&#45;&gt;proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_edge30" class="edge"><title>proc~track&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M354.076,-1311.18C368.746,-1326.47 393.565,-1353.98 410,-1381 431.321,-1416.05 415.679,-1438.36 446,-1466 453.798,-1473.11 464.005,-1477.81 474.053,-1480.92"/>
<polygon fill="#000000" stroke="#000000" points="473.391,-1484.36 483.953,-1483.53 475.176,-1477.6 473.391,-1484.36"/>
</g>
<!-- proc~track&#45;&gt;proc~get_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge31" class="edge"><title>proc~track&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M360.758,-1311.08C374.747,-1320.37 394.102,-1333.8 410,-1347 427.168,-1361.25 426.856,-1370.53 446,-1382 453.114,-1386.26 461.184,-1389.75 469.179,-1392.57"/>
<polygon fill="#000000" stroke="#000000" points="468.234,-1395.95 478.826,-1395.69 470.389,-1389.29 468.234,-1395.95"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_node20" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~ndmc~~CallsGraph_node20"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="696.5,-1300 635.5,-1300 635.5,-1276 696.5,-1276 696.5,-1300"/>
<text text-anchor="middle" x="666" y="-1285.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge27" class="edge"><title>proc~track&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M368.159,-1298.11C424.612,-1296.19 558.169,-1291.64 625.189,-1289.35"/>
<polygon fill="#000000" stroke="#000000" points="625.477,-1292.85 635.352,-1289.01 625.238,-1285.85 625.477,-1292.85"/>
</g>
<!-- proc~get_indices -->
<g id="proc~~ndmc~~CallsGraph_node35" class="node"><title>proc~get_indices</title>
<g id="a_proc~~ndmc~~CallsGraph_node35"><a xlink:href=".././proc/get_indices.html" xlink:title="get_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="546.5,-1331 479.5,-1331 479.5,-1307 546.5,-1307 546.5,-1331"/>
<text text-anchor="middle" x="513" y="-1316.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_indices</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~get_indices -->
<g id="proc~~ndmc~~CallsGraph_edge28" class="edge"><title>proc~track&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M368.19,-1302.08C395.051,-1305.24 437.28,-1310.21 469.041,-1313.94"/>
<polygon fill="#000000" stroke="#000000" points="469.033,-1317.47 479.374,-1315.16 469.851,-1310.52 469.033,-1317.47"/>
</g>
<!-- proc~doppler_stark -->
<g id="proc~~ndmc~~CallsGraph_node39" class="node"><title>proc~doppler_stark</title>
<g id="a_proc~~ndmc~~CallsGraph_node39"><a xlink:href=".././proc/doppler_stark.html" xlink:title="doppler_stark">
<polygon fill="#d9534f" stroke="#d9534f" points="552,-1251 474,-1251 474,-1227 552,-1227 552,-1251"/>
<text text-anchor="middle" x="513" y="-1236.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">doppler_stark</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~doppler_stark -->
<g id="proc~~ndmc~~CallsGraph_edge29" class="edge"><title>proc~track&#45;&gt;proc~doppler_stark</title>
<path fill="none" stroke="#000000" d="M368.19,-1289.76C394.862,-1280.34 436.688,-1265.58 468.371,-1254.4"/>
<polygon fill="#000000" stroke="#000000" points="469.585,-1257.68 477.85,-1251.05 467.256,-1251.08 469.585,-1257.68"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge33" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M542.285,-1483.35C555.06,-1480.46 569.588,-1475.28 580,-1466 609.106,-1440.06 599.278,-1421.22 616,-1386 628.632,-1359.39 643.909,-1329.12 654.01,-1309.35"/>
<polygon fill="#000000" stroke="#000000" points="657.204,-1310.79 658.649,-1300.3 650.974,-1307.6 657.204,-1310.79"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~ndmc~~CallsGraph_node27" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~ndmc~~CallsGraph_node27"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="716,-1499 616,-1499 616,-1475 716,-1475 716,-1499"/>
<text text-anchor="middle" x="666" y="-1484.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~ndmc~~CallsGraph_edge34" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M542.048,-1487C559.866,-1487 583.614,-1487 605.486,-1487"/>
<polygon fill="#000000" stroke="#000000" points="605.706,-1490.5 615.706,-1487 605.705,-1483.5 605.706,-1490.5"/>
</g>
<!-- proc~get_position -->
<g id="proc~~ndmc~~CallsGraph_node31" class="node"><title>proc~get_position</title>
<g id="a_proc~~ndmc~~CallsGraph_node31"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="701,-1419 631,-1419 631,-1395 701,-1395 701,-1419"/>
<text text-anchor="middle" x="666" y="-1404.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~ndmc~~CallsGraph_edge32" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M542.093,-1480.95C554.257,-1477.61 568.346,-1472.75 580,-1466 598.782,-1455.12 598.271,-1445.52 616,-1433 620.523,-1429.8 625.486,-1426.73 630.464,-1423.89"/>
<polygon fill="#000000" stroke="#000000" points="632.244,-1426.91 639.347,-1419.05 628.892,-1420.76 632.244,-1426.91"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_node40" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~ndmc~~CallsGraph_node40"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="954,-1479 886,-1479 886,-1455 954,-1455 954,-1479"/>
<text text-anchor="middle" x="920" y="-1464.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge35" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M542.338,-1494.45C562.674,-1499.39 590.819,-1505.43 616,-1508 660.216,-1512.5 671.776,-1512.42 716,-1508 771.903,-1502.41 835.193,-1488.37 876.024,-1478.28"/>
<polygon fill="#000000" stroke="#000000" points="877.052,-1481.63 885.903,-1475.8 875.352,-1474.84 877.052,-1481.63"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_node42" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~ndmc~~CallsGraph_node42"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="832,-1339 764,-1339 764,-1315 832,-1315 832,-1339"/>
<text text-anchor="middle" x="798" y="-1324.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge36" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M542.369,-1480.93C590.877,-1470.2 687.302,-1447.19 716,-1428 720.212,-1425.18 758.688,-1376.21 781.062,-1347.51"/>
<polygon fill="#000000" stroke="#000000" points="784.051,-1349.37 787.432,-1339.33 778.527,-1345.07 784.051,-1349.37"/>
</g>
<!-- proc~cross_product -->
<g id="proc~~ndmc~~CallsGraph_node33" class="node"><title>proc~cross_product</title>
<g id="a_proc~~ndmc~~CallsGraph_node33"><a xlink:href=".././proc/cross_product.html" xlink:title="cross_product">
<polygon fill="#d94e8f" stroke="#d94e8f" points="381,-729.999 301,-729.999 301,-705.999 381,-705.999 381,-729.999"/>
<text text-anchor="middle" x="341" y="-715.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cross_product</text>
</a>
</g>
</g>
<!-- proc~gyro_step&#45;&gt;proc~cross_product -->
<g id="proc~~ndmc~~CallsGraph_edge37" class="edge"><title>proc~gyro_step&#45;&gt;proc~cross_product</title>
<path fill="none" stroke="#000000" d="M193.063,-707.145C219.466,-709.096 258.97,-712.014 290.37,-714.333"/>
<polygon fill="#000000" stroke="#000000" points="290.446,-717.848 300.677,-715.094 290.962,-710.867 290.446,-717.848"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge38" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M547.01,-1397.76C558.412,-1394.66 570.656,-1389.76 580,-1382 606.009,-1360.41 592.224,-1339.03 616,-1315 619.488,-1311.47 623.535,-1308.28 627.778,-1305.43"/>
<polygon fill="#000000" stroke="#000000" points="629.91,-1308.23 636.647,-1300.05 626.281,-1302.24 629.91,-1308.23"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~ndmc~~CallsGraph_edge40" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M547.138,-1403.88C568.766,-1404.45 597.252,-1405.2 620.801,-1405.83"/>
<polygon fill="#000000" stroke="#000000" points="620.804,-1409.33 630.893,-1406.1 620.99,-1402.33 620.804,-1409.33"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge39" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M547.118,-1391.93C608.612,-1373.35 743.33,-1342.01 844,-1386 871.896,-1398.19 894.049,-1426.43 906.846,-1446.12"/>
<polygon fill="#000000" stroke="#000000" points="903.951,-1448.09 912.207,-1454.73 909.893,-1444.39 903.951,-1448.09"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge41" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M547.201,-1395.05C558.008,-1391.78 569.832,-1387.46 580,-1382 598.098,-1372.27 597.16,-1361.2 616,-1353 660.303,-1333.72 715.9,-1328.18 753.705,-1326.85"/>
<polygon fill="#000000" stroke="#000000" points="753.969,-1330.34 763.872,-1326.58 753.782,-1323.35 753.969,-1330.34"/>
</g>
<!-- proc~eigen -->
<g id="proc~~ndmc~~CallsGraph_node21" class="node"><title>proc~eigen</title>
<g id="a_proc~~ndmc~~CallsGraph_node21"><a xlink:href=".././proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-943.999 314,-943.999 314,-919.999 368,-919.999 368,-943.999"/>
<text text-anchor="middle" x="341" y="-929.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~ndmc~~CallsGraph_edge43" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M190.349,-983.866C220.635,-973.37 270.499,-956.087 304.264,-944.384"/>
<polygon fill="#000000" stroke="#000000" points="305.456,-947.676 313.759,-941.094 303.164,-941.062 305.456,-947.676"/>
</g>
<!-- proc~linsolve -->
<g id="proc~~ndmc~~CallsGraph_node32" class="node"><title>proc~linsolve</title>
<g id="a_proc~~ndmc~~CallsGraph_node32"><a xlink:href=".././proc/linsolve.html" xlink:title="linsolve">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-1103 314,-1103 314,-1079 368,-1079 368,-1103"/>
<text text-anchor="middle" x="341" y="-1088.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linsolve</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~linsolve -->
<g id="proc~~ndmc~~CallsGraph_edge44" class="edge"><title>proc~colrad&#45;&gt;proc~linsolve</title>
<path fill="none" stroke="#000000" d="M185.581,-1005.02C216.589,-1022.28 273.902,-1054.19 309.309,-1073.91"/>
<polygon fill="#000000" stroke="#000000" points="307.803,-1077.08 318.242,-1078.88 311.208,-1070.96 307.803,-1077.08"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~ndmc~~CallsGraph_node37" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~ndmc~~CallsGraph_node37"><a xlink:href=".././proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="385,-1031 297,-1031 297,-1007 385,-1007 385,-1031"/>
<text text-anchor="middle" x="341" y="-1016.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~ndmc~~CallsGraph_edge42" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M190.349,-996.891C215.702,-1000.64 254.776,-1006.41 286.64,-1011.12"/>
<polygon fill="#000000" stroke="#000000" points="286.301,-1014.6 296.705,-1012.6 287.324,-1007.68 286.301,-1014.6"/>
</g>
<!-- proc~mc_nbi&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge45" class="edge"><title>proc~mc_nbi&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M368.188,-676.531C458.472,-678.041 756.029,-680.246 844,-645.999 866.698,-637.162 887.764,-618.741 901.754,-604.442"/>
<polygon fill="#000000" stroke="#000000" points="904.449,-606.685 908.763,-597.009 899.356,-601.883 904.449,-606.685"/>
</g>
<!-- proc~mc_nbi&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge46" class="edge"><title>proc~mc_nbi&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M368.196,-677.23C382.782,-679.376 399.97,-684.611 410,-696.999 466.023,-766.189 389.178,-1027.46 446,-1096 485.51,-1143.65 536.49,-1089.96 580,-1134 623.042,-1177.56 575.845,-1220.76 616,-1267 618.868,-1270.3 622.346,-1273.1 626.112,-1275.47"/>
<polygon fill="#000000" stroke="#000000" points="624.784,-1278.72 635.268,-1280.25 628.023,-1272.52 624.784,-1278.72"/>
</g>
<!-- interface~randn -->
<g id="proc~~ndmc~~CallsGraph_node26" class="node"><title>interface~randn</title>
<g id="a_proc~~ndmc~~CallsGraph_node26"><a xlink:href=".././interface/randn.html" xlink:title="randn">
<polygon fill="#a7506f" stroke="#a7506f" points="540,-716.999 486,-716.999 486,-692.999 540,-692.999 540,-716.999"/>
<text text-anchor="middle" x="513" y="-702.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randn</text>
</a>
</g>
</g>
<!-- proc~mc_nbi&#45;&gt;interface~randn -->
<g id="proc~~ndmc~~CallsGraph_edge47" class="edge"><title>proc~mc_nbi&#45;&gt;interface~randn</title>
<path fill="none" stroke="#000000" d="M368.19,-680.466C397.016,-685.384 443.543,-693.321 475.836,-698.83"/>
<polygon fill="#000000" stroke="#000000" points="475.334,-702.294 485.78,-700.526 476.511,-695.394 475.334,-702.294"/>
</g>
<!-- proc~grid_intersect -->
<g id="proc~~ndmc~~CallsGraph_node28" class="node"><title>proc~grid_intersect</title>
<g id="a_proc~~ndmc~~CallsGraph_node28"><a xlink:href=".././proc/grid_intersect.html" xlink:title="grid_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="551.5,-796.999 474.5,-796.999 474.5,-772.999 551.5,-772.999 551.5,-796.999"/>
<text text-anchor="middle" x="513" y="-782.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">grid_intersect</text>
</a>
</g>
</g>
<!-- proc~mc_nbi&#45;&gt;proc~grid_intersect -->
<g id="proc~~ndmc~~CallsGraph_edge48" class="edge"><title>proc~mc_nbi&#45;&gt;proc~grid_intersect</title>
<path fill="none" stroke="#000000" d="M368.201,-681.401C381.277,-684.753 397.029,-689.816 410,-696.999 419.032,-702 464.129,-741.966 491.244,-766.285"/>
<polygon fill="#000000" stroke="#000000" points="488.918,-768.901 498.696,-772.981 493.596,-763.694 488.918,-768.901"/>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_edge50" class="edge"><title>proc~parallel_merge_populations&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M203.92,-353.954C269.178,-334.264 398.278,-295.311 466.805,-274.635"/>
<polygon fill="#000000" stroke="#000000" points="467.899,-277.961 476.462,-271.721 465.877,-271.259 467.899,-277.961"/>
</g>
<!-- proc~ind2sub -->
<g id="proc~~ndmc~~CallsGraph_node25" class="node"><title>proc~ind2sub</title>
<g id="a_proc~~ndmc~~CallsGraph_node25"><a xlink:href=".././proc/ind2sub.html" xlink:title="ind2sub">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-377.999 314,-377.999 314,-353.999 368,-353.999 368,-377.999"/>
<text text-anchor="middle" x="341" y="-363.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ind2sub</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;proc~ind2sub -->
<g id="proc~~ndmc~~CallsGraph_edge51" class="edge"><title>proc~parallel_merge_populations&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M235.586,-365.999C258.98,-365.999 283.98,-365.999 303.65,-365.999"/>
<polygon fill="#000000" stroke="#000000" points="303.699,-369.499 313.699,-365.999 303.699,-362.499 303.699,-369.499"/>
</g>
<!-- proc~parallel_merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_node38" class="node"><title>proc~parallel_merge_reservoirs</title>
<g id="a_proc~~ndmc~~CallsGraph_node38"><a xlink:href=".././proc/parallel_merge_reservoirs.html" xlink:title="parallel_merge_reservoirs">
<polygon fill="#d9534f" stroke="#d9534f" points="409.5,-457.999 272.5,-457.999 272.5,-433.999 409.5,-433.999 409.5,-457.999"/>
<text text-anchor="middle" x="341" y="-443.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_merge_reservoirs</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;proc~parallel_merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_edge49" class="edge"><title>proc~parallel_merge_populations&#45;&gt;proc~parallel_merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M190.731,-378.149C221.014,-391.914 270.514,-414.414 304.136,-429.697"/>
<polygon fill="#000000" stroke="#000000" points="303.042,-433.044 313.595,-433.996 305.939,-426.672 303.042,-433.044"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge52" class="edge"><title>proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M702.523,-288.976C717.714,-283.834 735.629,-277.77 751.753,-272.313"/>
<polygon fill="#000000" stroke="#000000" points="753.17,-275.529 761.52,-269.007 750.926,-268.898 753.17,-275.529"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_node46" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="959.5,-209.999 880.5,-209.999 880.5,-185.999 959.5,-185.999 959.5,-209.999"/>
<text text-anchor="middle" x="920" y="-195.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge53" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M711.794,-309.94C749.236,-315.108 802.949,-317.002 844,-295.999 875.876,-279.69 898.097,-242.908 909.684,-219.335"/>
<polygon fill="#000000" stroke="#000000" points="912.919,-220.679 913.996,-210.139 906.581,-217.708 912.919,-220.679"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge54" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M823.573,-151.081C841.369,-159.83 865.643,-171.765 885.255,-181.407"/>
<polygon fill="#000000" stroke="#000000" points="883.941,-184.662 894.46,-185.933 887.03,-178.38 883.941,-184.662"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_edge55" class="edge"><title>proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M777.828,-53.0126C770.784,-61.9704 777.508,-70.9987 798,-70.9987 810.487,-70.9987 817.862,-67.6461 820.124,-63"/>
<polygon fill="#000000" stroke="#000000" points="823.526,-62.1553 818.172,-53.0126 816.656,-63.4983 823.526,-62.1553"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge56" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M812.741,-53.0214C822.061,-61.5036 834.387,-73.3819 844,-84.9987 868.936,-115.132 893.089,-153.738 906.977,-177.133"/>
<polygon fill="#000000" stroke="#000000" points="904.027,-179.022 912.107,-185.875 910.064,-175.479 904.027,-179.022"/>
</g>
<!-- proc~update_reservoir -->
<g id="proc~~ndmc~~CallsGraph_node48" class="node"><title>proc~update_reservoir</title>
<g id="a_proc~~ndmc~~CallsGraph_node48"><a xlink:href=".././proc/update_reservoir.html" xlink:title="update_reservoir">
<polygon fill="#d9534f" stroke="#d9534f" points="713,-598.999 619,-598.999 619,-574.999 713,-574.999 713,-598.999"/>
<text text-anchor="middle" x="666" y="-584.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_reservoir</text>
</a>
</g>
</g>
<!-- proc~update_neutrals&#45;&gt;proc~update_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge57" class="edge"><title>proc~update_neutrals&#45;&gt;proc~update_reservoir</title>
<path fill="none" stroke="#000000" d="M386.235,-568.875C444.09,-572.636 545.508,-579.23 608.76,-583.342"/>
<polygon fill="#000000" stroke="#000000" points="608.749,-586.849 618.955,-584.005 609.203,-579.864 608.749,-586.849"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge60" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M696.825,-1296.95C713.727,-1302.02 735.17,-1308.45 753.876,-1314.06"/>
<polygon fill="#000000" stroke="#000000" points="753.071,-1317.47 763.655,-1317 755.082,-1310.77 753.071,-1317.47"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_node54" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~ndmc~~CallsGraph_node54"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="952.5,-1359 887.5,-1359 887.5,-1335 952.5,-1335 952.5,-1359"/>
<text text-anchor="middle" x="920" y="-1344.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge58" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M696.525,-1287.46C732.251,-1287.61 793.849,-1290.44 844,-1306 861.323,-1311.37 879.201,-1320.96 893.155,-1329.52"/>
<polygon fill="#000000" stroke="#000000" points="891.392,-1332.54 901.713,-1334.93 895.136,-1326.63 891.392,-1332.54"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~ndmc~~CallsGraph_node59" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~ndmc~~CallsGraph_node59"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="836.5,-1175 759.5,-1175 759.5,-1151 836.5,-1151 836.5,-1175"/>
<text text-anchor="middle" x="798" y="-1160.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~ndmc~~CallsGraph_edge59" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M696.578,-1278.17C703.328,-1275.17 710.21,-1271.46 716,-1267 746.103,-1243.78 771.244,-1206.91 785.188,-1183.87"/>
<polygon fill="#000000" stroke="#000000" points="788.23,-1185.6 790.297,-1175.21 782.201,-1182.05 788.23,-1185.6"/>
</g>
<!-- proc~balback -->
<g id="proc~~ndmc~~CallsGraph_node44" class="node"><title>proc~balback</title>
<g id="a_proc~~ndmc~~CallsGraph_node44"><a xlink:href=".././proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-922.999 486,-922.999 486,-898.999 540,-898.999 540,-922.999"/>
<text text-anchor="middle" x="513" y="-908.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~ndmc~~CallsGraph_edge61" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M368.19,-928.763C397.016,-925.203 443.543,-919.455 475.836,-915.466"/>
<polygon fill="#000000" stroke="#000000" points="476.285,-918.937 485.78,-914.238 475.427,-911.99 476.285,-918.937"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~ndmc~~CallsGraph_node45" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~ndmc~~CallsGraph_node45"><a xlink:href=".././proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-1007 486,-1007 486,-982.999 540,-982.999 540,-1007"/>
<text text-anchor="middle" x="513" y="-992.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~ndmc~~CallsGraph_edge62" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M368.289,-943.259C389.189,-952.054 419.255,-964.359 446,-973.999 455.655,-977.479 466.208,-980.972 475.988,-984.084"/>
<polygon fill="#000000" stroke="#000000" points="475.24,-987.518 485.829,-987.172 477.335,-980.839 475.24,-987.518"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~ndmc~~CallsGraph_node50" class="node"><title>proc~elmhes</title>
<g id="a_proc~~ndmc~~CallsGraph_node50"><a xlink:href=".././proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-880.999 486,-880.999 486,-856.999 540,-856.999 540,-880.999"/>
<text text-anchor="middle" x="513" y="-866.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~ndmc~~CallsGraph_edge63" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M368.289,-920.739C389.189,-911.944 419.255,-899.639 446,-889.999 455.655,-886.519 466.208,-883.025 475.988,-879.913"/>
<polygon fill="#000000" stroke="#000000" points="477.335,-883.159 485.829,-876.826 475.24,-876.48 477.335,-883.159"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~ndmc~~CallsGraph_node52" class="node"><title>proc~hqr2</title>
<g id="a_proc~~ndmc~~CallsGraph_node52"><a xlink:href=".././proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-964.999 486,-964.999 486,-940.999 540,-940.999 540,-964.999"/>
<text text-anchor="middle" x="513" y="-950.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~ndmc~~CallsGraph_edge64" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M368.19,-935.234C397.016,-938.795 443.543,-944.542 475.836,-948.531"/>
<polygon fill="#000000" stroke="#000000" points="475.427,-952.007 485.78,-949.76 476.285,-945.06 475.427,-952.007"/>
</g>
<!-- proc~balance -->
<g id="proc~~ndmc~~CallsGraph_node62" class="node"><title>proc~balance</title>
<g id="a_proc~~ndmc~~CallsGraph_node62"><a xlink:href=".././proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-838.999 486,-838.999 486,-814.999 540,-814.999 540,-838.999"/>
<text text-anchor="middle" x="513" y="-824.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~ndmc~~CallsGraph_edge65" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M354.024,-919.72C372.336,-901.655 409.008,-867.907 446,-847.999 455.291,-842.998 465.967,-838.958 475.988,-835.808"/>
<polygon fill="#000000" stroke="#000000" points="477.105,-839.128 485.713,-832.952 475.132,-832.412 477.105,-839.128"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_edge66" class="edge"><title>proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M710.288,-26.3244C721.033,-28.1427 732.671,-30.1123 743.829,-32.0005"/>
<polygon fill="#000000" stroke="#000000" points="743.457,-35.4873 753.901,-33.705 744.625,-28.5854 743.457,-35.4873"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge67" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M709.417,-6.98979C747.859,1.2417 804.391,6.45523 844,-19.9987 896.906,-55.3329 912.587,-136.055 917.16,-175.487"/>
<polygon fill="#000000" stroke="#000000" points="913.701,-176.064 918.196,-185.658 920.665,-175.354 913.701,-176.064"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge68" class="edge"><title>proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M777.828,-269.013C770.784,-277.97 777.508,-286.999 798,-286.999 810.487,-286.999 817.862,-283.646 820.124,-279"/>
<polygon fill="#000000" stroke="#000000" points="823.526,-278.155 818.172,-269.013 816.656,-279.498 823.526,-278.155"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge69" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M823.573,-244.917C841.369,-236.167 865.643,-224.232 885.255,-214.59"/>
<polygon fill="#000000" stroke="#000000" points="887.03,-217.618 894.46,-210.064 883.941,-211.336 887.03,-217.618"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge70" class="edge"><title>proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M710.65,-233.086C721.154,-235.995 732.495,-239.136 743.395,-242.154"/>
<polygon fill="#000000" stroke="#000000" points="742.673,-245.586 753.244,-244.882 744.541,-238.84 742.673,-245.586"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge71" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M711.762,-216.913C756.337,-212.845 824.56,-206.618 870.427,-202.432"/>
<polygon fill="#000000" stroke="#000000" points="870.79,-205.913 880.43,-201.519 870.154,-198.942 870.79,-205.913"/>
</g>
<!-- proc~in_passive_grid -->
<g id="proc~~ndmc~~CallsGraph_node55" class="node"><title>proc~in_passive_grid</title>
<g id="a_proc~~ndmc~~CallsGraph_node55"><a xlink:href=".././proc/in_passive_grid.html" xlink:title="in_passive_grid">
<polygon fill="#d94e8f" stroke="#d94e8f" points="709.5,-828.999 622.5,-828.999 622.5,-804.999 709.5,-804.999 709.5,-828.999"/>
<text text-anchor="middle" x="666" y="-814.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_passive_grid</text>
</a>
</g>
</g>
<!-- proc~grid_intersect&#45;&gt;proc~in_passive_grid -->
<g id="proc~~ndmc~~CallsGraph_edge72" class="edge"><title>proc~grid_intersect&#45;&gt;proc~in_passive_grid</title>
<path fill="none" stroke="#000000" d="M551.714,-792.991C570.097,-796.887 592.507,-801.636 612.528,-805.879"/>
<polygon fill="#000000" stroke="#000000" points="611.932,-809.33 622.44,-807.979 613.383,-802.482 611.932,-809.33"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_edge73" class="edge"><title>proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M693.936,-86.9811C713.284,-78.3489 739.579,-66.6171 760.767,-57.1644"/>
<polygon fill="#000000" stroke="#000000" points="762.392,-60.2717 770.098,-53.0009 759.54,-53.8791 762.392,-60.2717"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge74" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M710.084,-95.4847C747.438,-94.2773 801.954,-97.0472 844,-117.999 870.797,-131.352 892.975,-158.49 906.095,-177.437"/>
<polygon fill="#000000" stroke="#000000" points="903.332,-179.602 911.789,-185.984 909.158,-175.721 903.332,-179.602"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge75" class="edge"><title>proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M697.794,-191.031C703.938,-193.755 710.262,-196.796 716,-199.999 736.397,-211.383 757.955,-226.735 773.698,-238.639"/>
<polygon fill="#000000" stroke="#000000" points="771.736,-241.545 781.802,-244.85 775.995,-235.989 771.736,-241.545"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge76" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M711.762,-182.374C756.337,-185.734 824.56,-190.878 870.427,-194.336"/>
<polygon fill="#000000" stroke="#000000" points="870.195,-197.829 880.43,-195.091 870.722,-190.849 870.195,-197.829"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_node51" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~ndmc~~CallsGraph_node51"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="829,-1419 767,-1419 767,-1395 829,-1395 829,-1419"/>
<text text-anchor="middle" x="798" y="-1404.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge77" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M701.156,-1407C718.135,-1407 738.77,-1407 756.537,-1407"/>
<polygon fill="#000000" stroke="#000000" points="756.618,-1410.5 766.618,-1407 756.618,-1403.5 756.618,-1410.5"/>
</g>
<!-- proc~matinv -->
<g id="proc~~ndmc~~CallsGraph_node53" class="node"><title>proc~matinv</title>
<g id="a_proc~~ndmc~~CallsGraph_node53"><a xlink:href=".././proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-1087 486,-1087 486,-1063 540,-1063 540,-1087"/>
<text text-anchor="middle" x="513" y="-1072.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~linsolve&#45;&gt;proc~matinv -->
<g id="proc~~ndmc~~CallsGraph_edge78" class="edge"><title>proc~linsolve&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M368.19,-1088.53C396.892,-1085.83 443.14,-1081.48 475.416,-1078.44"/>
<polygon fill="#000000" stroke="#000000" points="476.152,-1081.89 485.78,-1077.47 475.496,-1074.92 476.152,-1081.89"/>
</g>
<!-- dgetrf -->
<g id="proc~~ndmc~~CallsGraph_node56" class="node"><title>dgetrf</title>
<polygon fill="#777777" stroke="#777777" points="540,-1209 486,-1209 486,-1185 540,-1185 540,-1209"/>
<text text-anchor="middle" x="513" y="-1194.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrf</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrf -->
<g id="proc~~ndmc~~CallsGraph_edge79" class="edge"><title>proc~linsolve&#45;&gt;dgetrf</title>
<path fill="none" stroke="#000000" d="M353.693,-1103.13C371.863,-1121.35 408.687,-1155.78 446,-1176 455.277,-1181.03 465.948,-1185.07 475.969,-1188.22"/>
<polygon fill="#000000" stroke="#000000" points="475.115,-1191.62 485.696,-1191.08 477.086,-1184.9 475.115,-1191.62"/>
</g>
<!-- dgetrs -->
<g id="proc~~ndmc~~CallsGraph_node57" class="node"><title>dgetrs</title>
<polygon fill="#777777" stroke="#777777" points="540,-1167 486,-1167 486,-1143 540,-1143 540,-1167"/>
<text text-anchor="middle" x="513" y="-1152.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrs</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrs -->
<g id="proc~~ndmc~~CallsGraph_edge80" class="edge"><title>proc~linsolve&#45;&gt;dgetrs</title>
<path fill="none" stroke="#000000" d="M368.19,-1100.86C397.141,-1111.76 443.946,-1129.38 476.255,-1141.54"/>
<polygon fill="#000000" stroke="#000000" points="475.188,-1144.88 485.78,-1145.13 477.655,-1138.33 475.188,-1144.88"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge81" class="edge"><title>proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M698.734,-330.897C704.617,-328.237 710.604,-325.238 716,-321.999 738.117,-308.724 760.811,-289.987 776.529,-276.038"/>
<polygon fill="#000000" stroke="#000000" points="778.991,-278.531 784.073,-269.234 774.303,-273.332 778.991,-278.531"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge82" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M711.698,-347.045C749.83,-348.274 804.583,-344.562 844,-318.999 880.222,-295.507 901.932,-247.736 912.07,-219.758"/>
<polygon fill="#000000" stroke="#000000" points="915.45,-220.69 915.395,-210.096 908.831,-218.413 915.45,-220.69"/>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge83" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M826.251,-380.918C832.659,-377.146 839.054,-372.501 844,-366.999 883.505,-323.057 904.975,-254.929 913.921,-220.116"/>
<polygon fill="#000000" stroke="#000000" points="917.406,-220.603 916.393,-210.057 910.608,-218.933 917.406,-220.603"/>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~ndmc~~CallsGraph_edge84" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M385.153,-1018.7C471.143,-1018.8 660.373,-1022.7 716,-1054 751.191,-1073.8 775.549,-1115.89 787.818,-1141.59"/>
<polygon fill="#000000" stroke="#000000" points="784.719,-1143.23 792.062,-1150.86 791.084,-1140.31 784.719,-1143.23"/>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_edge85" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M385.947,-433.911C394.472,-430.309 402.94,-425.741 410,-419.999 456.808,-381.929 489.016,-316.464 503.436,-282.637"/>
<polygon fill="#000000" stroke="#000000" points="506.743,-283.799 507.336,-273.22 500.276,-281.12 506.743,-283.799"/>
</g>
<!-- proc~merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_node47" class="node"><title>proc~merge_reservoirs</title>
<g id="a_proc~~ndmc~~CallsGraph_node47"><a xlink:href=".././proc/merge_reservoirs.html" xlink:title="merge_reservoirs">
<polygon fill="#d9534f" stroke="#d9534f" points="561.5,-499.999 464.5,-499.999 464.5,-475.999 561.5,-475.999 561.5,-499.999"/>
<text text-anchor="middle" x="513" y="-485.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">merge_reservoirs</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_edge86" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M390.715,-458.034C410.614,-462.95 433.779,-468.674 454.5,-473.793"/>
<polygon fill="#000000" stroke="#000000" points="453.904,-477.251 464.451,-476.251 455.583,-470.455 453.904,-477.251"/>
</g>
<!-- proc~num_ranks -->
<g id="proc~~ndmc~~CallsGraph_node49" class="node"><title>proc~num_ranks</title>
<g id="a_proc~~ndmc~~CallsGraph_node49"><a xlink:href=".././proc/num_ranks.html" xlink:title="num_ranks">
<polygon fill="#d94e8f" stroke="#d94e8f" points="546,-415.999 480,-415.999 480,-391.999 546,-391.999 546,-415.999"/>
<text text-anchor="middle" x="513" y="-401.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">num_ranks</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~num_ranks -->
<g id="proc~~ndmc~~CallsGraph_edge87" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~num_ranks</title>
<path fill="none" stroke="#000000" d="M390.715,-433.963C415.783,-427.77 446.035,-420.296 470.055,-414.362"/>
<polygon fill="#000000" stroke="#000000" points="471.065,-417.717 479.934,-411.921 469.386,-410.922 471.065,-417.717"/>
</g>
<!-- proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_node60" class="node"><title>proc~init_reservoir</title>
<g id="a_proc~~ndmc~~CallsGraph_node60"><a xlink:href=".././proc/init_reservoir.html" xlink:title="init_reservoir">
<polygon fill="#d9534f" stroke="#d9534f" points="835,-556.999 761,-556.999 761,-532.999 835,-532.999 835,-556.999"/>
<text text-anchor="middle" x="798" y="-542.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_reservoir</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge88" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M357.525,-458.246C376.994,-472.905 411.963,-496.975 446,-508.999 550.384,-545.872 682.314,-548.625 750.877,-547.056"/>
<polygon fill="#000000" stroke="#000000" points="751.021,-550.553 760.922,-546.784 750.831,-543.556 751.021,-550.553"/>
</g>
<!-- proc~my_rank -->
<g id="proc~~ndmc~~CallsGraph_node61" class="node"><title>proc~my_rank</title>
<g id="a_proc~~ndmc~~CallsGraph_node61"><a xlink:href=".././proc/my_rank.html" xlink:title="my_rank">
<polygon fill="#d94e8f" stroke="#d94e8f" points="540,-457.999 486,-457.999 486,-433.999 540,-433.999 540,-457.999"/>
<text text-anchor="middle" x="513" y="-443.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">my_rank</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~my_rank -->
<g id="proc~~ndmc~~CallsGraph_edge89" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~my_rank</title>
<path fill="none" stroke="#000000" d="M409.677,-445.999C432.177,-445.999 456.368,-445.999 475.577,-445.999"/>
<polygon fill="#000000" stroke="#000000" points="475.694,-449.499 485.694,-445.999 475.694,-442.499 475.694,-449.499"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_edge91" class="edge"><title>proc~store_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M381.594,-1413.73C391.307,-1417.51 401.381,-1422.24 410,-1428 429.347,-1440.92 426.292,-1453.64 446,-1466 454.467,-1471.31 464.394,-1475.39 473.941,-1478.47"/>
<polygon fill="#000000" stroke="#000000" points="473.093,-1481.87 483.674,-1481.33 475.068,-1475.15 473.093,-1481.87"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_indices -->
<g id="proc~~ndmc~~CallsGraph_edge90" class="edge"><title>proc~store_photons&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M359.362,-1389.95C379.484,-1376.4 413.987,-1354.4 446,-1340 453.484,-1336.63 461.668,-1333.57 469.648,-1330.88"/>
<polygon fill="#000000" stroke="#000000" points="470.772,-1334.2 479.219,-1327.8 468.628,-1327.53 470.772,-1334.2"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge93" class="edge"><title>proc~store_photons&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M349.622,-1414.24C364.747,-1437.29 401.013,-1486.74 446,-1508 605.93,-1583.58 675.46,-1561.7 844,-1508 861.166,-1502.53 878.918,-1493.03 892.84,-1484.55"/>
<polygon fill="#000000" stroke="#000000" points="894.785,-1487.46 901.391,-1479.17 891.061,-1481.53 894.785,-1487.46"/>
</g>
<!-- proc~get_passive_grid_indices -->
<g id="proc~~ndmc~~CallsGraph_node43" class="node"><title>proc~get_passive_grid_indices</title>
<g id="a_proc~~ndmc~~CallsGraph_node43"><a xlink:href=".././proc/get_passive_grid_indices.html" xlink:title="get_passive_grid_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="579.5,-1373 446.5,-1373 446.5,-1349 579.5,-1349 579.5,-1373"/>
<text text-anchor="middle" x="513" y="-1358.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_passive_grid_indices</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_passive_grid_indices -->
<g id="proc~~ndmc~~CallsGraph_edge94" class="edge"><title>proc~store_photons&#45;&gt;proc~get_passive_grid_indices</title>
<path fill="none" stroke="#000000" d="M381.857,-1392.39C402.81,-1387.33 428.918,-1381.04 452.239,-1375.41"/>
<polygon fill="#000000" stroke="#000000" points="453.139,-1378.8 462.039,-1373.05 451.497,-1371.99 453.139,-1378.8"/>
</g>
<!-- proc~spectrum -->
<g id="proc~~ndmc~~CallsGraph_node58" class="node"><title>proc~spectrum</title>
<g id="a_proc~~ndmc~~CallsGraph_node58"><a xlink:href=".././proc/spectrum.html" xlink:title="spectrum">
<polygon fill="#d9534f" stroke="#d9534f" points="541.5,-1457 484.5,-1457 484.5,-1433 541.5,-1433 541.5,-1457"/>
<text text-anchor="middle" x="513" y="-1442.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spectrum</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~spectrum -->
<g id="proc~~ndmc~~CallsGraph_edge92" class="edge"><title>proc~store_photons&#45;&gt;proc~spectrum</title>
<path fill="none" stroke="#000000" d="M381.857,-1412.08C409.791,-1419.15 446.888,-1428.53 474.327,-1435.47"/>
<polygon fill="#000000" stroke="#000000" points="473.778,-1438.94 484.331,-1438 475.495,-1432.15 473.778,-1438.94"/>
</g>
<!-- proc~xyz_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_node71" class="node"><title>proc~xyz_to_cyl</title>
<g id="a_proc~~ndmc~~CallsGraph_node71"><a xlink:href=".././proc/xyz_to_cyl.html" xlink:title="xyz_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="697,-1258 635,-1258 635,-1234 697,-1234 697,-1258"/>
<text text-anchor="middle" x="666" y="-1243.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_cyl</text>
</a>
</g>
</g>
<!-- proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_edge95" class="edge"><title>proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl</title>
<path fill="none" stroke="#000000" d="M566.239,-1348.91C571.198,-1346.46 575.898,-1343.53 580,-1340 607.426,-1316.41 589.748,-1291.89 616,-1267 618.938,-1264.21 622.304,-1261.77 625.864,-1259.62"/>
<polygon fill="#000000" stroke="#000000" points="627.71,-1262.61 634.984,-1254.9 624.494,-1256.39 627.71,-1262.61"/>
</g>
<!-- proc~rswap -->
<g id="proc~~ndmc~~CallsGraph_node63" class="node"><title>proc~rswap</title>
<g id="a_proc~~ndmc~~CallsGraph_node63"><a xlink:href=".././proc/rswap.html" xlink:title="RSWAP">
<polygon fill="#d9534f" stroke="#d9534f" points="693,-880.999 639,-880.999 639,-856.999 693,-856.999 693,-880.999"/>
<text text-anchor="middle" x="666" y="-866.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RSWAP</text>
</a>
</g>
</g>
<!-- proc~balback&#45;&gt;proc~rswap -->
<g id="proc~~ndmc~~CallsGraph_edge96" class="edge"><title>proc~balback&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M540.302,-903.683C564.878,-896.847 601.771,-886.586 629.057,-878.996"/>
<polygon fill="#000000" stroke="#000000" points="630.303,-882.283 638.999,-876.231 628.427,-875.539 630.303,-882.283"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge97" class="edge"><title>proc~merge_reservoirs&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M555.951,-475.886C564.026,-473.209 572.348,-470.205 580,-466.999 596.686,-460.006 598.439,-452.349 616,-447.999 659.141,-437.313 673.141,-436.234 716,-447.999 793.055,-469.151 866.378,-533.08 899.921,-565.58"/>
<polygon fill="#000000" stroke="#000000" points="897.622,-568.228 907.202,-572.752 902.534,-563.241 897.622,-568.228"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;proc~update_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge98" class="edge"><title>proc~merge_reservoirs&#45;&gt;proc~update_reservoir</title>
<path fill="none" stroke="#000000" d="M532.516,-500.138C558.893,-517.432 607.455,-549.271 637.889,-569.224"/>
<polygon fill="#000000" stroke="#000000" points="636.051,-572.204 646.333,-574.76 639.889,-566.35 636.051,-572.204"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge99" class="edge"><title>proc~merge_reservoirs&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M561.687,-497.604C614.409,-508.222 698.754,-525.211 750.851,-535.704"/>
<polygon fill="#000000" stroke="#000000" points="750.327,-539.168 760.821,-537.712 751.709,-532.306 750.327,-539.168"/>
</g>
<!-- float -->
<g id="proc~~ndmc~~CallsGraph_node64" class="node"><title>float</title>
<polygon fill="#777777" stroke="#777777" points="693,-480.999 639,-480.999 639,-456.999 693,-456.999 693,-480.999"/>
<text text-anchor="middle" x="666" y="-466.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">float</text>
</g>
<!-- proc~merge_reservoirs&#45;&gt;float -->
<g id="proc~~ndmc~~CallsGraph_edge100" class="edge"><title>proc~merge_reservoirs&#45;&gt;float</title>
<path fill="none" stroke="#000000" d="M561.777,-481.987C583.409,-479.265 608.567,-476.1 628.63,-473.575"/>
<polygon fill="#000000" stroke="#000000" points="629.127,-477.04 638.611,-472.319 628.253,-470.095 629.127,-477.04"/>
</g>
<!-- proc~update_reservoir&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge101" class="edge"><title>proc~update_reservoir&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M713.221,-586.632C762.024,-586.245 837.953,-585.642 882.652,-585.287"/>
<polygon fill="#000000" stroke="#000000" points="882.799,-588.786 892.771,-585.207 882.743,-581.786 882.799,-588.786"/>
</g>
<!-- proc~update_reservoir&#45;&gt;interface~randind -->
<g id="proc~~ndmc~~CallsGraph_edge102" class="edge"><title>proc~update_reservoir&#45;&gt;interface~randind</title>
<path fill="none" stroke="#000000" d="M708.133,-599.022C725.135,-603.992 744.667,-609.701 761.082,-614.499"/>
<polygon fill="#000000" stroke="#000000" points="760.269,-617.908 770.849,-617.355 762.233,-611.189 760.269,-617.908"/>
</g>
<!-- proc~update_reservoir&#45;&gt;proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge103" class="edge"><title>proc~update_reservoir&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M704.253,-574.963C718.778,-570.27 735.579,-564.842 750.858,-559.906"/>
<polygon fill="#000000" stroke="#000000" points="752.2,-563.151 760.639,-556.746 750.047,-556.49 752.2,-563.151"/>
</g>
<!-- proc~elmhes&#45;&gt;proc~rswap -->
<g id="proc~~ndmc~~CallsGraph_edge104" class="edge"><title>proc~elmhes&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M540.302,-868.999C564.769,-868.999 601.446,-868.999 628.696,-868.999"/>
<polygon fill="#000000" stroke="#000000" points="628.999,-872.499 638.999,-868.999 628.999,-865.499 628.999,-872.499"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge106" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M823.284,-1419.14C841.257,-1428.13 865.953,-1440.47 885.757,-1450.38"/>
<polygon fill="#000000" stroke="#000000" points="884.243,-1453.53 894.752,-1454.87 887.373,-1447.27 884.243,-1453.53"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge105" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M823.284,-1394.86C841.257,-1385.87 865.953,-1373.52 885.757,-1363.62"/>
<polygon fill="#000000" stroke="#000000" points="887.373,-1366.73 894.752,-1359.12 884.243,-1360.46 887.373,-1366.73"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~ndmc~~CallsGraph_node69" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~ndmc~~CallsGraph_node69"><a xlink:href=".././proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="693,-943.999 639,-943.999 639,-919.999 693,-919.999 693,-943.999"/>
<text text-anchor="middle" x="666" y="-929.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~ndmc~~CallsGraph_edge107" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M540.302,-949.341C564.878,-945.923 601.771,-940.792 629.057,-936.997"/>
<polygon fill="#000000" stroke="#000000" points="629.577,-940.459 638.999,-935.615 628.612,-933.526 629.577,-940.459"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~ndmc~~CallsGraph_node65" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~ndmc~~CallsGraph_node65"><a xlink:href=".././proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="693,-1007 639,-1007 639,-982.999 693,-982.999 693,-1007"/>
<text text-anchor="middle" x="666" y="-992.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~ndmc~~CallsGraph_edge108" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M536.934,-1062.85C562.692,-1049.2 604.656,-1026.97 633.484,-1011.7"/>
<polygon fill="#000000" stroke="#000000" points="635.147,-1014.78 642.345,-1007 631.87,-1008.59 635.147,-1014.78"/>
</g>
<!-- proc~lubksb -->
<g id="proc~~ndmc~~CallsGraph_node68" class="node"><title>proc~lubksb</title>
<g id="a_proc~~ndmc~~CallsGraph_node68"><a xlink:href=".././proc/lubksb.html" xlink:title="lubksb">
<polygon fill="#d9534f" stroke="#d9534f" points="693,-1087 639,-1087 639,-1063 693,-1063 693,-1087"/>
<text text-anchor="middle" x="666" y="-1072.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lubksb</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~lubksb -->
<g id="proc~~ndmc~~CallsGraph_edge109" class="edge"><title>proc~matinv&#45;&gt;proc~lubksb</title>
<path fill="none" stroke="#000000" d="M540.302,-1075C564.769,-1075 601.446,-1075 628.696,-1075"/>
<polygon fill="#000000" stroke="#000000" points="628.999,-1078.5 638.999,-1075 628.999,-1071.5 628.999,-1078.5"/>
</g>
<!-- proc~approx_le -->
<g id="proc~~ndmc~~CallsGraph_node66" class="node"><title>proc~approx_le</title>
<g id="a_proc~~ndmc~~CallsGraph_node66"><a xlink:href=".././proc/approx_le.html" xlink:title="approx_le">
<polygon fill="#d94e8f" stroke="#d94e8f" points="828,-859.999 768,-859.999 768,-835.999 828,-835.999 828,-859.999"/>
<text text-anchor="middle" x="798" y="-845.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_le</text>
</a>
</g>
</g>
<!-- proc~in_passive_grid&#45;&gt;proc~approx_le -->
<g id="proc~~ndmc~~CallsGraph_edge111" class="edge"><title>proc~in_passive_grid&#45;&gt;proc~approx_le</title>
<path fill="none" stroke="#000000" d="M709.567,-827.149C725.09,-830.851 742.558,-835.016 757.776,-838.645"/>
<polygon fill="#000000" stroke="#000000" points="757.362,-842.145 767.901,-841.06 758.986,-835.336 757.362,-842.145"/>
</g>
<!-- proc~approx_ge -->
<g id="proc~~ndmc~~CallsGraph_node67" class="node"><title>proc~approx_ge</title>
<g id="a_proc~~ndmc~~CallsGraph_node67"><a xlink:href=".././proc/approx_ge.html" xlink:title="approx_ge">
<polygon fill="#d94e8f" stroke="#d94e8f" points="830,-817.999 766,-817.999 766,-793.999 830,-793.999 830,-817.999"/>
<text text-anchor="middle" x="798" y="-803.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_ge</text>
</a>
</g>
</g>
<!-- proc~in_passive_grid&#45;&gt;proc~approx_ge -->
<g id="proc~~ndmc~~CallsGraph_edge112" class="edge"><title>proc~in_passive_grid&#45;&gt;proc~approx_ge</title>
<path fill="none" stroke="#000000" d="M709.567,-813.397C724.344,-812.146 740.885,-810.747 755.57,-809.504"/>
<polygon fill="#000000" stroke="#000000" points="756.213,-812.962 765.882,-808.632 755.623,-805.987 756.213,-812.962"/>
</g>
<!-- proc~uvw_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_node70" class="node"><title>proc~uvw_to_cyl</title>
<g id="a_proc~~ndmc~~CallsGraph_node70"><a xlink:href=".././proc/uvw_to_cyl.html" xlink:title="uvw_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="830.5,-964.999 765.5,-964.999 765.5,-940.999 830.5,-940.999 830.5,-964.999"/>
<text text-anchor="middle" x="798" y="-950.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_cyl</text>
</a>
</g>
</g>
<!-- proc~in_passive_grid&#45;&gt;proc~uvw_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_edge110" class="edge"><title>proc~in_passive_grid&#45;&gt;proc~uvw_to_cyl</title>
<path fill="none" stroke="#000000" d="M692.39,-829.118C700.743,-834.059 709.536,-840.414 716,-847.999 742.346,-878.912 723.738,-902.826 752,-931.999 753.395,-933.438 754.907,-934.79 756.505,-936.057"/>
<polygon fill="#000000" stroke="#000000" points="754.777,-939.111 765.047,-941.712 758.641,-933.273 754.777,-939.111"/>
</g>
<!-- proc~init_reservoir&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge113" class="edge"><title>proc~init_reservoir&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M835.004,-557C850.294,-562.097 868.074,-568.023 883.328,-573.108"/>
<polygon fill="#000000" stroke="#000000" points="882.343,-576.469 892.936,-576.311 884.556,-569.828 882.343,-576.469"/>
</g>
<!-- proc~balance&#45;&gt;proc~rswap -->
<g id="proc~~ndmc~~CallsGraph_edge114" class="edge"><title>proc~balance&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M540.302,-834.315C564.878,-841.15 601.771,-851.412 629.057,-859.001"/>
<polygon fill="#000000" stroke="#000000" points="628.427,-862.459 638.999,-861.767 630.303,-855.715 628.427,-862.459"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~ndmc~~CallsGraph_node74" class="node"><title>proc~outerprod</title>
<g id="a_proc~~ndmc~~CallsGraph_node74"><a xlink:href=".././proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="827.5,-1007 768.5,-1007 768.5,-982.999 827.5,-982.999 827.5,-1007"/>
<text text-anchor="middle" x="798" y="-992.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~ndmc~~CallsGraph_edge115" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M693.307,-994.999C711.967,-994.999 737.316,-994.999 758.28,-994.999"/>
<polygon fill="#000000" stroke="#000000" points="758.476,-998.499 768.476,-994.999 758.476,-991.499 758.476,-998.499"/>
</g>
<!-- proc~swap -->
<g id="proc~~ndmc~~CallsGraph_node75" class="node"><title>proc~swap</title>
<g id="a_proc~~ndmc~~CallsGraph_node75"><a xlink:href=".././proc/swap.html" xlink:title="swap">
<polygon fill="#d9534f" stroke="#d9534f" points="825,-1049 771,-1049 771,-1025 825,-1025 825,-1049"/>
<text text-anchor="middle" x="798" y="-1034.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swap</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~swap -->
<g id="proc~~ndmc~~CallsGraph_edge116" class="edge"><title>proc~ludcmp&#45;&gt;proc~swap</title>
<path fill="none" stroke="#000000" d="M693.307,-1003.5C712.778,-1009.79 739.532,-1018.43 760.987,-1025.36"/>
<polygon fill="#000000" stroke="#000000" points="760.14,-1028.77 770.732,-1028.51 762.292,-1022.11 760.14,-1028.77"/>
</g>
<!-- proc~approx_eq -->
<g id="proc~~ndmc~~CallsGraph_node72" class="node"><title>proc~approx_eq</title>
<g id="a_proc~~ndmc~~CallsGraph_node72"><a xlink:href=".././proc/approx_eq.html" xlink:title="approx_eq">
<polygon fill="#d94e8f" stroke="#d94e8f" points="952,-838.999 888,-838.999 888,-814.999 952,-814.999 952,-838.999"/>
<text text-anchor="middle" x="920" y="-824.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_eq</text>
</a>
</g>
</g>
<!-- proc~approx_le&#45;&gt;proc~approx_eq -->
<g id="proc~~ndmc~~CallsGraph_edge117" class="edge"><title>proc~approx_le&#45;&gt;proc~approx_eq</title>
<path fill="none" stroke="#000000" d="M828.049,-842.915C842.984,-840.302 861.442,-837.071 877.819,-834.205"/>
<polygon fill="#000000" stroke="#000000" points="878.45,-837.648 887.697,-832.477 877.243,-830.753 878.45,-837.648"/>
</g>
<!-- proc~approx_ge&#45;&gt;proc~approx_eq -->
<g id="proc~~ndmc~~CallsGraph_edge118" class="edge"><title>proc~approx_ge&#45;&gt;proc~approx_eq</title>
<path fill="none" stroke="#000000" d="M830.215,-811.461C844.799,-814.013 862.355,-817.086 877.993,-819.822"/>
<polygon fill="#000000" stroke="#000000" points="877.487,-823.287 887.941,-821.563 878.694,-816.392 877.487,-823.287"/>
</g>
<!-- proc~comdiv -->
<g id="proc~~ndmc~~CallsGraph_node73" class="node"><title>proc~comdiv</title>
<g id="a_proc~~ndmc~~CallsGraph_node73"><a xlink:href=".././proc/comdiv.html" xlink:title="Comdiv">
<polygon fill="#d9534f" stroke="#d9534f" points="825,-922.999 771,-922.999 771,-898.999 825,-898.999 825,-922.999"/>
<text text-anchor="middle" x="798" y="-908.599" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Comdiv</text>
</a>
</g>
</g>
<!-- proc~hqrvec&#45;&gt;proc~comdiv -->
<g id="proc~~ndmc~~CallsGraph_edge119" class="edge"><title>proc~hqrvec&#45;&gt;proc~comdiv</title>
<path fill="none" stroke="#000000" d="M693.307,-927.749C712.69,-924.618 739.29,-920.321 760.695,-916.863"/>
<polygon fill="#000000" stroke="#000000" points="761.418,-920.292 770.732,-915.242 760.301,-913.382 761.418,-920.292"/>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge121" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M697.078,-1257.58C703.461,-1260.39 710.061,-1263.59 716,-1267 737,-1279.06 758.964,-1295.61 774.714,-1308.28"/>
<polygon fill="#000000" stroke="#000000" points="772.819,-1311.25 782.779,-1314.86 777.245,-1305.82 772.819,-1311.25"/>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_edge120" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl</title>
<path fill="none" stroke="#000000" d="M671.056,-1233.98C679.6,-1208.58 699.982,-1147.54 716,-1096 732.779,-1042.01 715.126,-1016.85 752,-973.999 753.35,-972.43 754.842,-970.971 756.438,-969.615"/>
<polygon fill="#000000" stroke="#000000" points="758.845,-972.208 765.104,-963.66 754.88,-966.439 758.845,-972.208"/>
</g>
</g>
</svg>
</div><script>var panprocndmcCallsGraph = svgPanZoom('#procndmcCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~ndmc~~CalledByGraph Pages: 1 -->
<svg id="procndmcCalledByGraph" width="152pt" height="32pt"
 viewBox="0.00 0.00 152.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~ndmc~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~ndmc~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 148,-28 148,4 -4,4"/>
<!-- proc~ndmc -->
<g id="proc~~ndmc~~CalledByGraph_node1" class="node"><title>proc~ndmc</title>
<polygon fill="none" stroke="black" points="144,-24 90,-24 90,-0 144,-0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">ndmc</text>
</g>
<!-- program~fidasim -->
<g id="proc~~ndmc~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~ndmc~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~ndmc -->
<g id="proc~~ndmc~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~ndmc</title>
<path fill="none" stroke="#000000" d="M54.4029,-12C62.3932,-12 71.3106,-12 79.8241,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.919,-15.5001 89.919,-12 79.919,-8.5001 79.919,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/ndmc.html#src">ndmc</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">ndmc</span><span class="w"></span>
<span class="w">    </span><span class="c">!+ Calculates neutral beam deposition and spectra</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">neut_type</span><span class="w"> </span><span class="c">!! full half third energy</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">nlaunch</span><span class="w">   </span><span class="c">!! nr. of markers</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">nneutrals</span><span class="w"> </span><span class="c">!! # NBI particles</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">vnbi</span><span class="w"> </span><span class="c">!! velocities(full..)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rnbi</span><span class="w"> </span><span class="c">!! initial position</span>

<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">jj</span><span class="p">,</span><span class="w"> </span><span class="n">ii</span><span class="p">,</span><span class="w"> </span><span class="n">kk</span><span class="p">,</span><span class="w"> </span><span class="n">cnt</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ntrack</span><span class="p">,</span><span class="w"> </span><span class="n">ic</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">ParticleTrack</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ntrack</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tracks</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">plasma</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fields</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">states</span><span class="p">,</span><span class="w"> </span><span class="n">dens</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">photons</span><span class="p">,</span><span class="w"> </span><span class="n">iflux</span><span class="p">,</span><span class="n">flux_tot</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ind</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ri</span><span class="p">,</span><span class="n">ri_gc</span><span class="p">,</span><span class="n">r_gyro</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">randomu</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">randi</span><span class="w"></span>
<span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">err</span><span class="w"></span>

<span class="w">    </span><span class="c">!! Initialize Neutral Population</span>
<span class="w">    </span><span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">half</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">third</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i10)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of birth markers: 3 x&quot;,i10)&#39;</span><span class="p">)</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="o">*</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_birth</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">    endif</span><span class="w"></span>

<span class="w">    </span><span class="c">!! # of injected neutrals = NBI power/energy_per_particle</span>
<span class="w">    </span><span class="n">nneutrals</span><span class="o">=</span><span class="mf">1.d6</span><span class="o">*</span><span class="n">nbi</span><span class="p">%</span><span class="n">pinj</span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.d3</span><span class="o">*</span><span class="n">nbi</span><span class="p">%</span><span class="n">einj</span><span class="o">*</span><span class="n">e0</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="o">*</span><span class="p">(</span><span class="w"> </span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="o">+</span><span class="w">  </span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.d0</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="o">+</span><span class="w">  </span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mf">3.d0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">nlaunch</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="c">!$OMP PARALLEL DO schedule(guided) &amp;</span>
<span class="w">    </span><span class="c">!$OMP&amp; private(vnbi,rnbi,tracks,ntrack,plasma,fields,randi,flux_tot, &amp;</span>
<span class="w">    </span><span class="c">!$OMP&amp; states,dens,iflux,photons,neut_type,jj,ii,kk,ind,err,ri,ri_gc,r_gyro)</span>
<span class="w">    </span><span class="n">loop_over_markers</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">ii</span><span class="o">=</span><span class="n">istart</span><span class="p">,</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="p">,</span><span class="n">istep</span><span class="w"></span>
<span class="w">        </span><span class="n">energy_fractions</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">neut_type</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="w"></span>
<span class="w">            </span><span class="c">!! (type = 1: full energy, =2: half energy, =3: third energy</span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="n">neut_type</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">energy_fractions</span><span class="w"></span>

<span class="w">            </span><span class="k">call </span><span class="n">mc_nbi</span><span class="p">(</span><span class="n">vnbi</span><span class="p">,</span><span class="n">neut_type</span><span class="p">,</span><span class="n">rnbi</span><span class="p">,</span><span class="n">err</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">energy_fractions</span><span class="w"></span>

<span class="w">            </span><span class="k">call </span><span class="n">track</span><span class="p">(</span><span class="n">rnbi</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">tracks</span><span class="p">,</span><span class="n">ntrack</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">ntrack</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">energy_fractions</span><span class="w"></span>

<span class="w">            </span><span class="c">!! Solve collisional radiative model along track</span>
<span class="w">            </span><span class="n">flux_tot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.d0</span><span class="w"></span>
<span class="w">            </span><span class="n">states</span><span class="o">=</span><span class="mf">0.d0</span><span class="w"></span>
<span class="w">            </span><span class="n">states</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">nneutrals</span><span class="o">*</span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="n">neut_type</span><span class="p">)</span><span class="o">/</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="w"></span>
<span class="w">            </span><span class="n">loop_along_track</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">jj</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ntrack</span><span class="w"></span>
<span class="w">                </span><span class="n">iflux</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="n">ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">ind</span><span class="w"></span>
<span class="w">                </span><span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">call </span><span class="n">colrad</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">beam_mass</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="nb">time</span><span class="p">,</span><span class="n">states</span><span class="p">,</span><span class="n">dens</span><span class="p">,</span><span class="n">photons</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="n">dens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dens</span><span class="o">/</span><span class="n">nlaunch</span><span class="w"></span>
<span class="w">                </span><span class="k">call </span><span class="n">store_neutrals</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">neut_type</span><span class="p">,</span><span class="n">dens</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">flux</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">iflux</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">))</span><span class="o">/</span><span class="n">nlaunch</span><span class="w"></span>
<span class="w">                </span><span class="n">flux_tot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">flux_tot</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">flux</span><span class="o">*</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    call </span><span class="n">store_births</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">neut_type</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">flux</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">endif</span>

<span class="k">                if</span><span class="p">((</span><span class="n">photons</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_bes</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    call </span><span class="n">store_nbi_photons</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">beam_lambda0</span><span class="p">,</span><span class="w"> </span><span class="n">photons</span><span class="o">/</span><span class="n">nlaunch</span><span class="p">,</span><span class="n">neut_type</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">endif</span>
<span class="k">            enddo </span><span class="n">loop_along_track</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">((</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">flux_tot</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">                </span><span class="c">!! Sample according to deposited flux along neutral trajectory</span>
<span class="w">                </span><span class="c">!$OMP CRITICAL(ndmc_birth)</span>
<span class="w">                </span><span class="k">do </span><span class="n">kk</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_birth</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">randind</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ntrack</span><span class="p">)%</span><span class="n">flux</span><span class="p">,</span><span class="n">randi</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">randu</span><span class="p">(</span><span class="n">randomu</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">neut_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neut_type</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">energy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbi</span><span class="p">%</span><span class="n">einj</span><span class="o">/</span><span class="kt">real</span><span class="p">(</span><span class="n">neut_type</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">flux_tot</span><span class="o">/</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_birth</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tracks</span><span class="p">(</span><span class="n">randi</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">ind</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">vi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vnbi</span><span class="w"></span>
<span class="w">                    </span><span class="n">ri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tracks</span><span class="p">(</span><span class="n">randi</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">pos</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">vnbi</span><span class="o">*</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="n">randi</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="nb">time</span><span class="o">*</span><span class="p">(</span><span class="n">randomu</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">))</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">ri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ri</span><span class="w"></span>

<span class="w">                    </span><span class="k">call </span><span class="n">get_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">pitch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dot_product</span><span class="p">(</span><span class="n">fields</span><span class="p">%</span><span class="n">b_norm</span><span class="p">,</span><span class="n">vnbi</span><span class="o">/</span><span class="nb">norm2</span><span class="p">(</span><span class="n">vnbi</span><span class="p">))</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">gyro_step</span><span class="p">(</span><span class="n">vnbi</span><span class="p">,</span><span class="n">fields</span><span class="p">,</span><span class="n">beam_mass</span><span class="p">,</span><span class="n">r_gyro</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">ri_gc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ri</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r_gyro</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                </span><span class="k">enddo</span><span class="w"></span>
<span class="w">                </span><span class="c">!$OMP END CRITICAL(ndmc_birth)</span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">        enddo </span><span class="n">energy_fractions</span><span class="w"></span>
<span class="w">    </span><span class="k">enddo </span><span class="n">loop_over_markers</span><span class="w"></span>
<span class="w">    </span><span class="c">!$OMP END PARALLEL DO</span>

<span class="cp">#ifdef _MPI</span>
<span class="w">    </span><span class="c">!! Combine beam neutrals</span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_merge_populations</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_merge_populations</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">half</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_merge_populations</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">third</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">nbi_outside</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">dens</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span><span class="w"></span>
<span class="w">    </span><span class="c">!! Combine spectra</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_bes</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">full</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">half</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">third</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span><span class="w"></span>
<span class="cp">#endif</span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">nbi_outside</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="k">        if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T4,a, f6.2,a)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Percent of markers outside the grid: &#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                                  </span><span class="mi">10</span><span class="mf">0.</span><span class="o">*</span><span class="n">nbi_outside</span><span class="o">/</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="p">),</span><span class="s1">&#39;%&#39;</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">        if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">%</span><span class="n">dens</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">stop</span><span class="w"> </span><span class="s1">&#39;Beam does not intersect the grid!&#39;</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">end subroutine </span><span class="n">ndmc</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>