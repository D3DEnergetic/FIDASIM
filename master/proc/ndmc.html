<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="">
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>ndmc &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>User Guide</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>ndmc
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.7% of total for procedures.">94 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
     <li><a href='../module/libfida.html'>libfida</a></li>
     <li class="active">ndmc</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/ndmc.html#src">ndmc</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public subroutine ndmc()</h2>
    

    <p>Calculates neutral beam deposition and spectra</p>

    <h3>Arguments</h3>
    <em>None</em>
    <br>
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~ndmc~~CallsGraph Pages: 1 -->
<svg id="procndmcCallsGraph" width="641pt" height="1059pt"
 viewBox="0.00 0.00 641.00 1058.69" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~ndmc~~CallsGraph" class="graph" transform="scale(0.66219 0.66219) rotate(0) translate(4 1594.77)">
<title>proc~~ndmc~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1594.77 964,-1594.77 964,4 -4,4"/>
<!-- proc~ndmc -->
<g id="proc~~ndmc~~CallsGraph_node1" class="node"><title>proc~ndmc</title>
<polygon fill="none" stroke="black" points="54,-750.883 0,-750.883 0,-726.883 54,-726.883 54,-750.883"/>
<text text-anchor="middle" x="27" y="-736.483" font-family="Helvetica,sans-Serif" font-size="10.50">ndmc</text>
</g>
<!-- interface~randind -->
<g id="proc~~ndmc~~CallsGraph_node2" class="node"><title>interface~randind</title>
<g id="a_proc~~ndmc~~CallsGraph_node2"><a xlink:href=".././interface/randind.html" xlink:title="randind">
<polygon fill="#a7506f" stroke="#a7506f" points="825,-641.883 771,-641.883 771,-617.883 825,-617.883 825,-641.883"/>
<text text-anchor="middle" x="798" y="-627.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;interface~randind -->
<g id="proc~~ndmc~~CallsGraph_edge1" class="edge"><title>proc~ndmc&#45;&gt;interface~randind</title>
<path fill="none" stroke="#000000" d="M47.6045,-726.802C95.5864,-698.422 223.525,-629.883 340,-629.883 340,-629.883 340,-629.883 514,-629.883 602.668,-629.883 706.962,-629.883 760.787,-629.883"/>
<polygon fill="#000000" stroke="#000000" points="760.859,-633.383 770.859,-629.883 760.859,-626.383 760.859,-633.383"/>
</g>
<!-- proc~mc_nbi -->
<g id="proc~~ndmc~~CallsGraph_node3" class="node"><title>proc~mc_nbi</title>
<g id="a_proc~~ndmc~~CallsGraph_node3"><a xlink:href=".././proc/mc_nbi.html" xlink:title="mc_nbi">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-1131.88 314,-1131.88 314,-1107.88 368,-1107.88 368,-1131.88"/>
<text text-anchor="middle" x="341" y="-1117.48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_nbi</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~mc_nbi -->
<g id="proc~~ndmc~~CallsGraph_edge2" class="edge"><title>proc~ndmc&#45;&gt;proc~mc_nbi</title>
<path fill="none" stroke="#000000" d="M28.6853,-751.061C31.8877,-803.621 47.0758,-1010.42 90,-1055.88 145.939,-1115.13 248.579,-1122.5 303.328,-1121.8"/>
<polygon fill="#000000" stroke="#000000" points="303.694,-1125.29 313.611,-1121.56 303.534,-1118.29 303.694,-1125.29"/>
</g>
<!-- proc~parallel_merge_populations -->
<g id="proc~~ndmc~~CallsGraph_node4" class="node"><title>proc~parallel_merge_populations</title>
<g id="a_proc~~ndmc~~CallsGraph_node4"><a xlink:href=".././proc/parallel_merge_populations.html" xlink:title="parallel_merge_populations">
<polygon fill="#d9534f" stroke="#d9534f" points="235.5,-519.883 90.5,-519.883 90.5,-495.883 235.5,-495.883 235.5,-519.883"/>
<text text-anchor="middle" x="163" y="-505.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_merge_populations</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~parallel_merge_populations -->
<g id="proc~~ndmc~~CallsGraph_edge3" class="edge"><title>proc~ndmc&#45;&gt;proc~parallel_merge_populations</title>
<path fill="none" stroke="#000000" d="M30.1822,-726.768C35.9128,-697.441 53.5282,-621.198 90,-568.883 101.827,-551.919 119.495,-536.854 134.369,-525.939"/>
<polygon fill="#000000" stroke="#000000" points="136.603,-528.646 142.739,-520.009 132.556,-522.934 136.603,-528.646"/>
</g>
<!-- proc~gyro_step -->
<g id="proc~~ndmc~~CallsGraph_node5" class="node"><title>proc~gyro_step</title>
<g id="a_proc~~ndmc~~CallsGraph_node5"><a xlink:href=".././proc/gyro_step.html" xlink:title="gyro_step">
<polygon fill="#d9534f" stroke="#d9534f" points="193,-380.883 133,-380.883 133,-356.883 193,-356.883 193,-380.883"/>
<text text-anchor="middle" x="163" y="-366.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_step</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~gyro_step -->
<g id="proc~~ndmc~~CallsGraph_edge4" class="edge"><title>proc~ndmc&#45;&gt;proc~gyro_step</title>
<path fill="none" stroke="#000000" d="M28.6085,-726.536C31.5682,-671.24 46.1478,-446.81 90,-394.883 98.3899,-384.948 110.884,-378.81 123.12,-375.017"/>
<polygon fill="#000000" stroke="#000000" points="124.026,-378.397 132.794,-372.45 122.231,-371.632 124.026,-378.397"/>
</g>
<!-- proc~colrad -->
<g id="proc~~ndmc~~CallsGraph_node6" class="node"><title>proc~colrad</title>
<g id="a_proc~~ndmc~~CallsGraph_node6"><a xlink:href=".././proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="190,-859.883 136,-859.883 136,-835.883 190,-835.883 190,-859.883"/>
<text text-anchor="middle" x="163" y="-845.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~colrad -->
<g id="proc~~ndmc~~CallsGraph_edge5" class="edge"><title>proc~ndmc&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M42.8523,-750.964C66.1951,-769.952 111.639,-806.918 139.16,-829.304"/>
<polygon fill="#000000" stroke="#000000" points="137.115,-832.152 147.081,-835.748 141.532,-826.722 137.115,-832.152"/>
</g>
<!-- interface~randu -->
<g id="proc~~ndmc~~CallsGraph_node7" class="node"><title>interface~randu</title>
<g id="a_proc~~ndmc~~CallsGraph_node7"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="947,-600.883 893,-600.883 893,-576.883 947,-576.883 947,-600.883"/>
<text text-anchor="middle" x="920" y="-586.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge6" class="edge"><title>proc~ndmc&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M31.4994,-751.185C38.9641,-775.761 58.3934,-831.755 90,-868.883 177.587,-971.772 204.879,-1041.88 340,-1041.88 340,-1041.88 340,-1041.88 667,-1041.88 746.716,-1041.88 787.276,-1068.89 844,-1012.88 901.671,-955.939 915.453,-691.267 918.32,-611.619"/>
<polygon fill="#000000" stroke="#000000" points="921.831,-611.369 918.668,-601.257 914.835,-611.134 921.831,-611.369"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~ndmc~~CallsGraph_node8" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~ndmc~~CallsGraph_node8"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="547,-1539.88 479,-1539.88 479,-1515.88 547,-1515.88 547,-1539.88"/>
<text text-anchor="middle" x="513" y="-1525.48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~get_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge7" class="edge"><title>proc~ndmc&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M28.4419,-751.002C31.6163,-835.542 51.916,-1335.38 90,-1389.88 176.959,-1514.32 379.893,-1528.97 468.882,-1529.11"/>
<polygon fill="#000000" stroke="#000000" points="468.919,-1532.61 478.902,-1529.06 468.886,-1525.61 468.919,-1532.61"/>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_node9" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~ndmc~~CallsGraph_node9"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="549.5,-279.883 476.5,-279.883 476.5,-255.883 549.5,-255.883 549.5,-279.883"/>
<text text-anchor="middle" x="513" y="-265.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_edge8" class="edge"><title>proc~ndmc&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M29.472,-726.592C35.1426,-681.141 56.9212,-523.333 90,-486.883 147.623,-423.387 189.749,-447.109 272,-422.883 332.493,-405.066 356.389,-423.091 410,-389.883 451.15,-364.394 483.778,-316.594 500.256,-288.999"/>
<polygon fill="#000000" stroke="#000000" points="503.399,-290.555 505.398,-280.151 497.347,-287.038 503.399,-290.555"/>
</g>
<!-- proc~track -->
<g id="proc~~ndmc~~CallsGraph_node10" class="node"><title>proc~track</title>
<g id="a_proc~~ndmc~~CallsGraph_node10"><a xlink:href=".././proc/track.html" xlink:title="track">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-1425.88 314,-1425.88 314,-1401.88 368,-1401.88 368,-1425.88"/>
<text text-anchor="middle" x="341" y="-1411.48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~track -->
<g id="proc~~ndmc~~CallsGraph_edge9" class="edge"><title>proc~ndmc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M28.165,-751.189C29.2844,-819.934 37.413,-1156.46 90,-1242.88 140.413,-1325.73 247.939,-1377.96 304.124,-1400.69"/>
<polygon fill="#000000" stroke="#000000" points="303.079,-1404.04 313.665,-1404.46 305.654,-1397.53 303.079,-1404.04"/>
</g>
<!-- proc~store_births -->
<g id="proc~~ndmc~~CallsGraph_node11" class="node"><title>proc~store_births</title>
<g id="a_proc~~ndmc~~CallsGraph_node11"><a xlink:href=".././proc/store_births.html" xlink:title="store_births">
<polygon fill="#d9534f" stroke="#d9534f" points="197.5,-338.883 128.5,-338.883 128.5,-314.883 197.5,-314.883 197.5,-338.883"/>
<text text-anchor="middle" x="163" y="-324.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_births</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~store_births -->
<g id="proc~~ndmc~~CallsGraph_edge10" class="edge"><title>proc~ndmc&#45;&gt;proc~store_births</title>
<path fill="none" stroke="#000000" d="M28.2306,-726.83C29.6084,-667.423 38.5511,-406.292 90,-347.883 97.3801,-339.505 107.894,-334.383 118.615,-331.276"/>
<polygon fill="#000000" stroke="#000000" points="119.509,-334.661 128.435,-328.954 117.898,-327.849 119.509,-334.661"/>
</g>
<!-- proc~store_neutrals -->
<g id="proc~~ndmc~~CallsGraph_node12" class="node"><title>proc~store_neutrals</title>
<g id="a_proc~~ndmc~~CallsGraph_node12"><a xlink:href=".././proc/store_neutrals.html" xlink:title="store_neutrals">
<polygon fill="#d9534f" stroke="#d9534f" points="203.5,-601.883 122.5,-601.883 122.5,-577.883 203.5,-577.883 203.5,-601.883"/>
<text text-anchor="middle" x="163" y="-587.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_neutrals</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~store_neutrals -->
<g id="proc~~ndmc~~CallsGraph_edge11" class="edge"><title>proc~ndmc&#45;&gt;proc~store_neutrals</title>
<path fill="none" stroke="#000000" d="M30.939,-726.529C37.3961,-701.99 55.1031,-646.814 90,-615.883 96.648,-609.991 104.733,-605.403 113.052,-601.84"/>
<polygon fill="#000000" stroke="#000000" points="114.386,-605.077 122.478,-598.238 111.888,-598.538 114.386,-605.077"/>
</g>
<!-- proc~init_neutral_population -->
<g id="proc~~ndmc~~CallsGraph_node13" class="node"><title>proc~init_neutral_population</title>
<g id="a_proc~~ndmc~~CallsGraph_node13"><a xlink:href=".././proc/init_neutral_population.html" xlink:title="init_neutral_population">
<polygon fill="#d9534f" stroke="#d9534f" points="223.5,-296.883 102.5,-296.883 102.5,-272.883 223.5,-272.883 223.5,-296.883"/>
<text text-anchor="middle" x="163" y="-282.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_neutral_population</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~init_neutral_population -->
<g id="proc~~ndmc~~CallsGraph_edge12" class="edge"><title>proc~ndmc&#45;&gt;proc~init_neutral_population</title>
<path fill="none" stroke="#000000" d="M28.0268,-726.823C28.4105,-663.649 33.2673,-371.275 90,-305.883 91.2026,-304.497 92.491,-303.2 93.8521,-301.986"/>
<polygon fill="#000000" stroke="#000000" points="96.254,-304.571 102.352,-295.907 92.1818,-298.878 96.254,-304.571"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_node14" class="node"><title>proc~get_fields</title>
<g id="a_proc~~ndmc~~CallsGraph_node14"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="542,-1497.88 484,-1497.88 484,-1473.88 542,-1473.88 542,-1497.88"/>
<text text-anchor="middle" x="513" y="-1483.48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_edge13" class="edge"><title>proc~ndmc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M27.8979,-751.066C27.4781,-825.517 28.2404,-1219.25 90,-1318.88 173.574,-1453.7 386.674,-1479.75 473.901,-1484.73"/>
<polygon fill="#000000" stroke="#000000" points="473.732,-1488.23 483.897,-1485.24 474.088,-1481.24 473.732,-1488.23"/>
</g>
<!-- proc~store_nbi_photons -->
<g id="proc~~ndmc~~CallsGraph_node15" class="node"><title>proc~store_nbi_photons</title>
<g id="a_proc~~ndmc~~CallsGraph_node15"><a xlink:href=".././proc/store_nbi_photons.html" xlink:title="store_nbi_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="213.5,-1233.88 112.5,-1233.88 112.5,-1209.88 213.5,-1209.88 213.5,-1233.88"/>
<text text-anchor="middle" x="163" y="-1219.48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_nbi_photons</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~store_nbi_photons -->
<g id="proc~~ndmc~~CallsGraph_edge14" class="edge"><title>proc~ndmc&#45;&gt;proc~store_nbi_photons</title>
<path fill="none" stroke="#000000" d="M28.1714,-751.034C29.2213,-798.957 36.7017,-978.847 90,-1113.88 103.234,-1147.41 128.041,-1181.21 144.791,-1201.84"/>
<polygon fill="#000000" stroke="#000000" points="142.131,-1204.12 151.204,-1209.59 147.523,-1199.66 142.131,-1204.12"/>
</g>
<!-- proc~mc_nbi&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge17" class="edge"><title>proc~mc_nbi&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M368.383,-1113.86C389.334,-1109.25 419.423,-1102.99 446,-1098.88 533.914,-1085.29 779.494,-1117.14 844,-1055.88 909.248,-993.919 917.746,-695.786 918.841,-611.263"/>
<polygon fill="#000000" stroke="#000000" points="922.341,-611.248 918.948,-601.211 915.342,-611.173 922.341,-611.248"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_node28" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~ndmc~~CallsGraph_node28"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="696.5,-1376.88 635.5,-1376.88 635.5,-1352.88 696.5,-1352.88 696.5,-1376.88"/>
<text text-anchor="middle" x="666" y="-1362.48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~mc_nbi&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge15" class="edge"><title>proc~mc_nbi&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M358.891,-1132.08C378.854,-1146.02 413.481,-1168.73 446,-1182.88 502.761,-1207.59 533.506,-1180.01 580,-1220.88 610.507,-1247.7 594.948,-1270.15 616,-1304.88 624.75,-1319.32 636.701,-1334.03 646.61,-1345.27"/>
<polygon fill="#000000" stroke="#000000" points="644.092,-1347.7 653.389,-1352.78 649.291,-1343.01 644.092,-1347.7"/>
</g>
<!-- proc~grid_intersect -->
<g id="proc~~ndmc~~CallsGraph_node34" class="node"><title>proc~grid_intersect</title>
<g id="a_proc~~ndmc~~CallsGraph_node34"><a xlink:href=".././proc/grid_intersect.html" xlink:title="grid_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="551.5,-1173.88 474.5,-1173.88 474.5,-1149.88 551.5,-1149.88 551.5,-1173.88"/>
<text text-anchor="middle" x="513" y="-1159.48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">grid_intersect</text>
</a>
</g>
</g>
<!-- proc~mc_nbi&#45;&gt;proc~grid_intersect -->
<g id="proc~~ndmc~~CallsGraph_edge16" class="edge"><title>proc~mc_nbi&#45;&gt;proc~grid_intersect</title>
<path fill="none" stroke="#000000" d="M368.19,-1126.35C393.823,-1132.69 433.451,-1142.48 464.622,-1150.18"/>
<polygon fill="#000000" stroke="#000000" points="463.87,-1153.6 474.417,-1152.6 465.549,-1146.8 463.87,-1153.6"/>
</g>
<!-- interface~randn -->
<g id="proc~~ndmc~~CallsGraph_node41" class="node"><title>interface~randn</title>
<g id="a_proc~~ndmc~~CallsGraph_node41"><a xlink:href=".././interface/randn.html" xlink:title="randn">
<polygon fill="#a7506f" stroke="#a7506f" points="540,-1131.88 486,-1131.88 486,-1107.88 540,-1107.88 540,-1131.88"/>
<text text-anchor="middle" x="513" y="-1117.48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randn</text>
</a>
</g>
</g>
<!-- proc~mc_nbi&#45;&gt;interface~randn -->
<g id="proc~~ndmc~~CallsGraph_edge18" class="edge"><title>proc~mc_nbi&#45;&gt;interface~randn</title>
<path fill="none" stroke="#000000" d="M368.19,-1119.88C396.892,-1119.88 443.14,-1119.88 475.416,-1119.88"/>
<polygon fill="#000000" stroke="#000000" points="475.78,-1123.38 485.78,-1119.88 475.78,-1116.38 475.78,-1123.38"/>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_edge19" class="edge"><title>proc~parallel_merge_populations&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M193.592,-495.741C215.181,-487.038 245.224,-475.249 272,-465.883 332.639,-444.673 358.68,-461.527 410,-422.883 457.342,-387.235 489.317,-322.776 503.563,-289.325"/>
<polygon fill="#000000" stroke="#000000" points="506.829,-290.584 507.412,-280.005 500.359,-287.912 506.829,-290.584"/>
</g>
<!-- proc~ind2sub -->
<g id="proc~~ndmc~~CallsGraph_node29" class="node"><title>proc~ind2sub</title>
<g id="a_proc~~ndmc~~CallsGraph_node29"><a xlink:href=".././proc/ind2sub.html" xlink:title="ind2sub">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-498.883 314,-498.883 314,-474.883 368,-474.883 368,-498.883"/>
<text text-anchor="middle" x="341" y="-484.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ind2sub</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;proc~ind2sub -->
<g id="proc~~ndmc~~CallsGraph_edge21" class="edge"><title>proc~parallel_merge_populations&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M235.586,-499.342C258.98,-496.55 283.98,-493.567 303.65,-491.22"/>
<polygon fill="#000000" stroke="#000000" points="304.184,-494.682 313.699,-490.021 303.354,-487.731 304.184,-494.682"/>
</g>
<!-- proc~parallel_merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_node37" class="node"><title>proc~parallel_merge_reservoirs</title>
<g id="a_proc~~ndmc~~CallsGraph_node37"><a xlink:href=".././proc/parallel_merge_reservoirs.html" xlink:title="parallel_merge_reservoirs">
<polygon fill="#d9534f" stroke="#d9534f" points="409.5,-540.883 272.5,-540.883 272.5,-516.883 409.5,-516.883 409.5,-540.883"/>
<text text-anchor="middle" x="341" y="-526.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_merge_reservoirs</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;proc~parallel_merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_edge20" class="edge"><title>proc~parallel_merge_populations&#45;&gt;proc~parallel_merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M235.586,-516.425C244.437,-517.481 253.517,-518.564 262.452,-519.63"/>
<polygon fill="#000000" stroke="#000000" points="262.113,-523.114 272.457,-520.824 262.942,-516.164 262.113,-523.114"/>
</g>
<!-- proc~cross_product -->
<g id="proc~~ndmc~~CallsGraph_node33" class="node"><title>proc~cross_product</title>
<g id="a_proc~~ndmc~~CallsGraph_node33"><a xlink:href=".././proc/cross_product.html" xlink:title="cross_product">
<polygon fill="#d94e8f" stroke="#d94e8f" points="381,-380.883 301,-380.883 301,-356.883 381,-356.883 381,-380.883"/>
<text text-anchor="middle" x="341" y="-366.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cross_product</text>
</a>
</g>
</g>
<!-- proc~gyro_step&#45;&gt;proc~cross_product -->
<g id="proc~~ndmc~~CallsGraph_edge22" class="edge"><title>proc~gyro_step&#45;&gt;proc~cross_product</title>
<path fill="none" stroke="#000000" d="M193.063,-368.883C219.466,-368.883 258.97,-368.883 290.37,-368.883"/>
<polygon fill="#000000" stroke="#000000" points="290.677,-372.383 300.677,-368.883 290.677,-365.383 290.677,-372.383"/>
</g>
<!-- proc~linsolve -->
<g id="proc~~ndmc~~CallsGraph_node16" class="node"><title>proc~linsolve</title>
<g id="a_proc~~ndmc~~CallsGraph_node16"><a xlink:href=".././proc/linsolve.html" xlink:title="linsolve">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-911.883 314,-911.883 314,-887.883 368,-887.883 368,-911.883"/>
<text text-anchor="middle" x="341" y="-897.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linsolve</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~linsolve -->
<g id="proc~~ndmc~~CallsGraph_edge24" class="edge"><title>proc~colrad&#45;&gt;proc~linsolve</title>
<path fill="none" stroke="#000000" d="M190.349,-855.668C220.505,-864.578 270.071,-879.222 303.829,-889.196"/>
<polygon fill="#000000" stroke="#000000" points="303.177,-892.653 313.759,-892.13 305.16,-885.94 303.177,-892.653"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~ndmc~~CallsGraph_node20" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~ndmc~~CallsGraph_node20"><a xlink:href=".././proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="385,-973.883 297,-973.883 297,-949.883 385,-949.883 385,-973.883"/>
<text text-anchor="middle" x="341" y="-959.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~ndmc~~CallsGraph_edge25" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M181.399,-860.051C202.591,-874.776 239.578,-900.171 272,-920.883 284.498,-928.867 298.5,-937.381 310.535,-944.57"/>
<polygon fill="#000000" stroke="#000000" points="308.913,-947.677 319.297,-949.778 312.489,-941.66 308.913,-947.677"/>
</g>
<!-- proc~eigen -->
<g id="proc~~ndmc~~CallsGraph_node32" class="node"><title>proc~eigen</title>
<g id="a_proc~~ndmc~~CallsGraph_node32"><a xlink:href=".././proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-786.883 314,-786.883 314,-762.883 368,-762.883 368,-786.883"/>
<text text-anchor="middle" x="341" y="-772.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~ndmc~~CallsGraph_edge23" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M190.349,-836.954C220.635,-824.392 270.499,-803.71 304.264,-789.705"/>
<polygon fill="#000000" stroke="#000000" points="305.863,-792.831 313.759,-785.767 303.181,-786.366 305.863,-792.831"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_node17" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~ndmc~~CallsGraph_node17"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="954,-1516.88 886,-1516.88 886,-1492.88 954,-1492.88 954,-1516.88"/>
<text text-anchor="middle" x="920" y="-1502.48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge29" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M529.876,-1539.95C549.07,-1553.71 582.929,-1575.4 616,-1583.88 717.091,-1609.81 836.957,-1552.43 890.591,-1522.1"/>
<polygon fill="#000000" stroke="#000000" points="892.602,-1524.98 899.517,-1516.96 889.106,-1518.92 892.602,-1524.98"/>
</g>
<!-- proc~get_position -->
<g id="proc~~ndmc~~CallsGraph_node18" class="node"><title>proc~get_position</title>
<g id="a_proc~~ndmc~~CallsGraph_node18"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="701,-1574.88 631,-1574.88 631,-1550.88 701,-1550.88 701,-1574.88"/>
<text text-anchor="middle" x="666" y="-1560.48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~ndmc~~CallsGraph_edge27" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M547.138,-1535.56C568.863,-1540.6 597.508,-1547.24 621.118,-1552.71"/>
<polygon fill="#000000" stroke="#000000" points="620.361,-1556.13 630.893,-1554.98 621.942,-1549.31 620.361,-1556.13"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge26" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M547.25,-1523.82C558.947,-1520.85 571.325,-1515.72 580,-1506.88 619.298,-1466.84 578.686,-1427.78 616,-1385.88 618.908,-1382.62 622.412,-1379.84 626.193,-1377.49"/>
<polygon fill="#000000" stroke="#000000" points="628.106,-1380.44 635.367,-1372.72 624.879,-1374.22 628.106,-1380.44"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_node39" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~ndmc~~CallsGraph_node39"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="832,-1456.88 764,-1456.88 764,-1432.88 832,-1432.88 832,-1456.88"/>
<text text-anchor="middle" x="798" y="-1442.48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge28" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M547.259,-1520.87C587.601,-1512.05 657.475,-1495.74 716,-1476.88 730.476,-1472.22 746.081,-1466.28 759.693,-1460.79"/>
<polygon fill="#000000" stroke="#000000" points="761.28,-1463.92 769.208,-1456.89 758.627,-1457.44 761.28,-1463.92"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~ndmc~~CallsGraph_node21" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~ndmc~~CallsGraph_node21"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="710,-32.8831 622,-32.8831 622,-8.88308 710,-8.88308 710,-32.8831"/>
<text text-anchor="middle" x="666" y="-18.4831" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~ndmc~~CallsGraph_edge30" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M516.667,-255.802C525.165,-219.787 554.723,-111.654 616,-46.8831 618.978,-43.735 622.424,-40.8903 626.08,-38.3395"/>
<polygon fill="#000000" stroke="#000000" points="628.198,-41.1452 634.872,-32.917 624.524,-35.1871 628.198,-41.1452"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~ndmc~~CallsGraph_node23" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~ndmc~~CallsGraph_node23"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="711.5,-157.883 620.5,-157.883 620.5,-133.883 711.5,-133.883 711.5,-157.883"/>
<text text-anchor="middle" x="666" y="-143.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~ndmc~~CallsGraph_edge33" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M523.541,-255.83C540.346,-235.256 577.139,-193.054 616,-166.883 618.261,-165.36 620.65,-163.91 623.109,-162.536"/>
<polygon fill="#000000" stroke="#000000" points="624.887,-165.558 632.206,-157.897 621.707,-159.322 624.887,-165.558"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~ndmc~~CallsGraph_node24" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~ndmc~~CallsGraph_node24"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="842,-361.883 754,-361.883 754,-337.883 842,-337.883 842,-361.883"/>
<text text-anchor="middle" x="798" y="-347.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~ndmc~~CallsGraph_edge37" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M528.796,-280.045C547.722,-294.854 582.12,-319.318 616,-330.883 657.409,-345.018 706.982,-349.42 743.769,-350.483"/>
<polygon fill="#000000" stroke="#000000" points="743.715,-353.983 753.789,-350.7 743.867,-346.984 743.715,-353.983"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~ndmc~~CallsGraph_node25" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~ndmc~~CallsGraph_node25"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="710,-112.883 622,-112.883 622,-88.8831 710,-88.8831 710,-112.883"/>
<text text-anchor="middle" x="666" y="-98.4831" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~ndmc~~CallsGraph_edge38" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M520.035,-255.609C533.754,-228.771 569.716,-164.132 616,-124.883 619.003,-122.337 622.322,-119.985 625.776,-117.831"/>
<polygon fill="#000000" stroke="#000000" points="627.547,-120.851 634.535,-112.888 624.106,-114.754 627.547,-120.851"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~ndmc~~CallsGraph_node27" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~ndmc~~CallsGraph_node27"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="843.5,-403.883 752.5,-403.883 752.5,-379.883 843.5,-379.883 843.5,-403.883"/>
<text text-anchor="middle" x="798" y="-389.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~ndmc~~CallsGraph_edge39" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M524.576,-280.032C541.759,-298.948 577.693,-335.203 616,-353.883 655.702,-373.244 705.001,-382.77 742.119,-387.44"/>
<polygon fill="#000000" stroke="#000000" points="741.906,-390.939 752.246,-388.633 742.724,-383.987 741.906,-390.939"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~ndmc~~CallsGraph_node30" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~ndmc~~CallsGraph_node30"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="711.5,-321.883 620.5,-321.883 620.5,-297.883 711.5,-297.883 711.5,-321.883"/>
<text text-anchor="middle" x="666" y="-307.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~ndmc~~CallsGraph_edge34" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M549.785,-277.836C568.297,-282.986 591.263,-289.373 611.807,-295.088"/>
<polygon fill="#000000" stroke="#000000" points="611.096,-298.523 621.668,-297.83 612.972,-291.779 611.096,-298.523"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~ndmc~~CallsGraph_node31" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~ndmc~~CallsGraph_node31"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="711.5,-279.883 620.5,-279.883 620.5,-255.883 711.5,-255.883 711.5,-279.883"/>
<text text-anchor="middle" x="666" y="-265.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~ndmc~~CallsGraph_edge36" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M549.785,-267.883C567.757,-267.883 589.927,-267.883 610.004,-267.883"/>
<polygon fill="#000000" stroke="#000000" points="610.279,-271.383 620.279,-267.883 610.279,-264.383 610.279,-271.383"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_node38" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~ndmc~~CallsGraph_node38"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="842,-51.8831 754,-51.8831 754,-27.8831 842,-27.8831 842,-51.8831"/>
<text text-anchor="middle" x="798" y="-37.4831" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_edge31" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M516.906,-255.435C525.529,-221.419 554.307,-126.355 616,-79.8831 652.692,-52.2437 704.741,-42.9909 743.612,-40.2137"/>
<polygon fill="#000000" stroke="#000000" points="743.922,-43.7016 753.697,-39.6158 743.507,-36.7139 743.922,-43.7016"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~ndmc~~CallsGraph_node40" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~ndmc~~CallsGraph_node40"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="711.5,-199.883 620.5,-199.883 620.5,-175.883 711.5,-175.883 711.5,-199.883"/>
<text text-anchor="middle" x="666" y="-185.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~ndmc~~CallsGraph_edge32" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M536.934,-255.733C562.692,-242.086 604.656,-219.853 633.484,-204.58"/>
<polygon fill="#000000" stroke="#000000" points="635.147,-207.66 642.345,-199.886 631.87,-201.474 635.147,-207.66"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_node42" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~ndmc~~CallsGraph_node42"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="843.5,-225.883 752.5,-225.883 752.5,-201.883 843.5,-201.883 843.5,-225.883"/>
<text text-anchor="middle" x="798" y="-211.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge35" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M549.836,-260.298C569.373,-256.215 593.992,-251.154 616,-246.883 658.238,-238.686 706.14,-229.978 742.05,-223.567"/>
<polygon fill="#000000" stroke="#000000" points="743.086,-226.938 752.317,-221.738 741.858,-220.046 743.086,-226.938"/>
</g>
<!-- proc~track&#45;&gt;proc~get_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge43" class="edge"><title>proc~track&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M352.3,-1425.93C369.704,-1445.57 406.877,-1484.54 446,-1506.88 453.201,-1510.99 461.311,-1514.42 469.319,-1517.22"/>
<polygon fill="#000000" stroke="#000000" points="468.376,-1520.59 478.968,-1520.34 470.529,-1513.93 468.376,-1520.59"/>
</g>
<!-- proc~track&#45;&gt;proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_edge44" class="edge"><title>proc~track&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M364.285,-1426.01C385.052,-1437.02 417.077,-1453.26 446,-1464.88 454.931,-1468.47 464.73,-1471.87 473.981,-1474.84"/>
<polygon fill="#000000" stroke="#000000" points="473.148,-1478.25 483.737,-1477.9 475.238,-1471.57 473.148,-1478.25"/>
</g>
<!-- proc~get_indices -->
<g id="proc~~ndmc~~CallsGraph_node19" class="node"><title>proc~get_indices</title>
<g id="a_proc~~ndmc~~CallsGraph_node19"><a xlink:href=".././proc/get_indices.html" xlink:title="get_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="546.5,-1375.88 479.5,-1375.88 479.5,-1351.88 546.5,-1351.88 546.5,-1375.88"/>
<text text-anchor="middle" x="513" y="-1361.48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_indices</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~get_indices -->
<g id="proc~~ndmc~~CallsGraph_edge41" class="edge"><title>proc~track&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M368.19,-1406.18C395.167,-1398.25 437.647,-1385.75 469.455,-1376.4"/>
<polygon fill="#000000" stroke="#000000" points="470.768,-1379.66 479.374,-1373.48 468.793,-1372.94 470.768,-1379.66"/>
</g>
<!-- proc~doppler_stark -->
<g id="proc~~ndmc~~CallsGraph_node22" class="node"><title>proc~doppler_stark</title>
<g id="a_proc~~ndmc~~CallsGraph_node22"><a xlink:href=".././proc/doppler_stark.html" xlink:title="doppler_stark">
<polygon fill="#d9534f" stroke="#d9534f" points="552,-1455.88 474,-1455.88 474,-1431.88 552,-1431.88 552,-1455.88"/>
<text text-anchor="middle" x="513" y="-1441.48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">doppler_stark</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~doppler_stark -->
<g id="proc~~ndmc~~CallsGraph_edge42" class="edge"><title>proc~track&#45;&gt;proc~doppler_stark</title>
<path fill="none" stroke="#000000" d="M368.19,-1418.5C393.544,-1422.98 432.592,-1429.87 463.604,-1435.34"/>
<polygon fill="#000000" stroke="#000000" points="463.326,-1438.85 473.782,-1437.14 464.542,-1431.95 463.326,-1438.85"/>
</g>
<!-- proc~track&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge40" class="edge"><title>proc~track&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M368.201,-1411.64C412.186,-1407.66 503.571,-1398.49 580,-1384.88 594.893,-1382.23 611.089,-1378.61 625.311,-1375.17"/>
<polygon fill="#000000" stroke="#000000" points="626.396,-1378.51 635.27,-1372.72 624.723,-1371.71 626.396,-1378.51"/>
</g>
<!-- proc~update_neutrals -->
<g id="proc~~ndmc~~CallsGraph_node26" class="node"><title>proc~update_neutrals</title>
<g id="a_proc~~ndmc~~CallsGraph_node26"><a xlink:href=".././proc/update_neutrals.html" xlink:title="update_neutrals">
<polygon fill="#d9534f" stroke="#d9534f" points="386,-601.883 296,-601.883 296,-577.883 386,-577.883 386,-601.883"/>
<text text-anchor="middle" x="341" y="-587.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_neutrals</text>
</a>
</g>
</g>
<!-- proc~store_neutrals&#45;&gt;proc~update_neutrals -->
<g id="proc~~ndmc~~CallsGraph_edge45" class="edge"><title>proc~store_neutrals&#45;&gt;proc~update_neutrals</title>
<path fill="none" stroke="#000000" d="M203.937,-589.883C228.112,-589.883 259.267,-589.883 285.664,-589.883"/>
<polygon fill="#000000" stroke="#000000" points="285.897,-593.383 295.896,-589.883 285.896,-586.383 285.897,-593.383"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge49" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M542.157,-1487.2C611.742,-1490.47 792.199,-1498.93 875.584,-1502.85"/>
<polygon fill="#000000" stroke="#000000" points="875.581,-1506.35 885.735,-1503.32 875.91,-1499.36 875.581,-1506.35"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~ndmc~~CallsGraph_edge50" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M542.267,-1493.02C554.199,-1496.51 568.063,-1501.19 580,-1506.88 601.799,-1517.29 624.552,-1532.55 641.026,-1544.51"/>
<polygon fill="#000000" stroke="#000000" points="639.364,-1547.63 649.486,-1550.76 643.526,-1542 639.364,-1547.63"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge46" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M542.265,-1482.22C555.036,-1479.32 569.566,-1474.14 580,-1464.88 608.865,-1439.28 588.409,-1412.86 616,-1385.88 619.053,-1382.9 622.596,-1380.31 626.354,-1378.07"/>
<polygon fill="#000000" stroke="#000000" points="628.075,-1381.12 635.383,-1373.45 624.886,-1374.89 628.075,-1381.12"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~ndmc~~CallsGraph_node36" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~ndmc~~CallsGraph_node36"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="716,-1418.88 616,-1418.88 616,-1394.88 716,-1394.88 716,-1418.88"/>
<text text-anchor="middle" x="666" y="-1404.48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~ndmc~~CallsGraph_edge47" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M542.045,-1479.75C554.199,-1476.4 568.295,-1471.54 580,-1464.88 598.606,-1454.3 598.42,-1445.1 616,-1432.88 620.547,-1429.72 625.524,-1426.67 630.508,-1423.84"/>
<polygon fill="#000000" stroke="#000000" points="632.287,-1426.85 639.395,-1419 628.939,-1420.71 632.287,-1426.85"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge48" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M542.138,-1481.72C562.619,-1478.69 591.025,-1474.51 616,-1470.88 663.036,-1464.05 716.965,-1456.31 753.635,-1451.07"/>
<polygon fill="#000000" stroke="#000000" points="754.563,-1454.47 763.967,-1449.59 753.572,-1447.54 754.563,-1454.47"/>
</g>
<!-- proc~store_photons -->
<g id="proc~~ndmc~~CallsGraph_node35" class="node"><title>proc~store_photons</title>
<g id="a_proc~~ndmc~~CallsGraph_node35"><a xlink:href=".././proc/store_photons.html" xlink:title="store_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="381.5,-1315.88 300.5,-1315.88 300.5,-1291.88 381.5,-1291.88 381.5,-1315.88"/>
<text text-anchor="middle" x="341" y="-1301.48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_photons</text>
</a>
</g>
</g>
<!-- proc~store_nbi_photons&#45;&gt;proc~store_photons -->
<g id="proc~~ndmc~~CallsGraph_edge51" class="edge"><title>proc~store_nbi_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M189.969,-1233.98C220.473,-1248.19 271.208,-1271.83 305.122,-1287.63"/>
<polygon fill="#000000" stroke="#000000" points="303.668,-1290.82 314.211,-1291.87 306.624,-1284.47 303.668,-1290.82"/>
</g>
<!-- dgetrf -->
<g id="proc~~ndmc~~CallsGraph_node48" class="node"><title>dgetrf</title>
<polygon fill="#777777" stroke="#777777" points="540,-891.883 486,-891.883 486,-867.883 540,-867.883 540,-891.883"/>
<text text-anchor="middle" x="513" y="-877.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrf</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrf -->
<g id="proc~~ndmc~~CallsGraph_edge52" class="edge"><title>proc~linsolve&#45;&gt;dgetrf</title>
<path fill="none" stroke="#000000" d="M368.19,-896.802C397.016,-893.411 443.543,-887.937 475.836,-884.138"/>
<polygon fill="#000000" stroke="#000000" points="476.258,-887.612 485.78,-882.968 475.44,-880.66 476.258,-887.612"/>
</g>
<!-- proc~matinv -->
<g id="proc~~ndmc~~CallsGraph_node52" class="node"><title>proc~matinv</title>
<g id="a_proc~~ndmc~~CallsGraph_node52"><a xlink:href=".././proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-975.883 486,-975.883 486,-951.883 540,-951.883 540,-975.883"/>
<text text-anchor="middle" x="513" y="-961.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~linsolve&#45;&gt;proc~matinv -->
<g id="proc~~ndmc~~CallsGraph_edge53" class="edge"><title>proc~linsolve&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M368.262,-911.459C389.146,-920.49 419.204,-933.1 446,-942.883 455.641,-946.403 466.189,-949.91 475.969,-953.021"/>
<polygon fill="#000000" stroke="#000000" points="475.222,-956.455 485.811,-956.105 477.315,-949.775 475.222,-956.455"/>
</g>
<!-- dgetrs -->
<g id="proc~~ndmc~~CallsGraph_node54" class="node"><title>dgetrs</title>
<polygon fill="#777777" stroke="#777777" points="540,-933.883 486,-933.883 486,-909.883 540,-909.883 540,-933.883"/>
<text text-anchor="middle" x="513" y="-919.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrs</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrs -->
<g id="proc~~ndmc~~CallsGraph_edge54" class="edge"><title>proc~linsolve&#45;&gt;dgetrs</title>
<path fill="none" stroke="#000000" d="M368.19,-903.272C397.016,-907.003 443.543,-913.024 475.836,-917.203"/>
<polygon fill="#000000" stroke="#000000" points="475.414,-920.677 485.78,-918.49 476.312,-913.735 475.414,-920.677"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_node62" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~ndmc~~CallsGraph_node62"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="829,-1536.88 767,-1536.88 767,-1512.88 829,-1512.88 829,-1536.88"/>
<text text-anchor="middle" x="798" y="-1522.48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge55" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M701.156,-1552.9C718.135,-1547.94 738.77,-1541.9 756.537,-1536.71"/>
<polygon fill="#000000" stroke="#000000" points="758.002,-1539.93 766.618,-1533.76 756.038,-1533.21 758.002,-1539.93"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~ndmc~~CallsGraph_node53" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~ndmc~~CallsGraph_node53"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="836.5,-1376.88 759.5,-1376.88 759.5,-1352.88 836.5,-1352.88 836.5,-1376.88"/>
<text text-anchor="middle" x="798" y="-1362.48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~ndmc~~CallsGraph_edge56" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M370.068,-974.021C416.772,-995.056 512.015,-1041.58 580,-1098.88 584.525,-1102.7 712.271,-1258.29 716,-1262.88 738.817,-1291 764.78,-1323.85 781.027,-1344.51"/>
<polygon fill="#000000" stroke="#000000" points="778.429,-1346.87 787.358,-1352.57 783.933,-1342.54 778.429,-1346.87"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_edge57" class="edge"><title>proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M710.288,-27.2098C721.033,-28.7802 732.671,-30.4812 743.829,-32.1119"/>
<polygon fill="#000000" stroke="#000000" points="743.5,-35.6009 753.901,-33.584 744.512,-28.6745 743.5,-35.6009"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_node49" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="959.5,-205.883 880.5,-205.883 880.5,-181.883 959.5,-181.883 959.5,-205.883"/>
<text text-anchor="middle" x="920" y="-191.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge58" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M705.686,-8.83115C744.073,0.636322 802.951,8.18446 844,-18.8831 896.241,-53.3308 912.232,-132.531 917.018,-171.457"/>
<polygon fill="#000000" stroke="#000000" points="913.574,-172.161 918.132,-181.725 920.533,-171.406 913.574,-172.161"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge60" class="edge"><title>proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M696.803,-157.973C703.203,-160.759 709.879,-163.81 716,-166.883 733.928,-175.885 753.392,-187.128 768.745,-196.361"/>
<polygon fill="#000000" stroke="#000000" points="767.359,-199.614 777.724,-201.811 770.992,-193.63 767.359,-199.614"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge59" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M711.762,-154.409C756.337,-162.9 824.56,-175.894 870.427,-184.631"/>
<polygon fill="#000000" stroke="#000000" points="869.952,-188.103 880.43,-186.536 871.262,-181.227 869.952,-188.103"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge61" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M825.389,-337.704C831.956,-333.886 838.642,-329.244 844,-323.883 876.011,-291.852 899.125,-243.396 910.669,-215.579"/>
<polygon fill="#000000" stroke="#000000" points="914.035,-216.59 914.521,-206.006 907.541,-213.977 914.035,-216.59"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_edge62" class="edge"><title>proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M692.684,-88.8314C712.537,-79.5158 740.228,-66.5224 762.091,-56.2636"/>
<polygon fill="#000000" stroke="#000000" points="763.803,-59.3262 771.37,-51.9097 760.83,-52.9891 763.803,-59.3262"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge63" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M708.629,-112.979C744.818,-123.86 798.444,-140.864 844,-158.883 857.842,-164.358 872.763,-171.133 885.622,-177.26"/>
<polygon fill="#000000" stroke="#000000" points="884.475,-180.592 895.003,-181.786 887.517,-174.288 884.475,-180.592"/>
</g>
<!-- proc~update_reservoir -->
<g id="proc~~ndmc~~CallsGraph_node44" class="node"><title>proc~update_reservoir</title>
<g id="a_proc~~ndmc~~CallsGraph_node44"><a xlink:href=".././proc/update_reservoir.html" xlink:title="update_reservoir">
<polygon fill="#d9534f" stroke="#d9534f" points="713,-600.883 619,-600.883 619,-576.883 713,-576.883 713,-600.883"/>
<text text-anchor="middle" x="666" y="-586.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_reservoir</text>
</a>
</g>
</g>
<!-- proc~update_neutrals&#45;&gt;proc~update_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge64" class="edge"><title>proc~update_neutrals&#45;&gt;proc~update_reservoir</title>
<path fill="none" stroke="#000000" d="M386.235,-589.746C444.09,-589.567 545.508,-589.253 608.76,-589.057"/>
<polygon fill="#000000" stroke="#000000" points="608.965,-592.557 618.955,-589.026 608.944,-585.557 608.965,-592.557"/>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge65" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M832.344,-379.82C836.609,-377.317 840.648,-374.358 844,-370.883 887.05,-326.262 907.115,-253.187 914.884,-216.457"/>
<polygon fill="#000000" stroke="#000000" points="918.387,-216.788 916.912,-206.296 911.522,-215.418 918.387,-216.788"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge66" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M696.587,-1375.66C703.195,-1378.58 710.013,-1382.02 716,-1385.88 734.233,-1397.66 734.499,-1406.04 752,-1418.88 756.167,-1421.94 760.723,-1424.93 765.284,-1427.73"/>
<polygon fill="#000000" stroke="#000000" points="763.57,-1430.78 773.961,-1432.85 767.128,-1424.76 763.57,-1430.78"/>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~ndmc~~CallsGraph_edge68" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M696.825,-1364.88C712.365,-1364.88 731.744,-1364.88 749.306,-1364.88"/>
<polygon fill="#000000" stroke="#000000" points="749.393,-1368.38 759.393,-1364.88 749.393,-1361.38 749.393,-1368.38"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_node60" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~ndmc~~CallsGraph_node60"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="952.5,-1445.88 887.5,-1445.88 887.5,-1421.88 952.5,-1421.88 952.5,-1445.88"/>
<text text-anchor="middle" x="920" y="-1431.48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge67" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M696.897,-1373.07C741.755,-1385.35 826.621,-1408.59 877.468,-1422.51"/>
<polygon fill="#000000" stroke="#000000" points="876.593,-1425.9 887.162,-1425.17 878.441,-1419.15 876.593,-1425.9"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge70" class="edge"><title>proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M699.443,-297.848C705.138,-295.217 710.877,-292.21 716,-288.883 740.311,-273.096 764.17,-249.784 779.624,-233.349"/>
<polygon fill="#000000" stroke="#000000" points="782.292,-235.619 786.501,-225.896 777.147,-230.872 782.292,-235.619"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge69" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M711.837,-309.005C749.306,-306.527 803.033,-298.791 844,-275.883 870.457,-261.089 892.689,-233.567 905.917,-214.513"/>
<polygon fill="#000000" stroke="#000000" points="908.841,-216.436 911.505,-206.181 903.028,-212.537 908.841,-216.436"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge72" class="edge"><title>proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M696.175,-255.764C714.574,-248.122 738.542,-238.165 758.493,-229.878"/>
<polygon fill="#000000" stroke="#000000" points="760.031,-233.03 767.923,-225.961 757.345,-226.565 760.031,-233.03"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge71" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M711.512,-271.045C748.305,-272.053 801.252,-269.737 844,-252.883 866.107,-244.167 886.986,-226.696 901.073,-213.017"/>
<polygon fill="#000000" stroke="#000000" points="903.594,-215.445 908.165,-205.887 898.631,-210.509 903.594,-215.445"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~ndmc~~CallsGraph_node43" class="node"><title>proc~elmhes</title>
<g id="a_proc~~ndmc~~CallsGraph_node43"><a xlink:href=".././proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-807.883 486,-807.883 486,-783.883 540,-783.883 540,-807.883"/>
<text text-anchor="middle" x="513" y="-793.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~ndmc~~CallsGraph_edge76" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M368.19,-778.118C397.016,-781.679 443.543,-787.427 475.836,-791.416"/>
<polygon fill="#000000" stroke="#000000" points="475.427,-794.892 485.78,-792.644 476.285,-787.945 475.427,-794.892"/>
</g>
<!-- proc~balback -->
<g id="proc~~ndmc~~CallsGraph_node46" class="node"><title>proc~balback</title>
<g id="a_proc~~ndmc~~CallsGraph_node46"><a xlink:href=".././proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-765.883 486,-765.883 486,-741.883 540,-741.883 540,-765.883"/>
<text text-anchor="middle" x="513" y="-751.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~ndmc~~CallsGraph_edge73" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M368.19,-771.648C397.016,-768.087 443.543,-762.34 475.836,-758.35"/>
<polygon fill="#000000" stroke="#000000" points="476.285,-761.822 485.78,-757.122 475.427,-754.874 476.285,-761.822"/>
</g>
<!-- proc~balance -->
<g id="proc~~ndmc~~CallsGraph_node47" class="node"><title>proc~balance</title>
<g id="a_proc~~ndmc~~CallsGraph_node47"><a xlink:href=".././proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-849.883 486,-849.883 486,-825.883 540,-825.883 540,-849.883"/>
<text text-anchor="middle" x="513" y="-835.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~ndmc~~CallsGraph_edge74" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M368.289,-786.143C389.189,-794.938 419.255,-807.243 446,-816.883 455.655,-820.363 466.208,-823.857 475.988,-826.968"/>
<polygon fill="#000000" stroke="#000000" points="475.24,-830.402 485.829,-830.056 477.335,-823.723 475.24,-830.402"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~ndmc~~CallsGraph_node59" class="node"><title>proc~hqr2</title>
<g id="a_proc~~ndmc~~CallsGraph_node59"><a xlink:href=".././proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-723.883 486,-723.883 486,-699.883 540,-699.883 540,-723.883"/>
<text text-anchor="middle" x="513" y="-709.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~ndmc~~CallsGraph_edge75" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M368.289,-763.623C389.189,-754.828 419.255,-742.523 446,-732.883 455.655,-729.403 466.208,-725.909 475.988,-722.798"/>
<polygon fill="#000000" stroke="#000000" points="477.335,-726.043 485.829,-719.71 475.24,-719.364 477.335,-726.043"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~ndmc~~CallsGraph_node61" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~ndmc~~CallsGraph_node61"><a xlink:href=".././proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-681.883 486,-681.883 486,-657.883 540,-657.883 540,-681.883"/>
<text text-anchor="middle" x="513" y="-667.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~ndmc~~CallsGraph_edge77" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M354.024,-762.605C372.336,-744.539 409.008,-710.792 446,-690.883 455.291,-685.883 465.967,-681.843 475.988,-678.693"/>
<polygon fill="#000000" stroke="#000000" points="477.105,-682.012 485.713,-675.836 475.132,-675.296 477.105,-682.012"/>
</g>
<!-- proc~in_passive_grid -->
<g id="proc~~ndmc~~CallsGraph_node55" class="node"><title>proc~in_passive_grid</title>
<g id="a_proc~~ndmc~~CallsGraph_node55"><a xlink:href=".././proc/in_passive_grid.html" xlink:title="in_passive_grid">
<polygon fill="#d94e8f" stroke="#d94e8f" points="709.5,-1131.88 622.5,-1131.88 622.5,-1107.88 709.5,-1107.88 709.5,-1131.88"/>
<text text-anchor="middle" x="666" y="-1117.48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_passive_grid</text>
</a>
</g>
</g>
<!-- proc~grid_intersect&#45;&gt;proc~in_passive_grid -->
<g id="proc~~ndmc~~CallsGraph_edge78" class="edge"><title>proc~grid_intersect&#45;&gt;proc~in_passive_grid</title>
<path fill="none" stroke="#000000" d="M551.714,-1151.39C570.181,-1146.26 592.712,-1139.99 612.802,-1134.4"/>
<polygon fill="#000000" stroke="#000000" points="613.744,-1137.77 622.44,-1131.72 611.868,-1131.03 613.744,-1137.77"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_edge83" class="edge"><title>proc~store_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M352.462,-1316.02C366.533,-1332.67 391.878,-1363.85 410,-1392.88 428.945,-1423.23 418.812,-1441.63 446,-1464.88 453.95,-1471.68 464.119,-1476.29 474.08,-1479.4"/>
<polygon fill="#000000" stroke="#000000" points="473.317,-1482.82 483.883,-1482.05 475.14,-1476.06 473.317,-1482.82"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge82" class="edge"><title>proc~store_photons&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M381.711,-1304.55C494,-1306.77 808.018,-1315.47 844,-1343.88 884.705,-1376.02 855.682,-1409.07 880,-1454.88 885.633,-1465.49 893.55,-1476.14 900.781,-1484.87"/>
<polygon fill="#000000" stroke="#000000" points="898.235,-1487.28 907.405,-1492.59 903.546,-1482.72 898.235,-1487.28"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_indices -->
<g id="proc~~ndmc~~CallsGraph_edge80" class="edge"><title>proc~store_photons&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M376.402,-1316.02C403.306,-1325.52 440.844,-1338.77 469.604,-1348.92"/>
<polygon fill="#000000" stroke="#000000" points="468.785,-1352.34 479.379,-1352.37 471.114,-1345.74 468.785,-1352.34"/>
</g>
<!-- proc~get_passive_grid_indices -->
<g id="proc~~ndmc~~CallsGraph_node45" class="node"><title>proc~get_passive_grid_indices</title>
<g id="a_proc~~ndmc~~CallsGraph_node45"><a xlink:href=".././proc/get_passive_grid_indices.html" xlink:title="get_passive_grid_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="579.5,-1295.88 446.5,-1295.88 446.5,-1271.88 579.5,-1271.88 579.5,-1295.88"/>
<text text-anchor="middle" x="513" y="-1281.48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_passive_grid_indices</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_passive_grid_indices -->
<g id="proc~~ndmc~~CallsGraph_edge79" class="edge"><title>proc~store_photons&#45;&gt;proc~get_passive_grid_indices</title>
<path fill="none" stroke="#000000" d="M381.857,-1299.19C398.162,-1297.28 417.589,-1294.99 436.395,-1292.78"/>
<polygon fill="#000000" stroke="#000000" points="436.93,-1296.24 446.452,-1291.59 436.112,-1289.29 436.93,-1296.24"/>
</g>
<!-- proc~spectrum -->
<g id="proc~~ndmc~~CallsGraph_node50" class="node"><title>proc~spectrum</title>
<g id="a_proc~~ndmc~~CallsGraph_node50"><a xlink:href=".././proc/spectrum.html" xlink:title="spectrum">
<polygon fill="#d9534f" stroke="#d9534f" points="541.5,-1253.88 484.5,-1253.88 484.5,-1229.88 541.5,-1229.88 541.5,-1253.88"/>
<text text-anchor="middle" x="513" y="-1239.48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spectrum</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~spectrum -->
<g id="proc~~ndmc~~CallsGraph_edge81" class="edge"><title>proc~store_photons&#45;&gt;proc~spectrum</title>
<path fill="none" stroke="#000000" d="M370.94,-1291.87C391.697,-1283.4 420.4,-1271.99 446,-1262.88 455.152,-1259.63 465.099,-1256.34 474.43,-1253.35"/>
<polygon fill="#000000" stroke="#000000" points="475.761,-1256.6 484.245,-1250.26 473.655,-1249.93 475.761,-1256.6"/>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_edge85" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M397.562,-516.717C402.093,-514.289 406.331,-511.376 410,-507.883 443.911,-475.602 428.058,-452.128 446,-408.883 463.896,-365.749 487.7,-316.61 501.285,-289.221"/>
<polygon fill="#000000" stroke="#000000" points="504.47,-290.677 505.797,-280.166 498.204,-287.555 504.47,-290.677"/>
</g>
<!-- proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_node51" class="node"><title>proc~init_reservoir</title>
<g id="a_proc~~ndmc~~CallsGraph_node51"><a xlink:href=".././proc/init_reservoir.html" xlink:title="init_reservoir">
<polygon fill="#d9534f" stroke="#d9534f" points="835,-559.883 761,-559.883 761,-535.883 835,-535.883 835,-559.883"/>
<text text-anchor="middle" x="798" y="-545.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_reservoir</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge84" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M385.234,-516.858C393.552,-514.174 402.123,-511.145 410,-507.883 426.715,-500.962 428.439,-493.233 446,-488.883 503.809,-474.564 525.596,-464.654 580,-488.883 601.849,-498.614 594.69,-518.024 616,-528.883 657.944,-550.257 712.374,-553.187 750.549,-551.903"/>
<polygon fill="#000000" stroke="#000000" points="751.029,-555.385 760.862,-551.44 750.715,-548.392 751.029,-555.385"/>
</g>
<!-- proc~merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_node56" class="node"><title>proc~merge_reservoirs</title>
<g id="a_proc~~ndmc~~CallsGraph_node56"><a xlink:href=".././proc/merge_reservoirs.html" xlink:title="merge_reservoirs">
<polygon fill="#d9534f" stroke="#d9534f" points="561.5,-441.883 464.5,-441.883 464.5,-417.883 561.5,-417.883 561.5,-441.883"/>
<text text-anchor="middle" x="513" y="-427.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">merge_reservoirs</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_edge86" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M394.25,-516.764C399.836,-514.318 405.216,-511.389 410,-507.883 432.673,-491.268 423.972,-473.344 446,-455.883 450.637,-452.207 455.858,-448.996 461.281,-446.203"/>
<polygon fill="#000000" stroke="#000000" points="462.946,-449.289 470.53,-441.891 459.988,-442.944 462.946,-449.289"/>
</g>
<!-- proc~num_ranks -->
<g id="proc~~ndmc~~CallsGraph_node57" class="node"><title>proc~num_ranks</title>
<g id="a_proc~~ndmc~~CallsGraph_node57"><a xlink:href=".././proc/num_ranks.html" xlink:title="num_ranks">
<polygon fill="#d94e8f" stroke="#d94e8f" points="546,-563.883 480,-563.883 480,-539.883 546,-539.883 546,-563.883"/>
<text text-anchor="middle" x="513" y="-549.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">num_ranks</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~num_ranks -->
<g id="proc~~ndmc~~CallsGraph_edge87" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~num_ranks</title>
<path fill="none" stroke="#000000" d="M409.677,-538.039C430.051,-540.796 451.812,-543.74 470.004,-546.201"/>
<polygon fill="#000000" stroke="#000000" points="469.609,-549.68 479.988,-547.552 470.548,-542.743 469.609,-549.68"/>
</g>
<!-- proc~my_rank -->
<g id="proc~~ndmc~~CallsGraph_node58" class="node"><title>proc~my_rank</title>
<g id="a_proc~~ndmc~~CallsGraph_node58"><a xlink:href=".././proc/my_rank.html" xlink:title="my_rank">
<polygon fill="#d94e8f" stroke="#d94e8f" points="540,-521.883 486,-521.883 486,-497.883 540,-497.883 540,-521.883"/>
<text text-anchor="middle" x="513" y="-507.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">my_rank</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~my_rank -->
<g id="proc~~ndmc~~CallsGraph_edge88" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~my_rank</title>
<path fill="none" stroke="#000000" d="M409.677,-521.319C432.177,-518.804 456.368,-516.101 475.577,-513.954"/>
<polygon fill="#000000" stroke="#000000" points="476.145,-517.412 485.694,-512.823 475.367,-510.456 476.145,-517.412"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_edge89" class="edge"><title>proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M777.828,-51.897C770.784,-60.8548 777.508,-69.8831 798,-69.8831 810.487,-69.8831 817.862,-66.5305 820.124,-61.8843"/>
<polygon fill="#000000" stroke="#000000" points="823.526,-61.0397 818.172,-51.897 816.656,-62.3827 823.526,-61.0397"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge90" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M812.695,-51.9441C821.995,-60.4434 834.315,-72.3264 844,-83.8831 868.423,-113.025 892.426,-150.134 906.465,-172.939"/>
<polygon fill="#000000" stroke="#000000" points="903.654,-175.051 911.844,-181.772 909.632,-171.411 903.654,-175.051"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge92" class="edge"><title>proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M711.739,-196.831C721.544,-198.792 732.032,-200.89 742.181,-202.919"/>
<polygon fill="#000000" stroke="#000000" points="741.687,-206.39 752.179,-204.919 743.06,-199.526 741.687,-206.39"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge91" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M711.762,-188.949C756.337,-190.01 824.56,-191.635 870.427,-192.727"/>
<polygon fill="#000000" stroke="#000000" points="870.35,-196.226 880.43,-192.965 870.516,-189.228 870.35,-196.226"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge94" class="edge"><title>proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M777.828,-225.897C770.784,-234.855 777.508,-243.883 798,-243.883 810.487,-243.883 817.862,-240.531 820.124,-235.884"/>
<polygon fill="#000000" stroke="#000000" points="823.526,-235.04 818.172,-225.897 816.656,-236.383 823.526,-235.04"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge93" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M843.684,-206.436C852.305,-204.999 861.378,-203.487 870.124,-202.029"/>
<polygon fill="#000000" stroke="#000000" points="870.906,-205.447 880.195,-200.351 869.755,-198.542 870.906,-205.447"/>
</g>
<!-- proc~rswap -->
<g id="proc~~ndmc~~CallsGraph_node65" class="node"><title>proc~rswap</title>
<g id="a_proc~~ndmc~~CallsGraph_node65"><a xlink:href=".././proc/rswap.html" xlink:title="RSWAP">
<polygon fill="#d9534f" stroke="#d9534f" points="693,-807.883 639,-807.883 639,-783.883 693,-783.883 693,-807.883"/>
<text text-anchor="middle" x="666" y="-793.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RSWAP</text>
</a>
</g>
</g>
<!-- proc~elmhes&#45;&gt;proc~rswap -->
<g id="proc~~ndmc~~CallsGraph_edge95" class="edge"><title>proc~elmhes&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M540.302,-795.883C564.769,-795.883 601.446,-795.883 628.696,-795.883"/>
<polygon fill="#000000" stroke="#000000" points="628.999,-799.383 638.999,-795.883 628.999,-792.383 628.999,-799.383"/>
</g>
<!-- proc~update_reservoir&#45;&gt;interface~randind -->
<g id="proc~~ndmc~~CallsGraph_edge96" class="edge"><title>proc~update_reservoir&#45;&gt;interface~randind</title>
<path fill="none" stroke="#000000" d="M705.301,-600.963C722.957,-606.531 743.793,-613.102 761.139,-618.573"/>
<polygon fill="#000000" stroke="#000000" points="760.308,-621.981 770.898,-621.651 762.414,-615.305 760.308,-621.981"/>
</g>
<!-- proc~update_reservoir&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge97" class="edge"><title>proc~update_reservoir&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M713.221,-588.883C762.024,-588.883 837.953,-588.883 882.652,-588.883"/>
<polygon fill="#000000" stroke="#000000" points="882.771,-592.383 892.771,-588.883 882.771,-585.383 882.771,-592.383"/>
</g>
<!-- proc~update_reservoir&#45;&gt;proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge98" class="edge"><title>proc~update_reservoir&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M705.301,-576.803C719.678,-572.269 736.163,-567.07 751.156,-562.342"/>
<polygon fill="#000000" stroke="#000000" points="752.271,-565.66 760.755,-559.314 750.166,-558.984 752.271,-565.66"/>
</g>
<!-- proc~xyz_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_node63" class="node"><title>proc~xyz_to_cyl</title>
<g id="a_proc~~ndmc~~CallsGraph_node63"><a xlink:href=".././proc/xyz_to_cyl.html" xlink:title="xyz_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="697,-1295.88 635,-1295.88 635,-1271.88 697,-1271.88 697,-1295.88"/>
<text text-anchor="middle" x="666" y="-1281.48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_cyl</text>
</a>
</g>
</g>
<!-- proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_edge99" class="edge"><title>proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl</title>
<path fill="none" stroke="#000000" d="M579.792,-1283.88C595.118,-1283.88 610.987,-1283.88 624.816,-1283.88"/>
<polygon fill="#000000" stroke="#000000" points="624.95,-1287.38 634.95,-1283.88 624.95,-1280.38 624.95,-1287.38"/>
</g>
<!-- proc~balback&#45;&gt;proc~rswap -->
<g id="proc~~ndmc~~CallsGraph_edge100" class="edge"><title>proc~balback&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M540.302,-761.199C564.878,-768.034 601.771,-778.296 629.057,-785.886"/>
<polygon fill="#000000" stroke="#000000" points="628.427,-789.343 638.999,-788.651 630.303,-782.599 628.427,-789.343"/>
</g>
<!-- proc~balance&#45;&gt;proc~rswap -->
<g id="proc~~ndmc~~CallsGraph_edge101" class="edge"><title>proc~balance&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M540.302,-830.567C564.878,-823.732 601.771,-813.47 629.057,-805.88"/>
<polygon fill="#000000" stroke="#000000" points="630.303,-809.167 638.999,-803.115 628.427,-802.423 630.303,-809.167"/>
</g>
<!-- proc~init_reservoir&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge102" class="edge"><title>proc~init_reservoir&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M834.355,-559.963C849.667,-565.194 867.571,-571.312 882.96,-576.569"/>
<polygon fill="#000000" stroke="#000000" points="882.062,-579.961 892.656,-579.882 884.325,-573.337 882.062,-579.961"/>
</g>
<!-- proc~lubksb -->
<g id="proc~~ndmc~~CallsGraph_node64" class="node"><title>proc~lubksb</title>
<g id="a_proc~~ndmc~~CallsGraph_node64"><a xlink:href=".././proc/lubksb.html" xlink:title="lubksb">
<polygon fill="#d9534f" stroke="#d9534f" points="693,-952.883 639,-952.883 639,-928.883 693,-928.883 693,-952.883"/>
<text text-anchor="middle" x="666" y="-938.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lubksb</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~lubksb -->
<g id="proc~~ndmc~~CallsGraph_edge104" class="edge"><title>proc~matinv&#45;&gt;proc~lubksb</title>
<path fill="none" stroke="#000000" d="M540.302,-959.877C564.878,-956.134 601.771,-950.514 629.057,-946.358"/>
<polygon fill="#000000" stroke="#000000" points="629.64,-949.809 638.999,-944.843 628.586,-942.889 629.64,-949.809"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~ndmc~~CallsGraph_node70" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~ndmc~~CallsGraph_node70"><a xlink:href=".././proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="693,-994.883 639,-994.883 639,-970.883 693,-970.883 693,-994.883"/>
<text text-anchor="middle" x="666" y="-980.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~ndmc~~CallsGraph_edge103" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M540.302,-967.193C564.878,-970.285 601.771,-974.927 629.057,-978.361"/>
<polygon fill="#000000" stroke="#000000" points="628.64,-981.836 638.999,-979.611 629.514,-974.89 628.64,-981.836"/>
</g>
<!-- proc~approx_le -->
<g id="proc~~ndmc~~CallsGraph_node66" class="node"><title>proc~approx_le</title>
<g id="a_proc~~ndmc~~CallsGraph_node66"><a xlink:href=".././proc/approx_le.html" xlink:title="approx_le">
<polygon fill="#d94e8f" stroke="#d94e8f" points="828,-1131.88 768,-1131.88 768,-1107.88 828,-1107.88 828,-1131.88"/>
<text text-anchor="middle" x="798" y="-1117.48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_le</text>
</a>
</g>
</g>
<!-- proc~in_passive_grid&#45;&gt;proc~approx_le -->
<g id="proc~~ndmc~~CallsGraph_edge106" class="edge"><title>proc~in_passive_grid&#45;&gt;proc~approx_le</title>
<path fill="none" stroke="#000000" d="M709.567,-1119.88C725.09,-1119.88 742.558,-1119.88 757.776,-1119.88"/>
<polygon fill="#000000" stroke="#000000" points="757.901,-1123.38 767.901,-1119.88 757.901,-1116.38 757.901,-1123.38"/>
</g>
<!-- proc~uvw_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_node67" class="node"><title>proc~uvw_to_cyl</title>
<g id="a_proc~~ndmc~~CallsGraph_node67"><a xlink:href=".././proc/uvw_to_cyl.html" xlink:title="uvw_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="830.5,-1255.88 765.5,-1255.88 765.5,-1231.88 830.5,-1231.88 830.5,-1255.88"/>
<text text-anchor="middle" x="798" y="-1241.48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_cyl</text>
</a>
</g>
</g>
<!-- proc~in_passive_grid&#45;&gt;proc~uvw_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_edge105" class="edge"><title>proc~in_passive_grid&#45;&gt;proc~uvw_to_cyl</title>
<path fill="none" stroke="#000000" d="M694.379,-1131.99C701.767,-1135.89 709.506,-1140.59 716,-1145.88 730.845,-1157.99 762.785,-1198.71 781.822,-1223.7"/>
<polygon fill="#000000" stroke="#000000" points="779.138,-1225.95 787.968,-1231.8 784.716,-1221.72 779.138,-1225.95"/>
</g>
<!-- proc~approx_ge -->
<g id="proc~~ndmc~~CallsGraph_node69" class="node"><title>proc~approx_ge</title>
<g id="a_proc~~ndmc~~CallsGraph_node69"><a xlink:href=".././proc/approx_ge.html" xlink:title="approx_ge">
<polygon fill="#d94e8f" stroke="#d94e8f" points="830,-1173.88 766,-1173.88 766,-1149.88 830,-1149.88 830,-1173.88"/>
<text text-anchor="middle" x="798" y="-1159.48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_ge</text>
</a>
</g>
</g>
<!-- proc~in_passive_grid&#45;&gt;proc~approx_ge -->
<g id="proc~~ndmc~~CallsGraph_edge107" class="edge"><title>proc~in_passive_grid&#45;&gt;proc~approx_ge</title>
<path fill="none" stroke="#000000" d="M704.253,-1131.92C720.407,-1137.14 739.377,-1143.27 755.937,-1148.62"/>
<polygon fill="#000000" stroke="#000000" points="755.298,-1152.09 765.89,-1151.83 757.45,-1145.43 755.298,-1152.09"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge110" class="edge"><title>proc~merge_reservoirs&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M561.796,-427.657C603.547,-427.165 665.243,-429.991 716,-446.883 792.694,-472.408 866.185,-536.984 899.844,-569.519"/>
<polygon fill="#000000" stroke="#000000" points="897.563,-572.184 907.152,-576.689 902.465,-567.187 897.563,-572.184"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;proc~update_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge109" class="edge"><title>proc~merge_reservoirs&#45;&gt;proc~update_reservoir</title>
<path fill="none" stroke="#000000" d="M528.681,-442.001C542.413,-453.565 563.259,-471.719 580,-488.883 593.793,-503.025 627.898,-543.888 648.471,-568.785"/>
<polygon fill="#000000" stroke="#000000" points="645.816,-571.068 654.88,-576.555 651.216,-566.614 645.816,-571.068"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge111" class="edge"><title>proc~merge_reservoirs&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M561.529,-438.114C603.653,-446.596 666.05,-462.12 716,-486.883 738.357,-497.967 760.79,-515.479 776.36,-528.902"/>
<polygon fill="#000000" stroke="#000000" points="774.445,-531.88 784.26,-535.871 779.076,-526.631 774.445,-531.88"/>
</g>
<!-- float -->
<g id="proc~~ndmc~~CallsGraph_node71" class="node"><title>float</title>
<polygon fill="#777777" stroke="#777777" points="693,-519.883 639,-519.883 639,-495.883 693,-495.883 693,-519.883"/>
<text text-anchor="middle" x="666" y="-505.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">float</text>
</g>
<!-- proc~merge_reservoirs&#45;&gt;float -->
<g id="proc~~ndmc~~CallsGraph_edge108" class="edge"><title>proc~merge_reservoirs&#45;&gt;float</title>
<path fill="none" stroke="#000000" d="M549.338,-441.927C559.476,-445.88 570.383,-450.625 580,-455.883 597.317,-465.352 599.243,-471.455 616,-481.883 621.028,-485.012 626.469,-488.139 631.833,-491.083"/>
<polygon fill="#000000" stroke="#000000" points="630.235,-494.197 640.702,-495.834 633.54,-488.027 630.235,-494.197"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~ndmc~~CallsGraph_node68" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~ndmc~~CallsGraph_node68"><a xlink:href=".././proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="693,-723.883 639,-723.883 639,-699.883 693,-699.883 693,-723.883"/>
<text text-anchor="middle" x="666" y="-709.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~ndmc~~CallsGraph_edge112" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M540.302,-711.883C564.769,-711.883 601.446,-711.883 628.696,-711.883"/>
<polygon fill="#000000" stroke="#000000" points="628.999,-715.383 638.999,-711.883 628.999,-708.383 628.999,-715.383"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge114" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M829.281,-1519.84C843.272,-1517.5 860.146,-1514.69 875.468,-1512.14"/>
<polygon fill="#000000" stroke="#000000" points="876.484,-1515.52 885.772,-1510.42 875.333,-1508.61 876.484,-1515.52"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge113" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M815.184,-1512.61C835.696,-1497.06 871.229,-1470.11 894.927,-1452.14"/>
<polygon fill="#000000" stroke="#000000" points="897.219,-1454.79 903.073,-1445.96 892.99,-1449.21 897.219,-1454.79"/>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge115" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M677.167,-1296.27C687.1,-1308.38 702.632,-1327.37 716,-1343.88 738.642,-1371.86 764.649,-1404.35 780.954,-1424.77"/>
<polygon fill="#000000" stroke="#000000" points="778.335,-1427.1 787.309,-1432.73 783.806,-1422.73 778.335,-1427.1"/>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_edge116" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl</title>
<path fill="none" stroke="#000000" d="M697.151,-1274.61C714.525,-1269.26 736.614,-1262.46 755.596,-1256.62"/>
<polygon fill="#000000" stroke="#000000" points="756.67,-1259.95 765.198,-1253.67 754.611,-1253.26 756.67,-1259.95"/>
</g>
<!-- proc~approx_eq -->
<g id="proc~~ndmc~~CallsGraph_node74" class="node"><title>proc~approx_eq</title>
<g id="a_proc~~ndmc~~CallsGraph_node74"><a xlink:href=".././proc/approx_eq.html" xlink:title="approx_eq">
<polygon fill="#d94e8f" stroke="#d94e8f" points="952,-1152.88 888,-1152.88 888,-1128.88 952,-1128.88 952,-1152.88"/>
<text text-anchor="middle" x="920" y="-1138.48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_eq</text>
</a>
</g>
</g>
<!-- proc~approx_le&#45;&gt;proc~approx_eq -->
<g id="proc~~ndmc~~CallsGraph_edge117" class="edge"><title>proc~approx_le&#45;&gt;proc~approx_eq</title>
<path fill="none" stroke="#000000" d="M828.049,-1124.97C842.984,-1127.58 861.442,-1130.81 877.819,-1133.68"/>
<polygon fill="#000000" stroke="#000000" points="877.243,-1137.13 887.697,-1135.4 878.45,-1130.23 877.243,-1137.13"/>
</g>
<!-- proc~comdiv -->
<g id="proc~~ndmc~~CallsGraph_node72" class="node"><title>proc~comdiv</title>
<g id="a_proc~~ndmc~~CallsGraph_node72"><a xlink:href=".././proc/comdiv.html" xlink:title="Comdiv">
<polygon fill="#d9534f" stroke="#d9534f" points="825,-723.883 771,-723.883 771,-699.883 825,-699.883 825,-723.883"/>
<text text-anchor="middle" x="798" y="-709.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Comdiv</text>
</a>
</g>
</g>
<!-- proc~hqrvec&#45;&gt;proc~comdiv -->
<g id="proc~~ndmc~~CallsGraph_edge118" class="edge"><title>proc~hqrvec&#45;&gt;proc~comdiv</title>
<path fill="none" stroke="#000000" d="M693.307,-711.883C712.69,-711.883 739.29,-711.883 760.695,-711.883"/>
<polygon fill="#000000" stroke="#000000" points="760.732,-715.383 770.732,-711.883 760.732,-708.383 760.732,-715.383"/>
</g>
<!-- proc~approx_ge&#45;&gt;proc~approx_eq -->
<g id="proc~~ndmc~~CallsGraph_edge119" class="edge"><title>proc~approx_ge&#45;&gt;proc~approx_eq</title>
<path fill="none" stroke="#000000" d="M830.215,-1156.42C844.799,-1153.87 862.355,-1150.8 877.993,-1148.06"/>
<polygon fill="#000000" stroke="#000000" points="878.694,-1151.49 887.941,-1146.32 877.487,-1144.59 878.694,-1151.49"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~ndmc~~CallsGraph_node73" class="node"><title>proc~outerprod</title>
<g id="a_proc~~ndmc~~CallsGraph_node73"><a xlink:href=".././proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="827.5,-1003.88 768.5,-1003.88 768.5,-979.883 827.5,-979.883 827.5,-1003.88"/>
<text text-anchor="middle" x="798" y="-989.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~ndmc~~CallsGraph_edge121" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M693.307,-984.704C711.967,-985.996 737.316,-987.751 758.28,-989.202"/>
<polygon fill="#000000" stroke="#000000" points="758.258,-992.709 768.476,-989.908 758.742,-985.726 758.258,-992.709"/>
</g>
<!-- proc~swap -->
<g id="proc~~ndmc~~CallsGraph_node75" class="node"><title>proc~swap</title>
<g id="a_proc~~ndmc~~CallsGraph_node75"><a xlink:href=".././proc/swap.html" xlink:title="swap">
<polygon fill="#d9534f" stroke="#d9534f" points="825,-961.883 771,-961.883 771,-937.883 825,-937.883 825,-961.883"/>
<text text-anchor="middle" x="798" y="-947.483" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swap</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~swap -->
<g id="proc~~ndmc~~CallsGraph_edge120" class="edge"><title>proc~ludcmp&#45;&gt;proc~swap</title>
<path fill="none" stroke="#000000" d="M693.307,-976.205C712.778,-971.262 739.532,-964.471 760.987,-959.025"/>
<polygon fill="#000000" stroke="#000000" points="761.9,-962.404 770.732,-956.551 760.178,-955.619 761.9,-962.404"/>
</g>
</g>
</svg>
</div><script>var panprocndmcCallsGraph = svgPanZoom('#procndmcCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~ndmc~~CalledByGraph Pages: 1 -->
<svg id="procndmcCalledByGraph" width="152pt" height="32pt"
 viewBox="0.00 0.00 152.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~ndmc~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~ndmc~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 148,-28 148,4 -4,4"/>
<!-- proc~ndmc -->
<g id="proc~~ndmc~~CalledByGraph_node1" class="node"><title>proc~ndmc</title>
<polygon fill="none" stroke="black" points="144,-24 90,-24 90,-0 144,-0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">ndmc</text>
</g>
<!-- program~fidasim -->
<g id="proc~~ndmc~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~ndmc~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~ndmc -->
<g id="proc~~ndmc~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~ndmc</title>
<path fill="none" stroke="#000000" d="M54.4029,-12C62.3932,-12 71.3106,-12 79.8241,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.919,-15.5001 89.919,-12 79.919,-8.5001 79.919,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/ndmc.html#src">ndmc</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">ndmc</span><span class="w"></span>
<span class="w">    </span><span class="c">!+ Calculates neutral beam deposition and spectra</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">neut_type</span><span class="w"> </span><span class="c">!! full half third energy</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">nlaunch</span><span class="w">   </span><span class="c">!! nr. of markers</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">nneutrals</span><span class="w"> </span><span class="c">!! # NBI particles</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">vnbi</span><span class="w"> </span><span class="c">!! velocities(full..)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rnbi</span><span class="w"> </span><span class="c">!! initial position</span>

<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">jj</span><span class="p">,</span><span class="w"> </span><span class="n">ii</span><span class="p">,</span><span class="w"> </span><span class="n">kk</span><span class="p">,</span><span class="w"> </span><span class="n">cnt</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ntrack</span><span class="p">,</span><span class="w"> </span><span class="n">ic</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">ParticleTrack</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ntrack</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tracks</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">plasma</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fields</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">states</span><span class="p">,</span><span class="w"> </span><span class="n">dens</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">photons</span><span class="p">,</span><span class="w"> </span><span class="n">iflux</span><span class="p">,</span><span class="n">flux_tot</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ind</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ri</span><span class="p">,</span><span class="n">ri_gc</span><span class="p">,</span><span class="n">r_gyro</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">randomu</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">randi</span><span class="w"></span>
<span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">err</span><span class="w"></span>

<span class="w">    </span><span class="c">!! Initialize Neutral Population</span>
<span class="w">    </span><span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">half</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">third</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i10)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of birth markers: 3 x&quot;,i10)&#39;</span><span class="p">)</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="o">*</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_birth</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">    endif</span><span class="w"></span>

<span class="w">    </span><span class="c">!! # of injected neutrals = NBI power/energy_per_particle</span>
<span class="w">    </span><span class="n">nneutrals</span><span class="o">=</span><span class="mf">1.d6</span><span class="o">*</span><span class="n">nbi</span><span class="p">%</span><span class="n">pinj</span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.d3</span><span class="o">*</span><span class="n">nbi</span><span class="p">%</span><span class="n">einj</span><span class="o">*</span><span class="n">e0</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="o">*</span><span class="p">(</span><span class="w"> </span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="o">+</span><span class="w">  </span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.d0</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="o">+</span><span class="w">  </span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mf">3.d0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">nlaunch</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="c">!$OMP PARALLEL DO schedule(guided) &amp;</span>
<span class="w">    </span><span class="c">!$OMP&amp; private(vnbi,rnbi,tracks,ntrack,plasma,fields,randi,flux_tot, &amp;</span>
<span class="w">    </span><span class="c">!$OMP&amp; states,dens,iflux,photons,neut_type,jj,ii,kk,ind,err,ri,ri_gc,r_gyro)</span>
<span class="w">    </span><span class="n">loop_over_markers</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">ii</span><span class="o">=</span><span class="n">istart</span><span class="p">,</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="p">,</span><span class="n">istep</span><span class="w"></span>
<span class="w">        </span><span class="n">energy_fractions</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">neut_type</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="w"></span>
<span class="w">            </span><span class="c">!! (type = 1: full energy, =2: half energy, =3: third energy</span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="n">neut_type</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">energy_fractions</span><span class="w"></span>

<span class="w">            </span><span class="k">call </span><span class="n">mc_nbi</span><span class="p">(</span><span class="n">vnbi</span><span class="p">,</span><span class="n">neut_type</span><span class="p">,</span><span class="n">rnbi</span><span class="p">,</span><span class="n">err</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">energy_fractions</span><span class="w"></span>

<span class="w">            </span><span class="k">call </span><span class="n">track</span><span class="p">(</span><span class="n">rnbi</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">tracks</span><span class="p">,</span><span class="n">ntrack</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">ntrack</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">energy_fractions</span><span class="w"></span>

<span class="w">            </span><span class="c">!! Solve collisional radiative model along track</span>
<span class="w">            </span><span class="n">flux_tot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.d0</span><span class="w"></span>
<span class="w">            </span><span class="n">states</span><span class="o">=</span><span class="mf">0.d0</span><span class="w"></span>
<span class="w">            </span><span class="n">states</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">nneutrals</span><span class="o">*</span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="n">neut_type</span><span class="p">)</span><span class="o">/</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="w"></span>
<span class="w">            </span><span class="n">loop_along_track</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">jj</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ntrack</span><span class="w"></span>
<span class="w">                </span><span class="n">iflux</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="n">ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">ind</span><span class="w"></span>
<span class="w">                </span><span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">call </span><span class="n">colrad</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">beam_mass</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="nb">time</span><span class="p">,</span><span class="n">states</span><span class="p">,</span><span class="n">dens</span><span class="p">,</span><span class="n">photons</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="n">dens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dens</span><span class="o">/</span><span class="n">nlaunch</span><span class="w"></span>
<span class="w">                </span><span class="k">call </span><span class="n">store_neutrals</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">neut_type</span><span class="p">,</span><span class="n">dens</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">flux</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">iflux</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">))</span><span class="o">/</span><span class="n">nlaunch</span><span class="w"></span>
<span class="w">                </span><span class="n">flux_tot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">flux_tot</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">flux</span><span class="o">*</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    call </span><span class="n">store_births</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">neut_type</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">flux</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">endif</span>

<span class="k">                if</span><span class="p">((</span><span class="n">photons</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_bes</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    call </span><span class="n">store_nbi_photons</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">beam_lambda0</span><span class="p">,</span><span class="w"> </span><span class="n">photons</span><span class="o">/</span><span class="n">nlaunch</span><span class="p">,</span><span class="n">neut_type</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">endif</span>
<span class="k">            enddo </span><span class="n">loop_along_track</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">((</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">flux_tot</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">                </span><span class="c">!! Sample according to deposited flux along neutral trajectory</span>
<span class="w">                </span><span class="c">!$OMP CRITICAL(ndmc_birth)</span>
<span class="w">                </span><span class="k">do </span><span class="n">kk</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_birth</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">randind</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ntrack</span><span class="p">)%</span><span class="n">flux</span><span class="p">,</span><span class="n">randi</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">randu</span><span class="p">(</span><span class="n">randomu</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">neut_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neut_type</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">energy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbi</span><span class="p">%</span><span class="n">einj</span><span class="o">/</span><span class="kt">real</span><span class="p">(</span><span class="n">neut_type</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">flux_tot</span><span class="o">/</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_birth</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tracks</span><span class="p">(</span><span class="n">randi</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">ind</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">vi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vnbi</span><span class="w"></span>
<span class="w">                    </span><span class="n">ri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tracks</span><span class="p">(</span><span class="n">randi</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">pos</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">vnbi</span><span class="o">*</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="n">randi</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="nb">time</span><span class="o">*</span><span class="p">(</span><span class="n">randomu</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">))</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">ri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ri</span><span class="w"></span>

<span class="w">                    </span><span class="k">call </span><span class="n">get_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">pitch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dot_product</span><span class="p">(</span><span class="n">fields</span><span class="p">%</span><span class="n">b_norm</span><span class="p">,</span><span class="n">vnbi</span><span class="o">/</span><span class="nb">norm2</span><span class="p">(</span><span class="n">vnbi</span><span class="p">))</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">gyro_step</span><span class="p">(</span><span class="n">vnbi</span><span class="p">,</span><span class="n">fields</span><span class="p">,</span><span class="n">beam_mass</span><span class="p">,</span><span class="n">r_gyro</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">ri_gc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ri</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r_gyro</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                </span><span class="k">enddo</span><span class="w"></span>
<span class="w">                </span><span class="c">!$OMP END CRITICAL(ndmc_birth)</span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">        enddo </span><span class="n">energy_fractions</span><span class="w"></span>
<span class="w">    </span><span class="k">enddo </span><span class="n">loop_over_markers</span><span class="w"></span>
<span class="w">    </span><span class="c">!$OMP END PARALLEL DO</span>

<span class="cp">#ifdef _MPI</span>
<span class="w">    </span><span class="c">!! Combine beam neutrals</span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_merge_populations</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_merge_populations</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">half</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_merge_populations</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">third</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">nbi_outside</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">dens</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span><span class="w"></span>
<span class="w">    </span><span class="c">!! Combine spectra</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_bes</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">full</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">half</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">third</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span><span class="w"></span>
<span class="cp">#endif</span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">nbi_outside</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="k">        if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T4,a, f6.2,a)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Percent of markers outside the grid: &#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                                  </span><span class="mi">10</span><span class="mf">0.</span><span class="o">*</span><span class="n">nbi_outside</span><span class="o">/</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="p">),</span><span class="s1">&#39;%&#39;</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">        if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">%</span><span class="n">dens</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">stop</span><span class="w"> </span><span class="s1">&#39;Beam does not intersect the grid!&#39;</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">end subroutine </span><span class="n">ndmc</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>