<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="">
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>ndmc &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>User Guide</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>ndmc
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.7% of total for procedures.">94 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
     <li><a href='../module/libfida.html'>libfida</a></li>
     <li class="active">ndmc</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/ndmc.html#src">ndmc</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public subroutine ndmc()</h2>
    

    <p>Calculates neutral beam deposition and spectra</p>

    <h3>Arguments</h3>
    <em>None</em>
    <br>
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~ndmc~~CallsGraph Pages: 1 -->
<svg id="procndmcCallsGraph" width="641pt" height="1053pt"
 viewBox="0.00 0.00 641.00 1053.47" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~ndmc~~CallsGraph" class="graph" transform="scale(0.66219 0.66219) rotate(0) translate(4 1586.89)">
<title>proc~~ndmc~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1586.89 964,-1586.89 964,4 -4,4"/>
<!-- proc~ndmc -->
<g id="proc~~ndmc~~CallsGraph_node1" class="node"><title>proc~ndmc</title>
<polygon fill="none" stroke="black" points="54,-1003 0,-1003 0,-979 54,-979 54,-1003"/>
<text text-anchor="middle" x="27" y="-988.6" font-family="Helvetica,sans-Serif" font-size="10.50">ndmc</text>
</g>
<!-- proc~get_plasma -->
<g id="proc~~ndmc~~CallsGraph_node2" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~ndmc~~CallsGraph_node2"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="547,-1532 479,-1532 479,-1508 547,-1508 547,-1532"/>
<text text-anchor="middle" x="513" y="-1517.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~get_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge1" class="edge"><title>proc~ndmc&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M28.7849,-1003.2C32.5655,-1058.89 50.3663,-1288.79 90,-1347 177.663,-1475.75 379.772,-1508.78 468.686,-1517.18"/>
<polygon fill="#000000" stroke="#000000" points="468.431,-1520.67 478.701,-1518.06 469.048,-1513.7 468.431,-1520.67"/>
</g>
<!-- interface~randind -->
<g id="proc~~ndmc~~CallsGraph_node3" class="node"><title>interface~randind</title>
<g id="a_proc~~ndmc~~CallsGraph_node3"><a xlink:href=".././interface/randind.html" xlink:title="randind">
<polygon fill="#a7506f" stroke="#a7506f" points="825,-636 771,-636 771,-612 825,-612 825,-636"/>
<text text-anchor="middle" x="798" y="-621.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;interface~randind -->
<g id="proc~~ndmc~~CallsGraph_edge2" class="edge"><title>proc~ndmc&#45;&gt;interface~randind</title>
<path fill="none" stroke="#000000" d="M34.9674,-978.983C60.7254,-935.564 155.149,-785.113 272,-704 426.997,-596.407 669.683,-609.711 760.81,-619.378"/>
<polygon fill="#000000" stroke="#000000" points="760.581,-622.874 770.906,-620.501 761.355,-615.917 760.581,-622.874"/>
</g>
<!-- proc~mc_nbi -->
<g id="proc~~ndmc~~CallsGraph_node4" class="node"><title>proc~mc_nbi</title>
<g id="a_proc~~ndmc~~CallsGraph_node4"><a xlink:href=".././proc/mc_nbi.html" xlink:title="mc_nbi">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-1124 314,-1124 314,-1100 368,-1100 368,-1124"/>
<text text-anchor="middle" x="341" y="-1109.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_nbi</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~mc_nbi -->
<g id="proc~~ndmc~~CallsGraph_edge3" class="edge"><title>proc~ndmc&#45;&gt;proc~mc_nbi</title>
<path fill="none" stroke="#000000" d="M38.1,-1003.36C49.4053,-1016.39 68.9219,-1036.57 90,-1048 126.873,-1068 243.565,-1092.98 303.577,-1104.96"/>
<polygon fill="#000000" stroke="#000000" points="303.255,-1108.46 313.744,-1106.97 304.614,-1101.6 303.255,-1108.46"/>
</g>
<!-- proc~store_births -->
<g id="proc~~ndmc~~CallsGraph_node5" class="node"><title>proc~store_births</title>
<g id="a_proc~~ndmc~~CallsGraph_node5"><a xlink:href=".././proc/store_births.html" xlink:title="store_births">
<polygon fill="#d9534f" stroke="#d9534f" points="197.5,-1166 128.5,-1166 128.5,-1142 197.5,-1142 197.5,-1166"/>
<text text-anchor="middle" x="163" y="-1151.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_births</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~store_births -->
<g id="proc~~ndmc~~CallsGraph_edge4" class="edge"><title>proc~ndmc&#45;&gt;proc~store_births</title>
<path fill="none" stroke="#000000" d="M29.8034,-1003.31C34.4851,-1030.78 49.6044,-1097.47 90,-1133 98.0015,-1140.04 108.246,-1144.72 118.481,-1147.84"/>
<polygon fill="#000000" stroke="#000000" points="117.659,-1151.24 128.218,-1150.37 119.421,-1144.47 117.659,-1151.24"/>
</g>
<!-- proc~store_neutrals -->
<g id="proc~~ndmc~~CallsGraph_node6" class="node"><title>proc~store_neutrals</title>
<g id="a_proc~~ndmc~~CallsGraph_node6"><a xlink:href=".././proc/store_neutrals.html" xlink:title="store_neutrals">
<polygon fill="#d9534f" stroke="#d9534f" points="203.5,-595 122.5,-595 122.5,-571 203.5,-571 203.5,-595"/>
<text text-anchor="middle" x="163" y="-580.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_neutrals</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~store_neutrals -->
<g id="proc~~ndmc~~CallsGraph_edge5" class="edge"><title>proc~ndmc&#45;&gt;proc~store_neutrals</title>
<path fill="none" stroke="#000000" d="M28.3575,-978.899C30.3178,-920.409 41.5222,-667.429 90,-609 95.9826,-601.789 104.131,-596.578 112.798,-592.812"/>
<polygon fill="#000000" stroke="#000000" points="114.176,-596.034 122.328,-589.267 111.735,-589.473 114.176,-596.034"/>
</g>
<!-- proc~track -->
<g id="proc~~ndmc~~CallsGraph_node7" class="node"><title>proc~track</title>
<g id="a_proc~~ndmc~~CallsGraph_node7"><a xlink:href=".././proc/track.html" xlink:title="track">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-1414 314,-1414 314,-1390 368,-1390 368,-1414"/>
<text text-anchor="middle" x="341" y="-1399.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~track -->
<g id="proc~~ndmc~~CallsGraph_edge6" class="edge"><title>proc~ndmc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M29.8974,-1003.11C35.1697,-1033.97 52.1703,-1117.17 90,-1175 151.611,-1269.18 261.405,-1349.76 312.47,-1384.18"/>
<polygon fill="#000000" stroke="#000000" points="310.748,-1387.24 321.01,-1389.87 314.631,-1381.41 310.748,-1387.24"/>
</g>
<!-- proc~store_nbi_photons -->
<g id="proc~~ndmc~~CallsGraph_node8" class="node"><title>proc~store_nbi_photons</title>
<g id="a_proc~~ndmc~~CallsGraph_node8"><a xlink:href=".././proc/store_nbi_photons.html" xlink:title="store_nbi_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="213.5,-1124 112.5,-1124 112.5,-1100 213.5,-1100 213.5,-1124"/>
<text text-anchor="middle" x="163" y="-1109.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_nbi_photons</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~store_nbi_photons -->
<g id="proc~~ndmc~~CallsGraph_edge7" class="edge"><title>proc~ndmc&#45;&gt;proc~store_nbi_photons</title>
<path fill="none" stroke="#000000" d="M32.7907,-1003C41.3509,-1022.99 61.1224,-1063.14 90,-1086 94.673,-1089.7 99.9182,-1092.9 105.392,-1095.66"/>
<polygon fill="#000000" stroke="#000000" points="104.205,-1098.97 114.758,-1099.91 107.097,-1092.59 104.205,-1098.97"/>
</g>
<!-- proc~colrad -->
<g id="proc~~ndmc~~CallsGraph_node9" class="node"><title>proc~colrad</title>
<g id="a_proc~~ndmc~~CallsGraph_node9"><a xlink:href=".././proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="190,-960 136,-960 136,-936 190,-936 190,-960"/>
<text text-anchor="middle" x="163" y="-945.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~colrad -->
<g id="proc~~ndmc~~CallsGraph_edge8" class="edge"><title>proc~ndmc&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M54.1547,-982.607C74.7222,-976.007 103.594,-966.742 126.289,-959.46"/>
<polygon fill="#000000" stroke="#000000" points="127.459,-962.76 135.911,-956.372 125.32,-956.095 127.459,-962.76"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_node10" class="node"><title>proc~get_fields</title>
<g id="a_proc~~ndmc~~CallsGraph_node10"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="542,-1490 484,-1490 484,-1466 542,-1466 542,-1490"/>
<text text-anchor="middle" x="513" y="-1475.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_edge9" class="edge"><title>proc~ndmc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M28.1479,-1003.14C29.1512,-1043.31 36.576,-1174.48 90,-1264 145.042,-1356.23 176.318,-1374.2 272,-1423 337.986,-1456.66 424.606,-1469.95 473.691,-1475.03"/>
<polygon fill="#000000" stroke="#000000" points="473.575,-1478.53 483.867,-1476.02 474.253,-1471.56 473.575,-1478.53"/>
</g>
<!-- interface~randu -->
<g id="proc~~ndmc~~CallsGraph_node11" class="node"><title>interface~randu</title>
<g id="a_proc~~ndmc~~CallsGraph_node11"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="947,-596 893,-596 893,-572 947,-572 947,-596"/>
<text text-anchor="middle" x="920" y="-581.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge10" class="edge"><title>proc~ndmc&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M54.1294,-997.07C107.518,-1008.92 233.103,-1034 340,-1034 340,-1034 340,-1034 667,-1034 865.558,-1034 909.211,-696.352 917.337,-606.008"/>
<polygon fill="#000000" stroke="#000000" points="920.825,-606.295 918.177,-596.036 913.85,-605.707 920.825,-606.295"/>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_node12" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~ndmc~~CallsGraph_node12"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="549.5,-270 476.5,-270 476.5,-246 549.5,-246 549.5,-270"/>
<text text-anchor="middle" x="513" y="-255.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_edge11" class="edge"><title>proc~ndmc&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M28.6447,-978.868C32.6799,-904.92 55.4169,-516.726 90,-478 187.367,-368.969 288.848,-483.794 410,-402 456.053,-370.908 488.049,-311.592 502.79,-279.651"/>
<polygon fill="#000000" stroke="#000000" points="506.079,-280.871 506.966,-270.313 499.689,-278.013 506.079,-280.871"/>
</g>
<!-- proc~init_neutral_population -->
<g id="proc~~ndmc~~CallsGraph_node13" class="node"><title>proc~init_neutral_population</title>
<g id="a_proc~~ndmc~~CallsGraph_node13"><a xlink:href=".././proc/init_neutral_population.html" xlink:title="init_neutral_population">
<polygon fill="#d9534f" stroke="#d9534f" points="223.5,-511 102.5,-511 102.5,-487 223.5,-487 223.5,-511"/>
<text text-anchor="middle" x="163" y="-496.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_neutral_population</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~init_neutral_population -->
<g id="proc~~ndmc~~CallsGraph_edge12" class="edge"><title>proc~ndmc&#45;&gt;proc~init_neutral_population</title>
<path fill="none" stroke="#000000" d="M27.8719,-978.779C27.42,-912.008 28.5197,-591.681 90,-520 91.1947,-518.607 92.4761,-517.304 93.831,-516.085"/>
<polygon fill="#000000" stroke="#000000" points="96.2347,-518.667 102.303,-509.982 92.1434,-512.987 96.2347,-518.667"/>
</g>
<!-- proc~parallel_merge_populations -->
<g id="proc~~ndmc~~CallsGraph_node14" class="node"><title>proc~parallel_merge_populations</title>
<g id="a_proc~~ndmc~~CallsGraph_node14"><a xlink:href=".././proc/parallel_merge_populations.html" xlink:title="parallel_merge_populations">
<polygon fill="#d9534f" stroke="#d9534f" points="235.5,-553 90.5,-553 90.5,-529 235.5,-529 235.5,-553"/>
<text text-anchor="middle" x="163" y="-538.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_merge_populations</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~parallel_merge_populations -->
<g id="proc~~ndmc~~CallsGraph_edge13" class="edge"><title>proc~ndmc&#45;&gt;proc~parallel_merge_populations</title>
<path fill="none" stroke="#000000" d="M28.0469,-978.636C28.5368,-915.186 33.8618,-626.621 90,-562 90.8646,-561.005 91.7734,-560.055 92.7217,-559.15"/>
<polygon fill="#000000" stroke="#000000" points="94.8868,-561.9 100.682,-553.031 90.6206,-556.35 94.8868,-561.9"/>
</g>
<!-- proc~gyro_step -->
<g id="proc~~ndmc~~CallsGraph_node15" class="node"><title>proc~gyro_step</title>
<g id="a_proc~~ndmc~~CallsGraph_node15"><a xlink:href=".././proc/gyro_step.html" xlink:title="gyro_step">
<polygon fill="#d9534f" stroke="#d9534f" points="193,-393 133,-393 133,-369 193,-369 193,-393"/>
<text text-anchor="middle" x="163" y="-378.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_step</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~gyro_step -->
<g id="proc~~ndmc~~CallsGraph_edge14" class="edge"><title>proc~ndmc&#45;&gt;proc~gyro_step</title>
<path fill="none" stroke="#000000" d="M28.524,-978.837C32.0549,-899.174 53.3517,-453.735 90,-407 98.0888,-396.685 110.633,-390.459 122.998,-386.702"/>
<polygon fill="#000000" stroke="#000000" points="123.973,-390.065 132.788,-384.188 122.231,-383.285 123.973,-390.065"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_node26" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~ndmc~~CallsGraph_node26"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="696.5,-1369 635.5,-1369 635.5,-1345 696.5,-1345 696.5,-1369"/>
<text text-anchor="middle" x="666" y="-1354.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge15" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M547.25,-1515.94C558.947,-1512.97 571.325,-1507.84 580,-1499 619.298,-1458.95 578.686,-1419.9 616,-1378 618.908,-1374.73 622.412,-1371.96 626.193,-1369.6"/>
<polygon fill="#000000" stroke="#000000" points="628.106,-1372.55 635.367,-1364.84 624.879,-1366.34 628.106,-1372.55"/>
</g>
<!-- proc~get_position -->
<g id="proc~~ndmc~~CallsGraph_node28" class="node"><title>proc~get_position</title>
<g id="a_proc~~ndmc~~CallsGraph_node28"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="701,-1567 631,-1567 631,-1543 701,-1543 701,-1567"/>
<text text-anchor="middle" x="666" y="-1552.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~ndmc~~CallsGraph_edge17" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M547.138,-1527.68C568.863,-1532.72 597.508,-1539.36 621.118,-1544.83"/>
<polygon fill="#000000" stroke="#000000" points="620.361,-1548.25 630.893,-1547.09 621.942,-1541.43 620.361,-1548.25"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_node32" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~ndmc~~CallsGraph_node32"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="832,-1449 764,-1449 764,-1425 832,-1425 832,-1449"/>
<text text-anchor="middle" x="798" y="-1434.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge16" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M547.259,-1512.99C587.601,-1504.16 657.475,-1487.86 716,-1469 730.476,-1464.33 746.081,-1458.4 759.693,-1452.9"/>
<polygon fill="#000000" stroke="#000000" points="761.28,-1456.04 769.208,-1449.01 758.627,-1449.56 761.28,-1456.04"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_node42" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~ndmc~~CallsGraph_node42"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="954,-1509 886,-1509 886,-1485 954,-1485 954,-1509"/>
<text text-anchor="middle" x="920" y="-1494.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge18" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M529.876,-1532.07C549.07,-1545.83 582.929,-1567.52 616,-1576 717.091,-1601.93 836.957,-1544.54 890.591,-1514.22"/>
<polygon fill="#000000" stroke="#000000" points="892.602,-1517.1 899.517,-1509.07 889.106,-1511.03 892.602,-1517.1"/>
</g>
<!-- proc~mc_nbi&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge22" class="edge"><title>proc~mc_nbi&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M368.383,-1105.98C389.334,-1101.36 419.423,-1095.11 446,-1091 533.914,-1077.4 779.463,-1109.23 844,-1048 908.804,-986.52 917.62,-690.827 918.814,-606.495"/>
<polygon fill="#000000" stroke="#000000" points="922.317,-606.29 918.935,-596.249 915.317,-606.207 922.317,-606.29"/>
</g>
<!-- proc~grid_intersect -->
<g id="proc~~ndmc~~CallsGraph_node19" class="node"><title>proc~grid_intersect</title>
<g id="a_proc~~ndmc~~CallsGraph_node19"><a xlink:href=".././proc/grid_intersect.html" xlink:title="grid_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="551.5,-1166 474.5,-1166 474.5,-1142 551.5,-1142 551.5,-1166"/>
<text text-anchor="middle" x="513" y="-1151.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">grid_intersect</text>
</a>
</g>
</g>
<!-- proc~mc_nbi&#45;&gt;proc~grid_intersect -->
<g id="proc~~ndmc~~CallsGraph_edge19" class="edge"><title>proc~mc_nbi&#45;&gt;proc~grid_intersect</title>
<path fill="none" stroke="#000000" d="M368.19,-1118.47C393.823,-1124.8 433.451,-1134.59 464.622,-1142.29"/>
<polygon fill="#000000" stroke="#000000" points="463.87,-1145.71 474.417,-1144.71 465.549,-1138.92 463.87,-1145.71"/>
</g>
<!-- proc~mc_nbi&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge20" class="edge"><title>proc~mc_nbi&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M358.891,-1124.2C378.854,-1138.14 413.481,-1160.85 446,-1175 502.761,-1199.7 533.506,-1172.13 580,-1213 610.507,-1239.82 594.948,-1262.26 616,-1297 624.75,-1311.44 636.701,-1326.14 646.61,-1337.38"/>
<polygon fill="#000000" stroke="#000000" points="644.092,-1339.82 653.389,-1344.9 649.291,-1335.13 644.092,-1339.82"/>
</g>
<!-- interface~randn -->
<g id="proc~~ndmc~~CallsGraph_node37" class="node"><title>interface~randn</title>
<g id="a_proc~~ndmc~~CallsGraph_node37"><a xlink:href=".././interface/randn.html" xlink:title="randn">
<polygon fill="#a7506f" stroke="#a7506f" points="540,-1124 486,-1124 486,-1100 540,-1100 540,-1124"/>
<text text-anchor="middle" x="513" y="-1109.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randn</text>
</a>
</g>
</g>
<!-- proc~mc_nbi&#45;&gt;interface~randn -->
<g id="proc~~ndmc~~CallsGraph_edge21" class="edge"><title>proc~mc_nbi&#45;&gt;interface~randn</title>
<path fill="none" stroke="#000000" d="M368.19,-1112C396.892,-1112 443.14,-1112 475.416,-1112"/>
<polygon fill="#000000" stroke="#000000" points="475.78,-1115.5 485.78,-1112 475.78,-1108.5 475.78,-1115.5"/>
</g>
<!-- proc~update_neutrals -->
<g id="proc~~ndmc~~CallsGraph_node38" class="node"><title>proc~update_neutrals</title>
<g id="a_proc~~ndmc~~CallsGraph_node38"><a xlink:href=".././proc/update_neutrals.html" xlink:title="update_neutrals">
<polygon fill="#d9534f" stroke="#d9534f" points="386,-595 296,-595 296,-571 386,-571 386,-595"/>
<text text-anchor="middle" x="341" y="-580.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_neutrals</text>
</a>
</g>
</g>
<!-- proc~store_neutrals&#45;&gt;proc~update_neutrals -->
<g id="proc~~ndmc~~CallsGraph_edge23" class="edge"><title>proc~store_neutrals&#45;&gt;proc~update_neutrals</title>
<path fill="none" stroke="#000000" d="M203.937,-583C228.112,-583 259.267,-583 285.664,-583"/>
<polygon fill="#000000" stroke="#000000" points="285.897,-586.5 295.896,-583 285.896,-579.5 285.897,-586.5"/>
</g>
<!-- proc~track&#45;&gt;proc~get_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge24" class="edge"><title>proc~track&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M351.908,-1414.26C369.024,-1434.67 406.148,-1475.69 446,-1499 453.157,-1503.19 461.248,-1506.64 469.25,-1509.46"/>
<polygon fill="#000000" stroke="#000000" points="468.305,-1512.83 478.897,-1512.58 470.459,-1506.17 468.305,-1512.83"/>
</g>
<!-- proc~track&#45;&gt;proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_edge27" class="edge"><title>proc~track&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M364.654,-1414.26C392.706,-1429.39 437.807,-1453.56 446,-1457 454.957,-1460.76 464.833,-1464.24 474.156,-1467.23"/>
<polygon fill="#000000" stroke="#000000" points="473.398,-1470.66 483.986,-1470.29 475.477,-1463.98 473.398,-1470.66"/>
</g>
<!-- proc~track&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge26" class="edge"><title>proc~track&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M368.208,-1400.34C412.205,-1397.3 503.605,-1389.95 580,-1377 594.914,-1374.47 611.115,-1370.88 625.335,-1367.43"/>
<polygon fill="#000000" stroke="#000000" points="626.426,-1370.77 635.291,-1364.96 624.743,-1363.97 626.426,-1370.77"/>
</g>
<!-- proc~get_indices -->
<g id="proc~~ndmc~~CallsGraph_node29" class="node"><title>proc~get_indices</title>
<g id="a_proc~~ndmc~~CallsGraph_node29"><a xlink:href=".././proc/get_indices.html" xlink:title="get_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="546.5,-1368 479.5,-1368 479.5,-1344 546.5,-1344 546.5,-1368"/>
<text text-anchor="middle" x="513" y="-1353.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_indices</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~get_indices -->
<g id="proc~~ndmc~~CallsGraph_edge25" class="edge"><title>proc~track&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M368.19,-1394.91C395.167,-1387.61 437.647,-1376.12 469.455,-1367.51"/>
<polygon fill="#000000" stroke="#000000" points="470.635,-1370.82 479.374,-1364.83 468.807,-1364.06 470.635,-1370.82"/>
</g>
<!-- proc~doppler_stark -->
<g id="proc~~ndmc~~CallsGraph_node36" class="node"><title>proc~doppler_stark</title>
<g id="a_proc~~ndmc~~CallsGraph_node36"><a xlink:href=".././proc/doppler_stark.html" xlink:title="doppler_stark">
<polygon fill="#d9534f" stroke="#d9534f" points="552,-1448 474,-1448 474,-1424 552,-1424 552,-1448"/>
<text text-anchor="middle" x="513" y="-1433.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">doppler_stark</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~doppler_stark -->
<g id="proc~~ndmc~~CallsGraph_edge28" class="edge"><title>proc~track&#45;&gt;proc~doppler_stark</title>
<path fill="none" stroke="#000000" d="M368.19,-1407.24C393.544,-1412.31 432.592,-1420.12 463.604,-1426.32"/>
<polygon fill="#000000" stroke="#000000" points="463.289,-1429.83 473.782,-1428.36 464.662,-1422.96 463.289,-1429.83"/>
</g>
<!-- proc~store_photons -->
<g id="proc~~ndmc~~CallsGraph_node35" class="node"><title>proc~store_photons</title>
<g id="a_proc~~ndmc~~CallsGraph_node35"><a xlink:href=".././proc/store_photons.html" xlink:title="store_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="381.5,-1308 300.5,-1308 300.5,-1284 381.5,-1284 381.5,-1308"/>
<text text-anchor="middle" x="341" y="-1293.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_photons</text>
</a>
</g>
</g>
<!-- proc~store_nbi_photons&#45;&gt;proc~store_photons -->
<g id="proc~~ndmc~~CallsGraph_edge29" class="edge"><title>proc~store_nbi_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M213.873,-1121.42C221.743,-1124.31 229.437,-1128.08 236,-1133 285.653,-1170.23 317.829,-1238.69 331.876,-1273.87"/>
<polygon fill="#000000" stroke="#000000" points="328.783,-1275.57 335.652,-1283.64 335.313,-1273.05 328.783,-1275.57"/>
</g>
<!-- proc~linsolve -->
<g id="proc~~ndmc~~CallsGraph_node23" class="node"><title>proc~linsolve</title>
<g id="a_proc~~ndmc~~CallsGraph_node23"><a xlink:href=".././proc/linsolve.html" xlink:title="linsolve">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-737 314,-737 314,-713 368,-713 368,-737"/>
<text text-anchor="middle" x="341" y="-722.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linsolve</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~linsolve -->
<g id="proc~~ndmc~~CallsGraph_edge30" class="edge"><title>proc~colrad&#45;&gt;proc~linsolve</title>
<path fill="none" stroke="#000000" d="M173.713,-935.693C202.621,-899.065 288.307,-790.497 324.056,-745.202"/>
<polygon fill="#000000" stroke="#000000" points="326.869,-747.287 330.317,-737.269 321.374,-742.95 326.869,-747.287"/>
</g>
<!-- proc~eigen -->
<g id="proc~~ndmc~~CallsGraph_node27" class="node"><title>proc~eigen</title>
<g id="a_proc~~ndmc~~CallsGraph_node27"><a xlink:href=".././proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-899 314,-899 314,-875 368,-875 368,-899"/>
<text text-anchor="middle" x="341" y="-884.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~ndmc~~CallsGraph_edge32" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M190.349,-938.868C220.635,-928.371 270.499,-911.088 304.264,-899.386"/>
<polygon fill="#000000" stroke="#000000" points="305.456,-902.677 313.759,-896.095 303.164,-896.063 305.456,-902.677"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~ndmc~~CallsGraph_node39" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~ndmc~~CallsGraph_node39"><a xlink:href=".././proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="385,-976 297,-976 297,-952 385,-952 385,-976"/>
<text text-anchor="middle" x="341" y="-961.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~ndmc~~CallsGraph_edge31" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M190.349,-950.395C215.702,-952.7 254.776,-956.252 286.64,-959.149"/>
<polygon fill="#000000" stroke="#000000" points="286.429,-962.644 296.705,-960.064 287.063,-955.673 286.429,-962.644"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~ndmc~~CallsGraph_node21" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~ndmc~~CallsGraph_node21"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="716,-1411 616,-1411 616,-1387 716,-1387 716,-1411"/>
<text text-anchor="middle" x="666" y="-1396.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~ndmc~~CallsGraph_edge34" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M542.045,-1471.86C554.199,-1468.51 568.295,-1463.66 580,-1457 598.606,-1446.41 598.42,-1437.22 616,-1425 620.547,-1421.84 625.524,-1418.79 630.508,-1415.96"/>
<polygon fill="#000000" stroke="#000000" points="632.287,-1418.97 639.395,-1411.12 628.939,-1412.82 632.287,-1418.97"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge36" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M542.265,-1474.33C555.036,-1471.44 569.566,-1466.26 580,-1457 608.865,-1431.39 588.409,-1404.97 616,-1378 619.053,-1375.02 622.596,-1372.43 626.354,-1370.18"/>
<polygon fill="#000000" stroke="#000000" points="628.075,-1373.23 635.383,-1365.56 624.886,-1367 628.075,-1373.23"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~ndmc~~CallsGraph_edge33" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M542.267,-1485.14C554.199,-1488.62 568.063,-1493.3 580,-1499 601.799,-1509.4 624.552,-1524.66 641.026,-1536.63"/>
<polygon fill="#000000" stroke="#000000" points="639.364,-1539.75 649.486,-1542.88 643.526,-1534.12 639.364,-1539.75"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge35" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M542.138,-1473.84C562.619,-1470.81 591.025,-1466.63 616,-1463 663.036,-1456.16 716.965,-1448.43 753.635,-1443.19"/>
<polygon fill="#000000" stroke="#000000" points="754.563,-1446.59 763.967,-1441.71 753.572,-1439.66 754.563,-1446.59"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge37" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M542.157,-1479.32C611.742,-1482.59 792.199,-1491.05 875.584,-1494.96"/>
<polygon fill="#000000" stroke="#000000" points="875.581,-1498.47 885.735,-1495.44 875.91,-1491.47 875.581,-1498.47"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_node16" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~ndmc~~CallsGraph_node16"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="843.5,-88 752.5,-88 752.5,-64 843.5,-64 843.5,-88"/>
<text text-anchor="middle" x="798" y="-73.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge43" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M518.758,-245.913C530.549,-217.647 563.985,-147.056 616,-113 653.404,-88.5098 703.74,-79.7197 741.834,-76.7932"/>
<polygon fill="#000000" stroke="#000000" points="742.481,-80.2585 752.232,-76.1151 742.026,-73.2733 742.481,-80.2585"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~ndmc~~CallsGraph_node17" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~ndmc~~CallsGraph_node17"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="710,-230 622,-230 622,-206 710,-206 710,-230"/>
<text text-anchor="middle" x="666" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~ndmc~~CallsGraph_edge47" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M549.785,-248.521C568.372,-243.597 591.449,-237.484 612.056,-232.025"/>
<polygon fill="#000000" stroke="#000000" points="613.174,-235.35 621.944,-229.406 611.381,-228.583 613.174,-235.35"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~ndmc~~CallsGraph_node18" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~ndmc~~CallsGraph_node18"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="843.5,-360 752.5,-360 752.5,-336 843.5,-336 843.5,-360"/>
<text text-anchor="middle" x="798" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~ndmc~~CallsGraph_edge38" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M529.98,-270.216C549.275,-284.313 583.231,-307.078 616,-319 656.868,-333.868 705.68,-341.126 742.31,-344.663"/>
<polygon fill="#000000" stroke="#000000" points="742.027,-348.151 752.301,-345.564 742.656,-341.18 742.027,-348.151"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~ndmc~~CallsGraph_node20" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~ndmc~~CallsGraph_node20"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="711.5,-66 620.5,-66 620.5,-42 711.5,-42 711.5,-66"/>
<text text-anchor="middle" x="666" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~ndmc~~CallsGraph_edge39" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M518.285,-245.668C529.69,-214.376 563.538,-130.783 616,-80 619.28,-76.8247 623.026,-73.9338 626.952,-71.3309"/>
<polygon fill="#000000" stroke="#000000" points="628.933,-74.2249 635.725,-66.0941 625.345,-68.2143 628.933,-74.2249"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~ndmc~~CallsGraph_node24" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~ndmc~~CallsGraph_node24"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="710,-310 622,-310 622,-286 710,-286 710,-310"/>
<text text-anchor="middle" x="666" y="-295.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~ndmc~~CallsGraph_edge45" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M549.785,-267.479C568.372,-272.403 591.449,-278.516 612.056,-283.975"/>
<polygon fill="#000000" stroke="#000000" points="611.381,-287.417 621.944,-286.594 613.174,-280.65 611.381,-287.417"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~ndmc~~CallsGraph_node25" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~ndmc~~CallsGraph_node25"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="711.5,-24 620.5,-24 620.5,-0 711.5,-0 711.5,-24"/>
<text text-anchor="middle" x="666" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~ndmc~~CallsGraph_edge46" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M516.247,-245.983C523.721,-209.174 551.044,-96.6236 616,-33 617.227,-31.7978 618.534,-30.6596 619.903,-29.5823"/>
<polygon fill="#000000" stroke="#000000" points="621.864,-32.482 628.29,-24.0588 618.013,-26.6359 621.864,-32.482"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~ndmc~~CallsGraph_node30" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~ndmc~~CallsGraph_node30"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="711.5,-188 620.5,-188 620.5,-164 711.5,-164 711.5,-188"/>
<text text-anchor="middle" x="666" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~ndmc~~CallsGraph_edge41" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.374,-245.988C552.476,-233.091 585.86,-212.383 616,-197 619.145,-195.395 622.442,-193.801 625.774,-192.252"/>
<polygon fill="#000000" stroke="#000000" points="627.481,-195.322 635.166,-188.029 624.61,-188.938 627.481,-195.322"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~ndmc~~CallsGraph_node31" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~ndmc~~CallsGraph_node31"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="842,-402 754,-402 754,-378 842,-378 842,-402"/>
<text text-anchor="middle" x="798" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~ndmc~~CallsGraph_edge42" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M524.629,-270.127C541.883,-289.04 577.914,-325.416 616,-345 656.141,-365.64 706.232,-377.145 743.537,-383.343"/>
<polygon fill="#000000" stroke="#000000" points="743.276,-386.845 753.7,-384.954 744.371,-379.932 743.276,-386.845"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_node33" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~ndmc~~CallsGraph_node33"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="842,-262 754,-262 754,-238 842,-238 842,-262"/>
<text text-anchor="middle" x="798" y="-247.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_edge44" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M549.556,-256.995C598.47,-255.612 686.905,-253.112 743.737,-251.506"/>
<polygon fill="#000000" stroke="#000000" points="744.067,-254.998 753.964,-251.217 743.869,-248.001 744.067,-254.998"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~ndmc~~CallsGraph_node40" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~ndmc~~CallsGraph_node40"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="711.5,-146 620.5,-146 620.5,-122 711.5,-122 711.5,-146"/>
<text text-anchor="middle" x="666" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~ndmc~~CallsGraph_edge40" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M523.488,-245.694C540.212,-224.691 576.887,-181.62 616,-155 618.142,-153.542 620.402,-152.152 622.728,-150.832"/>
<polygon fill="#000000" stroke="#000000" points="624.634,-153.787 631.92,-146.095 621.427,-147.565 624.634,-153.787"/>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_edge48" class="edge"><title>proc~parallel_merge_populations&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M218.206,-528.947C224.449,-526.481 230.529,-523.53 236,-520 256.659,-506.671 251.464,-491.517 272,-478 325.661,-442.68 359.847,-475.146 410,-435 461.913,-393.445 492.497,-317.817 505.149,-280.315"/>
<polygon fill="#000000" stroke="#000000" points="508.611,-280.986 508.374,-270.393 501.954,-278.821 508.611,-280.986"/>
</g>
<!-- proc~parallel_merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_node22" class="node"><title>proc~parallel_merge_reservoirs</title>
<g id="a_proc~~ndmc~~CallsGraph_node22"><a xlink:href=".././proc/parallel_merge_reservoirs.html" xlink:title="parallel_merge_reservoirs">
<polygon fill="#d9534f" stroke="#d9534f" points="409.5,-511 272.5,-511 272.5,-487 409.5,-487 409.5,-511"/>
<text text-anchor="middle" x="341" y="-496.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_merge_reservoirs</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;proc~parallel_merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_edge49" class="edge"><title>proc~parallel_merge_populations&#45;&gt;proc~parallel_merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M214.435,-528.964C234.779,-524.11 258.42,-518.468 279.667,-513.398"/>
<polygon fill="#000000" stroke="#000000" points="280.644,-516.763 289.558,-511.037 279.019,-509.954 280.644,-516.763"/>
</g>
<!-- proc~ind2sub -->
<g id="proc~~ndmc~~CallsGraph_node41" class="node"><title>proc~ind2sub</title>
<g id="a_proc~~ndmc~~CallsGraph_node41"><a xlink:href=".././proc/ind2sub.html" xlink:title="ind2sub">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-553 314,-553 314,-529 368,-529 368,-553"/>
<text text-anchor="middle" x="341" y="-538.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ind2sub</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;proc~ind2sub -->
<g id="proc~~ndmc~~CallsGraph_edge50" class="edge"><title>proc~parallel_merge_populations&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M235.586,-541C258.98,-541 283.98,-541 303.65,-541"/>
<polygon fill="#000000" stroke="#000000" points="303.699,-544.5 313.699,-541 303.699,-537.5 303.699,-544.5"/>
</g>
<!-- proc~cross_product -->
<g id="proc~~ndmc~~CallsGraph_node34" class="node"><title>proc~cross_product</title>
<g id="a_proc~~ndmc~~CallsGraph_node34"><a xlink:href=".././proc/cross_product.html" xlink:title="cross_product">
<polygon fill="#d94e8f" stroke="#d94e8f" points="381,-393 301,-393 301,-369 381,-369 381,-393"/>
<text text-anchor="middle" x="341" y="-378.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cross_product</text>
</a>
</g>
</g>
<!-- proc~gyro_step&#45;&gt;proc~cross_product -->
<g id="proc~~ndmc~~CallsGraph_edge51" class="edge"><title>proc~gyro_step&#45;&gt;proc~cross_product</title>
<path fill="none" stroke="#000000" d="M193.063,-381C219.466,-381 258.97,-381 290.37,-381"/>
<polygon fill="#000000" stroke="#000000" points="290.677,-384.5 300.677,-381 290.677,-377.5 290.677,-384.5"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge53" class="edge"><title>proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M777.828,-88.0139C770.784,-96.9717 777.508,-106 798,-106 810.487,-106 817.862,-102.647 820.124,-98.0013"/>
<polygon fill="#000000" stroke="#000000" points="823.526,-97.1566 818.172,-88.0139 816.656,-98.4996 823.526,-97.1566"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_node55" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="959.5,-203 880.5,-203 880.5,-179 959.5,-179 959.5,-203"/>
<text text-anchor="middle" x="920" y="-188.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge52" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M811.842,-88.307C832.683,-108.28 874.031,-147.905 898.828,-171.668"/>
<polygon fill="#000000" stroke="#000000" points="896.609,-174.389 906.25,-178.781 901.452,-169.335 896.609,-174.389"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_edge55" class="edge"><title>proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M710.288,-228.656C721.142,-231.327 732.909,-234.224 744.17,-236.996"/>
<polygon fill="#000000" stroke="#000000" points="743.354,-240.399 753.901,-239.391 745.027,-233.602 743.354,-240.399"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge54" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M710.034,-213.389C754.469,-208.628 823.685,-201.212 870.147,-196.234"/>
<polygon fill="#000000" stroke="#000000" points="870.708,-199.694 880.278,-195.149 869.962,-192.734 870.708,-199.694"/>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge56" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M825.401,-335.833C831.968,-332.015 838.651,-327.37 844,-322 876.142,-289.73 899.21,-240.898 910.709,-212.865"/>
<polygon fill="#000000" stroke="#000000" points="914.103,-213.803 914.545,-203.218 907.598,-211.217 914.103,-213.803"/>
</g>
<!-- proc~in_passive_grid -->
<g id="proc~~ndmc~~CallsGraph_node59" class="node"><title>proc~in_passive_grid</title>
<g id="a_proc~~ndmc~~CallsGraph_node59"><a xlink:href=".././proc/in_passive_grid.html" xlink:title="in_passive_grid">
<polygon fill="#d94e8f" stroke="#d94e8f" points="709.5,-1124 622.5,-1124 622.5,-1100 709.5,-1100 709.5,-1124"/>
<text text-anchor="middle" x="666" y="-1109.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_passive_grid</text>
</a>
</g>
</g>
<!-- proc~grid_intersect&#45;&gt;proc~in_passive_grid -->
<g id="proc~~ndmc~~CallsGraph_edge57" class="edge"><title>proc~grid_intersect&#45;&gt;proc~in_passive_grid</title>
<path fill="none" stroke="#000000" d="M551.714,-1143.51C570.181,-1138.37 592.712,-1132.11 612.802,-1126.52"/>
<polygon fill="#000000" stroke="#000000" points="613.744,-1129.89 622.44,-1123.84 611.868,-1123.15 613.744,-1129.89"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge59" class="edge"><title>proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M711.739,-61.5712C721.544,-63.2305 732.032,-65.0054 742.181,-66.723"/>
<polygon fill="#000000" stroke="#000000" points="741.735,-70.1972 752.179,-68.4149 742.903,-63.2953 741.735,-70.1972"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge58" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M711.772,-42.4022C749.698,-35.205 804.111,-31.2931 844,-55 885.676,-79.7689 905.807,-136.833 914.098,-168.609"/>
<polygon fill="#000000" stroke="#000000" points="910.788,-169.81 916.553,-178.699 917.59,-168.155 910.788,-169.81"/>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_edge63" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M387.948,-486.972C395.936,-483.407 403.691,-478.836 410,-473 411.95,-471.196 476.646,-333.425 501.975,-279.399"/>
<polygon fill="#000000" stroke="#000000" points="505.279,-280.595 506.354,-270.055 498.941,-277.624 505.279,-280.595"/>
</g>
<!-- proc~num_ranks -->
<g id="proc~~ndmc~~CallsGraph_node43" class="node"><title>proc~num_ranks</title>
<g id="a_proc~~ndmc~~CallsGraph_node43"><a xlink:href=".././proc/num_ranks.html" xlink:title="num_ranks">
<polygon fill="#d94e8f" stroke="#d94e8f" points="546,-516 480,-516 480,-492 546,-492 546,-516"/>
<text text-anchor="middle" x="513" y="-501.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">num_ranks</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~num_ranks -->
<g id="proc~~ndmc~~CallsGraph_edge60" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~num_ranks</title>
<path fill="none" stroke="#000000" d="M409.677,-500.99C429.956,-501.587 451.609,-502.224 469.75,-502.757"/>
<polygon fill="#000000" stroke="#000000" points="469.89,-506.263 479.988,-503.058 470.096,-499.266 469.89,-506.263"/>
</g>
<!-- proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_node46" class="node"><title>proc~init_reservoir</title>
<g id="a_proc~~ndmc~~CallsGraph_node46"><a xlink:href=".././proc/init_reservoir.html" xlink:title="init_reservoir">
<polygon fill="#d9534f" stroke="#d9534f" points="835,-556 761,-556 761,-532 835,-532 835,-556"/>
<text text-anchor="middle" x="798" y="-541.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_reservoir</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge61" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M382.634,-511.072C401.699,-516.241 424.836,-521.812 446,-525 554.262,-541.31 683.164,-544.091 750.61,-544.295"/>
<polygon fill="#000000" stroke="#000000" points="750.89,-547.796 760.894,-544.308 750.899,-540.796 750.89,-547.796"/>
</g>
<!-- proc~my_rank -->
<g id="proc~~ndmc~~CallsGraph_node54" class="node"><title>proc~my_rank</title>
<g id="a_proc~~ndmc~~CallsGraph_node54"><a xlink:href=".././proc/my_rank.html" xlink:title="my_rank">
<polygon fill="#d94e8f" stroke="#d94e8f" points="540,-474 486,-474 486,-450 540,-450 540,-474"/>
<text text-anchor="middle" x="513" y="-459.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">my_rank</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~my_rank -->
<g id="proc~~ndmc~~CallsGraph_edge62" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~my_rank</title>
<path fill="none" stroke="#000000" d="M397.194,-486.987C422.921,-481.388 452.819,-474.881 475.654,-469.911"/>
<polygon fill="#000000" stroke="#000000" points="476.581,-473.291 485.608,-467.744 475.092,-466.451 476.581,-473.291"/>
</g>
<!-- proc~merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_node61" class="node"><title>proc~merge_reservoirs</title>
<g id="a_proc~~ndmc~~CallsGraph_node61"><a xlink:href=".././proc/merge_reservoirs.html" xlink:title="merge_reservoirs">
<polygon fill="#d9534f" stroke="#d9534f" points="561.5,-432 464.5,-432 464.5,-408 561.5,-408 561.5,-432"/>
<text text-anchor="middle" x="513" y="-417.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">merge_reservoirs</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_edge64" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M380.908,-486.889C390.734,-483.095 401.034,-478.447 410,-473 428.296,-461.885 427.394,-451.588 446,-441 449.22,-439.168 452.621,-437.472 456.113,-435.907"/>
<polygon fill="#000000" stroke="#000000" points="457.576,-439.09 465.506,-432.065 454.926,-432.611 457.576,-439.09"/>
</g>
<!-- dgetrs -->
<g id="proc~~ndmc~~CallsGraph_node44" class="node"><title>dgetrs</title>
<polygon fill="#777777" stroke="#777777" points="540,-716 486,-716 486,-692 540,-692 540,-716"/>
<text text-anchor="middle" x="513" y="-701.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrs</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrs -->
<g id="proc~~ndmc~~CallsGraph_edge67" class="edge"><title>proc~linsolve&#45;&gt;dgetrs</title>
<path fill="none" stroke="#000000" d="M368.19,-721.765C397.016,-718.204 443.543,-712.456 475.836,-708.467"/>
<polygon fill="#000000" stroke="#000000" points="476.285,-711.939 485.78,-707.239 475.427,-704.991 476.285,-711.939"/>
</g>
<!-- dgetrf -->
<g id="proc~~ndmc~~CallsGraph_node48" class="node"><title>dgetrf</title>
<polygon fill="#777777" stroke="#777777" points="540,-674 486,-674 486,-650 540,-650 540,-674"/>
<text text-anchor="middle" x="513" y="-659.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrf</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrf -->
<g id="proc~~ndmc~~CallsGraph_edge66" class="edge"><title>proc~linsolve&#45;&gt;dgetrf</title>
<path fill="none" stroke="#000000" d="M368.289,-713.74C389.189,-704.945 419.255,-692.64 446,-683 455.655,-679.52 466.208,-676.026 475.988,-672.915"/>
<polygon fill="#000000" stroke="#000000" points="477.335,-676.16 485.829,-669.827 475.24,-669.481 477.335,-676.16"/>
</g>
<!-- proc~matinv -->
<g id="proc~~ndmc~~CallsGraph_node52" class="node"><title>proc~matinv</title>
<g id="a_proc~~ndmc~~CallsGraph_node52"><a xlink:href=".././proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-758 486,-758 486,-734 540,-734 540,-758"/>
<text text-anchor="middle" x="513" y="-743.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~linsolve&#45;&gt;proc~matinv -->
<g id="proc~~ndmc~~CallsGraph_edge65" class="edge"><title>proc~linsolve&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M368.19,-728.235C397.016,-731.796 443.543,-737.544 475.836,-741.533"/>
<polygon fill="#000000" stroke="#000000" points="475.427,-745.009 485.78,-742.761 476.285,-738.061 475.427,-745.009"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_edge69" class="edge"><title>proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M699.804,-285.888C716.432,-279.748 736.821,-272.22 754.623,-265.647"/>
<polygon fill="#000000" stroke="#000000" points="756.037,-268.856 764.206,-262.109 753.613,-262.289 756.037,-268.856"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge68" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M710.037,-305.487C747.609,-309.855 802.471,-310.842 844,-289 875.69,-272.333 897.968,-235.661 909.617,-212.207"/>
<polygon fill="#000000" stroke="#000000" points="912.831,-213.596 913.955,-203.061 906.507,-210.596 912.831,-213.596"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge71" class="edge"><title>proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M696.198,-24.0419C702.759,-26.8782 709.655,-29.9629 716,-33 732.887,-41.0839 751.351,-50.8142 766.38,-58.9727"/>
<polygon fill="#000000" stroke="#000000" points="764.796,-62.0953 775.249,-63.8206 768.153,-55.9531 764.796,-62.0953"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge70" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M711.606,-6.02295C750.197,-3.28832 805.671,-5.47126 844,-33 889.398,-65.6056 908.287,-133.013 915.317,-168.315"/>
<polygon fill="#000000" stroke="#000000" points="911.95,-169.362 917.201,-178.564 918.835,-168.096 911.95,-169.362"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge72" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M696.587,-1367.77C703.195,-1370.69 710.013,-1374.13 716,-1378 734.233,-1389.78 734.499,-1398.16 752,-1411 756.167,-1414.06 760.723,-1417.05 765.284,-1419.85"/>
<polygon fill="#000000" stroke="#000000" points="763.57,-1422.9 773.961,-1424.97 767.128,-1416.87 763.57,-1422.9"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_node49" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~ndmc~~CallsGraph_node49"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="952.5,-1438 887.5,-1438 887.5,-1414 952.5,-1414 952.5,-1438"/>
<text text-anchor="middle" x="920" y="-1423.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge73" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M696.897,-1365.19C741.755,-1377.47 826.621,-1400.71 877.468,-1414.63"/>
<polygon fill="#000000" stroke="#000000" points="876.593,-1418.02 887.162,-1417.28 878.441,-1411.27 876.593,-1418.02"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~ndmc~~CallsGraph_node50" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~ndmc~~CallsGraph_node50"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="836.5,-1369 759.5,-1369 759.5,-1345 836.5,-1345 836.5,-1369"/>
<text text-anchor="middle" x="798" y="-1354.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~ndmc~~CallsGraph_edge74" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M696.825,-1357C712.365,-1357 731.744,-1357 749.306,-1357"/>
<polygon fill="#000000" stroke="#000000" points="749.393,-1360.5 759.393,-1357 749.393,-1353.5 749.393,-1360.5"/>
</g>
<!-- proc~balback -->
<g id="proc~~ndmc~~CallsGraph_node45" class="node"><title>proc~balback</title>
<g id="a_proc~~ndmc~~CallsGraph_node45"><a xlink:href=".././proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-884 486,-884 486,-860 540,-860 540,-884"/>
<text text-anchor="middle" x="513" y="-869.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~ndmc~~CallsGraph_edge75" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M368.19,-884.689C396.892,-882.157 443.14,-878.076 475.416,-875.228"/>
<polygon fill="#000000" stroke="#000000" points="476.127,-878.679 485.78,-874.314 475.511,-871.706 476.127,-878.679"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~ndmc~~CallsGraph_node47" class="node"><title>proc~elmhes</title>
<g id="a_proc~~ndmc~~CallsGraph_node47"><a xlink:href=".././proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-968 486,-968 486,-944 540,-944 540,-968"/>
<text text-anchor="middle" x="513" y="-953.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~ndmc~~CallsGraph_edge76" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M366.008,-899.118C386.854,-909.387 418.007,-924.135 446,-935 455.568,-938.713 466.092,-942.285 475.871,-945.397"/>
<polygon fill="#000000" stroke="#000000" points="475.134,-948.832 485.722,-948.459 477.212,-942.148 475.134,-948.832"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~ndmc~~CallsGraph_node51" class="node"><title>proc~hqr2</title>
<g id="a_proc~~ndmc~~CallsGraph_node51"><a xlink:href=".././proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-800 486,-800 486,-776 540,-776 540,-800"/>
<text text-anchor="middle" x="513" y="-785.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~ndmc~~CallsGraph_edge77" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M355.135,-874.814C373.958,-857.923 410.288,-827.401 446,-809 455.38,-804.167 466.084,-800.18 476.102,-797.027"/>
<polygon fill="#000000" stroke="#000000" points="477.222,-800.345 485.817,-794.151 475.235,-793.633 477.222,-800.345"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~ndmc~~CallsGraph_node56" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~ndmc~~CallsGraph_node56"><a xlink:href=".././proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-842 486,-842 486,-818 540,-818 540,-842"/>
<text text-anchor="middle" x="513" y="-827.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~ndmc~~CallsGraph_edge78" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M368.01,-877.793C389.01,-870.409 419.345,-859.852 446,-851 455.74,-847.765 466.322,-844.353 476.101,-841.242"/>
<polygon fill="#000000" stroke="#000000" points="477.457,-844.484 485.933,-838.128 475.343,-837.81 477.457,-844.484"/>
</g>
<!-- proc~balance -->
<g id="proc~~ndmc~~CallsGraph_node60" class="node"><title>proc~balance</title>
<g id="a_proc~~ndmc~~CallsGraph_node60"><a xlink:href=".././proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-926 486,-926 486,-902 540,-902 540,-926"/>
<text text-anchor="middle" x="513" y="-911.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~ndmc~~CallsGraph_edge79" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M368.19,-891.16C397.016,-895.738 443.543,-903.127 475.836,-908.256"/>
<polygon fill="#000000" stroke="#000000" points="475.355,-911.724 485.78,-909.836 476.453,-904.81 475.355,-911.724"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_node53" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~ndmc~~CallsGraph_node53"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="829,-1529 767,-1529 767,-1505 829,-1505 829,-1529"/>
<text text-anchor="middle" x="798" y="-1514.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge80" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M701.156,-1545.02C718.135,-1540.05 738.77,-1534.02 756.537,-1528.83"/>
<polygon fill="#000000" stroke="#000000" points="758.002,-1532.05 766.618,-1525.88 756.038,-1525.33 758.002,-1532.05"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge82" class="edge"><title>proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M699.773,-163.954C705.376,-161.34 710.997,-158.342 716,-155 740.987,-138.31 765.033,-113.359 780.342,-95.9785"/>
<polygon fill="#000000" stroke="#000000" points="783.237,-97.981 787.121,-88.1238 777.938,-93.4074 783.237,-97.981"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge81" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M711.762,-178.664C756.337,-181.318 824.56,-185.379 870.427,-188.109"/>
<polygon fill="#000000" stroke="#000000" points="870.24,-191.604 880.43,-188.704 870.656,-184.616 870.24,-191.604"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge83" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M832.351,-377.943C836.614,-375.439 840.651,-372.478 844,-369 887.422,-323.903 907.398,-249.919 915.032,-213.162"/>
<polygon fill="#000000" stroke="#000000" points="918.531,-213.509 917.018,-203.023 911.661,-212.164 918.531,-213.509"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_edge85" class="edge"><title>proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M777.828,-262.014C770.784,-270.972 777.508,-280 798,-280 810.487,-280 817.862,-276.647 820.124,-272.001"/>
<polygon fill="#000000" stroke="#000000" points="823.526,-271.157 818.172,-262.014 816.656,-272.5 823.526,-271.157"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge84" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M823.573,-237.918C841.369,-229.168 865.643,-217.234 885.255,-207.591"/>
<polygon fill="#000000" stroke="#000000" points="887.03,-210.619 894.46,-203.066 883.941,-204.337 887.03,-210.619"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_edge88" class="edge"><title>proc~store_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M353.345,-1308.27C367.711,-1324.2 392.674,-1353.28 410,-1381 429.808,-1412.7 417.857,-1432.4 446,-1457 453.877,-1463.88 464.023,-1468.51 473.985,-1471.63"/>
<polygon fill="#000000" stroke="#000000" points="473.23,-1475.05 483.796,-1474.26 475.046,-1468.29 473.23,-1475.05"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_indices -->
<g id="proc~~ndmc~~CallsGraph_edge86" class="edge"><title>proc~store_photons&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M376.402,-1308.14C403.306,-1317.64 440.844,-1330.89 469.604,-1341.04"/>
<polygon fill="#000000" stroke="#000000" points="468.785,-1344.46 479.379,-1344.49 471.114,-1337.86 468.785,-1344.46"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge90" class="edge"><title>proc~store_photons&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M381.711,-1296.66C494,-1298.88 808.018,-1307.59 844,-1336 884.705,-1368.14 855.682,-1401.19 880,-1447 885.633,-1457.61 893.55,-1468.26 900.781,-1476.99"/>
<polygon fill="#000000" stroke="#000000" points="898.235,-1479.4 907.405,-1484.7 903.546,-1474.84 898.235,-1479.4"/>
</g>
<!-- proc~get_passive_grid_indices -->
<g id="proc~~ndmc~~CallsGraph_node57" class="node"><title>proc~get_passive_grid_indices</title>
<g id="a_proc~~ndmc~~CallsGraph_node57"><a xlink:href=".././proc/get_passive_grid_indices.html" xlink:title="get_passive_grid_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="579.5,-1288 446.5,-1288 446.5,-1264 579.5,-1264 579.5,-1288"/>
<text text-anchor="middle" x="513" y="-1273.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_passive_grid_indices</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_passive_grid_indices -->
<g id="proc~~ndmc~~CallsGraph_edge87" class="edge"><title>proc~store_photons&#45;&gt;proc~get_passive_grid_indices</title>
<path fill="none" stroke="#000000" d="M381.857,-1291.31C398.162,-1289.39 417.589,-1287.11 436.395,-1284.89"/>
<polygon fill="#000000" stroke="#000000" points="436.93,-1288.36 446.452,-1283.71 436.112,-1281.4 436.93,-1288.36"/>
</g>
<!-- proc~spectrum -->
<g id="proc~~ndmc~~CallsGraph_node58" class="node"><title>proc~spectrum</title>
<g id="a_proc~~ndmc~~CallsGraph_node58"><a xlink:href=".././proc/spectrum.html" xlink:title="spectrum">
<polygon fill="#d9534f" stroke="#d9534f" points="541.5,-1246 484.5,-1246 484.5,-1222 541.5,-1222 541.5,-1246"/>
<text text-anchor="middle" x="513" y="-1231.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spectrum</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~spectrum -->
<g id="proc~~ndmc~~CallsGraph_edge89" class="edge"><title>proc~store_photons&#45;&gt;proc~spectrum</title>
<path fill="none" stroke="#000000" d="M370.94,-1283.98C391.697,-1275.52 420.4,-1264.11 446,-1255 455.152,-1251.74 465.099,-1248.45 474.43,-1245.47"/>
<polygon fill="#000000" stroke="#000000" points="475.761,-1248.72 484.245,-1242.37 473.655,-1242.05 475.761,-1248.72"/>
</g>
<!-- proc~update_reservoir -->
<g id="proc~~ndmc~~CallsGraph_node62" class="node"><title>proc~update_reservoir</title>
<g id="a_proc~~ndmc~~CallsGraph_node62"><a xlink:href=".././proc/update_reservoir.html" xlink:title="update_reservoir">
<polygon fill="#d9534f" stroke="#d9534f" points="713,-596 619,-596 619,-572 713,-572 713,-596"/>
<text text-anchor="middle" x="666" y="-581.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_reservoir</text>
</a>
</g>
</g>
<!-- proc~update_neutrals&#45;&gt;proc~update_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge91" class="edge"><title>proc~update_neutrals&#45;&gt;proc~update_reservoir</title>
<path fill="none" stroke="#000000" d="M386.235,-583.137C444.09,-583.316 545.508,-583.63 608.76,-583.826"/>
<polygon fill="#000000" stroke="#000000" points="608.944,-587.326 618.955,-583.857 608.965,-580.326 608.944,-587.326"/>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~ndmc~~CallsGraph_edge92" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M373.213,-976.034C421.016,-995.431 513.772,-1036.97 580,-1091 584.586,-1094.74 712.271,-1250.4 716,-1255 738.817,-1283.12 764.78,-1315.97 781.027,-1336.63"/>
<polygon fill="#000000" stroke="#000000" points="778.429,-1338.98 787.358,-1344.69 783.933,-1334.66 778.429,-1338.98"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge94" class="edge"><title>proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M693.936,-121.982C713.284,-113.35 739.579,-101.618 760.767,-92.1657"/>
<polygon fill="#000000" stroke="#000000" points="762.392,-95.273 770.098,-88.0022 759.54,-88.8804 762.392,-95.273"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge93" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M711.762,-144.125C756.337,-154.207 824.56,-169.638 870.427,-180.013"/>
<polygon fill="#000000" stroke="#000000" points="869.905,-183.483 880.43,-182.276 871.449,-176.656 869.905,-183.483"/>
</g>
<!-- proc~rswap -->
<g id="proc~~ndmc~~CallsGraph_node65" class="node"><title>proc~rswap</title>
<g id="a_proc~~ndmc~~CallsGraph_node65"><a xlink:href=".././proc/rswap.html" xlink:title="RSWAP">
<polygon fill="#d9534f" stroke="#d9534f" points="693,-926 639,-926 639,-902 693,-902 693,-926"/>
<text text-anchor="middle" x="666" y="-911.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RSWAP</text>
</a>
</g>
</g>
<!-- proc~balback&#45;&gt;proc~rswap -->
<g id="proc~~ndmc~~CallsGraph_edge95" class="edge"><title>proc~balback&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M540.302,-879.316C564.878,-886.151 601.771,-896.413 629.057,-904.003"/>
<polygon fill="#000000" stroke="#000000" points="628.427,-907.46 638.999,-906.768 630.303,-900.716 628.427,-907.46"/>
</g>
<!-- proc~init_reservoir&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge96" class="edge"><title>proc~init_reservoir&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M835.004,-556.001C850.294,-561.098 868.074,-567.025 883.328,-572.109"/>
<polygon fill="#000000" stroke="#000000" points="882.343,-575.47 892.936,-575.312 884.556,-568.829 882.343,-575.47"/>
</g>
<!-- proc~elmhes&#45;&gt;proc~rswap -->
<g id="proc~~ndmc~~CallsGraph_edge97" class="edge"><title>proc~elmhes&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M540.302,-948.684C564.878,-941.849 601.771,-931.587 629.057,-923.997"/>
<polygon fill="#000000" stroke="#000000" points="630.303,-927.284 638.999,-921.232 628.427,-920.54 630.303,-927.284"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~ndmc~~CallsGraph_node70" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~ndmc~~CallsGraph_node70"><a xlink:href=".././proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="693,-800 639,-800 639,-776 693,-776 693,-800"/>
<text text-anchor="middle" x="666" y="-785.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~ndmc~~CallsGraph_edge98" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M540.302,-788C564.769,-788 601.446,-788 628.696,-788"/>
<polygon fill="#000000" stroke="#000000" points="628.999,-791.5 638.999,-788 628.999,-784.5 628.999,-791.5"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~ndmc~~CallsGraph_node63" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~ndmc~~CallsGraph_node63"><a xlink:href=".././proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="693,-758 639,-758 639,-734 693,-734 693,-758"/>
<text text-anchor="middle" x="666" y="-743.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~ndmc~~CallsGraph_edge99" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M540.302,-746C564.769,-746 601.446,-746 628.696,-746"/>
<polygon fill="#000000" stroke="#000000" points="628.999,-749.5 638.999,-746 628.999,-742.5 628.999,-749.5"/>
</g>
<!-- proc~lubksb -->
<g id="proc~~ndmc~~CallsGraph_node69" class="node"><title>proc~lubksb</title>
<g id="a_proc~~ndmc~~CallsGraph_node69"><a xlink:href=".././proc/lubksb.html" xlink:title="lubksb">
<polygon fill="#d9534f" stroke="#d9534f" points="693,-716 639,-716 639,-692 693,-692 693,-716"/>
<text text-anchor="middle" x="666" y="-701.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lubksb</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~lubksb -->
<g id="proc~~ndmc~~CallsGraph_edge100" class="edge"><title>proc~matinv&#45;&gt;proc~lubksb</title>
<path fill="none" stroke="#000000" d="M540.302,-738.684C564.878,-731.849 601.771,-721.587 629.057,-713.997"/>
<polygon fill="#000000" stroke="#000000" points="630.303,-717.284 638.999,-711.232 628.427,-710.54 630.303,-717.284"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge102" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M829.281,-1511.95C843.272,-1509.62 860.146,-1506.81 875.468,-1504.26"/>
<polygon fill="#000000" stroke="#000000" points="876.484,-1507.63 885.772,-1502.54 875.333,-1500.73 876.484,-1507.63"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge101" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M815.184,-1504.73C835.696,-1489.17 871.229,-1462.23 894.927,-1444.26"/>
<polygon fill="#000000" stroke="#000000" points="897.219,-1446.91 903.073,-1438.08 892.99,-1441.33 897.219,-1446.91"/>
</g>
<!-- proc~xyz_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_node71" class="node"><title>proc~xyz_to_cyl</title>
<g id="a_proc~~ndmc~~CallsGraph_node71"><a xlink:href=".././proc/xyz_to_cyl.html" xlink:title="xyz_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="697,-1288 635,-1288 635,-1264 697,-1264 697,-1288"/>
<text text-anchor="middle" x="666" y="-1273.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_cyl</text>
</a>
</g>
</g>
<!-- proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_edge103" class="edge"><title>proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl</title>
<path fill="none" stroke="#000000" d="M579.792,-1276C595.118,-1276 610.987,-1276 624.816,-1276"/>
<polygon fill="#000000" stroke="#000000" points="624.95,-1279.5 634.95,-1276 624.95,-1272.5 624.95,-1279.5"/>
</g>
<!-- proc~approx_ge -->
<g id="proc~~ndmc~~CallsGraph_node66" class="node"><title>proc~approx_ge</title>
<g id="a_proc~~ndmc~~CallsGraph_node66"><a xlink:href=".././proc/approx_ge.html" xlink:title="approx_ge">
<polygon fill="#d94e8f" stroke="#d94e8f" points="830,-1166 766,-1166 766,-1142 830,-1142 830,-1166"/>
<text text-anchor="middle" x="798" y="-1151.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_ge</text>
</a>
</g>
</g>
<!-- proc~in_passive_grid&#45;&gt;proc~approx_ge -->
<g id="proc~~ndmc~~CallsGraph_edge104" class="edge"><title>proc~in_passive_grid&#45;&gt;proc~approx_ge</title>
<path fill="none" stroke="#000000" d="M704.253,-1124.04C720.407,-1129.25 739.377,-1135.38 755.937,-1140.73"/>
<polygon fill="#000000" stroke="#000000" points="755.298,-1144.21 765.89,-1143.95 757.45,-1137.54 755.298,-1144.21"/>
</g>
<!-- proc~approx_le -->
<g id="proc~~ndmc~~CallsGraph_node67" class="node"><title>proc~approx_le</title>
<g id="a_proc~~ndmc~~CallsGraph_node67"><a xlink:href=".././proc/approx_le.html" xlink:title="approx_le">
<polygon fill="#d94e8f" stroke="#d94e8f" points="828,-1124 768,-1124 768,-1100 828,-1100 828,-1124"/>
<text text-anchor="middle" x="798" y="-1109.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_le</text>
</a>
</g>
</g>
<!-- proc~in_passive_grid&#45;&gt;proc~approx_le -->
<g id="proc~~ndmc~~CallsGraph_edge106" class="edge"><title>proc~in_passive_grid&#45;&gt;proc~approx_le</title>
<path fill="none" stroke="#000000" d="M709.567,-1112C725.09,-1112 742.558,-1112 757.776,-1112"/>
<polygon fill="#000000" stroke="#000000" points="757.901,-1115.5 767.901,-1112 757.901,-1108.5 757.901,-1115.5"/>
</g>
<!-- proc~uvw_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_node68" class="node"><title>proc~uvw_to_cyl</title>
<g id="a_proc~~ndmc~~CallsGraph_node68"><a xlink:href=".././proc/uvw_to_cyl.html" xlink:title="uvw_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="830.5,-1248 765.5,-1248 765.5,-1224 830.5,-1224 830.5,-1248"/>
<text text-anchor="middle" x="798" y="-1233.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_cyl</text>
</a>
</g>
</g>
<!-- proc~in_passive_grid&#45;&gt;proc~uvw_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_edge105" class="edge"><title>proc~in_passive_grid&#45;&gt;proc~uvw_to_cyl</title>
<path fill="none" stroke="#000000" d="M694.379,-1124.11C701.767,-1128.01 709.506,-1132.71 716,-1138 730.845,-1150.1 762.785,-1190.83 781.822,-1215.81"/>
<polygon fill="#000000" stroke="#000000" points="779.138,-1218.07 787.968,-1223.92 784.716,-1213.84 779.138,-1218.07"/>
</g>
<!-- proc~balance&#45;&gt;proc~rswap -->
<g id="proc~~ndmc~~CallsGraph_edge107" class="edge"><title>proc~balance&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M540.302,-914C564.769,-914 601.446,-914 628.696,-914"/>
<polygon fill="#000000" stroke="#000000" points="628.999,-917.5 638.999,-914 628.999,-910.5 628.999,-917.5"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge111" class="edge"><title>proc~merge_reservoirs&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M561.882,-418.816C603.688,-419.212 665.416,-423.296 716,-441 792.469,-467.764 866.066,-532.299 899.796,-564.724"/>
<polygon fill="#000000" stroke="#000000" points="897.518,-567.391 907.121,-571.867 902.405,-562.38 897.518,-567.391"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge108" class="edge"><title>proc~merge_reservoirs&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M561.912,-430.03C604.011,-439.971 666.152,-457.434 716,-483 738.072,-494.32 760.386,-511.659 775.989,-524.962"/>
<polygon fill="#000000" stroke="#000000" points="774.083,-527.943 783.922,-531.873 778.681,-522.665 774.083,-527.943"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;proc~update_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge109" class="edge"><title>proc~merge_reservoirs&#45;&gt;proc~update_reservoir</title>
<path fill="none" stroke="#000000" d="M561.766,-429.698C568.409,-432.547 574.747,-436.232 580,-441 610.077,-468.297 594.805,-490.351 616,-525 624.526,-538.939 636.138,-553.072 645.918,-564.01"/>
<polygon fill="#000000" stroke="#000000" points="643.622,-566.686 652.958,-571.695 648.784,-561.957 643.622,-566.686"/>
</g>
<!-- float -->
<g id="proc~~ndmc~~CallsGraph_node64" class="node"><title>float</title>
<polygon fill="#777777" stroke="#777777" points="693,-516 639,-516 639,-492 693,-492 693,-516"/>
<text text-anchor="middle" x="666" y="-501.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">float</text>
</g>
<!-- proc~merge_reservoirs&#45;&gt;float -->
<g id="proc~~ndmc~~CallsGraph_edge110" class="edge"><title>proc~merge_reservoirs&#45;&gt;float</title>
<path fill="none" stroke="#000000" d="M561.766,-432.078C568.119,-434.571 574.374,-437.523 580,-441 599.517,-453.062 597.644,-464.234 616,-478 620.382,-481.286 625.235,-484.396 630.135,-487.244"/>
<polygon fill="#000000" stroke="#000000" points="628.462,-490.319 638.91,-492.073 631.836,-484.186 628.462,-490.319"/>
</g>
<!-- proc~update_reservoir&#45;&gt;interface~randind -->
<g id="proc~~ndmc~~CallsGraph_edge113" class="edge"><title>proc~update_reservoir&#45;&gt;interface~randind</title>
<path fill="none" stroke="#000000" d="M706.004,-596.001C723.51,-601.388 744.027,-607.701 761.144,-612.967"/>
<polygon fill="#000000" stroke="#000000" points="760.193,-616.337 770.781,-615.932 762.252,-609.646 760.193,-616.337"/>
</g>
<!-- proc~update_reservoir&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge114" class="edge"><title>proc~update_reservoir&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M713.221,-584C762.024,-584 837.953,-584 882.652,-584"/>
<polygon fill="#000000" stroke="#000000" points="882.771,-587.5 892.771,-584 882.771,-580.5 882.771,-587.5"/>
</g>
<!-- proc~update_reservoir&#45;&gt;proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge112" class="edge"><title>proc~update_reservoir&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M706.004,-571.999C720.102,-567.661 736.153,-562.722 750.809,-558.213"/>
<polygon fill="#000000" stroke="#000000" points="752.162,-561.458 760.691,-555.172 750.103,-554.768 752.162,-561.458"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~ndmc~~CallsGraph_node73" class="node"><title>proc~outerprod</title>
<g id="a_proc~~ndmc~~CallsGraph_node73"><a xlink:href=".././proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="827.5,-716 768.5,-716 768.5,-692 827.5,-692 827.5,-716"/>
<text text-anchor="middle" x="798" y="-701.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~ndmc~~CallsGraph_edge115" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M693.307,-737.501C712.138,-731.417 737.78,-723.133 758.853,-716.324"/>
<polygon fill="#000000" stroke="#000000" points="760.036,-719.62 768.476,-713.215 757.884,-712.959 760.036,-719.62"/>
</g>
<!-- proc~swap -->
<g id="proc~~ndmc~~CallsGraph_node74" class="node"><title>proc~swap</title>
<g id="a_proc~~ndmc~~CallsGraph_node74"><a xlink:href=".././proc/swap.html" xlink:title="swap">
<polygon fill="#d9534f" stroke="#d9534f" points="825,-758 771,-758 771,-734 825,-734 825,-758"/>
<text text-anchor="middle" x="798" y="-743.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swap</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~swap -->
<g id="proc~~ndmc~~CallsGraph_edge116" class="edge"><title>proc~ludcmp&#45;&gt;proc~swap</title>
<path fill="none" stroke="#000000" d="M693.307,-746C712.69,-746 739.29,-746 760.695,-746"/>
<polygon fill="#000000" stroke="#000000" points="760.732,-749.5 770.732,-746 760.732,-742.5 760.732,-749.5"/>
</g>
<!-- proc~approx_eq -->
<g id="proc~~ndmc~~CallsGraph_node75" class="node"><title>proc~approx_eq</title>
<g id="a_proc~~ndmc~~CallsGraph_node75"><a xlink:href=".././proc/approx_eq.html" xlink:title="approx_eq">
<polygon fill="#d94e8f" stroke="#d94e8f" points="952,-1145 888,-1145 888,-1121 952,-1121 952,-1145"/>
<text text-anchor="middle" x="920" y="-1130.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_eq</text>
</a>
</g>
</g>
<!-- proc~approx_ge&#45;&gt;proc~approx_eq -->
<g id="proc~~ndmc~~CallsGraph_edge117" class="edge"><title>proc~approx_ge&#45;&gt;proc~approx_eq</title>
<path fill="none" stroke="#000000" d="M830.215,-1148.54C844.799,-1145.99 862.355,-1142.91 877.993,-1140.18"/>
<polygon fill="#000000" stroke="#000000" points="878.694,-1143.61 887.941,-1138.44 877.487,-1136.71 878.694,-1143.61"/>
</g>
<!-- proc~approx_le&#45;&gt;proc~approx_eq -->
<g id="proc~~ndmc~~CallsGraph_edge118" class="edge"><title>proc~approx_le&#45;&gt;proc~approx_eq</title>
<path fill="none" stroke="#000000" d="M828.049,-1117.08C842.984,-1119.7 861.442,-1122.93 877.819,-1125.79"/>
<polygon fill="#000000" stroke="#000000" points="877.243,-1129.25 887.697,-1127.52 878.45,-1122.35 877.243,-1129.25"/>
</g>
<!-- proc~comdiv -->
<g id="proc~~ndmc~~CallsGraph_node72" class="node"><title>proc~comdiv</title>
<g id="a_proc~~ndmc~~CallsGraph_node72"><a xlink:href=".././proc/comdiv.html" xlink:title="Comdiv">
<polygon fill="#d9534f" stroke="#d9534f" points="825,-800 771,-800 771,-776 825,-776 825,-800"/>
<text text-anchor="middle" x="798" y="-785.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Comdiv</text>
</a>
</g>
</g>
<!-- proc~hqrvec&#45;&gt;proc~comdiv -->
<g id="proc~~ndmc~~CallsGraph_edge119" class="edge"><title>proc~hqrvec&#45;&gt;proc~comdiv</title>
<path fill="none" stroke="#000000" d="M693.307,-788C712.69,-788 739.29,-788 760.695,-788"/>
<polygon fill="#000000" stroke="#000000" points="760.732,-791.5 770.732,-788 760.732,-784.5 760.732,-791.5"/>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge120" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M677.167,-1288.38C687.1,-1300.5 702.632,-1319.48 716,-1336 738.642,-1363.98 764.649,-1396.47 780.954,-1416.88"/>
<polygon fill="#000000" stroke="#000000" points="778.335,-1419.21 787.309,-1424.85 783.806,-1414.85 778.335,-1419.21"/>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_edge121" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl</title>
<path fill="none" stroke="#000000" d="M697.151,-1266.72C714.525,-1261.38 736.614,-1254.58 755.596,-1248.74"/>
<polygon fill="#000000" stroke="#000000" points="756.67,-1252.07 765.198,-1245.79 754.611,-1245.38 756.67,-1252.07"/>
</g>
</g>
</svg>
</div><script>var panprocndmcCallsGraph = svgPanZoom('#procndmcCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~ndmc~~CalledByGraph Pages: 1 -->
<svg id="procndmcCalledByGraph" width="152pt" height="32pt"
 viewBox="0.00 0.00 152.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~ndmc~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~ndmc~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 148,-28 148,4 -4,4"/>
<!-- proc~ndmc -->
<g id="proc~~ndmc~~CalledByGraph_node1" class="node"><title>proc~ndmc</title>
<polygon fill="none" stroke="black" points="144,-24 90,-24 90,-0 144,-0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">ndmc</text>
</g>
<!-- program~fidasim -->
<g id="proc~~ndmc~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~ndmc~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~ndmc -->
<g id="proc~~ndmc~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~ndmc</title>
<path fill="none" stroke="#000000" d="M54.4029,-12C62.3932,-12 71.3106,-12 79.8241,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.919,-15.5001 89.919,-12 79.919,-8.5001 79.919,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/ndmc.html#src">ndmc</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">ndmc</span><span class="w"></span>
<span class="w">    </span><span class="c">!+ Calculates neutral beam deposition and spectra</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">neut_type</span><span class="w"> </span><span class="c">!! full half third energy</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">nlaunch</span><span class="w">   </span><span class="c">!! nr. of markers</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">nneutrals</span><span class="w"> </span><span class="c">!! # NBI particles</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">vnbi</span><span class="w"> </span><span class="c">!! velocities(full..)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rnbi</span><span class="w"> </span><span class="c">!! initial position</span>

<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">jj</span><span class="p">,</span><span class="w"> </span><span class="n">ii</span><span class="p">,</span><span class="w"> </span><span class="n">kk</span><span class="p">,</span><span class="w"> </span><span class="n">cnt</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ntrack</span><span class="p">,</span><span class="w"> </span><span class="n">ic</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">ParticleTrack</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ntrack</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tracks</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">plasma</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fields</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">states</span><span class="p">,</span><span class="w"> </span><span class="n">dens</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">photons</span><span class="p">,</span><span class="w"> </span><span class="n">iflux</span><span class="p">,</span><span class="n">flux_tot</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ind</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ri</span><span class="p">,</span><span class="n">ri_gc</span><span class="p">,</span><span class="n">r_gyro</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">randomu</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">randi</span><span class="w"></span>
<span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">err</span><span class="w"></span>

<span class="w">    </span><span class="c">!! Initialize Neutral Population</span>
<span class="w">    </span><span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">half</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">third</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i10)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of birth markers: 3 x&quot;,i10)&#39;</span><span class="p">)</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="o">*</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_birth</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">    endif</span><span class="w"></span>

<span class="w">    </span><span class="c">!! # of injected neutrals = NBI power/energy_per_particle</span>
<span class="w">    </span><span class="n">nneutrals</span><span class="o">=</span><span class="mf">1.d6</span><span class="o">*</span><span class="n">nbi</span><span class="p">%</span><span class="n">pinj</span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.d3</span><span class="o">*</span><span class="n">nbi</span><span class="p">%</span><span class="n">einj</span><span class="o">*</span><span class="n">e0</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="o">*</span><span class="p">(</span><span class="w"> </span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="o">+</span><span class="w">  </span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.d0</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="o">+</span><span class="w">  </span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mf">3.d0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">nlaunch</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="c">!$OMP PARALLEL DO schedule(guided) &amp;</span>
<span class="w">    </span><span class="c">!$OMP&amp; private(vnbi,rnbi,tracks,ntrack,plasma,fields,randi,flux_tot, &amp;</span>
<span class="w">    </span><span class="c">!$OMP&amp; states,dens,iflux,photons,neut_type,jj,ii,kk,ind,err,ri,ri_gc,r_gyro)</span>
<span class="w">    </span><span class="n">loop_over_markers</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">ii</span><span class="o">=</span><span class="n">istart</span><span class="p">,</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="p">,</span><span class="n">istep</span><span class="w"></span>
<span class="w">        </span><span class="n">energy_fractions</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">neut_type</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="w"></span>
<span class="w">            </span><span class="c">!! (type = 1: full energy, =2: half energy, =3: third energy</span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="n">neut_type</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">energy_fractions</span><span class="w"></span>

<span class="w">            </span><span class="k">call </span><span class="n">mc_nbi</span><span class="p">(</span><span class="n">vnbi</span><span class="p">,</span><span class="n">neut_type</span><span class="p">,</span><span class="n">rnbi</span><span class="p">,</span><span class="n">err</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">energy_fractions</span><span class="w"></span>

<span class="w">            </span><span class="k">call </span><span class="n">track</span><span class="p">(</span><span class="n">rnbi</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">tracks</span><span class="p">,</span><span class="n">ntrack</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">ntrack</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">energy_fractions</span><span class="w"></span>

<span class="w">            </span><span class="c">!! Solve collisional radiative model along track</span>
<span class="w">            </span><span class="n">flux_tot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.d0</span><span class="w"></span>
<span class="w">            </span><span class="n">states</span><span class="o">=</span><span class="mf">0.d0</span><span class="w"></span>
<span class="w">            </span><span class="n">states</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">nneutrals</span><span class="o">*</span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="n">neut_type</span><span class="p">)</span><span class="o">/</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="w"></span>
<span class="w">            </span><span class="n">loop_along_track</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">jj</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ntrack</span><span class="w"></span>
<span class="w">                </span><span class="n">iflux</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="n">ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">ind</span><span class="w"></span>
<span class="w">                </span><span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">call </span><span class="n">colrad</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">beam_mass</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="nb">time</span><span class="p">,</span><span class="n">states</span><span class="p">,</span><span class="n">dens</span><span class="p">,</span><span class="n">photons</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="n">dens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dens</span><span class="o">/</span><span class="n">nlaunch</span><span class="w"></span>
<span class="w">                </span><span class="k">call </span><span class="n">store_neutrals</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">neut_type</span><span class="p">,</span><span class="n">dens</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">flux</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">iflux</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">))</span><span class="o">/</span><span class="n">nlaunch</span><span class="w"></span>
<span class="w">                </span><span class="n">flux_tot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">flux_tot</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">flux</span><span class="o">*</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    call </span><span class="n">store_births</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">neut_type</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">flux</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">endif</span>

<span class="k">                if</span><span class="p">((</span><span class="n">photons</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_bes</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    call </span><span class="n">store_nbi_photons</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">beam_lambda0</span><span class="p">,</span><span class="w"> </span><span class="n">photons</span><span class="o">/</span><span class="n">nlaunch</span><span class="p">,</span><span class="n">neut_type</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">endif</span>
<span class="k">            enddo </span><span class="n">loop_along_track</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">((</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">flux_tot</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">                </span><span class="c">!! Sample according to deposited flux along neutral trajectory</span>
<span class="w">                </span><span class="c">!$OMP CRITICAL(ndmc_birth)</span>
<span class="w">                </span><span class="k">do </span><span class="n">kk</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_birth</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">randind</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ntrack</span><span class="p">)%</span><span class="n">flux</span><span class="p">,</span><span class="n">randi</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">randu</span><span class="p">(</span><span class="n">randomu</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">neut_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neut_type</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">energy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbi</span><span class="p">%</span><span class="n">einj</span><span class="o">/</span><span class="kt">real</span><span class="p">(</span><span class="n">neut_type</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">flux_tot</span><span class="o">/</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_birth</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tracks</span><span class="p">(</span><span class="n">randi</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">ind</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">vi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vnbi</span><span class="w"></span>
<span class="w">                    </span><span class="n">ri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tracks</span><span class="p">(</span><span class="n">randi</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">pos</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">vnbi</span><span class="o">*</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="n">randi</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="nb">time</span><span class="o">*</span><span class="p">(</span><span class="n">randomu</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">))</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">ri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ri</span><span class="w"></span>

<span class="w">                    </span><span class="k">call </span><span class="n">get_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">pitch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dot_product</span><span class="p">(</span><span class="n">fields</span><span class="p">%</span><span class="n">b_norm</span><span class="p">,</span><span class="n">vnbi</span><span class="o">/</span><span class="nb">norm2</span><span class="p">(</span><span class="n">vnbi</span><span class="p">))</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">gyro_step</span><span class="p">(</span><span class="n">vnbi</span><span class="p">,</span><span class="n">fields</span><span class="p">,</span><span class="n">beam_mass</span><span class="p">,</span><span class="n">r_gyro</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">ri_gc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ri</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r_gyro</span><span class="w"></span>
<span class="w">                    </span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                </span><span class="k">enddo</span><span class="w"></span>
<span class="w">                </span><span class="c">!$OMP END CRITICAL(ndmc_birth)</span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">        enddo </span><span class="n">energy_fractions</span><span class="w"></span>
<span class="w">    </span><span class="k">enddo </span><span class="n">loop_over_markers</span><span class="w"></span>
<span class="w">    </span><span class="c">!$OMP END PARALLEL DO</span>

<span class="cp">#ifdef _MPI</span>
<span class="w">    </span><span class="c">!! Combine beam neutrals</span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_merge_populations</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_merge_populations</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">half</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_merge_populations</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">third</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">nbi_outside</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">dens</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span><span class="w"></span>
<span class="w">    </span><span class="c">!! Combine spectra</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_bes</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">full</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">half</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">third</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span><span class="w"></span>
<span class="cp">#endif</span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">nbi_outside</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="k">        if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T4,a, f6.2,a)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Percent of markers outside the grid: &#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                                  </span><span class="mi">10</span><span class="mf">0.</span><span class="o">*</span><span class="n">nbi_outside</span><span class="o">/</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="p">),</span><span class="s1">&#39;%&#39;</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">        if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">%</span><span class="n">dens</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">stop</span><span class="w"> </span><span class="s1">&#39;Beam does not intersect the grid!&#39;</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">end subroutine </span><span class="n">ndmc</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>