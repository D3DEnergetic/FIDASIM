<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>ndmc &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
               
        
        
            </ul>
        
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>



          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>ndmc
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.7% of total for procedures.">94 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
    
     <li><a href='../module/libfida.html'>libfida</a></li>
    
  
     <li class="active">ndmc</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/ndmc.html#src">ndmc</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine ndmc()
    
    
   
</h2>
    
  


    
    <p>Calculates neutral beam deposition and spectra</p>
    

    <h3>Arguments</h3>
    
    <em>None</em>
    <br>
    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~ndmc~~CallsGraph Pages: 1 -->
<svg id="procndmcCallsGraph" width="641pt" height="930pt"
 viewBox="0.00 0.00 641.00 929.71" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~ndmc~~CallsGraph" class="graph" transform="scale(0.66219 0.66219) rotate(0) translate(4 1400)">
<title>proc~~ndmc~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1400 964,-1400 964,4 -4,4"/>
<!-- proc~ndmc -->
<g id="proc~~ndmc~~CallsGraph_node1" class="node"><title>proc~ndmc</title>
<polygon fill="none" stroke="black" points="54,-814 0,-814 0,-790 54,-790 54,-814"/>
<text text-anchor="middle" x="27" y="-799.6" font-family="Helvetica,sans-Serif" font-size="10.50">ndmc</text>
</g>
<!-- proc~track -->
<g id="proc~~ndmc~~CallsGraph_node2" class="node"><title>proc~track</title>
<g id="a_proc~~ndmc~~CallsGraph_node2"><a xlink:href=".././proc/track.html" xlink:title="track">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-1234 314,-1234 314,-1210 368,-1210 368,-1234"/>
<text text-anchor="middle" x="341" y="-1219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~track -->
<g id="proc~~ndmc~~CallsGraph_edge1" class="edge"><title>proc~ndmc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M29.1171,-814.261C33.9015,-864.456 54.0731,-1053.8 90,-1100 144.172,-1169.66 248.377,-1202.03 303.593,-1214.86"/>
<polygon fill="#000000" stroke="#000000" points="303.109,-1218.34 313.632,-1217.1 304.634,-1211.5 303.109,-1218.34"/>
</g>
<!-- proc~colrad -->
<g id="proc~~ndmc~~CallsGraph_node3" class="node"><title>proc~colrad</title>
<g id="a_proc~~ndmc~~CallsGraph_node3"><a xlink:href=".././proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="190,-550 136,-550 136,-526 190,-526 190,-550"/>
<text text-anchor="middle" x="163" y="-535.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~colrad -->
<g id="proc~~ndmc~~CallsGraph_edge2" class="edge"><title>proc~ndmc&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M27.4721,-789.798C26.4877,-751.333 28.7054,-631.19 90,-564 99.2585,-553.851 112.779,-547.659 125.61,-543.883"/>
<polygon fill="#000000" stroke="#000000" points="126.82,-547.187 135.658,-541.343 125.105,-540.401 126.82,-547.187"/>
</g>
<!-- interface~randu -->
<g id="proc~~ndmc~~CallsGraph_node4" class="node"><title>interface~randu</title>
<g id="a_proc~~ndmc~~CallsGraph_node4"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="947,-792 893,-792 893,-768 947,-768 947,-792"/>
<text text-anchor="middle" x="920" y="-777.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge3" class="edge"><title>proc~ndmc&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M53.7498,-814.079C64.7098,-818.771 77.7658,-823.781 90,-827 198.387,-855.516 227.925,-860 340,-860 340,-860 340,-860 667,-860 746.119,-860 770.97,-871.436 844,-841 866.352,-831.684 887.332,-813.493 901.387,-799.39"/>
<polygon fill="#000000" stroke="#000000" points="904.032,-801.689 908.447,-792.057 898.99,-796.833 904.032,-801.689"/>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_node5" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~ndmc~~CallsGraph_node5"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="549.5,-474 476.5,-474 476.5,-450 549.5,-450 549.5,-474"/>
<text text-anchor="middle" x="513" y="-459.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_edge4" class="edge"><title>proc~ndmc&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M31.2243,-789.811C38.1945,-765.53 56.7784,-710.581 90,-677 200.86,-564.941 382.335,-500.145 466.495,-474.667"/>
<polygon fill="#000000" stroke="#000000" points="467.682,-477.966 476.265,-471.754 465.682,-471.257 467.682,-477.966"/>
</g>
<!-- proc~mc_nbi -->
<g id="proc~~ndmc~~CallsGraph_node6" class="node"><title>proc~mc_nbi</title>
<g id="a_proc~~ndmc~~CallsGraph_node6"><a xlink:href=".././proc/mc_nbi.html" xlink:title="mc_nbi">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-988 314,-988 314,-964 368,-964 368,-988"/>
<text text-anchor="middle" x="341" y="-973.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_nbi</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~mc_nbi -->
<g id="proc~~ndmc~~CallsGraph_edge5" class="edge"><title>proc~ndmc&#45;&gt;proc~mc_nbi</title>
<path fill="none" stroke="#000000" d="M35.8368,-814.27C46.4312,-830 66.7003,-857.238 90,-874 157.996,-922.917 252.871,-953.241 303.974,-967.095"/>
<polygon fill="#000000" stroke="#000000" points="303.327,-970.544 313.89,-969.724 305.121,-963.778 303.327,-970.544"/>
</g>
<!-- proc~init_neutral_population -->
<g id="proc~~ndmc~~CallsGraph_node7" class="node"><title>proc~init_neutral_population</title>
<g id="a_proc~~ndmc~~CallsGraph_node7"><a xlink:href=".././proc/init_neutral_population.html" xlink:title="init_neutral_population">
<polygon fill="#d9534f" stroke="#d9534f" points="223.5,-508 102.5,-508 102.5,-484 223.5,-484 223.5,-508"/>
<text text-anchor="middle" x="163" y="-493.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_neutral_population</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~init_neutral_population -->
<g id="proc~~ndmc~~CallsGraph_edge6" class="edge"><title>proc~ndmc&#45;&gt;proc~init_neutral_population</title>
<path fill="none" stroke="#000000" d="M29.0197,-789.769C33.3586,-740.586 51.8354,-557.917 90,-517 91.2212,-515.691 92.5189,-514.462 93.8814,-513.308"/>
<polygon fill="#000000" stroke="#000000" points="96.0705,-516.049 102.311,-507.488 92.0935,-510.289 96.0705,-516.049"/>
</g>
<!-- interface~randind -->
<g id="proc~~ndmc~~CallsGraph_node8" class="node"><title>interface~randind</title>
<g id="a_proc~~ndmc~~CallsGraph_node8"><a xlink:href=".././interface/randind.html" xlink:title="randind">
<polygon fill="#a7506f" stroke="#a7506f" points="825,-832 771,-832 771,-808 825,-808 825,-832"/>
<text text-anchor="middle" x="798" y="-817.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;interface~randind -->
<g id="proc~~ndmc~~CallsGraph_edge7" class="edge"><title>proc~ndmc&#45;&gt;interface~randind</title>
<path fill="none" stroke="#000000" d="M54.2607,-804.823C107.888,-810.336 233.887,-822 340,-822 340,-822 340,-822 514,-822 602.67,-822 706.964,-821.006 760.787,-820.42"/>
<polygon fill="#000000" stroke="#000000" points="760.899,-823.919 770.859,-820.308 760.821,-816.919 760.899,-823.919"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~ndmc~~CallsGraph_node9" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~ndmc~~CallsGraph_node9"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="547,-1396 479,-1396 479,-1372 547,-1372 547,-1396"/>
<text text-anchor="middle" x="513" y="-1381.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~get_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge8" class="edge"><title>proc~ndmc&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M28.2354,-814.297C29.6503,-876.147 38.7957,-1152.83 90,-1218 185.234,-1339.2 381.638,-1372.11 468.755,-1380.89"/>
<polygon fill="#000000" stroke="#000000" points="468.537,-1384.38 478.823,-1381.84 469.198,-1377.41 468.537,-1384.38"/>
</g>
<!-- proc~store_births -->
<g id="proc~~ndmc~~CallsGraph_node10" class="node"><title>proc~store_births</title>
<g id="a_proc~~ndmc~~CallsGraph_node10"><a xlink:href=".././proc/store_births.html" xlink:title="store_births">
<polygon fill="#d9534f" stroke="#d9534f" points="197.5,-466 128.5,-466 128.5,-442 197.5,-442 197.5,-466"/>
<text text-anchor="middle" x="163" y="-451.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_births</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~store_births -->
<g id="proc~~ndmc~~CallsGraph_edge9" class="edge"><title>proc~ndmc&#45;&gt;proc~store_births</title>
<path fill="none" stroke="#000000" d="M28.6453,-789.839C31.7219,-736.381 46.5943,-522.806 90,-475 97.4385,-466.807 107.873,-461.74 118.494,-458.626"/>
<polygon fill="#000000" stroke="#000000" points="119.32,-462.027 128.221,-456.281 117.679,-455.222 119.32,-462.027"/>
</g>
<!-- proc~gyro_step -->
<g id="proc~~ndmc~~CallsGraph_node11" class="node"><title>proc~gyro_step</title>
<g id="a_proc~~ndmc~~CallsGraph_node11"><a xlink:href=".././proc/gyro_step.html" xlink:title="gyro_step">
<polygon fill="#d9534f" stroke="#d9534f" points="193,-245 133,-245 133,-221 193,-221 193,-245"/>
<text text-anchor="middle" x="163" y="-230.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_step</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~gyro_step -->
<g id="proc~~ndmc~~CallsGraph_edge10" class="edge"><title>proc~ndmc&#45;&gt;proc~gyro_step</title>
<path fill="none" stroke="#000000" d="M29.2535,-789.728C34.2134,-742.827 53.9755,-570.627 90,-433 107.351,-366.713 137.408,-291.373 152.612,-254.981"/>
<polygon fill="#000000" stroke="#000000" points="155.997,-255.963 156.654,-245.389 149.546,-253.245 155.997,-255.963"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_node12" class="node"><title>proc~get_fields</title>
<g id="a_proc~~ndmc~~CallsGraph_node12"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="542,-1274 484,-1274 484,-1250 542,-1250 542,-1274"/>
<text text-anchor="middle" x="513" y="-1259.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_edge11" class="edge"><title>proc~ndmc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M28.6002,-814.006C31.6073,-869.847 46.6484,-1103.82 90,-1160 182.162,-1279.44 388.171,-1274.46 473.67,-1266.61"/>
<polygon fill="#000000" stroke="#000000" points="474.113,-1270.08 483.722,-1265.62 473.427,-1263.11 474.113,-1270.08"/>
</g>
<!-- proc~parallel_merge_populations -->
<g id="proc~~ndmc~~CallsGraph_node13" class="node"><title>proc~parallel_merge_populations</title>
<g id="a_proc~~ndmc~~CallsGraph_node13"><a xlink:href=".././proc/parallel_merge_populations.html" xlink:title="parallel_merge_populations">
<polygon fill="#d9534f" stroke="#d9534f" points="235.5,-710 90.5,-710 90.5,-686 235.5,-686 235.5,-710"/>
<text text-anchor="middle" x="163" y="-695.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_merge_populations</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~parallel_merge_populations -->
<g id="proc~~ndmc~~CallsGraph_edge12" class="edge"><title>proc~ndmc&#45;&gt;proc~parallel_merge_populations</title>
<path fill="none" stroke="#000000" d="M43.6338,-789.866C66.9326,-771.784 110.942,-737.627 138.238,-716.442"/>
<polygon fill="#000000" stroke="#000000" points="140.712,-718.953 146.466,-710.056 136.42,-713.423 140.712,-718.953"/>
</g>
<!-- proc~store_neutrals -->
<g id="proc~~ndmc~~CallsGraph_node14" class="node"><title>proc~store_neutrals</title>
<g id="a_proc~~ndmc~~CallsGraph_node14"><a xlink:href=".././proc/store_neutrals.html" xlink:title="store_neutrals">
<polygon fill="#d9534f" stroke="#d9534f" points="203.5,-794 122.5,-794 122.5,-770 203.5,-770 203.5,-794"/>
<text text-anchor="middle" x="163" y="-779.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_neutrals</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~store_neutrals -->
<g id="proc~~ndmc~~CallsGraph_edge13" class="edge"><title>proc~ndmc&#45;&gt;proc~store_neutrals</title>
<path fill="none" stroke="#000000" d="M54.1547,-798.096C70.6937,-795.628 92.6026,-792.358 112.351,-789.41"/>
<polygon fill="#000000" stroke="#000000" points="113.068,-792.842 122.442,-787.904 112.035,-785.919 113.068,-792.842"/>
</g>
<!-- proc~store_nbi_photons -->
<g id="proc~~ndmc~~CallsGraph_node15" class="node"><title>proc~store_nbi_photons</title>
<g id="a_proc~~ndmc~~CallsGraph_node15"><a xlink:href=".././proc/store_nbi_photons.html" xlink:title="store_nbi_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="213.5,-1091 112.5,-1091 112.5,-1067 213.5,-1067 213.5,-1091"/>
<text text-anchor="middle" x="163" y="-1076.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_nbi_photons</text>
</a>
</g>
</g>
<!-- proc~ndmc&#45;&gt;proc~store_nbi_photons -->
<g id="proc~~ndmc~~CallsGraph_edge14" class="edge"><title>proc~ndmc&#45;&gt;proc~store_nbi_photons</title>
<path fill="none" stroke="#000000" d="M32.5094,-814.188C42.1419,-839.894 65.8253,-901.38 90,-951 108.913,-989.82 134.314,-1033.3 149.341,-1058.28"/>
<polygon fill="#000000" stroke="#000000" points="146.386,-1060.16 154.557,-1066.9 152.375,-1056.53 146.386,-1060.16"/>
</g>
<!-- proc~track&#45;&gt;proc~get_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge16" class="edge"><title>proc~track&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M349.72,-1234.4C369.212,-1265.35 420.655,-1344.84 446,-1363 452.955,-1367.98 461.143,-1371.82 469.341,-1374.76"/>
<polygon fill="#000000" stroke="#000000" points="468.305,-1378.1 478.896,-1377.82 470.438,-1371.44 468.305,-1378.1"/>
</g>
<!-- proc~track&#45;&gt;proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_edge17" class="edge"><title>proc~track&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M368.19,-1228.16C396.428,-1234.81 441.651,-1245.45 473.841,-1253.02"/>
<polygon fill="#000000" stroke="#000000" points="473.261,-1256.48 483.797,-1255.36 474.864,-1249.67 473.261,-1256.48"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_node23" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~ndmc~~CallsGraph_node23"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="696.5,-1137 635.5,-1137 635.5,-1113 696.5,-1113 696.5,-1137"/>
<text text-anchor="middle" x="666" y="-1122.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge15" class="edge"><title>proc~track&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M368.227,-1227.04C414.662,-1234.52 512.772,-1243.63 580,-1203 605.644,-1187.5 593.203,-1165.44 616,-1146 619.081,-1143.37 622.54,-1141.03 626.157,-1138.95"/>
<polygon fill="#000000" stroke="#000000" points="627.998,-1141.94 635.353,-1134.32 624.848,-1135.69 627.998,-1141.94"/>
</g>
<!-- proc~get_indices -->
<g id="proc~~ndmc~~CallsGraph_node27" class="node"><title>proc~get_indices</title>
<g id="a_proc~~ndmc~~CallsGraph_node27"><a xlink:href=".././proc/get_indices.html" xlink:title="get_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="546.5,-1194 479.5,-1194 479.5,-1170 546.5,-1170 546.5,-1194"/>
<text text-anchor="middle" x="513" y="-1179.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_indices</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~get_indices -->
<g id="proc~~ndmc~~CallsGraph_edge18" class="edge"><title>proc~track&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M368.19,-1215.84C395.167,-1209.49 437.647,-1199.49 469.455,-1192.01"/>
<polygon fill="#000000" stroke="#000000" points="470.441,-1195.37 479.374,-1189.68 468.838,-1188.56 470.441,-1195.37"/>
</g>
<!-- proc~doppler_stark -->
<g id="proc~~ndmc~~CallsGraph_node42" class="node"><title>proc~doppler_stark</title>
<g id="a_proc~~ndmc~~CallsGraph_node42"><a xlink:href=".././proc/doppler_stark.html" xlink:title="doppler_stark">
<polygon fill="#d9534f" stroke="#d9534f" points="552,-1354 474,-1354 474,-1330 552,-1330 552,-1354"/>
<text text-anchor="middle" x="513" y="-1339.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">doppler_stark</text>
</a>
</g>
</g>
<!-- proc~track&#45;&gt;proc~doppler_stark -->
<g id="proc~~ndmc~~CallsGraph_edge19" class="edge"><title>proc~track&#45;&gt;proc~doppler_stark</title>
<path fill="none" stroke="#000000" d="M352.732,-1234.2C370.463,-1253.75 407.736,-1292.27 446,-1316 451.907,-1319.66 458.417,-1322.97 464.977,-1325.91"/>
<polygon fill="#000000" stroke="#000000" points="463.986,-1329.29 474.561,-1329.94 466.701,-1322.84 463.986,-1329.29"/>
</g>
<!-- proc~linsolve -->
<g id="proc~~ndmc~~CallsGraph_node30" class="node"><title>proc~linsolve</title>
<g id="a_proc~~ndmc~~CallsGraph_node30"><a xlink:href=".././proc/linsolve.html" xlink:title="linsolve">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-108 314,-108 314,-84 368,-84 368,-108"/>
<text text-anchor="middle" x="341" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linsolve</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~linsolve -->
<g id="proc~~ndmc~~CallsGraph_edge20" class="edge"><title>proc~colrad&#45;&gt;proc~linsolve</title>
<path fill="none" stroke="#000000" d="M190.127,-537.255C205.792,-535.351 224.788,-530.198 236,-517 278.758,-466.668 251.969,-284.931 272,-222 284.635,-182.304 309.87,-140.583 325.792,-116.5"/>
<polygon fill="#000000" stroke="#000000" points="328.715,-118.426 331.393,-108.175 322.907,-114.518 328.715,-118.426"/>
</g>
<!-- proc~eigen -->
<g id="proc~~ndmc~~CallsGraph_node35" class="node"><title>proc~eigen</title>
<g id="a_proc~~ndmc~~CallsGraph_node35"><a xlink:href=".././proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-255 314,-255 314,-231 368,-231 368,-255"/>
<text text-anchor="middle" x="341" y="-240.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~ndmc~~CallsGraph_edge21" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M190.121,-536.095C205.195,-533.723 223.568,-528.487 236,-517 311.376,-447.353 332.536,-317.363 338.122,-265.352"/>
<polygon fill="#000000" stroke="#000000" points="341.623,-265.511 339.115,-255.217 334.656,-264.828 341.623,-265.511"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~ndmc~~CallsGraph_node41" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~ndmc~~CallsGraph_node41"><a xlink:href=".././proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="385,-710 297,-710 297,-686 385,-686 385,-710"/>
<text text-anchor="middle" x="341" y="-695.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~ndmc~~CallsGraph_edge22" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M170.026,-550.055C184.087,-576.955 221.725,-642.243 272,-677 276.637,-680.206 281.781,-682.936 287.104,-685.258"/>
<polygon fill="#000000" stroke="#000000" points="286.219,-688.668 296.808,-689.012 288.745,-682.14 286.219,-688.668"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_node17" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~ndmc~~CallsGraph_node17"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="843.5,-382 752.5,-382 752.5,-358 843.5,-358 843.5,-382"/>
<text text-anchor="middle" x="798" y="-367.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge25" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M529.235,-449.879C548.337,-435.349 582.641,-411.407 616,-399 656.761,-383.84 705.58,-376.601 742.24,-373.147"/>
<polygon fill="#000000" stroke="#000000" points="742.584,-376.63 752.24,-372.27 741.973,-369.657 742.584,-376.63"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~ndmc~~CallsGraph_node18" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~ndmc~~CallsGraph_node18"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="711.5,-432 620.5,-432 620.5,-408 711.5,-408 711.5,-432"/>
<text text-anchor="middle" x="666" y="-417.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~ndmc~~CallsGraph_edge26" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M549.785,-452.047C568.297,-446.897 591.263,-440.51 611.807,-434.795"/>
<polygon fill="#000000" stroke="#000000" points="612.972,-438.104 621.668,-432.053 611.096,-431.36 612.972,-438.104"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~ndmc~~CallsGraph_node20" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~ndmc~~CallsGraph_node20"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="711.5,-352 620.5,-352 620.5,-328 711.5,-328 711.5,-352"/>
<text text-anchor="middle" x="666" y="-337.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~ndmc~~CallsGraph_edge29" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M524.745,-449.988C542.444,-430.664 579.424,-392.194 616,-366 620.453,-362.811 625.346,-359.756 630.264,-356.932"/>
<polygon fill="#000000" stroke="#000000" points="631.961,-359.993 639.052,-352.121 628.6,-353.853 631.961,-359.993"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_node22" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~ndmc~~CallsGraph_node22"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="842,-556 754,-556 754,-532 842,-532 842,-556"/>
<text text-anchor="middle" x="798" y="-541.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_edge24" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M528.796,-474.162C547.722,-488.971 582.12,-513.435 616,-525 657.409,-539.135 706.982,-543.537 743.769,-544.6"/>
<polygon fill="#000000" stroke="#000000" points="743.715,-548.1 753.789,-544.817 743.867,-541.101 743.715,-548.1"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~ndmc~~CallsGraph_node25" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~ndmc~~CallsGraph_node25"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="842,-264 754,-264 754,-240 842,-240 842,-264"/>
<text text-anchor="middle" x="798" y="-249.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~ndmc~~CallsGraph_edge31" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M519.895,-449.869C539.134,-410.493 599.791,-288.139 616,-277 653.199,-251.437 704.961,-246.567 743.607,-247.284"/>
<polygon fill="#000000" stroke="#000000" points="743.528,-250.784 753.633,-247.6 743.748,-243.787 743.528,-250.784"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~ndmc~~CallsGraph_node26" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~ndmc~~CallsGraph_node26"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="710,-596 622,-596 622,-572 710,-572 710,-596"/>
<text text-anchor="middle" x="666" y="-581.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~ndmc~~CallsGraph_edge32" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M524.745,-474.012C542.444,-493.336 579.424,-531.806 616,-558 620.453,-561.189 625.346,-564.244 630.264,-567.068"/>
<polygon fill="#000000" stroke="#000000" points="628.6,-570.147 639.052,-571.879 631.961,-564.007 628.6,-570.147"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~ndmc~~CallsGraph_node32" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~ndmc~~CallsGraph_node32"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="843.5,-222 752.5,-222 752.5,-198 843.5,-198 843.5,-222"/>
<text text-anchor="middle" x="798" y="-207.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~ndmc~~CallsGraph_edge27" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M520.212,-449.812C532.161,-426.259 559.019,-372.771 580,-327 596.925,-290.077 584.242,-268.322 616,-243 651.42,-214.758 703.148,-207.68 742.242,-206.984"/>
<polygon fill="#000000" stroke="#000000" points="742.415,-210.483 752.4,-206.94 742.385,-203.483 742.415,-210.483"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~ndmc~~CallsGraph_node33" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~ndmc~~CallsGraph_node33"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="710,-516 622,-516 622,-492 710,-492 710,-516"/>
<text text-anchor="middle" x="666" y="-501.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~ndmc~~CallsGraph_edge28" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M549.785,-471.953C568.372,-477.123 591.449,-483.542 612.056,-489.274"/>
<polygon fill="#000000" stroke="#000000" points="611.372,-492.716 621.944,-492.024 613.248,-485.972 611.372,-492.716"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~ndmc~~CallsGraph_node37" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~ndmc~~CallsGraph_node37"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="711.5,-310 620.5,-310 620.5,-286 711.5,-286 711.5,-310"/>
<text text-anchor="middle" x="666" y="-295.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~ndmc~~CallsGraph_edge23" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M519.689,-449.957C532.964,-423.018 568.501,-357.257 616,-319 617.728,-317.608 619.561,-316.293 621.466,-315.053"/>
<polygon fill="#000000" stroke="#000000" points="623.218,-318.083 630.163,-310.083 619.745,-312.005 623.218,-318.083"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~ndmc~~CallsGraph_node40" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~ndmc~~CallsGraph_node40"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="711.5,-474 620.5,-474 620.5,-450 711.5,-450 711.5,-474"/>
<text text-anchor="middle" x="666" y="-459.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~ndmc~~CallsGraph_edge30" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M549.785,-462C567.757,-462 589.927,-462 610.004,-462"/>
<polygon fill="#000000" stroke="#000000" points="610.279,-465.5 620.279,-462 610.279,-458.5 610.279,-465.5"/>
</g>
<!-- proc~mc_nbi&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge33" class="edge"><title>proc~mc_nbi&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M368.021,-970.164C416.65,-959.309 524.66,-935.444 616,-917 717.08,-896.589 755.653,-927.184 844,-874 873.292,-856.367 895.799,-822.826 908.215,-800.947"/>
<polygon fill="#000000" stroke="#000000" points="911.332,-802.543 913.054,-792.089 905.188,-799.187 911.332,-802.543"/>
</g>
<!-- proc~grid_intersect -->
<g id="proc~~ndmc~~CallsGraph_node21" class="node"><title>proc~grid_intersect</title>
<g id="a_proc~~ndmc~~CallsGraph_node21"><a xlink:href=".././proc/grid_intersect.html" xlink:title="grid_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="551.5,-1030 474.5,-1030 474.5,-1006 551.5,-1006 551.5,-1030"/>
<text text-anchor="middle" x="513" y="-1015.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">grid_intersect</text>
</a>
</g>
</g>
<!-- proc~mc_nbi&#45;&gt;proc~grid_intersect -->
<g id="proc~~ndmc~~CallsGraph_edge34" class="edge"><title>proc~mc_nbi&#45;&gt;proc~grid_intersect</title>
<path fill="none" stroke="#000000" d="M368.19,-982.47C393.823,-988.803 433.451,-998.594 464.622,-1006.29"/>
<polygon fill="#000000" stroke="#000000" points="463.87,-1009.71 474.417,-1008.71 465.549,-1002.92 463.87,-1009.71"/>
</g>
<!-- proc~mc_nbi&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge35" class="edge"><title>proc~mc_nbi&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M358.891,-988.198C378.854,-1002.14 413.481,-1024.85 446,-1039 502.761,-1063.7 524.528,-1049.52 580,-1077 597.922,-1085.88 598.685,-1093.99 616,-1104 619.235,-1105.87 622.669,-1107.67 626.157,-1109.38"/>
<polygon fill="#000000" stroke="#000000" points="624.878,-1112.65 635.423,-1113.68 627.821,-1106.3 624.878,-1112.65"/>
</g>
<!-- interface~randn -->
<g id="proc~~ndmc~~CallsGraph_node31" class="node"><title>interface~randn</title>
<g id="a_proc~~ndmc~~CallsGraph_node31"><a xlink:href=".././interface/randn.html" xlink:title="randn">
<polygon fill="#a7506f" stroke="#a7506f" points="540,-988 486,-988 486,-964 540,-964 540,-988"/>
<text text-anchor="middle" x="513" y="-973.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randn</text>
</a>
</g>
</g>
<!-- proc~mc_nbi&#45;&gt;interface~randn -->
<g id="proc~~ndmc~~CallsGraph_edge36" class="edge"><title>proc~mc_nbi&#45;&gt;interface~randn</title>
<path fill="none" stroke="#000000" d="M368.19,-976C396.892,-976 443.14,-976 475.416,-976"/>
<polygon fill="#000000" stroke="#000000" points="475.78,-979.5 485.78,-976 475.78,-972.5 475.78,-979.5"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_node16" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~ndmc~~CallsGraph_node16"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="954,-1317 886,-1317 886,-1293 954,-1293 954,-1317"/>
<text text-anchor="middle" x="920" y="-1302.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge39" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M547.443,-1382.64C607.79,-1379.47 738.434,-1369.42 844,-1339 858.923,-1334.7 874.686,-1327.93 887.89,-1321.55"/>
<polygon fill="#000000" stroke="#000000" points="889.605,-1324.61 897.002,-1317.03 886.49,-1318.34 889.605,-1324.61"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge37" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M547.173,-1380.66C559.148,-1377.79 571.736,-1372.55 580,-1363 643.989,-1289.09 555.663,-1222.92 616,-1146 618.84,-1142.38 622.425,-1139.37 626.359,-1136.88"/>
<polygon fill="#000000" stroke="#000000" points="628.112,-1139.91 635.373,-1132.2 624.885,-1133.7 628.112,-1139.91"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_node24" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~ndmc~~CallsGraph_node24"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="832,-1217 764,-1217 764,-1193 832,-1193 832,-1217"/>
<text text-anchor="middle" x="798" y="-1202.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge38" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M547.186,-1377.15C589.645,-1367.13 663.913,-1345.26 716,-1306 724.017,-1299.96 760.297,-1253.15 781.485,-1225.43"/>
<polygon fill="#000000" stroke="#000000" points="784.5,-1227.25 787.779,-1217.17 778.933,-1223 784.5,-1227.25"/>
</g>
<!-- proc~get_position -->
<g id="proc~~ndmc~~CallsGraph_node38" class="node"><title>proc~get_position</title>
<g id="a_proc~~ndmc~~CallsGraph_node38"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="701,-1297 631,-1297 631,-1273 701,-1273 701,-1297"/>
<text text-anchor="middle" x="666" y="-1282.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~ndmc~~CallsGraph_edge40" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M547.076,-1376.53C557.989,-1373.28 569.909,-1368.85 580,-1363 606.656,-1347.55 631.968,-1322.5 647.927,-1304.97"/>
<polygon fill="#000000" stroke="#000000" points="650.946,-1306.84 654.975,-1297.05 645.715,-1302.19 650.946,-1306.84"/>
</g>
<!-- proc~cross_product -->
<g id="proc~~ndmc~~CallsGraph_node19" class="node"><title>proc~cross_product</title>
<g id="a_proc~~ndmc~~CallsGraph_node19"><a xlink:href=".././proc/cross_product.html" xlink:title="cross_product">
<polygon fill="#d94e8f" stroke="#d94e8f" points="381,-66 301,-66 301,-42 381,-42 381,-66"/>
<text text-anchor="middle" x="341" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cross_product</text>
</a>
</g>
</g>
<!-- proc~gyro_step&#45;&gt;proc~cross_product -->
<g id="proc~~ndmc~~CallsGraph_edge41" class="edge"><title>proc~gyro_step&#45;&gt;proc~cross_product</title>
<path fill="none" stroke="#000000" d="M168.99,-220.635C181.611,-190.925 217.713,-115.03 272,-75 277.679,-70.8123 284.209,-67.4479 290.926,-64.7479"/>
<polygon fill="#000000" stroke="#000000" points="292.564,-67.8814 300.826,-61.249 290.231,-61.2815 292.564,-67.8814"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge42" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M542.412,-1257.58C600.292,-1249.57 735.563,-1235.95 844,-1264 861.913,-1268.63 880.169,-1278.48 894.184,-1287.36"/>
<polygon fill="#000000" stroke="#000000" points="892.459,-1290.42 902.735,-1293 896.309,-1284.57 892.459,-1290.42"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~ndmc~~CallsGraph_edge43" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M542.209,-1256.32C555.121,-1252.47 569.785,-1246.16 580,-1236 610.543,-1205.62 585.911,-1176.83 616,-1146 619.018,-1142.91 622.565,-1140.24 626.347,-1137.96"/>
<polygon fill="#000000" stroke="#000000" points="628.166,-1140.96 635.463,-1133.28 624.968,-1134.73 628.166,-1140.96"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge45" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M542.269,-1252.14C562.573,-1245.37 590.707,-1236.63 616,-1231 662.397,-1220.68 716.434,-1213.54 753.304,-1209.39"/>
<polygon fill="#000000" stroke="#000000" points="754.14,-1212.82 763.698,-1208.24 753.375,-1205.86 754.14,-1212.82"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~ndmc~~CallsGraph_node36" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~ndmc~~CallsGraph_node36"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="716,-1179 616,-1179 616,-1155 716,-1155 716,-1179"/>
<text text-anchor="middle" x="666" y="-1164.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~ndmc~~CallsGraph_edge44" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M542.206,-1254.34C554.528,-1250.16 568.71,-1244.14 580,-1236 600.22,-1221.43 596.632,-1208.69 616,-1193 620.013,-1189.75 624.495,-1186.72 629.073,-1183.96"/>
<polygon fill="#000000" stroke="#000000" points="630.894,-1186.95 637.898,-1179 627.465,-1180.85 630.894,-1186.95"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~ndmc~~CallsGraph_edge46" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M542.048,-1266.27C564.087,-1269.63 595.197,-1274.37 620.609,-1278.24"/>
<polygon fill="#000000" stroke="#000000" points="620.336,-1281.74 630.749,-1279.78 621.39,-1274.82 620.336,-1281.74"/>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_edge47" class="edge"><title>proc~parallel_merge_populations&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M181.682,-685.998C202.546,-672.242 238.629,-649.706 272,-635 330.787,-609.094 357.117,-628.474 410,-592 452.009,-563.026 484.888,-511.547 501.04,-482.83"/>
<polygon fill="#000000" stroke="#000000" points="504.127,-484.48 505.866,-474.029 497.989,-481.115 504.127,-484.48"/>
</g>
<!-- proc~ind2sub -->
<g id="proc~~ndmc~~CallsGraph_node29" class="node"><title>proc~ind2sub</title>
<g id="a_proc~~ndmc~~CallsGraph_node29"><a xlink:href=".././proc/ind2sub.html" xlink:title="ind2sub">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-752 314,-752 314,-728 368,-728 368,-752"/>
<text text-anchor="middle" x="341" y="-737.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ind2sub</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;proc~ind2sub -->
<g id="proc~~ndmc~~CallsGraph_edge49" class="edge"><title>proc~parallel_merge_populations&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M214.435,-710.036C243.13,-716.883 278.386,-725.297 304.228,-731.463"/>
<polygon fill="#000000" stroke="#000000" points="303.444,-734.875 313.983,-733.791 305.069,-728.066 303.444,-734.875"/>
</g>
<!-- proc~parallel_merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_node34" class="node"><title>proc~parallel_merge_reservoirs</title>
<g id="a_proc~~ndmc~~CallsGraph_node34"><a xlink:href=".././proc/parallel_merge_reservoirs.html" xlink:title="parallel_merge_reservoirs">
<polygon fill="#d9534f" stroke="#d9534f" points="409.5,-668 272.5,-668 272.5,-644 409.5,-644 409.5,-668"/>
<text text-anchor="middle" x="341" y="-653.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_merge_reservoirs</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_populations&#45;&gt;proc~parallel_merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_edge48" class="edge"><title>proc~parallel_merge_populations&#45;&gt;proc~parallel_merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M214.435,-685.964C234.779,-681.11 258.42,-675.468 279.667,-670.398"/>
<polygon fill="#000000" stroke="#000000" points="280.644,-673.763 289.558,-668.037 279.019,-666.954 280.644,-673.763"/>
</g>
<!-- proc~update_neutrals -->
<g id="proc~~ndmc~~CallsGraph_node39" class="node"><title>proc~update_neutrals</title>
<g id="a_proc~~ndmc~~CallsGraph_node39"><a xlink:href=".././proc/update_neutrals.html" xlink:title="update_neutrals">
<polygon fill="#d9534f" stroke="#d9534f" points="386,-794 296,-794 296,-770 386,-770 386,-794"/>
<text text-anchor="middle" x="341" y="-779.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_neutrals</text>
</a>
</g>
</g>
<!-- proc~store_neutrals&#45;&gt;proc~update_neutrals -->
<g id="proc~~ndmc~~CallsGraph_edge50" class="edge"><title>proc~store_neutrals&#45;&gt;proc~update_neutrals</title>
<path fill="none" stroke="#000000" d="M203.937,-782C228.112,-782 259.267,-782 285.664,-782"/>
<polygon fill="#000000" stroke="#000000" points="285.897,-785.5 295.896,-782 285.896,-778.5 285.897,-785.5"/>
</g>
<!-- proc~store_photons -->
<g id="proc~~ndmc~~CallsGraph_node28" class="node"><title>proc~store_photons</title>
<g id="a_proc~~ndmc~~CallsGraph_node28"><a xlink:href=".././proc/store_photons.html" xlink:title="store_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="381.5,-1172 300.5,-1172 300.5,-1148 381.5,-1148 381.5,-1172"/>
<text text-anchor="middle" x="341" y="-1157.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_photons</text>
</a>
</g>
</g>
<!-- proc~store_nbi_photons&#45;&gt;proc~store_photons -->
<g id="proc~~ndmc~~CallsGraph_edge51" class="edge"><title>proc~store_nbi_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M190.349,-1091.13C220.635,-1105.06 270.499,-1128.01 304.264,-1143.55"/>
<polygon fill="#000000" stroke="#000000" points="303.211,-1146.92 313.759,-1147.92 306.138,-1140.56 303.211,-1146.92"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge53" class="edge"><title>proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M777.828,-382.014C770.784,-390.972 777.508,-400 798,-400 810.487,-400 817.862,-396.647 820.124,-392.001"/>
<polygon fill="#000000" stroke="#000000" points="823.526,-391.157 818.172,-382.014 816.656,-392.5 823.526,-391.157"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_node59" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="959.5,-411 880.5,-411 880.5,-387 959.5,-387 959.5,-411"/>
<text text-anchor="middle" x="920" y="-396.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge52" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M843.684,-380.799C852.398,-382.905 861.575,-385.122 870.409,-387.257"/>
<polygon fill="#000000" stroke="#000000" points="869.652,-390.675 880.195,-389.622 871.297,-383.871 869.652,-390.675"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge55" class="edge"><title>proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M698.469,-407.896C715.747,-401.251 737.376,-392.932 755.965,-385.783"/>
<polygon fill="#000000" stroke="#000000" points="757.293,-389.022 765.37,-382.165 754.78,-382.489 757.293,-389.022"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge54" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M711.807,-418.089C747.631,-416.351 799.108,-413.382 844,-409 852.457,-408.174 861.429,-407.128 870.116,-406.024"/>
<polygon fill="#000000" stroke="#000000" points="870.673,-409.481 880.134,-404.712 869.764,-402.54 870.673,-409.481"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge57" class="edge"><title>proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M711.739,-350.324C721.544,-352.587 732.032,-355.007 742.181,-357.349"/>
<polygon fill="#000000" stroke="#000000" points="741.648,-360.818 752.179,-359.657 743.222,-353.998 741.648,-360.818"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge56" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M711.842,-335.819C748.362,-333.927 800.765,-334.701 844,-349 863.932,-355.592 883.571,-369.006 897.749,-380.282"/>
<polygon fill="#000000" stroke="#000000" points="895.885,-383.281 905.826,-386.946 900.34,-377.882 895.885,-383.281"/>
</g>
<!-- proc~in_passive_grid -->
<g id="proc~~ndmc~~CallsGraph_node44" class="node"><title>proc~in_passive_grid</title>
<g id="a_proc~~ndmc~~CallsGraph_node44"><a xlink:href=".././proc/in_passive_grid.html" xlink:title="in_passive_grid">
<polygon fill="#d94e8f" stroke="#d94e8f" points="709.5,-950 622.5,-950 622.5,-926 709.5,-926 709.5,-950"/>
<text text-anchor="middle" x="666" y="-935.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_passive_grid</text>
</a>
</g>
</g>
<!-- proc~grid_intersect&#45;&gt;proc~in_passive_grid -->
<g id="proc~~ndmc~~CallsGraph_edge58" class="edge"><title>proc~grid_intersect&#45;&gt;proc~in_passive_grid</title>
<path fill="none" stroke="#000000" d="M551.763,-1008.12C561.203,-1005.07 571.154,-1001.35 580,-997 602.645,-985.853 626.038,-969.169 642.537,-956.384"/>
<polygon fill="#000000" stroke="#000000" points="644.813,-959.046 650.495,-950.103 640.477,-953.551 644.813,-959.046"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_edge60" class="edge"><title>proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M777.828,-556.014C770.784,-564.972 777.508,-574 798,-574 810.487,-574 817.862,-570.647 820.124,-566.001"/>
<polygon fill="#000000" stroke="#000000" points="823.526,-565.157 818.172,-556.014 816.656,-566.5 823.526,-565.157"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge59" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M824.78,-531.949C831.496,-528.08 838.409,-523.38 844,-518 873.982,-489.149 897.277,-445.989 909.505,-420.347"/>
<polygon fill="#000000" stroke="#000000" points="912.745,-421.68 913.779,-411.136 906.395,-418.734 912.745,-421.68"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge61" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M696.587,-1135.77C703.195,-1138.69 710.013,-1142.13 716,-1146 734.233,-1157.78 734.499,-1166.16 752,-1179 756.167,-1182.06 760.723,-1185.05 765.284,-1187.85"/>
<polygon fill="#000000" stroke="#000000" points="763.57,-1190.9 773.961,-1192.97 767.128,-1184.87 763.57,-1190.9"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~ndmc~~CallsGraph_node57" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~ndmc~~CallsGraph_node57"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="836.5,-1137 759.5,-1137 759.5,-1113 836.5,-1113 836.5,-1137"/>
<text text-anchor="middle" x="798" y="-1122.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~ndmc~~CallsGraph_edge62" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M696.825,-1125C712.365,-1125 731.744,-1125 749.306,-1125"/>
<polygon fill="#000000" stroke="#000000" points="749.393,-1128.5 759.393,-1125 749.393,-1121.5 749.393,-1128.5"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_node61" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~ndmc~~CallsGraph_node61"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="952.5,-1226 887.5,-1226 887.5,-1202 952.5,-1202 952.5,-1226"/>
<text text-anchor="middle" x="920" y="-1211.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge63" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M696.623,-1134.29C731.925,-1145.49 792.599,-1165.17 844,-1184 855.934,-1188.37 868.817,-1193.41 880.482,-1198.09"/>
<polygon fill="#000000" stroke="#000000" points="879.364,-1201.41 889.947,-1201.92 881.989,-1194.92 879.364,-1201.41"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge64" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M824.807,-264.023C831.522,-267.892 838.429,-272.599 844,-278 874.234,-307.312 897.445,-351.205 909.59,-377.286"/>
<polygon fill="#000000" stroke="#000000" points="906.518,-378.989 913.831,-386.655 912.895,-376.102 906.518,-378.989"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_edge66" class="edge"><title>proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M706.004,-571.999C719.124,-567.962 733.935,-563.404 747.739,-559.157"/>
<polygon fill="#000000" stroke="#000000" points="749.045,-562.417 757.574,-556.131 746.987,-555.727 749.045,-562.417"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge65" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M709.118,-596.037C747.617,-604.389 804.419,-609.772 844,-583 898.587,-546.078 913.47,-461.795 917.508,-421.399"/>
<polygon fill="#000000" stroke="#000000" points="921.011,-421.508 918.383,-411.244 914.037,-420.907 921.011,-421.508"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_fields -->
<g id="proc~~ndmc~~CallsGraph_edge70" class="edge"><title>proc~store_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M362.169,-1172.1C392.203,-1190.12 448.824,-1224.09 483.207,-1244.72"/>
<polygon fill="#000000" stroke="#000000" points="481.482,-1247.77 491.857,-1249.91 485.083,-1241.77 481.482,-1247.77"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge68" class="edge"><title>proc~store_photons&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M370.276,-1172.07C383.716,-1178.95 399.171,-1188.68 410,-1201 436.273,-1230.9 414.213,-1259.05 446,-1283 512.725,-1333.28 771.699,-1317.59 875.555,-1308.98"/>
<polygon fill="#000000" stroke="#000000" points="876.023,-1312.46 885.693,-1308.13 875.433,-1305.48 876.023,-1312.46"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_indices -->
<g id="proc~~ndmc~~CallsGraph_edge71" class="edge"><title>proc~store_photons&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M381.857,-1165.16C408.022,-1168.54 442.226,-1172.97 469.002,-1176.44"/>
<polygon fill="#000000" stroke="#000000" points="468.87,-1179.95 479.236,-1177.76 469.768,-1173.01 468.87,-1179.95"/>
</g>
<!-- proc~get_passive_grid_indices -->
<g id="proc~~ndmc~~CallsGraph_node45" class="node"><title>proc~get_passive_grid_indices</title>
<g id="a_proc~~ndmc~~CallsGraph_node45"><a xlink:href=".././proc/get_passive_grid_indices.html" xlink:title="get_passive_grid_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="579.5,-1152 446.5,-1152 446.5,-1128 579.5,-1128 579.5,-1152"/>
<text text-anchor="middle" x="513" y="-1137.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_passive_grid_indices</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_passive_grid_indices -->
<g id="proc~~ndmc~~CallsGraph_edge67" class="edge"><title>proc~store_photons&#45;&gt;proc~get_passive_grid_indices</title>
<path fill="none" stroke="#000000" d="M381.857,-1155.31C398.162,-1153.39 417.589,-1151.11 436.395,-1148.89"/>
<polygon fill="#000000" stroke="#000000" points="436.93,-1152.36 446.452,-1147.71 436.112,-1145.4 436.93,-1152.36"/>
</g>
<!-- proc~spectrum -->
<g id="proc~~ndmc~~CallsGraph_node56" class="node"><title>proc~spectrum</title>
<g id="a_proc~~ndmc~~CallsGraph_node56"><a xlink:href=".././proc/spectrum.html" xlink:title="spectrum">
<polygon fill="#d9534f" stroke="#d9534f" points="541.5,-1110 484.5,-1110 484.5,-1086 541.5,-1086 541.5,-1110"/>
<text text-anchor="middle" x="513" y="-1095.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spectrum</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~spectrum -->
<g id="proc~~ndmc~~CallsGraph_edge69" class="edge"><title>proc~store_photons&#45;&gt;proc~spectrum</title>
<path fill="none" stroke="#000000" d="M370.94,-1147.98C391.697,-1139.52 420.4,-1128.11 446,-1119 455.152,-1115.74 465.099,-1112.45 474.43,-1109.47"/>
<polygon fill="#000000" stroke="#000000" points="475.761,-1112.72 484.245,-1106.37 473.655,-1106.05 475.761,-1112.72"/>
</g>
<!-- dgetrs -->
<g id="proc~~ndmc~~CallsGraph_node43" class="node"><title>dgetrs</title>
<polygon fill="#777777" stroke="#777777" points="540,-108 486,-108 486,-84 540,-84 540,-108"/>
<text text-anchor="middle" x="513" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrs</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrs -->
<g id="proc~~ndmc~~CallsGraph_edge74" class="edge"><title>proc~linsolve&#45;&gt;dgetrs</title>
<path fill="none" stroke="#000000" d="M368.19,-96C396.892,-96 443.14,-96 475.416,-96"/>
<polygon fill="#000000" stroke="#000000" points="475.78,-99.5001 485.78,-96 475.78,-92.5001 475.78,-99.5001"/>
</g>
<!-- proc~matinv -->
<g id="proc~~ndmc~~CallsGraph_node50" class="node"><title>proc~matinv</title>
<g id="a_proc~~ndmc~~CallsGraph_node50"><a xlink:href=".././proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-66 486,-66 486,-42 540,-42 540,-66"/>
<text text-anchor="middle" x="513" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~linsolve&#45;&gt;proc~matinv -->
<g id="proc~~ndmc~~CallsGraph_edge72" class="edge"><title>proc~linsolve&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M368.19,-89.5295C397.016,-82.4077 443.543,-70.913 475.836,-62.9346"/>
<polygon fill="#000000" stroke="#000000" points="476.912,-66.2742 485.78,-60.4778 475.233,-59.4785 476.912,-66.2742"/>
</g>
<!-- dgetrf -->
<g id="proc~~ndmc~~CallsGraph_node60" class="node"><title>dgetrf</title>
<polygon fill="#777777" stroke="#777777" points="540,-24 486,-24 486,-0 540,-0 540,-24"/>
<text text-anchor="middle" x="513" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrf</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrf -->
<g id="proc~~ndmc~~CallsGraph_edge73" class="edge"><title>proc~linsolve&#45;&gt;dgetrf</title>
<path fill="none" stroke="#000000" d="M368.031,-91.5612C381.364,-88.4287 397.398,-83.2716 410,-75 430.553,-61.5091 425.504,-46.5784 446,-33 454.947,-27.0729 465.677,-22.7262 475.86,-19.5782"/>
<polygon fill="#000000" stroke="#000000" points="477.081,-22.8715 485.774,-16.8157 475.202,-16.1284 477.081,-22.8715"/>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge75" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M832.284,-222.122C836.557,-224.616 840.615,-227.558 844,-231 885.226,-272.922 905.942,-341.418 914.329,-376.597"/>
<polygon fill="#000000" stroke="#000000" points="911.01,-377.79 916.629,-386.772 917.838,-376.246 911.01,-377.79"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~ndmc~~CallsGraph_edge77" class="edge"><title>proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M706.004,-516.001C719.124,-520.038 733.935,-524.596 747.739,-528.843"/>
<polygon fill="#000000" stroke="#000000" points="746.987,-532.273 757.574,-531.869 749.045,-525.583 746.987,-532.273"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge76" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M710.187,-494.687C746.883,-485.877 800.391,-470.885 844,-450 862.464,-441.157 881.518,-428.142 895.801,-417.473"/>
<polygon fill="#000000" stroke="#000000" points="898.204,-420.041 904.029,-411.191 893.957,-414.477 898.204,-420.041"/>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;interface~parallel_sum -->
<g id="proc~~ndmc~~CallsGraph_edge81" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M386.413,-643.896C394.809,-640.307 403.109,-635.748 410,-630 458.681,-589.397 490.424,-519.248 504.175,-483.821"/>
<polygon fill="#000000" stroke="#000000" points="507.62,-484.604 507.864,-474.012 501.068,-482.14 507.62,-484.604"/>
</g>
<!-- proc~my_rank -->
<g id="proc~~ndmc~~CallsGraph_node46" class="node"><title>proc~my_rank</title>
<g id="a_proc~~ndmc~~CallsGraph_node46"><a xlink:href=".././proc/my_rank.html" xlink:title="my_rank">
<polygon fill="#d94e8f" stroke="#d94e8f" points="540,-672 486,-672 486,-648 540,-648 540,-672"/>
<text text-anchor="middle" x="513" y="-657.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">my_rank</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~my_rank -->
<g id="proc~~ndmc~~CallsGraph_edge78" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~my_rank</title>
<path fill="none" stroke="#000000" d="M409.677,-657.592C432.177,-658.122 456.368,-658.691 475.577,-659.143"/>
<polygon fill="#000000" stroke="#000000" points="475.614,-662.645 485.694,-659.381 475.779,-655.647 475.614,-662.645"/>
</g>
<!-- proc~num_ranks -->
<g id="proc~~ndmc~~CallsGraph_node48" class="node"><title>proc~num_ranks</title>
<g id="a_proc~~ndmc~~CallsGraph_node48"><a xlink:href=".././proc/num_ranks.html" xlink:title="num_ranks">
<polygon fill="#d94e8f" stroke="#d94e8f" points="546,-714 480,-714 480,-690 546,-690 546,-714"/>
<text text-anchor="middle" x="513" y="-699.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">num_ranks</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~num_ranks -->
<g id="proc~~ndmc~~CallsGraph_edge79" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~num_ranks</title>
<path fill="none" stroke="#000000" d="M386.665,-668.086C412.546,-675.089 444.921,-683.849 470.283,-690.712"/>
<polygon fill="#000000" stroke="#000000" points="469.414,-694.102 479.981,-693.336 471.242,-687.345 469.414,-694.102"/>
</g>
<!-- proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_node49" class="node"><title>proc~init_reservoir</title>
<g id="a_proc~~ndmc~~CallsGraph_node49"><a xlink:href=".././proc/init_reservoir.html" xlink:title="init_reservoir">
<polygon fill="#d9534f" stroke="#d9534f" points="835,-752 761,-752 761,-728 835,-728 835,-752"/>
<text text-anchor="middle" x="798" y="-737.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_reservoir</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge80" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M393.348,-668.102C399.218,-670.559 404.912,-673.496 410,-677 431.38,-691.726 422.944,-711.068 446,-723 544.767,-774.115 680.843,-761.056 751.019,-749.298"/>
<polygon fill="#000000" stroke="#000000" points="751.631,-752.744 760.883,-747.58 750.43,-745.848 751.631,-752.744"/>
</g>
<!-- proc~merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_node54" class="node"><title>proc~merge_reservoirs</title>
<g id="a_proc~~ndmc~~CallsGraph_node54"><a xlink:href=".././proc/merge_reservoirs.html" xlink:title="merge_reservoirs">
<polygon fill="#d9534f" stroke="#d9534f" points="561.5,-630 464.5,-630 464.5,-606 561.5,-606 561.5,-630"/>
<text text-anchor="middle" x="513" y="-615.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">merge_reservoirs</text>
</a>
</g>
</g>
<!-- proc~parallel_merge_reservoirs&#45;&gt;proc~merge_reservoirs -->
<g id="proc~~ndmc~~CallsGraph_edge82" class="edge"><title>proc~parallel_merge_reservoirs&#45;&gt;proc~merge_reservoirs</title>
<path fill="none" stroke="#000000" d="M395.789,-643.977C414.424,-639.811 435.383,-635.126 454.318,-630.894"/>
<polygon fill="#000000" stroke="#000000" points="455.311,-634.258 464.306,-628.661 453.784,-627.427 455.311,-634.258"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~ndmc~~CallsGraph_node51" class="node"><title>proc~elmhes</title>
<g id="a_proc~~ndmc~~CallsGraph_node51"><a xlink:href=".././proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-192 486,-192 486,-168 540,-168 540,-192"/>
<text text-anchor="middle" x="513" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~ndmc~~CallsGraph_edge83" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M368.289,-231.74C389.189,-222.945 419.255,-210.64 446,-201 455.655,-197.52 466.208,-194.026 475.988,-190.915"/>
<polygon fill="#000000" stroke="#000000" points="477.335,-194.16 485.829,-187.827 475.24,-187.481 477.335,-194.16"/>
</g>
<!-- proc~balance -->
<g id="proc~~ndmc~~CallsGraph_node52" class="node"><title>proc~balance</title>
<g id="a_proc~~ndmc~~CallsGraph_node52"><a xlink:href=".././proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-318 486,-318 486,-294 540,-294 540,-318"/>
<text text-anchor="middle" x="513" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~ndmc~~CallsGraph_edge84" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M368.289,-254.26C389.189,-263.055 419.255,-275.36 446,-285 455.655,-288.48 466.208,-291.974 475.988,-295.085"/>
<polygon fill="#000000" stroke="#000000" points="475.24,-298.519 485.829,-298.173 477.335,-291.84 475.24,-298.519"/>
</g>
<!-- proc~balback -->
<g id="proc~~ndmc~~CallsGraph_node53" class="node"><title>proc~balback</title>
<g id="a_proc~~ndmc~~CallsGraph_node53"><a xlink:href=".././proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-276 486,-276 486,-252 540,-252 540,-276"/>
<text text-anchor="middle" x="513" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~ndmc~~CallsGraph_edge85" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M368.19,-246.235C397.016,-249.796 443.543,-255.544 475.836,-259.533"/>
<polygon fill="#000000" stroke="#000000" points="475.427,-263.009 485.78,-260.761 476.285,-256.061 475.427,-263.009"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~ndmc~~CallsGraph_node55" class="node"><title>proc~hqr2</title>
<g id="a_proc~~ndmc~~CallsGraph_node55"><a xlink:href=".././proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-150 486,-150 486,-126 540,-126 540,-150"/>
<text text-anchor="middle" x="513" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~ndmc~~CallsGraph_edge86" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M354.024,-230.721C372.336,-212.656 409.008,-178.909 446,-159 455.291,-154 465.967,-149.96 475.988,-146.81"/>
<polygon fill="#000000" stroke="#000000" points="477.105,-150.129 485.713,-143.953 475.132,-143.413 477.105,-150.129"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~ndmc~~CallsGraph_node62" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~ndmc~~CallsGraph_node62"><a xlink:href=".././proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-234 486,-234 486,-210 540,-210 540,-234"/>
<text text-anchor="middle" x="513" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~ndmc~~CallsGraph_edge87" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M368.19,-239.765C397.016,-236.204 443.543,-230.456 475.836,-226.467"/>
<polygon fill="#000000" stroke="#000000" points="476.285,-229.939 485.78,-225.239 475.427,-222.991 476.285,-229.939"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge89" class="edge"><title>proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M697.148,-310.037C703.463,-312.803 710.018,-315.86 716,-319 734.942,-328.943 755.316,-341.783 770.892,-352.092"/>
<polygon fill="#000000" stroke="#000000" points="769.205,-355.174 779.462,-357.828 773.098,-349.357 769.205,-355.174"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge88" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M711.675,-299.601C748.803,-302.47 802.134,-310.237 844,-331 867.465,-342.638 889.026,-363.769 902.948,-379.398"/>
<polygon fill="#000000" stroke="#000000" points="900.318,-381.707 909.502,-386.989 905.617,-377.133 900.318,-381.707"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_node58" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~ndmc~~CallsGraph_node58"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="829,-1297 767,-1297 767,-1273 829,-1273 829,-1297"/>
<text text-anchor="middle" x="798" y="-1282.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge90" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M701.156,-1285C718.135,-1285 738.77,-1285 756.537,-1285"/>
<polygon fill="#000000" stroke="#000000" points="756.618,-1288.5 766.618,-1285 756.618,-1281.5 756.618,-1288.5"/>
</g>
<!-- proc~update_reservoir -->
<g id="proc~~ndmc~~CallsGraph_node47" class="node"><title>proc~update_reservoir</title>
<g id="a_proc~~ndmc~~CallsGraph_node47"><a xlink:href=".././proc/update_reservoir.html" xlink:title="update_reservoir">
<polygon fill="#d9534f" stroke="#d9534f" points="713,-794 619,-794 619,-770 713,-770 713,-794"/>
<text text-anchor="middle" x="666" y="-779.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_reservoir</text>
</a>
</g>
</g>
<!-- proc~update_neutrals&#45;&gt;proc~update_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge91" class="edge"><title>proc~update_neutrals&#45;&gt;proc~update_reservoir</title>
<path fill="none" stroke="#000000" d="M386.235,-782C444.09,-782 545.508,-782 608.76,-782"/>
<polygon fill="#000000" stroke="#000000" points="608.955,-785.5 618.955,-782 608.955,-778.5 608.955,-785.5"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~ndmc~~CallsGraph_edge93" class="edge"><title>proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M699.109,-449.968C704.897,-447.32 710.754,-444.306 716,-441 739.307,-426.313 762.614,-405.017 778.202,-389.582"/>
<polygon fill="#000000" stroke="#000000" points="781.054,-391.677 785.609,-382.112 776.083,-386.749 781.054,-391.677"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~ndmc~~CallsGraph_edge92" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M711.798,-454.74C747.839,-448.458 799.612,-438.433 844,-426 855.544,-422.767 867.863,-418.63 879.11,-414.571"/>
<polygon fill="#000000" stroke="#000000" points="880.498,-417.79 888.673,-411.05 878.079,-411.221 880.498,-417.79"/>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~ndmc~~CallsGraph_edge94" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M385.003,-707.268C393.688,-710.22 402.458,-714.053 410,-719 439.386,-738.274 591.562,-933.745 616,-959 670.35,-1015.17 739.666,-1076.01 774.651,-1106.03"/>
<polygon fill="#000000" stroke="#000000" points="772.503,-1108.8 782.378,-1112.64 777.053,-1103.48 772.503,-1108.8"/>
</g>
<!-- proc~uvw_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_node63" class="node"><title>proc~uvw_to_cyl</title>
<g id="a_proc~~ndmc~~CallsGraph_node63"><a xlink:href=".././proc/uvw_to_cyl.html" xlink:title="uvw_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="830.5,-1065 765.5,-1065 765.5,-1041 830.5,-1041 830.5,-1065"/>
<text text-anchor="middle" x="798" y="-1050.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_cyl</text>
</a>
</g>
</g>
<!-- proc~in_passive_grid&#45;&gt;proc~uvw_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_edge95" class="edge"><title>proc~in_passive_grid&#45;&gt;proc~uvw_to_cyl</title>
<path fill="none" stroke="#000000" d="M693.707,-950.048C701.244,-954 709.23,-958.744 716,-964 723.191,-969.583 758.138,-1008.82 779.712,-1033.3"/>
<polygon fill="#000000" stroke="#000000" points="777.223,-1035.77 786.457,-1040.96 782.478,-1031.14 777.223,-1035.77"/>
</g>
<!-- proc~approx_ge -->
<g id="proc~~ndmc~~CallsGraph_node64" class="node"><title>proc~approx_ge</title>
<g id="a_proc~~ndmc~~CallsGraph_node64"><a xlink:href=".././proc/approx_ge.html" xlink:title="approx_ge">
<polygon fill="#d94e8f" stroke="#d94e8f" points="830,-950 766,-950 766,-926 830,-926 830,-950"/>
<text text-anchor="middle" x="798" y="-935.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_ge</text>
</a>
</g>
</g>
<!-- proc~in_passive_grid&#45;&gt;proc~approx_ge -->
<g id="proc~~ndmc~~CallsGraph_edge96" class="edge"><title>proc~in_passive_grid&#45;&gt;proc~approx_ge</title>
<path fill="none" stroke="#000000" d="M709.567,-938C724.344,-938 740.885,-938 755.57,-938"/>
<polygon fill="#000000" stroke="#000000" points="755.882,-941.5 765.882,-938 755.882,-934.5 755.882,-941.5"/>
</g>
<!-- proc~approx_le -->
<g id="proc~~ndmc~~CallsGraph_node68" class="node"><title>proc~approx_le</title>
<g id="a_proc~~ndmc~~CallsGraph_node68"><a xlink:href=".././proc/approx_le.html" xlink:title="approx_le">
<polygon fill="#d94e8f" stroke="#d94e8f" points="828,-992 768,-992 768,-968 828,-968 828,-992"/>
<text text-anchor="middle" x="798" y="-977.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_le</text>
</a>
</g>
</g>
<!-- proc~in_passive_grid&#45;&gt;proc~approx_le -->
<g id="proc~~ndmc~~CallsGraph_edge97" class="edge"><title>proc~in_passive_grid&#45;&gt;proc~approx_le</title>
<path fill="none" stroke="#000000" d="M704.253,-950.036C721.062,-955.466 740.918,-961.881 757.937,-967.38"/>
<polygon fill="#000000" stroke="#000000" points="756.993,-970.753 767.585,-970.497 759.145,-964.092 756.993,-970.753"/>
</g>
<!-- proc~xyz_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_node65" class="node"><title>proc~xyz_to_cyl</title>
<g id="a_proc~~ndmc~~CallsGraph_node65"><a xlink:href=".././proc/xyz_to_cyl.html" xlink:title="xyz_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="697,-1095 635,-1095 635,-1071 697,-1071 697,-1095"/>
<text text-anchor="middle" x="666" y="-1080.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_cyl</text>
</a>
</g>
</g>
<!-- proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_edge98" class="edge"><title>proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl</title>
<path fill="none" stroke="#000000" d="M553.99,-1127.93C562.619,-1125.14 571.655,-1122.09 580,-1119 584.92,-1117.18 607.046,-1107.8 627.489,-1099.08"/>
<polygon fill="#000000" stroke="#000000" points="628.875,-1102.29 636.695,-1095.14 626.124,-1095.85 628.875,-1102.29"/>
</g>
<!-- proc~update_reservoir&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge99" class="edge"><title>proc~update_reservoir&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M713.221,-781.633C762.024,-781.246 837.953,-780.643 882.652,-780.288"/>
<polygon fill="#000000" stroke="#000000" points="882.799,-783.788 892.771,-780.208 882.743,-776.788 882.799,-783.788"/>
</g>
<!-- proc~update_reservoir&#45;&gt;interface~randind -->
<g id="proc~~ndmc~~CallsGraph_edge101" class="edge"><title>proc~update_reservoir&#45;&gt;interface~randind</title>
<path fill="none" stroke="#000000" d="M708.133,-794.023C725.135,-798.993 744.667,-804.703 761.082,-809.501"/>
<polygon fill="#000000" stroke="#000000" points="760.269,-812.91 770.849,-812.356 762.233,-806.191 760.269,-812.91"/>
</g>
<!-- proc~update_reservoir&#45;&gt;proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge100" class="edge"><title>proc~update_reservoir&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M704.253,-769.964C718.778,-765.272 735.579,-759.844 750.858,-754.908"/>
<polygon fill="#000000" stroke="#000000" points="752.2,-758.152 760.639,-751.747 750.047,-751.491 752.2,-758.152"/>
</g>
<!-- proc~init_reservoir&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge102" class="edge"><title>proc~init_reservoir&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M835.004,-752.001C850.294,-757.098 868.074,-763.025 883.328,-768.109"/>
<polygon fill="#000000" stroke="#000000" points="882.343,-771.47 892.936,-771.312 884.556,-764.829 882.343,-771.47"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~ndmc~~CallsGraph_node70" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~ndmc~~CallsGraph_node70"><a xlink:href=".././proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="693,-87 639,-87 639,-63 693,-63 693,-87"/>
<text text-anchor="middle" x="666" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~ndmc~~CallsGraph_edge104" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M540.302,-57.6579C564.878,-61.0757 601.771,-66.2065 629.057,-70.0014"/>
<polygon fill="#000000" stroke="#000000" points="628.612,-73.4731 638.999,-71.384 629.577,-66.5398 628.612,-73.4731"/>
</g>
<!-- proc~lubksb -->
<g id="proc~~ndmc~~CallsGraph_node71" class="node"><title>proc~lubksb</title>
<g id="a_proc~~ndmc~~CallsGraph_node71"><a xlink:href=".././proc/lubksb.html" xlink:title="lubksb">
<polygon fill="#d9534f" stroke="#d9534f" points="693,-45 639,-45 639,-21 693,-21 693,-45"/>
<text text-anchor="middle" x="666" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lubksb</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~lubksb -->
<g id="proc~~ndmc~~CallsGraph_edge103" class="edge"><title>proc~matinv&#45;&gt;proc~lubksb</title>
<path fill="none" stroke="#000000" d="M540.302,-50.3421C564.878,-46.9243 601.771,-41.7935 629.057,-37.9986"/>
<polygon fill="#000000" stroke="#000000" points="629.577,-41.4602 638.999,-36.616 628.612,-34.5269 629.577,-41.4602"/>
</g>
<!-- proc~rswap -->
<g id="proc~~ndmc~~CallsGraph_node69" class="node"><title>proc~rswap</title>
<g id="a_proc~~ndmc~~CallsGraph_node69"><a xlink:href=".././proc/rswap.html" xlink:title="RSWAP">
<polygon fill="#d9534f" stroke="#d9534f" points="693,-192 639,-192 639,-168 693,-168 693,-192"/>
<text text-anchor="middle" x="666" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RSWAP</text>
</a>
</g>
</g>
<!-- proc~elmhes&#45;&gt;proc~rswap -->
<g id="proc~~ndmc~~CallsGraph_edge105" class="edge"><title>proc~elmhes&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M540.302,-180C564.769,-180 601.446,-180 628.696,-180"/>
<polygon fill="#000000" stroke="#000000" points="628.999,-183.5 638.999,-180 628.999,-176.5 628.999,-183.5"/>
</g>
<!-- proc~balance&#45;&gt;proc~rswap -->
<g id="proc~~ndmc~~CallsGraph_edge106" class="edge"><title>proc~balance&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M540.298,-302.764C553.522,-299.961 569.026,-294.735 580,-285 608.865,-259.395 589.551,-234.093 616,-206 620.06,-201.688 624.997,-197.947 630.156,-194.752"/>
<polygon fill="#000000" stroke="#000000" points="631.883,-197.796 638.931,-189.885 628.488,-191.675 631.883,-197.796"/>
</g>
<!-- proc~balback&#45;&gt;proc~rswap -->
<g id="proc~~ndmc~~CallsGraph_edge107" class="edge"><title>proc~balback&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M540.017,-258.858C552.711,-255.589 567.828,-250.523 580,-243 599.517,-230.938 597.644,-219.766 616,-206 620.382,-202.714 625.235,-199.604 630.135,-196.756"/>
<polygon fill="#000000" stroke="#000000" points="631.836,-199.814 638.91,-191.927 628.462,-193.681 631.836,-199.814"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;interface~randu -->
<g id="proc~~ndmc~~CallsGraph_edge108" class="edge"><title>proc~merge_reservoirs&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M561.833,-616.956C603.608,-617.441 665.318,-621.578 716,-639 791.887,-665.086 865.23,-728.302 899.25,-760.481"/>
<polygon fill="#000000" stroke="#000000" points="897.016,-763.188 906.655,-767.587 901.863,-758.138 897.016,-763.188"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;proc~update_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge111" class="edge"><title>proc~merge_reservoirs&#45;&gt;proc~update_reservoir</title>
<path fill="none" stroke="#000000" d="M561.766,-627.698C568.409,-630.547 574.747,-634.232 580,-639 610.077,-666.297 594.805,-688.351 616,-723 624.526,-736.939 636.138,-751.072 645.918,-762.01"/>
<polygon fill="#000000" stroke="#000000" points="643.622,-764.686 652.958,-769.695 648.784,-759.957 643.622,-764.686"/>
</g>
<!-- proc~merge_reservoirs&#45;&gt;proc~init_reservoir -->
<g id="proc~~ndmc~~CallsGraph_edge109" class="edge"><title>proc~merge_reservoirs&#45;&gt;proc~init_reservoir</title>
<path fill="none" stroke="#000000" d="M561.813,-628.225C603.848,-638.293 665.95,-655.832 716,-681 737.639,-691.881 759.698,-708.376 775.32,-721.161"/>
<polygon fill="#000000" stroke="#000000" points="773.375,-724.097 783.293,-727.823 777.863,-718.726 773.375,-724.097"/>
</g>
<!-- float -->
<g id="proc~~ndmc~~CallsGraph_node66" class="node"><title>float</title>
<polygon fill="#777777" stroke="#777777" points="693,-714 639,-714 639,-690 693,-690 693,-714"/>
<text text-anchor="middle" x="666" y="-699.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">float</text>
</g>
<!-- proc~merge_reservoirs&#45;&gt;float -->
<g id="proc~~ndmc~~CallsGraph_edge110" class="edge"><title>proc~merge_reservoirs&#45;&gt;float</title>
<path fill="none" stroke="#000000" d="M561.766,-630.078C568.119,-632.571 574.374,-635.523 580,-639 599.517,-651.062 597.644,-662.234 616,-676 620.382,-679.286 625.235,-682.396 630.135,-685.244"/>
<polygon fill="#000000" stroke="#000000" points="628.462,-688.319 638.91,-690.073 631.836,-682.186 628.462,-688.319"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~ndmc~~CallsGraph_node67" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~ndmc~~CallsGraph_node67"><a xlink:href=".././proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="693,-150 639,-150 639,-126 693,-126 693,-150"/>
<text text-anchor="middle" x="666" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~ndmc~~CallsGraph_edge112" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M540.302,-138C564.769,-138 601.446,-138 628.696,-138"/>
<polygon fill="#000000" stroke="#000000" points="628.999,-141.5 638.999,-138 628.999,-134.5 628.999,-141.5"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~ndmc~~CallsGraph_edge113" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M829.281,-1290.05C843.272,-1292.38 860.146,-1295.19 875.468,-1297.74"/>
<polygon fill="#000000" stroke="#000000" points="875.333,-1301.27 885.772,-1299.46 876.484,-1294.37 875.333,-1301.27"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge114" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M819.356,-1272.96C838.665,-1261.53 867.887,-1244.24 889.7,-1231.34"/>
<polygon fill="#000000" stroke="#000000" points="891.72,-1234.21 898.544,-1226.1 888.155,-1228.18 891.72,-1234.21"/>
</g>
<!-- proc~approx_eq -->
<g id="proc~~ndmc~~CallsGraph_node75" class="node"><title>proc~approx_eq</title>
<g id="a_proc~~ndmc~~CallsGraph_node75"><a xlink:href=".././proc/approx_eq.html" xlink:title="approx_eq">
<polygon fill="#d94e8f" stroke="#d94e8f" points="952,-971 888,-971 888,-947 952,-947 952,-971"/>
<text text-anchor="middle" x="920" y="-956.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_eq</text>
</a>
</g>
</g>
<!-- proc~approx_ge&#45;&gt;proc~approx_eq -->
<g id="proc~~ndmc~~CallsGraph_edge115" class="edge"><title>proc~approx_ge&#45;&gt;proc~approx_eq</title>
<path fill="none" stroke="#000000" d="M830.215,-943.463C844.799,-946.015 862.355,-949.087 877.993,-951.824"/>
<polygon fill="#000000" stroke="#000000" points="877.487,-955.288 887.941,-953.565 878.694,-948.393 877.487,-955.288"/>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~ndmc~~CallsGraph_edge117" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M697.046,-1093.12C703.632,-1096.07 710.326,-1099.69 716,-1104 723.993,-1110.07 760.282,-1156.86 781.478,-1184.58"/>
<polygon fill="#000000" stroke="#000000" points="778.926,-1187.01 787.775,-1192.83 784.491,-1182.76 778.926,-1187.01"/>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl -->
<g id="proc~~ndmc~~CallsGraph_edge116" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl</title>
<path fill="none" stroke="#000000" d="M697.151,-1076.04C714.445,-1072.05 736.411,-1066.98 755.335,-1062.62"/>
<polygon fill="#000000" stroke="#000000" points="756.242,-1066 765.198,-1060.34 754.667,-1059.18 756.242,-1066"/>
</g>
<!-- proc~comdiv -->
<g id="proc~~ndmc~~CallsGraph_node73" class="node"><title>proc~comdiv</title>
<g id="a_proc~~ndmc~~CallsGraph_node73"><a xlink:href=".././proc/comdiv.html" xlink:title="Comdiv">
<polygon fill="#d9534f" stroke="#d9534f" points="825,-150 771,-150 771,-126 825,-126 825,-150"/>
<text text-anchor="middle" x="798" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Comdiv</text>
</a>
</g>
</g>
<!-- proc~hqrvec&#45;&gt;proc~comdiv -->
<g id="proc~~ndmc~~CallsGraph_edge118" class="edge"><title>proc~hqrvec&#45;&gt;proc~comdiv</title>
<path fill="none" stroke="#000000" d="M693.307,-138C712.69,-138 739.29,-138 760.695,-138"/>
<polygon fill="#000000" stroke="#000000" points="760.732,-141.5 770.732,-138 760.732,-134.5 760.732,-141.5"/>
</g>
<!-- proc~approx_le&#45;&gt;proc~approx_eq -->
<g id="proc~~ndmc~~CallsGraph_edge119" class="edge"><title>proc~approx_le&#45;&gt;proc~approx_eq</title>
<path fill="none" stroke="#000000" d="M828.049,-974.916C842.984,-972.303 861.442,-969.073 877.819,-966.207"/>
<polygon fill="#000000" stroke="#000000" points="878.45,-969.65 887.697,-964.478 877.243,-962.754 878.45,-969.65"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~ndmc~~CallsGraph_node72" class="node"><title>proc~outerprod</title>
<g id="a_proc~~ndmc~~CallsGraph_node72"><a xlink:href=".././proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="827.5,-55 768.5,-55 768.5,-31 827.5,-31 827.5,-55"/>
<text text-anchor="middle" x="798" y="-40.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~ndmc~~CallsGraph_edge120" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M693.307,-68.5243C712.053,-63.9101 737.548,-57.6344 758.566,-52.4606"/>
<polygon fill="#000000" stroke="#000000" points="759.602,-55.8101 768.476,-50.0213 757.929,-49.013 759.602,-55.8101"/>
</g>
<!-- proc~swap -->
<g id="proc~~ndmc~~CallsGraph_node74" class="node"><title>proc~swap</title>
<g id="a_proc~~ndmc~~CallsGraph_node74"><a xlink:href=".././proc/swap.html" xlink:title="swap">
<polygon fill="#d9534f" stroke="#d9534f" points="825,-97 771,-97 771,-73 825,-73 825,-97"/>
<text text-anchor="middle" x="798" y="-82.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swap</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~swap -->
<g id="proc~~ndmc~~CallsGraph_edge121" class="edge"><title>proc~ludcmp&#45;&gt;proc~swap</title>
<path fill="none" stroke="#000000" d="M693.307,-77.0236C712.69,-78.5146 739.29,-80.5608 760.695,-82.2073"/>
<polygon fill="#000000" stroke="#000000" points="760.493,-85.702 770.732,-82.9794 761.03,-78.7226 760.493,-85.702"/>
</g>
</g>
</svg>
</div><script>var panprocndmcCallsGraph = svgPanZoom('#procndmcCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~ndmc~~CalledByGraph Pages: 1 -->
<svg id="procndmcCalledByGraph" width="152pt" height="32pt"
 viewBox="0.00 0.00 152.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~ndmc~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~ndmc~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 148,-28 148,4 -4,4"/>
<!-- proc~ndmc -->
<g id="proc~~ndmc~~CalledByGraph_node1" class="node"><title>proc~ndmc</title>
<polygon fill="none" stroke="black" points="144,-24 90,-24 90,-0 144,-0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">ndmc</text>
</g>
<!-- program~fidasim -->
<g id="proc~~ndmc~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~ndmc~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~ndmc -->
<g id="proc~~ndmc~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~ndmc</title>
<path fill="none" stroke="#000000" d="M54.4029,-12C62.3932,-12 71.3106,-12 79.8241,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.919,-15.5001 89.919,-12 79.919,-8.5001 79.919,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/ndmc.html#src">ndmc</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">ndmc</span>
    <span class="c">!+ Calculates neutral beam deposition and spectra</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">neut_type</span> <span class="c">!! full half third energy</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">nlaunch</span>   <span class="c">!! nr. of markers</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">nneutrals</span> <span class="c">!! # NBI particles</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vnbi</span> <span class="c">!! velocities(full..)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rnbi</span> <span class="c">!! initial position</span>

    <span class="kt">integer</span><span class="p">(</span><span class="n">Int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">jj</span><span class="p">,</span> <span class="n">ii</span><span class="p">,</span> <span class="n">kk</span><span class="p">,</span> <span class="n">cnt</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ntrack</span><span class="p">,</span> <span class="n">ic</span>
    <span class="k">type</span><span class="p">(</span><span class="n">ParticleTrack</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ntrack</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tracks</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span> <span class="kd">::</span> <span class="n">plasma</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fields</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">states</span><span class="p">,</span> <span class="n">dens</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">photons</span><span class="p">,</span> <span class="n">iflux</span><span class="p">,</span><span class="n">flux_tot</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ind</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ri</span><span class="p">,</span><span class="n">ri_gc</span><span class="p">,</span><span class="n">r_gyro</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">randomu</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">randi</span>
    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">err</span>

    <span class="c">!! Initialize Neutral Population</span>
    <span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">)</span>
    <span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">half</span><span class="p">)</span>
    <span class="k">call </span><span class="n">init_neutral_population</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">third</span><span class="p">)</span>

    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i10)&#39;</span><span class="p">)</span> <span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span>
        <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of birth markers: 3 x&quot;,i10)&#39;</span><span class="p">)</span> <span class="nb">int</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="o">*</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_birth</span><span class="p">)</span>
        <span class="k">endif</span>
<span class="k">    endif</span>

    <span class="c">!! # of injected neutrals = NBI power/energy_per_particle</span>
    <span class="n">nneutrals</span><span class="o">=</span><span class="mf">1.d6</span><span class="o">*</span><span class="n">nbi</span><span class="p">%</span><span class="n">pinj</span><span class="o">/</span> <span class="p">(</span><span class="mf">1.d3</span><span class="o">*</span><span class="n">nbi</span><span class="p">%</span><span class="n">einj</span><span class="o">*</span><span class="n">e0</span> <span class="p">&amp;</span>
         <span class="o">*</span><span class="p">(</span> <span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>      <span class="p">&amp;</span>
         <span class="o">+</span>  <span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.d0</span> <span class="p">&amp;</span>
         <span class="o">+</span>  <span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mf">3.d0</span> <span class="p">)</span> <span class="p">)</span>

    <span class="n">nlaunch</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="p">)</span>
    <span class="c">!$OMP PARALLEL DO schedule(guided) &amp;</span>
    <span class="c">!$OMP&amp; private(vnbi,rnbi,tracks,ntrack,plasma,fields,randi,flux_tot, &amp;</span>
    <span class="c">!$OMP&amp; states,dens,iflux,photons,neut_type,jj,ii,kk,ind,err,ri,ri_gc,r_gyro)</span>
    <span class="n">loop_over_markers</span><span class="p">:</span> <span class="k">do </span><span class="n">ii</span><span class="o">=</span><span class="n">istart</span><span class="p">,</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="p">,</span><span class="n">istep</span>
        <span class="n">energy_fractions</span><span class="p">:</span> <span class="k">do </span><span class="n">neut_type</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
            <span class="c">!! (type = 1: full energy, =2: half energy, =3: third energy</span>
            <span class="k">if</span><span class="p">(</span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="n">neut_type</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">energy_fractions</span>

            <span class="k">call </span><span class="n">mc_nbi</span><span class="p">(</span><span class="n">vnbi</span><span class="p">,</span><span class="n">neut_type</span><span class="p">,</span><span class="n">rnbi</span><span class="p">,</span><span class="n">err</span><span class="p">)</span>
            <span class="k">if</span><span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="k">cycle </span><span class="n">energy_fractions</span>

            <span class="k">call </span><span class="n">track</span><span class="p">(</span><span class="n">rnbi</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">tracks</span><span class="p">,</span><span class="n">ntrack</span><span class="p">)</span>
            <span class="k">if</span><span class="p">(</span><span class="n">ntrack</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">energy_fractions</span>

            <span class="c">!! Solve collisional radiative model along track</span>
            <span class="n">flux_tot</span> <span class="o">=</span> <span class="mf">0.d0</span>
            <span class="n">states</span><span class="o">=</span><span class="mf">0.d0</span>
            <span class="n">states</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">nneutrals</span><span class="o">*</span><span class="n">nbi</span><span class="p">%</span><span class="n">current_fractions</span><span class="p">(</span><span class="n">neut_type</span><span class="p">)</span><span class="o">/</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span>
            <span class="n">loop_along_track</span><span class="p">:</span> <span class="k">do </span><span class="n">jj</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ntrack</span>
                <span class="n">iflux</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">)</span>
                <span class="n">ind</span> <span class="o">=</span> <span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">ind</span>
                <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">)</span>

                <span class="k">call </span><span class="n">colrad</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">beam_mass</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="nb">time</span><span class="p">,</span><span class="n">states</span><span class="p">,</span><span class="n">dens</span><span class="p">,</span><span class="n">photons</span><span class="p">)</span>
                <span class="n">dens</span> <span class="o">=</span> <span class="n">dens</span><span class="o">/</span><span class="n">nlaunch</span>
                <span class="k">call </span><span class="n">store_neutrals</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">neut_type</span><span class="p">,</span><span class="n">dens</span><span class="p">)</span>
                <span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">flux</span> <span class="o">=</span> <span class="p">(</span><span class="n">iflux</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">))</span><span class="o">/</span><span class="n">nlaunch</span>
                <span class="n">flux_tot</span> <span class="o">=</span> <span class="n">flux_tot</span> <span class="o">+</span> <span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">flux</span><span class="o">*</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span>

                <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                    call </span><span class="n">store_births</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">neut_type</span><span class="p">,</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">flux</span><span class="p">)</span>
                <span class="k">endif</span>

<span class="k">                if</span><span class="p">((</span><span class="n">photons</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_bes</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                    call </span><span class="n">store_nbi_photons</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span><span class="n">vnbi</span><span class="p">,</span><span class="n">beam_lambda0</span><span class="p">,</span> <span class="n">photons</span><span class="o">/</span><span class="n">nlaunch</span><span class="p">,</span><span class="n">neut_type</span><span class="p">)</span>
                <span class="k">endif</span>
<span class="k">            enddo </span><span class="n">loop_along_track</span>
            <span class="k">if</span><span class="p">((</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">flux_tot</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">))</span> <span class="k">then</span>
                <span class="c">!! Sample according to deposited flux along neutral trajectory</span>
                <span class="c">!$OMP CRITICAL(ndmc_birth)</span>
                <span class="k">do </span><span class="n">kk</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_birth</span>
                    <span class="k">call </span><span class="n">randind</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ntrack</span><span class="p">)%</span><span class="n">flux</span><span class="p">,</span><span class="n">randi</span><span class="p">)</span>
                    <span class="k">call </span><span class="n">randu</span><span class="p">(</span><span class="n">randomu</span><span class="p">)</span>
                    <span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">neut_type</span> <span class="o">=</span> <span class="n">neut_type</span>
                    <span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">energy</span> <span class="o">=</span> <span class="n">nbi</span><span class="p">%</span><span class="n">einj</span><span class="o">/</span><span class="kt">real</span><span class="p">(</span><span class="n">neut_type</span><span class="p">)</span>
                    <span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">weight</span> <span class="o">=</span> <span class="n">flux_tot</span><span class="o">/</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_birth</span>
                    <span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">ind</span> <span class="o">=</span> <span class="n">tracks</span><span class="p">(</span><span class="n">randi</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">ind</span>
                    <span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">vi</span> <span class="o">=</span> <span class="n">vnbi</span>
                    <span class="n">ri</span> <span class="o">=</span> <span class="n">tracks</span><span class="p">(</span><span class="n">randi</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">pos</span> <span class="o">+</span> <span class="n">vnbi</span><span class="o">*</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="n">randi</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="nb">time</span><span class="o">*</span><span class="p">(</span><span class="n">randomu</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
                    <span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">ri</span> <span class="o">=</span> <span class="n">ri</span>

                    <span class="k">call </span><span class="n">get_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">)</span>
                    <span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">pitch</span> <span class="o">=</span> <span class="nb">dot_product</span><span class="p">(</span><span class="n">fields</span><span class="p">%</span><span class="n">b_norm</span><span class="p">,</span><span class="n">vnbi</span><span class="o">/</span><span class="nb">norm2</span><span class="p">(</span><span class="n">vnbi</span><span class="p">))</span>
                    <span class="k">call </span><span class="n">gyro_step</span><span class="p">(</span><span class="n">vnbi</span><span class="p">,</span><span class="n">fields</span><span class="p">,</span><span class="n">beam_mass</span><span class="p">,</span><span class="n">r_gyro</span><span class="p">)</span>
                    <span class="n">birth</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">cnt</span><span class="p">)%</span><span class="n">ri_gc</span> <span class="o">=</span> <span class="n">ri</span> <span class="o">+</span> <span class="n">r_gyro</span>
                    <span class="n">birth</span><span class="p">%</span><span class="n">cnt</span> <span class="o">=</span> <span class="n">birth</span><span class="p">%</span><span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="k">enddo</span>
                <span class="c">!$OMP END CRITICAL(ndmc_birth)</span>
            <span class="k">endif</span>
<span class="k">        enddo </span><span class="n">energy_fractions</span>
    <span class="k">enddo </span><span class="n">loop_over_markers</span>
    <span class="c">!$OMP END PARALLEL DO</span>

<span class="cp">#ifdef _MPI</span>
    <span class="c">!! Combine beam neutrals</span>
    <span class="k">call </span><span class="n">parallel_merge_populations</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">)</span>
    <span class="k">call </span><span class="n">parallel_merge_populations</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">half</span><span class="p">)</span>
    <span class="k">call </span><span class="n">parallel_merge_populations</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">third</span><span class="p">)</span>

    <span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">nbi_outside</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_birth</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">birth</span><span class="p">%</span><span class="n">dens</span><span class="p">)</span>
    <span class="k">endif</span>
    <span class="c">!! Combine spectra</span>
    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_bes</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">full</span><span class="p">)</span>
        <span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">half</span><span class="p">)</span>
        <span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">third</span><span class="p">)</span>
    <span class="k">endif</span>
<span class="cp">#endif</span>

    <span class="k">if</span><span class="p">(</span><span class="n">nbi_outside</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="k">        if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T4,a, f6.2,a)&#39;</span><span class="p">)</span> <span class="s1">&#39;Percent of markers outside the grid: &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
                                  <span class="mi">10</span><span class="mf">0.</span><span class="o">*</span><span class="n">nbi_outside</span><span class="o">/</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_nbi</span><span class="p">),</span><span class="s1">&#39;%&#39;</span>
        <span class="k">endif</span>
<span class="k">        if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">%</span><span class="n">dens</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span> <span class="s1">&#39;Beam does not intersect the grid!&#39;</span>
    <span class="k">endif</span>

<span class="k">end subroutine </span><span class="n">ndmc</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2021 
                                          </p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            
            
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>