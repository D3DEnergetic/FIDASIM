<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="">
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>npa_f &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>User Guide</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>npa_f
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.6% of total for procedures.">84 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
     <li><a href='../module/libfida.html'>libfida</a></li>
     <li class="active">npa_f</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/npa_f.html#src">npa_f</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public subroutine npa_f()</h2>
    

    <p>Calculate Active NPA flux using a fast-ion distribution function F(E,p,r,z)</p>

    <h3>Arguments</h3>
    <em>None</em>
    <br>
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~npa_f~~CallsGraph Pages: 1 -->
<svg id="procnpa_fCallsGraph" width="641pt" height="1080pt"
 viewBox="0.00 0.00 641.00 1079.70" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~npa_f~~CallsGraph" class="graph" transform="scale(0.781707 0.781707) rotate(0) translate(4 1377.2)">
<title>proc~~npa_f~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1377.2 816,-1377.2 816,4 -4,4"/>
<!-- proc~npa_f -->
<g id="proc~~npa_f~~CallsGraph_node1" class="node"><title>proc~npa_f</title>
<polygon fill="none" stroke="black" points="54,-535 0,-535 0,-511 54,-511 54,-535"/>
<text text-anchor="middle" x="27" y="-520.6" font-family="Helvetica,sans-Serif" font-size="10.50">npa_f</text>
</g>
<!-- proc~gyro_surface -->
<g id="proc~~npa_f~~CallsGraph_node2" class="node"><title>proc~gyro_surface</title>
<g id="a_proc~~npa_f~~CallsGraph_node2"><a xlink:href=".././proc/gyro_surface.html" xlink:title="gyro_surface">
<polygon fill="#d9534f" stroke="#d9534f" points="175.5,-1181 100.5,-1181 100.5,-1157 175.5,-1157 175.5,-1181"/>
<text text-anchor="middle" x="138" y="-1166.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_surface</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~gyro_surface -->
<g id="proc~~npa_f~~CallsGraph_edge1" class="edge"><title>proc~npa_f&#45;&gt;proc~gyro_surface</title>
<path fill="none" stroke="#000000" d="M28.479,-535.172C31.8306,-617.937 52.7312,-1096.32 90,-1148 90.7645,-1149.06 91.595,-1150.07 92.4815,-1151.03"/>
<polygon fill="#000000" stroke="#000000" points="90.275,-1153.74 100.208,-1157.43 94.7417,-1148.35 90.275,-1153.74"/>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~npa_f~~CallsGraph_node3" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~npa_f~~CallsGraph_node3"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="174.5,-1139 101.5,-1139 101.5,-1115 174.5,-1115 174.5,-1139"/>
<text text-anchor="middle" x="138" y="-1124.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;interface~parallel_sum -->
<g id="proc~~npa_f~~CallsGraph_edge2" class="edge"><title>proc~npa_f&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M30.1773,-535.065C43.6118,-609.509 115.242,-1006.43 133.01,-1104.89"/>
<polygon fill="#000000" stroke="#000000" points="129.597,-1105.69 134.817,-1114.91 136.486,-1104.44 129.597,-1105.69"/>
</g>
<!-- proc~npa_gyro_range -->
<g id="proc~~npa_f~~CallsGraph_node4" class="node"><title>proc~npa_gyro_range</title>
<g id="a_proc~~npa_f~~CallsGraph_node4"><a xlink:href=".././proc/npa_gyro_range.html" xlink:title="npa_gyro_range">
<polygon fill="#d9534f" stroke="#d9534f" points="183.5,-827 92.5,-827 92.5,-803 183.5,-803 183.5,-827"/>
<text text-anchor="middle" x="138" y="-812.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_gyro_range</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~npa_gyro_range -->
<g id="proc~~npa_f~~CallsGraph_edge3" class="edge"><title>proc~npa_f&#45;&gt;proc~npa_gyro_range</title>
<path fill="none" stroke="#000000" d="M31.935,-535.322C41.3562,-564.613 66.1983,-640.622 90,-703 102.126,-734.778 117.63,-770.974 127.441,-793.405"/>
<polygon fill="#000000" stroke="#000000" points="124.288,-794.93 131.516,-802.677 130.697,-792.114 124.288,-794.93"/>
</g>
<!-- proc~get_indices -->
<g id="proc~~npa_f~~CallsGraph_node5" class="node"><title>proc~get_indices</title>
<g id="a_proc~~npa_f~~CallsGraph_node5"><a xlink:href=".././proc/get_indices.html" xlink:title="get_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="171.5,-619 104.5,-619 104.5,-595 171.5,-595 171.5,-619"/>
<text text-anchor="middle" x="138" y="-604.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_indices</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~get_indices -->
<g id="proc~~npa_f~~CallsGraph_edge4" class="edge"><title>proc~npa_f&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M37.4342,-535.004C48.7387,-548.761 68.8217,-571.299 90,-586 91.9088,-587.325 93.9148,-588.598 95.9783,-589.815"/>
<polygon fill="#000000" stroke="#000000" points="94.804,-593.156 105.273,-594.785 98.1053,-586.983 94.804,-593.156"/>
</g>
<!-- proc~attenuate -->
<g id="proc~~npa_f~~CallsGraph_node6" class="node"><title>proc~attenuate</title>
<g id="a_proc~~npa_f~~CallsGraph_node6"><a xlink:href=".././proc/attenuate.html" xlink:title="attenuate">
<polygon fill="#d9534f" stroke="#d9534f" points="167,-535 109,-535 109,-511 167,-511 167,-535"/>
<text text-anchor="middle" x="138" y="-520.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">attenuate</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~attenuate -->
<g id="proc~~npa_f~~CallsGraph_edge5" class="edge"><title>proc~npa_f&#45;&gt;proc~attenuate</title>
<path fill="none" stroke="#000000" d="M54.1082,-523C67.3866,-523 83.7845,-523 98.4814,-523"/>
<polygon fill="#000000" stroke="#000000" points="98.8136,-526.5 108.814,-523 98.8135,-519.5 98.8136,-526.5"/>
</g>
<!-- proc~get_nlaunch -->
<g id="proc~~npa_f~~CallsGraph_node7" class="node"><title>proc~get_nlaunch</title>
<g id="a_proc~~npa_f~~CallsGraph_node7"><a xlink:href=".././proc/get_nlaunch.html" xlink:title="get_nlaunch">
<polygon fill="#d9534f" stroke="#d9534f" points="173.5,-150 102.5,-150 102.5,-126 173.5,-126 173.5,-150"/>
<text text-anchor="middle" x="138" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_nlaunch</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~get_nlaunch -->
<g id="proc~~npa_f~~CallsGraph_edge6" class="edge"><title>proc~npa_f&#45;&gt;proc~get_nlaunch</title>
<path fill="none" stroke="#000000" d="M29.3142,-510.826C34.0007,-469.793 51.6988,-333.187 90,-227 98.8042,-202.591 113.209,-176.553 123.755,-158.989"/>
<polygon fill="#000000" stroke="#000000" points="126.919,-160.523 129.156,-150.167 120.949,-156.867 126.919,-160.523"/>
</g>
<!-- proc~gyro_trajectory -->
<g id="proc~~npa_f~~CallsGraph_node8" class="node"><title>proc~gyro_trajectory</title>
<g id="a_proc~~npa_f~~CallsGraph_node8"><a xlink:href=".././proc/gyro_trajectory.html" xlink:title="gyro_trajectory">
<polygon fill="#d9534f" stroke="#d9534f" points="180,-108 96,-108 96,-84 180,-84 180,-108"/>
<text text-anchor="middle" x="138" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_trajectory</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~gyro_trajectory -->
<g id="proc~~npa_f~~CallsGraph_edge7" class="edge"><title>proc~npa_f&#45;&gt;proc~gyro_trajectory</title>
<path fill="none" stroke="#000000" d="M28.3306,-510.628C30.1871,-449.624 41.0619,-181.232 90,-117 90.677,-116.111 91.4,-115.259 92.1628,-114.443"/>
<polygon fill="#000000" stroke="#000000" points="94.4683,-117.078 99.9391,-108.005 90.0043,-111.686 94.4683,-117.078"/>
</g>
<!-- proc~get_total_cx_rate -->
<g id="proc~~npa_f~~CallsGraph_node9" class="node"><title>proc~get_total_cx_rate</title>
<g id="a_proc~~npa_f~~CallsGraph_node9"><a xlink:href=".././proc/get_total_cx_rate.html" xlink:title="get_total_cx_rate">
<polygon fill="#d9534f" stroke="#d9534f" points="185.5,-577 90.5,-577 90.5,-553 185.5,-553 185.5,-577"/>
<text text-anchor="middle" x="138" y="-562.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_total_cx_rate</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~get_total_cx_rate -->
<g id="proc~~npa_f~~CallsGraph_edge8" class="edge"><title>proc~npa_f&#45;&gt;proc~get_total_cx_rate</title>
<path fill="none" stroke="#000000" d="M54.1082,-533.06C66.6967,-537.911 82.0891,-543.842 96.1777,-549.27"/>
<polygon fill="#000000" stroke="#000000" points="95.0829,-552.599 105.673,-552.929 97.5998,-546.067 95.0829,-552.599"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~npa_f~~CallsGraph_node10" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~npa_f~~CallsGraph_node10"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-495 235,-495 235,-471 303,-471 303,-495"/>
<text text-anchor="middle" x="269" y="-480.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~get_plasma -->
<g id="proc~~npa_f~~CallsGraph_edge9" class="edge"><title>proc~npa_f&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M54.187,-512.702C65.105,-508.786 78.0127,-504.636 90,-502 135.307,-492.037 188.294,-487.233 224.603,-484.959"/>
<polygon fill="#000000" stroke="#000000" points="225.066,-488.437 234.844,-484.357 224.656,-481.449 225.066,-488.437"/>
</g>
<!-- proc~ind2sub -->
<g id="proc~~npa_f~~CallsGraph_node11" class="node"><title>proc~ind2sub</title>
<g id="a_proc~~npa_f~~CallsGraph_node11"><a xlink:href=".././proc/ind2sub.html" xlink:title="ind2sub">
<polygon fill="#d9534f" stroke="#d9534f" points="296,-171 242,-171 242,-147 296,-147 296,-171"/>
<text text-anchor="middle" x="269" y="-156.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ind2sub</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~ind2sub -->
<g id="proc~~npa_f~~CallsGraph_edge10" class="edge"><title>proc~npa_f&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M28.3706,-510.808C30.048,-473.325 39.286,-357.695 90,-281 124.913,-228.201 191.274,-191.954 232.366,-173.41"/>
<polygon fill="#000000" stroke="#000000" points="233.987,-176.52 241.733,-169.292 231.17,-170.112 233.987,-176.52"/>
</g>
<!-- proc~hit_npa_detector -->
<g id="proc~~npa_f~~CallsGraph_node12" class="node"><title>proc~hit_npa_detector</title>
<g id="a_proc~~npa_f~~CallsGraph_node12"><a xlink:href=".././proc/hit_npa_detector.html" xlink:title="hit_npa_detector">
<polygon fill="#d9534f" stroke="#d9534f" points="315.5,-743 222.5,-743 222.5,-719 315.5,-719 315.5,-743"/>
<text text-anchor="middle" x="269" y="-728.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hit_npa_detector</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~hit_npa_detector -->
<g id="proc~~npa_f~~CallsGraph_edge11" class="edge"><title>proc~npa_f&#45;&gt;proc~hit_npa_detector</title>
<path fill="none" stroke="#000000" d="M32.6781,-535.024C41.3321,-556.025 61.5835,-599.833 90,-628 130.207,-667.854 188.894,-697.853 227.744,-714.915"/>
<polygon fill="#000000" stroke="#000000" points="226.601,-718.234 237.17,-718.973 229.369,-711.804 226.601,-718.234"/>
</g>
<!-- proc~store_npa -->
<g id="proc~~npa_f~~CallsGraph_node13" class="node"><title>proc~store_npa</title>
<g id="a_proc~~npa_f~~CallsGraph_node13"><a xlink:href=".././proc/store_npa.html" xlink:title="store_npa">
<polygon fill="#d9534f" stroke="#d9534f" points="168.5,-417 107.5,-417 107.5,-393 168.5,-393 168.5,-417"/>
<text text-anchor="middle" x="138" y="-402.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_npa</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~store_npa -->
<g id="proc~~npa_f~~CallsGraph_edge12" class="edge"><title>proc~npa_f&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M39.2544,-510.816C58.02,-490.501 95.8769,-449.519 118.576,-424.945"/>
<polygon fill="#000000" stroke="#000000" points="121.429,-427.015 125.644,-417.294 116.287,-422.265 121.429,-427.015"/>
</g>
<!-- proc~mc_fastion -->
<g id="proc~~npa_f~~CallsGraph_node14" class="node"><title>proc~mc_fastion</title>
<g id="a_proc~~npa_f~~CallsGraph_node14"><a xlink:href=".././proc/mc_fastion.html" xlink:title="mc_fastion">
<polygon fill="#d9534f" stroke="#d9534f" points="170,-314 106,-314 106,-290 170,-290 170,-314"/>
<text text-anchor="middle" x="138" y="-299.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_fastion</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~mc_fastion -->
<g id="proc~~npa_f~~CallsGraph_edge13" class="edge"><title>proc~npa_f&#45;&gt;proc~mc_fastion</title>
<path fill="none" stroke="#000000" d="M32.9082,-510.91C42.9056,-486.543 66.6641,-429.939 90,-384 100.809,-362.721 114.508,-339.151 124.324,-322.762"/>
<polygon fill="#000000" stroke="#000000" points="127.432,-324.385 129.603,-314.015 121.439,-320.768 127.432,-324.385"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~npa_f~~CallsGraph_node15" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~npa_f~~CallsGraph_node15"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-1079 225,-1079 225,-1055 313,-1055 313,-1079"/>
<text text-anchor="middle" x="269" y="-1064.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~npa_f~~CallsGraph_edge14" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M165.105,-1114.86C184.601,-1105.79 211.455,-1093.3 232.841,-1083.35"/>
<polygon fill="#000000" stroke="#000000" points="234.343,-1086.51 241.934,-1079.12 231.39,-1080.17 234.343,-1086.51"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~npa_f~~CallsGraph_node17" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~npa_f~~CallsGraph_node17"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1328 223.5,-1328 223.5,-1304 314.5,-1304 314.5,-1328"/>
<text text-anchor="middle" x="269" y="-1313.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~npa_f~~CallsGraph_edge19" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.805,-1138.69C179.006,-1141.24 182.893,-1144.31 186,-1148 227.916,-1197.82 182.478,-1238.26 222,-1290 224.182,-1292.86 226.774,-1295.45 229.599,-1297.79"/>
<polygon fill="#000000" stroke="#000000" points="227.842,-1300.83 238.032,-1303.73 231.874,-1295.11 227.842,-1300.83"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~npa_f~~CallsGraph_node19" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~npa_f~~CallsGraph_node19"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1248 223.5,-1248 223.5,-1224 314.5,-1224 314.5,-1248"/>
<text text-anchor="middle" x="269" y="-1233.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~npa_f~~CallsGraph_edge23" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M173.525,-1139.19C178.024,-1141.67 182.335,-1144.59 186,-1148 210.758,-1171.02 197.335,-1191.88 222,-1215 223.277,-1216.2 224.634,-1217.33 226.051,-1218.42"/>
<polygon fill="#000000" stroke="#000000" points="224.383,-1221.5 234.681,-1223.99 228.183,-1215.63 224.383,-1221.5"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~npa_f~~CallsGraph_node20" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~npa_f~~CallsGraph_node20"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-995 380,-995 380,-971 468,-971 468,-995"/>
<text text-anchor="middle" x="424" y="-980.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~npa_f~~CallsGraph_edge15" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M144.521,-1114.91C155.632,-1092.06 183.005,-1042.71 222,-1019 266.772,-991.772 326.852,-983.985 369.636,-982.266"/>
<polygon fill="#000000" stroke="#000000" points="369.958,-985.758 379.848,-981.957 369.747,-978.761 369.958,-985.758"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~npa_f~~CallsGraph_node23" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~npa_f~~CallsGraph_node23"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1206 223.5,-1206 223.5,-1182 314.5,-1182 314.5,-1206"/>
<text text-anchor="middle" x="269" y="-1191.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~npa_f~~CallsGraph_edge17" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M167.031,-1139.02C173.323,-1141.86 179.931,-1144.95 186,-1148 188.692,-1149.35 215.558,-1164.45 237.816,-1176.98"/>
<polygon fill="#000000" stroke="#000000" points="236.248,-1180.12 246.679,-1181.98 239.684,-1174.02 236.248,-1180.12"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~npa_f~~CallsGraph_node25" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~npa_f~~CallsGraph_node25"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-1159 225,-1159 225,-1135 313,-1135 313,-1159"/>
<text text-anchor="middle" x="269" y="-1144.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~npa_f~~CallsGraph_edge20" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.591,-1132.52C186.952,-1134.43 201.1,-1136.63 214.581,-1138.72"/>
<polygon fill="#000000" stroke="#000000" points="214.301,-1142.22 224.72,-1140.29 215.374,-1135.3 214.301,-1142.22"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~npa_f~~CallsGraph_node26" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~npa_f~~CallsGraph_node26"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-1117 380,-1117 380,-1093 468,-1093 468,-1117"/>
<text text-anchor="middle" x="424" y="-1102.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~npa_f~~CallsGraph_edge22" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.681,-1124.24C223.768,-1120.43 312.516,-1113.56 369.549,-1109.14"/>
<polygon fill="#000000" stroke="#000000" points="370.112,-1112.61 379.812,-1108.35 369.572,-1105.63 370.112,-1112.61"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~npa_f~~CallsGraph_node32" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~npa_f~~CallsGraph_node32"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="469.5,-1291 378.5,-1291 378.5,-1267 469.5,-1267 469.5,-1291"/>
<text text-anchor="middle" x="424" y="-1276.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_f~~CallsGraph_edge21" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.565,-1138.9C178.803,-1141.41 182.764,-1144.42 186,-1148 220.205,-1185.85 182.343,-1224.9 222,-1257 262.631,-1289.88 323.997,-1291.96 368.231,-1287.94"/>
<polygon fill="#000000" stroke="#000000" points="368.653,-1291.41 378.238,-1286.9 367.93,-1284.45 368.653,-1291.41"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~npa_f~~CallsGraph_node34" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~npa_f~~CallsGraph_node34"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="469.5,-1037 378.5,-1037 378.5,-1013 469.5,-1013 469.5,-1037"/>
<text text-anchor="middle" x="424" y="-1022.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~npa_f~~CallsGraph_edge16" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M147.261,-1114.81C160.563,-1096.32 188.642,-1061.65 222,-1046 268.071,-1024.39 326.458,-1020.52 368.416,-1021.23"/>
<polygon fill="#000000" stroke="#000000" points="368.356,-1024.73 378.444,-1021.5 368.539,-1017.74 368.356,-1024.73"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~npa_f~~CallsGraph_node35" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~npa_f~~CallsGraph_node35"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1370 223.5,-1370 223.5,-1346 314.5,-1346 314.5,-1370"/>
<text text-anchor="middle" x="269" y="-1355.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~npa_f~~CallsGraph_edge18" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.55,-1138.24C178.898,-1140.86 182.894,-1144.08 186,-1148 239.061,-1215.06 169.21,-1269.73 222,-1337 222.593,-1337.76 223.219,-1338.48 223.874,-1339.19"/>
<polygon fill="#000000" stroke="#000000" points="221.912,-1342.11 231.843,-1345.8 226.381,-1336.72 221.912,-1342.11"/>
</g>
<!-- proc~approx_eq -->
<g id="proc~~npa_f~~CallsGraph_node16" class="node"><title>proc~approx_eq</title>
<g id="a_proc~~npa_f~~CallsGraph_node16"><a xlink:href=".././proc/approx_eq.html" xlink:title="approx_eq">
<polygon fill="#d94e8f" stroke="#d94e8f" points="301,-869 237,-869 237,-845 301,-845 301,-869"/>
<text text-anchor="middle" x="269" y="-854.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_eq</text>
</a>
</g>
</g>
<!-- proc~npa_gyro_range&#45;&gt;proc~approx_eq -->
<g id="proc~~npa_f~~CallsGraph_edge25" class="edge"><title>proc~npa_gyro_range&#45;&gt;proc~approx_eq</title>
<path fill="none" stroke="#000000" d="M175.966,-827.036C191.873,-832.215 210.531,-838.289 226.873,-843.61"/>
<polygon fill="#000000" stroke="#000000" points="226.112,-847.043 236.705,-846.811 228.279,-840.387 226.112,-847.043"/>
</g>
<!-- proc~gyro_range -->
<g id="proc~~npa_f~~CallsGraph_node18" class="node"><title>proc~gyro_range</title>
<g id="a_proc~~npa_f~~CallsGraph_node18"><a xlink:href=".././proc/gyro_range.html" xlink:title="gyro_range">
<polygon fill="#d9534f" stroke="#d9534f" points="302.5,-827 235.5,-827 235.5,-803 302.5,-803 302.5,-827"/>
<text text-anchor="middle" x="269" y="-812.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_range</text>
</a>
</g>
</g>
<!-- proc~npa_gyro_range&#45;&gt;proc~gyro_range -->
<g id="proc~~npa_f~~CallsGraph_edge24" class="edge"><title>proc~npa_gyro_range&#45;&gt;proc~gyro_range</title>
<path fill="none" stroke="#000000" d="M183.756,-815C197.077,-815 211.642,-815 224.859,-815"/>
<polygon fill="#000000" stroke="#000000" points="225.119,-818.5 235.119,-815 225.119,-811.5 225.119,-818.5"/>
</g>
<!-- proc~attenuate&#45;&gt;proc~get_plasma -->
<g id="proc~~npa_f~~CallsGraph_edge26" class="edge"><title>proc~attenuate&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M167.31,-514.222C184.236,-508.973 206.078,-502.201 225.091,-496.305"/>
<polygon fill="#000000" stroke="#000000" points="226.22,-499.62 234.735,-493.315 224.147,-492.934 226.22,-499.62"/>
</g>
<!-- proc~colrad -->
<g id="proc~~npa_f~~CallsGraph_node21" class="node"><title>proc~colrad</title>
<g id="a_proc~~npa_f~~CallsGraph_node21"><a xlink:href=".././proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="296,-585 242,-585 242,-561 296,-561 296,-585"/>
<text text-anchor="middle" x="269" y="-570.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~attenuate&#45;&gt;proc~colrad -->
<g id="proc~~npa_f~~CallsGraph_edge27" class="edge"><title>proc~attenuate&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M167.31,-533.973C186.518,-541.418 212.057,-551.317 232.607,-559.282"/>
<polygon fill="#000000" stroke="#000000" points="231.362,-562.553 241.951,-562.903 233.892,-556.026 231.362,-562.553"/>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~ind2sub -->
<g id="proc~~npa_f~~CallsGraph_edge29" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M173.57,-143.628C191.621,-146.566 213.691,-150.159 231.955,-153.132"/>
<polygon fill="#000000" stroke="#000000" points="231.501,-156.604 241.934,-154.757 232.626,-149.695 231.501,-156.604"/>
</g>
<!-- interface~randind_cdf -->
<g id="proc~~npa_f~~CallsGraph_node28" class="node"><title>interface~randind_cdf</title>
<g id="a_proc~~npa_f~~CallsGraph_node28"><a xlink:href=".././interface/randind_cdf.html" xlink:title="randind_cdf">
<polygon fill="#a7506f" stroke="#a7506f" points="303.5,-87 234.5,-87 234.5,-63 303.5,-63 303.5,-87"/>
<text text-anchor="middle" x="269" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind_cdf</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;interface~randind_cdf -->
<g id="proc~~npa_f~~CallsGraph_edge31" class="edge"><title>proc~get_nlaunch&#45;&gt;interface~randind_cdf</title>
<path fill="none" stroke="#000000" d="M167.567,-125.828C173.707,-123.048 180.116,-120.02 186,-117 202.48,-108.543 205.554,-104.524 222,-96 224.884,-94.5053 227.895,-93.004 230.936,-91.5292"/>
<polygon fill="#000000" stroke="#000000" points="232.51,-94.6566 240.054,-87.2176 229.518,-88.3284 232.51,-94.6566"/>
</g>
<!-- proc~rng_init -->
<g id="proc~~npa_f~~CallsGraph_node38" class="node"><title>proc~rng_init</title>
<g id="a_proc~~npa_f~~CallsGraph_node38"><a xlink:href=".././proc/rng_init.html" xlink:title="rng_init">
<polygon fill="#d9534f" stroke="#d9534f" points="296,-45 242,-45 242,-21 296,-21 296,-45"/>
<text text-anchor="middle" x="269" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rng_init</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~rng_init -->
<g id="proc~~npa_f~~CallsGraph_edge28" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~rng_init</title>
<path fill="none" stroke="#000000" d="M172.96,-125.99C177.644,-123.46 182.158,-120.48 186,-117 209.903,-95.3521 198.184,-75.7441 222,-54 225.209,-51.07 228.897,-48.4879 232.759,-46.2287"/>
<polygon fill="#000000" stroke="#000000" points="234.632,-49.2019 241.941,-41.5317 231.444,-42.97 234.632,-49.2019"/>
</g>
<!-- proc~cumsum -->
<g id="proc~~npa_f~~CallsGraph_node40" class="node"><title>proc~cumsum</title>
<g id="a_proc~~npa_f~~CallsGraph_node40"><a xlink:href=".././proc/cumsum.html" xlink:title="cumsum">
<polygon fill="#d9534f" stroke="#d9534f" points="296,-129 242,-129 242,-105 296,-105 296,-129"/>
<text text-anchor="middle" x="269" y="-114.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cumsum</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~cumsum -->
<g id="proc~~npa_f~~CallsGraph_edge30" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~cumsum</title>
<path fill="none" stroke="#000000" d="M173.57,-132.372C191.621,-129.434 213.691,-125.841 231.955,-122.868"/>
<polygon fill="#000000" stroke="#000000" points="232.626,-126.305 241.934,-121.243 231.501,-119.396 232.626,-126.305"/>
</g>
<!-- proc~neutral_cx_rate -->
<g id="proc~~npa_f~~CallsGraph_node39" class="node"><title>proc~neutral_cx_rate</title>
<g id="a_proc~~npa_f~~CallsGraph_node39"><a xlink:href=".././proc/neutral_cx_rate.html" xlink:title="neutral_cx_rate">
<polygon fill="#d9534f" stroke="#d9534f" points="312.5,-638 225.5,-638 225.5,-614 312.5,-614 312.5,-638"/>
<text text-anchor="middle" x="269" y="-623.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutral_cx_rate</text>
</a>
</g>
</g>
<!-- proc~get_total_cx_rate&#45;&gt;proc~neutral_cx_rate -->
<g id="proc~~npa_f~~CallsGraph_edge32" class="edge"><title>proc~get_total_cx_rate&#45;&gt;proc~neutral_cx_rate</title>
<path fill="none" stroke="#000000" d="M166.409,-577.06C172.854,-579.948 179.684,-583.05 186,-586 202.01,-593.479 219.639,-602.036 234.435,-609.311"/>
<polygon fill="#000000" stroke="#000000" points="233.187,-612.598 243.704,-613.883 236.284,-606.32 233.187,-612.598"/>
</g>
<!-- proc~get_position -->
<g id="proc~~npa_f~~CallsGraph_node24" class="node"><title>proc~get_position</title>
<g id="a_proc~~npa_f~~CallsGraph_node24"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="459,-297 389,-297 389,-273 459,-273 459,-297"/>
<text text-anchor="middle" x="424" y="-282.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~npa_f~~CallsGraph_edge34" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M275.888,-470.787C284.714,-452.433 301.85,-416.624 316,-386 332.354,-350.606 322.63,-331.643 352,-306 359.625,-299.342 369.278,-294.793 378.989,-291.686"/>
<polygon fill="#000000" stroke="#000000" points="379.93,-295.057 388.646,-289.034 378.077,-288.307 379.93,-295.057"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_node29" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~npa_f~~CallsGraph_node29"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="606,-415 538,-415 538,-391 606,-391 606,-415"/>
<text text-anchor="middle" x="572" y="-400.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge33" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M303.073,-474.21C357.788,-459.668 467.121,-430.609 527.842,-414.471"/>
<polygon fill="#000000" stroke="#000000" points="529.107,-417.756 537.872,-411.805 527.309,-410.991 529.107,-417.756"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~npa_f~~CallsGraph_node36" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~npa_f~~CallsGraph_node36"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="454.5,-495 393.5,-495 393.5,-471 454.5,-471 454.5,-495"/>
<text text-anchor="middle" x="424" y="-480.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~npa_f~~CallsGraph_edge36" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M303.199,-483C326.731,-483 358.413,-483 383.287,-483"/>
<polygon fill="#000000" stroke="#000000" points="383.486,-486.5 393.486,-483 383.486,-479.5 383.486,-486.5"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_node42" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~npa_f~~CallsGraph_node42"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="716,-335 648,-335 648,-311 716,-311 716,-335"/>
<text text-anchor="middle" x="682" y="-320.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_edge35" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M303.017,-493.911C347.794,-506.961 429.783,-524.619 496,-504 555.795,-485.38 567.814,-468.382 612,-424 636.167,-399.726 657.272,-365.945 669.58,-344.274"/>
<polygon fill="#000000" stroke="#000000" points="672.798,-345.688 674.595,-335.246 666.679,-342.288 672.798,-345.688"/>
</g>
<!-- proc~line_plane_intersect -->
<g id="proc~~npa_f~~CallsGraph_node22" class="node"><title>proc~line_plane_intersect</title>
<g id="a_proc~~npa_f~~CallsGraph_node22"><a xlink:href=".././proc/line_plane_intersect.html" xlink:title="line_plane_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="478,-785 370,-785 370,-761 478,-761 478,-785"/>
<text text-anchor="middle" x="424" y="-770.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">line_plane_intersect</text>
</a>
</g>
</g>
<!-- proc~hit_npa_detector&#45;&gt;proc~line_plane_intersect -->
<g id="proc~~npa_f~~CallsGraph_edge37" class="edge"><title>proc~hit_npa_detector&#45;&gt;proc~line_plane_intersect</title>
<path fill="none" stroke="#000000" d="M313.844,-743.036C331.129,-747.781 351.153,-753.277 369.294,-758.257"/>
<polygon fill="#000000" stroke="#000000" points="368.58,-761.691 379.15,-760.963 370.433,-754.94 368.58,-761.691"/>
</g>
<!-- proc~in_boundary -->
<g id="proc~~npa_f~~CallsGraph_node33" class="node"><title>proc~in_boundary</title>
<g id="a_proc~~npa_f~~CallsGraph_node33"><a xlink:href=".././proc/in_boundary.html" xlink:title="in_boundary">
<polygon fill="#d94e8f" stroke="#d94e8f" points="460,-743 388,-743 388,-719 460,-719 460,-743"/>
<text text-anchor="middle" x="424" y="-728.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_boundary</text>
</a>
</g>
</g>
<!-- proc~hit_npa_detector&#45;&gt;proc~in_boundary -->
<g id="proc~~npa_f~~CallsGraph_edge38" class="edge"><title>proc~hit_npa_detector&#45;&gt;proc~in_boundary</title>
<path fill="none" stroke="#000000" d="M315.905,-731C335.453,-731 358.193,-731 377.677,-731"/>
<polygon fill="#000000" stroke="#000000" points="377.83,-734.5 387.83,-731 377.83,-727.5 377.83,-734.5"/>
</g>
<!-- proc~store_npa&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge39" class="edge"><title>proc~store_npa&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M168.693,-404.863C243.522,-404.516 440.089,-403.606 527.74,-403.2"/>
<polygon fill="#000000" stroke="#000000" points="527.89,-406.7 537.873,-403.153 527.857,-399.7 527.89,-406.7"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~npa_f~~CallsGraph_node41" class="node"><title>proc~get_fields</title>
<g id="a_proc~~npa_f~~CallsGraph_node41"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="298,-377 240,-377 240,-353 298,-353 298,-377"/>
<text text-anchor="middle" x="269" y="-362.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~store_npa&#45;&gt;proc~get_fields -->
<g id="proc~~npa_f~~CallsGraph_edge40" class="edge"><title>proc~store_npa&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M168.595,-395.823C186.922,-390.141 210.629,-382.79 230.294,-376.692"/>
<polygon fill="#000000" stroke="#000000" points="231.355,-380.027 239.87,-373.723 229.282,-373.341 231.355,-380.027"/>
</g>
<!-- interface~randu -->
<g id="proc~~npa_f~~CallsGraph_node27" class="node"><title>interface~randu</title>
<g id="a_proc~~npa_f~~CallsGraph_node27"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="451,-137 397,-137 397,-113 451,-113 451,-137"/>
<text text-anchor="middle" x="424" y="-122.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;interface~randu -->
<g id="proc~~npa_f~~CallsGraph_edge42" class="edge"><title>proc~mc_fastion&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M161.648,-289.889C178.194,-281.201 201.267,-269.416 222,-260 263.029,-241.366 283.222,-252.923 316,-222 343.186,-196.352 323.607,-170.306 352,-146 361.765,-137.641 374.735,-132.608 386.916,-129.578"/>
<polygon fill="#000000" stroke="#000000" points="387.813,-132.966 396.874,-127.475 386.367,-126.117 387.813,-132.966"/>
</g>
<!-- proc~get_distribution -->
<g id="proc~~npa_f~~CallsGraph_node30" class="node"><title>proc~get_distribution</title>
<g id="a_proc~~npa_f~~CallsGraph_node30"><a xlink:href=".././proc/get_distribution.html" xlink:title="get_distribution">
<polygon fill="#d9534f" stroke="#d9534f" points="311.5,-293 226.5,-293 226.5,-269 311.5,-269 311.5,-293"/>
<text text-anchor="middle" x="269" y="-278.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_distribution</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;proc~get_distribution -->
<g id="proc~~npa_f~~CallsGraph_edge41" class="edge"><title>proc~mc_fastion&#45;&gt;proc~get_distribution</title>
<path fill="none" stroke="#000000" d="M170.227,-296.916C184.051,-294.666 200.683,-291.959 216.277,-289.42"/>
<polygon fill="#000000" stroke="#000000" points="217.027,-292.844 226.334,-287.783 215.902,-285.935 217.027,-292.844"/>
</g>
<!-- interface~randind -->
<g id="proc~~npa_f~~CallsGraph_node31" class="node"><title>interface~randind</title>
<g id="a_proc~~npa_f~~CallsGraph_node31"><a xlink:href=".././interface/randind.html" xlink:title="randind">
<polygon fill="#a7506f" stroke="#a7506f" points="296,-335 242,-335 242,-311 296,-311 296,-335"/>
<text text-anchor="middle" x="269" y="-320.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;interface~randind -->
<g id="proc~~npa_f~~CallsGraph_edge43" class="edge"><title>proc~mc_fastion&#45;&gt;interface~randind</title>
<path fill="none" stroke="#000000" d="M170.227,-307.084C188.81,-310.109 212.467,-313.96 231.855,-317.116"/>
<polygon fill="#000000" stroke="#000000" points="231.409,-320.589 241.842,-318.742 232.534,-313.68 231.409,-320.589"/>
</g>
<!-- proc~mc_beam_grid -->
<g id="proc~~npa_f~~CallsGraph_node37" class="node"><title>proc~mc_beam_grid</title>
<g id="a_proc~~npa_f~~CallsGraph_node37"><a xlink:href=".././proc/mc_beam_grid.html" xlink:title="mc_beam_grid">
<polygon fill="#d9534f" stroke="#d9534f" points="311,-213 227,-213 227,-189 311,-189 311,-213"/>
<text text-anchor="middle" x="269" y="-198.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_beam_grid</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;proc~mc_beam_grid -->
<g id="proc~~npa_f~~CallsGraph_edge44" class="edge"><title>proc~mc_fastion&#45;&gt;proc~mc_beam_grid</title>
<path fill="none" stroke="#000000" d="M150.655,-289.927C166.095,-274.308 194.588,-246.762 222,-227 226.172,-223.992 230.723,-221.055 235.286,-218.302"/>
<polygon fill="#000000" stroke="#000000" points="237.084,-221.305 243.982,-213.263 233.574,-215.249 237.084,-221.305"/>
</g>
<!-- proc~mc_fastion&#45;&gt;proc~get_fields -->
<g id="proc~~npa_f~~CallsGraph_edge45" class="edge"><title>proc~mc_fastion&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M162.131,-314.018C178.712,-322.557 201.625,-334.199 222,-344 225.182,-345.531 228.499,-347.099 231.831,-348.654"/>
<polygon fill="#000000" stroke="#000000" points="230.613,-351.947 241.159,-352.966 233.55,-345.593 230.613,-351.947"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~npa_f~~CallsGraph_edge46" class="edge"><title>proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M313.026,-1077.69C330.708,-1082.08 351.361,-1087.21 369.964,-1091.83"/>
<polygon fill="#000000" stroke="#000000" points="369.218,-1095.25 379.767,-1094.26 370.905,-1088.45 369.218,-1095.25"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_node47" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="611.5,-1194 532.5,-1194 532.5,-1170 611.5,-1170 611.5,-1194"/>
<text text-anchor="middle" x="572" y="-1179.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge47" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M313.294,-1060.25C361.059,-1054.97 438.738,-1052.99 496,-1084 527.321,-1100.96 549.592,-1137.22 561.358,-1160.56"/>
<polygon fill="#000000" stroke="#000000" points="558.258,-1162.19 565.753,-1169.68 564.564,-1159.15 558.258,-1162.19"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_f~~CallsGraph_edge48" class="edge"><title>proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M314.665,-1305.2C331.402,-1301.15 350.614,-1296.51 368.167,-1292.26"/>
<polygon fill="#000000" stroke="#000000" points="369.382,-1295.57 378.279,-1289.81 367.737,-1288.76 369.382,-1295.57"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge49" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M309.933,-1328.01C357.748,-1339.91 438.563,-1351.92 496,-1318 537.745,-1293.35 557.848,-1236.24 566.117,-1204.42"/>
<polygon fill="#000000" stroke="#000000" points="569.612,-1204.86 568.564,-1194.32 562.808,-1203.21 569.612,-1204.86"/>
</g>
<!-- proc~gyro_range&#45;&gt;proc~line_plane_intersect -->
<g id="proc~~npa_f~~CallsGraph_edge54" class="edge"><title>proc~gyro_range&#45;&gt;proc~line_plane_intersect</title>
<path fill="none" stroke="#000000" d="M302.822,-805.99C322.25,-800.657 347.33,-793.772 369.548,-787.673"/>
<polygon fill="#000000" stroke="#000000" points="370.48,-791.047 379.196,-785.025 368.627,-784.297 370.48,-791.047"/>
</g>
<!-- proc~gyro_range&#45;&gt;proc~in_boundary -->
<g id="proc~~npa_f~~CallsGraph_edge55" class="edge"><title>proc~gyro_range&#45;&gt;proc~in_boundary</title>
<path fill="none" stroke="#000000" d="M282.609,-802.891C297.891,-788.82 324.968,-765.777 352,-752 360.071,-747.886 369.08,-744.446 377.898,-741.62"/>
<polygon fill="#000000" stroke="#000000" points="379.133,-744.904 387.712,-738.688 377.128,-738.197 379.133,-744.904"/>
</g>
<!-- proc~gyro_surface_coordinates -->
<g id="proc~~npa_f~~CallsGraph_node45" class="node"><title>proc~gyro_surface_coordinates</title>
<g id="a_proc~~npa_f~~CallsGraph_node45"><a xlink:href=".././proc/gyro_surface_coordinates.html" xlink:title="gyro_surface_coordinates">
<polygon fill="#d9534f" stroke="#d9534f" points="492,-911 356,-911 356,-887 492,-887 492,-911"/>
<text text-anchor="middle" x="424" y="-896.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_surface_coordinates</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~gyro_surface_coordinates -->
<g id="proc~~npa_f~~CallsGraph_edge50" class="edge"><title>proc~gyro_range&#45;&gt;proc~gyro_surface_coordinates</title>
<path fill="none" stroke="#000000" d="M301.237,-827.017C306.391,-829.619 311.511,-832.621 316,-836 335.643,-850.785 331.366,-864.632 352,-878 354.613,-879.693 357.367,-881.253 360.211,-882.691"/>
<polygon fill="#000000" stroke="#000000" points="358.989,-885.979 369.546,-886.879 361.855,-879.592 358.989,-885.979"/>
</g>
<!-- proc~in_gyro_surface -->
<g id="proc~~npa_f~~CallsGraph_node50" class="node"><title>proc~in_gyro_surface</title>
<g id="a_proc~~npa_f~~CallsGraph_node50"><a xlink:href=".././proc/in_gyro_surface.html" xlink:title="in_gyro_surface">
<polygon fill="#d94e8f" stroke="#d94e8f" points="468.5,-869 379.5,-869 379.5,-845 468.5,-845 468.5,-869"/>
<text text-anchor="middle" x="424" y="-854.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_gyro_surface</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~in_gyro_surface -->
<g id="proc~~npa_f~~CallsGraph_edge51" class="edge"><title>proc~gyro_range&#45;&gt;proc~in_gyro_surface</title>
<path fill="none" stroke="#000000" d="M302.822,-824.01C322.326,-829.364 347.527,-836.282 369.81,-842.399"/>
<polygon fill="#000000" stroke="#000000" points="368.914,-845.782 379.483,-845.054 370.767,-839.032 368.914,-845.782"/>
</g>
<!-- proc~boundary_edge -->
<g id="proc~~npa_f~~CallsGraph_node54" class="node"><title>proc~boundary_edge</title>
<g id="a_proc~~npa_f~~CallsGraph_node54"><a xlink:href=".././proc/boundary_edge.html" xlink:title="boundary_edge">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-827 380,-827 380,-803 468,-803 468,-827"/>
<text text-anchor="middle" x="424" y="-812.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boundary_edge</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~boundary_edge -->
<g id="proc~~npa_f~~CallsGraph_edge52" class="edge"><title>proc~gyro_range&#45;&gt;proc~boundary_edge</title>
<path fill="none" stroke="#000000" d="M302.822,-815C322.227,-815 347.271,-815 369.47,-815"/>
<polygon fill="#000000" stroke="#000000" points="369.77,-818.5 379.77,-815 369.77,-811.5 369.77,-818.5"/>
</g>
<!-- proc~line_gyro_surface_intersect -->
<g id="proc~~npa_f~~CallsGraph_node55" class="node"><title>proc~line_gyro_surface_intersect</title>
<g id="a_proc~~npa_f~~CallsGraph_node55"><a xlink:href=".././proc/line_gyro_surface_intersect.html" xlink:title="line_gyro_surface_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="496,-953 352,-953 352,-929 496,-929 496,-953"/>
<text text-anchor="middle" x="424" y="-938.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">line_gyro_surface_intersect</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~line_gyro_surface_intersect -->
<g id="proc~~npa_f~~CallsGraph_edge53" class="edge"><title>proc~gyro_range&#45;&gt;proc~line_gyro_surface_intersect</title>
<path fill="none" stroke="#000000" d="M302.66,-826.194C307.537,-828.867 312.196,-832.107 316,-836 344.383,-865.055 321.645,-893.012 352,-920 353.354,-921.204 354.774,-922.339 356.249,-923.408"/>
<polygon fill="#000000" stroke="#000000" points="354.85,-926.654 365.214,-928.853 358.484,-920.671 354.85,-926.654"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_f~~CallsGraph_edge56" class="edge"><title>proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M313.026,-1248.09C330.857,-1253.1 351.711,-1258.96 370.437,-1264.23"/>
<polygon fill="#000000" stroke="#000000" points="369.723,-1267.66 380.297,-1267 371.617,-1260.92 369.723,-1267.66"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge57" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.818,-1230.33C360.578,-1224.24 433.557,-1213.72 496,-1201 504.607,-1199.25 513.71,-1197.15 522.495,-1195"/>
<polygon fill="#000000" stroke="#000000" points="523.382,-1198.39 532.234,-1192.56 521.683,-1191.59 523.382,-1198.39"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge58" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M468.295,-989.291C478.282,-992.407 488.24,-997.058 496,-1004 542.86,-1045.92 561.31,-1121.91 567.829,-1159.59"/>
<polygon fill="#000000" stroke="#000000" points="564.388,-1160.23 569.427,-1169.55 571.3,-1159.12 564.388,-1160.23"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~npa_f~~CallsGraph_node48" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~npa_f~~CallsGraph_node48"><a xlink:href=".././proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-617 380,-617 380,-593 468,-593 468,-617"/>
<text text-anchor="middle" x="424" y="-602.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~npa_f~~CallsGraph_edge59" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M296.302,-578.501C316.427,-582.71 344.85,-588.655 369.677,-593.847"/>
<polygon fill="#000000" stroke="#000000" points="369.198,-597.323 379.703,-595.944 370.631,-590.471 369.198,-597.323"/>
</g>
<!-- proc~eigen -->
<g id="proc~~npa_f~~CallsGraph_node49" class="node"><title>proc~eigen</title>
<g id="a_proc~~npa_f~~CallsGraph_node49"><a xlink:href=".././proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="451,-701 397,-701 397,-677 451,-677 451,-701"/>
<text text-anchor="middle" x="424" y="-686.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~npa_f~~CallsGraph_edge60" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M291.701,-585.249C299.955,-590.598 309.039,-597.392 316,-605 337.771,-628.792 326.715,-647.984 352,-668 362,-675.916 374.913,-680.851 386.98,-683.925"/>
<polygon fill="#000000" stroke="#000000" points="386.316,-687.363 396.834,-686.096 387.821,-680.527 386.316,-687.363"/>
</g>
<!-- proc~linsolve -->
<g id="proc~~npa_f~~CallsGraph_node56" class="node"><title>proc~linsolve</title>
<g id="a_proc~~npa_f~~CallsGraph_node56"><a xlink:href=".././proc/linsolve.html" xlink:title="linsolve">
<polygon fill="#d9534f" stroke="#d9534f" points="451,-575 397,-575 397,-551 451,-551 451,-575"/>
<text text-anchor="middle" x="424" y="-560.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linsolve</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~linsolve -->
<g id="proc~~npa_f~~CallsGraph_edge61" class="edge"><title>proc~colrad&#45;&gt;proc~linsolve</title>
<path fill="none" stroke="#000000" d="M296.302,-571.281C321.227,-569.652 358.881,-567.191 386.667,-565.375"/>
<polygon fill="#000000" stroke="#000000" points="387.036,-568.858 396.786,-564.713 386.579,-561.873 387.036,-568.858"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_f~~CallsGraph_edge62" class="edge"><title>proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M297.971,-1206.17C303.979,-1208.95 310.249,-1211.98 316,-1215 343.667,-1229.53 374.159,-1248.03 395.491,-1261.4"/>
<polygon fill="#000000" stroke="#000000" points="393.711,-1264.41 404.037,-1266.78 397.445,-1258.49 393.711,-1264.41"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge63" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.738,-1192.22C370.24,-1190 464.546,-1186.24 521.967,-1183.95"/>
<polygon fill="#000000" stroke="#000000" points="522.389,-1187.44 532.242,-1183.55 522.11,-1180.45 522.389,-1187.44"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_node46" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~npa_f~~CallsGraph_node46"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="603,-335 541,-335 541,-311 603,-311 603,-335"/>
<text text-anchor="middle" x="572" y="-320.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_edge64" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M459.231,-293.909C480.719,-299.502 508.521,-306.738 531.021,-312.594"/>
<polygon fill="#000000" stroke="#000000" points="530.384,-316.045 540.944,-315.177 532.148,-309.271 530.384,-316.045"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~npa_f~~CallsGraph_edge65" class="edge"><title>proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M313.026,-1135.19C330.708,-1130.34 351.361,-1124.67 369.964,-1119.56"/>
<polygon fill="#000000" stroke="#000000" points="371.05,-1122.89 379.767,-1116.87 369.197,-1116.14 371.05,-1122.89"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge66" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M313.126,-1152.01C368.485,-1158.45 464.288,-1169.59 522.241,-1176.33"/>
<polygon fill="#000000" stroke="#000000" points="521.916,-1179.82 532.254,-1177.49 522.725,-1172.86 521.916,-1179.82"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~npa_f~~CallsGraph_edge67" class="edge"><title>proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M399.529,-1117.01C390.984,-1125.97 399.141,-1135 424,-1135 439.149,-1135 448.095,-1131.65 450.839,-1127"/>
<polygon fill="#000000" stroke="#000000" points="454.184,-1125.94 448.471,-1117.01 447.373,-1127.55 454.184,-1125.94"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge68" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M447.812,-1117.03C472.311,-1129.95 511.426,-1150.58 538.996,-1165.12"/>
<polygon fill="#000000" stroke="#000000" points="537.388,-1168.23 547.866,-1169.8 540.653,-1162.04 537.388,-1168.23"/>
</g>
<!-- proc~get_distribution&#45;&gt;proc~get_position -->
<g id="proc~~npa_f~~CallsGraph_edge70" class="edge"><title>proc~get_distribution&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M311.808,-282.093C332.642,-282.638 357.83,-283.296 378.962,-283.849"/>
<polygon fill="#000000" stroke="#000000" points="378.885,-287.348 388.973,-284.11 379.068,-280.35 378.885,-287.348"/>
</g>
<!-- proc~get_distribution&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge69" class="edge"><title>proc~get_distribution&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M297.667,-268.969C343.087,-251.243 434.543,-224.262 496,-264 528.742,-285.17 513.189,-309.848 532,-344 539.292,-357.239 548.588,-371.387 556.276,-382.51"/>
<polygon fill="#000000" stroke="#000000" points="553.418,-384.53 562.027,-390.706 559.148,-380.509 553.418,-384.53"/>
</g>
<!-- interface~interpol -->
<g id="proc~~npa_f~~CallsGraph_node57" class="node"><title>interface~interpol</title>
<g id="a_proc~~npa_f~~CallsGraph_node57"><a xlink:href=".././interface/interpol.html" xlink:title="interpol">
<polygon fill="#a7506f" stroke="#a7506f" points="451,-179 397,-179 397,-155 451,-155 451,-179"/>
<text text-anchor="middle" x="424" y="-164.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol</text>
</a>
</g>
</g>
<!-- proc~get_distribution&#45;&gt;interface~interpol -->
<g id="proc~~npa_f~~CallsGraph_edge71" class="edge"><title>proc~get_distribution&#45;&gt;interface~interpol</title>
<path fill="none" stroke="#000000" d="M296.971,-268.897C303.683,-265.078 310.52,-260.417 316,-255 338.662,-232.6 327.586,-213.476 352,-193 361.979,-184.631 374.888,-178.843 386.957,-174.894"/>
<polygon fill="#000000" stroke="#000000" points="388.21,-178.173 396.814,-171.992 386.233,-171.458 388.21,-178.173"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_f~~CallsGraph_edge72" class="edge"><title>proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M399.529,-1291.01C390.984,-1299.97 399.141,-1309 424,-1309 439.149,-1309 448.095,-1305.65 450.839,-1301"/>
<polygon fill="#000000" stroke="#000000" points="454.184,-1299.94 448.471,-1291.01 447.373,-1301.55 454.184,-1299.94"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge73" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M466.873,-1266.87C476.791,-1263.14 487.072,-1258.53 496,-1253 518.586,-1239.01 540.152,-1217.43 554.312,-1201.73"/>
<polygon fill="#000000" stroke="#000000" points="557.025,-1203.95 561.008,-1194.13 551.772,-1199.32 557.025,-1203.95"/>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge74" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M469.635,-1035.94C479.021,-1039.66 488.376,-1044.57 496,-1051 531.14,-1080.65 553.342,-1131.19 563.834,-1160.06"/>
<polygon fill="#000000" stroke="#000000" points="560.576,-1161.35 567.172,-1169.64 567.186,-1159.04 560.576,-1161.35"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_f~~CallsGraph_edge75" class="edge"><title>proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M297.389,-1345.87C303.549,-1343.04 310.029,-1339.98 316,-1337 342.191,-1323.94 371.362,-1308.04 392.622,-1296.19"/>
<polygon fill="#000000" stroke="#000000" points="394.489,-1299.15 401.506,-1291.21 391.07,-1293.04 394.489,-1299.15"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge76" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.633,-1367.49C363.584,-1375.27 442.309,-1379.78 496,-1343 543.262,-1310.63 561.426,-1240.45 567.835,-1204.39"/>
<polygon fill="#000000" stroke="#000000" points="571.313,-1204.8 569.466,-1194.37 564.404,-1203.68 571.313,-1204.8"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge78" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M454.567,-474.456C467.672,-470.098 483.026,-464.19 496,-457 513.729,-447.175 515.556,-440.852 532,-429 535.74,-426.304 539.735,-423.528 543.689,-420.84"/>
<polygon fill="#000000" stroke="#000000" points="545.806,-423.634 552.163,-415.158 541.908,-417.82 545.806,-423.634"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_node44" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~npa_f~~CallsGraph_node44"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="714.5,-416 649.5,-416 649.5,-392 714.5,-392 714.5,-416"/>
<text text-anchor="middle" x="682" y="-401.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge77" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M454.617,-473.861C500.147,-459.81 587.499,-432.854 639.373,-416.846"/>
<polygon fill="#000000" stroke="#000000" points="640.728,-420.091 649.252,-413.797 638.664,-413.402 640.728,-420.091"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_node58" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~npa_f~~CallsGraph_node58"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="610.5,-659 533.5,-659 533.5,-635 610.5,-635 610.5,-659"/>
<text text-anchor="middle" x="572" y="-644.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_edge79" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M444.042,-495.06C459.716,-505.789 481.621,-522.734 496,-542 520.295,-574.551 504.586,-596.029 532,-626 532.876,-626.958 533.806,-627.88 534.779,-628.768"/>
<polygon fill="#000000" stroke="#000000" points="532.811,-631.669 542.899,-634.907 537.033,-626.085 532.811,-631.669"/>
</g>
<!-- proc~mc_beam_grid&#45;&gt;interface~randu -->
<g id="proc~~npa_f~~CallsGraph_edge80" class="edge"><title>proc~mc_beam_grid&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M300.461,-188.815C305.808,-186.199 311.194,-183.236 316,-180 334.256,-167.709 332.925,-156.977 352,-146 362.685,-139.851 375.329,-135.362 386.964,-132.152"/>
<polygon fill="#000000" stroke="#000000" points="388.019,-135.496 396.855,-129.651 386.302,-128.709 388.019,-135.496"/>
</g>
<!-- proc~my_rank -->
<g id="proc~~npa_f~~CallsGraph_node51" class="node"><title>proc~my_rank</title>
<g id="a_proc~~npa_f~~CallsGraph_node51"><a xlink:href=".././proc/my_rank.html" xlink:title="my_rank">
<polygon fill="#d94e8f" stroke="#d94e8f" points="451,-24 397,-24 397,-0 451,-0 451,-24"/>
<text text-anchor="middle" x="424" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">my_rank</text>
</a>
</g>
</g>
<!-- proc~rng_init&#45;&gt;proc~my_rank -->
<g id="proc~~npa_f~~CallsGraph_edge81" class="edge"><title>proc~rng_init&#45;&gt;proc~my_rank</title>
<path fill="none" stroke="#000000" d="M296.302,-29.39C321.227,-25.9689 358.881,-20.8006 386.667,-16.9869"/>
<polygon fill="#000000" stroke="#000000" points="387.355,-20.4254 396.786,-15.598 386.403,-13.4904 387.355,-20.4254"/>
</g>
<!-- proc~rng_seed -->
<g id="proc~~npa_f~~CallsGraph_node53" class="node"><title>proc~rng_seed</title>
<g id="a_proc~~npa_f~~CallsGraph_node53"><a xlink:href=".././proc/rng_seed.html" xlink:title="rng_seed">
<polygon fill="#d94e8f" stroke="#d94e8f" points="453,-66 395,-66 395,-42 453,-42 453,-66"/>
<text text-anchor="middle" x="424" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rng_seed</text>
</a>
</g>
</g>
<!-- proc~rng_init&#45;&gt;proc~rng_seed -->
<g id="proc~~npa_f~~CallsGraph_edge82" class="edge"><title>proc~rng_init&#45;&gt;proc~rng_seed</title>
<path fill="none" stroke="#000000" d="M296.302,-36.61C320.697,-39.9584 357.285,-44.9803 384.88,-48.7679"/>
<polygon fill="#000000" stroke="#000000" points="384.589,-52.2607 394.972,-50.153 385.541,-45.3257 384.589,-52.2607"/>
</g>
<!-- proc~bb_cx_rates -->
<g id="proc~~npa_f~~CallsGraph_node43" class="node"><title>proc~bb_cx_rates</title>
<g id="a_proc~~npa_f~~CallsGraph_node43"><a xlink:href=".././proc/bb_cx_rates.html" xlink:title="bb_cx_rates">
<polygon fill="#d9534f" stroke="#d9534f" points="459.5,-659 388.5,-659 388.5,-635 459.5,-635 459.5,-659"/>
<text text-anchor="middle" x="424" y="-644.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bb_cx_rates</text>
</a>
</g>
</g>
<!-- proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates -->
<g id="proc~~npa_f~~CallsGraph_edge83" class="edge"><title>proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates</title>
<path fill="none" stroke="#000000" d="M312.619,-631.85C333.042,-634.653 357.503,-638.01 378.201,-640.851"/>
<polygon fill="#000000" stroke="#000000" points="377.95,-644.349 388.333,-642.242 378.902,-637.414 377.95,-644.349"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~npa_f~~CallsGraph_edge85" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M298.193,-354.206C304.311,-351.305 310.571,-347.879 316,-344 334.93,-330.476 332.166,-318.16 352,-306 360.296,-300.914 369.894,-296.999 379.299,-294.008"/>
<polygon fill="#000000" stroke="#000000" points="380.332,-297.353 388.967,-291.215 378.389,-290.628 380.332,-297.353"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge84" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M298.237,-367.844C341.066,-372.249 424.984,-381.239 496,-391 506.288,-392.414 517.343,-394.094 527.72,-395.742"/>
<polygon fill="#000000" stroke="#000000" points="527.389,-399.233 537.818,-397.368 528.502,-392.322 527.389,-399.233"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~npa_f~~CallsGraph_edge86" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M285.797,-377.184C312.596,-397.852 367.133,-439.913 398.782,-464.322"/>
<polygon fill="#000000" stroke="#000000" points="397.003,-467.37 407.059,-470.706 401.278,-461.827 397.003,-467.37"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_edge88" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M298.308,-355.931C304.698,-352.898 311.047,-348.98 316,-344 343.495,-316.356 319.258,-285.17 352,-264 448.443,-201.641 592.402,-270.964 652.767,-305.634"/>
<polygon fill="#000000" stroke="#000000" points="651.319,-308.842 661.717,-310.875 654.856,-302.801 651.319,-308.842"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~npa_f~~CallsGraph_node52" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~npa_f~~CallsGraph_node52"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="474,-339 374,-339 374,-315 474,-315 474,-339"/>
<text text-anchor="middle" x="424" y="-324.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~npa_f~~CallsGraph_edge87" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M298.063,-358.03C316.699,-353.401 341.852,-347.154 364.703,-341.479"/>
<polygon fill="#000000" stroke="#000000" points="365.807,-344.811 374.669,-339.004 364.12,-338.018 365.807,-344.811"/>
</g>
<!-- proc~bb_cx_rates&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_edge89" class="edge"><title>proc~bb_cx_rates&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M459.6,-647C478.572,-647 502.381,-647 523.114,-647"/>
<polygon fill="#000000" stroke="#000000" points="523.32,-650.5 533.32,-647 523.32,-643.5 523.32,-650.5"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_edge91" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M603.084,-323C613.693,-323 625.844,-323 637.346,-323"/>
<polygon fill="#000000" stroke="#000000" points="637.662,-326.5 647.662,-323 637.662,-319.5 637.662,-326.5"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge90" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M589.403,-335.302C607.268,-348.701 636.032,-370.274 656.559,-385.669"/>
<polygon fill="#000000" stroke="#000000" points="654.697,-388.647 664.797,-391.847 658.897,-383.047 654.697,-388.647"/>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_edge92" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M466.838,-617.036C484.47,-622.108 505.088,-628.039 523.306,-633.28"/>
<polygon fill="#000000" stroke="#000000" points="522.568,-636.709 533.146,-636.111 524.504,-629.982 522.568,-636.709"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~npa_f~~CallsGraph_node59" class="node"><title>proc~hqr2</title>
<g id="a_proc~~npa_f~~CallsGraph_node59"><a xlink:href=".././proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-869 545,-869 545,-845 599,-845 599,-869"/>
<text text-anchor="middle" x="572" y="-854.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~npa_f~~CallsGraph_edge93" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M451.121,-690.627C466.114,-692.899 484.239,-698.129 496,-710 536.991,-751.373 495.488,-790.625 532,-836 533.41,-837.752 535.007,-839.379 536.73,-840.884"/>
<polygon fill="#000000" stroke="#000000" points="534.731,-843.758 544.899,-846.734 538.807,-838.067 534.731,-843.758"/>
</g>
<!-- proc~balback -->
<g id="proc~~npa_f~~CallsGraph_node61" class="node"><title>proc~balback</title>
<g id="a_proc~~npa_f~~CallsGraph_node61"><a xlink:href=".././proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-743 545,-743 545,-719 599,-719 599,-743"/>
<text text-anchor="middle" x="572" y="-728.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~npa_f~~CallsGraph_edge94" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M451.102,-696.509C474.418,-703.216 508.802,-713.108 534.778,-720.58"/>
<polygon fill="#000000" stroke="#000000" points="534.054,-724.014 544.632,-723.415 535.989,-717.286 534.054,-724.014"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~npa_f~~CallsGraph_node62" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~npa_f~~CallsGraph_node62"><a xlink:href=".././proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-827 545,-827 545,-803 599,-803 599,-827"/>
<text text-anchor="middle" x="572" y="-812.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~npa_f~~CallsGraph_edge95" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M451.278,-691.301C465.954,-693.818 483.704,-699.068 496,-710 526.355,-736.988 504.586,-764.029 532,-794 533.362,-795.49 534.856,-796.894 536.438,-798.216"/>
<polygon fill="#000000" stroke="#000000" points="534.707,-801.277 544.907,-804.142 538.72,-795.541 534.707,-801.277"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~npa_f~~CallsGraph_node63" class="node"><title>proc~elmhes</title>
<g id="a_proc~~npa_f~~CallsGraph_node63"><a xlink:href=".././proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-785 545,-785 545,-761 599,-761 599,-785"/>
<text text-anchor="middle" x="572" y="-770.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~npa_f~~CallsGraph_edge96" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M451.154,-693.006C465.271,-696.052 482.515,-701.263 496,-710 516.634,-723.368 512.853,-736.578 532,-752 533.527,-753.23 535.137,-754.423 536.798,-755.575"/>
<polygon fill="#000000" stroke="#000000" points="535.052,-758.612 545.382,-760.965 538.774,-752.683 535.052,-758.612"/>
</g>
<!-- proc~balance -->
<g id="proc~~npa_f~~CallsGraph_node65" class="node"><title>proc~balance</title>
<g id="a_proc~~npa_f~~CallsGraph_node65"><a xlink:href=".././proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-701 545,-701 545,-677 599,-677 599,-701"/>
<text text-anchor="middle" x="572" y="-686.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~npa_f~~CallsGraph_edge97" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M451.102,-689C474.314,-689 508.498,-689 534.432,-689"/>
<polygon fill="#000000" stroke="#000000" points="534.632,-692.5 544.632,-689 534.632,-685.5 534.632,-692.5"/>
</g>
<!-- dgetrf -->
<g id="proc~~npa_f~~CallsGraph_node60" class="node"><title>dgetrf</title>
<polygon fill="#777777" stroke="#777777" points="599,-575 545,-575 545,-551 599,-551 599,-575"/>
<text text-anchor="middle" x="572" y="-560.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrf</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrf -->
<g id="proc~~npa_f~~CallsGraph_edge100" class="edge"><title>proc~linsolve&#45;&gt;dgetrf</title>
<path fill="none" stroke="#000000" d="M451.102,-563C474.314,-563 508.498,-563 534.432,-563"/>
<polygon fill="#000000" stroke="#000000" points="534.632,-566.5 544.632,-563 534.632,-559.5 534.632,-566.5"/>
</g>
<!-- proc~matinv -->
<g id="proc~~npa_f~~CallsGraph_node64" class="node"><title>proc~matinv</title>
<g id="a_proc~~npa_f~~CallsGraph_node64"><a xlink:href=".././proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-617 545,-617 545,-593 599,-593 599,-617"/>
<text text-anchor="middle" x="572" y="-602.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~linsolve&#45;&gt;proc~matinv -->
<g id="proc~~npa_f~~CallsGraph_edge98" class="edge"><title>proc~linsolve&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M451.102,-570.509C474.418,-577.216 508.802,-587.108 534.778,-594.58"/>
<polygon fill="#000000" stroke="#000000" points="534.054,-598.014 544.632,-597.415 535.989,-591.286 534.054,-598.014"/>
</g>
<!-- dgetrs -->
<g id="proc~~npa_f~~CallsGraph_node66" class="node"><title>dgetrs</title>
<polygon fill="#777777" stroke="#777777" points="599,-533 545,-533 545,-509 599,-509 599,-533"/>
<text text-anchor="middle" x="572" y="-518.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrs</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrs -->
<g id="proc~~npa_f~~CallsGraph_edge99" class="edge"><title>proc~linsolve&#45;&gt;dgetrs</title>
<path fill="none" stroke="#000000" d="M451.102,-555.491C474.418,-548.784 508.802,-538.892 534.778,-531.42"/>
<polygon fill="#000000" stroke="#000000" points="535.989,-534.714 544.632,-528.585 534.054,-527.986 535.989,-534.714"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~npa_f~~CallsGraph_node67" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~npa_f~~CallsGraph_node67"><a xlink:href=".././proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-869 655,-869 655,-845 709,-845 709,-869"/>
<text text-anchor="middle" x="682" y="-854.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~npa_f~~CallsGraph_edge101" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M599.144,-857C612.707,-857 629.499,-857 644.338,-857"/>
<polygon fill="#000000" stroke="#000000" points="644.723,-860.5 654.723,-857 644.723,-853.5 644.723,-860.5"/>
</g>
<!-- proc~rswap -->
<g id="proc~~npa_f~~CallsGraph_node70" class="node"><title>proc~rswap</title>
<g id="a_proc~~npa_f~~CallsGraph_node70"><a xlink:href=".././proc/rswap.html" xlink:title="RSWAP">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-743 655,-743 655,-719 709,-719 709,-743"/>
<text text-anchor="middle" x="682" y="-728.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RSWAP</text>
</a>
</g>
</g>
<!-- proc~balback&#45;&gt;proc~rswap -->
<g id="proc~~npa_f~~CallsGraph_edge102" class="edge"><title>proc~balback&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M599.144,-731C612.707,-731 629.499,-731 644.338,-731"/>
<polygon fill="#000000" stroke="#000000" points="644.723,-734.5 654.723,-731 644.723,-727.5 644.723,-734.5"/>
</g>
<!-- proc~elmhes&#45;&gt;proc~rswap -->
<g id="proc~~npa_f~~CallsGraph_edge103" class="edge"><title>proc~elmhes&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M599.144,-762.833C612.971,-757.456 630.153,-750.774 645.2,-744.922"/>
<polygon fill="#000000" stroke="#000000" points="646.671,-748.106 654.723,-741.219 644.134,-741.581 646.671,-748.106"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~npa_f~~CallsGraph_node68" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~npa_f~~CallsGraph_node68"><a xlink:href=".././proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-638 655,-638 655,-614 709,-614 709,-638"/>
<text text-anchor="middle" x="682" y="-623.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~npa_f~~CallsGraph_edge104" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M599.144,-610.084C612.839,-612.746 629.826,-616.049 644.769,-618.955"/>
<polygon fill="#000000" stroke="#000000" points="644.238,-622.417 654.723,-620.891 645.575,-615.546 644.238,-622.417"/>
</g>
<!-- proc~lubksb -->
<g id="proc~~npa_f~~CallsGraph_node69" class="node"><title>proc~lubksb</title>
<g id="a_proc~~npa_f~~CallsGraph_node69"><a xlink:href=".././proc/lubksb.html" xlink:title="lubksb">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-596 655,-596 655,-572 709,-572 709,-596"/>
<text text-anchor="middle" x="682" y="-581.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lubksb</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~lubksb -->
<g id="proc~~npa_f~~CallsGraph_edge105" class="edge"><title>proc~matinv&#45;&gt;proc~lubksb</title>
<path fill="none" stroke="#000000" d="M599.144,-599.916C612.839,-597.254 629.826,-593.951 644.769,-591.045"/>
<polygon fill="#000000" stroke="#000000" points="645.575,-594.454 654.723,-589.109 644.238,-587.583 645.575,-594.454"/>
</g>
<!-- proc~balance&#45;&gt;proc~rswap -->
<g id="proc~~npa_f~~CallsGraph_edge106" class="edge"><title>proc~balance&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M599.144,-699.167C612.971,-704.544 630.153,-711.226 645.2,-717.078"/>
<polygon fill="#000000" stroke="#000000" points="644.134,-720.419 654.723,-720.781 646.671,-713.894 644.134,-720.419"/>
</g>
<!-- proc~comdiv -->
<g id="proc~~npa_f~~CallsGraph_node73" class="node"><title>proc~comdiv</title>
<g id="a_proc~~npa_f~~CallsGraph_node73"><a xlink:href=".././proc/comdiv.html" xlink:title="Comdiv">
<polygon fill="#d9534f" stroke="#d9534f" points="809,-869 755,-869 755,-845 809,-845 809,-869"/>
<text text-anchor="middle" x="782" y="-854.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Comdiv</text>
</a>
</g>
</g>
<!-- proc~hqrvec&#45;&gt;proc~comdiv -->
<g id="proc~~npa_f~~CallsGraph_edge107" class="edge"><title>proc~hqrvec&#45;&gt;proc~comdiv</title>
<path fill="none" stroke="#000000" d="M709.005,-857C719.969,-857 732.92,-857 744.794,-857"/>
<polygon fill="#000000" stroke="#000000" points="744.874,-860.5 754.874,-857 744.874,-853.5 744.874,-860.5"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~npa_f~~CallsGraph_node71" class="node"><title>proc~outerprod</title>
<g id="a_proc~~npa_f~~CallsGraph_node71"><a xlink:href=".././proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="811.5,-617 752.5,-617 752.5,-593 811.5,-593 811.5,-617"/>
<text text-anchor="middle" x="782" y="-602.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~npa_f~~CallsGraph_edge109" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M709.005,-620.428C719.251,-618.232 731.231,-615.665 742.446,-613.261"/>
<polygon fill="#000000" stroke="#000000" points="743.414,-616.634 752.459,-611.116 741.947,-609.789 743.414,-616.634"/>
</g>
<!-- proc~swap -->
<g id="proc~~npa_f~~CallsGraph_node72" class="node"><title>proc~swap</title>
<g id="a_proc~~npa_f~~CallsGraph_node72"><a xlink:href=".././proc/swap.html" xlink:title="swap">
<polygon fill="#d9534f" stroke="#d9534f" points="809,-659 755,-659 755,-635 809,-635 809,-659"/>
<text text-anchor="middle" x="782" y="-644.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swap</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~swap -->
<g id="proc~~npa_f~~CallsGraph_edge108" class="edge"><title>proc~ludcmp&#45;&gt;proc~swap</title>
<path fill="none" stroke="#000000" d="M709.005,-631.572C719.969,-633.922 732.92,-636.697 744.794,-639.242"/>
<polygon fill="#000000" stroke="#000000" points="744.362,-642.728 754.874,-641.401 745.829,-635.884 744.362,-642.728"/>
</g>
</g>
</svg>
</div><script>var panprocnpa_fCallsGraph = svgPanZoom('#procnpa_fCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~npa_f~~CalledByGraph Pages: 1 -->
<svg id="procnpa_fCalledByGraph" width="152pt" height="32pt"
 viewBox="0.00 0.00 152.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~npa_f~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~npa_f~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 148,-28 148,4 -4,4"/>
<!-- proc~npa_f -->
<g id="proc~~npa_f~~CalledByGraph_node1" class="node"><title>proc~npa_f</title>
<polygon fill="none" stroke="black" points="144,-24 90,-24 90,-0 144,-0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">npa_f</text>
</g>
<!-- program~fidasim -->
<g id="proc~~npa_f~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~npa_f~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_f -->
<g id="proc~~npa_f~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~npa_f</title>
<path fill="none" stroke="#000000" d="M54.4029,-12C62.3932,-12 71.3106,-12 79.8241,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.919,-15.5001 89.919,-12 79.919,-8.5001 79.919,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/npa_f.html#src">npa_f</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">npa_f</span><span class="w"></span>
<span class="w">    </span><span class="c">!+ Calculate Active NPA flux using a fast-ion distribution function F(E,p,r,z)</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">det</span><span class="p">,</span><span class="n">ic</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iion</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rg</span><span class="p">,</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ind</span><span class="p">,</span><span class="n">pind</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">denf</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">plasma</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fields</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">GyroSurface</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">gs</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">gyrange</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">neut_types</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rates</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">states</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">flux</span><span class="p">,</span><span class="w"> </span><span class="n">theta</span><span class="p">,</span><span class="w"> </span><span class="n">dtheta</span><span class="p">,</span><span class="w"> </span><span class="n">eb</span><span class="p">,</span><span class="w"> </span><span class="n">ptch</span><span class="w"></span>

<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">inpa</span><span class="p">,</span><span class="n">ichan</span><span class="p">,</span><span class="n">nrange</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">npart</span><span class="p">,</span><span class="n">ncell</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cell_ind</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nx</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ny</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nz</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">papprox</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nx</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ny</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nz</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nlaunch</span><span class="w"></span>

<span class="w">    </span><span class="n">papprox</span><span class="o">=</span><span class="mf">0.d0</span><span class="w"></span>
<span class="w">    </span><span class="k">do </span><span class="n">ic</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">ind2sub</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">ic</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">ind</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">plasma</span><span class="p">%</span><span class="n">in_plasma</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="k">        </span><span class="n">papprox</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                        </span><span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">half</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                        </span><span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">third</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                        </span><span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">dcx</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                        </span><span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">halo</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span><span class="o">*</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                        </span><span class="n">plasma</span><span class="p">%</span><span class="n">denf</span><span class="w"></span>
<span class="w">    </span><span class="k">enddo</span>

<span class="k">    </span><span class="n">ncell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">    </span><span class="k">do </span><span class="n">ic</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">ind2sub</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">ic</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">papprox</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">ncell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ncell</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">cell_ind</span><span class="p">(</span><span class="n">ncell</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ic</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">    enddo</span>

<span class="k">    call </span><span class="n">get_nlaunch</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_npa</span><span class="p">,</span><span class="w"> </span><span class="n">papprox</span><span class="p">,</span><span class="w"> </span><span class="n">nlaunch</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i12)&#39;</span><span class="p">)</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">nlaunch</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span><span class="w"></span>

<span class="w">    </span><span class="c">!! Loop over all cells that can contribute to NPA signal</span>
<span class="w">    </span><span class="c">!$OMP PARALLEL DO schedule(dynamic,1) private(ic,i,j,k,ind,iion,ichan,fields,nrange,gyrange, &amp;</span>
<span class="w">    </span><span class="c">!$OMP&amp; pind,vi,ri,rf,det,plasma,rates,states,flux,denf,eb,ptch,gs,ir,theta,dtheta)</span>
<span class="w">    </span><span class="n">loop_over_cells</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">ic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">istart</span><span class="p">,</span><span class="w"> </span><span class="n">ncell</span><span class="p">,</span><span class="w"> </span><span class="n">istep</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">ind2sub</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">cell_ind</span><span class="p">(</span><span class="n">ic</span><span class="p">),</span><span class="n">ind</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">loop_over_fast_ions</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">iion</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="c">!! Sample fast ion distribution for energy and pitch</span>
<span class="w">            </span><span class="k">call </span><span class="n">mc_fastion</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="w"> </span><span class="n">fields</span><span class="p">,</span><span class="w"> </span><span class="n">eb</span><span class="p">,</span><span class="w"> </span><span class="n">ptch</span><span class="p">,</span><span class="w"> </span><span class="n">denf</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">denf</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">loop_over_fast_ions</span><span class="w"></span>

<span class="w">            </span><span class="k">call </span><span class="n">gyro_surface</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span><span class="w"> </span><span class="n">eb</span><span class="p">,</span><span class="w"> </span><span class="n">ptch</span><span class="p">,</span><span class="w"> </span><span class="n">fbm</span><span class="p">%</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">gs</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">detector_loop</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">ichan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">npa_chords</span><span class="p">%</span><span class="n">nchan</span><span class="w"></span>
<span class="w">                </span><span class="k">call </span><span class="n">npa_gyro_range</span><span class="p">(</span><span class="n">ichan</span><span class="p">,</span><span class="w"> </span><span class="n">gs</span><span class="p">,</span><span class="w"> </span><span class="n">gyrange</span><span class="p">,</span><span class="w"> </span><span class="n">nrange</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="n">nrange</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">detector_loop</span><span class="w"></span>
<span class="w">                </span><span class="n">gyro_range_loop</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">ir</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nrange</span><span class="w"></span>
<span class="w">                    </span><span class="n">dtheta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gyrange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="n">theta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gyrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="n">dtheta</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">gyro_trajectory</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span><span class="w"> </span><span class="n">theta</span><span class="p">,</span><span class="w"> </span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="c">!! Check if particle hits a NPA detector</span>
<span class="w">                    </span><span class="k">call </span><span class="n">hit_npa_detector</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="w"> </span><span class="p">,</span><span class="n">det</span><span class="p">,</span><span class="w"> </span><span class="n">rf</span><span class="p">,</span><span class="w"> </span><span class="n">ichan</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="n">det</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">ichan</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        if</span><span class="w"> </span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="k">                            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;NPA_F: Missed Detector &quot;</span><span class="p">,</span><span class="n">ichan</span><span class="w"></span>
<span class="w">                        </span><span class="k">endif</span>
<span class="k">                        cycle </span><span class="n">gyro_range_loop</span><span class="w"></span>
<span class="w">                    </span><span class="k">endif</span><span class="w"></span>

<span class="w">                    </span><span class="c">!! Get beam grid indices at ri</span>
<span class="w">                    </span><span class="k">call </span><span class="n">get_indices</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">pind</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="c">!! Calculate CX probability with beam and halo neutrals</span>
<span class="w">                    </span><span class="k">call </span><span class="n">get_total_cx_rate</span><span class="p">(</span><span class="n">pind</span><span class="p">,</span><span class="w"> </span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="p">,</span><span class="w"> </span><span class="n">neut_types</span><span class="p">,</span><span class="w"> </span><span class="n">rates</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">gyro_range_loop</span><span class="w"></span>

<span class="w">                    </span><span class="c">!! Weight CX rates by ion source density</span>
<span class="w">                    </span><span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">denf</span><span class="w"></span>

<span class="w">                    </span><span class="c">!! Attenuate states as the particle move through plasma</span>
<span class="w">                    </span><span class="k">call </span><span class="n">attenuate</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">states</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="c">!! Store NPA Flux</span>
<span class="w">                    </span><span class="n">flux</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dtheta</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="o">*</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="o">/</span><span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">store_npa</span><span class="p">(</span><span class="n">det</span><span class="p">,</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">flux</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">enddo </span><span class="n">gyro_range_loop</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo </span><span class="n">detector_loop</span><span class="w"></span>
<span class="w">        </span><span class="k">enddo </span><span class="n">loop_over_fast_ions</span><span class="w"></span>
<span class="w">    </span><span class="k">enddo </span><span class="n">loop_over_cells</span><span class="w"></span>
<span class="w">    </span><span class="c">!$OMP END PARALLEL DO</span>

<span class="w">    </span><span class="n">npart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">npa</span><span class="p">%</span><span class="n">npart</span><span class="w"></span>
<span class="cp">#ifdef _MPI</span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">npart</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">npa</span><span class="p">%</span><span class="n">flux</span><span class="p">)</span><span class="w"></span>
<span class="cp">#endif</span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T4,&quot;Number of Active NPA particles that hit a detector: &quot;,i8)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">npart</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">end subroutine </span><span class="n">npa_f</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>