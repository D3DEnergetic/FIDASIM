<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>npa_f &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>npa_f
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.6% of total for procedures.">84 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
    
     <li><a href='../module/libfida.html'>libfida</a></li>
    
  
     <li class="active">npa_f</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/npa_f.html#src">npa_f</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine npa_f()
    
    
   
</h2>
    
  


    
    <p>Calculate Active NPA flux using a fast-ion distribution function F(E,p,r,z)</p>
    

    <h3>Arguments</h3>
    
    <em>None</em>
    <br>
    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~npa_f~~CallsGraph Pages: 1 -->
<svg id="procnpa_fCallsGraph" width="641pt" height="994pt"
 viewBox="0.00 0.00 641.00 993.63" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~npa_f~~CallsGraph" class="graph" transform="scale(0.783619 0.783619) rotate(0) translate(4 1264)">
<title>proc~~npa_f~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1264 814,-1264 814,4 -4,4"/>
<!-- proc~npa_f -->
<g id="proc~~npa_f~~CallsGraph_node1" class="node"><title>proc~npa_f</title>
<polygon fill="none" stroke="black" points="54,-436 0,-436 0,-412 54,-412 54,-436"/>
<text text-anchor="middle" x="27" y="-421.6" font-family="Helvetica,sans-Serif" font-size="10.50">npa_f</text>
</g>
<!-- proc~gyro_surface -->
<g id="proc~~npa_f~~CallsGraph_node2" class="node"><title>proc~gyro_surface</title>
<g id="a_proc~~npa_f~~CallsGraph_node2"><a xlink:href=".././proc/gyro_surface.html" xlink:title="gyro_surface">
<polygon fill="#d9534f" stroke="#d9534f" points="175.5,-1071 100.5,-1071 100.5,-1047 175.5,-1047 175.5,-1071"/>
<text text-anchor="middle" x="138" y="-1056.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_surface</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~gyro_surface -->
<g id="proc~~npa_f~~CallsGraph_edge1" class="edge"><title>proc~npa_f&#45;&gt;proc~gyro_surface</title>
<path fill="none" stroke="#000000" d="M28.5039,-436.22C31.9815,-518.275 53.3752,-987.303 90,-1038 90.7654,-1039.06 91.5968,-1040.07 92.484,-1041.02"/>
<polygon fill="#000000" stroke="#000000" points="90.2797,-1043.74 100.214,-1047.42 94.7439,-1038.35 90.2797,-1043.74"/>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~npa_f~~CallsGraph_node3" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~npa_f~~CallsGraph_node3"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="174.5,-1029 101.5,-1029 101.5,-1005 174.5,-1005 174.5,-1029"/>
<text text-anchor="middle" x="138" y="-1014.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;interface~parallel_sum -->
<g id="proc~~npa_f~~CallsGraph_edge2" class="edge"><title>proc~npa_f&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M30.2267,-436.114C43.7593,-509.736 114.978,-897.194 132.903,-994.709"/>
<polygon fill="#000000" stroke="#000000" points="129.481,-995.454 134.731,-1004.66 136.366,-994.189 129.481,-995.454"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~npa_f~~CallsGraph_node4" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~npa_f~~CallsGraph_node4"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-676 235,-676 235,-652 303,-652 303,-676"/>
<text text-anchor="middle" x="269" y="-661.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~get_plasma -->
<g id="proc~~npa_f~~CallsGraph_edge3" class="edge"><title>proc~npa_f&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M36.1332,-436.261C47.3691,-452.826 68.6781,-482.934 90,-506 140.895,-561.058 209.068,-617.445 244.456,-645.616"/>
<polygon fill="#000000" stroke="#000000" points="242.296,-648.37 252.309,-651.832 246.641,-642.881 242.296,-648.37"/>
</g>
<!-- proc~hit_npa_detector -->
<g id="proc~~npa_f~~CallsGraph_node5" class="node"><title>proc~hit_npa_detector</title>
<g id="a_proc~~npa_f~~CallsGraph_node5"><a xlink:href=".././proc/hit_npa_detector.html" xlink:title="hit_npa_detector">
<polygon fill="#d9534f" stroke="#d9534f" points="315.5,-318 222.5,-318 222.5,-294 315.5,-294 315.5,-318"/>
<text text-anchor="middle" x="269" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hit_npa_detector</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~hit_npa_detector -->
<g id="proc~~npa_f~~CallsGraph_edge4" class="edge"><title>proc~npa_f&#45;&gt;proc~hit_npa_detector</title>
<path fill="none" stroke="#000000" d="M54.0386,-414.892C95.8231,-400.186 174.359,-372.132 186,-365 204.508,-353.661 204.439,-344.756 222,-332 226.161,-328.978 230.706,-326.032 235.266,-323.275"/>
<polygon fill="#000000" stroke="#000000" points="237.065,-326.278 243.96,-318.233 233.553,-320.222 237.065,-326.278"/>
</g>
<!-- proc~gyro_trajectory -->
<g id="proc~~npa_f~~CallsGraph_node6" class="node"><title>proc~gyro_trajectory</title>
<g id="a_proc~~npa_f~~CallsGraph_node6"><a xlink:href=".././proc/gyro_trajectory.html" xlink:title="gyro_trajectory">
<polygon fill="#d9534f" stroke="#d9534f" points="180,-314 96,-314 96,-290 180,-290 180,-314"/>
<text text-anchor="middle" x="138" y="-299.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_trajectory</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~gyro_trajectory -->
<g id="proc~~npa_f~~CallsGraph_edge5" class="edge"><title>proc~npa_f&#45;&gt;proc~gyro_trajectory</title>
<path fill="none" stroke="#000000" d="M32.6453,-411.807C41.117,-391.023 60.9252,-348.512 90,-323 91.3393,-321.825 92.7551,-320.705 94.2274,-319.64"/>
<polygon fill="#000000" stroke="#000000" points="96.4799,-322.362 103.137,-314.119 92.7928,-316.411 96.4799,-322.362"/>
</g>
<!-- proc~get_total_cx_rate -->
<g id="proc~~npa_f~~CallsGraph_node7" class="node"><title>proc~get_total_cx_rate</title>
<g id="a_proc~~npa_f~~CallsGraph_node7"><a xlink:href=".././proc/get_total_cx_rate.html" xlink:title="get_total_cx_rate">
<polygon fill="#d9534f" stroke="#d9534f" points="185.5,-738 90.5,-738 90.5,-714 185.5,-714 185.5,-738"/>
<text text-anchor="middle" x="138" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_total_cx_rate</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~get_total_cx_rate -->
<g id="proc~~npa_f~~CallsGraph_edge6" class="edge"><title>proc~npa_f&#45;&gt;proc~get_total_cx_rate</title>
<path fill="none" stroke="#000000" d="M28.3084,-436.154C29.808,-475.206 38.5919,-599.886 90,-685 95.0979,-693.44 102.516,-701.064 109.959,-707.383"/>
<polygon fill="#000000" stroke="#000000" points="107.925,-710.237 117.936,-713.706 112.273,-704.752 107.925,-710.237"/>
</g>
<!-- proc~attenuate -->
<g id="proc~~npa_f~~CallsGraph_node8" class="node"><title>proc~attenuate</title>
<g id="a_proc~~npa_f~~CallsGraph_node8"><a xlink:href=".././proc/attenuate.html" xlink:title="attenuate">
<polygon fill="#d9534f" stroke="#d9534f" points="167,-676 109,-676 109,-652 167,-652 167,-676"/>
<text text-anchor="middle" x="138" y="-661.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">attenuate</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~attenuate -->
<g id="proc~~npa_f~~CallsGraph_edge7" class="edge"><title>proc~npa_f&#45;&gt;proc~attenuate</title>
<path fill="none" stroke="#000000" d="M32.319,-436.279C41.7697,-462.783 65.4118,-527.149 90,-579 100.57,-601.289 114.407,-625.861 124.326,-642.828"/>
<polygon fill="#000000" stroke="#000000" points="121.562,-645.031 129.659,-651.864 127.591,-641.473 121.562,-645.031"/>
</g>
<!-- proc~ind2sub -->
<g id="proc~~npa_f~~CallsGraph_node9" class="node"><title>proc~ind2sub</title>
<g id="a_proc~~npa_f~~CallsGraph_node9"><a xlink:href=".././proc/ind2sub.html" xlink:title="ind2sub">
<polygon fill="#d9534f" stroke="#d9534f" points="165,-272 111,-272 111,-248 165,-248 165,-272"/>
<text text-anchor="middle" x="138" y="-257.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ind2sub</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~ind2sub -->
<g id="proc~~npa_f~~CallsGraph_edge8" class="edge"><title>proc~npa_f&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M30.1395,-411.989C35.5092,-385.115 51.9451,-319.479 90,-281 93.4328,-277.529 97.5406,-274.583 101.879,-272.096"/>
<polygon fill="#000000" stroke="#000000" points="103.545,-275.177 110.966,-267.615 100.449,-268.899 103.545,-275.177"/>
</g>
<!-- proc~npa_gyro_range -->
<g id="proc~~npa_f~~CallsGraph_node10" class="node"><title>proc~npa_gyro_range</title>
<g id="a_proc~~npa_f~~CallsGraph_node10"><a xlink:href=".././proc/npa_gyro_range.html" xlink:title="npa_gyro_range">
<polygon fill="#d9534f" stroke="#d9534f" points="183.5,-356 92.5,-356 92.5,-332 183.5,-332 183.5,-356"/>
<text text-anchor="middle" x="138" y="-341.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_gyro_range</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~npa_gyro_range -->
<g id="proc~~npa_f~~CallsGraph_edge9" class="edge"><title>proc~npa_f&#45;&gt;proc~npa_gyro_range</title>
<path fill="none" stroke="#000000" d="M40.6408,-411.565C52.7271,-400.031 71.76,-382.773 90,-370 94.3753,-366.936 99.1458,-363.941 103.915,-361.139"/>
<polygon fill="#000000" stroke="#000000" points="105.997,-363.983 112.983,-356.017 102.554,-357.888 105.997,-363.983"/>
</g>
<!-- proc~store_npa -->
<g id="proc~~npa_f~~CallsGraph_node11" class="node"><title>proc~store_npa</title>
<g id="a_proc~~npa_f~~CallsGraph_node11"><a xlink:href=".././proc/store_npa.html" xlink:title="store_npa">
<polygon fill="#d9534f" stroke="#d9534f" points="168.5,-436 107.5,-436 107.5,-412 168.5,-412 168.5,-436"/>
<text text-anchor="middle" x="138" y="-421.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_npa</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~store_npa -->
<g id="proc~~npa_f~~CallsGraph_edge10" class="edge"><title>proc~npa_f&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M54.1082,-424C66.9811,-424 82.786,-424 97.1305,-424"/>
<polygon fill="#000000" stroke="#000000" points="97.2547,-427.5 107.255,-424 97.2546,-420.5 97.2547,-427.5"/>
</g>
<!-- proc~mc_fastion -->
<g id="proc~~npa_f~~CallsGraph_node12" class="node"><title>proc~mc_fastion</title>
<g id="a_proc~~npa_f~~CallsGraph_node12"><a xlink:href=".././proc/mc_fastion.html" xlink:title="mc_fastion">
<polygon fill="#d9534f" stroke="#d9534f" points="170,-497 106,-497 106,-473 170,-473 170,-497"/>
<text text-anchor="middle" x="138" y="-482.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_fastion</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~mc_fastion -->
<g id="proc~~npa_f~~CallsGraph_edge11" class="edge"><title>proc~npa_f&#45;&gt;proc~mc_fastion</title>
<path fill="none" stroke="#000000" d="M49.5349,-436.052C65.8076,-445.158 88.3608,-457.78 106.49,-467.925"/>
<polygon fill="#000000" stroke="#000000" points="105.074,-471.144 115.51,-472.973 108.493,-465.036 105.074,-471.144"/>
</g>
<!-- proc~get_nlaunch -->
<g id="proc~~npa_f~~CallsGraph_node13" class="node"><title>proc~get_nlaunch</title>
<g id="a_proc~~npa_f~~CallsGraph_node13"><a xlink:href=".././proc/get_nlaunch.html" xlink:title="get_nlaunch">
<polygon fill="#d9534f" stroke="#d9534f" points="173.5,-119 102.5,-119 102.5,-95 173.5,-95 173.5,-119"/>
<text text-anchor="middle" x="138" y="-104.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_nlaunch</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~get_nlaunch -->
<g id="proc~~npa_f~~CallsGraph_edge12" class="edge"><title>proc~npa_f&#45;&gt;proc~get_nlaunch</title>
<path fill="none" stroke="#000000" d="M31.9841,-411.852C41.715,-382.239 67.5409,-303.993 90,-239 103.407,-200.201 119.561,-155.197 129.015,-129.027"/>
<polygon fill="#000000" stroke="#000000" points="132.406,-129.942 132.517,-119.348 125.823,-127.561 132.406,-129.942"/>
</g>
<!-- proc~get_indices -->
<g id="proc~~npa_f~~CallsGraph_node14" class="node"><title>proc~get_indices</title>
<g id="a_proc~~npa_f~~CallsGraph_node14"><a xlink:href=".././proc/get_indices.html" xlink:title="get_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="171.5,-77 104.5,-77 104.5,-53 171.5,-53 171.5,-77"/>
<text text-anchor="middle" x="138" y="-62.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_indices</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~get_indices -->
<g id="proc~~npa_f~~CallsGraph_edge13" class="edge"><title>proc~npa_f&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M28.7289,-411.939C32.2102,-357.916 48.7159,-138.539 90,-86 91.6428,-83.9094 93.5384,-82.0211 95.6061,-80.3163"/>
<polygon fill="#000000" stroke="#000000" points="97.8387,-83.0366 104.262,-74.6108 93.9862,-77.1921 97.8387,-83.0366"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~npa_f~~CallsGraph_node15" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~npa_f~~CallsGraph_node15"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-1260 225,-1260 225,-1236 313,-1236 313,-1260"/>
<text text-anchor="middle" x="269" y="-1245.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~npa_f~~CallsGraph_edge15" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.55,-1028.24C178.898,-1030.86 182.894,-1034.08 186,-1038 239.061,-1105.06 169.21,-1159.73 222,-1227 222.593,-1227.76 223.219,-1228.48 223.874,-1229.19"/>
<polygon fill="#000000" stroke="#000000" points="221.912,-1232.11 231.843,-1235.8 226.381,-1226.72 221.912,-1232.11"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~npa_f~~CallsGraph_node21" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~npa_f~~CallsGraph_node21"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1218 223.5,-1218 223.5,-1194 314.5,-1194 314.5,-1218"/>
<text text-anchor="middle" x="269" y="-1203.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~npa_f~~CallsGraph_edge17" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.833,-1028.67C179.029,-1031.22 182.908,-1034.29 186,-1038 229.095,-1089.65 179.114,-1133.18 222,-1185 222.728,-1185.88 223.5,-1186.72 224.311,-1187.53"/>
<polygon fill="#000000" stroke="#000000" points="222.443,-1190.52 232.468,-1193.95 226.77,-1185.01 222.443,-1190.52"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~npa_f~~CallsGraph_node25" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~npa_f~~CallsGraph_node25"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1176 223.5,-1176 223.5,-1152 314.5,-1152 314.5,-1176"/>
<text text-anchor="middle" x="269" y="-1161.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~npa_f~~CallsGraph_edge16" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.527,-1028.94C178.771,-1031.44 182.744,-1034.44 186,-1038 219.281,-1074.42 188.866,-1106.45 222,-1143 222.895,-1143.99 223.847,-1144.93 224.844,-1145.84"/>
<polygon fill="#000000" stroke="#000000" points="223.087,-1148.89 233.224,-1151.97 227.222,-1143.24 223.087,-1148.89"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~npa_f~~CallsGraph_node26" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~npa_f~~CallsGraph_node26"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1134 223.5,-1134 223.5,-1110 314.5,-1110 314.5,-1134"/>
<text text-anchor="middle" x="269" y="-1119.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~npa_f~~CallsGraph_edge18" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M172.96,-1029.01C177.644,-1031.54 182.158,-1034.52 186,-1038 209.903,-1059.65 198.184,-1079.26 222,-1101 223.293,-1102.18 224.663,-1103.3 226.091,-1104.37"/>
<polygon fill="#000000" stroke="#000000" points="224.449,-1107.48 234.762,-1109.91 228.215,-1101.58 224.449,-1107.48"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~npa_f~~CallsGraph_node27" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~npa_f~~CallsGraph_node27"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-1092 225,-1092 225,-1068 313,-1068 313,-1092"/>
<text text-anchor="middle" x="269" y="-1077.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~npa_f~~CallsGraph_edge19" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M167.567,-1029.17C173.707,-1031.95 180.116,-1034.98 186,-1038 202.48,-1046.46 205.554,-1050.48 222,-1059 224.884,-1060.49 227.895,-1062 230.936,-1063.47"/>
<polygon fill="#000000" stroke="#000000" points="229.518,-1066.67 240.054,-1067.78 232.51,-1060.34 229.518,-1066.67"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~npa_f~~CallsGraph_node30" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~npa_f~~CallsGraph_node30"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1050 223.5,-1050 223.5,-1026 314.5,-1026 314.5,-1050"/>
<text text-anchor="middle" x="269" y="-1035.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_f~~CallsGraph_edge20" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.591,-1022.79C186.596,-1024.75 200.285,-1026.98 213.413,-1029.11"/>
<polygon fill="#000000" stroke="#000000" points="212.872,-1032.57 223.305,-1030.72 213.997,-1025.66 212.872,-1032.57"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~npa_f~~CallsGraph_node31" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~npa_f~~CallsGraph_node31"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-1008 225,-1008 225,-984 313,-984 313,-1008"/>
<text text-anchor="middle" x="269" y="-993.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~npa_f~~CallsGraph_edge23" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.591,-1011.21C186.952,-1009.19 201.1,-1006.89 214.581,-1004.7"/>
<polygon fill="#000000" stroke="#000000" points="215.412,-1008.11 224.72,-1003.05 214.287,-1001.2 215.412,-1008.11"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~npa_f~~CallsGraph_node32" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~npa_f~~CallsGraph_node32"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-966 223.5,-966 223.5,-942 314.5,-942 314.5,-966"/>
<text text-anchor="middle" x="269" y="-951.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~npa_f~~CallsGraph_edge14" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M162.131,-1004.98C178.712,-996.443 201.625,-984.801 222,-975 225.182,-973.469 228.499,-971.901 231.831,-970.346"/>
<polygon fill="#000000" stroke="#000000" points="233.55,-973.407 241.159,-966.034 230.613,-967.053 233.55,-973.407"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~npa_f~~CallsGraph_node36" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~npa_f~~CallsGraph_node36"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-924 225,-924 225,-900 313,-900 313,-924"/>
<text text-anchor="middle" x="269" y="-909.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~npa_f~~CallsGraph_edge21" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M148.604,-1004.77C163.005,-987.077 191.749,-954.135 222,-933 224.078,-931.548 226.272,-930.157 228.531,-928.83"/>
<polygon fill="#000000" stroke="#000000" points="230.287,-931.86 237.445,-924.048 226.978,-925.691 230.287,-931.86"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~npa_f~~CallsGraph_node37" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~npa_f~~CallsGraph_node37"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-882 223.5,-882 223.5,-858 314.5,-858 314.5,-882"/>
<text text-anchor="middle" x="269" y="-867.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~npa_f~~CallsGraph_edge22" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M144.115,-1004.98C155.069,-980.515 183.007,-924.399 222,-891 223.5,-889.715 225.092,-888.494 226.748,-887.335"/>
<polygon fill="#000000" stroke="#000000" points="228.706,-890.241 235.431,-882.054 225.068,-884.26 228.706,-890.241"/>
</g>
<!-- proc~get_position -->
<g id="proc~~npa_f~~CallsGraph_node19" class="node"><title>proc~get_position</title>
<g id="a_proc~~npa_f~~CallsGraph_node19"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="459,-718 389,-718 389,-694 459,-694 459,-718"/>
<text text-anchor="middle" x="424" y="-703.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~npa_f~~CallsGraph_edge26" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M303.199,-673.113C325.445,-679.22 354.977,-687.327 379.152,-693.963"/>
<polygon fill="#000000" stroke="#000000" points="378.237,-697.341 388.807,-696.614 380.09,-690.591 378.237,-697.341"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_node22" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~npa_f~~CallsGraph_node22"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="714,-718 646,-718 646,-694 714,-694 714,-718"/>
<text text-anchor="middle" x="680" y="-703.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_edge24" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M280.746,-676.157C295.17,-691.457 322.423,-716.95 352,-727 460.57,-763.891 496.582,-743.877 610,-727 618.819,-725.688 628.07,-723.481 636.83,-720.979"/>
<polygon fill="#000000" stroke="#000000" points="637.908,-724.309 646.464,-718.06 635.878,-717.61 637.908,-724.309"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_node39" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~npa_f~~CallsGraph_node39"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="605,-556 537,-556 537,-532 605,-532 605,-556"/>
<text text-anchor="middle" x="571" y="-541.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge25" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M303.444,-655.367C365.815,-639.253 493.816,-606.116 496,-605 517.016,-594.262 537.447,-576.713 551.497,-563.188"/>
<polygon fill="#000000" stroke="#000000" points="553.958,-565.676 558.609,-556.157 549.037,-560.698 553.958,-565.676"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~npa_f~~CallsGraph_node42" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~npa_f~~CallsGraph_node42"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="454.5,-676 393.5,-676 393.5,-652 454.5,-652 454.5,-676"/>
<text text-anchor="middle" x="424" y="-661.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~npa_f~~CallsGraph_edge27" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M303.199,-664C326.731,-664 358.413,-664 383.287,-664"/>
<polygon fill="#000000" stroke="#000000" points="383.486,-667.5 393.486,-664 383.486,-660.5 383.486,-667.5"/>
</g>
<!-- proc~line_plane_intersect -->
<g id="proc~~npa_f~~CallsGraph_node29" class="node"><title>proc~line_plane_intersect</title>
<g id="a_proc~~npa_f~~CallsGraph_node29"><a xlink:href=".././proc/line_plane_intersect.html" xlink:title="line_plane_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="478,-276 370,-276 370,-252 478,-252 478,-276"/>
<text text-anchor="middle" x="424" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">line_plane_intersect</text>
</a>
</g>
</g>
<!-- proc~hit_npa_detector&#45;&gt;proc~line_plane_intersect -->
<g id="proc~~npa_f~~CallsGraph_edge28" class="edge"><title>proc~hit_npa_detector&#45;&gt;proc~line_plane_intersect</title>
<path fill="none" stroke="#000000" d="M313.844,-293.964C331.129,-289.219 351.153,-283.723 369.294,-278.743"/>
<polygon fill="#000000" stroke="#000000" points="370.433,-282.06 379.15,-276.037 368.58,-275.309 370.433,-282.06"/>
</g>
<!-- proc~in_boundary -->
<g id="proc~~npa_f~~CallsGraph_node35" class="node"><title>proc~in_boundary</title>
<g id="a_proc~~npa_f~~CallsGraph_node35"><a xlink:href=".././proc/in_boundary.html" xlink:title="in_boundary">
<polygon fill="#d94e8f" stroke="#d94e8f" points="460,-318 388,-318 388,-294 460,-294 460,-318"/>
<text text-anchor="middle" x="424" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_boundary</text>
</a>
</g>
</g>
<!-- proc~hit_npa_detector&#45;&gt;proc~in_boundary -->
<g id="proc~~npa_f~~CallsGraph_edge29" class="edge"><title>proc~hit_npa_detector&#45;&gt;proc~in_boundary</title>
<path fill="none" stroke="#000000" d="M315.905,-306C335.453,-306 358.193,-306 377.677,-306"/>
<polygon fill="#000000" stroke="#000000" points="377.83,-309.5 387.83,-306 377.83,-302.5 377.83,-309.5"/>
</g>
<!-- proc~neutral_cx_rate -->
<g id="proc~~npa_f~~CallsGraph_node23" class="node"><title>proc~neutral_cx_rate</title>
<g id="a_proc~~npa_f~~CallsGraph_node23"><a xlink:href=".././proc/neutral_cx_rate.html" xlink:title="neutral_cx_rate">
<polygon fill="#d9534f" stroke="#d9534f" points="312.5,-778 225.5,-778 225.5,-754 312.5,-754 312.5,-778"/>
<text text-anchor="middle" x="269" y="-763.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutral_cx_rate</text>
</a>
</g>
</g>
<!-- proc~get_total_cx_rate&#45;&gt;proc~neutral_cx_rate -->
<g id="proc~~npa_f~~CallsGraph_edge30" class="edge"><title>proc~get_total_cx_rate&#45;&gt;proc~neutral_cx_rate</title>
<path fill="none" stroke="#000000" d="M177.704,-738.001C190.723,-742.038 205.421,-746.596 219.118,-750.843"/>
<polygon fill="#000000" stroke="#000000" points="218.289,-754.25 228.877,-753.869 220.362,-747.564 218.289,-754.25"/>
</g>
<!-- proc~attenuate&#45;&gt;proc~get_plasma -->
<g id="proc~~npa_f~~CallsGraph_edge32" class="edge"><title>proc~attenuate&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M167.31,-664C184.081,-664 205.678,-664 224.567,-664"/>
<polygon fill="#000000" stroke="#000000" points="224.735,-667.5 234.735,-664 224.735,-660.5 224.735,-667.5"/>
</g>
<!-- proc~colrad -->
<g id="proc~~npa_f~~CallsGraph_node28" class="node"><title>proc~colrad</title>
<g id="a_proc~~npa_f~~CallsGraph_node28"><a xlink:href=".././proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="296,-840 242,-840 242,-816 296,-816 296,-840"/>
<text text-anchor="middle" x="269" y="-825.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~attenuate&#45;&gt;proc~colrad -->
<g id="proc~~npa_f~~CallsGraph_edge31" class="edge"><title>proc~attenuate&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M156.346,-676.123C166.044,-683.58 177.794,-693.83 186,-705 209.564,-737.077 198.607,-754.798 222,-787 227.91,-795.136 235.682,-802.825 243.152,-809.298"/>
<polygon fill="#000000" stroke="#000000" points="241.097,-812.14 251.036,-815.809 245.554,-806.743 241.097,-812.14"/>
</g>
<!-- proc~gyro_range -->
<g id="proc~~npa_f~~CallsGraph_node18" class="node"><title>proc~gyro_range</title>
<g id="a_proc~~npa_f~~CallsGraph_node18"><a xlink:href=".././proc/gyro_range.html" xlink:title="gyro_range">
<polygon fill="#d9534f" stroke="#d9534f" points="302.5,-255 235.5,-255 235.5,-231 302.5,-231 302.5,-255"/>
<text text-anchor="middle" x="269" y="-240.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_range</text>
</a>
</g>
</g>
<!-- proc~npa_gyro_range&#45;&gt;proc~gyro_range -->
<g id="proc~~npa_f~~CallsGraph_edge33" class="edge"><title>proc~npa_gyro_range&#45;&gt;proc~gyro_range</title>
<path fill="none" stroke="#000000" d="M170.78,-331.86C176.061,-329.272 181.333,-326.306 186,-323 204.984,-309.553 205.399,-301.298 222,-285 229.707,-277.433 238.402,-269.378 246.141,-262.367"/>
<polygon fill="#000000" stroke="#000000" points="248.972,-264.529 254.071,-255.242 244.294,-259.322 248.972,-264.529"/>
</g>
<!-- proc~approx_eq -->
<g id="proc~~npa_f~~CallsGraph_node33" class="node"><title>proc~approx_eq</title>
<g id="a_proc~~npa_f~~CallsGraph_node33"><a xlink:href=".././proc/approx_eq.html" xlink:title="approx_eq">
<polygon fill="#d94e8f" stroke="#d94e8f" points="301,-213 237,-213 237,-189 301,-189 301,-213"/>
<text text-anchor="middle" x="269" y="-198.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_eq</text>
</a>
</g>
</g>
<!-- proc~npa_gyro_range&#45;&gt;proc~approx_eq -->
<g id="proc~~npa_f~~CallsGraph_edge34" class="edge"><title>proc~npa_gyro_range&#45;&gt;proc~approx_eq</title>
<path fill="none" stroke="#000000" d="M174.958,-331.746C179.031,-329.303 182.844,-326.411 186,-323 218.361,-288.018 189.78,-257.113 222,-222 223.766,-220.076 225.742,-218.315 227.857,-216.706"/>
<polygon fill="#000000" stroke="#000000" points="229.953,-219.522 236.543,-211.226 226.218,-213.602 229.953,-219.522"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~npa_f~~CallsGraph_node34" class="node"><title>proc~get_fields</title>
<g id="a_proc~~npa_f~~CallsGraph_node34"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="298,-436 240,-436 240,-412 298,-412 298,-436"/>
<text text-anchor="middle" x="269" y="-421.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~store_npa&#45;&gt;proc~get_fields -->
<g id="proc~~npa_f~~CallsGraph_edge35" class="edge"><title>proc~store_npa&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M168.595,-424C186.754,-424 210.196,-424 229.754,-424"/>
<polygon fill="#000000" stroke="#000000" points="229.87,-427.5 239.87,-424 229.87,-420.5 229.87,-427.5"/>
</g>
<!-- proc~store_npa&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge36" class="edge"><title>proc~store_npa&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M168.655,-413.92C244.305,-389.009 442.278,-329.077 496,-365 549.147,-400.538 564.168,-482.02 568.379,-521.602"/>
<polygon fill="#000000" stroke="#000000" points="564.896,-521.947 569.303,-531.581 571.866,-521.301 564.896,-521.947"/>
</g>
<!-- proc~get_distribution -->
<g id="proc~~npa_f~~CallsGraph_node16" class="node"><title>proc~get_distribution</title>
<g id="a_proc~~npa_f~~CallsGraph_node16"><a xlink:href=".././proc/get_distribution.html" xlink:title="get_distribution">
<polygon fill="#d9534f" stroke="#d9534f" points="311.5,-600 226.5,-600 226.5,-576 311.5,-576 311.5,-600"/>
<text text-anchor="middle" x="269" y="-585.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_distribution</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;proc~get_distribution -->
<g id="proc~~npa_f~~CallsGraph_edge38" class="edge"><title>proc~mc_fastion&#45;&gt;proc~get_distribution</title>
<path fill="none" stroke="#000000" d="M148.909,-497.205C163.466,-514.526 192.153,-546.413 222,-567 224.087,-568.439 226.288,-569.821 228.551,-571.14"/>
<polygon fill="#000000" stroke="#000000" points="227.008,-574.283 237.478,-575.904 230.304,-568.108 227.008,-574.283"/>
</g>
<!-- proc~mc_fastion&#45;&gt;proc~get_fields -->
<g id="proc~~npa_f~~CallsGraph_edge39" class="edge"><title>proc~mc_fastion&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M164.486,-472.948C184.186,-463.633 211.664,-450.639 233.359,-440.381"/>
<polygon fill="#000000" stroke="#000000" points="235.023,-443.466 242.567,-436.027 232.03,-437.137 235.023,-443.466"/>
</g>
<!-- interface~randind -->
<g id="proc~~npa_f~~CallsGraph_node38" class="node"><title>interface~randind</title>
<g id="a_proc~~npa_f~~CallsGraph_node38"><a xlink:href=".././interface/randind.html" xlink:title="randind">
<polygon fill="#a7506f" stroke="#a7506f" points="296,-558 242,-558 242,-534 296,-534 296,-558"/>
<text text-anchor="middle" x="269" y="-543.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;interface~randind -->
<g id="proc~~npa_f~~CallsGraph_edge40" class="edge"><title>proc~mc_fastion&#45;&gt;interface~randind</title>
<path fill="none" stroke="#000000" d="M163.632,-497.037C180.112,-505.049 202.306,-515.76 222,-525 225.378,-526.585 228.902,-528.222 232.431,-529.851"/>
<polygon fill="#000000" stroke="#000000" points="231.136,-533.108 241.685,-534.1 234.058,-526.747 231.136,-533.108"/>
</g>
<!-- proc~mc_beam_grid -->
<g id="proc~~npa_f~~CallsGraph_node40" class="node"><title>proc~mc_beam_grid</title>
<g id="a_proc~~npa_f~~CallsGraph_node40"><a xlink:href=".././proc/mc_beam_grid.html" xlink:title="mc_beam_grid">
<polygon fill="#d9534f" stroke="#d9534f" points="311,-516 227,-516 227,-492 311,-492 311,-516"/>
<text text-anchor="middle" x="269" y="-501.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_beam_grid</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;proc~mc_beam_grid -->
<g id="proc~~npa_f~~CallsGraph_edge41" class="edge"><title>proc~mc_fastion&#45;&gt;proc~mc_beam_grid</title>
<path fill="none" stroke="#000000" d="M170.227,-489.599C184.174,-491.653 200.978,-494.128 216.691,-496.443"/>
<polygon fill="#000000" stroke="#000000" points="216.415,-499.94 226.818,-497.934 217.435,-493.015 216.415,-499.94"/>
</g>
<!-- interface~randu -->
<g id="proc~~npa_f~~CallsGraph_node41" class="node"><title>interface~randu</title>
<g id="a_proc~~npa_f~~CallsGraph_node41"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="451,-516 397,-516 397,-492 451,-492 451,-516"/>
<text text-anchor="middle" x="424" y="-501.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;interface~randu -->
<g id="proc~~npa_f~~CallsGraph_edge37" class="edge"><title>proc~mc_fastion&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M170.134,-484.072C185.708,-483.653 204.849,-483.207 222,-483 263.775,-482.497 274.418,-478.958 316,-483 339.856,-485.319 366.287,-490.481 386.911,-495.106"/>
<polygon fill="#000000" stroke="#000000" points="386.296,-498.556 396.826,-497.388 387.866,-491.734 386.296,-498.556"/>
</g>
<!-- proc~cumsum -->
<g id="proc~~npa_f~~CallsGraph_node17" class="node"><title>proc~cumsum</title>
<g id="a_proc~~npa_f~~CallsGraph_node17"><a xlink:href=".././proc/cumsum.html" xlink:title="cumsum">
<polygon fill="#d9534f" stroke="#d9534f" points="296,-35 242,-35 242,-11 296,-11 296,-35"/>
<text text-anchor="middle" x="269" y="-20.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cumsum</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~cumsum -->
<g id="proc~~npa_f~~CallsGraph_edge43" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~cumsum</title>
<path fill="none" stroke="#000000" d="M171.415,-94.8087C176.513,-92.2551 181.559,-89.3143 186,-86 205.702,-71.2944 202.357,-58.785 222,-44 225.222,-41.5748 228.769,-39.3437 232.42,-37.3153"/>
<polygon fill="#000000" stroke="#000000" points="234.232,-40.3215 241.587,-32.6951 231.082,-34.0707 234.232,-40.3215"/>
</g>
<!-- proc~rng_init -->
<g id="proc~~npa_f~~CallsGraph_node20" class="node"><title>proc~rng_init</title>
<g id="a_proc~~npa_f~~CallsGraph_node20"><a xlink:href=".././proc/rng_init.html" xlink:title="rng_init">
<polygon fill="#d9534f" stroke="#d9534f" points="296,-119 242,-119 242,-95 296,-95 296,-119"/>
<text text-anchor="middle" x="269" y="-104.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rng_init</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~rng_init -->
<g id="proc~~npa_f~~CallsGraph_edge42" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~rng_init</title>
<path fill="none" stroke="#000000" d="M173.57,-107C191.537,-107 213.486,-107 231.7,-107"/>
<polygon fill="#000000" stroke="#000000" points="231.934,-110.5 241.934,-107 231.934,-103.5 231.934,-110.5"/>
</g>
<!-- interface~randind_cdf -->
<g id="proc~~npa_f~~CallsGraph_node24" class="node"><title>interface~randind_cdf</title>
<g id="a_proc~~npa_f~~CallsGraph_node24"><a xlink:href=".././interface/randind_cdf.html" xlink:title="randind_cdf">
<polygon fill="#a7506f" stroke="#a7506f" points="303.5,-77 234.5,-77 234.5,-53 303.5,-53 303.5,-77"/>
<text text-anchor="middle" x="269" y="-62.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind_cdf</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;interface~randind_cdf -->
<g id="proc~~npa_f~~CallsGraph_edge44" class="edge"><title>proc~get_nlaunch&#45;&gt;interface~randind_cdf</title>
<path fill="none" stroke="#000000" d="M173.57,-95.7448C189.291,-90.6261 208.061,-84.515 224.71,-79.0945"/>
<polygon fill="#000000" stroke="#000000" points="225.803,-82.4195 234.228,-75.9956 223.636,-75.7634 225.803,-82.4195"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_node49" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="463.5,-1092 384.5,-1092 384.5,-1068 463.5,-1068 463.5,-1092"/>
<text text-anchor="middle" x="424" y="-1077.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge45" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M302.43,-1235.78C307.227,-1233.26 311.921,-1230.33 316,-1227 360.118,-1190.96 395.209,-1132.68 412.075,-1101.43"/>
<polygon fill="#000000" stroke="#000000" points="415.324,-1102.77 416.899,-1092.29 409.134,-1099.5 415.324,-1102.77"/>
</g>
<!-- proc~get_distribution&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge47" class="edge"><title>proc~get_distribution&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M303.909,-575.92C318.528,-571.169 335.928,-566.115 352,-563 411.907,-551.39 482.459,-546.869 526.715,-545.112"/>
<polygon fill="#000000" stroke="#000000" points="526.968,-548.605 536.833,-544.741 526.711,-541.61 526.968,-548.605"/>
</g>
<!-- interface~interpol -->
<g id="proc~~npa_f~~CallsGraph_node55" class="node"><title>interface~interpol</title>
<g id="a_proc~~npa_f~~CallsGraph_node55"><a xlink:href=".././interface/interpol.html" xlink:title="interpol">
<polygon fill="#a7506f" stroke="#a7506f" points="451,-596 397,-596 397,-572 451,-572 451,-596"/>
<text text-anchor="middle" x="424" y="-581.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol</text>
</a>
</g>
</g>
<!-- proc~get_distribution&#45;&gt;interface~interpol -->
<g id="proc~~npa_f~~CallsGraph_edge46" class="edge"><title>proc~get_distribution&#45;&gt;interface~interpol</title>
<path fill="none" stroke="#000000" d="M311.808,-586.907C335.18,-586.296 364.034,-585.542 386.492,-584.954"/>
<polygon fill="#000000" stroke="#000000" points="386.728,-588.45 396.633,-584.689 386.545,-581.452 386.728,-588.45"/>
</g>
<!-- proc~gyro_range&#45;&gt;proc~line_plane_intersect -->
<g id="proc~~npa_f~~CallsGraph_edge51" class="edge"><title>proc~gyro_range&#45;&gt;proc~line_plane_intersect</title>
<path fill="none" stroke="#000000" d="M302.822,-247.505C319.422,-249.783 340.147,-252.628 359.689,-255.31"/>
<polygon fill="#000000" stroke="#000000" points="359.388,-258.802 369.772,-256.694 360.34,-251.867 359.388,-258.802"/>
</g>
<!-- proc~gyro_range&#45;&gt;proc~in_boundary -->
<g id="proc~~npa_f~~CallsGraph_edge49" class="edge"><title>proc~gyro_range&#45;&gt;proc~in_boundary</title>
<path fill="none" stroke="#000000" d="M291.073,-255.172C307.342,-264.227 330.614,-276.447 352,-285 360.325,-288.329 369.384,-291.404 378.159,-294.114"/>
<polygon fill="#000000" stroke="#000000" points="377.309,-297.513 387.892,-297.015 379.308,-290.804 377.309,-297.513"/>
</g>
<!-- proc~in_gyro_surface -->
<g id="proc~~npa_f~~CallsGraph_node48" class="node"><title>proc~in_gyro_surface</title>
<g id="a_proc~~npa_f~~CallsGraph_node48"><a xlink:href=".././proc/in_gyro_surface.html" xlink:title="in_gyro_surface">
<polygon fill="#d94e8f" stroke="#d94e8f" points="468.5,-234 379.5,-234 379.5,-210 468.5,-210 468.5,-234"/>
<text text-anchor="middle" x="424" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_gyro_surface</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~in_gyro_surface -->
<g id="proc~~npa_f~~CallsGraph_edge48" class="edge"><title>proc~gyro_range&#45;&gt;proc~in_gyro_surface</title>
<path fill="none" stroke="#000000" d="M302.822,-238.495C322.239,-235.83 347.301,-232.39 369.51,-229.342"/>
<polygon fill="#000000" stroke="#000000" points="370.052,-232.8 379.483,-227.973 369.1,-225.865 370.052,-232.8"/>
</g>
<!-- proc~boundary_edge -->
<g id="proc~~npa_f~~CallsGraph_node50" class="node"><title>proc~boundary_edge</title>
<g id="a_proc~~npa_f~~CallsGraph_node50"><a xlink:href=".././proc/boundary_edge.html" xlink:title="boundary_edge">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-192 380,-192 380,-168 468,-168 468,-192"/>
<text text-anchor="middle" x="424" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boundary_edge</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~boundary_edge -->
<g id="proc~~npa_f~~CallsGraph_edge50" class="edge"><title>proc~gyro_range&#45;&gt;proc~boundary_edge</title>
<path fill="none" stroke="#000000" d="M297.946,-230.782C303.955,-228.005 310.232,-224.989 316,-222 332.446,-213.476 334.996,-208.347 352,-201 357.808,-198.491 364.007,-196.17 370.232,-194.058"/>
<polygon fill="#000000" stroke="#000000" points="371.54,-197.314 379.983,-190.915 369.392,-190.652 371.54,-197.314"/>
</g>
<!-- proc~gyro_surface_coordinates -->
<g id="proc~~npa_f~~CallsGraph_node52" class="node"><title>proc~gyro_surface_coordinates</title>
<g id="a_proc~~npa_f~~CallsGraph_node52"><a xlink:href=".././proc/gyro_surface_coordinates.html" xlink:title="gyro_surface_coordinates">
<polygon fill="#d9534f" stroke="#d9534f" points="492,-150 356,-150 356,-126 492,-126 492,-150"/>
<text text-anchor="middle" x="424" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_surface_coordinates</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~gyro_surface_coordinates -->
<g id="proc~~npa_f~~CallsGraph_edge52" class="edge"><title>proc~gyro_range&#45;&gt;proc~gyro_surface_coordinates</title>
<path fill="none" stroke="#000000" d="M302.763,-231.166C307.517,-228.592 312.11,-225.552 316,-222 339.816,-200.256 326.715,-179.016 352,-159 353.802,-157.574 355.698,-156.244 357.666,-155.005"/>
<polygon fill="#000000" stroke="#000000" points="359.559,-157.961 366.695,-150.13 356.233,-151.802 359.559,-157.961"/>
</g>
<!-- proc~line_gyro_surface_intersect -->
<g id="proc~~npa_f~~CallsGraph_node53" class="node"><title>proc~line_gyro_surface_intersect</title>
<g id="a_proc~~npa_f~~CallsGraph_node53"><a xlink:href=".././proc/line_gyro_surface_intersect.html" xlink:title="line_gyro_surface_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="496,-108 352,-108 352,-84 496,-84 496,-108"/>
<text text-anchor="middle" x="424" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">line_gyro_surface_intersect</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~line_gyro_surface_intersect -->
<g id="proc~~npa_f~~CallsGraph_edge53" class="edge"><title>proc~gyro_range&#45;&gt;proc~line_gyro_surface_intersect</title>
<path fill="none" stroke="#000000" d="M302.914,-232.046C307.761,-229.344 312.344,-226.033 316,-222 349.134,-185.45 316.379,-151.131 352,-117 353.276,-115.777 354.62,-114.625 356.021,-113.54"/>
<polygon fill="#000000" stroke="#000000" points="358.074,-116.381 364.588,-108.025 354.285,-110.495 358.074,-116.381"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_node58" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~npa_f~~CallsGraph_node58"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="602,-718 540,-718 540,-694 602,-694 602,-718"/>
<text text-anchor="middle" x="571" y="-703.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_edge54" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M459.363,-706C480.474,-706 507.615,-706 529.732,-706"/>
<polygon fill="#000000" stroke="#000000" points="529.818,-709.5 539.818,-706 529.818,-702.5 529.818,-709.5"/>
</g>
<!-- proc~rng_seed -->
<g id="proc~~npa_f~~CallsGraph_node56" class="node"><title>proc~rng_seed</title>
<g id="a_proc~~npa_f~~CallsGraph_node56"><a xlink:href=".././proc/rng_seed.html" xlink:title="rng_seed">
<polygon fill="#d94e8f" stroke="#d94e8f" points="453,-66 395,-66 395,-42 453,-42 453,-66"/>
<text text-anchor="middle" x="424" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rng_seed</text>
</a>
</g>
</g>
<!-- proc~rng_init&#45;&gt;proc~rng_seed -->
<g id="proc~~npa_f~~CallsGraph_edge55" class="edge"><title>proc~rng_init&#45;&gt;proc~rng_seed</title>
<path fill="none" stroke="#000000" d="M296.012,-96.1999C312.032,-89.7111 333.06,-81.4837 352,-75 362.598,-71.3719 374.209,-67.7803 384.914,-64.6208"/>
<polygon fill="#000000" stroke="#000000" points="386.212,-67.8885 394.838,-61.737 384.259,-61.1666 386.212,-67.8885"/>
</g>
<!-- proc~my_rank -->
<g id="proc~~npa_f~~CallsGraph_node57" class="node"><title>proc~my_rank</title>
<g id="a_proc~~npa_f~~CallsGraph_node57"><a xlink:href=".././proc/my_rank.html" xlink:title="my_rank">
<polygon fill="#d94e8f" stroke="#d94e8f" points="451,-24 397,-24 397,-0 451,-0 451,-24"/>
<text text-anchor="middle" x="424" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">my_rank</text>
</a>
</g>
</g>
<!-- proc~rng_init&#45;&gt;proc~my_rank -->
<g id="proc~~npa_f~~CallsGraph_edge56" class="edge"><title>proc~rng_init&#45;&gt;proc~my_rank</title>
<path fill="none" stroke="#000000" d="M296.282,-97.9611C303.147,-94.8388 310.231,-90.8707 316,-86 337.757,-67.6293 329.005,-49.796 352,-33 362.218,-25.5366 375.076,-20.7078 387.032,-17.5911"/>
<polygon fill="#000000" stroke="#000000" points="387.821,-21.0012 396.786,-15.3555 386.257,-14.1782 387.821,-21.0012"/>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge57" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M300.513,-1193.89C305.854,-1191.27 311.225,-1188.28 316,-1185 352.106,-1160.19 386.991,-1122.61 406.651,-1099.78"/>
<polygon fill="#000000" stroke="#000000" points="409.377,-1101.98 413.179,-1092.09 404.04,-1097.45 409.377,-1101.98"/>
</g>
<!-- proc~bb_cx_rates -->
<g id="proc~~npa_f~~CallsGraph_node44" class="node"><title>proc~bb_cx_rates</title>
<g id="a_proc~~npa_f~~CallsGraph_node44"><a xlink:href=".././proc/bb_cx_rates.html" xlink:title="bb_cx_rates">
<polygon fill="#d9534f" stroke="#d9534f" points="459.5,-798 388.5,-798 388.5,-774 459.5,-774 459.5,-798"/>
<text text-anchor="middle" x="424" y="-783.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bb_cx_rates</text>
</a>
</g>
</g>
<!-- proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates -->
<g id="proc~~npa_f~~CallsGraph_edge58" class="edge"><title>proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates</title>
<path fill="none" stroke="#000000" d="M312.619,-771.571C333.042,-774.241 357.503,-777.438 378.201,-780.144"/>
<polygon fill="#000000" stroke="#000000" points="377.963,-783.643 388.333,-781.468 378.871,-776.702 377.963,-783.643"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge59" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M297.955,-1151.8C303.964,-1149.02 310.238,-1146 316,-1143 343.436,-1128.71 373.734,-1110.64 395.065,-1097.53"/>
<polygon fill="#000000" stroke="#000000" points="396.96,-1100.47 403.624,-1092.23 393.278,-1094.52 396.96,-1100.47"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge60" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M313.844,-1109.96C332.793,-1104.76 355.033,-1098.66 374.477,-1093.32"/>
<polygon fill="#000000" stroke="#000000" points="375.641,-1096.63 384.358,-1090.61 373.788,-1089.88 375.641,-1096.63"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge61" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M313.026,-1080C332.144,-1080 354.736,-1080 374.454,-1080"/>
<polygon fill="#000000" stroke="#000000" points="374.47,-1083.5 384.47,-1080 374.47,-1076.5 374.47,-1083.5"/>
</g>
<!-- proc~linsolve -->
<g id="proc~~npa_f~~CallsGraph_node43" class="node"><title>proc~linsolve</title>
<g id="a_proc~~npa_f~~CallsGraph_node43"><a xlink:href=".././proc/linsolve.html" xlink:title="linsolve">
<polygon fill="#d9534f" stroke="#d9534f" points="451,-1050 397,-1050 397,-1026 451,-1026 451,-1050"/>
<text text-anchor="middle" x="424" y="-1035.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linsolve</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~linsolve -->
<g id="proc~~npa_f~~CallsGraph_edge64" class="edge"><title>proc~colrad&#45;&gt;proc~linsolve</title>
<path fill="none" stroke="#000000" d="M296.073,-836.517C303.09,-839.667 310.305,-843.78 316,-849 316.881,-849.808 383.626,-968.141 411.241,-1017.13"/>
<polygon fill="#000000" stroke="#000000" points="408.252,-1018.96 416.211,-1025.95 414.35,-1015.52 408.252,-1018.96"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~npa_f~~CallsGraph_node46" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~npa_f~~CallsGraph_node46"><a xlink:href=".././proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-840 380,-840 380,-816 468,-816 468,-840"/>
<text text-anchor="middle" x="424" y="-825.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~npa_f~~CallsGraph_edge63" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M296.302,-828C316.427,-828 344.85,-828 369.677,-828"/>
<polygon fill="#000000" stroke="#000000" points="369.703,-831.5 379.703,-828 369.703,-824.5 369.703,-831.5"/>
</g>
<!-- proc~eigen -->
<g id="proc~~npa_f~~CallsGraph_node51" class="node"><title>proc~eigen</title>
<g id="a_proc~~npa_f~~CallsGraph_node51"><a xlink:href=".././proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="451,-903 397,-903 397,-879 451,-879 451,-903"/>
<text text-anchor="middle" x="424" y="-888.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~npa_f~~CallsGraph_edge62" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M296.302,-838.83C321.447,-849.184 359.546,-864.872 387.399,-876.341"/>
<polygon fill="#000000" stroke="#000000" points="386.207,-879.635 396.786,-880.206 388.872,-873.162 386.207,-879.635"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge65" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M313.844,-1050.04C332.793,-1055.24 355.033,-1061.34 374.477,-1066.68"/>
<polygon fill="#000000" stroke="#000000" points="373.788,-1070.12 384.358,-1069.39 375.641,-1063.37 373.788,-1070.12"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge66" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M301.237,-1008.02C306.391,-1010.62 311.511,-1013.62 316,-1017 335.643,-1031.79 331.366,-1045.63 352,-1059 358.903,-1063.47 366.79,-1067.02 374.739,-1069.83"/>
<polygon fill="#000000" stroke="#000000" points="373.813,-1073.21 384.403,-1072.9 375.931,-1066.53 373.813,-1073.21"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge67" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M304.535,-966.257C308.725,-968.714 312.687,-971.609 316,-975 344.383,-1004.05 321.645,-1032.01 352,-1059 358.421,-1064.71 366.33,-1068.87 374.511,-1071.9"/>
<polygon fill="#000000" stroke="#000000" points="373.578,-1075.27 384.168,-1074.96 375.694,-1068.6 373.578,-1075.27"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_edge68" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M298.155,-421.14C341.95,-417.747 428.382,-415.318 496,-440 554.873,-461.49 575.65,-470.579 610,-523 650.425,-584.691 603.665,-624.604 646,-685 646.439,-685.626 646.902,-686.237 647.388,-686.834"/>
<polygon fill="#000000" stroke="#000000" points="645.043,-689.433 654.701,-693.787 649.866,-684.36 645.043,-689.433"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge70" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M298.402,-429.811C350.97,-440.829 461.244,-465.241 496,-483 517.016,-493.738 537.447,-511.287 551.497,-524.812"/>
<polygon fill="#000000" stroke="#000000" points="549.037,-527.302 558.609,-531.843 553.958,-522.324 549.037,-527.302"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~npa_f~~CallsGraph_edge71" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M281.735,-436.162C292.07,-447.472 306.86,-465.208 316,-483 341.834,-533.286 320.915,-557.78 352,-605 362.903,-621.562 379.85,-635.895 394.453,-646.287"/>
<polygon fill="#000000" stroke="#000000" points="392.486,-649.182 402.716,-651.936 396.437,-643.403 392.486,-649.182"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~npa_f~~CallsGraph_node45" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~npa_f~~CallsGraph_node45"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="474,-398 374,-398 374,-374 474,-374 474,-398"/>
<text text-anchor="middle" x="424" y="-383.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~npa_f~~CallsGraph_edge69" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M298.063,-417.03C316.699,-412.401 341.852,-406.154 364.703,-400.479"/>
<polygon fill="#000000" stroke="#000000" points="365.807,-403.811 374.669,-398.004 364.12,-397.018 365.807,-403.811"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge72" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M305.406,-924.16C309.357,-926.618 313.023,-929.539 316,-933 353.982,-977.152 311.009,-1017.63 352,-1059 358.245,-1065.3 366.283,-1069.73 374.695,-1072.84"/>
<polygon fill="#000000" stroke="#000000" points="373.686,-1076.19 384.274,-1075.82 375.765,-1069.51 373.686,-1076.19"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge73" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M306.081,-882.262C309.821,-884.692 313.251,-887.578 316,-891 363.826,-950.53 300.108,-1002.98 352,-1059 358.093,-1065.58 366.136,-1070.13 374.615,-1073.27"/>
<polygon fill="#000000" stroke="#000000" points="373.705,-1076.65 384.292,-1076.25 375.766,-1069.96 373.705,-1076.65"/>
</g>
<!-- proc~mc_beam_grid&#45;&gt;interface~randu -->
<g id="proc~~npa_f~~CallsGraph_edge74" class="edge"><title>proc~mc_beam_grid&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M311.001,-504C334.537,-504 363.833,-504 386.558,-504"/>
<polygon fill="#000000" stroke="#000000" points="386.813,-507.5 396.812,-504 386.812,-500.5 386.813,-507.5"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge77" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M454.768,-657.092C468.211,-653.01 483.78,-646.863 496,-638 523.12,-618.332 545.442,-586.132 558.246,-565"/>
<polygon fill="#000000" stroke="#000000" points="561.395,-566.549 563.442,-556.154 555.359,-563.003 561.395,-566.549"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_node47" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~npa_f~~CallsGraph_node47"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="712.5,-676 647.5,-676 647.5,-652 712.5,-652 712.5,-676"/>
<text text-anchor="middle" x="680" y="-661.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge75" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M454.634,-664C499.688,-664 585.599,-664 637.05,-664"/>
<polygon fill="#000000" stroke="#000000" points="637.168,-667.5 647.168,-664 637.168,-660.5 637.168,-667.5"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_node54" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~npa_f~~CallsGraph_node54"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="609.5,-798 532.5,-798 532.5,-774 609.5,-774 609.5,-798"/>
<text text-anchor="middle" x="571" y="-783.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_edge76" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M454.535,-668.275C468.083,-671.305 483.804,-676.421 496,-685 511.586,-695.964 540.533,-739.284 557.229,-765.498"/>
<polygon fill="#000000" stroke="#000000" points="554.284,-767.389 562.582,-773.976 560.203,-763.652 554.284,-767.389"/>
</g>
<!-- dgetrf -->
<g id="proc~~npa_f~~CallsGraph_node60" class="node"><title>dgetrf</title>
<polygon fill="#777777" stroke="#777777" points="598,-1092 544,-1092 544,-1068 598,-1068 598,-1092"/>
<text text-anchor="middle" x="571" y="-1077.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrf</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrf -->
<g id="proc~~npa_f~~CallsGraph_edge78" class="edge"><title>proc~linsolve&#45;&gt;dgetrf</title>
<path fill="none" stroke="#000000" d="M451.258,-1045.61C474.458,-1052.33 508.499,-1062.19 534.192,-1069.63"/>
<polygon fill="#000000" stroke="#000000" points="533.358,-1073.03 543.937,-1072.45 535.306,-1066.31 533.358,-1073.03"/>
</g>
<!-- proc~matinv -->
<g id="proc~~npa_f~~CallsGraph_node63" class="node"><title>proc~matinv</title>
<g id="a_proc~~npa_f~~CallsGraph_node63"><a xlink:href=".././proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-1050 544,-1050 544,-1026 598,-1026 598,-1050"/>
<text text-anchor="middle" x="571" y="-1035.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~linsolve&#45;&gt;proc~matinv -->
<g id="proc~~npa_f~~CallsGraph_edge79" class="edge"><title>proc~linsolve&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M451.258,-1038C474.355,-1038 508.198,-1038 533.85,-1038"/>
<polygon fill="#000000" stroke="#000000" points="533.937,-1041.5 543.937,-1038 533.937,-1034.5 533.937,-1041.5"/>
</g>
<!-- dgetrs -->
<g id="proc~~npa_f~~CallsGraph_node66" class="node"><title>dgetrs</title>
<polygon fill="#777777" stroke="#777777" points="598,-1134 544,-1134 544,-1110 598,-1110 598,-1134"/>
<text text-anchor="middle" x="571" y="-1119.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrs</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrs -->
<g id="proc~~npa_f~~CallsGraph_edge80" class="edge"><title>proc~linsolve&#45;&gt;dgetrs</title>
<path fill="none" stroke="#000000" d="M451.154,-1042.01C465.271,-1045.05 482.515,-1050.26 496,-1059 516.634,-1072.37 512.937,-1085.47 532,-1101 533.366,-1102.11 534.8,-1103.2 536.277,-1104.25"/>
<polygon fill="#000000" stroke="#000000" points="534.746,-1107.43 545.049,-1109.89 538.534,-1101.54 534.746,-1107.43"/>
</g>
<!-- proc~bb_cx_rates&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_edge81" class="edge"><title>proc~bb_cx_rates&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M459.731,-786C478.438,-786 501.799,-786 522.198,-786"/>
<polygon fill="#000000" stroke="#000000" points="522.247,-789.5 532.247,-786 522.247,-782.5 522.247,-789.5"/>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_edge82" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M466.551,-815.964C484.062,-810.892 504.539,-804.961 522.633,-799.72"/>
<polygon fill="#000000" stroke="#000000" points="523.774,-803.034 532.405,-796.889 521.826,-796.31 523.774,-803.034"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~npa_f~~CallsGraph_node59" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~npa_f~~CallsGraph_node59"><a xlink:href=".././proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-924 544,-924 544,-900 598,-900 598,-924"/>
<text text-anchor="middle" x="571" y="-909.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~npa_f~~CallsGraph_edge83" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M451.258,-894.803C474.355,-898.148 508.198,-903.049 533.85,-906.764"/>
<polygon fill="#000000" stroke="#000000" points="533.539,-910.256 543.937,-908.225 534.542,-903.328 533.539,-910.256"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~npa_f~~CallsGraph_node61" class="node"><title>proc~elmhes</title>
<g id="a_proc~~npa_f~~CallsGraph_node61"><a xlink:href=".././proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-840 544,-840 544,-816 598,-816 598,-840"/>
<text text-anchor="middle" x="571" y="-825.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~npa_f~~CallsGraph_edge84" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M451.258,-879.591C474.56,-869.467 508.8,-854.59 534.532,-843.41"/>
<polygon fill="#000000" stroke="#000000" points="536.16,-846.519 543.937,-839.324 533.37,-840.099 536.16,-846.519"/>
</g>
<!-- proc~balback -->
<g id="proc~~npa_f~~CallsGraph_node62" class="node"><title>proc~balback</title>
<g id="a_proc~~npa_f~~CallsGraph_node62"><a xlink:href=".././proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-1008 544,-1008 544,-984 598,-984 598,-1008"/>
<text text-anchor="middle" x="571" y="-993.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~npa_f~~CallsGraph_edge85" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M438.987,-903.175C458.916,-920.239 496.957,-951.779 532,-975 533.889,-976.252 535.858,-977.499 537.863,-978.726"/>
<polygon fill="#000000" stroke="#000000" points="536.342,-981.891 546.74,-983.921 539.878,-975.849 536.342,-981.891"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~npa_f~~CallsGraph_node64" class="node"><title>proc~hqr2</title>
<g id="a_proc~~npa_f~~CallsGraph_node64"><a xlink:href=".././proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-882 544,-882 544,-858 598,-858 598,-882"/>
<text text-anchor="middle" x="571" y="-867.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~npa_f~~CallsGraph_edge86" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M451.258,-887.197C474.355,-883.852 508.198,-878.951 533.85,-875.236"/>
<polygon fill="#000000" stroke="#000000" points="534.542,-878.672 543.937,-873.775 533.539,-871.744 534.542,-878.672"/>
</g>
<!-- proc~balance -->
<g id="proc~~npa_f~~CallsGraph_node65" class="node"><title>proc~balance</title>
<g id="a_proc~~npa_f~~CallsGraph_node65"><a xlink:href=".././proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-966 544,-966 544,-942 598,-942 598,-966"/>
<text text-anchor="middle" x="571" y="-951.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~npa_f~~CallsGraph_edge87" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M451.258,-902.409C474.56,-912.533 508.8,-927.41 534.532,-938.59"/>
<polygon fill="#000000" stroke="#000000" points="533.37,-941.901 543.937,-942.676 536.16,-935.481 533.37,-941.901"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_edge89" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M602.09,-706C612.502,-706 624.387,-706 635.649,-706"/>
<polygon fill="#000000" stroke="#000000" points="635.756,-709.5 645.756,-706 635.756,-702.5 635.756,-709.5"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge88" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M602.09,-694.189C613.503,-689.709 626.687,-684.534 638.88,-679.748"/>
<polygon fill="#000000" stroke="#000000" points="640.363,-682.926 648.393,-676.014 637.805,-676.41 640.363,-682.926"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~npa_f~~CallsGraph_node67" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~npa_f~~CallsGraph_node67"><a xlink:href=".././proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="707,-1050 653,-1050 653,-1026 707,-1026 707,-1050"/>
<text text-anchor="middle" x="680" y="-1035.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~npa_f~~CallsGraph_edge90" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M598.175,-1038C611.518,-1038 627.96,-1038 642.523,-1038"/>
<polygon fill="#000000" stroke="#000000" points="642.724,-1041.5 652.724,-1038 642.724,-1034.5 642.724,-1041.5"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~npa_f~~CallsGraph_node68" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~npa_f~~CallsGraph_node68"><a xlink:href=".././proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="707,-882 653,-882 653,-858 707,-858 707,-882"/>
<text text-anchor="middle" x="680" y="-867.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~npa_f~~CallsGraph_edge91" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M598.175,-870C611.518,-870 627.96,-870 642.523,-870"/>
<polygon fill="#000000" stroke="#000000" points="642.724,-873.5 652.724,-870 642.724,-866.5 642.724,-873.5"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~npa_f~~CallsGraph_node69" class="node"><title>proc~outerprod</title>
<g id="a_proc~~npa_f~~CallsGraph_node69"><a xlink:href=".././proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="809.5,-1050 750.5,-1050 750.5,-1026 809.5,-1026 809.5,-1050"/>
<text text-anchor="middle" x="780" y="-1035.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~npa_f~~CallsGraph_edge92" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M707.005,-1038C717.251,-1038 729.231,-1038 740.446,-1038"/>
<polygon fill="#000000" stroke="#000000" points="740.459,-1041.5 750.459,-1038 740.459,-1034.5 740.459,-1041.5"/>
</g>
</g>
</svg>
</div><script>var panprocnpa_fCallsGraph = svgPanZoom('#procnpa_fCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~npa_f~~CalledByGraph Pages: 1 -->
<svg id="procnpa_fCalledByGraph" width="152pt" height="32pt"
 viewBox="0.00 0.00 152.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~npa_f~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~npa_f~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 148,-28 148,4 -4,4"/>
<!-- proc~npa_f -->
<g id="proc~~npa_f~~CalledByGraph_node1" class="node"><title>proc~npa_f</title>
<polygon fill="none" stroke="black" points="144,-24 90,-24 90,-0 144,-0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">npa_f</text>
</g>
<!-- program~fidasim -->
<g id="proc~~npa_f~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~npa_f~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_f -->
<g id="proc~~npa_f~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~npa_f</title>
<path fill="none" stroke="#000000" d="M54.4029,-12C62.3932,-12 71.3106,-12 79.8241,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.919,-15.5001 89.919,-12 79.919,-8.5001 79.919,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/npa_f.html#src">npa_f</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">npa_f</span>
    <span class="c">!+ Calculate Active NPA flux using a fast-ion distribution function F(E,p,r,z)</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">det</span><span class="p">,</span><span class="n">ic</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">Int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iion</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rg</span><span class="p">,</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ind</span><span class="p">,</span><span class="n">pind</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">denf</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span> <span class="kd">::</span> <span class="n">plasma</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fields</span>
    <span class="k">type</span><span class="p">(</span><span class="n">GyroSurface</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gs</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gyrange</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="kd">::</span> <span class="n">neut_types</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rates</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">states</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">flux</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">dtheta</span><span class="p">,</span> <span class="n">eb</span><span class="p">,</span> <span class="n">ptch</span>

    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">inpa</span><span class="p">,</span><span class="n">ichan</span><span class="p">,</span><span class="n">nrange</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">npart</span><span class="p">,</span><span class="n">ncell</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cell_ind</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nx</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ny</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nz</span><span class="p">)</span> <span class="kd">::</span> <span class="n">papprox</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nx</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ny</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nz</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nlaunch</span>

    <span class="n">papprox</span><span class="o">=</span><span class="mf">0.d0</span>
    <span class="k">do </span><span class="n">ic</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span>
        <span class="k">call </span><span class="n">ind2sub</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">ic</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span> <span class="n">j</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">ind</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">plasma</span><span class="p">%</span><span class="n">in_plasma</span><span class="p">)</span> <span class="k">cycle</span>
<span class="k">        </span><span class="n">papprox</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
                        <span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">half</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
                        <span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">third</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
                        <span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">dcx</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
                        <span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">halo</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span><span class="o">*</span> <span class="p">&amp;</span>
                        <span class="n">plasma</span><span class="p">%</span><span class="n">denf</span>
    <span class="n">enddo</span>

    <span class="n">ncell</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">do </span><span class="n">ic</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span>
        <span class="k">call </span><span class="n">ind2sub</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">ic</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span> <span class="n">j</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">papprox</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">ncell</span> <span class="o">=</span> <span class="n">ncell</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">cell_ind</span><span class="p">(</span><span class="n">ncell</span><span class="p">)</span> <span class="o">=</span> <span class="n">ic</span>
        <span class="n">endif</span>
    <span class="n">enddo</span>

    <span class="k">call </span><span class="n">get_nlaunch</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_npa</span><span class="p">,</span> <span class="n">papprox</span><span class="p">,</span> <span class="n">nlaunch</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i12)&#39;</span><span class="p">)</span> <span class="nb">sum</span><span class="p">(</span><span class="n">nlaunch</span><span class="p">)</span>
    <span class="n">endif</span>

    <span class="c">!! Loop over all cells that can contribute to NPA signal</span>
    <span class="c">!$OMP PARALLEL DO schedule(dynamic,1) private(ic,i,j,k,ind,iion,ichan,fields,nrange,gyrange, &amp;</span>
    <span class="c">!$OMP&amp; pind,vi,ri,rf,det,plasma,rates,states,flux,denf,eb,ptch,gs,ir,theta,dtheta)</span>
    <span class="n">loop_over_cells</span><span class="p">:</span> <span class="k">do </span><span class="n">ic</span> <span class="o">=</span> <span class="n">istart</span><span class="p">,</span> <span class="n">ncell</span><span class="p">,</span> <span class="n">istep</span>
        <span class="k">call </span><span class="n">ind2sub</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">cell_ind</span><span class="p">(</span><span class="n">ic</span><span class="p">),</span><span class="n">ind</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span> <span class="n">j</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">loop_over_fast_ions</span><span class="p">:</span> <span class="k">do </span><span class="n">iion</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
            <span class="c">!! Sample fast ion distribution for energy and pitch</span>
            <span class="k">call </span><span class="n">mc_fastion</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">eb</span><span class="p">,</span> <span class="n">ptch</span><span class="p">,</span> <span class="n">denf</span><span class="p">)</span>
            <span class="k">if</span><span class="p">(</span><span class="n">denf</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">loop_over_fast_ions</span>

            <span class="k">call </span><span class="n">gyro_surface</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">eb</span><span class="p">,</span> <span class="n">ptch</span><span class="p">,</span> <span class="n">fbm</span><span class="p">%</span><span class="n">A</span><span class="p">,</span> <span class="n">gs</span><span class="p">)</span>

            <span class="n">detector_loop</span><span class="p">:</span> <span class="k">do </span><span class="n">ichan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">npa_chords</span><span class="p">%</span><span class="n">nchan</span>
                <span class="k">call </span><span class="n">npa_gyro_range</span><span class="p">(</span><span class="n">ichan</span><span class="p">,</span> <span class="n">gs</span><span class="p">,</span> <span class="n">gyrange</span><span class="p">,</span> <span class="n">nrange</span><span class="p">)</span>
                <span class="k">if</span><span class="p">(</span><span class="n">nrange</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">detector_loop</span>
                <span class="n">gyro_range_loop</span><span class="p">:</span> <span class="k">do </span><span class="n">ir</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nrange</span>
                    <span class="n">dtheta</span> <span class="o">=</span> <span class="n">gyrange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span>
                    <span class="n">theta</span> <span class="o">=</span> <span class="n">gyrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dtheta</span>
                    <span class="k">call </span><span class="n">gyro_trajectory</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">)</span>

                    <span class="c">!! Check if particle hits a NPA detector</span>
                    <span class="k">call </span><span class="n">hit_npa_detector</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span> <span class="n">vi</span> <span class="p">,</span><span class="n">det</span><span class="p">,</span> <span class="n">rf</span><span class="p">,</span> <span class="n">ichan</span><span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">det</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">ichan</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                        if</span> <span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="k">                            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s2">&quot;NPA_F: Missed Detector &quot;</span><span class="p">,</span><span class="n">ichan</span>
                        <span class="n">endif</span>
                        <span class="k">cycle </span><span class="n">gyro_range_loop</span>
                    <span class="n">endif</span>

                    <span class="c">!! Get beam grid indices at ri</span>
                    <span class="k">call </span><span class="n">get_indices</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">pind</span><span class="p">)</span>

                    <span class="c">!! Calculate CX probability with beam and halo neutrals</span>
                    <span class="k">call </span><span class="n">get_total_cx_rate</span><span class="p">(</span><span class="n">pind</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">,</span> <span class="n">neut_types</span><span class="p">,</span> <span class="n">rates</span><span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span> <span class="k">cycle </span><span class="n">gyro_range_loop</span>

                    <span class="c">!! Weight CX rates by ion source density</span>
                    <span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">denf</span>

                    <span class="c">!! Attenuate states as the particle move through plasma</span>
                    <span class="k">call </span><span class="n">attenuate</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">states</span><span class="p">)</span>

                    <span class="c">!! Store NPA Flux</span>
                    <span class="n">flux</span> <span class="o">=</span> <span class="p">(</span><span class="n">dtheta</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="o">*</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="o">/</span><span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
                    <span class="k">call </span><span class="n">store_npa</span><span class="p">(</span><span class="n">det</span><span class="p">,</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">flux</span><span class="p">)</span>
                <span class="n">enddo</span> <span class="n">gyro_range_loop</span>
            <span class="n">enddo</span> <span class="n">detector_loop</span>
        <span class="n">enddo</span> <span class="n">loop_over_fast_ions</span>
    <span class="n">enddo</span> <span class="n">loop_over_cells</span>
    <span class="c">!$OMP END PARALLEL DO</span>

    <span class="n">npart</span> <span class="o">=</span> <span class="n">npa</span><span class="p">%</span><span class="n">npart</span>
<span class="cp">#ifdef _MPI</span>
    <span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">npart</span><span class="p">)</span>
    <span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">npa</span><span class="p">%</span><span class="n">flux</span><span class="p">)</span>
<span class="cp">#endif</span>

    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T4,&quot;Number of Active NPA particles that hit a detector: &quot;,i8)&#39;</span><span class="p">)</span> <span class="n">npart</span>
    <span class="n">endif</span>

<span class="k">end subroutine </span><span class="n">npa_f</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> FIDASIM was developed by Luke Stagner</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>