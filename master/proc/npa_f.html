<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>npa_f &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>npa_f
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.6% of total for procedures.">84 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
    
     <li><a href='../module/libfida.html'>libfida</a></li>
    
  
     <li class="active">npa_f</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/npa_f.html#src">npa_f</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine npa_f()
    
    
   
</h2>
    
  


    
    <p>Calculate Active NPA flux using a fast-ion distribution function F(E,p,r,z)</p>
    

    <h3>Arguments</h3>
    
    <em>None</em>
    <br>
    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~npa_f~~CallsGraph Pages: 1 -->
<svg id="procnpa_fCallsGraph" width="641pt" height="1013pt"
 viewBox="0.00 0.00 641.00 1013.22" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~npa_f~~CallsGraph" class="graph" transform="scale(0.783619 0.783619) rotate(0) translate(4 1289)">
<title>proc~~npa_f~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1289 814,-1289 814,4 -4,4"/>
<!-- proc~npa_f -->
<g id="proc~~npa_f~~CallsGraph_node1" class="node"><title>proc~npa_f</title>
<polygon fill="none" stroke="black" points="54,-657 0,-657 0,-633 54,-633 54,-657"/>
<text text-anchor="middle" x="27" y="-642.6" font-family="Helvetica,sans-Serif" font-size="10.50">npa_f</text>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~npa_f~~CallsGraph_node2" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~npa_f~~CallsGraph_node2"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="174.5,-1075 101.5,-1075 101.5,-1051 174.5,-1051 174.5,-1075"/>
<text text-anchor="middle" x="138" y="-1060.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;interface~parallel_sum -->
<g id="proc~~npa_f~~CallsGraph_edge1" class="edge"><title>proc~npa_f&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M31.1446,-657.059C46.2489,-714.982 111.433,-964.955 131.258,-1040.98"/>
<polygon fill="#000000" stroke="#000000" points="127.933,-1042.1 133.843,-1050.89 134.706,-1040.33 127.933,-1042.1"/>
</g>
<!-- proc~gyro_surface -->
<g id="proc~~npa_f~~CallsGraph_node3" class="node"><title>proc~gyro_surface</title>
<g id="a_proc~~npa_f~~CallsGraph_node3"><a xlink:href=".././proc/gyro_surface.html" xlink:title="gyro_surface">
<polygon fill="#d9534f" stroke="#d9534f" points="175.5,-865 100.5,-865 100.5,-841 175.5,-841 175.5,-865"/>
<text text-anchor="middle" x="138" y="-850.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_surface</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~gyro_surface -->
<g id="proc~~npa_f~~CallsGraph_edge2" class="edge"><title>proc~npa_f&#45;&gt;proc~gyro_surface</title>
<path fill="none" stroke="#000000" d="M28.7244,-657.16C31.2803,-689.636 42.5025,-779.496 90,-832 90.8769,-832.969 91.8069,-833.896 92.7813,-834.783"/>
<polygon fill="#000000" stroke="#000000" points="90.8416,-837.701 100.969,-840.813 94.9925,-832.065 90.8416,-837.701"/>
</g>
<!-- proc~get_total_cx_rate -->
<g id="proc~~npa_f~~CallsGraph_node4" class="node"><title>proc~get_total_cx_rate</title>
<g id="a_proc~~npa_f~~CallsGraph_node4"><a xlink:href=".././proc/get_total_cx_rate.html" xlink:title="get_total_cx_rate">
<polygon fill="#d9534f" stroke="#d9534f" points="185.5,-823 90.5,-823 90.5,-799 185.5,-799 185.5,-823"/>
<text text-anchor="middle" x="138" y="-808.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_total_cx_rate</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~get_total_cx_rate -->
<g id="proc~~npa_f~~CallsGraph_edge3" class="edge"><title>proc~npa_f&#45;&gt;proc~get_total_cx_rate</title>
<path fill="none" stroke="#000000" d="M30.0892,-657.177C35.356,-684.423 51.5949,-750.97 90,-790 91.0578,-791.075 92.1803,-792.1 93.3545,-793.076"/>
<polygon fill="#000000" stroke="#000000" points="91.4934,-796.044 101.714,-798.834 95.4645,-790.279 91.4934,-796.044"/>
</g>
<!-- proc~npa_gyro_range -->
<g id="proc~~npa_f~~CallsGraph_node5" class="node"><title>proc~npa_gyro_range</title>
<g id="a_proc~~npa_f~~CallsGraph_node5"><a xlink:href=".././proc/npa_gyro_range.html" xlink:title="npa_gyro_range">
<polygon fill="#d9534f" stroke="#d9534f" points="183.5,-781 92.5,-781 92.5,-757 183.5,-757 183.5,-781"/>
<text text-anchor="middle" x="138" y="-766.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_gyro_range</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~npa_gyro_range -->
<g id="proc~~npa_f~~CallsGraph_edge4" class="edge"><title>proc~npa_f&#45;&gt;proc~npa_gyro_range</title>
<path fill="none" stroke="#000000" d="M32.4478,-657.1C40.7453,-678.173 60.4625,-721.854 90,-748 91.3342,-749.181 92.7457,-750.305 94.2143,-751.375"/>
<polygon fill="#000000" stroke="#000000" points="92.7705,-754.599 103.11,-756.911 96.4692,-748.656 92.7705,-754.599"/>
</g>
<!-- proc~gyro_trajectory -->
<g id="proc~~npa_f~~CallsGraph_node6" class="node"><title>proc~gyro_trajectory</title>
<g id="a_proc~~npa_f~~CallsGraph_node6"><a xlink:href=".././proc/gyro_trajectory.html" xlink:title="gyro_trajectory">
<polygon fill="#d9534f" stroke="#d9534f" points="180,-739 96,-739 96,-715 180,-715 180,-739"/>
<text text-anchor="middle" x="138" y="-724.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_trajectory</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~gyro_trajectory -->
<g id="proc~~npa_f~~CallsGraph_edge5" class="edge"><title>proc~npa_f&#45;&gt;proc~gyro_trajectory</title>
<path fill="none" stroke="#000000" d="M37.9233,-657.079C49.3719,-670.418 69.294,-691.873 90,-706 92.1317,-707.454 94.3805,-708.848 96.6928,-710.176"/>
<polygon fill="#000000" stroke="#000000" points="95.3318,-713.414 105.813,-714.961 98.5843,-707.216 95.3318,-713.414"/>
</g>
<!-- proc~ind2sub -->
<g id="proc~~npa_f~~CallsGraph_node7" class="node"><title>proc~ind2sub</title>
<g id="a_proc~~npa_f~~CallsGraph_node7"><a xlink:href=".././proc/ind2sub.html" xlink:title="ind2sub">
<polygon fill="#d9534f" stroke="#d9534f" points="165,-697 111,-697 111,-673 165,-673 165,-697"/>
<text text-anchor="middle" x="138" y="-682.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ind2sub</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~ind2sub -->
<g id="proc~~npa_f~~CallsGraph_edge6" class="edge"><title>proc~npa_f&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M54.1082,-654.581C68.161,-659.738 85.708,-666.177 101.035,-671.802"/>
<polygon fill="#000000" stroke="#000000" points="100.133,-675.199 110.727,-675.359 102.545,-668.628 100.133,-675.199"/>
</g>
<!-- proc~hit_npa_detector -->
<g id="proc~~npa_f~~CallsGraph_node8" class="node"><title>proc~hit_npa_detector</title>
<g id="a_proc~~npa_f~~CallsGraph_node8"><a xlink:href=".././proc/hit_npa_detector.html" xlink:title="hit_npa_detector">
<polygon fill="#d9534f" stroke="#d9534f" points="315.5,-739 222.5,-739 222.5,-715 315.5,-715 315.5,-739"/>
<text text-anchor="middle" x="269" y="-724.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hit_npa_detector</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~hit_npa_detector -->
<g id="proc~~npa_f~~CallsGraph_edge7" class="edge"><title>proc~npa_f&#45;&gt;proc~hit_npa_detector</title>
<path fill="none" stroke="#000000" d="M54.048,-642.574C86.843,-640.716 143.97,-641.532 186,-664 207.682,-675.591 202.357,-691.215 222,-706 223.824,-707.373 225.751,-708.683 227.743,-709.93"/>
<polygon fill="#000000" stroke="#000000" points="226.328,-713.149 236.763,-714.983 229.749,-707.042 226.328,-713.149"/>
</g>
<!-- proc~attenuate -->
<g id="proc~~npa_f~~CallsGraph_node9" class="node"><title>proc~attenuate</title>
<g id="a_proc~~npa_f~~CallsGraph_node9"><a xlink:href=".././proc/attenuate.html" xlink:title="attenuate">
<polygon fill="#d9534f" stroke="#d9534f" points="167,-573 109,-573 109,-549 167,-549 167,-573"/>
<text text-anchor="middle" x="138" y="-558.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">attenuate</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~attenuate -->
<g id="proc~~npa_f~~CallsGraph_edge8" class="edge"><title>proc~npa_f&#45;&gt;proc~attenuate</title>
<path fill="none" stroke="#000000" d="M38.4364,-632.573C50.0293,-619.321 69.7901,-598.312 90,-584 93.072,-581.824 96.381,-579.751 99.7696,-577.803"/>
<polygon fill="#000000" stroke="#000000" points="101.655,-580.763 108.818,-572.956 98.3501,-574.592 101.655,-580.763"/>
</g>
<!-- proc~get_nlaunch -->
<g id="proc~~npa_f~~CallsGraph_node10" class="node"><title>proc~get_nlaunch</title>
<g id="a_proc~~npa_f~~CallsGraph_node10"><a xlink:href=".././proc/get_nlaunch.html" xlink:title="get_nlaunch">
<polygon fill="#d9534f" stroke="#d9534f" points="173.5,-617 102.5,-617 102.5,-593 173.5,-593 173.5,-617"/>
<text text-anchor="middle" x="138" y="-602.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_nlaunch</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~get_nlaunch -->
<g id="proc~~npa_f~~CallsGraph_edge9" class="edge"><title>proc~npa_f&#45;&gt;proc~get_nlaunch</title>
<path fill="none" stroke="#000000" d="M54.1082,-635.419C66.1702,-630.993 80.8065,-625.621 94.4035,-620.632"/>
<polygon fill="#000000" stroke="#000000" points="95.8868,-623.816 104.069,-617.085 93.4752,-617.244 95.8868,-623.816"/>
</g>
<!-- proc~get_indices -->
<g id="proc~~npa_f~~CallsGraph_node11" class="node"><title>proc~get_indices</title>
<g id="a_proc~~npa_f~~CallsGraph_node11"><a xlink:href=".././proc/get_indices.html" xlink:title="get_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="171.5,-531 104.5,-531 104.5,-507 171.5,-507 171.5,-531"/>
<text text-anchor="middle" x="138" y="-516.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_indices</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~get_indices -->
<g id="proc~~npa_f~~CallsGraph_edge10" class="edge"><title>proc~npa_f&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M32.3842,-632.664C40.5832,-611.179 60.1529,-566.646 90,-540 91.6792,-538.501 93.483,-537.093 95.3705,-535.774"/>
<polygon fill="#000000" stroke="#000000" points="97.2952,-538.701 104.056,-530.544 93.6841,-532.704 97.2952,-538.701"/>
</g>
<!-- proc~mc_fastion -->
<g id="proc~~npa_f~~CallsGraph_node12" class="node"><title>proc~mc_fastion</title>
<g id="a_proc~~npa_f~~CallsGraph_node12"><a xlink:href=".././proc/mc_fastion.html" xlink:title="mc_fastion">
<polygon fill="#d9534f" stroke="#d9534f" points="170,-126 106,-126 106,-102 170,-102 170,-126"/>
<text text-anchor="middle" x="138" y="-111.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_fastion</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~mc_fastion -->
<g id="proc~~npa_f~~CallsGraph_edge11" class="edge"><title>proc~npa_f&#45;&gt;proc~mc_fastion</title>
<path fill="none" stroke="#000000" d="M29.0277,-632.687C33.3382,-583.236 51.5465,-394.497 90,-244 99.9735,-204.966 117.077,-161.225 127.671,-135.734"/>
<polygon fill="#000000" stroke="#000000" points="130.989,-136.872 131.643,-126.297 124.538,-134.156 130.989,-136.872"/>
</g>
<!-- proc~store_npa -->
<g id="proc~~npa_f~~CallsGraph_node13" class="node"><title>proc~store_npa</title>
<g id="a_proc~~npa_f~~CallsGraph_node13"><a xlink:href=".././proc/store_npa.html" xlink:title="store_npa">
<polygon fill="#d9534f" stroke="#d9534f" points="168.5,-277 107.5,-277 107.5,-253 168.5,-253 168.5,-277"/>
<text text-anchor="middle" x="138" y="-262.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_npa</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~store_npa -->
<g id="proc~~npa_f~~CallsGraph_edge12" class="edge"><title>proc~npa_f&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M30.7523,-632.768C38.8788,-597.003 63.8418,-489.61 90,-402 102.257,-360.947 119.018,-313.854 128.858,-286.946"/>
<polygon fill="#000000" stroke="#000000" points="132.217,-287.952 132.384,-277.359 125.648,-285.536 132.217,-287.952"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~npa_f~~CallsGraph_node14" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~npa_f~~CallsGraph_node14"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-415 235,-415 235,-391 303,-391 303,-415"/>
<text text-anchor="middle" x="269" y="-400.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~get_plasma -->
<g id="proc~~npa_f~~CallsGraph_edge13" class="edge"><title>proc~npa_f&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M30.2412,-632.848C35.8193,-605.622 52.6539,-538.914 90,-498 127.009,-457.455 185.414,-430.949 225.149,-416.488"/>
<polygon fill="#000000" stroke="#000000" points="226.561,-419.701 234.824,-413.07 224.23,-413.101 226.561,-419.701"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~npa_f~~CallsGraph_node18" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~npa_f~~CallsGraph_node18"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1075 223.5,-1075 223.5,-1051 314.5,-1051 314.5,-1075"/>
<text text-anchor="middle" x="269" y="-1060.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~npa_f~~CallsGraph_edge15" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.591,-1063C186.478,-1063 200.017,-1063 213.026,-1063"/>
<polygon fill="#000000" stroke="#000000" points="213.305,-1066.5 223.305,-1063 213.305,-1059.5 213.305,-1066.5"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~npa_f~~CallsGraph_node19" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~npa_f~~CallsGraph_node19"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1033 223.5,-1033 223.5,-1009 314.5,-1009 314.5,-1033"/>
<text text-anchor="middle" x="269" y="-1018.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~npa_f~~CallsGraph_edge20" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.591,-1051.41C188.907,-1046.75 205.617,-1041.31 220.915,-1036.33"/>
<polygon fill="#000000" stroke="#000000" points="222.299,-1039.56 230.724,-1033.14 220.132,-1032.9 222.299,-1039.56"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~npa_f~~CallsGraph_node21" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~npa_f~~CallsGraph_node21"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-991 223.5,-991 223.5,-967 314.5,-967 314.5,-991"/>
<text text-anchor="middle" x="269" y="-976.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~npa_f~~CallsGraph_edge19" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M153.005,-1050.83C168.977,-1037.32 196.224,-1015.41 222,-1000 224.473,-998.522 227.067,-997.078 229.711,-995.683"/>
<polygon fill="#000000" stroke="#000000" points="231.404,-998.75 238.791,-991.155 228.28,-992.486 231.404,-998.75"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~npa_f~~CallsGraph_node23" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~npa_f~~CallsGraph_node23"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-949 223.5,-949 223.5,-925 314.5,-925 314.5,-949"/>
<text text-anchor="middle" x="269" y="-934.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_f~~CallsGraph_edge23" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M145.979,-1050.76C158.672,-1029.42 187.443,-985.102 222,-958 223.74,-956.635 225.583,-955.336 227.491,-954.102"/>
<polygon fill="#000000" stroke="#000000" points="229.242,-957.133 236.166,-949.114 225.752,-951.065 229.242,-957.133"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~npa_f~~CallsGraph_node25" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~npa_f~~CallsGraph_node25"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-907 225,-907 225,-883 313,-883 313,-907"/>
<text text-anchor="middle" x="269" y="-892.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~npa_f~~CallsGraph_edge18" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M142.978,-1050.66C152.447,-1023.06 178.814,-955.633 222,-916 223.29,-914.817 224.657,-913.69 226.083,-912.619"/>
<polygon fill="#000000" stroke="#000000" points="228.209,-915.414 234.746,-907.076 224.436,-909.517 228.209,-915.414"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~npa_f~~CallsGraph_node33" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~npa_f~~CallsGraph_node33"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-1285 225,-1285 225,-1261 313,-1261 313,-1285"/>
<text text-anchor="middle" x="269" y="-1270.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~npa_f~~CallsGraph_edge14" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M141.235,-1075.32C147.798,-1108.2 169.926,-1199.17 222,-1252 223.078,-1253.09 224.224,-1254.14 225.424,-1255.13"/>
<polygon fill="#000000" stroke="#000000" points="223.734,-1258.22 233.96,-1260.99 227.694,-1252.44 223.734,-1258.22"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~npa_f~~CallsGraph_node34" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~npa_f~~CallsGraph_node34"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-1243 225,-1243 225,-1219 313,-1219 313,-1243"/>
<text text-anchor="middle" x="269" y="-1228.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~npa_f~~CallsGraph_edge16" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M142.978,-1075.34C152.447,-1102.94 178.814,-1170.37 222,-1210 223.29,-1211.18 224.657,-1212.31 226.083,-1213.38"/>
<polygon fill="#000000" stroke="#000000" points="224.436,-1216.48 234.746,-1218.92 228.209,-1210.59 224.436,-1216.48"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~npa_f~~CallsGraph_node36" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~npa_f~~CallsGraph_node36"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1201 223.5,-1201 223.5,-1177 314.5,-1177 314.5,-1201"/>
<text text-anchor="middle" x="269" y="-1186.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~npa_f~~CallsGraph_edge17" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M145.979,-1075.24C158.672,-1096.58 187.443,-1140.9 222,-1168 223.74,-1169.36 225.583,-1170.66 227.491,-1171.9"/>
<polygon fill="#000000" stroke="#000000" points="225.752,-1174.94 236.166,-1176.89 229.242,-1168.87 225.752,-1174.94"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~npa_f~~CallsGraph_node41" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~npa_f~~CallsGraph_node41"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-1159 225,-1159 225,-1135 313,-1135 313,-1159"/>
<text text-anchor="middle" x="269" y="-1144.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~npa_f~~CallsGraph_edge21" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M153.005,-1075.17C168.977,-1088.68 196.224,-1110.59 222,-1126 224.473,-1127.48 227.067,-1128.92 229.711,-1130.32"/>
<polygon fill="#000000" stroke="#000000" points="228.28,-1133.51 238.791,-1134.85 231.404,-1127.25 228.28,-1133.51"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~npa_f~~CallsGraph_node42" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~npa_f~~CallsGraph_node42"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1117 223.5,-1117 223.5,-1093 314.5,-1093 314.5,-1117"/>
<text text-anchor="middle" x="269" y="-1102.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~npa_f~~CallsGraph_edge22" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.591,-1074.59C188.907,-1079.25 205.617,-1084.69 220.915,-1089.67"/>
<polygon fill="#000000" stroke="#000000" points="220.132,-1093.1 230.724,-1092.86 222.299,-1086.44 220.132,-1093.1"/>
</g>
<!-- proc~neutral_cx_rate -->
<g id="proc~~npa_f~~CallsGraph_node24" class="node"><title>proc~neutral_cx_rate</title>
<g id="a_proc~~npa_f~~CallsGraph_node24"><a xlink:href=".././proc/neutral_cx_rate.html" xlink:title="neutral_cx_rate">
<polygon fill="#d9534f" stroke="#d9534f" points="312.5,-865 225.5,-865 225.5,-841 312.5,-841 312.5,-865"/>
<text text-anchor="middle" x="269" y="-850.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutral_cx_rate</text>
</a>
</g>
</g>
<!-- proc~get_total_cx_rate&#45;&gt;proc~neutral_cx_rate -->
<g id="proc~~npa_f~~CallsGraph_edge24" class="edge"><title>proc~get_total_cx_rate&#45;&gt;proc~neutral_cx_rate</title>
<path fill="none" stroke="#000000" d="M175.966,-823.036C190.135,-827.649 206.487,-832.972 221.44,-837.841"/>
<polygon fill="#000000" stroke="#000000" points="220.436,-841.195 231.028,-840.963 222.603,-834.539 220.436,-841.195"/>
</g>
<!-- proc~approx_eq -->
<g id="proc~~npa_f~~CallsGraph_node15" class="node"><title>proc~approx_eq</title>
<g id="a_proc~~npa_f~~CallsGraph_node15"><a xlink:href=".././proc/approx_eq.html" xlink:title="approx_eq">
<polygon fill="#d94e8f" stroke="#d94e8f" points="301,-781 237,-781 237,-757 301,-757 301,-781"/>
<text text-anchor="middle" x="269" y="-766.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_eq</text>
</a>
</g>
</g>
<!-- proc~npa_gyro_range&#45;&gt;proc~approx_eq -->
<g id="proc~~npa_f~~CallsGraph_edge25" class="edge"><title>proc~npa_gyro_range&#45;&gt;proc~approx_eq</title>
<path fill="none" stroke="#000000" d="M183.756,-769C197.673,-769 212.948,-769 226.624,-769"/>
<polygon fill="#000000" stroke="#000000" points="226.721,-772.5 236.721,-769 226.721,-765.5 226.721,-772.5"/>
</g>
<!-- proc~gyro_range -->
<g id="proc~~npa_f~~CallsGraph_node22" class="node"><title>proc~gyro_range</title>
<g id="a_proc~~npa_f~~CallsGraph_node22"><a xlink:href=".././proc/gyro_range.html" xlink:title="gyro_range">
<polygon fill="#d9534f" stroke="#d9534f" points="302.5,-823 235.5,-823 235.5,-799 302.5,-799 302.5,-823"/>
<text text-anchor="middle" x="269" y="-808.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_range</text>
</a>
</g>
</g>
<!-- proc~npa_gyro_range&#45;&gt;proc~gyro_range -->
<g id="proc~~npa_f~~CallsGraph_edge26" class="edge"><title>proc~npa_gyro_range&#45;&gt;proc~gyro_range</title>
<path fill="none" stroke="#000000" d="M175.966,-781.036C191.503,-786.094 209.665,-792.007 225.73,-797.238"/>
<polygon fill="#000000" stroke="#000000" points="224.827,-800.624 235.419,-800.392 226.994,-793.968 224.827,-800.624"/>
</g>
<!-- proc~line_plane_intersect -->
<g id="proc~~npa_f~~CallsGraph_node16" class="node"><title>proc~line_plane_intersect</title>
<g id="a_proc~~npa_f~~CallsGraph_node16"><a xlink:href=".././proc/line_plane_intersect.html" xlink:title="line_plane_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="478,-781 370,-781 370,-757 478,-757 478,-781"/>
<text text-anchor="middle" x="424" y="-766.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">line_plane_intersect</text>
</a>
</g>
</g>
<!-- proc~hit_npa_detector&#45;&gt;proc~line_plane_intersect -->
<g id="proc~~npa_f~~CallsGraph_edge28" class="edge"><title>proc~hit_npa_detector&#45;&gt;proc~line_plane_intersect</title>
<path fill="none" stroke="#000000" d="M313.844,-739.036C331.129,-743.781 351.153,-749.277 369.294,-754.257"/>
<polygon fill="#000000" stroke="#000000" points="368.58,-757.691 379.15,-756.963 370.433,-750.94 368.58,-757.691"/>
</g>
<!-- proc~in_boundary -->
<g id="proc~~npa_f~~CallsGraph_node39" class="node"><title>proc~in_boundary</title>
<g id="a_proc~~npa_f~~CallsGraph_node39"><a xlink:href=".././proc/in_boundary.html" xlink:title="in_boundary">
<polygon fill="#d94e8f" stroke="#d94e8f" points="460,-739 388,-739 388,-715 460,-715 460,-739"/>
<text text-anchor="middle" x="424" y="-724.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_boundary</text>
</a>
</g>
</g>
<!-- proc~hit_npa_detector&#45;&gt;proc~in_boundary -->
<g id="proc~~npa_f~~CallsGraph_edge27" class="edge"><title>proc~hit_npa_detector&#45;&gt;proc~in_boundary</title>
<path fill="none" stroke="#000000" d="M315.905,-727C335.453,-727 358.193,-727 377.677,-727"/>
<polygon fill="#000000" stroke="#000000" points="377.83,-730.5 387.83,-727 377.83,-723.5 377.83,-730.5"/>
</g>
<!-- proc~attenuate&#45;&gt;proc~get_plasma -->
<g id="proc~~npa_f~~CallsGraph_edge29" class="edge"><title>proc~attenuate&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M167.026,-551.825C173.727,-548.767 180.519,-544.864 186,-540 222.722,-507.412 247.882,-454.338 259.901,-424.725"/>
<polygon fill="#000000" stroke="#000000" points="263.204,-425.888 263.601,-415.3 256.689,-423.329 263.204,-425.888"/>
</g>
<!-- proc~colrad -->
<g id="proc~~npa_f~~CallsGraph_node40" class="node"><title>proc~colrad</title>
<g id="a_proc~~npa_f~~CallsGraph_node40"><a xlink:href=".././proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="296,-571 242,-571 242,-547 296,-547 296,-571"/>
<text text-anchor="middle" x="269" y="-556.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~attenuate&#45;&gt;proc~colrad -->
<g id="proc~~npa_f~~CallsGraph_edge30" class="edge"><title>proc~attenuate&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M167.31,-560.561C186.257,-560.267 211.364,-559.878 231.768,-559.562"/>
<polygon fill="#000000" stroke="#000000" points="232.006,-563.059 241.951,-559.404 231.898,-556.059 232.006,-563.059"/>
</g>
<!-- proc~rng_init -->
<g id="proc~~npa_f~~CallsGraph_node28" class="node"><title>proc~rng_init</title>
<g id="a_proc~~npa_f~~CallsGraph_node28"><a xlink:href=".././proc/rng_init.html" xlink:title="rng_init">
<polygon fill="#d9534f" stroke="#d9534f" points="296,-697 242,-697 242,-673 296,-673 296,-697"/>
<text text-anchor="middle" x="269" y="-682.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rng_init</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~rng_init -->
<g id="proc~~npa_f~~CallsGraph_edge32" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~rng_init</title>
<path fill="none" stroke="#000000" d="M163.578,-617.172C171.007,-621.223 179.036,-625.99 186,-631 203.62,-643.675 203.905,-652.013 222,-664 225.362,-666.227 228.999,-668.331 232.703,-670.285"/>
<polygon fill="#000000" stroke="#000000" points="231.414,-673.551 241.933,-674.815 234.498,-667.267 231.414,-673.551"/>
</g>
<!-- interface~randind_cdf -->
<g id="proc~~npa_f~~CallsGraph_node29" class="node"><title>interface~randind_cdf</title>
<g id="a_proc~~npa_f~~CallsGraph_node29"><a xlink:href=".././interface/randind_cdf.html" xlink:title="randind_cdf">
<polygon fill="#a7506f" stroke="#a7506f" points="303.5,-655 234.5,-655 234.5,-631 303.5,-631 303.5,-655"/>
<text text-anchor="middle" x="269" y="-640.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind_cdf</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;interface~randind_cdf -->
<g id="proc~~npa_f~~CallsGraph_edge31" class="edge"><title>proc~get_nlaunch&#45;&gt;interface~randind_cdf</title>
<path fill="none" stroke="#000000" d="M173.57,-615.183C189.144,-619.771 207.711,-625.24 224.242,-630.11"/>
<polygon fill="#000000" stroke="#000000" points="223.646,-633.583 234.228,-633.052 225.624,-626.869 223.646,-633.583"/>
</g>
<!-- proc~cumsum -->
<g id="proc~~npa_f~~CallsGraph_node37" class="node"><title>proc~cumsum</title>
<g id="a_proc~~npa_f~~CallsGraph_node37"><a xlink:href=".././proc/cumsum.html" xlink:title="cumsum">
<polygon fill="#d9534f" stroke="#d9534f" points="296,-613 242,-613 242,-589 296,-589 296,-613"/>
<text text-anchor="middle" x="269" y="-598.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cumsum</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~cumsum -->
<g id="proc~~npa_f~~CallsGraph_edge33" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~cumsum</title>
<path fill="none" stroke="#000000" d="M173.57,-603.928C191.537,-603.371 213.486,-602.69 231.7,-602.126"/>
<polygon fill="#000000" stroke="#000000" points="232.047,-605.617 241.934,-601.808 231.83,-598.62 232.047,-605.617"/>
</g>
<!-- interface~randind -->
<g id="proc~~npa_f~~CallsGraph_node20" class="node"><title>interface~randind</title>
<g id="a_proc~~npa_f~~CallsGraph_node20"><a xlink:href=".././interface/randind.html" xlink:title="randind">
<polygon fill="#a7506f" stroke="#a7506f" points="296,-66 242,-66 242,-42 296,-42 296,-66"/>
<text text-anchor="middle" x="269" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;interface~randind -->
<g id="proc~~npa_f~~CallsGraph_edge34" class="edge"><title>proc~mc_fastion&#45;&gt;interface~randind</title>
<path fill="none" stroke="#000000" d="M165.105,-101.858C184.601,-92.7903 211.455,-80.3 232.841,-70.3532"/>
<polygon fill="#000000" stroke="#000000" points="234.343,-73.5147 241.934,-66.1238 231.39,-67.1677 234.343,-73.5147"/>
</g>
<!-- proc~mc_beam_grid -->
<g id="proc~~npa_f~~CallsGraph_node31" class="node"><title>proc~mc_beam_grid</title>
<g id="a_proc~~npa_f~~CallsGraph_node31"><a xlink:href=".././proc/mc_beam_grid.html" xlink:title="mc_beam_grid">
<polygon fill="#d9534f" stroke="#d9534f" points="311,-24 227,-24 227,-0 311,-0 311,-24"/>
<text text-anchor="middle" x="269" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_beam_grid</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;proc~mc_beam_grid -->
<g id="proc~~npa_f~~CallsGraph_edge35" class="edge"><title>proc~mc_fastion&#45;&gt;proc~mc_beam_grid</title>
<path fill="none" stroke="#000000" d="M148.941,-101.953C163.536,-84.8564 192.269,-53.3719 222,-33 224.091,-31.5671 226.296,-30.1903 228.562,-28.8752"/>
<polygon fill="#000000" stroke="#000000" points="230.312,-31.9086 237.495,-24.1201 227.023,-25.7295 230.312,-31.9086"/>
</g>
<!-- interface~randu -->
<g id="proc~~npa_f~~CallsGraph_node32" class="node"><title>interface~randu</title>
<g id="a_proc~~npa_f~~CallsGraph_node32"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="451,-34 397,-34 397,-10 451,-10 451,-34"/>
<text text-anchor="middle" x="424" y="-19.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;interface~randu -->
<g id="proc~~npa_f~~CallsGraph_edge36" class="edge"><title>proc~mc_fastion&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M170.009,-111.196C206.376,-107.012 267.81,-97.1118 316,-75 334.178,-66.6592 334.422,-57.5405 352,-48 362.976,-42.0429 375.599,-36.9228 387.129,-32.8402"/>
<polygon fill="#000000" stroke="#000000" points="388.564,-36.0494 396.912,-29.5247 386.317,-29.4198 388.564,-36.0494"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~npa_f~~CallsGraph_node35" class="node"><title>proc~get_fields</title>
<g id="a_proc~~npa_f~~CallsGraph_node35"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="298,-205 240,-205 240,-181 298,-181 298,-205"/>
<text text-anchor="middle" x="269" y="-190.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;proc~get_fields -->
<g id="proc~~npa_f~~CallsGraph_edge37" class="edge"><title>proc~mc_fastion&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M158.874,-126.171C180.432,-139.373 215.035,-160.564 239.489,-175.54"/>
<polygon fill="#000000" stroke="#000000" points="237.96,-178.707 248.316,-180.945 241.616,-172.738 237.96,-178.707"/>
</g>
<!-- proc~get_distribution -->
<g id="proc~~npa_f~~CallsGraph_node38" class="node"><title>proc~get_distribution</title>
<g id="a_proc~~npa_f~~CallsGraph_node38"><a xlink:href=".././proc/get_distribution.html" xlink:title="get_distribution">
<polygon fill="#d9534f" stroke="#d9534f" points="311.5,-146 226.5,-146 226.5,-122 311.5,-122 311.5,-146"/>
<text text-anchor="middle" x="269" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_distribution</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;proc~get_distribution -->
<g id="proc~~npa_f~~CallsGraph_edge38" class="edge"><title>proc~mc_fastion&#45;&gt;proc~get_distribution</title>
<path fill="none" stroke="#000000" d="M170.227,-118.841C184.051,-120.985 200.683,-123.563 216.277,-125.981"/>
<polygon fill="#000000" stroke="#000000" points="215.916,-129.467 226.334,-127.54 216.989,-122.549 215.916,-129.467"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_node27" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~npa_f~~CallsGraph_node27"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="605,-277 537,-277 537,-253 605,-253 605,-277"/>
<text text-anchor="middle" x="571" y="-262.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~store_npa&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge40" class="edge"><title>proc~store_npa&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M168.624,-265C243.28,-265 439.392,-265 526.84,-265"/>
<polygon fill="#000000" stroke="#000000" points="526.95,-268.5 536.95,-265 526.95,-261.5 526.95,-268.5"/>
</g>
<!-- proc~store_npa&#45;&gt;proc~get_fields -->
<g id="proc~~npa_f~~CallsGraph_edge39" class="edge"><title>proc~store_npa&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M160.592,-252.949C181.614,-241.216 213.765,-223.271 237.415,-210.071"/>
<polygon fill="#000000" stroke="#000000" points="239.312,-213.02 246.338,-205.09 235.9,-206.908 239.312,-213.02"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~npa_f~~CallsGraph_node17" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~npa_f~~CallsGraph_node17"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="454.5,-355 393.5,-355 393.5,-331 454.5,-331 454.5,-355"/>
<text text-anchor="middle" x="424" y="-340.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~npa_f~~CallsGraph_edge44" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M298.343,-390.904C314.083,-384.273 334.054,-376.003 352,-369 362.194,-365.022 373.277,-360.878 383.59,-357.098"/>
<polygon fill="#000000" stroke="#000000" points="384.989,-360.313 393.187,-353.602 382.593,-353.736 384.989,-360.313"/>
</g>
<!-- proc~get_position -->
<g id="proc~~npa_f~~CallsGraph_node26" class="node"><title>proc~get_position</title>
<g id="a_proc~~npa_f~~CallsGraph_node26"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="459,-435 389,-435 389,-411 459,-411 459,-435"/>
<text text-anchor="middle" x="424" y="-420.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~npa_f~~CallsGraph_edge43" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M303.199,-407.34C325.346,-410.235 354.714,-414.074 378.829,-417.226"/>
<polygon fill="#000000" stroke="#000000" points="378.437,-420.705 388.807,-418.53 379.345,-413.764 378.437,-420.705"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge42" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M278.886,-390.83C292.566,-372.99 320.524,-339.918 352,-322 381.623,-305.137 471.937,-284.819 526.585,-273.564"/>
<polygon fill="#000000" stroke="#000000" points="527.583,-276.932 536.681,-271.504 526.183,-270.074 527.583,-276.932"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_node30" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~npa_f~~CallsGraph_node30"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="714,-372 646,-372 646,-348 714,-348 714,-372"/>
<text text-anchor="middle" x="680" y="-357.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_edge41" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M303.124,-399.518C376.711,-391.781 553.761,-373.167 635.856,-364.536"/>
<polygon fill="#000000" stroke="#000000" points="636.274,-368.011 645.853,-363.485 635.542,-361.05 636.274,-368.011"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge46" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M454.755,-334.042C467.753,-329.64 482.971,-323.812 496,-317 514.091,-307.54 532.894,-294.277 547.018,-283.513"/>
<polygon fill="#000000" stroke="#000000" points="549.409,-286.088 555.16,-277.19 545.115,-280.559 549.409,-286.088"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_node44" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~npa_f~~CallsGraph_node44"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="609.5,-792 532.5,-792 532.5,-768 609.5,-768 609.5,-792"/>
<text text-anchor="middle" x="571" y="-777.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_edge47" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M447.313,-355.087C463.756,-365.281 485.084,-381.484 496,-402 570.907,-542.784 444.177,-625.89 532,-759 532.35,-759.531 532.719,-760.05 533.104,-760.556"/>
<polygon fill="#000000" stroke="#000000" points="530.925,-763.318 540.546,-767.755 535.792,-758.287 530.925,-763.318"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_node52" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~npa_f~~CallsGraph_node52"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="712.5,-414 647.5,-414 647.5,-390 712.5,-390 712.5,-414"/>
<text text-anchor="middle" x="680" y="-399.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge45" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M454.67,-348.216C491.372,-354.869 555.661,-367.182 610,-381 619.001,-383.289 628.579,-386.014 637.643,-388.731"/>
<polygon fill="#000000" stroke="#000000" points="636.64,-392.084 647.226,-391.655 638.682,-385.389 636.64,-392.084"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_node43" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="463.5,-1096 384.5,-1096 384.5,-1072 463.5,-1072 463.5,-1096"/>
<text text-anchor="middle" x="424" y="-1081.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge48" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.665,-1069.13C333.357,-1071.7 355.134,-1074.69 374.241,-1077.31"/>
<polygon fill="#000000" stroke="#000000" points="373.868,-1080.79 384.251,-1078.68 374.82,-1073.85 373.868,-1080.79"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge49" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M299.5,-1033.15C323.707,-1043.11 358.165,-1057.3 384.535,-1068.16"/>
<polygon fill="#000000" stroke="#000000" points="383.271,-1071.43 393.85,-1072 385.936,-1064.95 383.271,-1071.43"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge50" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M299.25,-991.087C304.933,-993.786 310.751,-996.804 316,-1000 347.876,-1019.41 381.17,-1046.86 401.985,-1065.03"/>
<polygon fill="#000000" stroke="#000000" points="399.769,-1067.75 409.583,-1071.74 404.401,-1062.5 399.769,-1067.75"/>
</g>
<!-- proc~gyro_range&#45;&gt;proc~line_plane_intersect -->
<g id="proc~~npa_f~~CallsGraph_edge53" class="edge"><title>proc~gyro_range&#45;&gt;proc~line_plane_intersect</title>
<path fill="none" stroke="#000000" d="M302.822,-801.99C322.25,-796.657 347.33,-789.772 369.548,-783.673"/>
<polygon fill="#000000" stroke="#000000" points="370.48,-787.047 379.196,-781.025 368.627,-780.297 370.48,-787.047"/>
</g>
<!-- proc~gyro_range&#45;&gt;proc~in_boundary -->
<g id="proc~~npa_f~~CallsGraph_edge52" class="edge"><title>proc~gyro_range&#45;&gt;proc~in_boundary</title>
<path fill="none" stroke="#000000" d="M301.237,-798.983C306.391,-796.381 311.511,-793.379 316,-790 335.643,-775.215 331.366,-761.368 352,-748 359.843,-742.919 368.958,-739.03 377.99,-736.066"/>
<polygon fill="#000000" stroke="#000000" points="379.094,-739.389 387.693,-733.2 377.111,-732.676 379.094,-739.389"/>
</g>
<!-- proc~gyro_surface_coordinates -->
<g id="proc~~npa_f~~CallsGraph_node48" class="node"><title>proc~gyro_surface_coordinates</title>
<g id="a_proc~~npa_f~~CallsGraph_node48"><a xlink:href=".././proc/gyro_surface_coordinates.html" xlink:title="gyro_surface_coordinates">
<polygon fill="#d9534f" stroke="#d9534f" points="492,-949 356,-949 356,-925 492,-925 492,-949"/>
<text text-anchor="middle" x="424" y="-934.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_surface_coordinates</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~gyro_surface_coordinates -->
<g id="proc~~npa_f~~CallsGraph_edge51" class="edge"><title>proc~gyro_range&#45;&gt;proc~gyro_surface_coordinates</title>
<path fill="none" stroke="#000000" d="M302.66,-822.194C307.537,-824.867 312.196,-828.107 316,-832 344.383,-861.055 321.645,-889.012 352,-916 353.354,-917.204 354.774,-918.339 356.249,-919.408"/>
<polygon fill="#000000" stroke="#000000" points="354.85,-922.654 365.214,-924.853 358.484,-916.671 354.85,-922.654"/>
</g>
<!-- proc~in_gyro_surface -->
<g id="proc~~npa_f~~CallsGraph_node53" class="node"><title>proc~in_gyro_surface</title>
<g id="a_proc~~npa_f~~CallsGraph_node53"><a xlink:href=".././proc/in_gyro_surface.html" xlink:title="in_gyro_surface">
<polygon fill="#d94e8f" stroke="#d94e8f" points="468.5,-907 379.5,-907 379.5,-883 468.5,-883 468.5,-907"/>
<text text-anchor="middle" x="424" y="-892.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_gyro_surface</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~in_gyro_surface -->
<g id="proc~~npa_f~~CallsGraph_edge54" class="edge"><title>proc~gyro_range&#45;&gt;proc~in_gyro_surface</title>
<path fill="none" stroke="#000000" d="M301.237,-823.017C306.391,-825.619 311.511,-828.621 316,-832 335.643,-846.785 331.366,-860.632 352,-874 357.381,-877.486 363.359,-880.411 369.499,-882.86"/>
<polygon fill="#000000" stroke="#000000" points="368.623,-886.264 379.218,-886.332 370.978,-879.672 368.623,-886.264"/>
</g>
<!-- proc~line_gyro_surface_intersect -->
<g id="proc~~npa_f~~CallsGraph_node54" class="node"><title>proc~line_gyro_surface_intersect</title>
<g id="a_proc~~npa_f~~CallsGraph_node54"><a xlink:href=".././proc/line_gyro_surface_intersect.html" xlink:title="line_gyro_surface_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="496,-865 352,-865 352,-841 496,-841 496,-865"/>
<text text-anchor="middle" x="424" y="-850.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">line_gyro_surface_intersect</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~line_gyro_surface_intersect -->
<g id="proc~~npa_f~~CallsGraph_edge55" class="edge"><title>proc~gyro_range&#45;&gt;proc~line_gyro_surface_intersect</title>
<path fill="none" stroke="#000000" d="M302.822,-820.01C322.25,-825.343 347.33,-832.228 369.548,-838.327"/>
<polygon fill="#000000" stroke="#000000" points="368.627,-841.703 379.196,-840.975 370.48,-834.953 368.627,-841.703"/>
</g>
<!-- proc~boundary_edge -->
<g id="proc~~npa_f~~CallsGraph_node58" class="node"><title>proc~boundary_edge</title>
<g id="a_proc~~npa_f~~CallsGraph_node58"><a xlink:href=".././proc/boundary_edge.html" xlink:title="boundary_edge">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-823 380,-823 380,-799 468,-799 468,-823"/>
<text text-anchor="middle" x="424" y="-808.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boundary_edge</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~boundary_edge -->
<g id="proc~~npa_f~~CallsGraph_edge56" class="edge"><title>proc~gyro_range&#45;&gt;proc~boundary_edge</title>
<path fill="none" stroke="#000000" d="M302.822,-811C322.227,-811 347.271,-811 369.47,-811"/>
<polygon fill="#000000" stroke="#000000" points="369.77,-814.5 379.77,-811 369.77,-807.5 369.77,-814.5"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge57" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M301.733,-949.245C306.722,-951.792 311.659,-954.717 316,-958 317.364,-959.032 376.078,-1028.45 405.937,-1063.8"/>
<polygon fill="#000000" stroke="#000000" points="403.391,-1066.2 412.518,-1071.59 408.739,-1061.69 403.391,-1066.2"/>
</g>
<!-- proc~bb_cx_rates -->
<g id="proc~~npa_f~~CallsGraph_node45" class="node"><title>proc~bb_cx_rates</title>
<g id="a_proc~~npa_f~~CallsGraph_node45"><a xlink:href=".././proc/bb_cx_rates.html" xlink:title="bb_cx_rates">
<polygon fill="#d9534f" stroke="#d9534f" points="459.5,-991 388.5,-991 388.5,-967 459.5,-967 459.5,-991"/>
<text text-anchor="middle" x="424" y="-976.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bb_cx_rates</text>
</a>
</g>
</g>
<!-- proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates -->
<g id="proc~~npa_f~~CallsGraph_edge58" class="edge"><title>proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates</title>
<path fill="none" stroke="#000000" d="M304.535,-865.257C308.725,-867.714 312.687,-870.609 316,-874 344.383,-903.055 321.645,-931.012 352,-958 359.415,-964.592 368.813,-969.119 378.325,-972.225"/>
<polygon fill="#000000" stroke="#000000" points="377.627,-975.664 388.199,-974.976 379.505,-968.921 377.627,-975.664"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge59" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M304.535,-907.257C308.725,-909.714 312.687,-912.609 316,-916 344.383,-945.055 330.655,-965.443 352,-1000 366.832,-1024.01 388.206,-1048.3 403.623,-1064.54"/>
<polygon fill="#000000" stroke="#000000" points="401.195,-1067.06 410.658,-1071.83 406.232,-1062.2 401.195,-1067.06"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_node55" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~npa_f~~CallsGraph_node55"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="602,-414 540,-414 540,-390 602,-390 602,-414"/>
<text text-anchor="middle" x="571" y="-399.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_edge60" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M459.363,-418.023C480.474,-414.966 507.615,-411.035 529.732,-407.832"/>
<polygon fill="#000000" stroke="#000000" points="530.423,-411.268 539.818,-406.371 529.42,-404.341 530.423,-411.268"/>
</g>
<!-- proc~my_rank -->
<g id="proc~~npa_f~~CallsGraph_node47" class="node"><title>proc~my_rank</title>
<g id="a_proc~~npa_f~~CallsGraph_node47"><a xlink:href=".././proc/my_rank.html" xlink:title="my_rank">
<polygon fill="#d94e8f" stroke="#d94e8f" points="451,-697 397,-697 397,-673 451,-673 451,-697"/>
<text text-anchor="middle" x="424" y="-682.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">my_rank</text>
</a>
</g>
</g>
<!-- proc~rng_init&#45;&gt;proc~my_rank -->
<g id="proc~~npa_f~~CallsGraph_edge61" class="edge"><title>proc~rng_init&#45;&gt;proc~my_rank</title>
<path fill="none" stroke="#000000" d="M296.302,-685C321.227,-685 358.881,-685 386.667,-685"/>
<polygon fill="#000000" stroke="#000000" points="386.786,-688.5 396.786,-685 386.786,-681.5 386.786,-688.5"/>
</g>
<!-- proc~rng_seed -->
<g id="proc~~npa_f~~CallsGraph_node51" class="node"><title>proc~rng_seed</title>
<g id="a_proc~~npa_f~~CallsGraph_node51"><a xlink:href=".././proc/rng_seed.html" xlink:title="rng_seed">
<polygon fill="#d94e8f" stroke="#d94e8f" points="453,-655 395,-655 395,-631 453,-631 453,-655"/>
<text text-anchor="middle" x="424" y="-640.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rng_seed</text>
</a>
</g>
</g>
<!-- proc~rng_init&#45;&gt;proc~rng_seed -->
<g id="proc~~npa_f~~CallsGraph_edge62" class="edge"><title>proc~rng_init&#45;&gt;proc~rng_seed</title>
<path fill="none" stroke="#000000" d="M296.302,-677.78C320.804,-671.054 357.607,-660.951 385.245,-653.364"/>
<polygon fill="#000000" stroke="#000000" points="386.255,-656.716 394.972,-650.694 384.402,-649.966 386.255,-656.716"/>
</g>
<!-- proc~mc_beam_grid&#45;&gt;interface~randu -->
<g id="proc~~npa_f~~CallsGraph_edge63" class="edge"><title>proc~mc_beam_grid&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M311.001,-14.6798C334.537,-16.2181 363.833,-18.1329 386.558,-19.6182"/>
<polygon fill="#000000" stroke="#000000" points="386.605,-23.1287 396.812,-20.2884 387.062,-16.1436 386.605,-23.1287"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge64" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M302.615,-1261C307.388,-1258.45 312.026,-1255.46 316,-1252 364.44,-1209.86 398.9,-1140.47 414.178,-1105.53"/>
<polygon fill="#000000" stroke="#000000" points="417.433,-1106.82 418.137,-1096.25 410.994,-1104.07 417.433,-1106.82"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge65" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M301.733,-1218.76C306.722,-1216.21 311.659,-1213.28 316,-1210 356.101,-1179.67 391.428,-1131.84 409.734,-1104.67"/>
<polygon fill="#000000" stroke="#000000" points="412.672,-1106.57 415.272,-1096.3 406.835,-1102.71 412.672,-1106.57"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~npa_f~~CallsGraph_edge68" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M282.262,-205.022C308.672,-230.914 371.129,-292.146 403.217,-323.604"/>
<polygon fill="#000000" stroke="#000000" points="401.089,-326.42 410.68,-330.921 405.989,-321.421 401.089,-326.42"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge67" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M298.223,-199.774C350.866,-212.408 464.334,-239.64 526.719,-254.613"/>
<polygon fill="#000000" stroke="#000000" points="526.103,-258.064 536.644,-256.994 527.737,-251.257 526.103,-258.064"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_edge66" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M298.285,-181.215C313.837,-175.37 333.649,-168.943 352,-166 415.192,-155.864 434.859,-147.085 496,-166 554.649,-184.144 567.988,-199.235 610,-244 636.919,-272.683 658.204,-313.629 669.669,-338.421"/>
<polygon fill="#000000" stroke="#000000" points="666.539,-339.994 673.837,-347.674 672.921,-337.119 666.539,-339.994"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~npa_f~~CallsGraph_node57" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~npa_f~~CallsGraph_node57"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="474,-199 374,-199 374,-175 474,-175 474,-199"/>
<text text-anchor="middle" x="424" y="-184.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~npa_f~~CallsGraph_edge69" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M298.063,-191.9C316.391,-191.181 341.022,-190.215 363.569,-189.331"/>
<polygon fill="#000000" stroke="#000000" points="363.896,-192.821 373.751,-188.931 363.621,-185.826 363.896,-192.821"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge70" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M299.25,-1176.91C304.933,-1174.21 310.751,-1171.2 316,-1168 347.876,-1148.59 381.17,-1121.14 401.985,-1102.97"/>
<polygon fill="#000000" stroke="#000000" points="404.401,-1105.5 409.583,-1096.26 399.769,-1100.25 404.401,-1105.5"/>
</g>
<!-- proc~get_distribution&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge71" class="edge"><title>proc~get_distribution&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M311.879,-130.7C359.763,-128.911 438.892,-132.171 496,-166 526.694,-184.182 548.73,-220.501 560.409,-243.732"/>
<polygon fill="#000000" stroke="#000000" points="557.282,-245.305 564.775,-252.796 563.588,-242.267 557.282,-245.305"/>
</g>
<!-- interface~interpol -->
<g id="proc~~npa_f~~CallsGraph_node56" class="node"><title>interface~interpol</title>
<g id="a_proc~~npa_f~~CallsGraph_node56"><a xlink:href=".././interface/interpol.html" xlink:title="interpol">
<polygon fill="#a7506f" stroke="#a7506f" points="451,-81 397,-81 397,-57 451,-57 451,-81"/>
<text text-anchor="middle" x="424" y="-66.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol</text>
</a>
</g>
</g>
<!-- proc~get_distribution&#45;&gt;interface~interpol -->
<g id="proc~~npa_f~~CallsGraph_edge72" class="edge"><title>proc~get_distribution&#45;&gt;interface~interpol</title>
<path fill="none" stroke="#000000" d="M293.774,-121.973C310.003,-113.942 332.087,-103.36 352,-95 363.327,-90.2445 375.861,-85.4912 387.206,-81.3741"/>
<polygon fill="#000000" stroke="#000000" points="388.574,-84.6019 396.809,-77.9357 386.214,-78.0116 388.574,-84.6019"/>
</g>
<!-- proc~eigen -->
<g id="proc~~npa_f~~CallsGraph_node46" class="node"><title>proc~eigen</title>
<g id="a_proc~~npa_f~~CallsGraph_node46"><a xlink:href=".././proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="451,-571 397,-571 397,-547 451,-547 451,-571"/>
<text text-anchor="middle" x="424" y="-556.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~npa_f~~CallsGraph_edge74" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M296.302,-559C321.227,-559 358.881,-559 386.667,-559"/>
<polygon fill="#000000" stroke="#000000" points="386.786,-562.5 396.786,-559 386.786,-555.5 386.786,-562.5"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~npa_f~~CallsGraph_node49" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~npa_f~~CallsGraph_node49"><a xlink:href=".././proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-613 380,-613 380,-589 468,-589 468,-613"/>
<text text-anchor="middle" x="424" y="-598.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~npa_f~~CallsGraph_edge73" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M296.302,-566.22C316.516,-571.769 345.103,-579.616 370.008,-586.453"/>
<polygon fill="#000000" stroke="#000000" points="369.133,-589.842 379.703,-589.115 370.986,-583.092 369.133,-589.842"/>
</g>
<!-- proc~linsolve -->
<g id="proc~~npa_f~~CallsGraph_node50" class="node"><title>proc~linsolve</title>
<g id="a_proc~~npa_f~~CallsGraph_node50"><a xlink:href=".././proc/linsolve.html" xlink:title="linsolve">
<polygon fill="#d9534f" stroke="#d9534f" points="451,-508 397,-508 397,-484 451,-484 451,-508"/>
<text text-anchor="middle" x="424" y="-493.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linsolve</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~linsolve -->
<g id="proc~~npa_f~~CallsGraph_edge75" class="edge"><title>proc~colrad&#45;&gt;proc~linsolve</title>
<path fill="none" stroke="#000000" d="M296.302,-548.17C321.447,-537.816 359.546,-522.128 387.399,-510.659"/>
<polygon fill="#000000" stroke="#000000" points="388.872,-513.838 396.786,-506.794 386.207,-507.365 388.872,-513.838"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge76" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M299.5,-1134.85C323.707,-1124.89 358.165,-1110.7 384.535,-1099.84"/>
<polygon fill="#000000" stroke="#000000" points="385.936,-1103.05 393.85,-1096 383.271,-1096.57 385.936,-1103.05"/>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge77" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.665,-1098.87C333.357,-1096.3 355.134,-1093.31 374.241,-1090.69"/>
<polygon fill="#000000" stroke="#000000" points="374.82,-1094.15 384.251,-1089.32 373.868,-1087.21 374.82,-1094.15"/>
</g>
<!-- proc~bb_cx_rates&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_edge78" class="edge"><title>proc~bb_cx_rates&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M459.852,-975.033C472.476,-972.078 486.058,-966.937 496,-958 542.666,-916.053 560.67,-840.071 566.964,-802.407"/>
<polygon fill="#000000" stroke="#000000" points="570.435,-802.861 568.502,-792.444 563.517,-801.793 570.435,-802.861"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~npa_f~~CallsGraph_node59" class="node"><title>proc~hqr2</title>
<g id="a_proc~~npa_f~~CallsGraph_node59"><a xlink:href=".././proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-666 544,-666 544,-642 598,-642 598,-666"/>
<text text-anchor="middle" x="571" y="-651.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~npa_f~~CallsGraph_edge79" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M451.214,-562.356C465.517,-565.21 482.921,-570.447 496,-580 518.995,-596.796 510.962,-613.81 532,-633 533.114,-634.016 534.285,-635.001 535.499,-635.955"/>
<polygon fill="#000000" stroke="#000000" points="533.729,-638.985 543.952,-641.767 537.695,-633.217 533.729,-638.985"/>
</g>
<!-- proc~balback -->
<g id="proc~~npa_f~~CallsGraph_node62" class="node"><title>proc~balback</title>
<g id="a_proc~~npa_f~~CallsGraph_node62"><a xlink:href=".././proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-624 544,-624 544,-600 598,-600 598,-624"/>
<text text-anchor="middle" x="571" y="-609.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~npa_f~~CallsGraph_edge80" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M451.21,-565.937C464.717,-569.716 481.378,-574.698 496,-580 508.875,-584.669 522.718,-590.443 534.908,-595.796"/>
<polygon fill="#000000" stroke="#000000" points="533.721,-599.099 544.28,-599.969 536.569,-592.704 533.721,-599.099"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~npa_f~~CallsGraph_node63" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~npa_f~~CallsGraph_node63"><a xlink:href=".././proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-582 544,-582 544,-558 598,-558 598,-582"/>
<text text-anchor="middle" x="571" y="-567.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~npa_f~~CallsGraph_edge81" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M451.258,-560.992C474.355,-562.744 508.198,-565.312 533.85,-567.258"/>
<polygon fill="#000000" stroke="#000000" points="533.701,-570.756 543.937,-568.023 534.23,-563.776 533.701,-570.756"/>
</g>
<!-- proc~balance -->
<g id="proc~~npa_f~~CallsGraph_node64" class="node"><title>proc~balance</title>
<g id="a_proc~~npa_f~~CallsGraph_node64"><a xlink:href=".././proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-750 544,-750 544,-726 598,-726 598,-750"/>
<text text-anchor="middle" x="571" y="-735.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~npa_f~~CallsGraph_edge82" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M451.213,-560.536C466.239,-562.776 484.366,-568.004 496,-580 539.83,-625.193 493.329,-667.321 532,-717 533.082,-718.39 534.284,-719.702 535.574,-720.937"/>
<polygon fill="#000000" stroke="#000000" points="533.654,-723.876 543.713,-727.202 537.923,-718.329 533.654,-723.876"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~npa_f~~CallsGraph_node65" class="node"><title>proc~elmhes</title>
<g id="a_proc~~npa_f~~CallsGraph_node65"><a xlink:href=".././proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-708 544,-708 544,-684 598,-684 598,-708"/>
<text text-anchor="middle" x="571" y="-693.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~npa_f~~CallsGraph_edge83" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M451.11,-561.049C465.912,-563.476 483.845,-568.72 496,-580 529.097,-610.714 502.429,-640.879 532,-675 533.12,-676.292 534.34,-677.52 535.633,-678.686"/>
<polygon fill="#000000" stroke="#000000" points="533.553,-681.5 543.659,-684.68 537.742,-675.892 533.553,-681.5"/>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_edge84" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M468.273,-606.316C478.498,-609.441 488.572,-614.341 496,-622 539.83,-667.193 493.329,-709.321 532,-759 532.587,-759.755 533.21,-760.486 533.863,-761.195"/>
<polygon fill="#000000" stroke="#000000" points="531.903,-764.122 541.787,-767.936 536.439,-758.791 531.903,-764.122"/>
</g>
<!-- dgetrs -->
<g id="proc~~npa_f~~CallsGraph_node60" class="node"><title>dgetrs</title>
<polygon fill="#777777" stroke="#777777" points="598,-540 544,-540 544,-516 598,-516 598,-540"/>
<text text-anchor="middle" x="571" y="-525.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrs</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrs -->
<g id="proc~~npa_f~~CallsGraph_edge86" class="edge"><title>proc~linsolve&#45;&gt;dgetrs</title>
<path fill="none" stroke="#000000" d="M451.258,-501.795C474.355,-506.892 508.198,-514.361 533.85,-520.022"/>
<polygon fill="#000000" stroke="#000000" points="533.418,-523.511 543.937,-522.248 534.926,-516.675 533.418,-523.511"/>
</g>
<!-- dgetrf -->
<g id="proc~~npa_f~~CallsGraph_node61" class="node"><title>dgetrf</title>
<polygon fill="#777777" stroke="#777777" points="598,-498 544,-498 544,-474 598,-474 598,-498"/>
<text text-anchor="middle" x="571" y="-483.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrf</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrf -->
<g id="proc~~npa_f~~CallsGraph_edge85" class="edge"><title>proc~linsolve&#45;&gt;dgetrf</title>
<path fill="none" stroke="#000000" d="M451.258,-494.189C474.355,-492.596 508.198,-490.262 533.85,-488.493"/>
<polygon fill="#000000" stroke="#000000" points="534.201,-491.977 543.937,-487.797 533.72,-484.994 534.201,-491.977"/>
</g>
<!-- proc~matinv -->
<g id="proc~~npa_f~~CallsGraph_node66" class="node"><title>proc~matinv</title>
<g id="a_proc~~npa_f~~CallsGraph_node66"><a xlink:href=".././proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-456 544,-456 544,-432 598,-432 598,-456"/>
<text text-anchor="middle" x="571" y="-441.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~linsolve&#45;&gt;proc~matinv -->
<g id="proc~~npa_f~~CallsGraph_edge87" class="edge"><title>proc~linsolve&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M451.258,-486.583C474.458,-478.263 508.499,-466.056 534.192,-456.842"/>
<polygon fill="#000000" stroke="#000000" points="535.705,-460.017 543.937,-453.347 533.342,-453.428 535.705,-460.017"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_edge89" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M602.09,-390.189C613.503,-385.709 626.687,-380.534 638.88,-375.748"/>
<polygon fill="#000000" stroke="#000000" points="640.363,-378.926 648.393,-372.014 637.805,-372.41 640.363,-378.926"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge88" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M602.09,-402C612.99,-402 625.506,-402 637.23,-402"/>
<polygon fill="#000000" stroke="#000000" points="637.27,-405.5 647.27,-402 637.27,-398.5 637.27,-405.5"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~npa_f~~CallsGraph_node67" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~npa_f~~CallsGraph_node67"><a xlink:href=".././proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="707,-666 653,-666 653,-642 707,-642 707,-666"/>
<text text-anchor="middle" x="680" y="-651.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~npa_f~~CallsGraph_edge90" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M598.175,-654C611.518,-654 627.96,-654 642.523,-654"/>
<polygon fill="#000000" stroke="#000000" points="642.724,-657.5 652.724,-654 642.724,-650.5 642.724,-657.5"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~npa_f~~CallsGraph_node68" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~npa_f~~CallsGraph_node68"><a xlink:href=".././proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="707,-456 653,-456 653,-432 707,-432 707,-456"/>
<text text-anchor="middle" x="680" y="-441.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~npa_f~~CallsGraph_edge91" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M598.175,-444C611.518,-444 627.96,-444 642.523,-444"/>
<polygon fill="#000000" stroke="#000000" points="642.724,-447.5 652.724,-444 642.724,-440.5 642.724,-447.5"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~npa_f~~CallsGraph_node69" class="node"><title>proc~outerprod</title>
<g id="a_proc~~npa_f~~CallsGraph_node69"><a xlink:href=".././proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="809.5,-456 750.5,-456 750.5,-432 809.5,-432 809.5,-456"/>
<text text-anchor="middle" x="780" y="-441.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~npa_f~~CallsGraph_edge92" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M707.005,-444C717.251,-444 729.231,-444 740.446,-444"/>
<polygon fill="#000000" stroke="#000000" points="740.459,-447.5 750.459,-444 740.459,-440.5 740.459,-447.5"/>
</g>
</g>
</svg>
</div><script>var panprocnpa_fCallsGraph = svgPanZoom('#procnpa_fCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~npa_f~~CalledByGraph Pages: 1 -->
<svg id="procnpa_fCalledByGraph" width="152pt" height="32pt"
 viewBox="0.00 0.00 152.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~npa_f~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~npa_f~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 148,-28 148,4 -4,4"/>
<!-- proc~npa_f -->
<g id="proc~~npa_f~~CalledByGraph_node1" class="node"><title>proc~npa_f</title>
<polygon fill="none" stroke="black" points="144,-24 90,-24 90,-0 144,-0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">npa_f</text>
</g>
<!-- program~fidasim -->
<g id="proc~~npa_f~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~npa_f~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_f -->
<g id="proc~~npa_f~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~npa_f</title>
<path fill="none" stroke="#000000" d="M54.4029,-12C62.3932,-12 71.3106,-12 79.8241,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.919,-15.5001 89.919,-12 79.919,-8.5001 79.919,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/npa_f.html#src">npa_f</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">npa_f</span>
    <span class="c">!+ Calculate Active NPA flux using a fast-ion distribution function F(E,p,r,z)</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">det</span><span class="p">,</span><span class="n">ic</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">Int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iion</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rg</span><span class="p">,</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ind</span><span class="p">,</span><span class="n">pind</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">denf</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span> <span class="kd">::</span> <span class="n">plasma</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fields</span>
    <span class="k">type</span><span class="p">(</span><span class="n">GyroSurface</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gs</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gyrange</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="kd">::</span> <span class="n">neut_types</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rates</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">states</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">flux</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">dtheta</span><span class="p">,</span> <span class="n">eb</span><span class="p">,</span> <span class="n">ptch</span>

    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">inpa</span><span class="p">,</span><span class="n">ichan</span><span class="p">,</span><span class="n">nrange</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">npart</span><span class="p">,</span><span class="n">ncell</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cell_ind</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nx</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ny</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nz</span><span class="p">)</span> <span class="kd">::</span> <span class="n">papprox</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nx</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ny</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nz</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nlaunch</span>

    <span class="n">papprox</span><span class="o">=</span><span class="mf">0.d0</span>
    <span class="k">do </span><span class="n">ic</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span>
        <span class="k">call </span><span class="n">ind2sub</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">ic</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span> <span class="n">j</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">ind</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">plasma</span><span class="p">%</span><span class="n">in_plasma</span><span class="p">)</span> <span class="k">cycle</span>
<span class="k">        </span><span class="n">papprox</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
                        <span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">half</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
                        <span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">third</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
                        <span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">dcx</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
                        <span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">halo</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span><span class="o">*</span> <span class="p">&amp;</span>
                        <span class="n">plasma</span><span class="p">%</span><span class="n">denf</span>
    <span class="k">enddo</span>

<span class="k">    </span><span class="n">ncell</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">do </span><span class="n">ic</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span>
        <span class="k">call </span><span class="n">ind2sub</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">ic</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span> <span class="n">j</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">papprox</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">ncell</span> <span class="o">=</span> <span class="n">ncell</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">cell_ind</span><span class="p">(</span><span class="n">ncell</span><span class="p">)</span> <span class="o">=</span> <span class="n">ic</span>
        <span class="k">endif</span>
<span class="k">    enddo</span>

<span class="k">    call </span><span class="n">get_nlaunch</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_npa</span><span class="p">,</span> <span class="n">papprox</span><span class="p">,</span> <span class="n">nlaunch</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i12)&#39;</span><span class="p">)</span> <span class="nb">sum</span><span class="p">(</span><span class="n">nlaunch</span><span class="p">)</span>
    <span class="k">endif</span>

    <span class="c">!! Loop over all cells that can contribute to NPA signal</span>
    <span class="c">!$OMP PARALLEL DO schedule(dynamic,1) private(ic,i,j,k,ind,iion,ichan,fields,nrange,gyrange, &amp;</span>
    <span class="c">!$OMP&amp; pind,vi,ri,rf,det,plasma,rates,states,flux,denf,eb,ptch,gs,ir,theta,dtheta)</span>
    <span class="n">loop_over_cells</span><span class="p">:</span> <span class="k">do </span><span class="n">ic</span> <span class="o">=</span> <span class="n">istart</span><span class="p">,</span> <span class="n">ncell</span><span class="p">,</span> <span class="n">istep</span>
        <span class="k">call </span><span class="n">ind2sub</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">cell_ind</span><span class="p">(</span><span class="n">ic</span><span class="p">),</span><span class="n">ind</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span> <span class="n">j</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">loop_over_fast_ions</span><span class="p">:</span> <span class="k">do </span><span class="n">iion</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
            <span class="c">!! Sample fast ion distribution for energy and pitch</span>
            <span class="k">call </span><span class="n">mc_fastion</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">eb</span><span class="p">,</span> <span class="n">ptch</span><span class="p">,</span> <span class="n">denf</span><span class="p">)</span>
            <span class="k">if</span><span class="p">(</span><span class="n">denf</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">loop_over_fast_ions</span>

            <span class="k">call </span><span class="n">gyro_surface</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">eb</span><span class="p">,</span> <span class="n">ptch</span><span class="p">,</span> <span class="n">fbm</span><span class="p">%</span><span class="n">A</span><span class="p">,</span> <span class="n">gs</span><span class="p">)</span>

            <span class="n">detector_loop</span><span class="p">:</span> <span class="k">do </span><span class="n">ichan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">npa_chords</span><span class="p">%</span><span class="n">nchan</span>
                <span class="k">call </span><span class="n">npa_gyro_range</span><span class="p">(</span><span class="n">ichan</span><span class="p">,</span> <span class="n">gs</span><span class="p">,</span> <span class="n">gyrange</span><span class="p">,</span> <span class="n">nrange</span><span class="p">)</span>
                <span class="k">if</span><span class="p">(</span><span class="n">nrange</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">detector_loop</span>
                <span class="n">gyro_range_loop</span><span class="p">:</span> <span class="k">do </span><span class="n">ir</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nrange</span>
                    <span class="n">dtheta</span> <span class="o">=</span> <span class="n">gyrange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span>
                    <span class="n">theta</span> <span class="o">=</span> <span class="n">gyrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dtheta</span>
                    <span class="k">call </span><span class="n">gyro_trajectory</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">)</span>

                    <span class="c">!! Check if particle hits a NPA detector</span>
                    <span class="k">call </span><span class="n">hit_npa_detector</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span> <span class="n">vi</span> <span class="p">,</span><span class="n">det</span><span class="p">,</span> <span class="n">rf</span><span class="p">,</span> <span class="n">ichan</span><span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">det</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">ichan</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                        if</span> <span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="k">                            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s2">&quot;NPA_F: Missed Detector &quot;</span><span class="p">,</span><span class="n">ichan</span>
                        <span class="k">endif</span>
<span class="k">                        cycle </span><span class="n">gyro_range_loop</span>
                    <span class="k">endif</span>

                    <span class="c">!! Get beam grid indices at ri</span>
                    <span class="k">call </span><span class="n">get_indices</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">pind</span><span class="p">)</span>

                    <span class="c">!! Calculate CX probability with beam and halo neutrals</span>
                    <span class="k">call </span><span class="n">get_total_cx_rate</span><span class="p">(</span><span class="n">pind</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">,</span> <span class="n">neut_types</span><span class="p">,</span> <span class="n">rates</span><span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span> <span class="k">cycle </span><span class="n">gyro_range_loop</span>

                    <span class="c">!! Weight CX rates by ion source density</span>
                    <span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">denf</span>

                    <span class="c">!! Attenuate states as the particle move through plasma</span>
                    <span class="k">call </span><span class="n">attenuate</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">states</span><span class="p">)</span>

                    <span class="c">!! Store NPA Flux</span>
                    <span class="n">flux</span> <span class="o">=</span> <span class="p">(</span><span class="n">dtheta</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="o">*</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="o">/</span><span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
                    <span class="k">call </span><span class="n">store_npa</span><span class="p">(</span><span class="n">det</span><span class="p">,</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">flux</span><span class="p">)</span>
                <span class="k">enddo </span><span class="n">gyro_range_loop</span>
            <span class="k">enddo </span><span class="n">detector_loop</span>
        <span class="k">enddo </span><span class="n">loop_over_fast_ions</span>
    <span class="k">enddo </span><span class="n">loop_over_cells</span>
    <span class="c">!$OMP END PARALLEL DO</span>

    <span class="n">npart</span> <span class="o">=</span> <span class="n">npa</span><span class="p">%</span><span class="n">npart</span>
<span class="cp">#ifdef _MPI</span>
    <span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">npart</span><span class="p">)</span>
    <span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">npa</span><span class="p">%</span><span class="n">flux</span><span class="p">)</span>
<span class="cp">#endif</span>

    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T4,&quot;Number of Active NPA particles that hit a detector: &quot;,i8)&#39;</span><span class="p">)</span> <span class="n">npart</span>
    <span class="k">endif</span>

<span class="k">end subroutine </span><span class="n">npa_f</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> FIDASIM was developed by Luke Stagner</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>