<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="">
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>npa_f &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>User Guide</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>npa_f
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.6% of total for procedures.">84 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
     <li><a href='../module/libfida.html'>libfida</a></li>
     <li class="active">npa_f</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/npa_f.html#src">npa_f</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public subroutine npa_f()</h2>
    

    <p>Calculate Active NPA flux using a fast-ion distribution function F(E,p,r,z)</p>

    <h3>Arguments</h3>
    <em>None</em>
    <br>
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~npa_f~~CallsGraph Pages: 1 -->
<svg id="procnpa_fCallsGraph" width="641pt" height="1123pt"
 viewBox="0.00 0.00 641.00 1123.10" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~npa_f~~CallsGraph" class="graph" transform="scale(0.781707 0.781707) rotate(0) translate(4 1432.73)">
<title>proc~~npa_f~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1432.73 816,-1432.73 816,4 -4,4"/>
<!-- proc~npa_f -->
<g id="proc~~npa_f~~CallsGraph_node1" class="node"><title>proc~npa_f</title>
<polygon fill="none" stroke="black" points="54,-560 0,-560 0,-536 54,-536 54,-560"/>
<text text-anchor="middle" x="27" y="-545.6" font-family="Helvetica,sans-Serif" font-size="10.50">npa_f</text>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~npa_f~~CallsGraph_node2" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~npa_f~~CallsGraph_node2"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="174.5,-1208 101.5,-1208 101.5,-1184 174.5,-1184 174.5,-1208"/>
<text text-anchor="middle" x="138" y="-1193.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;interface~parallel_sum -->
<g id="proc~~npa_f~~CallsGraph_edge1" class="edge"><title>proc~npa_f&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M29.2918,-560.071C34.9352,-612.03 58.5552,-821.704 90,-992 102.313,-1058.68 121.644,-1136.53 131.223,-1173.84"/>
<polygon fill="#000000" stroke="#000000" points="127.868,-1174.85 133.758,-1183.66 134.646,-1173.1 127.868,-1174.85"/>
</g>
<!-- proc~gyro_surface -->
<g id="proc~~npa_f~~CallsGraph_node3" class="node"><title>proc~gyro_surface</title>
<g id="a_proc~~npa_f~~CallsGraph_node3"><a xlink:href=".././proc/gyro_surface.html" xlink:title="gyro_surface">
<polygon fill="#d9534f" stroke="#d9534f" points="175.5,-983 100.5,-983 100.5,-959 175.5,-959 175.5,-983"/>
<text text-anchor="middle" x="138" y="-968.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_surface</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~gyro_surface -->
<g id="proc~~npa_f~~CallsGraph_edge2" class="edge"><title>proc~npa_f&#45;&gt;proc~gyro_surface</title>
<path fill="none" stroke="#000000" d="M28.4767,-560.021C31.0321,-619.303 44.7285,-880.256 90,-945 92.0389,-947.916 94.5142,-950.54 97.2504,-952.895"/>
<polygon fill="#000000" stroke="#000000" points="95.3458,-955.836 105.507,-958.836 99.4343,-950.155 95.3458,-955.836"/>
</g>
<!-- proc~get_nlaunch -->
<g id="proc~~npa_f~~CallsGraph_node4" class="node"><title>proc~get_nlaunch</title>
<g id="a_proc~~npa_f~~CallsGraph_node4"><a xlink:href=".././proc/get_nlaunch.html" xlink:title="get_nlaunch">
<polygon fill="#d9534f" stroke="#d9534f" points="173.5,-903 102.5,-903 102.5,-879 173.5,-879 173.5,-903"/>
<text text-anchor="middle" x="138" y="-888.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_nlaunch</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~get_nlaunch -->
<g id="proc~~npa_f~~CallsGraph_edge3" class="edge"><title>proc~npa_f&#45;&gt;proc~get_nlaunch</title>
<path fill="none" stroke="#000000" d="M31.7026,-560.198C41.2106,-591.464 67.3318,-677.009 90,-748 103.745,-791.045 120.364,-841.18 129.704,-869.19"/>
<polygon fill="#000000" stroke="#000000" points="126.42,-870.404 132.906,-878.78 133.059,-868.187 126.42,-870.404"/>
</g>
<!-- proc~mc_fastion -->
<g id="proc~~npa_f~~CallsGraph_node5" class="node"><title>proc~mc_fastion</title>
<g id="a_proc~~npa_f~~CallsGraph_node5"><a xlink:href=".././proc/mc_fastion.html" xlink:title="mc_fastion">
<polygon fill="#d9534f" stroke="#d9534f" points="170,-739 106,-739 106,-715 170,-715 170,-739"/>
<text text-anchor="middle" x="138" y="-724.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_fastion</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~mc_fastion -->
<g id="proc~~npa_f~~CallsGraph_edge4" class="edge"><title>proc~npa_f&#45;&gt;proc~mc_fastion</title>
<path fill="none" stroke="#000000" d="M35.3211,-560.023C53.5385,-589.939 101.095,-668.037 124.128,-705.861"/>
<polygon fill="#000000" stroke="#000000" points="121.232,-707.836 129.423,-714.556 127.211,-704.195 121.232,-707.836"/>
</g>
<!-- proc~hit_npa_detector -->
<g id="proc~~npa_f~~CallsGraph_node6" class="node"><title>proc~hit_npa_detector</title>
<g id="a_proc~~npa_f~~CallsGraph_node6"><a xlink:href=".././proc/hit_npa_detector.html" xlink:title="hit_npa_detector">
<polygon fill="#d9534f" stroke="#d9534f" points="315.5,-234 222.5,-234 222.5,-210 315.5,-210 315.5,-234"/>
<text text-anchor="middle" x="269" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hit_npa_detector</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~hit_npa_detector -->
<g id="proc~~npa_f~~CallsGraph_edge5" class="edge"><title>proc~npa_f&#45;&gt;proc~hit_npa_detector</title>
<path fill="none" stroke="#000000" d="M32.3329,-535.768C40.4527,-514.489 59.9036,-470.501 90,-445 125.01,-415.336 152.905,-438.787 186,-407 198.602,-394.896 241.143,-289.869 259.476,-243.662"/>
<polygon fill="#000000" stroke="#000000" points="262.775,-244.84 263.197,-234.253 256.265,-242.265 262.775,-244.84"/>
</g>
<!-- proc~get_total_cx_rate -->
<g id="proc~~npa_f~~CallsGraph_node7" class="node"><title>proc~get_total_cx_rate</title>
<g id="a_proc~~npa_f~~CallsGraph_node7"><a xlink:href=".././proc/get_total_cx_rate.html" xlink:title="get_total_cx_rate">
<polygon fill="#d9534f" stroke="#d9534f" points="185.5,-478 90.5,-478 90.5,-454 185.5,-454 185.5,-478"/>
<text text-anchor="middle" x="138" y="-463.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_total_cx_rate</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~get_total_cx_rate -->
<g id="proc~~npa_f~~CallsGraph_edge6" class="edge"><title>proc~npa_f&#45;&gt;proc~get_total_cx_rate</title>
<path fill="none" stroke="#000000" d="M37.9233,-535.921C49.3719,-522.582 69.294,-501.127 90,-487 92.1317,-485.546 94.3805,-484.152 96.6928,-482.824"/>
<polygon fill="#000000" stroke="#000000" points="98.5843,-485.784 105.813,-478.039 95.3318,-479.586 98.5843,-485.784"/>
</g>
<!-- proc~ind2sub -->
<g id="proc~~npa_f~~CallsGraph_node8" class="node"><title>proc~ind2sub</title>
<g id="a_proc~~npa_f~~CallsGraph_node8"><a xlink:href=".././proc/ind2sub.html" xlink:title="ind2sub">
<polygon fill="#d9534f" stroke="#d9534f" points="296,-1008 242,-1008 242,-984 296,-984 296,-1008"/>
<text text-anchor="middle" x="269" y="-993.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ind2sub</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~ind2sub -->
<g id="proc~~npa_f~~CallsGraph_edge7" class="edge"><title>proc~npa_f&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M28.5092,-560.256C31.1063,-617.252 44.5801,-855.982 90,-912 118.9,-947.644 145.554,-928.325 186,-950 203.17,-959.201 205.072,-965.361 222,-975 225.421,-976.948 229.055,-978.858 232.723,-980.683"/>
<polygon fill="#000000" stroke="#000000" points="231.273,-983.87 241.805,-985.02 234.289,-977.553 231.273,-983.87"/>
</g>
<!-- proc~get_indices -->
<g id="proc~~npa_f~~CallsGraph_node9" class="node"><title>proc~get_indices</title>
<g id="a_proc~~npa_f~~CallsGraph_node9"><a xlink:href=".././proc/get_indices.html" xlink:title="get_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="171.5,-356 104.5,-356 104.5,-332 171.5,-332 171.5,-356"/>
<text text-anchor="middle" x="138" y="-341.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_indices</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~get_indices -->
<g id="proc~~npa_f~~CallsGraph_edge8" class="edge"><title>proc~npa_f&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M28.8471,-535.631C31.6799,-503.455 43.4752,-416.094 90,-365 91.7375,-363.092 93.6809,-361.347 95.7618,-359.753"/>
<polygon fill="#000000" stroke="#000000" points="97.752,-362.635 104.324,-354.325 94.004,-356.723 97.752,-362.635"/>
</g>
<!-- proc~store_npa -->
<g id="proc~~npa_f~~CallsGraph_node10" class="node"><title>proc~store_npa</title>
<g id="a_proc~~npa_f~~CallsGraph_node10"><a xlink:href=".././proc/store_npa.html" xlink:title="store_npa">
<polygon fill="#d9534f" stroke="#d9534f" points="168.5,-600 107.5,-600 107.5,-576 168.5,-576 168.5,-600"/>
<text text-anchor="middle" x="138" y="-585.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_npa</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~store_npa -->
<g id="proc~~npa_f~~CallsGraph_edge9" class="edge"><title>proc~npa_f&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M54.1082,-557.581C67.1061,-562.351 83.0932,-568.218 97.5479,-573.522"/>
<polygon fill="#000000" stroke="#000000" points="96.661,-576.925 107.255,-577.084 99.0726,-570.353 96.661,-576.925"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~npa_f~~CallsGraph_node11" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~npa_f~~CallsGraph_node11"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-540 235,-540 235,-516 303,-516 303,-540"/>
<text text-anchor="middle" x="269" y="-525.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~get_plasma -->
<g id="proc~~npa_f~~CallsGraph_edge10" class="edge"><title>proc~npa_f&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M54.1411,-545.822C95.0864,-542.409 174.792,-535.767 224.488,-531.626"/>
<polygon fill="#000000" stroke="#000000" points="224.938,-535.101 234.612,-530.782 224.356,-528.125 224.938,-535.101"/>
</g>
<!-- proc~attenuate -->
<g id="proc~~npa_f~~CallsGraph_node12" class="node"><title>proc~attenuate</title>
<g id="a_proc~~npa_f~~CallsGraph_node12"><a xlink:href=".././proc/attenuate.html" xlink:title="attenuate">
<polygon fill="#d9534f" stroke="#d9534f" points="167,-520 109,-520 109,-496 167,-496 167,-520"/>
<text text-anchor="middle" x="138" y="-505.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">attenuate</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~attenuate -->
<g id="proc~~npa_f~~CallsGraph_edge11" class="edge"><title>proc~npa_f&#45;&gt;proc~attenuate</title>
<path fill="none" stroke="#000000" d="M54.1082,-538.419C67.6444,-533.452 84.4225,-527.295 99.3356,-521.822"/>
<polygon fill="#000000" stroke="#000000" points="100.631,-525.075 108.814,-518.344 98.2199,-518.503 100.631,-525.075"/>
</g>
<!-- proc~gyro_trajectory -->
<g id="proc~~npa_f~~CallsGraph_node13" class="node"><title>proc~gyro_trajectory</title>
<g id="a_proc~~npa_f~~CallsGraph_node13"><a xlink:href=".././proc/gyro_trajectory.html" xlink:title="gyro_trajectory">
<polygon fill="#d9534f" stroke="#d9534f" points="180,-314 96,-314 96,-290 180,-290 180,-314"/>
<text text-anchor="middle" x="138" y="-299.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_trajectory</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~gyro_trajectory -->
<g id="proc~~npa_f~~CallsGraph_edge12" class="edge"><title>proc~npa_f&#45;&gt;proc~gyro_trajectory</title>
<path fill="none" stroke="#000000" d="M27.9068,-535.86C28.2671,-499.175 34.157,-388.003 90,-323 90.8517,-322.009 91.7595,-321.062 92.7142,-320.158"/>
<polygon fill="#000000" stroke="#000000" points="94.9388,-322.864 100.799,-314.037 90.7135,-317.283 94.9388,-322.864"/>
</g>
<!-- proc~npa_gyro_range -->
<g id="proc~~npa_f~~CallsGraph_node14" class="node"><title>proc~npa_gyro_range</title>
<g id="a_proc~~npa_f~~CallsGraph_node14"><a xlink:href=".././proc/npa_gyro_range.html" xlink:title="npa_gyro_range">
<polygon fill="#d9534f" stroke="#d9534f" points="183.5,-398 92.5,-398 92.5,-374 183.5,-374 183.5,-398"/>
<text text-anchor="middle" x="138" y="-383.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_gyro_range</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~npa_gyro_range -->
<g id="proc~~npa_f~~CallsGraph_edge13" class="edge"><title>proc~npa_f&#45;&gt;proc~npa_gyro_range</title>
<path fill="none" stroke="#000000" d="M30.8293,-535.637C37.282,-509.831 55.2817,-449.521 90,-412 92.8499,-408.92 96.1502,-406.119 99.6544,-403.595"/>
<polygon fill="#000000" stroke="#000000" points="101.545,-406.541 108.085,-398.206 97.7745,-400.643 101.545,-406.541"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~npa_f~~CallsGraph_node16" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~npa_f~~CallsGraph_node16"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1126 223.5,-1126 223.5,-1102 314.5,-1102 314.5,-1126"/>
<text text-anchor="middle" x="269" y="-1111.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~npa_f~~CallsGraph_edge16" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M153.656,-1183.78C169.76,-1170.71 196.711,-1149.85 222,-1135 224.484,-1133.54 227.087,-1132.11 229.737,-1130.73"/>
<polygon fill="#000000" stroke="#000000" points="231.424,-1133.8 238.829,-1126.22 228.315,-1127.53 231.424,-1133.8"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~npa_f~~CallsGraph_node17" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~npa_f~~CallsGraph_node17"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-1043 380,-1043 380,-1019 468,-1019 468,-1043"/>
<text text-anchor="middle" x="424" y="-1028.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~npa_f~~CallsGraph_edge17" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M142.837,-1183.71C151.861,-1157.03 177.12,-1093.8 222,-1064 265.776,-1034.94 326.449,-1028.49 369.658,-1028.2"/>
<polygon fill="#000000" stroke="#000000" points="369.681,-1031.7 379.695,-1028.24 369.709,-1024.7 369.681,-1031.7"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~npa_f~~CallsGraph_node18" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~npa_f~~CallsGraph_node18"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-1377 380,-1377 380,-1353 468,-1353 468,-1377"/>
<text text-anchor="middle" x="424" y="-1362.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~npa_f~~CallsGraph_edge19" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M141.775,-1208.18C149.123,-1237.33 172.04,-1311.13 222,-1344 265.553,-1372.65 326.263,-1375.12 369.54,-1372.14"/>
<polygon fill="#000000" stroke="#000000" points="369.908,-1375.63 379.595,-1371.33 369.346,-1368.65 369.908,-1375.63"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~npa_f~~CallsGraph_node26" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~npa_f~~CallsGraph_node26"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-1335 225,-1335 225,-1311 313,-1311 313,-1335"/>
<text text-anchor="middle" x="269" y="-1320.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~npa_f~~CallsGraph_edge15" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M146.39,-1208.15C159.5,-1228.91 188.611,-1271.63 222,-1299 224.887,-1301.37 228.044,-1303.6 231.309,-1305.67"/>
<polygon fill="#000000" stroke="#000000" points="229.687,-1308.78 240.09,-1310.79 233.212,-1302.73 229.687,-1308.78"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~npa_f~~CallsGraph_node27" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~npa_f~~CallsGraph_node27"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="469.5,-1203 378.5,-1203 378.5,-1179 469.5,-1179 469.5,-1203"/>
<text text-anchor="middle" x="424" y="-1188.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_f~~CallsGraph_edge18" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.681,-1195.37C223.347,-1194.52 310.997,-1192.97 368.075,-1191.97"/>
<polygon fill="#000000" stroke="#000000" points="368.424,-1195.46 378.361,-1191.79 368.301,-1188.46 368.424,-1195.46"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~npa_f~~CallsGraph_node28" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~npa_f~~CallsGraph_node28"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1290 223.5,-1290 223.5,-1266 314.5,-1266 314.5,-1290"/>
<text text-anchor="middle" x="269" y="-1275.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~npa_f~~CallsGraph_edge20" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M153.656,-1208.22C169.76,-1221.29 196.711,-1242.15 222,-1257 224.484,-1258.46 227.087,-1259.89 229.737,-1261.27"/>
<polygon fill="#000000" stroke="#000000" points="228.315,-1264.47 238.829,-1265.78 231.424,-1258.2 228.315,-1264.47"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~npa_f~~CallsGraph_node30" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~npa_f~~CallsGraph_node30"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-1415 225,-1415 225,-1391 313,-1391 313,-1415"/>
<text text-anchor="middle" x="269" y="-1400.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~npa_f~~CallsGraph_edge23" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M141.748,-1208.02C149.434,-1239.31 173.816,-1324.56 222,-1377 224.863,-1380.12 228.188,-1382.95 231.714,-1385.51"/>
<polygon fill="#000000" stroke="#000000" points="229.887,-1388.5 240.189,-1390.97 233.679,-1382.61 229.887,-1388.5"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~npa_f~~CallsGraph_node32" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~npa_f~~CallsGraph_node32"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1248 223.5,-1248 223.5,-1224 314.5,-1224 314.5,-1248"/>
<text text-anchor="middle" x="269" y="-1233.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~npa_f~~CallsGraph_edge14" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.591,-1207.04C188.417,-1211.32 204.477,-1216.3 219.341,-1220.91"/>
<polygon fill="#000000" stroke="#000000" points="218.313,-1224.26 228.9,-1223.88 220.386,-1217.57 218.313,-1224.26"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~npa_f~~CallsGraph_node36" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~npa_f~~CallsGraph_node36"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1168 223.5,-1168 223.5,-1144 314.5,-1144 314.5,-1168"/>
<text text-anchor="middle" x="269" y="-1153.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~npa_f~~CallsGraph_edge21" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.591,-1184.96C188.417,-1180.68 204.477,-1175.7 219.341,-1171.09"/>
<polygon fill="#000000" stroke="#000000" points="220.386,-1174.43 228.9,-1168.12 218.313,-1167.74 220.386,-1174.43"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~npa_f~~CallsGraph_node38" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~npa_f~~CallsGraph_node38"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="469.5,-1085 378.5,-1085 378.5,-1061 469.5,-1061 469.5,-1085"/>
<text text-anchor="middle" x="424" y="-1070.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~npa_f~~CallsGraph_edge22" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M144.697,-1183.84C155.921,-1161.43 183.217,-1113.98 222,-1093 266.88,-1068.72 325.675,-1065.58 368.069,-1067.39"/>
<polygon fill="#000000" stroke="#000000" points="368.032,-1070.9 378.204,-1067.93 368.405,-1063.91 368.032,-1070.9"/>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~ind2sub -->
<g id="proc~~npa_f~~CallsGraph_edge24" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M166.453,-903.129C173.312,-906.947 180.324,-911.602 186,-917 207.985,-937.908 199.226,-954.954 222,-975 225.188,-977.806 228.813,-980.301 232.597,-982.503"/>
<polygon fill="#000000" stroke="#000000" points="231.089,-985.663 241.583,-987.117 234.286,-979.436 231.089,-985.663"/>
</g>
<!-- interface~randind_cdf -->
<g id="proc~~npa_f~~CallsGraph_node23" class="node"><title>interface~randind_cdf</title>
<g id="a_proc~~npa_f~~CallsGraph_node23"><a xlink:href=".././interface/randind_cdf.html" xlink:title="randind_cdf">
<polygon fill="#a7506f" stroke="#a7506f" points="303.5,-924 234.5,-924 234.5,-900 303.5,-900 303.5,-924"/>
<text text-anchor="middle" x="269" y="-909.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind_cdf</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;interface~randind_cdf -->
<g id="proc~~npa_f~~CallsGraph_edge26" class="edge"><title>proc~get_nlaunch&#45;&gt;interface~randind_cdf</title>
<path fill="none" stroke="#000000" d="M173.57,-896.628C189.144,-899.163 207.711,-902.185 224.242,-904.877"/>
<polygon fill="#000000" stroke="#000000" points="223.795,-908.35 234.228,-906.502 224.92,-901.441 223.795,-908.35"/>
</g>
<!-- proc~rng_init -->
<g id="proc~~npa_f~~CallsGraph_node34" class="node"><title>proc~rng_init</title>
<g id="a_proc~~npa_f~~CallsGraph_node34"><a xlink:href=".././proc/rng_init.html" xlink:title="rng_init">
<polygon fill="#d9534f" stroke="#d9534f" points="296,-882 242,-882 242,-858 296,-858 296,-882"/>
<text text-anchor="middle" x="269" y="-867.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rng_init</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~rng_init -->
<g id="proc~~npa_f~~CallsGraph_edge25" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~rng_init</title>
<path fill="none" stroke="#000000" d="M173.57,-885.372C191.621,-882.434 213.691,-878.841 231.955,-875.868"/>
<polygon fill="#000000" stroke="#000000" points="232.626,-879.305 241.934,-874.243 231.501,-872.396 232.626,-879.305"/>
</g>
<!-- proc~cumsum -->
<g id="proc~~npa_f~~CallsGraph_node35" class="node"><title>proc~cumsum</title>
<g id="a_proc~~npa_f~~CallsGraph_node35"><a xlink:href=".././proc/cumsum.html" xlink:title="cumsum">
<polygon fill="#d9534f" stroke="#d9534f" points="296,-966 242,-966 242,-942 296,-942 296,-966"/>
<text text-anchor="middle" x="269" y="-951.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cumsum</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~cumsum -->
<g id="proc~~npa_f~~CallsGraph_edge27" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~cumsum</title>
<path fill="none" stroke="#000000" d="M162.131,-903.018C178.712,-911.557 201.625,-923.199 222,-933 225.362,-934.617 228.876,-936.277 232.398,-937.919"/>
<polygon fill="#000000" stroke="#000000" points="231.097,-941.173 241.643,-942.188 234.031,-934.818 231.097,-941.173"/>
</g>
<!-- proc~mc_beam_grid -->
<g id="proc~~npa_f~~CallsGraph_node21" class="node"><title>proc~mc_beam_grid</title>
<g id="a_proc~~npa_f~~CallsGraph_node21"><a xlink:href=".././proc/mc_beam_grid.html" xlink:title="mc_beam_grid">
<polygon fill="#d9534f" stroke="#d9534f" points="311,-760 227,-760 227,-736 311,-736 311,-760"/>
<text text-anchor="middle" x="269" y="-745.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_beam_grid</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;proc~mc_beam_grid -->
<g id="proc~~npa_f~~CallsGraph_edge29" class="edge"><title>proc~mc_fastion&#45;&gt;proc~mc_beam_grid</title>
<path fill="none" stroke="#000000" d="M170.227,-732.084C184.174,-734.354 200.978,-737.089 216.691,-739.647"/>
<polygon fill="#000000" stroke="#000000" points="216.385,-743.144 226.818,-741.296 217.51,-736.235 216.385,-743.144"/>
</g>
<!-- interface~randu -->
<g id="proc~~npa_f~~CallsGraph_node22" class="node"><title>interface~randu</title>
<g id="a_proc~~npa_f~~CallsGraph_node22"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="451,-878 397,-878 397,-854 451,-854 451,-878"/>
<text text-anchor="middle" x="424" y="-863.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;interface~randu -->
<g id="proc~~npa_f~~CallsGraph_edge30" class="edge"><title>proc~mc_fastion&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M147.723,-739.276C161.429,-757.653 189.792,-792.162 222,-811 274.541,-841.731 344.835,-855.824 386.856,-861.875"/>
<polygon fill="#000000" stroke="#000000" points="386.521,-865.362 396.902,-863.246 387.467,-858.426 386.521,-865.362"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~npa_f~~CallsGraph_node29" class="node"><title>proc~get_fields</title>
<g id="a_proc~~npa_f~~CallsGraph_node29"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="298,-676 240,-676 240,-652 298,-652 298,-676"/>
<text text-anchor="middle" x="269" y="-661.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;proc~get_fields -->
<g id="proc~~npa_f~~CallsGraph_edge32" class="edge"><title>proc~mc_fastion&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M162.131,-714.982C178.712,-706.443 201.625,-694.801 222,-685 225.182,-683.469 228.499,-681.901 231.831,-680.346"/>
<polygon fill="#000000" stroke="#000000" points="233.55,-683.407 241.159,-676.034 230.613,-677.053 233.55,-683.407"/>
</g>
<!-- interface~randind -->
<g id="proc~~npa_f~~CallsGraph_node37" class="node"><title>interface~randind</title>
<g id="a_proc~~npa_f~~CallsGraph_node37"><a xlink:href=".././interface/randind.html" xlink:title="randind">
<polygon fill="#a7506f" stroke="#a7506f" points="296,-802 242,-802 242,-778 296,-778 296,-802"/>
<text text-anchor="middle" x="269" y="-787.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;interface~randind -->
<g id="proc~~npa_f~~CallsGraph_edge31" class="edge"><title>proc~mc_fastion&#45;&gt;interface~randind</title>
<path fill="none" stroke="#000000" d="M162.131,-739.018C178.712,-747.557 201.625,-759.199 222,-769 225.362,-770.617 228.876,-772.277 232.398,-773.919"/>
<polygon fill="#000000" stroke="#000000" points="231.097,-777.173 241.643,-778.188 234.031,-770.818 231.097,-777.173"/>
</g>
<!-- proc~get_distribution -->
<g id="proc~~npa_f~~CallsGraph_node39" class="node"><title>proc~get_distribution</title>
<g id="a_proc~~npa_f~~CallsGraph_node39"><a xlink:href=".././proc/get_distribution.html" xlink:title="get_distribution">
<polygon fill="#d9534f" stroke="#d9534f" points="311.5,-718 226.5,-718 226.5,-694 311.5,-694 311.5,-718"/>
<text text-anchor="middle" x="269" y="-703.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_distribution</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;proc~get_distribution -->
<g id="proc~~npa_f~~CallsGraph_edge28" class="edge"><title>proc~mc_fastion&#45;&gt;proc~get_distribution</title>
<path fill="none" stroke="#000000" d="M170.227,-721.916C184.051,-719.666 200.683,-716.959 216.277,-714.42"/>
<polygon fill="#000000" stroke="#000000" points="217.027,-717.844 226.334,-712.783 215.902,-710.935 217.027,-717.844"/>
</g>
<!-- proc~in_boundary -->
<g id="proc~~npa_f~~CallsGraph_node19" class="node"><title>proc~in_boundary</title>
<g id="a_proc~~npa_f~~CallsGraph_node19"><a xlink:href=".././proc/in_boundary.html" xlink:title="in_boundary">
<polygon fill="#d94e8f" stroke="#d94e8f" points="460,-234 388,-234 388,-210 460,-210 460,-234"/>
<text text-anchor="middle" x="424" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_boundary</text>
</a>
</g>
</g>
<!-- proc~hit_npa_detector&#45;&gt;proc~in_boundary -->
<g id="proc~~npa_f~~CallsGraph_edge34" class="edge"><title>proc~hit_npa_detector&#45;&gt;proc~in_boundary</title>
<path fill="none" stroke="#000000" d="M315.905,-222C335.453,-222 358.193,-222 377.677,-222"/>
<polygon fill="#000000" stroke="#000000" points="377.83,-225.5 387.83,-222 377.83,-218.5 377.83,-225.5"/>
</g>
<!-- proc~line_plane_intersect -->
<g id="proc~~npa_f~~CallsGraph_node25" class="node"><title>proc~line_plane_intersect</title>
<g id="a_proc~~npa_f~~CallsGraph_node25"><a xlink:href=".././proc/line_plane_intersect.html" xlink:title="line_plane_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="478,-192 370,-192 370,-168 478,-168 478,-192"/>
<text text-anchor="middle" x="424" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">line_plane_intersect</text>
</a>
</g>
</g>
<!-- proc~hit_npa_detector&#45;&gt;proc~line_plane_intersect -->
<g id="proc~~npa_f~~CallsGraph_edge33" class="edge"><title>proc~hit_npa_detector&#45;&gt;proc~line_plane_intersect</title>
<path fill="none" stroke="#000000" d="M313.844,-209.964C331.129,-205.219 351.153,-199.723 369.294,-194.743"/>
<polygon fill="#000000" stroke="#000000" points="370.433,-198.06 379.15,-192.037 368.58,-191.309 370.433,-198.06"/>
</g>
<!-- proc~neutral_cx_rate -->
<g id="proc~~npa_f~~CallsGraph_node41" class="node"><title>proc~neutral_cx_rate</title>
<g id="a_proc~~npa_f~~CallsGraph_node41"><a xlink:href=".././proc/neutral_cx_rate.html" xlink:title="neutral_cx_rate">
<polygon fill="#d9534f" stroke="#d9534f" points="312.5,-459 225.5,-459 225.5,-435 312.5,-435 312.5,-459"/>
<text text-anchor="middle" x="269" y="-444.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutral_cx_rate</text>
</a>
</g>
</g>
<!-- proc~get_total_cx_rate&#45;&gt;proc~neutral_cx_rate -->
<g id="proc~~npa_f~~CallsGraph_edge35" class="edge"><title>proc~get_total_cx_rate&#45;&gt;proc~neutral_cx_rate</title>
<path fill="none" stroke="#000000" d="M185.572,-459.141C195.213,-457.721 205.435,-456.215 215.278,-454.765"/>
<polygon fill="#000000" stroke="#000000" points="215.975,-458.2 225.358,-453.281 214.955,-451.275 215.975,-458.2"/>
</g>
<!-- proc~store_npa&#45;&gt;proc~get_fields -->
<g id="proc~~npa_f~~CallsGraph_edge36" class="edge"><title>proc~store_npa&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M159.44,-600.042C180.733,-612.587 214.297,-632.361 238.469,-646.602"/>
<polygon fill="#000000" stroke="#000000" points="236.835,-649.702 247.228,-651.762 240.389,-643.671 236.835,-649.702"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_node42" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~npa_f~~CallsGraph_node42"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="606,-598 538,-598 538,-574 606,-574 606,-598"/>
<text text-anchor="middle" x="572" y="-583.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~store_npa&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge37" class="edge"><title>proc~store_npa&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M168.693,-587.863C243.522,-587.516 440.089,-586.606 527.74,-586.2"/>
<polygon fill="#000000" stroke="#000000" points="527.89,-589.7 537.873,-586.153 527.857,-582.7 527.89,-589.7"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~npa_f~~CallsGraph_node24" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~npa_f~~CallsGraph_node24"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="454.5,-482 393.5,-482 393.5,-458 454.5,-458 454.5,-482"/>
<text text-anchor="middle" x="424" y="-467.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~npa_f~~CallsGraph_edge38" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M300.316,-515.994C315.758,-509.923 334.847,-502.487 352,-496 362.235,-492.129 373.333,-488.023 383.646,-484.244"/>
<polygon fill="#000000" stroke="#000000" points="385.047,-487.458 393.24,-480.74 382.646,-480.883 385.047,-487.458"/>
</g>
<!-- proc~get_position -->
<g id="proc~~npa_f~~CallsGraph_node33" class="node"><title>proc~get_position</title>
<g id="a_proc~~npa_f~~CallsGraph_node33"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="459,-718 389,-718 389,-694 459,-694 459,-718"/>
<text text-anchor="middle" x="424" y="-703.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~npa_f~~CallsGraph_edge40" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M274.963,-540.346C288.607,-573.735 327.305,-664.679 352,-685 359.817,-691.432 369.543,-695.894 379.264,-698.989"/>
<polygon fill="#000000" stroke="#000000" points="378.342,-702.366 388.913,-701.652 380.204,-695.618 378.342,-702.366"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_node40" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~npa_f~~CallsGraph_node40"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="716,-679 648,-679 648,-655 716,-655 716,-679"/>
<text text-anchor="middle" x="682" y="-664.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_edge39" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M303.019,-522.19C368.208,-512.59 515.481,-500.371 612,-565 641.534,-584.776 661.808,-621.884 672.394,-645.472"/>
<polygon fill="#000000" stroke="#000000" points="669.178,-646.853 676.336,-654.663 675.611,-644.093 669.178,-646.853"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge41" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M303.073,-534.373C357.788,-544.916 467.121,-565.983 527.842,-577.684"/>
<polygon fill="#000000" stroke="#000000" points="527.39,-581.161 537.872,-579.617 528.715,-574.288 527.39,-581.161"/>
</g>
<!-- proc~attenuate&#45;&gt;proc~get_plasma -->
<g id="proc~~npa_f~~CallsGraph_edge42" class="edge"><title>proc~attenuate&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M167.31,-512.389C184.158,-515.001 205.878,-518.369 224.829,-521.307"/>
<polygon fill="#000000" stroke="#000000" points="224.317,-524.769 234.735,-522.843 225.389,-517.852 224.317,-524.769"/>
</g>
<!-- proc~colrad -->
<g id="proc~~npa_f~~CallsGraph_node31" class="node"><title>proc~colrad</title>
<g id="a_proc~~npa_f~~CallsGraph_node31"><a xlink:href=".././proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="296,-377 242,-377 242,-353 296,-353 296,-377"/>
<text text-anchor="middle" x="269" y="-362.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~attenuate&#45;&gt;proc~colrad -->
<g id="proc~~npa_f~~CallsGraph_edge43" class="edge"><title>proc~attenuate&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M167.047,-498.849C173.747,-495.79 180.534,-491.881 186,-487 209.481,-466.032 204.495,-452.165 222,-426 231.286,-412.12 242.565,-397.138 251.63,-385.495"/>
<polygon fill="#000000" stroke="#000000" points="254.631,-387.34 258.061,-377.316 249.129,-383.014 254.631,-387.34"/>
</g>
<!-- proc~approx_eq -->
<g id="proc~~npa_f~~CallsGraph_node15" class="node"><title>proc~approx_eq</title>
<g id="a_proc~~npa_f~~CallsGraph_node15"><a xlink:href=".././proc/approx_eq.html" xlink:title="approx_eq">
<polygon fill="#d94e8f" stroke="#d94e8f" points="301,-129 237,-129 237,-105 301,-105 301,-129"/>
<text text-anchor="middle" x="269" y="-114.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_eq</text>
</a>
</g>
</g>
<!-- proc~npa_gyro_range&#45;&gt;proc~approx_eq -->
<g id="proc~~npa_f~~CallsGraph_edge44" class="edge"><title>proc~npa_gyro_range&#45;&gt;proc~approx_eq</title>
<path fill="none" stroke="#000000" d="M176.041,-373.98C179.832,-371.509 183.282,-368.547 186,-365 248.14,-283.924 160.188,-219.326 222,-138 223.793,-135.641 225.913,-133.539 228.242,-131.668"/>
<polygon fill="#000000" stroke="#000000" points="230.289,-134.512 236.797,-126.152 226.496,-128.629 230.289,-134.512"/>
</g>
<!-- proc~gyro_range -->
<g id="proc~~npa_f~~CallsGraph_node20" class="node"><title>proc~gyro_range</title>
<g id="a_proc~~npa_f~~CallsGraph_node20"><a xlink:href=".././proc/gyro_range.html" xlink:title="gyro_range">
<polygon fill="#d9534f" stroke="#d9534f" points="302.5,-171 235.5,-171 235.5,-147 302.5,-147 302.5,-171"/>
<text text-anchor="middle" x="269" y="-156.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_range</text>
</a>
</g>
</g>
<!-- proc~npa_gyro_range&#45;&gt;proc~gyro_range -->
<g id="proc~~npa_f~~CallsGraph_edge45" class="edge"><title>proc~npa_gyro_range&#45;&gt;proc~gyro_range</title>
<path fill="none" stroke="#000000" d="M175.841,-373.822C179.666,-371.378 183.179,-368.465 186,-365 233.117,-307.131 184.697,-265.632 222,-201 227.081,-192.196 234.633,-184.195 242.156,-177.593"/>
<polygon fill="#000000" stroke="#000000" points="244.674,-180.055 250.189,-171.009 240.237,-174.641 244.674,-180.055"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_f~~CallsGraph_edge46" class="edge"><title>proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M297.357,-1126.2C303.519,-1129.02 310.007,-1132.07 316,-1135 341.754,-1147.61 370.529,-1162.73 391.747,-1174.08"/>
<polygon fill="#000000" stroke="#000000" points="390.169,-1177.2 400.635,-1178.85 393.479,-1171.03 390.169,-1177.2"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_node46" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="611.5,-1232 532.5,-1232 532.5,-1208 611.5,-1208 611.5,-1232"/>
<text text-anchor="middle" x="572" y="-1217.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge47" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.888,-1112.26C362.318,-1112.21 438.112,-1117.34 496,-1146 520.988,-1158.37 542.809,-1182.24 556.375,-1199.54"/>
<polygon fill="#000000" stroke="#000000" points="553.866,-1202.02 562.69,-1207.89 559.448,-1197.8 553.866,-1202.02"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge48" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M468.193,-1037.41C478.183,-1040.52 488.167,-1045.14 496,-1052 540.642,-1091.09 559.989,-1161.92 567.243,-1197.84"/>
<polygon fill="#000000" stroke="#000000" points="563.828,-1198.61 569.121,-1207.79 570.706,-1197.31 563.828,-1198.61"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~npa_f~~CallsGraph_edge49" class="edge"><title>proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M399.529,-1377.01C390.984,-1385.97 399.141,-1395 424,-1395 439.149,-1395 448.095,-1391.65 450.839,-1387"/>
<polygon fill="#000000" stroke="#000000" points="454.184,-1385.94 448.471,-1377.01 447.373,-1387.55 454.184,-1385.94"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge50" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M468.322,-1354.25C478.086,-1350.49 487.935,-1345.52 496,-1339 528.528,-1312.71 551.101,-1268.34 562.48,-1241.84"/>
<polygon fill="#000000" stroke="#000000" points="565.831,-1242.9 566.417,-1232.32 559.362,-1240.22 565.831,-1242.9"/>
</g>
<!-- proc~gyro_range&#45;&gt;proc~in_boundary -->
<g id="proc~~npa_f~~CallsGraph_edge51" class="edge"><title>proc~gyro_range&#45;&gt;proc~in_boundary</title>
<path fill="none" stroke="#000000" d="M291.073,-171.172C307.342,-180.227 330.614,-192.447 352,-201 360.325,-204.329 369.384,-207.404 378.159,-210.114"/>
<polygon fill="#000000" stroke="#000000" points="377.309,-213.513 387.892,-213.015 379.308,-206.804 377.309,-213.513"/>
</g>
<!-- proc~gyro_range&#45;&gt;proc~line_plane_intersect -->
<g id="proc~~npa_f~~CallsGraph_edge56" class="edge"><title>proc~gyro_range&#45;&gt;proc~line_plane_intersect</title>
<path fill="none" stroke="#000000" d="M302.822,-163.505C319.422,-165.783 340.147,-168.628 359.689,-171.31"/>
<polygon fill="#000000" stroke="#000000" points="359.388,-174.802 369.772,-172.694 360.34,-167.867 359.388,-174.802"/>
</g>
<!-- proc~gyro_surface_coordinates -->
<g id="proc~~npa_f~~CallsGraph_node44" class="node"><title>proc~gyro_surface_coordinates</title>
<g id="a_proc~~npa_f~~CallsGraph_node44"><a xlink:href=".././proc/gyro_surface_coordinates.html" xlink:title="gyro_surface_coordinates">
<polygon fill="#d9534f" stroke="#d9534f" points="492,-108 356,-108 356,-84 492,-84 492,-108"/>
<text text-anchor="middle" x="424" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_surface_coordinates</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~gyro_surface_coordinates -->
<g id="proc~~npa_f~~CallsGraph_edge52" class="edge"><title>proc~gyro_range&#45;&gt;proc~gyro_surface_coordinates</title>
<path fill="none" stroke="#000000" d="M297.946,-146.782C303.955,-144.005 310.232,-140.989 316,-138 332.446,-129.476 334.996,-124.347 352,-117 356.674,-114.981 361.601,-113.083 366.592,-111.319"/>
<polygon fill="#000000" stroke="#000000" points="367.847,-114.589 376.216,-108.092 365.622,-107.953 367.847,-114.589"/>
</g>
<!-- proc~boundary_edge -->
<g id="proc~~npa_f~~CallsGraph_node48" class="node"><title>proc~boundary_edge</title>
<g id="a_proc~~npa_f~~CallsGraph_node48"><a xlink:href=".././proc/boundary_edge.html" xlink:title="boundary_edge">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-66 380,-66 380,-42 468,-42 468,-66"/>
<text text-anchor="middle" x="424" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boundary_edge</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~boundary_edge -->
<g id="proc~~npa_f~~CallsGraph_edge53" class="edge"><title>proc~gyro_range&#45;&gt;proc~boundary_edge</title>
<path fill="none" stroke="#000000" d="M302.763,-147.166C307.517,-144.592 312.11,-141.552 316,-138 339.816,-116.256 326.715,-95.0164 352,-75 357.417,-70.7116 363.69,-67.2982 370.219,-64.5815"/>
<polygon fill="#000000" stroke="#000000" points="371.687,-67.7724 379.9,-61.0789 369.306,-61.19 371.687,-67.7724"/>
</g>
<!-- proc~line_gyro_surface_intersect -->
<g id="proc~~npa_f~~CallsGraph_node49" class="node"><title>proc~line_gyro_surface_intersect</title>
<g id="a_proc~~npa_f~~CallsGraph_node49"><a xlink:href=".././proc/line_gyro_surface_intersect.html" xlink:title="line_gyro_surface_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="496,-24 352,-24 352,-0 496,-0 496,-24"/>
<text text-anchor="middle" x="424" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">line_gyro_surface_intersect</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~line_gyro_surface_intersect -->
<g id="proc~~npa_f~~CallsGraph_edge54" class="edge"><title>proc~gyro_range&#45;&gt;proc~line_gyro_surface_intersect</title>
<path fill="none" stroke="#000000" d="M302.914,-148.046C307.761,-145.344 312.344,-142.033 316,-138 349.134,-101.45 316.379,-67.1309 352,-33 353.276,-31.7772 354.62,-30.6252 356.021,-29.5398"/>
<polygon fill="#000000" stroke="#000000" points="358.074,-32.3808 364.588,-24.0248 354.285,-26.4949 358.074,-32.3808"/>
</g>
<!-- proc~in_gyro_surface -->
<g id="proc~~npa_f~~CallsGraph_node50" class="node"><title>proc~in_gyro_surface</title>
<g id="a_proc~~npa_f~~CallsGraph_node50"><a xlink:href=".././proc/in_gyro_surface.html" xlink:title="in_gyro_surface">
<polygon fill="#d94e8f" stroke="#d94e8f" points="468.5,-150 379.5,-150 379.5,-126 468.5,-126 468.5,-150"/>
<text text-anchor="middle" x="424" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_gyro_surface</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~in_gyro_surface -->
<g id="proc~~npa_f~~CallsGraph_edge55" class="edge"><title>proc~gyro_range&#45;&gt;proc~in_gyro_surface</title>
<path fill="none" stroke="#000000" d="M302.822,-154.495C322.239,-151.83 347.301,-148.39 369.51,-145.342"/>
<polygon fill="#000000" stroke="#000000" points="370.052,-148.8 379.483,-143.973 369.1,-141.865 370.052,-148.8"/>
</g>
<!-- proc~mc_beam_grid&#45;&gt;interface~randu -->
<g id="proc~~npa_f~~CallsGraph_edge57" class="edge"><title>proc~mc_beam_grid&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M303.949,-760.105C308.329,-762.602 312.499,-765.548 316,-769 342.614,-795.241 323.607,-820.694 352,-845 361.765,-853.359 374.735,-858.392 386.916,-861.422"/>
<polygon fill="#000000" stroke="#000000" points="386.367,-864.883 396.874,-863.525 387.813,-858.034 386.367,-864.883"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge60" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M440.349,-482.195C466.046,-502.612 517.913,-543.821 547.991,-567.719"/>
<polygon fill="#000000" stroke="#000000" points="545.85,-570.488 555.857,-573.969 550.205,-565.007 545.85,-570.488"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_node54" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~npa_f~~CallsGraph_node54"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="714.5,-560 649.5,-560 649.5,-536 714.5,-536 714.5,-560"/>
<text text-anchor="middle" x="682" y="-545.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge58" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M454.699,-469.596C492.62,-470.079 559.596,-474.337 612,-496 630.597,-503.688 648.652,-517.598 661.626,-529.099"/>
<polygon fill="#000000" stroke="#000000" points="659.272,-531.689 669.006,-535.871 664.004,-526.531 659.272,-531.689"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_node57" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~npa_f~~CallsGraph_node57"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="610.5,-444 533.5,-444 533.5,-420 610.5,-420 610.5,-444"/>
<text text-anchor="middle" x="572" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_edge59" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M454.545,-462.31C474.36,-457.153 500.891,-450.247 523.625,-444.33"/>
<polygon fill="#000000" stroke="#000000" points="524.638,-447.684 533.434,-441.777 522.875,-440.909 524.638,-447.684"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~npa_f~~CallsGraph_edge61" class="edge"><title>proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M313.026,-1334.81C330.708,-1339.66 351.361,-1345.33 369.964,-1350.44"/>
<polygon fill="#000000" stroke="#000000" points="369.197,-1353.86 379.767,-1353.13 371.05,-1347.11 369.197,-1353.86"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge62" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M313.14,-1317.92C359.756,-1311.33 435.488,-1297.42 496,-1271 515.001,-1262.7 534.297,-1249.45 548.558,-1238.53"/>
<polygon fill="#000000" stroke="#000000" points="551.04,-1241.03 556.739,-1232.1 546.714,-1235.53 551.04,-1241.03"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_f~~CallsGraph_edge63" class="edge"><title>proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M399.529,-1203.01C390.984,-1211.97 399.141,-1221 424,-1221 439.149,-1221 448.095,-1217.65 450.839,-1213"/>
<polygon fill="#000000" stroke="#000000" points="454.184,-1211.94 448.471,-1203.01 447.373,-1213.55 454.184,-1211.94"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge64" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M469.598,-1199.86C486.126,-1203.14 504.956,-1206.88 521.865,-1210.24"/>
<polygon fill="#000000" stroke="#000000" points="521.618,-1213.76 532.108,-1212.27 522.982,-1206.89 521.618,-1213.76"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_f~~CallsGraph_edge65" class="edge"><title>proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M298.002,-1265.89C304.008,-1263.11 310.269,-1260.06 316,-1257 344.133,-1241.98 375.012,-1222.6 396.335,-1208.74"/>
<polygon fill="#000000" stroke="#000000" points="398.403,-1211.56 404.853,-1203.16 394.569,-1205.71 398.403,-1211.56"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge66" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.649,-1274.24C360.586,-1269.78 433.986,-1260.99 496,-1246 507.5,-1243.22 519.722,-1239.38 530.888,-1235.5"/>
<polygon fill="#000000" stroke="#000000" points="532.142,-1238.77 540.384,-1232.12 529.789,-1232.18 532.142,-1238.77"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~npa_f~~CallsGraph_edge68" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M279.571,-651.864C305.169,-619.406 375.412,-530.34 407.111,-490.147"/>
<polygon fill="#000000" stroke="#000000" points="409.988,-492.15 413.433,-482.131 404.492,-487.816 409.988,-492.15"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~npa_f~~CallsGraph_edge67" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M298.063,-671.703C320.782,-677.94 353.184,-686.835 379.297,-694.003"/>
<polygon fill="#000000" stroke="#000000" points="378.394,-697.385 388.964,-696.657 380.247,-690.634 378.394,-697.385"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_edge70" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M298.338,-674.595C304.449,-677.507 310.669,-680.988 316,-685 335.643,-699.785 329.664,-716.727 352,-727 454.643,-774.209 591.333,-714.983 651.006,-683.851"/>
<polygon fill="#000000" stroke="#000000" points="652.721,-686.904 659.905,-679.117 649.433,-680.724 652.721,-686.904"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge71" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M298.047,-656.732C350.858,-643.047 465.359,-613.375 527.973,-597.15"/>
<polygon fill="#000000" stroke="#000000" points="529.126,-600.467 537.928,-594.57 527.37,-593.691 529.126,-600.467"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~npa_f~~CallsGraph_node55" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~npa_f~~CallsGraph_node55"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="474,-676 374,-676 374,-652 474,-652 474,-676"/>
<text text-anchor="middle" x="424" y="-661.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~npa_f~~CallsGraph_edge69" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M298.063,-664C316.391,-664 341.022,-664 363.569,-664"/>
<polygon fill="#000000" stroke="#000000" points="363.751,-667.5 373.751,-664 363.751,-660.5 363.751,-667.5"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~npa_f~~CallsGraph_edge72" class="edge"><title>proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M313.026,-1392.31C330.708,-1387.92 351.361,-1382.79 369.964,-1378.17"/>
<polygon fill="#000000" stroke="#000000" points="370.905,-1381.55 379.767,-1375.74 369.218,-1374.75 370.905,-1381.55"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge73" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M307.684,-1415.08C355.78,-1428.02 439.505,-1441.98 496,-1404 550.691,-1367.23 565.522,-1282.87 569.528,-1242.43"/>
<polygon fill="#000000" stroke="#000000" points="573.032,-1242.52 570.395,-1232.26 566.058,-1241.93 573.032,-1242.52"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~npa_f~~CallsGraph_node45" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~npa_f~~CallsGraph_node45"><a xlink:href=".././proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-398 380,-398 380,-374 468,-374 468,-398"/>
<text text-anchor="middle" x="424" y="-383.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~npa_f~~CallsGraph_edge74" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M296.302,-368.61C316.427,-371.372 344.85,-375.274 369.677,-378.681"/>
<polygon fill="#000000" stroke="#000000" points="369.32,-382.165 379.703,-380.057 370.272,-375.23 369.32,-382.165"/>
</g>
<!-- proc~linsolve -->
<g id="proc~~npa_f~~CallsGraph_node47" class="node"><title>proc~linsolve</title>
<g id="a_proc~~npa_f~~CallsGraph_node47"><a xlink:href=".././proc/linsolve.html" xlink:title="linsolve">
<polygon fill="#d9534f" stroke="#d9534f" points="451,-356 397,-356 397,-332 451,-332 451,-356"/>
<text text-anchor="middle" x="424" y="-341.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linsolve</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~linsolve -->
<g id="proc~~npa_f~~CallsGraph_edge76" class="edge"><title>proc~colrad&#45;&gt;proc~linsolve</title>
<path fill="none" stroke="#000000" d="M296.302,-361.39C321.227,-357.969 358.881,-352.801 386.667,-348.987"/>
<polygon fill="#000000" stroke="#000000" points="387.355,-352.425 396.786,-347.598 386.403,-345.49 387.355,-352.425"/>
</g>
<!-- proc~eigen -->
<g id="proc~~npa_f~~CallsGraph_node56" class="node"><title>proc~eigen</title>
<g id="a_proc~~npa_f~~CallsGraph_node56"><a xlink:href=".././proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="451,-276 397,-276 397,-252 451,-252 451,-276"/>
<text text-anchor="middle" x="424" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~npa_f~~CallsGraph_edge75" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M288.455,-352.817C315.221,-335.148 364.982,-302.299 395.911,-281.882"/>
<polygon fill="#000000" stroke="#000000" points="398.062,-284.656 404.479,-276.226 394.205,-278.814 398.062,-284.656"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_f~~CallsGraph_edge77" class="edge"><title>proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M311.001,-1223.94C329.856,-1218.4 352.408,-1211.76 372.317,-1205.91"/>
<polygon fill="#000000" stroke="#000000" points="373.545,-1209.19 382.151,-1203.01 371.57,-1202.48 373.545,-1209.19"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge78" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.671,-1236.21C360.314,-1236.09 433.203,-1235.01 496,-1230 504.471,-1229.32 513.449,-1228.35 522.138,-1227.28"/>
<polygon fill="#000000" stroke="#000000" points="522.691,-1230.73 532.157,-1225.98 521.79,-1223.79 522.691,-1230.73"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_node53" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~npa_f~~CallsGraph_node53"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="603,-679 541,-679 541,-655 603,-655 603,-679"/>
<text text-anchor="middle" x="572" y="-664.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_edge79" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M459.231,-696.856C480.719,-691.116 508.521,-683.69 531.021,-677.679"/>
<polygon fill="#000000" stroke="#000000" points="532.186,-680.991 540.944,-675.029 530.379,-674.228 532.186,-680.991"/>
</g>
<!-- proc~rng_seed -->
<g id="proc~~npa_f~~CallsGraph_node43" class="node"><title>proc~rng_seed</title>
<g id="a_proc~~npa_f~~CallsGraph_node43"><a xlink:href=".././proc/rng_seed.html" xlink:title="rng_seed">
<polygon fill="#d94e8f" stroke="#d94e8f" points="453,-920 395,-920 395,-896 453,-896 453,-920"/>
<text text-anchor="middle" x="424" y="-905.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rng_seed</text>
</a>
</g>
</g>
<!-- proc~rng_init&#45;&gt;proc~rng_seed -->
<g id="proc~~npa_f~~CallsGraph_edge80" class="edge"><title>proc~rng_init&#45;&gt;proc~rng_seed</title>
<path fill="none" stroke="#000000" d="M296.302,-876.532C320.804,-882.618 357.607,-891.759 385.245,-898.623"/>
<polygon fill="#000000" stroke="#000000" points="384.423,-902.025 394.972,-901.039 386.111,-895.232 384.423,-902.025"/>
</g>
<!-- proc~my_rank -->
<g id="proc~~npa_f~~CallsGraph_node58" class="node"><title>proc~my_rank</title>
<g id="a_proc~~npa_f~~CallsGraph_node58"><a xlink:href=".././proc/my_rank.html" xlink:title="my_rank">
<polygon fill="#d94e8f" stroke="#d94e8f" points="451,-962 397,-962 397,-938 451,-938 451,-962"/>
<text text-anchor="middle" x="424" y="-947.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">my_rank</text>
</a>
</g>
</g>
<!-- proc~rng_init&#45;&gt;proc~my_rank -->
<g id="proc~~npa_f~~CallsGraph_edge81" class="edge"><title>proc~rng_init&#45;&gt;proc~my_rank</title>
<path fill="none" stroke="#000000" d="M296.266,-879.895C302.984,-882.979 310,-886.713 316,-891 334.93,-904.524 332.166,-916.84 352,-929 362.51,-935.444 375.11,-940.007 386.759,-943.194"/>
<polygon fill="#000000" stroke="#000000" points="386.126,-946.643 396.675,-945.653 387.811,-939.849 386.126,-946.643"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_f~~CallsGraph_edge82" class="edge"><title>proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M314.665,-1166.22C331.402,-1170.05 350.614,-1174.44 368.167,-1178.46"/>
<polygon fill="#000000" stroke="#000000" points="367.751,-1181.95 378.279,-1180.77 369.312,-1175.13 367.751,-1181.95"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge83" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.624,-1152.05C361.177,-1149.46 435.648,-1149.67 496,-1170 515.773,-1176.66 535.293,-1189.95 549.461,-1201.15"/>
<polygon fill="#000000" stroke="#000000" points="547.593,-1204.14 557.545,-1207.78 552.031,-1198.73 547.593,-1204.14"/>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge84" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M469.841,-1084.29C479.111,-1087.98 488.366,-1092.78 496,-1099 529.136,-1125.99 551.725,-1171.72 562.898,-1198.56"/>
<polygon fill="#000000" stroke="#000000" points="559.65,-1199.87 566.62,-1207.85 566.148,-1197.26 559.65,-1199.87"/>
</g>
<!-- proc~get_distribution&#45;&gt;proc~get_position -->
<g id="proc~~npa_f~~CallsGraph_edge85" class="edge"><title>proc~get_distribution&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M311.808,-706C332.642,-706 357.83,-706 378.962,-706"/>
<polygon fill="#000000" stroke="#000000" points="378.973,-709.5 388.973,-706 378.973,-702.5 378.973,-709.5"/>
</g>
<!-- proc~get_distribution&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge86" class="edge"><title>proc~get_distribution&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M295.861,-718.052C340.623,-736.959 433.718,-767.475 496,-727 529.033,-705.533 513.206,-680.624 532,-646 539.389,-632.387 548.831,-617.803 556.573,-606.422"/>
<polygon fill="#000000" stroke="#000000" points="559.545,-608.279 562.347,-598.062 553.784,-604.302 559.545,-608.279"/>
</g>
<!-- interface~interpol -->
<g id="proc~~npa_f~~CallsGraph_node51" class="node"><title>interface~interpol</title>
<g id="a_proc~~npa_f~~CallsGraph_node51"><a xlink:href=".././interface/interpol.html" xlink:title="interpol">
<polygon fill="#a7506f" stroke="#a7506f" points="451,-836 397,-836 397,-812 451,-812 451,-836"/>
<text text-anchor="middle" x="424" y="-821.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol</text>
</a>
</g>
</g>
<!-- proc~get_distribution&#45;&gt;interface~interpol -->
<g id="proc~~npa_f~~CallsGraph_edge87" class="edge"><title>proc~get_distribution&#45;&gt;interface~interpol</title>
<path fill="none" stroke="#000000" d="M303.865,-718.192C308.257,-720.676 312.453,-723.596 316,-727 341.525,-751.499 325.548,-774.504 352,-798 361.814,-806.717 374.795,-812.592 386.971,-816.514"/>
<polygon fill="#000000" stroke="#000000" points="386.344,-819.975 396.922,-819.369 388.275,-813.247 386.344,-819.975"/>
</g>
<!-- proc~bb_cx_rates -->
<g id="proc~~npa_f~~CallsGraph_node52" class="node"><title>proc~bb_cx_rates</title>
<g id="a_proc~~npa_f~~CallsGraph_node52"><a xlink:href=".././proc/bb_cx_rates.html" xlink:title="bb_cx_rates">
<polygon fill="#d9534f" stroke="#d9534f" points="459.5,-440 388.5,-440 388.5,-416 459.5,-416 459.5,-440"/>
<text text-anchor="middle" x="424" y="-425.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bb_cx_rates</text>
</a>
</g>
</g>
<!-- proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates -->
<g id="proc~~npa_f~~CallsGraph_edge88" class="edge"><title>proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates</title>
<path fill="none" stroke="#000000" d="M312.619,-441.707C333.042,-439.171 357.503,-436.134 378.201,-433.563"/>
<polygon fill="#000000" stroke="#000000" points="378.84,-437.011 388.333,-432.305 377.978,-430.064 378.84,-437.011"/>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_edge89" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M466.745,-398.089C476.373,-400.948 486.558,-404.031 496,-407 505.722,-410.057 516.113,-413.444 525.968,-416.712"/>
<polygon fill="#000000" stroke="#000000" points="525.006,-420.08 535.6,-419.924 527.22,-413.44 525.006,-420.08"/>
</g>
<!-- dgetrs -->
<g id="proc~~npa_f~~CallsGraph_node61" class="node"><title>dgetrs</title>
<polygon fill="#777777" stroke="#777777" points="599,-402 545,-402 545,-378 599,-378 599,-402"/>
<text text-anchor="middle" x="572" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrs</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrs -->
<g id="proc~~npa_f~~CallsGraph_edge92" class="edge"><title>proc~linsolve&#45;&gt;dgetrs</title>
<path fill="none" stroke="#000000" d="M451.031,-351.468C464.49,-355.388 481.163,-360.334 496,-365 508.811,-369.028 522.785,-373.629 535.162,-377.777"/>
<polygon fill="#000000" stroke="#000000" points="534.098,-381.112 544.692,-380.986 536.332,-374.478 534.098,-381.112"/>
</g>
<!-- proc~matinv -->
<g id="proc~~npa_f~~CallsGraph_node64" class="node"><title>proc~matinv</title>
<g id="a_proc~~npa_f~~CallsGraph_node64"><a xlink:href=".././proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-360 545,-360 545,-336 599,-336 599,-360"/>
<text text-anchor="middle" x="572" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~linsolve&#45;&gt;proc~matinv -->
<g id="proc~~npa_f~~CallsGraph_edge90" class="edge"><title>proc~linsolve&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M451.102,-344.715C474.314,-345.351 508.498,-346.288 534.432,-346.998"/>
<polygon fill="#000000" stroke="#000000" points="534.54,-350.502 544.632,-347.278 534.731,-343.505 534.54,-350.502"/>
</g>
<!-- dgetrf -->
<g id="proc~~npa_f~~CallsGraph_node65" class="node"><title>dgetrf</title>
<polygon fill="#777777" stroke="#777777" points="599,-318 545,-318 545,-294 599,-294 599,-318"/>
<text text-anchor="middle" x="572" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrf</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrf -->
<g id="proc~~npa_f~~CallsGraph_edge91" class="edge"><title>proc~linsolve&#45;&gt;dgetrf</title>
<path fill="none" stroke="#000000" d="M451.102,-337.206C474.418,-331.138 508.802,-322.188 534.778,-315.428"/>
<polygon fill="#000000" stroke="#000000" points="535.836,-318.769 544.632,-312.863 534.073,-311.995 535.836,-318.769"/>
</g>
<!-- proc~bb_cx_rates&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_edge93" class="edge"><title>proc~bb_cx_rates&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M459.6,-428.948C478.572,-429.468 502.381,-430.12 523.114,-430.688"/>
<polygon fill="#000000" stroke="#000000" points="523.228,-434.192 533.32,-430.968 523.419,-427.195 523.228,-434.192"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_edge95" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M603.084,-667C613.693,-667 625.844,-667 637.346,-667"/>
<polygon fill="#000000" stroke="#000000" points="637.662,-670.5 647.662,-667 637.662,-663.5 637.662,-670.5"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge94" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M584.151,-654.713C602.841,-634.119 640.645,-592.465 663.095,-567.728"/>
<polygon fill="#000000" stroke="#000000" points="665.942,-569.8 670.07,-560.043 660.758,-565.096 665.942,-569.8"/>
</g>
<!-- proc~balback -->
<g id="proc~~npa_f~~CallsGraph_node59" class="node"><title>proc~balback</title>
<g id="a_proc~~npa_f~~CallsGraph_node59"><a xlink:href=".././proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-276 545,-276 545,-252 599,-252 599,-276"/>
<text text-anchor="middle" x="572" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~npa_f~~CallsGraph_edge96" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M451.102,-264C474.314,-264 508.498,-264 534.432,-264"/>
<polygon fill="#000000" stroke="#000000" points="534.632,-267.5 544.632,-264 534.632,-260.5 534.632,-267.5"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~npa_f~~CallsGraph_node60" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~npa_f~~CallsGraph_node60"><a xlink:href=".././proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-150 545,-150 545,-126 599,-126 599,-150"/>
<text text-anchor="middle" x="572" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~npa_f~~CallsGraph_edge97" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M451.278,-261.699C465.954,-259.182 483.704,-253.932 496,-243 526.355,-216.012 504.586,-188.971 532,-159 533.362,-157.51 534.856,-156.106 536.438,-154.784"/>
<polygon fill="#000000" stroke="#000000" points="538.72,-157.459 544.907,-148.858 534.707,-151.723 538.72,-157.459"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~npa_f~~CallsGraph_node62" class="node"><title>proc~elmhes</title>
<g id="a_proc~~npa_f~~CallsGraph_node62"><a xlink:href=".././proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-234 545,-234 545,-210 599,-210 599,-234"/>
<text text-anchor="middle" x="572" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~npa_f~~CallsGraph_edge98" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M451.102,-256.491C474.418,-249.784 508.802,-239.892 534.778,-232.42"/>
<polygon fill="#000000" stroke="#000000" points="535.989,-235.714 544.632,-229.585 534.054,-228.986 535.989,-235.714"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~npa_f~~CallsGraph_node63" class="node"><title>proc~hqr2</title>
<g id="a_proc~~npa_f~~CallsGraph_node63"><a xlink:href=".././proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-108 545,-108 545,-84 599,-84 599,-108"/>
<text text-anchor="middle" x="572" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~npa_f~~CallsGraph_edge99" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M451.121,-262.373C466.114,-260.101 484.239,-254.871 496,-243 536.991,-201.627 495.488,-162.375 532,-117 533.41,-115.248 535.007,-113.621 536.73,-112.116"/>
<polygon fill="#000000" stroke="#000000" points="538.807,-114.933 544.899,-106.266 534.731,-109.242 538.807,-114.933"/>
</g>
<!-- proc~balance -->
<g id="proc~~npa_f~~CallsGraph_node66" class="node"><title>proc~balance</title>
<g id="a_proc~~npa_f~~CallsGraph_node66"><a xlink:href=".././proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-192 545,-192 545,-168 599,-168 599,-192"/>
<text text-anchor="middle" x="572" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~npa_f~~CallsGraph_edge100" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M451.154,-259.994C465.271,-256.948 482.515,-251.737 496,-243 516.634,-229.632 512.853,-216.422 532,-201 533.527,-199.77 535.137,-198.577 536.798,-197.425"/>
<polygon fill="#000000" stroke="#000000" points="538.774,-200.317 545.382,-192.035 535.052,-194.388 538.774,-200.317"/>
</g>
<!-- proc~rswap -->
<g id="proc~~npa_f~~CallsGraph_node68" class="node"><title>proc~rswap</title>
<g id="a_proc~~npa_f~~CallsGraph_node68"><a xlink:href=".././proc/rswap.html" xlink:title="RSWAP">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-234 655,-234 655,-210 709,-210 709,-234"/>
<text text-anchor="middle" x="682" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RSWAP</text>
</a>
</g>
</g>
<!-- proc~balback&#45;&gt;proc~rswap -->
<g id="proc~~npa_f~~CallsGraph_edge101" class="edge"><title>proc~balback&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M599.144,-253.833C612.971,-248.456 630.153,-241.774 645.2,-235.922"/>
<polygon fill="#000000" stroke="#000000" points="646.671,-239.106 654.723,-232.219 644.134,-232.581 646.671,-239.106"/>
</g>
<!-- proc~elmhes&#45;&gt;proc~rswap -->
<g id="proc~~npa_f~~CallsGraph_edge102" class="edge"><title>proc~elmhes&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M599.144,-222C612.707,-222 629.499,-222 644.338,-222"/>
<polygon fill="#000000" stroke="#000000" points="644.723,-225.5 654.723,-222 644.723,-218.5 644.723,-225.5"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~npa_f~~CallsGraph_node67" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~npa_f~~CallsGraph_node67"><a xlink:href=".././proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-108 655,-108 655,-84 709,-84 709,-108"/>
<text text-anchor="middle" x="682" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~npa_f~~CallsGraph_edge103" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M599.144,-96C612.707,-96 629.499,-96 644.338,-96"/>
<polygon fill="#000000" stroke="#000000" points="644.723,-99.5001 654.723,-96 644.723,-92.5001 644.723,-99.5001"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~npa_f~~CallsGraph_node69" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~npa_f~~CallsGraph_node69"><a xlink:href=".././proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-381 655,-381 655,-357 709,-357 709,-381"/>
<text text-anchor="middle" x="682" y="-366.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~npa_f~~CallsGraph_edge104" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M599.144,-353.084C612.839,-355.746 629.826,-359.049 644.769,-361.955"/>
<polygon fill="#000000" stroke="#000000" points="644.238,-365.417 654.723,-363.891 645.575,-358.546 644.238,-365.417"/>
</g>
<!-- proc~lubksb -->
<g id="proc~~npa_f~~CallsGraph_node70" class="node"><title>proc~lubksb</title>
<g id="a_proc~~npa_f~~CallsGraph_node70"><a xlink:href=".././proc/lubksb.html" xlink:title="lubksb">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-339 655,-339 655,-315 709,-315 709,-339"/>
<text text-anchor="middle" x="682" y="-324.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lubksb</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~lubksb -->
<g id="proc~~npa_f~~CallsGraph_edge105" class="edge"><title>proc~matinv&#45;&gt;proc~lubksb</title>
<path fill="none" stroke="#000000" d="M599.144,-342.916C612.839,-340.254 629.826,-336.951 644.769,-334.045"/>
<polygon fill="#000000" stroke="#000000" points="645.575,-337.454 654.723,-332.109 644.238,-330.583 645.575,-337.454"/>
</g>
<!-- proc~balance&#45;&gt;proc~rswap -->
<g id="proc~~npa_f~~CallsGraph_edge106" class="edge"><title>proc~balance&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M599.144,-190.167C612.971,-195.544 630.153,-202.226 645.2,-208.078"/>
<polygon fill="#000000" stroke="#000000" points="644.134,-211.419 654.723,-211.781 646.671,-204.894 644.134,-211.419"/>
</g>
<!-- proc~comdiv -->
<g id="proc~~npa_f~~CallsGraph_node72" class="node"><title>proc~comdiv</title>
<g id="a_proc~~npa_f~~CallsGraph_node72"><a xlink:href=".././proc/comdiv.html" xlink:title="Comdiv">
<polygon fill="#d9534f" stroke="#d9534f" points="809,-108 755,-108 755,-84 809,-84 809,-108"/>
<text text-anchor="middle" x="782" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Comdiv</text>
</a>
</g>
</g>
<!-- proc~hqrvec&#45;&gt;proc~comdiv -->
<g id="proc~~npa_f~~CallsGraph_edge107" class="edge"><title>proc~hqrvec&#45;&gt;proc~comdiv</title>
<path fill="none" stroke="#000000" d="M709.005,-96C719.969,-96 732.92,-96 744.794,-96"/>
<polygon fill="#000000" stroke="#000000" points="744.874,-99.5001 754.874,-96 744.874,-92.5001 744.874,-99.5001"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~npa_f~~CallsGraph_node71" class="node"><title>proc~outerprod</title>
<g id="a_proc~~npa_f~~CallsGraph_node71"><a xlink:href=".././proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="811.5,-360 752.5,-360 752.5,-336 811.5,-336 811.5,-360"/>
<text text-anchor="middle" x="782" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~npa_f~~CallsGraph_edge108" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M709.005,-363.428C719.251,-361.232 731.231,-358.665 742.446,-356.261"/>
<polygon fill="#000000" stroke="#000000" points="743.414,-359.634 752.459,-354.116 741.947,-352.789 743.414,-359.634"/>
</g>
<!-- proc~swap -->
<g id="proc~~npa_f~~CallsGraph_node73" class="node"><title>proc~swap</title>
<g id="a_proc~~npa_f~~CallsGraph_node73"><a xlink:href=".././proc/swap.html" xlink:title="swap">
<polygon fill="#d9534f" stroke="#d9534f" points="809,-402 755,-402 755,-378 809,-378 809,-402"/>
<text text-anchor="middle" x="782" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swap</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~swap -->
<g id="proc~~npa_f~~CallsGraph_edge109" class="edge"><title>proc~ludcmp&#45;&gt;proc~swap</title>
<path fill="none" stroke="#000000" d="M709.005,-374.572C719.969,-376.922 732.92,-379.697 744.794,-382.242"/>
<polygon fill="#000000" stroke="#000000" points="744.362,-385.728 754.874,-384.401 745.829,-378.884 744.362,-385.728"/>
</g>
</g>
</svg>
</div><script>var panprocnpa_fCallsGraph = svgPanZoom('#procnpa_fCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~npa_f~~CalledByGraph Pages: 1 -->
<svg id="procnpa_fCalledByGraph" width="152pt" height="32pt"
 viewBox="0.00 0.00 152.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~npa_f~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~npa_f~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 148,-28 148,4 -4,4"/>
<!-- proc~npa_f -->
<g id="proc~~npa_f~~CalledByGraph_node1" class="node"><title>proc~npa_f</title>
<polygon fill="none" stroke="black" points="144,-24 90,-24 90,-0 144,-0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">npa_f</text>
</g>
<!-- program~fidasim -->
<g id="proc~~npa_f~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~npa_f~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_f -->
<g id="proc~~npa_f~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~npa_f</title>
<path fill="none" stroke="#000000" d="M54.4029,-12C62.3932,-12 71.3106,-12 79.8241,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.919,-15.5001 89.919,-12 79.919,-8.5001 79.919,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/npa_f.html#src">npa_f</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">npa_f</span><span class="w"></span>
<span class="w">    </span><span class="c">!+ Calculate Active NPA flux using a fast-ion distribution function F(E,p,r,z)</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">det</span><span class="p">,</span><span class="n">ic</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iion</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rg</span><span class="p">,</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ind</span><span class="p">,</span><span class="n">pind</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">denf</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">plasma</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fields</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">GyroSurface</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">gs</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">gyrange</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">neut_types</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rates</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">states</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">flux</span><span class="p">,</span><span class="w"> </span><span class="n">theta</span><span class="p">,</span><span class="w"> </span><span class="n">dtheta</span><span class="p">,</span><span class="w"> </span><span class="n">eb</span><span class="p">,</span><span class="w"> </span><span class="n">ptch</span><span class="w"></span>

<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">inpa</span><span class="p">,</span><span class="n">ichan</span><span class="p">,</span><span class="n">nrange</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">npart</span><span class="p">,</span><span class="n">ncell</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cell_ind</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nx</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ny</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nz</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">papprox</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nx</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ny</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nz</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nlaunch</span><span class="w"></span>

<span class="w">    </span><span class="n">papprox</span><span class="o">=</span><span class="mf">0.d0</span><span class="w"></span>
<span class="w">    </span><span class="k">do </span><span class="n">ic</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">ind2sub</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">ic</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">ind</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">plasma</span><span class="p">%</span><span class="n">in_plasma</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="k">        </span><span class="n">papprox</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                        </span><span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">half</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                        </span><span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">third</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                        </span><span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">dcx</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                        </span><span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">halo</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span><span class="o">*</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                        </span><span class="n">plasma</span><span class="p">%</span><span class="n">denf</span><span class="w"></span>
<span class="w">    </span><span class="k">enddo</span>

<span class="k">    </span><span class="n">ncell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">    </span><span class="k">do </span><span class="n">ic</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">ind2sub</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">ic</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">papprox</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">ncell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ncell</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">cell_ind</span><span class="p">(</span><span class="n">ncell</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ic</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">    enddo</span>

<span class="k">    call </span><span class="n">get_nlaunch</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_npa</span><span class="p">,</span><span class="w"> </span><span class="n">papprox</span><span class="p">,</span><span class="w"> </span><span class="n">nlaunch</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i12)&#39;</span><span class="p">)</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">nlaunch</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span><span class="w"></span>

<span class="w">    </span><span class="c">!! Loop over all cells that can contribute to NPA signal</span>
<span class="w">    </span><span class="c">!$OMP PARALLEL DO schedule(dynamic,1) private(ic,i,j,k,ind,iion,ichan,fields,nrange,gyrange, &amp;</span>
<span class="w">    </span><span class="c">!$OMP&amp; pind,vi,ri,rf,det,plasma,rates,states,flux,denf,eb,ptch,gs,ir,theta,dtheta)</span>
<span class="w">    </span><span class="n">loop_over_cells</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">ic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">istart</span><span class="p">,</span><span class="w"> </span><span class="n">ncell</span><span class="p">,</span><span class="w"> </span><span class="n">istep</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">ind2sub</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">cell_ind</span><span class="p">(</span><span class="n">ic</span><span class="p">),</span><span class="n">ind</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">loop_over_fast_ions</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">iion</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="c">!! Sample fast ion distribution for energy and pitch</span>
<span class="w">            </span><span class="k">call </span><span class="n">mc_fastion</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="w"> </span><span class="n">fields</span><span class="p">,</span><span class="w"> </span><span class="n">eb</span><span class="p">,</span><span class="w"> </span><span class="n">ptch</span><span class="p">,</span><span class="w"> </span><span class="n">denf</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">denf</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">loop_over_fast_ions</span><span class="w"></span>

<span class="w">            </span><span class="k">call </span><span class="n">gyro_surface</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span><span class="w"> </span><span class="n">eb</span><span class="p">,</span><span class="w"> </span><span class="n">ptch</span><span class="p">,</span><span class="w"> </span><span class="n">fbm</span><span class="p">%</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">gs</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">detector_loop</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">ichan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">npa_chords</span><span class="p">%</span><span class="n">nchan</span><span class="w"></span>
<span class="w">                </span><span class="k">call </span><span class="n">npa_gyro_range</span><span class="p">(</span><span class="n">ichan</span><span class="p">,</span><span class="w"> </span><span class="n">gs</span><span class="p">,</span><span class="w"> </span><span class="n">gyrange</span><span class="p">,</span><span class="w"> </span><span class="n">nrange</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="n">nrange</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">detector_loop</span><span class="w"></span>
<span class="w">                </span><span class="n">gyro_range_loop</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">ir</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nrange</span><span class="w"></span>
<span class="w">                    </span><span class="n">dtheta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gyrange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="n">theta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gyrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="n">dtheta</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">gyro_trajectory</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span><span class="w"> </span><span class="n">theta</span><span class="p">,</span><span class="w"> </span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="c">!! Check if particle hits a NPA detector</span>
<span class="w">                    </span><span class="k">call </span><span class="n">hit_npa_detector</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="w"> </span><span class="p">,</span><span class="n">det</span><span class="p">,</span><span class="w"> </span><span class="n">rf</span><span class="p">,</span><span class="w"> </span><span class="n">ichan</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="n">det</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">ichan</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        if</span><span class="w"> </span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="k">                            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;NPA_F: Missed Detector &quot;</span><span class="p">,</span><span class="n">ichan</span><span class="w"></span>
<span class="w">                        </span><span class="k">endif</span>
<span class="k">                        cycle </span><span class="n">gyro_range_loop</span><span class="w"></span>
<span class="w">                    </span><span class="k">endif</span><span class="w"></span>

<span class="w">                    </span><span class="c">!! Get beam grid indices at ri</span>
<span class="w">                    </span><span class="k">call </span><span class="n">get_indices</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">pind</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="c">!! Calculate CX probability with beam and halo neutrals</span>
<span class="w">                    </span><span class="k">call </span><span class="n">get_total_cx_rate</span><span class="p">(</span><span class="n">pind</span><span class="p">,</span><span class="w"> </span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="p">,</span><span class="w"> </span><span class="n">neut_types</span><span class="p">,</span><span class="w"> </span><span class="n">rates</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">gyro_range_loop</span><span class="w"></span>

<span class="w">                    </span><span class="c">!! Weight CX rates by ion source density</span>
<span class="w">                    </span><span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">denf</span><span class="w"></span>

<span class="w">                    </span><span class="c">!! Attenuate states as the particle move through plasma</span>
<span class="w">                    </span><span class="k">call </span><span class="n">attenuate</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">states</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="c">!! Store NPA Flux</span>
<span class="w">                    </span><span class="n">flux</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dtheta</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="o">*</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="o">/</span><span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">store_npa</span><span class="p">(</span><span class="n">det</span><span class="p">,</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">flux</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">enddo </span><span class="n">gyro_range_loop</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo </span><span class="n">detector_loop</span><span class="w"></span>
<span class="w">        </span><span class="k">enddo </span><span class="n">loop_over_fast_ions</span><span class="w"></span>
<span class="w">    </span><span class="k">enddo </span><span class="n">loop_over_cells</span><span class="w"></span>
<span class="w">    </span><span class="c">!$OMP END PARALLEL DO</span>

<span class="w">    </span><span class="n">npart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">npa</span><span class="p">%</span><span class="n">npart</span><span class="w"></span>
<span class="cp">#ifdef _MPI</span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">npart</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">npa</span><span class="p">%</span><span class="n">flux</span><span class="p">)</span><span class="w"></span>
<span class="cp">#endif</span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T4,&quot;Number of Active NPA particles that hit a detector: &quot;,i8)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">npart</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">end subroutine </span><span class="n">npa_f</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>