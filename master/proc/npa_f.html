<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>npa_f &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>npa_f
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.6% of total for procedures.">84 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
    
     <li><a href='../module/libfida.html'>libfida</a></li>
    
  
     <li class="active">npa_f</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/npa_f.html#src">npa_f</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine npa_f()
    
    
   
</h2>
    
  


    
    <p>Calculate Active NPA flux using a fast-ion distribution function F(E,p,r,z)</p>
    

    <h3>Arguments</h3>
    
    <em>None</em>
    <br>
    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~npa_f~~CallsGraph Pages: 1 -->
<svg id="procnpa_fCallsGraph" width="641pt" height="960pt"
 viewBox="0.00 0.00 641.00 959.93" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~npa_f~~CallsGraph" class="graph" transform="scale(0.783619 0.783619) rotate(0) translate(4 1221)">
<title>proc~~npa_f~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1221 814,-1221 814,4 -4,4"/>
<!-- proc~npa_f -->
<g id="proc~~npa_f~~CallsGraph_node1" class="node"><title>proc~npa_f</title>
<polygon fill="none" stroke="black" points="54,-774 0,-774 0,-750 54,-750 54,-774"/>
<text text-anchor="middle" x="27" y="-759.6" font-family="Helvetica,sans-Serif" font-size="10.50">npa_f</text>
</g>
<!-- proc~gyro_surface -->
<g id="proc~~npa_f~~CallsGraph_node2" class="node"><title>proc~gyro_surface</title>
<g id="a_proc~~npa_f~~CallsGraph_node2"><a xlink:href=".././proc/gyro_surface.html" xlink:title="gyro_surface">
<polygon fill="#d9534f" stroke="#d9534f" points="175.5,-1135 100.5,-1135 100.5,-1111 175.5,-1111 175.5,-1135"/>
<text text-anchor="middle" x="138" y="-1120.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_surface</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~gyro_surface -->
<g id="proc~~npa_f~~CallsGraph_edge1" class="edge"><title>proc~npa_f&#45;&gt;proc~gyro_surface</title>
<path fill="none" stroke="#000000" d="M28.7191,-774.131C32.158,-828.472 48.5072,-1049.14 90,-1102 90.807,-1103.03 91.6753,-1104.01 92.595,-1104.94"/>
<polygon fill="#000000" stroke="#000000" points="90.4877,-1107.74 100.496,-1111.21 94.8397,-1102.25 90.4877,-1107.74"/>
</g>
<!-- proc~get_total_cx_rate -->
<g id="proc~~npa_f~~CallsGraph_node3" class="node"><title>proc~get_total_cx_rate</title>
<g id="a_proc~~npa_f~~CallsGraph_node3"><a xlink:href=".././proc/get_total_cx_rate.html" xlink:title="get_total_cx_rate">
<polygon fill="#d9534f" stroke="#d9534f" points="185.5,-692 90.5,-692 90.5,-668 185.5,-668 185.5,-692"/>
<text text-anchor="middle" x="138" y="-677.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_total_cx_rate</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~get_total_cx_rate -->
<g id="proc~~npa_f~~CallsGraph_edge2" class="edge"><title>proc~npa_f&#45;&gt;proc~get_total_cx_rate</title>
<path fill="none" stroke="#000000" d="M37.9233,-749.921C49.3719,-736.582 69.294,-715.127 90,-701 92.1317,-699.546 94.3805,-698.152 96.6928,-696.824"/>
<polygon fill="#000000" stroke="#000000" points="98.5843,-699.784 105.813,-692.039 95.3318,-693.586 98.5843,-699.784"/>
</g>
<!-- proc~mc_fastion -->
<g id="proc~~npa_f~~CallsGraph_node4" class="node"><title>proc~mc_fastion</title>
<g id="a_proc~~npa_f~~CallsGraph_node4"><a xlink:href=".././proc/mc_fastion.html" xlink:title="mc_fastion">
<polygon fill="#d9534f" stroke="#d9534f" points="170,-1093 106,-1093 106,-1069 170,-1069 170,-1093"/>
<text text-anchor="middle" x="138" y="-1078.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_fastion</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~mc_fastion -->
<g id="proc~~npa_f~~CallsGraph_edge3" class="edge"><title>proc~npa_f&#45;&gt;proc~mc_fastion</title>
<path fill="none" stroke="#000000" d="M30.41,-774.033C37.4478,-808.232 59.4216,-908.655 90,-988 99.8608,-1013.59 114.522,-1041.48 124.842,-1059.97"/>
<polygon fill="#000000" stroke="#000000" points="121.824,-1061.75 129.794,-1068.73 127.916,-1058.3 121.824,-1061.75"/>
</g>
<!-- proc~get_nlaunch -->
<g id="proc~~npa_f~~CallsGraph_node5" class="node"><title>proc~get_nlaunch</title>
<g id="a_proc~~npa_f~~CallsGraph_node5"><a xlink:href=".././proc/get_nlaunch.html" xlink:title="get_nlaunch">
<polygon fill="#d9534f" stroke="#d9534f" points="173.5,-898 102.5,-898 102.5,-874 173.5,-874 173.5,-898"/>
<text text-anchor="middle" x="138" y="-883.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_nlaunch</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~get_nlaunch -->
<g id="proc~~npa_f~~CallsGraph_edge4" class="edge"><title>proc~npa_f&#45;&gt;proc~get_nlaunch</title>
<path fill="none" stroke="#000000" d="M32.4478,-774.1C40.7453,-795.173 60.4625,-838.854 90,-865 91.3342,-866.181 92.7457,-867.305 94.2143,-868.375"/>
<polygon fill="#000000" stroke="#000000" points="92.7705,-871.599 103.11,-873.911 96.4692,-865.656 92.7705,-871.599"/>
</g>
<!-- proc~get_indices -->
<g id="proc~~npa_f~~CallsGraph_node6" class="node"><title>proc~get_indices</title>
<g id="a_proc~~npa_f~~CallsGraph_node6"><a xlink:href=".././proc/get_indices.html" xlink:title="get_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="171.5,-856 104.5,-856 104.5,-832 171.5,-832 171.5,-856"/>
<text text-anchor="middle" x="138" y="-841.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_indices</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~get_indices -->
<g id="proc~~npa_f~~CallsGraph_edge5" class="edge"><title>proc~npa_f&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M37.9233,-774.079C49.3719,-787.418 69.294,-808.873 90,-823 92.1317,-824.454 94.3805,-825.848 96.6928,-827.176"/>
<polygon fill="#000000" stroke="#000000" points="95.3318,-830.414 105.813,-831.961 98.5843,-824.216 95.3318,-830.414"/>
</g>
<!-- proc~ind2sub -->
<g id="proc~~npa_f~~CallsGraph_node7" class="node"><title>proc~ind2sub</title>
<g id="a_proc~~npa_f~~CallsGraph_node7"><a xlink:href=".././proc/ind2sub.html" xlink:title="ind2sub">
<polygon fill="#d9534f" stroke="#d9534f" points="165,-814 111,-814 111,-790 165,-790 165,-814"/>
<text text-anchor="middle" x="138" y="-799.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ind2sub</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~ind2sub -->
<g id="proc~~npa_f~~CallsGraph_edge6" class="edge"><title>proc~npa_f&#45;&gt;proc~ind2sub</title>
<path fill="none" stroke="#000000" d="M54.1082,-771.581C68.161,-776.738 85.708,-783.177 101.035,-788.802"/>
<polygon fill="#000000" stroke="#000000" points="100.133,-792.199 110.727,-792.359 102.545,-785.628 100.133,-792.199"/>
</g>
<!-- proc~attenuate -->
<g id="proc~~npa_f~~CallsGraph_node8" class="node"><title>proc~attenuate</title>
<g id="a_proc~~npa_f~~CallsGraph_node8"><a xlink:href=".././proc/attenuate.html" xlink:title="attenuate">
<polygon fill="#d9534f" stroke="#d9534f" points="167,-734 109,-734 109,-710 167,-710 167,-734"/>
<text text-anchor="middle" x="138" y="-719.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">attenuate</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~attenuate -->
<g id="proc~~npa_f~~CallsGraph_edge7" class="edge"><title>proc~npa_f&#45;&gt;proc~attenuate</title>
<path fill="none" stroke="#000000" d="M54.1082,-752.419C67.6444,-747.452 84.4225,-741.295 99.3356,-735.822"/>
<polygon fill="#000000" stroke="#000000" points="100.631,-739.075 108.814,-732.344 98.2199,-732.503 100.631,-739.075"/>
</g>
<!-- proc~hit_npa_detector -->
<g id="proc~~npa_f~~CallsGraph_node9" class="node"><title>proc~hit_npa_detector</title>
<g id="a_proc~~npa_f~~CallsGraph_node9"><a xlink:href=".././proc/hit_npa_detector.html" xlink:title="hit_npa_detector">
<polygon fill="#d9534f" stroke="#d9534f" points="315.5,-192 222.5,-192 222.5,-168 315.5,-168 315.5,-192"/>
<text text-anchor="middle" x="269" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hit_npa_detector</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~hit_npa_detector -->
<g id="proc~~npa_f~~CallsGraph_edge8" class="edge"><title>proc~npa_f&#45;&gt;proc~hit_npa_detector</title>
<path fill="none" stroke="#000000" d="M28.7396,-749.824C32.2169,-696.288 48.5437,-482.25 90,-432 119.202,-396.603 156.821,-429.416 186,-394 241.485,-326.656 168.262,-269.746 222,-201 222.591,-200.243 223.216,-199.513 223.87,-198.809"/>
<polygon fill="#000000" stroke="#000000" points="226.378,-201.276 231.83,-192.192 221.903,-195.893 226.378,-201.276"/>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~npa_f~~CallsGraph_node10" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~npa_f~~CallsGraph_node10"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="174.5,-465 101.5,-465 101.5,-441 174.5,-441 174.5,-465"/>
<text text-anchor="middle" x="138" y="-450.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;interface~parallel_sum -->
<g id="proc~~npa_f~~CallsGraph_edge9" class="edge"><title>proc~npa_f&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M32.2729,-749.887C48.722,-703.256 108.091,-534.954 129.356,-474.67"/>
<polygon fill="#000000" stroke="#000000" points="132.731,-475.624 132.757,-465.029 126.129,-473.296 132.731,-475.624"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~npa_f~~CallsGraph_node11" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~npa_f~~CallsGraph_node11"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-776 235,-776 235,-752 303,-752 303,-776"/>
<text text-anchor="middle" x="269" y="-761.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~get_plasma -->
<g id="proc~~npa_f~~CallsGraph_edge10" class="edge"><title>proc~npa_f&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M54.1411,-762.218C95.0864,-762.559 174.792,-763.223 224.488,-763.637"/>
<polygon fill="#000000" stroke="#000000" points="224.583,-767.138 234.612,-763.722 224.642,-760.138 224.583,-767.138"/>
</g>
<!-- proc~npa_gyro_range -->
<g id="proc~~npa_f~~CallsGraph_node12" class="node"><title>proc~npa_gyro_range</title>
<g id="a_proc~~npa_f~~CallsGraph_node12"><a xlink:href=".././proc/npa_gyro_range.html" xlink:title="npa_gyro_range">
<polygon fill="#d9534f" stroke="#d9534f" points="183.5,-150 92.5,-150 92.5,-126 183.5,-126 183.5,-150"/>
<text text-anchor="middle" x="138" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_gyro_range</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~npa_gyro_range -->
<g id="proc~~npa_f~~CallsGraph_edge11" class="edge"><title>proc~npa_f&#45;&gt;proc~npa_gyro_range</title>
<path fill="none" stroke="#000000" d="M29.5351,-749.877C35.8716,-700.33 61.0258,-508.437 90,-352 103.051,-281.533 122.349,-198.88 131.629,-160.143"/>
<polygon fill="#000000" stroke="#000000" points="135.131,-160.551 134.07,-150.01 128.326,-158.913 135.131,-160.551"/>
</g>
<!-- proc~gyro_trajectory -->
<g id="proc~~npa_f~~CallsGraph_node13" class="node"><title>proc~gyro_trajectory</title>
<g id="a_proc~~npa_f~~CallsGraph_node13"><a xlink:href=".././proc/gyro_trajectory.html" xlink:title="gyro_trajectory">
<polygon fill="#d9534f" stroke="#d9534f" points="180,-385 96,-385 96,-361 180,-361 180,-385"/>
<text text-anchor="middle" x="138" y="-370.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_trajectory</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~gyro_trajectory -->
<g id="proc~~npa_f~~CallsGraph_edge13" class="edge"><title>proc~npa_f&#45;&gt;proc~gyro_trajectory</title>
<path fill="none" stroke="#000000" d="M28.6757,-749.9C32.023,-693.613 48.365,-457.649 90,-399 92.0597,-396.099 94.5494,-393.485 97.2954,-391.137"/>
<polygon fill="#000000" stroke="#000000" points="99.4796,-393.877 105.568,-385.207 95.4013,-388.188 99.4796,-393.877"/>
</g>
<!-- proc~store_npa -->
<g id="proc~~npa_f~~CallsGraph_node14" class="node"><title>proc~store_npa</title>
<g id="a_proc~~npa_f~~CallsGraph_node14"><a xlink:href=".././proc/store_npa.html" xlink:title="store_npa">
<polygon fill="#d9534f" stroke="#d9534f" points="168.5,-979 107.5,-979 107.5,-955 168.5,-955 168.5,-979"/>
<text text-anchor="middle" x="138" y="-964.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_npa</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~store_npa -->
<g id="proc~~npa_f~~CallsGraph_edge12" class="edge"><title>proc~npa_f&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M31.9851,-774.159C40.6254,-799.738 62.5351,-860.581 90,-907 98.3762,-921.157 109.7,-935.713 119.134,-946.942"/>
<polygon fill="#000000" stroke="#000000" points="116.729,-949.514 125.9,-954.819 122.039,-944.953 116.729,-949.514"/>
</g>
<!-- proc~neutral_cx_rate -->
<g id="proc~~npa_f~~CallsGraph_node16" class="node"><title>proc~neutral_cx_rate</title>
<g id="a_proc~~npa_f~~CallsGraph_node16"><a xlink:href=".././proc/neutral_cx_rate.html" xlink:title="neutral_cx_rate">
<polygon fill="#d9534f" stroke="#d9534f" points="312.5,-696 225.5,-696 225.5,-672 312.5,-672 312.5,-696"/>
<text text-anchor="middle" x="269" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutral_cx_rate</text>
</a>
</g>
</g>
<!-- proc~get_total_cx_rate&#45;&gt;proc~neutral_cx_rate -->
<g id="proc~~npa_f~~CallsGraph_edge14" class="edge"><title>proc~get_total_cx_rate&#45;&gt;proc~neutral_cx_rate</title>
<path fill="none" stroke="#000000" d="M185.572,-681.444C195.213,-681.743 205.435,-682.06 215.278,-682.365"/>
<polygon fill="#000000" stroke="#000000" points="215.255,-685.866 225.358,-682.678 215.472,-678.869 215.255,-685.866"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~npa_f~~CallsGraph_node21" class="node"><title>proc~get_fields</title>
<g id="a_proc~~npa_f~~CallsGraph_node21"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="298,-1035 240,-1035 240,-1011 298,-1011 298,-1035"/>
<text text-anchor="middle" x="269" y="-1020.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;proc~get_fields -->
<g id="proc~~npa_f~~CallsGraph_edge15" class="edge"><title>proc~mc_fastion&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M165.729,-1068.98C184.928,-1060.35 211.021,-1048.62 232.045,-1039.17"/>
<polygon fill="#000000" stroke="#000000" points="233.62,-1042.3 241.305,-1035 230.75,-1035.91 233.62,-1042.3"/>
</g>
<!-- interface~randind -->
<g id="proc~~npa_f~~CallsGraph_node23" class="node"><title>interface~randind</title>
<g id="a_proc~~npa_f~~CallsGraph_node23"><a xlink:href=".././interface/randind.html" xlink:title="randind">
<polygon fill="#a7506f" stroke="#a7506f" points="296,-1135 242,-1135 242,-1111 296,-1111 296,-1135"/>
<text text-anchor="middle" x="269" y="-1120.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;interface~randind -->
<g id="proc~~npa_f~~CallsGraph_edge17" class="edge"><title>proc~mc_fastion&#45;&gt;interface~randind</title>
<path fill="none" stroke="#000000" d="M170.227,-1091.17C188.896,-1097.25 212.685,-1104.99 232.123,-1111.32"/>
<polygon fill="#000000" stroke="#000000" points="231.249,-1114.72 241.842,-1114.48 233.416,-1108.06 231.249,-1114.72"/>
</g>
<!-- proc~get_distribution -->
<g id="proc~~npa_f~~CallsGraph_node31" class="node"><title>proc~get_distribution</title>
<g id="a_proc~~npa_f~~CallsGraph_node31"><a xlink:href=".././proc/get_distribution.html" xlink:title="get_distribution">
<polygon fill="#d9534f" stroke="#d9534f" points="311.5,-1093 226.5,-1093 226.5,-1069 311.5,-1069 311.5,-1093"/>
<text text-anchor="middle" x="269" y="-1078.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_distribution</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;proc~get_distribution -->
<g id="proc~~npa_f~~CallsGraph_edge18" class="edge"><title>proc~mc_fastion&#45;&gt;proc~get_distribution</title>
<path fill="none" stroke="#000000" d="M170.227,-1081C184.051,-1081 200.683,-1081 216.277,-1081"/>
<polygon fill="#000000" stroke="#000000" points="216.335,-1084.5 226.334,-1081 216.334,-1077.5 216.335,-1084.5"/>
</g>
<!-- proc~mc_beam_grid -->
<g id="proc~~npa_f~~CallsGraph_node32" class="node"><title>proc~mc_beam_grid</title>
<g id="a_proc~~npa_f~~CallsGraph_node32"><a xlink:href=".././proc/mc_beam_grid.html" xlink:title="mc_beam_grid">
<polygon fill="#d9534f" stroke="#d9534f" points="311,-1177 227,-1177 227,-1153 311,-1153 311,-1177"/>
<text text-anchor="middle" x="269" y="-1162.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_beam_grid</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;proc~mc_beam_grid -->
<g id="proc~~npa_f~~CallsGraph_edge19" class="edge"><title>proc~mc_fastion&#45;&gt;proc~mc_beam_grid</title>
<path fill="none" stroke="#000000" d="M170.427,-1092.7C175.859,-1095.37 181.273,-1098.47 186,-1102 205.702,-1116.71 202.357,-1129.21 222,-1144 223.824,-1145.37 225.751,-1146.68 227.743,-1147.93"/>
<polygon fill="#000000" stroke="#000000" points="226.328,-1151.15 236.763,-1152.98 229.749,-1145.04 226.328,-1151.15"/>
</g>
<!-- interface~randu -->
<g id="proc~~npa_f~~CallsGraph_node36" class="node"><title>interface~randu</title>
<g id="a_proc~~npa_f~~CallsGraph_node36"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="451,-1217 397,-1217 397,-1193 451,-1193 451,-1217"/>
<text text-anchor="middle" x="424" y="-1202.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;interface~randu -->
<g id="proc~~npa_f~~CallsGraph_edge16" class="edge"><title>proc~mc_fastion&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M170.428,-1091.09C176.107,-1093.95 181.61,-1097.54 186,-1102 214.5,-1130.94 189.182,-1162.07 222,-1186 270.272,-1221.2 343.367,-1217.95 386.832,-1211.85"/>
<polygon fill="#000000" stroke="#000000" points="387.593,-1215.27 396.948,-1210.3 386.534,-1208.35 387.593,-1215.27"/>
</g>
<!-- interface~randind_cdf -->
<g id="proc~~npa_f~~CallsGraph_node20" class="node"><title>interface~randind_cdf</title>
<g id="a_proc~~npa_f~~CallsGraph_node20"><a xlink:href=".././interface/randind_cdf.html" xlink:title="randind_cdf">
<polygon fill="#a7506f" stroke="#a7506f" points="303.5,-897 234.5,-897 234.5,-873 303.5,-873 303.5,-897"/>
<text text-anchor="middle" x="269" y="-882.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind_cdf</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;interface~randind_cdf -->
<g id="proc~~npa_f~~CallsGraph_edge22" class="edge"><title>proc~get_nlaunch&#45;&gt;interface~randind_cdf</title>
<path fill="none" stroke="#000000" d="M173.57,-885.732C188.997,-885.612 207.361,-885.47 223.774,-885.343"/>
<polygon fill="#000000" stroke="#000000" points="224.255,-888.839 234.228,-885.262 224.201,-881.84 224.255,-888.839"/>
</g>
<!-- proc~rng_init -->
<g id="proc~~npa_f~~CallsGraph_node29" class="node"><title>proc~rng_init</title>
<g id="a_proc~~npa_f~~CallsGraph_node29"><a xlink:href=".././proc/rng_init.html" xlink:title="rng_init">
<polygon fill="#d9534f" stroke="#d9534f" points="296,-939 242,-939 242,-915 296,-915 296,-939"/>
<text text-anchor="middle" x="269" y="-924.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rng_init</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~rng_init -->
<g id="proc~~npa_f~~CallsGraph_edge21" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~rng_init</title>
<path fill="none" stroke="#000000" d="M173.57,-896.987C191.705,-902.751 213.897,-909.804 232.21,-915.625"/>
<polygon fill="#000000" stroke="#000000" points="231.343,-919.022 241.934,-918.715 233.464,-912.351 231.343,-919.022"/>
</g>
<!-- proc~cumsum -->
<g id="proc~~npa_f~~CallsGraph_node35" class="node"><title>proc~cumsum</title>
<g id="a_proc~~npa_f~~CallsGraph_node35"><a xlink:href=".././proc/cumsum.html" xlink:title="cumsum">
<polygon fill="#d9534f" stroke="#d9534f" points="296,-855 242,-855 242,-831 296,-831 296,-855"/>
<text text-anchor="middle" x="269" y="-840.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cumsum</text>
</a>
</g>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~cumsum -->
<g id="proc~~npa_f~~CallsGraph_edge20" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~cumsum</title>
<path fill="none" stroke="#000000" d="M173.57,-874.477C191.705,-868.432 213.897,-861.034 232.21,-854.93"/>
<polygon fill="#000000" stroke="#000000" points="233.554,-858.171 241.934,-851.689 231.34,-851.531 233.554,-858.171"/>
</g>
<!-- proc~attenuate&#45;&gt;proc~get_plasma -->
<g id="proc~~npa_f~~CallsGraph_edge23" class="edge"><title>proc~attenuate&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M167.31,-731.217C184.236,-736.728 206.078,-743.839 225.091,-750.03"/>
<polygon fill="#000000" stroke="#000000" points="224.142,-753.402 234.735,-753.169 226.31,-746.745 224.142,-753.402"/>
</g>
<!-- proc~colrad -->
<g id="proc~~npa_f~~CallsGraph_node42" class="node"><title>proc~colrad</title>
<g id="a_proc~~npa_f~~CallsGraph_node42"><a xlink:href=".././proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="296,-654 242,-654 242,-630 296,-630 296,-654"/>
<text text-anchor="middle" x="269" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~attenuate&#45;&gt;proc~colrad -->
<g id="proc~~npa_f~~CallsGraph_edge24" class="edge"><title>proc~attenuate&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M167.319,-711.505C173.726,-708.553 180.312,-705.029 186,-701 204.984,-687.553 203.07,-676.524 222,-663 225.281,-660.656 228.866,-658.476 232.54,-656.479"/>
<polygon fill="#000000" stroke="#000000" points="234.346,-659.489 241.734,-651.895 231.223,-653.225 234.346,-659.489"/>
</g>
<!-- proc~line_plane_intersect -->
<g id="proc~~npa_f~~CallsGraph_node22" class="node"><title>proc~line_plane_intersect</title>
<g id="a_proc~~npa_f~~CallsGraph_node22"><a xlink:href=".././proc/line_plane_intersect.html" xlink:title="line_plane_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="478,-234 370,-234 370,-210 478,-210 478,-234"/>
<text text-anchor="middle" x="424" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">line_plane_intersect</text>
</a>
</g>
</g>
<!-- proc~hit_npa_detector&#45;&gt;proc~line_plane_intersect -->
<g id="proc~~npa_f~~CallsGraph_edge26" class="edge"><title>proc~hit_npa_detector&#45;&gt;proc~line_plane_intersect</title>
<path fill="none" stroke="#000000" d="M313.844,-192.036C331.129,-196.781 351.153,-202.277 369.294,-207.257"/>
<polygon fill="#000000" stroke="#000000" points="368.58,-210.691 379.15,-209.963 370.433,-203.94 368.58,-210.691"/>
</g>
<!-- proc~in_boundary -->
<g id="proc~~npa_f~~CallsGraph_node27" class="node"><title>proc~in_boundary</title>
<g id="a_proc~~npa_f~~CallsGraph_node27"><a xlink:href=".././proc/in_boundary.html" xlink:title="in_boundary">
<polygon fill="#d94e8f" stroke="#d94e8f" points="460,-192 388,-192 388,-168 460,-168 460,-192"/>
<text text-anchor="middle" x="424" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_boundary</text>
</a>
</g>
</g>
<!-- proc~hit_npa_detector&#45;&gt;proc~in_boundary -->
<g id="proc~~npa_f~~CallsGraph_edge25" class="edge"><title>proc~hit_npa_detector&#45;&gt;proc~in_boundary</title>
<path fill="none" stroke="#000000" d="M315.905,-180C335.453,-180 358.193,-180 377.677,-180"/>
<polygon fill="#000000" stroke="#000000" points="377.83,-183.5 387.83,-180 377.83,-176.5 377.83,-183.5"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~npa_f~~CallsGraph_node15" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~npa_f~~CallsGraph_node15"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-234 225,-234 225,-210 313,-210 313,-234"/>
<text text-anchor="middle" x="269" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~npa_f~~CallsGraph_edge28" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M170.33,-440.72C176.297,-437.104 181.938,-432.578 186,-427 235.049,-359.637 170.393,-308.424 222,-243 222.595,-242.246 223.222,-241.518 223.88,-240.816"/>
<polygon fill="#000000" stroke="#000000" points="226.385,-243.286 231.86,-234.215 221.923,-237.892 226.385,-243.286"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~npa_f~~CallsGraph_node17" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~npa_f~~CallsGraph_node17"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-612 225,-612 225,-588 313,-588 313,-612"/>
<text text-anchor="middle" x="269" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~npa_f~~CallsGraph_edge30" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M144.115,-465.016C155.069,-489.485 183.007,-545.601 222,-579 223.5,-580.285 225.092,-581.506 226.748,-582.665"/>
<polygon fill="#000000" stroke="#000000" points="225.068,-585.74 235.431,-587.946 228.706,-579.759 225.068,-585.74"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~npa_f~~CallsGraph_node18" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~npa_f~~CallsGraph_node18"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-570 225,-570 225,-546 313,-546 313,-570"/>
<text text-anchor="middle" x="269" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~npa_f~~CallsGraph_edge27" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M148.604,-465.226C163.005,-482.923 191.749,-515.865 222,-537 224.078,-538.452 226.272,-539.843 228.531,-541.17"/>
<polygon fill="#000000" stroke="#000000" points="226.978,-544.309 237.445,-545.952 230.287,-538.14 226.978,-544.309"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~npa_f~~CallsGraph_node24" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~npa_f~~CallsGraph_node24"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-528 223.5,-528 223.5,-504 314.5,-504 314.5,-528"/>
<text text-anchor="middle" x="269" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~npa_f~~CallsGraph_edge35" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M162.131,-465.018C178.712,-473.557 201.625,-485.199 222,-495 225.182,-496.531 228.499,-498.099 231.831,-499.654"/>
<polygon fill="#000000" stroke="#000000" points="230.613,-502.947 241.159,-503.966 233.55,-496.593 230.613,-502.947"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~npa_f~~CallsGraph_node28" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~npa_f~~CallsGraph_node28"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-486 223.5,-486 223.5,-462 314.5,-462 314.5,-486"/>
<text text-anchor="middle" x="269" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~npa_f~~CallsGraph_edge29" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.591,-458.794C186.596,-460.748 200.285,-462.977 213.413,-465.114"/>
<polygon fill="#000000" stroke="#000000" points="212.872,-468.572 223.305,-466.724 213.997,-461.663 212.872,-468.572"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~npa_f~~CallsGraph_node34" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~npa_f~~CallsGraph_node34"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-444 223.5,-444 223.5,-420 314.5,-420 314.5,-444"/>
<text text-anchor="middle" x="269" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~npa_f~~CallsGraph_edge36" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.591,-447.206C186.596,-445.252 200.285,-443.023 213.413,-440.886"/>
<polygon fill="#000000" stroke="#000000" points="213.997,-444.337 223.305,-439.276 212.872,-437.428 213.997,-444.337"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~npa_f~~CallsGraph_node37" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~npa_f~~CallsGraph_node37"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-402 223.5,-402 223.5,-378 314.5,-378 314.5,-402"/>
<text text-anchor="middle" x="269" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~npa_f~~CallsGraph_edge31" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M162.131,-440.982C178.712,-432.443 201.625,-420.801 222,-411 225.182,-409.469 228.499,-407.901 231.831,-406.346"/>
<polygon fill="#000000" stroke="#000000" points="233.55,-409.407 241.159,-402.034 230.613,-403.053 233.55,-409.407"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~npa_f~~CallsGraph_node39" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~npa_f~~CallsGraph_node39"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-360 223.5,-360 223.5,-336 314.5,-336 314.5,-360"/>
<text text-anchor="middle" x="269" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~npa_f~~CallsGraph_edge33" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M166.453,-440.871C173.312,-437.053 180.324,-432.398 186,-427 207.985,-406.092 199.226,-389.046 222,-369 223.314,-367.844 224.702,-366.74 226.145,-365.688"/>
<polygon fill="#000000" stroke="#000000" points="228.259,-368.494 234.873,-360.217 224.541,-362.562 228.259,-368.494"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~npa_f~~CallsGraph_node40" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~npa_f~~CallsGraph_node40"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-318 223.5,-318 223.5,-294 314.5,-294 314.5,-318"/>
<text text-anchor="middle" x="269" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_f~~CallsGraph_edge34" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M168.729,-440.801C175.078,-437.114 181.284,-432.537 186,-427 216.63,-391.04 190.008,-361.754 222,-327 222.903,-326.019 223.861,-325.081 224.864,-324.183"/>
<polygon fill="#000000" stroke="#000000" points="227.238,-326.784 233.274,-318.076 223.126,-321.12 227.238,-326.784"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~npa_f~~CallsGraph_node41" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~npa_f~~CallsGraph_node41"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-276 225,-276 225,-252 313,-252 313,-276"/>
<text text-anchor="middle" x="269" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~npa_f~~CallsGraph_edge32" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M169.614,-440.838C175.772,-437.184 181.672,-432.612 186,-427 225.759,-375.442 180.285,-334.989 222,-285 222.731,-284.124 223.507,-283.282 224.32,-282.474"/>
<polygon fill="#000000" stroke="#000000" points="226.778,-284.996 232.495,-276.075 222.463,-279.484 226.778,-284.996"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_node25" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~npa_f~~CallsGraph_node25"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="605,-979 537,-979 537,-955 605,-955 605,-979"/>
<text text-anchor="middle" x="571" y="-964.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge39" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M284.234,-776.013C299.934,-788.74 326.382,-808.663 352,-821 412.178,-849.981 441.6,-825.246 496,-864 525.814,-885.239 548.113,-922.331 560.085,-945.729"/>
<polygon fill="#000000" stroke="#000000" points="557.012,-947.412 564.575,-954.832 563.29,-944.315 557.012,-947.412"/>
</g>
<!-- proc~get_position -->
<g id="proc~~npa_f~~CallsGraph_node26" class="node"><title>proc~get_position</title>
<g id="a_proc~~npa_f~~CallsGraph_node26"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="459,-779 389,-779 389,-755 459,-755 459,-779"/>
<text text-anchor="middle" x="424" y="-764.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~npa_f~~CallsGraph_edge37" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M303.199,-764.651C325.248,-765.083 354.452,-765.656 378.506,-766.128"/>
<polygon fill="#000000" stroke="#000000" points="378.74,-769.633 388.807,-766.33 378.877,-762.634 378.74,-769.633"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_node30" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~npa_f~~CallsGraph_node30"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="714,-819 646,-819 646,-795 714,-795 714,-819"/>
<text text-anchor="middle" x="680" y="-804.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_edge38" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M303.109,-775.549C317.888,-780.219 335.63,-785.167 352,-788 452.377,-805.373 572.392,-807.736 635.412,-807.589"/>
<polygon fill="#000000" stroke="#000000" points="635.779,-811.087 645.763,-807.54 635.746,-804.087 635.779,-811.087"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~npa_f~~CallsGraph_node38" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~npa_f~~CallsGraph_node38"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="454.5,-737 393.5,-737 393.5,-713 454.5,-713 454.5,-737"/>
<text text-anchor="middle" x="424" y="-722.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~npa_f~~CallsGraph_edge40" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M303.199,-755.538C326.836,-749.512 358.696,-741.391 383.619,-735.038"/>
<polygon fill="#000000" stroke="#000000" points="384.66,-738.385 393.486,-732.523 382.931,-731.602 384.66,-738.385"/>
</g>
<!-- proc~approx_eq -->
<g id="proc~~npa_f~~CallsGraph_node19" class="node"><title>proc~approx_eq</title>
<g id="a_proc~~npa_f~~CallsGraph_node19"><a xlink:href=".././proc/approx_eq.html" xlink:title="approx_eq">
<polygon fill="#d94e8f" stroke="#d94e8f" points="301,-108 237,-108 237,-84 301,-84 301,-108"/>
<text text-anchor="middle" x="269" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_eq</text>
</a>
</g>
</g>
<!-- proc~npa_gyro_range&#45;&gt;proc~approx_eq -->
<g id="proc~~npa_f~~CallsGraph_edge41" class="edge"><title>proc~npa_gyro_range&#45;&gt;proc~approx_eq</title>
<path fill="none" stroke="#000000" d="M175.966,-125.964C191.873,-120.785 210.531,-114.711 226.873,-109.39"/>
<polygon fill="#000000" stroke="#000000" points="228.279,-112.613 236.705,-106.189 226.112,-105.957 228.279,-112.613"/>
</g>
<!-- proc~gyro_range -->
<g id="proc~~npa_f~~CallsGraph_node33" class="node"><title>proc~gyro_range</title>
<g id="a_proc~~npa_f~~CallsGraph_node33"><a xlink:href=".././proc/gyro_range.html" xlink:title="gyro_range">
<polygon fill="#d9534f" stroke="#d9534f" points="302.5,-150 235.5,-150 235.5,-126 302.5,-126 302.5,-150"/>
<text text-anchor="middle" x="269" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_range</text>
</a>
</g>
</g>
<!-- proc~npa_gyro_range&#45;&gt;proc~gyro_range -->
<g id="proc~~npa_f~~CallsGraph_edge42" class="edge"><title>proc~npa_gyro_range&#45;&gt;proc~gyro_range</title>
<path fill="none" stroke="#000000" d="M183.756,-138C197.077,-138 211.642,-138 224.859,-138"/>
<polygon fill="#000000" stroke="#000000" points="225.119,-141.5 235.119,-138 225.119,-134.5 225.119,-141.5"/>
</g>
<!-- proc~store_npa&#45;&gt;proc~get_fields -->
<g id="proc~~npa_f~~CallsGraph_edge44" class="edge"><title>proc~store_npa&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M166.674,-979.013C185.336,-987.115 210.183,-997.901 230.601,-1006.76"/>
<polygon fill="#000000" stroke="#000000" points="229.36,-1010.04 239.927,-1010.81 232.148,-1003.62 229.36,-1010.04"/>
</g>
<!-- proc~store_npa&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge43" class="edge"><title>proc~store_npa&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M168.624,-967C243.28,-967 439.392,-967 526.84,-967"/>
<polygon fill="#000000" stroke="#000000" points="526.95,-970.5 536.95,-967 526.95,-963.5 526.95,-970.5"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_node53" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="463.5,-402 384.5,-402 384.5,-378 463.5,-378 463.5,-402"/>
<text text-anchor="middle" x="424" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge45" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M302.43,-234.22C307.227,-236.744 311.921,-239.668 316,-243 360.118,-279.038 395.209,-337.319 412.075,-368.573"/>
<polygon fill="#000000" stroke="#000000" points="409.134,-370.5 416.899,-377.708 415.324,-367.231 409.134,-370.5"/>
</g>
<!-- proc~bb_cx_rates -->
<g id="proc~~npa_f~~CallsGraph_node50" class="node"><title>proc~bb_cx_rates</title>
<g id="a_proc~~npa_f~~CallsGraph_node50"><a xlink:href=".././proc/bb_cx_rates.html" xlink:title="bb_cx_rates">
<polygon fill="#d9534f" stroke="#d9534f" points="459.5,-695 388.5,-695 388.5,-671 459.5,-671 459.5,-695"/>
<text text-anchor="middle" x="424" y="-680.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bb_cx_rates</text>
</a>
</g>
</g>
<!-- proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates -->
<g id="proc~~npa_f~~CallsGraph_edge46" class="edge"><title>proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates</title>
<path fill="none" stroke="#000000" d="M312.619,-683.721C333.042,-683.588 357.503,-683.428 378.201,-683.293"/>
<polygon fill="#000000" stroke="#000000" points="378.356,-686.792 388.333,-683.227 378.31,-679.792 378.356,-686.792"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge47" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M306.073,-587.731C309.814,-585.303 313.247,-582.419 316,-579 363.355,-520.206 301.345,-468.976 352,-413 358.064,-406.299 366.094,-401.542 374.569,-398.167"/>
<polygon fill="#000000" stroke="#000000" points="375.882,-401.419 384.246,-394.915 373.652,-394.783 375.882,-401.419"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge48" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M305.392,-545.828C309.346,-543.372 313.016,-540.454 316,-537 353.517,-493.575 312.05,-454.197 352,-413 358.226,-406.58 366.256,-401.949 374.665,-398.611"/>
<polygon fill="#000000" stroke="#000000" points="375.897,-401.889 384.244,-395.364 373.649,-395.26 375.897,-401.889"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge50" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M298.161,-1029.91C341.963,-1039.29 428.405,-1052.27 496,-1028 518.873,-1019.79 539.721,-1001.11 553.417,-986.568"/>
<polygon fill="#000000" stroke="#000000" points="556.142,-988.773 560.257,-979.009 550.952,-984.076 556.142,-988.773"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_edge49" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M298.362,-1033.92C313.937,-1039.33 333.747,-1045.28 352,-1048 468.44,-1065.36 531.908,-1076.1 610,-988 651.645,-941.019 669.246,-866.303 675.723,-829.288"/>
<polygon fill="#000000" stroke="#000000" points="679.232,-829.517 677.391,-819.084 672.324,-828.389 679.232,-829.517"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~npa_f~~CallsGraph_edge51" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M279.527,-1010.75C290.122,-996.496 306.936,-971.844 316,-948 348.403,-862.759 291.201,-813.967 352,-746 360.02,-737.034 371.665,-731.817 383.213,-728.806"/>
<polygon fill="#000000" stroke="#000000" points="384.18,-732.179 393.242,-726.689 382.735,-725.33 384.18,-732.179"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~npa_f~~CallsGraph_node47" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~npa_f~~CallsGraph_node47"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="474,-1019 374,-1019 374,-995 474,-995 474,-1019"/>
<text text-anchor="middle" x="424" y="-1004.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~npa_f~~CallsGraph_edge52" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M298.063,-1020.07C316.391,-1018.15 341.022,-1015.57 363.569,-1013.22"/>
<polygon fill="#000000" stroke="#000000" points="364.169,-1016.67 373.751,-1012.15 363.441,-1009.71 364.169,-1016.67"/>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge53" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M304.041,-503.987C308.407,-501.476 312.549,-498.502 316,-495 343.938,-466.651 322.479,-439.696 352,-413 358.424,-407.191 366.334,-402.847 374.515,-399.6"/>
<polygon fill="#000000" stroke="#000000" points="375.86,-402.839 384.172,-396.269 373.578,-396.221 375.86,-402.839"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_node43" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~npa_f~~CallsGraph_node43"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="602,-779 540,-779 540,-755 602,-755 602,-779"/>
<text text-anchor="middle" x="571" y="-764.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_edge54" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M459.363,-767C480.474,-767 507.615,-767 529.732,-767"/>
<polygon fill="#000000" stroke="#000000" points="529.818,-770.5 539.818,-767 529.818,-763.5 529.818,-770.5"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge55" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M301.169,-461.891C306.331,-459.299 311.47,-456.324 316,-453 335.282,-438.849 331.937,-426.02 352,-413 358.954,-408.487 366.868,-404.793 374.826,-401.791"/>
<polygon fill="#000000" stroke="#000000" points="376.178,-405.027 384.495,-398.463 373.9,-398.408 376.178,-405.027"/>
</g>
<!-- proc~my_rank -->
<g id="proc~~npa_f~~CallsGraph_node48" class="node"><title>proc~my_rank</title>
<g id="a_proc~~npa_f~~CallsGraph_node48"><a xlink:href=".././proc/my_rank.html" xlink:title="my_rank">
<polygon fill="#d94e8f" stroke="#d94e8f" points="451,-939 397,-939 397,-915 451,-915 451,-939"/>
<text text-anchor="middle" x="424" y="-924.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">my_rank</text>
</a>
</g>
</g>
<!-- proc~rng_init&#45;&gt;proc~my_rank -->
<g id="proc~~npa_f~~CallsGraph_edge56" class="edge"><title>proc~rng_init&#45;&gt;proc~my_rank</title>
<path fill="none" stroke="#000000" d="M296.302,-927C321.227,-927 358.881,-927 386.667,-927"/>
<polygon fill="#000000" stroke="#000000" points="386.786,-930.5 396.786,-927 386.786,-923.5 386.786,-930.5"/>
</g>
<!-- proc~rng_seed -->
<g id="proc~~npa_f~~CallsGraph_node49" class="node"><title>proc~rng_seed</title>
<g id="a_proc~~npa_f~~CallsGraph_node49"><a xlink:href=".././proc/rng_seed.html" xlink:title="rng_seed">
<polygon fill="#d94e8f" stroke="#d94e8f" points="453,-897 395,-897 395,-873 453,-873 453,-897"/>
<text text-anchor="middle" x="424" y="-882.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rng_seed</text>
</a>
</g>
</g>
<!-- proc~rng_init&#45;&gt;proc~rng_seed -->
<g id="proc~~npa_f~~CallsGraph_edge57" class="edge"><title>proc~rng_init&#45;&gt;proc~rng_seed</title>
<path fill="none" stroke="#000000" d="M296.302,-919.78C320.804,-913.054 357.607,-902.951 385.245,-895.364"/>
<polygon fill="#000000" stroke="#000000" points="386.255,-898.716 394.972,-892.694 384.402,-891.966 386.255,-898.716"/>
</g>
<!-- proc~get_distribution&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge59" class="edge"><title>proc~get_distribution&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M311.743,-1083.06C359.151,-1083.62 437.503,-1079.03 496,-1048 522.462,-1033.96 544.338,-1006.6 557.277,-987.588"/>
<polygon fill="#000000" stroke="#000000" points="560.339,-989.301 562.891,-979.018 554.484,-985.465 560.339,-989.301"/>
</g>
<!-- interface~interpol -->
<g id="proc~~npa_f~~CallsGraph_node56" class="node"><title>interface~interpol</title>
<g id="a_proc~~npa_f~~CallsGraph_node56"><a xlink:href=".././interface/interpol.html" xlink:title="interpol">
<polygon fill="#a7506f" stroke="#a7506f" points="451,-1175 397,-1175 397,-1151 451,-1151 451,-1175"/>
<text text-anchor="middle" x="424" y="-1160.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol</text>
</a>
</g>
</g>
<!-- proc~get_distribution&#45;&gt;interface~interpol -->
<g id="proc~~npa_f~~CallsGraph_edge58" class="edge"><title>proc~get_distribution&#45;&gt;interface~interpol</title>
<path fill="none" stroke="#000000" d="M300.5,-1093.13C305.843,-1095.75 311.217,-1098.73 316,-1102 334.42,-1114.6 333.107,-1125.12 352,-1137 362.766,-1143.77 375.552,-1149.14 387.286,-1153.2"/>
<polygon fill="#000000" stroke="#000000" points="386.236,-1156.53 396.828,-1156.3 388.401,-1149.88 386.236,-1156.53"/>
</g>
<!-- proc~mc_beam_grid&#45;&gt;interface~randu -->
<g id="proc~~npa_f~~CallsGraph_edge60" class="edge"><title>proc~mc_beam_grid&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M311.001,-1175.72C334.643,-1181.9 364.098,-1189.6 386.867,-1195.55"/>
<polygon fill="#000000" stroke="#000000" points="386.252,-1199.01 396.812,-1198.15 388.023,-1192.24 386.252,-1199.01"/>
</g>
<!-- proc~gyro_range&#45;&gt;proc~line_plane_intersect -->
<g id="proc~~npa_f~~CallsGraph_edge63" class="edge"><title>proc~gyro_range&#45;&gt;proc~line_plane_intersect</title>
<path fill="none" stroke="#000000" d="M301.237,-150.017C306.391,-152.619 311.511,-155.621 316,-159 335.643,-173.785 331.366,-187.632 352,-201 354.751,-202.782 357.658,-204.418 360.664,-205.918"/>
<polygon fill="#000000" stroke="#000000" points="359.355,-209.167 369.915,-210.025 362.196,-202.769 359.355,-209.167"/>
</g>
<!-- proc~gyro_range&#45;&gt;proc~in_boundary -->
<g id="proc~~npa_f~~CallsGraph_edge61" class="edge"><title>proc~gyro_range&#45;&gt;proc~in_boundary</title>
<path fill="none" stroke="#000000" d="M302.822,-147.01C324.817,-153.048 354.055,-161.074 378.185,-167.698"/>
<polygon fill="#000000" stroke="#000000" points="377.265,-171.075 387.835,-170.347 379.118,-164.324 377.265,-171.075"/>
</g>
<!-- proc~gyro_surface_coordinates -->
<g id="proc~~npa_f~~CallsGraph_node44" class="node"><title>proc~gyro_surface_coordinates</title>
<g id="a_proc~~npa_f~~CallsGraph_node44"><a xlink:href=".././proc/gyro_surface_coordinates.html" xlink:title="gyro_surface_coordinates">
<polygon fill="#d9534f" stroke="#d9534f" points="492,-150 356,-150 356,-126 492,-126 492,-150"/>
<text text-anchor="middle" x="424" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_surface_coordinates</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~gyro_surface_coordinates -->
<g id="proc~~npa_f~~CallsGraph_edge62" class="edge"><title>proc~gyro_range&#45;&gt;proc~gyro_surface_coordinates</title>
<path fill="none" stroke="#000000" d="M302.822,-138C315.45,-138 330.465,-138 345.531,-138"/>
<polygon fill="#000000" stroke="#000000" points="345.94,-141.5 355.94,-138 345.94,-134.5 345.94,-141.5"/>
</g>
<!-- proc~line_gyro_surface_intersect -->
<g id="proc~~npa_f~~CallsGraph_node45" class="node"><title>proc~line_gyro_surface_intersect</title>
<g id="a_proc~~npa_f~~CallsGraph_node45"><a xlink:href=".././proc/line_gyro_surface_intersect.html" xlink:title="line_gyro_surface_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="496,-108 352,-108 352,-84 496,-84 496,-108"/>
<text text-anchor="middle" x="424" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">line_gyro_surface_intersect</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~line_gyro_surface_intersect -->
<g id="proc~~npa_f~~CallsGraph_edge64" class="edge"><title>proc~gyro_range&#45;&gt;proc~line_gyro_surface_intersect</title>
<path fill="none" stroke="#000000" d="M302.822,-128.99C322.25,-123.657 347.33,-116.772 369.548,-110.673"/>
<polygon fill="#000000" stroke="#000000" points="370.48,-114.047 379.196,-108.025 368.627,-107.297 370.48,-114.047"/>
</g>
<!-- proc~in_gyro_surface -->
<g id="proc~~npa_f~~CallsGraph_node51" class="node"><title>proc~in_gyro_surface</title>
<g id="a_proc~~npa_f~~CallsGraph_node51"><a xlink:href=".././proc/in_gyro_surface.html" xlink:title="in_gyro_surface">
<polygon fill="#d94e8f" stroke="#d94e8f" points="468.5,-66 379.5,-66 379.5,-42 468.5,-42 468.5,-66"/>
<text text-anchor="middle" x="424" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_gyro_surface</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~in_gyro_surface -->
<g id="proc~~npa_f~~CallsGraph_edge65" class="edge"><title>proc~gyro_range&#45;&gt;proc~in_gyro_surface</title>
<path fill="none" stroke="#000000" d="M301.237,-125.983C306.391,-123.381 311.511,-120.379 316,-117 335.643,-102.215 331.366,-88.3678 352,-75 357.381,-71.5141 363.359,-68.5894 369.499,-66.1396"/>
<polygon fill="#000000" stroke="#000000" points="370.978,-69.3282 379.218,-62.6682 368.623,-62.7361 370.978,-69.3282"/>
</g>
<!-- proc~boundary_edge -->
<g id="proc~~npa_f~~CallsGraph_node54" class="node"><title>proc~boundary_edge</title>
<g id="a_proc~~npa_f~~CallsGraph_node54"><a xlink:href=".././proc/boundary_edge.html" xlink:title="boundary_edge">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-24 380,-24 380,-0 468,-0 468,-24"/>
<text text-anchor="middle" x="424" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boundary_edge</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~boundary_edge -->
<g id="proc~~npa_f~~CallsGraph_edge66" class="edge"><title>proc~gyro_range&#45;&gt;proc~boundary_edge</title>
<path fill="none" stroke="#000000" d="M302.66,-126.806C307.537,-124.133 312.196,-120.893 316,-117 344.383,-87.9455 321.645,-59.9877 352,-33 357.228,-28.3519 363.442,-24.731 369.986,-21.9106"/>
<polygon fill="#000000" stroke="#000000" points="371.558,-25.062 379.735,-18.3248 369.141,-18.4923 371.558,-25.062"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge67" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M313.844,-419.964C332.793,-414.763 355.033,-408.658 374.477,-403.32"/>
<polygon fill="#000000" stroke="#000000" points="375.641,-406.63 384.358,-400.608 373.788,-399.88 375.641,-406.63"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge68" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.665,-390C333.357,-390 355.134,-390 374.241,-390"/>
<polygon fill="#000000" stroke="#000000" points="374.251,-393.5 384.251,-390 374.251,-386.5 374.251,-393.5"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge71" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M454.781,-727.479C468.878,-730.093 484.993,-735.378 496,-746 552.78,-800.798 565.995,-900.363 569.069,-944.685"/>
<polygon fill="#000000" stroke="#000000" points="565.591,-945.157 569.663,-954.938 572.579,-944.752 565.591,-945.157"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_node46" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~npa_f~~CallsGraph_node46"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="712.5,-758 647.5,-758 647.5,-734 712.5,-734 712.5,-758"/>
<text text-anchor="middle" x="680" y="-743.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge70" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M454.634,-727.45C499.688,-731.175 585.599,-738.278 637.05,-742.532"/>
<polygon fill="#000000" stroke="#000000" points="636.914,-746.032 647.168,-743.368 637.491,-739.056 636.914,-746.032"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_node52" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~npa_f~~CallsGraph_node52"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="609.5,-699 532.5,-699 532.5,-675 609.5,-675 609.5,-699"/>
<text text-anchor="middle" x="571" y="-684.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_edge69" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M454.693,-717.218C474.164,-712.116 500.054,-705.331 522.368,-699.483"/>
<polygon fill="#000000" stroke="#000000" points="523.546,-702.792 532.332,-696.872 521.772,-696.021 523.546,-702.792"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge72" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M313.844,-360.036C332.793,-365.237 355.033,-371.342 374.477,-376.68"/>
<polygon fill="#000000" stroke="#000000" points="373.788,-380.12 384.358,-379.392 375.641,-373.37 373.788,-380.12"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge73" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M297.955,-318.2C303.964,-320.978 310.238,-323.999 316,-327 343.436,-341.29 373.734,-359.355 395.065,-372.473"/>
<polygon fill="#000000" stroke="#000000" points="393.278,-375.483 403.624,-377.766 396.96,-369.529 393.278,-375.483"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_f~~CallsGraph_edge74" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M300.513,-276.109C305.854,-278.733 311.225,-281.718 316,-285 352.106,-309.813 386.991,-347.392 406.651,-370.221"/>
<polygon fill="#000000" stroke="#000000" points="404.04,-372.554 413.179,-377.913 409.377,-368.024 404.04,-372.554"/>
</g>
<!-- proc~eigen -->
<g id="proc~~npa_f~~CallsGraph_node55" class="node"><title>proc~eigen</title>
<g id="a_proc~~npa_f~~CallsGraph_node55"><a xlink:href=".././proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="451,-592 397,-592 397,-568 451,-568 451,-592"/>
<text text-anchor="middle" x="424" y="-577.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~npa_f~~CallsGraph_edge76" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M296.302,-631.342C321.447,-621.152 359.546,-605.713 387.399,-594.426"/>
<polygon fill="#000000" stroke="#000000" points="388.833,-597.622 396.786,-590.623 386.204,-591.135 388.833,-597.622"/>
</g>
<!-- proc~linsolve -->
<g id="proc~~npa_f~~CallsGraph_node57" class="node"><title>proc~linsolve</title>
<g id="a_proc~~npa_f~~CallsGraph_node57"><a xlink:href=".././proc/linsolve.html" xlink:title="linsolve">
<polygon fill="#d9534f" stroke="#d9534f" points="451,-446 397,-446 397,-422 451,-422 451,-446"/>
<text text-anchor="middle" x="424" y="-431.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linsolve</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~linsolve -->
<g id="proc~~npa_f~~CallsGraph_edge75" class="edge"><title>proc~colrad&#45;&gt;proc~linsolve</title>
<path fill="none" stroke="#000000" d="M296.057,-633.466C303.074,-630.316 310.293,-626.207 316,-621 317.748,-619.405 383.681,-503.326 411.163,-454.879"/>
<polygon fill="#000000" stroke="#000000" points="414.227,-456.57 416.116,-446.145 408.138,-453.117 414.227,-456.57"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~npa_f~~CallsGraph_node58" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~npa_f~~CallsGraph_node58"><a xlink:href=".././proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-653 380,-653 380,-629 468,-629 468,-653"/>
<text text-anchor="middle" x="424" y="-638.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~npa_f~~CallsGraph_edge77" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M296.302,-641.828C316.427,-641.697 344.85,-641.511 369.677,-641.349"/>
<polygon fill="#000000" stroke="#000000" points="369.726,-644.848 379.703,-641.283 369.68,-637.849 369.726,-644.848"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_f~~CallsGraph_edge78" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M602.09,-778.249C613.004,-782.329 625.537,-787.014 637.274,-791.401"/>
<polygon fill="#000000" stroke="#000000" points="636.301,-794.774 646.893,-794.997 638.752,-788.217 636.301,-794.774"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge79" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M602.09,-761.094C612.99,-758.955 625.506,-756.499 637.23,-754.198"/>
<polygon fill="#000000" stroke="#000000" points="638.131,-757.588 647.27,-752.227 636.783,-750.719 638.131,-757.588"/>
</g>
<!-- proc~bb_cx_rates&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_edge80" class="edge"><title>proc~bb_cx_rates&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M459.731,-683.958C478.438,-684.474 501.799,-685.119 522.198,-685.681"/>
<polygon fill="#000000" stroke="#000000" points="522.154,-689.181 532.247,-685.959 522.347,-682.184 522.154,-689.181"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~npa_f~~CallsGraph_node60" class="node"><title>proc~elmhes</title>
<g id="a_proc~~npa_f~~CallsGraph_node60"><a xlink:href=".././proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-489 544,-489 544,-465 598,-465 598,-489"/>
<text text-anchor="middle" x="571" y="-474.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~npa_f~~CallsGraph_edge81" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M439.377,-567.872C459.455,-551.197 497.335,-520.68 532,-498 533.896,-496.759 535.871,-495.521 537.88,-494.3"/>
<polygon fill="#000000" stroke="#000000" points="539.89,-497.18 546.767,-489.12 536.365,-491.132 539.89,-497.18"/>
</g>
<!-- proc~balback -->
<g id="proc~~npa_f~~CallsGraph_node61" class="node"><title>proc~balback</title>
<g id="a_proc~~npa_f~~CallsGraph_node61"><a xlink:href=".././proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-657 544,-657 544,-633 598,-633 598,-657"/>
<text text-anchor="middle" x="571" y="-642.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~npa_f~~CallsGraph_edge82" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M451.258,-591.771C474.56,-602.217 508.8,-617.566 534.532,-629.101"/>
<polygon fill="#000000" stroke="#000000" points="533.38,-632.42 543.937,-633.317 536.244,-626.032 533.38,-632.42"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~npa_f~~CallsGraph_node63" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~npa_f~~CallsGraph_node63"><a xlink:href=".././proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-615 544,-615 544,-591 598,-591 598,-615"/>
<text text-anchor="middle" x="571" y="-600.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~npa_f~~CallsGraph_edge83" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M451.258,-584.165C474.355,-587.829 508.198,-593.197 533.85,-597.266"/>
<polygon fill="#000000" stroke="#000000" points="533.512,-600.756 543.937,-598.866 534.609,-593.842 533.512,-600.756"/>
</g>
<!-- proc~balance -->
<g id="proc~~npa_f~~CallsGraph_node65" class="node"><title>proc~balance</title>
<g id="a_proc~~npa_f~~CallsGraph_node65"><a xlink:href=".././proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-573 544,-573 544,-549 598,-549 598,-573"/>
<text text-anchor="middle" x="571" y="-558.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~npa_f~~CallsGraph_edge84" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M451.258,-576.559C474.355,-573.533 508.198,-569.098 533.85,-565.737"/>
<polygon fill="#000000" stroke="#000000" points="534.476,-569.185 543.937,-564.415 533.567,-562.244 534.476,-569.185"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~npa_f~~CallsGraph_node66" class="node"><title>proc~hqr2</title>
<g id="a_proc~~npa_f~~CallsGraph_node66"><a xlink:href=".././proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-531 544,-531 544,-507 598,-507 598,-531"/>
<text text-anchor="middle" x="571" y="-516.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~npa_f~~CallsGraph_edge85" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M451.258,-568.953C474.56,-559.15 508.8,-544.746 534.532,-533.921"/>
<polygon fill="#000000" stroke="#000000" points="536.077,-537.068 543.937,-529.964 533.362,-530.616 536.077,-537.068"/>
</g>
<!-- dgetrs -->
<g id="proc~~npa_f~~CallsGraph_node59" class="node"><title>dgetrs</title>
<polygon fill="#777777" stroke="#777777" points="598,-447 544,-447 544,-423 598,-423 598,-447"/>
<text text-anchor="middle" x="571" y="-432.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrs</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrs -->
<g id="proc~~npa_f~~CallsGraph_edge87" class="edge"><title>proc~linsolve&#45;&gt;dgetrs</title>
<path fill="none" stroke="#000000" d="M451.258,-434.181C474.355,-434.34 508.198,-434.574 533.85,-434.751"/>
<polygon fill="#000000" stroke="#000000" points="533.913,-438.251 543.937,-434.82 533.961,-431.251 533.913,-438.251"/>
</g>
<!-- proc~matinv -->
<g id="proc~~npa_f~~CallsGraph_node62" class="node"><title>proc~matinv</title>
<g id="a_proc~~npa_f~~CallsGraph_node62"><a xlink:href=".././proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-405 544,-405 544,-381 598,-381 598,-405"/>
<text text-anchor="middle" x="571" y="-390.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~linsolve&#45;&gt;proc~matinv -->
<g id="proc~~npa_f~~CallsGraph_edge86" class="edge"><title>proc~linsolve&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M451.258,-426.575C474.458,-420.015 508.499,-410.39 534.192,-403.125"/>
<polygon fill="#000000" stroke="#000000" points="535.267,-406.458 543.937,-400.37 533.362,-399.723 535.267,-406.458"/>
</g>
<!-- dgetrf -->
<g id="proc~~npa_f~~CallsGraph_node64" class="node"><title>dgetrf</title>
<polygon fill="#777777" stroke="#777777" points="598,-363 544,-363 544,-339 598,-339 598,-363"/>
<text text-anchor="middle" x="571" y="-348.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrf</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrf -->
<g id="proc~~npa_f~~CallsGraph_edge88" class="edge"><title>proc~linsolve&#45;&gt;dgetrf</title>
<path fill="none" stroke="#000000" d="M451.031,-428.954C465.111,-425.419 482.358,-419.731 496,-411 515.868,-398.284 513.439,-386.558 532,-372 533.386,-370.913 534.836,-369.849 536.327,-368.813"/>
<polygon fill="#000000" stroke="#000000" points="538.572,-371.534 545.144,-363.224 534.824,-365.622 538.572,-371.534"/>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_edge89" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M466.754,-653.061C476.381,-655.921 486.564,-659.012 496,-662 505.599,-665.04 515.855,-668.419 525.579,-671.686"/>
<polygon fill="#000000" stroke="#000000" points="524.488,-675.011 535.082,-674.898 526.729,-668.38 524.488,-675.011"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~npa_f~~CallsGraph_node68" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~npa_f~~CallsGraph_node68"><a xlink:href=".././proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="707,-405 653,-405 653,-381 707,-381 707,-405"/>
<text text-anchor="middle" x="680" y="-390.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~npa_f~~CallsGraph_edge90" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M598.175,-393C611.518,-393 627.96,-393 642.523,-393"/>
<polygon fill="#000000" stroke="#000000" points="642.724,-396.5 652.724,-393 642.724,-389.5 642.724,-396.5"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~npa_f~~CallsGraph_node67" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~npa_f~~CallsGraph_node67"><a xlink:href=".././proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="707,-531 653,-531 653,-507 707,-507 707,-531"/>
<text text-anchor="middle" x="680" y="-516.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~npa_f~~CallsGraph_edge91" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M598.175,-519C611.518,-519 627.96,-519 642.523,-519"/>
<polygon fill="#000000" stroke="#000000" points="642.724,-522.5 652.724,-519 642.724,-515.5 642.724,-522.5"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~npa_f~~CallsGraph_node69" class="node"><title>proc~outerprod</title>
<g id="a_proc~~npa_f~~CallsGraph_node69"><a xlink:href=".././proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="809.5,-405 750.5,-405 750.5,-381 809.5,-381 809.5,-405"/>
<text text-anchor="middle" x="780" y="-390.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~npa_f~~CallsGraph_edge92" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M707.005,-393C717.251,-393 729.231,-393 740.446,-393"/>
<polygon fill="#000000" stroke="#000000" points="740.459,-396.5 750.459,-393 740.459,-389.5 740.459,-396.5"/>
</g>
</g>
</svg>
</div><script>var panprocnpa_fCallsGraph = svgPanZoom('#procnpa_fCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~npa_f~~CalledByGraph Pages: 1 -->
<svg id="procnpa_fCalledByGraph" width="152pt" height="32pt"
 viewBox="0.00 0.00 152.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~npa_f~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~npa_f~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 148,-28 148,4 -4,4"/>
<!-- proc~npa_f -->
<g id="proc~~npa_f~~CalledByGraph_node1" class="node"><title>proc~npa_f</title>
<polygon fill="none" stroke="black" points="144,-24 90,-24 90,-0 144,-0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">npa_f</text>
</g>
<!-- program~fidasim -->
<g id="proc~~npa_f~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~npa_f~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_f -->
<g id="proc~~npa_f~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~npa_f</title>
<path fill="none" stroke="#000000" d="M54.4029,-12C62.3932,-12 71.3106,-12 79.8241,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.919,-15.5001 89.919,-12 79.919,-8.5001 79.919,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/npa_f.html#src">npa_f</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">npa_f</span>
    <span class="c">!+ Calculate Active NPA flux using a fast-ion distribution function F(E,p,r,z)</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">det</span><span class="p">,</span><span class="n">ic</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">Int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iion</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rg</span><span class="p">,</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ind</span><span class="p">,</span><span class="n">pind</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">denf</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span> <span class="kd">::</span> <span class="n">plasma</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fields</span>
    <span class="k">type</span><span class="p">(</span><span class="n">GyroSurface</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gs</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gyrange</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="kd">::</span> <span class="n">neut_types</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rates</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">states</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">flux</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">dtheta</span><span class="p">,</span> <span class="n">eb</span><span class="p">,</span> <span class="n">ptch</span>

    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">inpa</span><span class="p">,</span><span class="n">ichan</span><span class="p">,</span><span class="n">nrange</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">npart</span><span class="p">,</span><span class="n">ncell</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cell_ind</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nx</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ny</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nz</span><span class="p">)</span> <span class="kd">::</span> <span class="n">papprox</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nx</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ny</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nz</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nlaunch</span>

    <span class="n">papprox</span><span class="o">=</span><span class="mf">0.d0</span>
    <span class="k">do </span><span class="n">ic</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span>
        <span class="k">call </span><span class="n">ind2sub</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">ic</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span> <span class="n">j</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">ind</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">plasma</span><span class="p">%</span><span class="n">in_plasma</span><span class="p">)</span> <span class="k">cycle</span>
<span class="k">        </span><span class="n">papprox</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">full</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
                        <span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">half</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
                        <span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">third</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
                        <span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">dcx</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
                        <span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">halo</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span><span class="o">*</span> <span class="p">&amp;</span>
                        <span class="n">plasma</span><span class="p">%</span><span class="n">denf</span>
    <span class="n">enddo</span>

    <span class="n">ncell</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">do </span><span class="n">ic</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span>
        <span class="k">call </span><span class="n">ind2sub</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">ic</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span> <span class="n">j</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">papprox</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">ncell</span> <span class="o">=</span> <span class="n">ncell</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">cell_ind</span><span class="p">(</span><span class="n">ncell</span><span class="p">)</span> <span class="o">=</span> <span class="n">ic</span>
        <span class="n">endif</span>
    <span class="n">enddo</span>

    <span class="k">call </span><span class="n">get_nlaunch</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_npa</span><span class="p">,</span> <span class="n">papprox</span><span class="p">,</span> <span class="n">nlaunch</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i12)&#39;</span><span class="p">)</span> <span class="nb">sum</span><span class="p">(</span><span class="n">nlaunch</span><span class="p">)</span>
    <span class="n">endif</span>

    <span class="c">!! Loop over all cells that can contribute to NPA signal</span>
    <span class="c">!$OMP PARALLEL DO schedule(dynamic,1) private(ic,i,j,k,ind,iion,ichan,fields,nrange,gyrange, &amp;</span>
    <span class="c">!$OMP&amp; pind,vi,ri,rf,det,plasma,rates,states,flux,denf,eb,ptch,gs,ir,theta,dtheta)</span>
    <span class="n">loop_over_cells</span><span class="p">:</span> <span class="k">do </span><span class="n">ic</span> <span class="o">=</span> <span class="n">istart</span><span class="p">,</span> <span class="n">ncell</span><span class="p">,</span> <span class="n">istep</span>
        <span class="k">call </span><span class="n">ind2sub</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="n">cell_ind</span><span class="p">(</span><span class="n">ic</span><span class="p">),</span><span class="n">ind</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span> <span class="n">j</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">loop_over_fast_ions</span><span class="p">:</span> <span class="k">do </span><span class="n">iion</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
            <span class="c">!! Sample fast ion distribution for energy and pitch</span>
            <span class="k">call </span><span class="n">mc_fastion</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">eb</span><span class="p">,</span> <span class="n">ptch</span><span class="p">,</span> <span class="n">denf</span><span class="p">)</span>
            <span class="k">if</span><span class="p">(</span><span class="n">denf</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">loop_over_fast_ions</span>

            <span class="k">call </span><span class="n">gyro_surface</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">eb</span><span class="p">,</span> <span class="n">ptch</span><span class="p">,</span> <span class="n">fbm</span><span class="p">%</span><span class="n">A</span><span class="p">,</span> <span class="n">gs</span><span class="p">)</span>

            <span class="n">detector_loop</span><span class="p">:</span> <span class="k">do </span><span class="n">ichan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">npa_chords</span><span class="p">%</span><span class="n">nchan</span>
                <span class="k">call </span><span class="n">npa_gyro_range</span><span class="p">(</span><span class="n">ichan</span><span class="p">,</span> <span class="n">gs</span><span class="p">,</span> <span class="n">gyrange</span><span class="p">,</span> <span class="n">nrange</span><span class="p">)</span>
                <span class="k">if</span><span class="p">(</span><span class="n">nrange</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">detector_loop</span>
                <span class="n">gyro_range_loop</span><span class="p">:</span> <span class="k">do </span><span class="n">ir</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nrange</span>
                    <span class="n">dtheta</span> <span class="o">=</span> <span class="n">gyrange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span>
                    <span class="n">theta</span> <span class="o">=</span> <span class="n">gyrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dtheta</span>
                    <span class="k">call </span><span class="n">gyro_trajectory</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">)</span>

                    <span class="c">!! Check if particle hits a NPA detector</span>
                    <span class="k">call </span><span class="n">hit_npa_detector</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span> <span class="n">vi</span> <span class="p">,</span><span class="n">det</span><span class="p">,</span> <span class="n">rf</span><span class="p">,</span> <span class="n">ichan</span><span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">det</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">ichan</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                        if</span> <span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="k">                            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s2">&quot;NPA_F: Missed Detector &quot;</span><span class="p">,</span><span class="n">ichan</span>
                        <span class="n">endif</span>
                        <span class="k">cycle </span><span class="n">gyro_range_loop</span>
                    <span class="n">endif</span>

                    <span class="c">!! Get beam grid indices at ri</span>
                    <span class="k">call </span><span class="n">get_indices</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">pind</span><span class="p">)</span>

                    <span class="c">!! Calculate CX probability with beam and halo neutrals</span>
                    <span class="k">call </span><span class="n">get_total_cx_rate</span><span class="p">(</span><span class="n">pind</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">,</span> <span class="n">neut_types</span><span class="p">,</span> <span class="n">rates</span><span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span> <span class="k">cycle </span><span class="n">gyro_range_loop</span>

                    <span class="c">!! Weight CX rates by ion source density</span>
                    <span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">denf</span>

                    <span class="c">!! Attenuate states as the particle move through plasma</span>
                    <span class="k">call </span><span class="n">attenuate</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">states</span><span class="p">)</span>

                    <span class="c">!! Store NPA Flux</span>
                    <span class="n">flux</span> <span class="o">=</span> <span class="p">(</span><span class="n">dtheta</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="o">*</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="o">/</span><span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
                    <span class="k">call </span><span class="n">store_npa</span><span class="p">(</span><span class="n">det</span><span class="p">,</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">flux</span><span class="p">)</span>
                <span class="n">enddo</span> <span class="n">gyro_range_loop</span>
            <span class="n">enddo</span> <span class="n">detector_loop</span>
        <span class="n">enddo</span> <span class="n">loop_over_fast_ions</span>
    <span class="n">enddo</span> <span class="n">loop_over_cells</span>
    <span class="c">!$OMP END PARALLEL DO</span>

    <span class="n">npart</span> <span class="o">=</span> <span class="n">npa</span><span class="p">%</span><span class="n">npart</span>
<span class="cp">#ifdef _MPI</span>
    <span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">npart</span><span class="p">)</span>
    <span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">npa</span><span class="p">%</span><span class="n">flux</span><span class="p">)</span>
<span class="cp">#endif</span>

    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T4,&quot;Number of Active NPA particles that hit a detector: &quot;,i8)&#39;</span><span class="p">)</span> <span class="n">npart</span>
    <span class="n">endif</span>

<span class="k">end subroutine </span><span class="n">npa_f</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> FIDASIM was developed by Luke Stagner</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>