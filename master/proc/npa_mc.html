<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="">
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>npa_mc &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>User Guide</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>npa_mc
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.7% of total for procedures.">103 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
     <li><a href='../module/libfida.html'>libfida</a></li>
     <li class="active">npa_mc</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/npa_mc.html#src">npa_mc</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public subroutine npa_mc()</h2>
    

    <p>Calculate Active NPA flux using a Monte Carlo fast-ion distribution</p>

    <h3>Arguments</h3>
    <em>None</em>
    <br>
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~npa_mc~~CallsGraph Pages: 1 -->
<svg id="procnpa_mcCallsGraph" width="641pt" height="920pt"
 viewBox="0.00 0.00 641.00 920.46" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~npa_mc~~CallsGraph" class="graph" transform="scale(0.781707 0.781707) rotate(0) translate(4 1173.5)">
<title>proc~~npa_mc~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1173.5 816,-1173.5 816,4 -4,4"/>
<!-- proc~npa_mc -->
<g id="proc~~npa_mc~~CallsGraph_node1" class="node"><title>proc~npa_mc</title>
<polygon fill="none" stroke="black" points="54,-542 0,-542 0,-518 54,-518 54,-542"/>
<text text-anchor="middle" x="27" y="-527.6" font-family="Helvetica,sans-Serif" font-size="10.50">npa_mc</text>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~npa_mc~~CallsGraph_node2" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~npa_mc~~CallsGraph_node2"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="174.5,-962 101.5,-962 101.5,-938 174.5,-938 174.5,-962"/>
<text text-anchor="middle" x="138" y="-947.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;interface~parallel_sum -->
<g id="proc~~npa_mc~~CallsGraph_edge1" class="edge"><title>proc~npa_mc&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M29.2802,-542.142C34.0234,-584.994 52.3021,-732.817 90,-849 99.3359,-877.773 114.808,-909.088 125.433,-929.099"/>
<polygon fill="#000000" stroke="#000000" points="122.383,-930.816 130.212,-937.954 128.543,-927.491 122.383,-930.816"/>
</g>
<!-- proc~gyro_surface -->
<g id="proc~~npa_mc~~CallsGraph_node3" class="node"><title>proc~gyro_surface</title>
<g id="a_proc~~npa_mc~~CallsGraph_node3"><a xlink:href=".././proc/gyro_surface.html" xlink:title="gyro_surface">
<polygon fill="#d9534f" stroke="#d9534f" points="175.5,-840 100.5,-840 100.5,-816 175.5,-816 175.5,-840"/>
<text text-anchor="middle" x="138" y="-825.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_surface</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~gyro_surface -->
<g id="proc~~npa_mc~~CallsGraph_edge2" class="edge"><title>proc~npa_mc&#45;&gt;proc~gyro_surface</title>
<path fill="none" stroke="#000000" d="M29.2621,-542.076C34.465,-589.832 55.6092,-764.938 90,-807 90.7071,-807.865 91.4573,-808.695 92.2445,-809.493"/>
<polygon fill="#000000" stroke="#000000" points="90.1711,-812.316 100.173,-815.811 94.5335,-806.841 90.1711,-812.316"/>
</g>
<!-- interface~randu -->
<g id="proc~~npa_mc~~CallsGraph_node4" class="node"><title>interface~randu</title>
<g id="a_proc~~npa_mc~~CallsGraph_node4"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="165,-798 111,-798 111,-774 165,-774 165,-798"/>
<text text-anchor="middle" x="138" y="-783.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;interface~randu -->
<g id="proc~~npa_mc~~CallsGraph_edge3" class="edge"><title>proc~npa_mc&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M28.0801,-542.191C28.9315,-579.071 36.0681,-691.138 90,-760 93.2935,-764.205 97.4663,-767.83 101.96,-770.924"/>
<polygon fill="#000000" stroke="#000000" points="100.47,-774.111 110.85,-776.233 104.058,-768.101 100.47,-774.111"/>
</g>
<!-- proc~get_total_cx_rate -->
<g id="proc~~npa_mc~~CallsGraph_node5" class="node"><title>proc~get_total_cx_rate</title>
<g id="a_proc~~npa_mc~~CallsGraph_node5"><a xlink:href=".././proc/get_total_cx_rate.html" xlink:title="get_total_cx_rate">
<polygon fill="#d9534f" stroke="#d9534f" points="185.5,-480 90.5,-480 90.5,-456 185.5,-456 185.5,-480"/>
<text text-anchor="middle" x="138" y="-465.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_total_cx_rate</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~get_total_cx_rate -->
<g id="proc~~npa_mc~~CallsGraph_edge4" class="edge"><title>proc~npa_mc&#45;&gt;proc~get_total_cx_rate</title>
<path fill="none" stroke="#000000" d="M44.6385,-517.915C56.863,-509.307 74.0515,-497.759 90,-489 92.7319,-487.5 95.5918,-486.018 98.494,-484.579"/>
<polygon fill="#000000" stroke="#000000" points="100.276,-487.607 107.803,-480.15 97.2693,-481.285 100.276,-487.607"/>
</g>
<!-- proc~hit_npa_detector -->
<g id="proc~~npa_mc~~CallsGraph_node6" class="node"><title>proc~hit_npa_detector</title>
<g id="a_proc~~npa_mc~~CallsGraph_node6"><a xlink:href=".././proc/hit_npa_detector.html" xlink:title="hit_npa_detector">
<polygon fill="#d9534f" stroke="#d9534f" points="315.5,-255 222.5,-255 222.5,-231 315.5,-231 315.5,-255"/>
<text text-anchor="middle" x="269" y="-240.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hit_npa_detector</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~hit_npa_detector -->
<g id="proc~~npa_mc~~CallsGraph_edge5" class="edge"><title>proc~npa_mc&#45;&gt;proc~hit_npa_detector</title>
<path fill="none" stroke="#000000" d="M34.1888,-517.896C43.8567,-500.082 64.1441,-466.781 90,-447 126.445,-419.117 154.219,-442.101 186,-409 219.586,-374.02 199.458,-348.936 222,-306 230.004,-290.755 241.404,-275.113 250.852,-263.229"/>
<polygon fill="#000000" stroke="#000000" points="253.709,-265.264 257.311,-255.3 248.282,-260.843 253.709,-265.264"/>
</g>
<!-- proc~get_indices -->
<g id="proc~~npa_mc~~CallsGraph_node7" class="node"><title>proc~get_indices</title>
<g id="a_proc~~npa_mc~~CallsGraph_node7"><a xlink:href=".././proc/get_indices.html" xlink:title="get_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="171.5,-358 104.5,-358 104.5,-334 171.5,-334 171.5,-358"/>
<text text-anchor="middle" x="138" y="-343.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_indices</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~get_indices -->
<g id="proc~~npa_mc~~CallsGraph_edge7" class="edge"><title>proc~npa_mc&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M29.4444,-517.678C33.5369,-487.993 47.7902,-411.675 90,-367 91.7723,-365.124 93.7427,-363.404 95.844,-361.829"/>
<polygon fill="#000000" stroke="#000000" points="97.8305,-364.715 104.455,-356.447 94.1204,-358.779 97.8305,-364.715"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~npa_mc~~CallsGraph_node8" class="node"><title>proc~get_fields</title>
<g id="a_proc~~npa_mc~~CallsGraph_node8"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="298,-602 240,-602 240,-578 298,-578 298,-602"/>
<text text-anchor="middle" x="269" y="-587.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~get_fields -->
<g id="proc~~npa_mc~~CallsGraph_edge8" class="edge"><title>proc~npa_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M54.0186,-536.349C85.3483,-544.01 139.556,-557.321 186,-569 200.45,-572.634 216.317,-576.683 230.211,-580.249"/>
<polygon fill="#000000" stroke="#000000" points="229.375,-583.648 239.931,-582.747 231.117,-576.868 229.375,-583.648"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~npa_mc~~CallsGraph_node9" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~npa_mc~~CallsGraph_node9"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="716,-640 648,-640 648,-616 716,-616 716,-640"/>
<text text-anchor="middle" x="682" y="-625.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_mc~~CallsGraph_edge10" class="edge"><title>proc~npa_mc&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M33.8977,-542.232C56.875,-587.925 145.236,-746 268,-746 268,-746 268,-746 425,-746 518.858,-746 615.766,-679.772 658.476,-646.548"/>
<polygon fill="#000000" stroke="#000000" points="660.846,-649.136 666.513,-640.184 656.5,-643.648 660.846,-649.136"/>
</g>
<!-- proc~store_npa -->
<g id="proc~~npa_mc~~CallsGraph_node10" class="node"><title>proc~store_npa</title>
<g id="a_proc~~npa_mc~~CallsGraph_node10"><a xlink:href=".././proc/store_npa.html" xlink:title="store_npa">
<polygon fill="#d9534f" stroke="#d9534f" points="168.5,-602 107.5,-602 107.5,-578 168.5,-578 168.5,-602"/>
<text text-anchor="middle" x="138" y="-587.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_npa</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~store_npa -->
<g id="proc~~npa_mc~~CallsGraph_edge9" class="edge"><title>proc~npa_mc&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M50.0578,-542.142C66.1617,-551.006 88.2073,-563.142 106.069,-572.974"/>
<polygon fill="#000000" stroke="#000000" points="104.527,-576.12 114.975,-577.876 107.902,-569.988 104.527,-576.12"/>
</g>
<!-- proc~attenuate -->
<g id="proc~~npa_mc~~CallsGraph_node11" class="node"><title>proc~attenuate</title>
<g id="a_proc~~npa_mc~~CallsGraph_node11"><a xlink:href=".././proc/attenuate.html" xlink:title="attenuate">
<polygon fill="#d9534f" stroke="#d9534f" points="167,-522 109,-522 109,-498 167,-498 167,-522"/>
<text text-anchor="middle" x="138" y="-507.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">attenuate</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~attenuate -->
<g id="proc~~npa_mc~~CallsGraph_edge6" class="edge"><title>proc~npa_mc&#45;&gt;proc~attenuate</title>
<path fill="none" stroke="#000000" d="M54.1082,-525.21C67.5155,-522.749 84.1032,-519.706 98.909,-516.989"/>
<polygon fill="#000000" stroke="#000000" points="99.6094,-520.419 108.814,-515.172 98.346,-513.534 99.6094,-520.419"/>
</g>
<!-- proc~gyro_trajectory -->
<g id="proc~~npa_mc~~CallsGraph_node12" class="node"><title>proc~gyro_trajectory</title>
<g id="a_proc~~npa_mc~~CallsGraph_node12"><a xlink:href=".././proc/gyro_trajectory.html" xlink:title="gyro_trajectory">
<polygon fill="#d9534f" stroke="#d9534f" points="180,-316 96,-316 96,-292 180,-292 180,-316"/>
<text text-anchor="middle" x="138" y="-301.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_trajectory</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~gyro_trajectory -->
<g id="proc~~npa_mc~~CallsGraph_edge11" class="edge"><title>proc~npa_mc&#45;&gt;proc~gyro_trajectory</title>
<path fill="none" stroke="#000000" d="M28.3079,-517.704C29.8146,-483.048 38.6332,-383.314 90,-325 90.864,-324.019 91.7826,-323.082 92.7469,-322.186"/>
<polygon fill="#000000" stroke="#000000" points="94.9652,-324.898 100.882,-316.109 90.7758,-319.29 94.9652,-324.898"/>
</g>
<!-- proc~npa_gyro_range -->
<g id="proc~~npa_mc~~CallsGraph_node13" class="node"><title>proc~npa_gyro_range</title>
<g id="a_proc~~npa_mc~~CallsGraph_node13"><a xlink:href=".././proc/npa_gyro_range.html" xlink:title="npa_gyro_range">
<polygon fill="#d9534f" stroke="#d9534f" points="183.5,-400 92.5,-400 92.5,-376 183.5,-376 183.5,-400"/>
<text text-anchor="middle" x="138" y="-385.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_gyro_range</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~npa_gyro_range -->
<g id="proc~~npa_mc~~CallsGraph_edge12" class="edge"><title>proc~npa_mc&#45;&gt;proc~npa_gyro_range</title>
<path fill="none" stroke="#000000" d="M31.9168,-517.73C39.7364,-494.862 59.2228,-445.225 90,-414 93.0194,-410.937 96.4765,-408.133 100.116,-405.595"/>
<polygon fill="#000000" stroke="#000000" points="102.191,-408.426 108.817,-400.159 98.4814,-402.489 102.191,-408.426"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~npa_mc~~CallsGraph_node15" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~npa_mc~~CallsGraph_node15"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1126 223.5,-1126 223.5,-1102 314.5,-1102 314.5,-1126"/>
<text text-anchor="middle" x="269" y="-1111.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~npa_mc~~CallsGraph_edge15" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M143.742,-962.095C154.374,-987.952 182.332,-1049.39 222,-1088 225.106,-1091.02 228.633,-1093.82 232.319,-1096.36"/>
<polygon fill="#000000" stroke="#000000" points="230.751,-1099.51 241.086,-1101.84 234.46,-1093.57 230.751,-1099.51"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~npa_mc~~CallsGraph_node16" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~npa_mc~~CallsGraph_node16"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-798 225,-798 225,-774 313,-774 313,-798"/>
<text text-anchor="middle" x="269" y="-783.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~npa_mc~~CallsGraph_edge16" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M143.219,-937.596C153.003,-910.498 179.685,-845.373 222,-807 223.297,-805.824 224.67,-804.704 226.101,-803.638"/>
<polygon fill="#000000" stroke="#000000" points="228.223,-806.436 234.783,-798.116 224.467,-800.53 228.223,-806.436"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~npa_mc~~CallsGraph_node17" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~npa_mc~~CallsGraph_node17"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-912 380,-912 380,-888 468,-888 468,-912"/>
<text text-anchor="middle" x="424" y="-897.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~npa_mc~~CallsGraph_edge18" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.766,-940.08C189.339,-936.266 206.399,-932.09 222,-929 271.738,-919.148 329.026,-911.213 369.684,-906.151"/>
<polygon fill="#000000" stroke="#000000" points="370.15,-909.62 379.648,-904.926 369.296,-902.672 370.15,-909.62"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~npa_mc~~CallsGraph_node22" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~npa_mc~~CallsGraph_node22"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-962 225,-962 225,-938 313,-938 313,-962"/>
<text text-anchor="middle" x="269" y="-947.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~npa_mc~~CallsGraph_edge14" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.591,-950C186.952,-950 201.1,-950 214.581,-950"/>
<polygon fill="#000000" stroke="#000000" points="214.72,-953.5 224.72,-950 214.72,-946.5 214.72,-953.5"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~npa_mc~~CallsGraph_node23" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~npa_mc~~CallsGraph_node23"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="469.5,-1086 378.5,-1086 378.5,-1062 469.5,-1062 469.5,-1086"/>
<text text-anchor="middle" x="424" y="-1071.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_mc~~CallsGraph_edge17" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M144.448,-962.055C155.434,-984.776 182.602,-1033.58 222,-1055 266.805,-1079.36 325.61,-1082.17 368.027,-1080.05"/>
<polygon fill="#000000" stroke="#000000" points="368.398,-1083.54 378.168,-1079.44 367.975,-1076.55 368.398,-1083.54"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~npa_mc~~CallsGraph_node24" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~npa_mc~~CallsGraph_node24"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1046 223.5,-1046 223.5,-1022 314.5,-1022 314.5,-1046"/>
<text text-anchor="middle" x="269" y="-1031.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~npa_mc~~CallsGraph_edge19" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M153.005,-962.172C168.977,-975.677 196.224,-997.592 222,-1013 224.473,-1014.48 227.067,-1015.92 229.711,-1017.32"/>
<polygon fill="#000000" stroke="#000000" points="228.28,-1020.51 238.791,-1021.85 231.404,-1014.25 228.28,-1020.51"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~npa_mc~~CallsGraph_node27" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~npa_mc~~CallsGraph_node27"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-882 225,-882 225,-858 313,-858 313,-882"/>
<text text-anchor="middle" x="269" y="-867.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~npa_mc~~CallsGraph_edge22" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M156.928,-937.873C173.6,-926.707 199.223,-909.828 222,-896 226.803,-893.084 231.941,-890.075 236.978,-887.185"/>
<polygon fill="#000000" stroke="#000000" points="238.873,-890.134 245.844,-882.155 235.419,-884.045 238.873,-890.134"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~npa_mc~~CallsGraph_node28" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~npa_mc~~CallsGraph_node28"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1004 223.5,-1004 223.5,-980 314.5,-980 314.5,-1004"/>
<text text-anchor="middle" x="269" y="-989.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~npa_mc~~CallsGraph_edge13" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.591,-961.588C188.907,-966.249 205.617,-971.689 220.915,-976.67"/>
<polygon fill="#000000" stroke="#000000" points="220.132,-980.096 230.724,-979.864 222.299,-973.44 220.132,-980.096"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~npa_mc~~CallsGraph_node30" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~npa_mc~~CallsGraph_node30"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1168 223.5,-1168 223.5,-1144 314.5,-1144 314.5,-1168"/>
<text text-anchor="middle" x="269" y="-1153.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~npa_mc~~CallsGraph_edge20" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M141.314,-962.057C148.072,-994.253 170.642,-1083.31 222,-1135 223.083,-1136.09 224.232,-1137.13 225.435,-1138.12"/>
<polygon fill="#000000" stroke="#000000" points="223.754,-1141.21 233.985,-1143.96 227.703,-1135.43 223.754,-1141.21"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~npa_mc~~CallsGraph_node31" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~npa_mc~~CallsGraph_node31"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-840 223.5,-840 223.5,-816 314.5,-816 314.5,-840"/>
<text text-anchor="middle" x="269" y="-825.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~npa_mc~~CallsGraph_edge21" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M146.298,-937.913C159.269,-917.289 188.177,-875.012 222,-849 223.753,-847.652 225.606,-846.366 227.523,-845.143"/>
<polygon fill="#000000" stroke="#000000" points="229.266,-848.178 236.221,-840.185 225.8,-842.096 229.266,-848.178"/>
</g>
<!-- proc~neutral_cx_rate -->
<g id="proc~~npa_mc~~CallsGraph_node33" class="node"><title>proc~neutral_cx_rate</title>
<g id="a_proc~~npa_mc~~CallsGraph_node33"><a xlink:href=".././proc/neutral_cx_rate.html" xlink:title="neutral_cx_rate">
<polygon fill="#d9534f" stroke="#d9534f" points="312.5,-441 225.5,-441 225.5,-417 312.5,-417 312.5,-441"/>
<text text-anchor="middle" x="269" y="-426.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutral_cx_rate</text>
</a>
</g>
</g>
<!-- proc~get_total_cx_rate&#45;&gt;proc~neutral_cx_rate -->
<g id="proc~~npa_mc~~CallsGraph_edge23" class="edge"><title>proc~get_total_cx_rate&#45;&gt;proc~neutral_cx_rate</title>
<path fill="none" stroke="#000000" d="M178.757,-455.98C191.263,-452.199 205.233,-447.976 218.338,-444.014"/>
<polygon fill="#000000" stroke="#000000" points="219.593,-447.291 228.152,-441.047 217.567,-440.591 219.593,-447.291"/>
</g>
<!-- proc~in_boundary -->
<g id="proc~~npa_mc~~CallsGraph_node18" class="node"><title>proc~in_boundary</title>
<g id="a_proc~~npa_mc~~CallsGraph_node18"><a xlink:href=".././proc/in_boundary.html" xlink:title="in_boundary">
<polygon fill="#d94e8f" stroke="#d94e8f" points="460,-192 388,-192 388,-168 460,-168 460,-192"/>
<text text-anchor="middle" x="424" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_boundary</text>
</a>
</g>
</g>
<!-- proc~hit_npa_detector&#45;&gt;proc~in_boundary -->
<g id="proc~~npa_mc~~CallsGraph_edge25" class="edge"><title>proc~hit_npa_detector&#45;&gt;proc~in_boundary</title>
<path fill="none" stroke="#000000" d="M297.946,-230.782C303.955,-228.005 310.232,-224.989 316,-222 332.446,-213.476 334.996,-208.347 352,-201 360.231,-197.444 369.247,-194.267 378.009,-191.526"/>
<polygon fill="#000000" stroke="#000000" points="379.16,-194.835 387.74,-188.62 377.156,-188.128 379.16,-194.835"/>
</g>
<!-- proc~line_plane_intersect -->
<g id="proc~~npa_mc~~CallsGraph_node21" class="node"><title>proc~line_plane_intersect</title>
<g id="a_proc~~npa_mc~~CallsGraph_node21"><a xlink:href=".././proc/line_plane_intersect.html" xlink:title="line_plane_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="478,-234 370,-234 370,-210 478,-210 478,-234"/>
<text text-anchor="middle" x="424" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">line_plane_intersect</text>
</a>
</g>
</g>
<!-- proc~hit_npa_detector&#45;&gt;proc~line_plane_intersect -->
<g id="proc~~npa_mc~~CallsGraph_edge24" class="edge"><title>proc~hit_npa_detector&#45;&gt;proc~line_plane_intersect</title>
<path fill="none" stroke="#000000" d="M315.905,-236.699C329.708,-234.805 345.102,-232.692 359.817,-230.672"/>
<polygon fill="#000000" stroke="#000000" points="360.438,-234.12 369.869,-229.293 359.486,-227.185 360.438,-234.12"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_mc~~CallsGraph_edge29" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M281.08,-602.036C295.657,-616.885 322.861,-641.35 352,-651 450.287,-683.549 573.873,-658.64 637.979,-641.205"/>
<polygon fill="#000000" stroke="#000000" points="639.052,-644.539 647.744,-638.481 637.171,-637.797 639.052,-644.539"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~npa_mc~~CallsGraph_node20" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~npa_mc~~CallsGraph_node20"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="454.5,-482 393.5,-482 393.5,-458 454.5,-458 454.5,-482"/>
<text text-anchor="middle" x="424" y="-467.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~npa_mc~~CallsGraph_edge27" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M285.512,-577.833C312.432,-556.72 367.941,-513.184 399.575,-488.372"/>
<polygon fill="#000000" stroke="#000000" points="401.738,-491.124 407.447,-482.199 397.418,-485.616 401.738,-491.124"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~npa_mc~~CallsGraph_node25" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~npa_mc~~CallsGraph_node25"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="474,-642 374,-642 374,-618 474,-618 474,-642"/>
<text text-anchor="middle" x="424" y="-627.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~npa_mc~~CallsGraph_edge28" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M298.063,-597.337C317.387,-602.389 343.716,-609.272 367.222,-615.418"/>
<polygon fill="#000000" stroke="#000000" points="366.535,-618.855 377.095,-617.999 368.305,-612.083 366.535,-618.855"/>
</g>
<!-- proc~get_position -->
<g id="proc~~npa_mc~~CallsGraph_node29" class="node"><title>proc~get_position</title>
<g id="a_proc~~npa_mc~~CallsGraph_node29"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="459,-562 389,-562 389,-538 459,-538 459,-562"/>
<text text-anchor="middle" x="424" y="-547.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~npa_mc~~CallsGraph_edge26" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M298.063,-582.663C320.682,-576.75 352.899,-568.327 378.952,-561.516"/>
<polygon fill="#000000" stroke="#000000" points="380.175,-564.814 388.964,-558.898 378.404,-558.041 380.175,-564.814"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~npa_mc~~CallsGraph_node34" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~npa_mc~~CallsGraph_node34"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="606,-602 538,-602 538,-578 606,-578 606,-602"/>
<text text-anchor="middle" x="572" y="-587.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_mc~~CallsGraph_edge30" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M298.047,-590C350.749,-590 464.887,-590 527.585,-590"/>
<polygon fill="#000000" stroke="#000000" points="527.928,-593.5 537.928,-590 527.928,-586.5 527.928,-593.5"/>
</g>
<!-- proc~store_npa&#45;&gt;proc~get_fields -->
<g id="proc~~npa_mc~~CallsGraph_edge31" class="edge"><title>proc~store_npa&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M168.595,-590C186.754,-590 210.196,-590 229.754,-590"/>
<polygon fill="#000000" stroke="#000000" points="229.87,-593.5 239.87,-590 229.87,-586.5 229.87,-593.5"/>
</g>
<!-- proc~store_npa&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_mc~~CallsGraph_edge32" class="edge"><title>proc~store_npa&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M162.672,-602.05C220.959,-630.026 375.43,-693.841 496,-651 519.085,-642.797 540.228,-624.117 554.139,-609.574"/>
<polygon fill="#000000" stroke="#000000" points="556.898,-611.744 561.089,-602.013 551.744,-607.006 556.898,-611.744"/>
</g>
<!-- proc~colrad -->
<g id="proc~~npa_mc~~CallsGraph_node26" class="node"><title>proc~colrad</title>
<g id="a_proc~~npa_mc~~CallsGraph_node26"><a xlink:href=".././proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="296,-339 242,-339 242,-315 296,-315 296,-339"/>
<text text-anchor="middle" x="269" y="-324.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~attenuate&#45;&gt;proc~colrad -->
<g id="proc~~npa_mc~~CallsGraph_edge34" class="edge"><title>proc~attenuate&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M167.448,-501.272C174.14,-498.206 180.823,-494.187 186,-489 213.829,-461.116 204.251,-443.171 222,-408 232.537,-387.121 245.848,-363.982 255.438,-347.8"/>
<polygon fill="#000000" stroke="#000000" points="258.483,-349.526 260.604,-339.146 252.473,-345.938 258.483,-349.526"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~npa_mc~~CallsGraph_node32" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~npa_mc~~CallsGraph_node32"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-522 235,-522 235,-498 303,-498 303,-522"/>
<text text-anchor="middle" x="269" y="-507.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~attenuate&#45;&gt;proc~get_plasma -->
<g id="proc~~npa_mc~~CallsGraph_edge33" class="edge"><title>proc~attenuate&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M167.31,-510C184.081,-510 205.678,-510 224.567,-510"/>
<polygon fill="#000000" stroke="#000000" points="224.735,-513.5 234.735,-510 224.735,-506.5 224.735,-513.5"/>
</g>
<!-- proc~approx_eq -->
<g id="proc~~npa_mc~~CallsGraph_node14" class="node"><title>proc~approx_eq</title>
<g id="a_proc~~npa_mc~~CallsGraph_node14"><a xlink:href=".././proc/approx_eq.html" xlink:title="approx_eq">
<polygon fill="#d94e8f" stroke="#d94e8f" points="301,-213 237,-213 237,-189 301,-189 301,-213"/>
<text text-anchor="middle" x="269" y="-198.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_eq</text>
</a>
</g>
</g>
<!-- proc~npa_gyro_range&#45;&gt;proc~approx_eq -->
<g id="proc~~npa_mc~~CallsGraph_edge35" class="edge"><title>proc~npa_gyro_range&#45;&gt;proc~approx_eq</title>
<path fill="none" stroke="#000000" d="M175.75,-375.746C179.591,-373.316 183.132,-370.426 186,-367 228.623,-316.085 179.583,-273.087 222,-222 223.717,-219.932 225.682,-218.057 227.811,-216.361"/>
<polygon fill="#000000" stroke="#000000" points="230.145,-219.02 236.654,-210.661 226.353,-213.137 230.145,-219.02"/>
</g>
<!-- proc~gyro_range -->
<g id="proc~~npa_mc~~CallsGraph_node19" class="node"><title>proc~gyro_range</title>
<g id="a_proc~~npa_mc~~CallsGraph_node19"><a xlink:href=".././proc/gyro_range.html" xlink:title="gyro_range">
<polygon fill="#d9534f" stroke="#d9534f" points="302.5,-150 235.5,-150 235.5,-126 302.5,-126 302.5,-150"/>
<text text-anchor="middle" x="269" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_range</text>
</a>
</g>
</g>
<!-- proc~npa_gyro_range&#45;&gt;proc~gyro_range -->
<g id="proc~~npa_mc~~CallsGraph_edge36" class="edge"><title>proc~npa_gyro_range&#45;&gt;proc~gyro_range</title>
<path fill="none" stroke="#000000" d="M175.928,-375.892C179.739,-373.436 183.224,-370.501 186,-367 238.585,-300.68 180.645,-253.846 222,-180 226.889,-171.269 234.254,-163.363 241.666,-156.826"/>
<polygon fill="#000000" stroke="#000000" points="244.108,-159.348 249.612,-150.295 239.664,-153.94 244.108,-159.348"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_mc~~CallsGraph_edge37" class="edge"><title>proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M314.665,-1102.32C331.402,-1097.95 350.614,-1092.92 368.167,-1088.34"/>
<polygon fill="#000000" stroke="#000000" points="369.49,-1091.61 378.279,-1085.69 367.719,-1084.83 369.49,-1091.61"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_node37" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="611.5,-989 532.5,-989 532.5,-965 611.5,-965 611.5,-989"/>
<text text-anchor="middle" x="572" y="-974.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge38" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M313.39,-1126.04C361.591,-1136.79 439.989,-1146.24 496,-1113 537.691,-1088.26 557.816,-1031.18 566.102,-999.398"/>
<polygon fill="#000000" stroke="#000000" points="569.595,-999.849 568.556,-989.305 562.793,-998.195 569.595,-999.849"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge39" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M313.192,-779.959C362.296,-775.506 442.555,-775.834 496,-815 542.443,-849.035 560.977,-918.989 567.65,-954.803"/>
<polygon fill="#000000" stroke="#000000" points="564.215,-955.482 569.358,-964.745 571.114,-954.297 564.215,-955.482"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~npa_mc~~CallsGraph_edge40" class="edge"><title>proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M399.529,-912.014C390.984,-920.972 399.141,-930 424,-930 439.149,-930 448.095,-926.647 450.839,-922.001"/>
<polygon fill="#000000" stroke="#000000" points="454.184,-920.936 448.471,-912.014 447.373,-922.552 454.184,-920.936"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge41" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M447.812,-912.031C472.311,-924.952 511.426,-945.581 538.996,-960.121"/>
<polygon fill="#000000" stroke="#000000" points="537.388,-963.23 547.866,-964.799 540.653,-957.038 537.388,-963.23"/>
</g>
<!-- proc~gyro_range&#45;&gt;proc~in_boundary -->
<g id="proc~~npa_mc~~CallsGraph_edge42" class="edge"><title>proc~gyro_range&#45;&gt;proc~in_boundary</title>
<path fill="none" stroke="#000000" d="M302.822,-147.01C324.817,-153.048 354.055,-161.074 378.185,-167.698"/>
<polygon fill="#000000" stroke="#000000" points="377.265,-171.075 387.835,-170.347 379.118,-164.324 377.265,-171.075"/>
</g>
<!-- proc~gyro_range&#45;&gt;proc~line_plane_intersect -->
<g id="proc~~npa_mc~~CallsGraph_edge47" class="edge"><title>proc~gyro_range&#45;&gt;proc~line_plane_intersect</title>
<path fill="none" stroke="#000000" d="M282.609,-150.109C297.891,-164.18 324.968,-187.223 352,-201 355.801,-202.937 359.809,-204.725 363.908,-206.37"/>
<polygon fill="#000000" stroke="#000000" points="362.986,-209.76 373.58,-209.95 365.417,-203.196 362.986,-209.76"/>
</g>
<!-- proc~gyro_surface_coordinates -->
<g id="proc~~npa_mc~~CallsGraph_node35" class="node"><title>proc~gyro_surface_coordinates</title>
<g id="a_proc~~npa_mc~~CallsGraph_node35"><a xlink:href=".././proc/gyro_surface_coordinates.html" xlink:title="gyro_surface_coordinates">
<polygon fill="#d9534f" stroke="#d9534f" points="492,-24 356,-24 356,-0 492,-0 492,-24"/>
<text text-anchor="middle" x="424" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_surface_coordinates</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~gyro_surface_coordinates -->
<g id="proc~~npa_mc~~CallsGraph_edge43" class="edge"><title>proc~gyro_range&#45;&gt;proc~gyro_surface_coordinates</title>
<path fill="none" stroke="#000000" d="M276.112,-125.938C287.809,-104.073 315.481,-57.8595 352,-33 354.522,-31.2832 357.187,-29.7042 359.946,-28.2523"/>
<polygon fill="#000000" stroke="#000000" points="361.428,-31.4232 369.021,-24.0343 358.477,-25.0754 361.428,-31.4232"/>
</g>
<!-- proc~boundary_edge -->
<g id="proc~~npa_mc~~CallsGraph_node39" class="node"><title>proc~boundary_edge</title>
<g id="a_proc~~npa_mc~~CallsGraph_node39"><a xlink:href=".././proc/boundary_edge.html" xlink:title="boundary_edge">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-150 380,-150 380,-126 468,-126 468,-150"/>
<text text-anchor="middle" x="424" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boundary_edge</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~boundary_edge -->
<g id="proc~~npa_mc~~CallsGraph_edge44" class="edge"><title>proc~gyro_range&#45;&gt;proc~boundary_edge</title>
<path fill="none" stroke="#000000" d="M302.822,-138C322.227,-138 347.271,-138 369.47,-138"/>
<polygon fill="#000000" stroke="#000000" points="369.77,-141.5 379.77,-138 369.77,-134.5 369.77,-141.5"/>
</g>
<!-- proc~line_gyro_surface_intersect -->
<g id="proc~~npa_mc~~CallsGraph_node40" class="node"><title>proc~line_gyro_surface_intersect</title>
<g id="a_proc~~npa_mc~~CallsGraph_node40"><a xlink:href=".././proc/line_gyro_surface_intersect.html" xlink:title="line_gyro_surface_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="496,-108 352,-108 352,-84 496,-84 496,-108"/>
<text text-anchor="middle" x="424" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">line_gyro_surface_intersect</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~line_gyro_surface_intersect -->
<g id="proc~~npa_mc~~CallsGraph_edge45" class="edge"><title>proc~gyro_range&#45;&gt;proc~line_gyro_surface_intersect</title>
<path fill="none" stroke="#000000" d="M302.822,-128.99C322.25,-123.657 347.33,-116.772 369.548,-110.673"/>
<polygon fill="#000000" stroke="#000000" points="370.48,-114.047 379.196,-108.025 368.627,-107.297 370.48,-114.047"/>
</g>
<!-- proc~in_gyro_surface -->
<g id="proc~~npa_mc~~CallsGraph_node41" class="node"><title>proc~in_gyro_surface</title>
<g id="a_proc~~npa_mc~~CallsGraph_node41"><a xlink:href=".././proc/in_gyro_surface.html" xlink:title="in_gyro_surface">
<polygon fill="#d94e8f" stroke="#d94e8f" points="468.5,-66 379.5,-66 379.5,-42 468.5,-42 468.5,-66"/>
<text text-anchor="middle" x="424" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_gyro_surface</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~in_gyro_surface -->
<g id="proc~~npa_mc~~CallsGraph_edge46" class="edge"><title>proc~gyro_range&#45;&gt;proc~in_gyro_surface</title>
<path fill="none" stroke="#000000" d="M282.609,-125.891C297.891,-111.82 324.968,-88.7768 352,-75 357.562,-72.1655 363.568,-69.6507 369.651,-67.4363"/>
<polygon fill="#000000" stroke="#000000" points="370.867,-70.7199 379.218,-64.201 368.624,-64.0887 370.867,-70.7199"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_mc~~CallsGraph_edge50" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M454.606,-475.497C468.491,-479.316 484.476,-485.649 496,-496 522.912,-520.174 506.882,-542.967 532,-569 532.901,-569.934 533.853,-570.836 534.845,-571.706"/>
<polygon fill="#000000" stroke="#000000" points="532.93,-574.643 543.057,-577.759 537.084,-569.008 532.93,-574.643"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~npa_mc~~CallsGraph_node44" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~npa_mc~~CallsGraph_node44"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="714.5,-521 649.5,-521 649.5,-497 714.5,-497 714.5,-521"/>
<text text-anchor="middle" x="682" y="-506.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~npa_mc~~CallsGraph_edge48" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M454.617,-474.512C500.052,-481.434 587.135,-494.7 639.048,-502.609"/>
<polygon fill="#000000" stroke="#000000" points="638.839,-506.117 649.252,-504.163 639.893,-499.197 638.839,-506.117"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~npa_mc~~CallsGraph_node46" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~npa_mc~~CallsGraph_node46"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="610.5,-442 533.5,-442 533.5,-418 610.5,-418 610.5,-442"/>
<text text-anchor="middle" x="572" y="-427.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_mc~~CallsGraph_edge49" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M454.545,-461.905C474.36,-456.477 500.891,-449.208 523.625,-442.979"/>
<polygon fill="#000000" stroke="#000000" points="524.714,-446.31 533.434,-440.292 522.865,-439.559 524.714,-446.31"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~npa_mc~~CallsGraph_edge51" class="edge"><title>proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M307.037,-937.896C327.915,-931.074 354.192,-922.486 376.452,-915.212"/>
<polygon fill="#000000" stroke="#000000" points="377.621,-918.512 386.039,-912.079 375.447,-911.858 377.621,-918.512"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge52" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M313.126,-953.868C368.485,-958.834 464.288,-967.428 522.241,-972.626"/>
<polygon fill="#000000" stroke="#000000" points="521.981,-976.117 532.254,-973.524 522.606,-969.145 521.981,-976.117"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_mc~~CallsGraph_edge53" class="edge"><title>proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M399.529,-1086.01C390.984,-1094.97 399.141,-1104 424,-1104 439.149,-1104 448.095,-1100.65 450.839,-1096"/>
<polygon fill="#000000" stroke="#000000" points="454.184,-1094.94 448.471,-1086.01 447.373,-1096.55 454.184,-1094.94"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge54" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M466.873,-1061.87C476.791,-1058.14 487.072,-1053.53 496,-1048 518.586,-1034.01 540.152,-1012.43 554.312,-996.732"/>
<polygon fill="#000000" stroke="#000000" points="557.025,-998.948 561.008,-989.131 551.772,-994.321 557.025,-998.948"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_mc~~CallsGraph_edge55" class="edge"><title>proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M314.665,-1045.68C331.402,-1050.05 350.614,-1055.08 368.167,-1059.66"/>
<polygon fill="#000000" stroke="#000000" points="367.719,-1063.17 378.279,-1062.31 369.49,-1056.39 367.719,-1063.17"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge56" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.881,-1028.4C360.69,-1022.32 433.707,-1011.64 496,-998 504.637,-996.109 513.756,-993.814 522.546,-991.445"/>
<polygon fill="#000000" stroke="#000000" points="523.579,-994.791 532.287,-988.756 521.716,-988.043 523.579,-994.791"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~npa_mc~~CallsGraph_node36" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~npa_mc~~CallsGraph_node36"><a xlink:href=".././proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-360 380,-360 380,-336 468,-336 468,-360"/>
<text text-anchor="middle" x="424" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~npa_mc~~CallsGraph_edge57" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M296.302,-330.61C316.427,-333.372 344.85,-337.274 369.677,-340.681"/>
<polygon fill="#000000" stroke="#000000" points="369.32,-344.165 379.703,-342.057 370.272,-337.23 369.32,-344.165"/>
</g>
<!-- proc~linsolve -->
<g id="proc~~npa_mc~~CallsGraph_node38" class="node"><title>proc~linsolve</title>
<g id="a_proc~~npa_mc~~CallsGraph_node38"><a xlink:href=".././proc/linsolve.html" xlink:title="linsolve">
<polygon fill="#d9534f" stroke="#d9534f" points="451,-276 397,-276 397,-252 451,-252 451,-276"/>
<text text-anchor="middle" x="424" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linsolve</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~linsolve -->
<g id="proc~~npa_mc~~CallsGraph_edge59" class="edge"><title>proc~colrad&#45;&gt;proc~linsolve</title>
<path fill="none" stroke="#000000" d="M291.073,-314.828C307.342,-305.773 330.614,-293.553 352,-285 363.262,-280.496 375.868,-276.459 387.297,-273.157"/>
<polygon fill="#000000" stroke="#000000" points="388.286,-276.515 396.974,-270.451 386.401,-269.773 388.286,-276.515"/>
</g>
<!-- proc~eigen -->
<g id="proc~~npa_mc~~CallsGraph_node45" class="node"><title>proc~eigen</title>
<g id="a_proc~~npa_mc~~CallsGraph_node45"><a xlink:href=".././proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="451,-318 397,-318 397,-294 451,-294 451,-318"/>
<text text-anchor="middle" x="424" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~npa_mc~~CallsGraph_edge58" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M296.302,-323.39C321.227,-319.969 358.881,-314.801 386.667,-310.987"/>
<polygon fill="#000000" stroke="#000000" points="387.355,-314.425 396.786,-309.598 386.403,-307.49 387.355,-314.425"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~npa_mc~~CallsGraph_edge60" class="edge"><title>proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M313.026,-878.437C330.626,-881.887 351.17,-885.916 369.707,-889.55"/>
<polygon fill="#000000" stroke="#000000" points="369.28,-893.033 379.767,-891.523 370.627,-886.164 369.28,-893.033"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge61" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M313.136,-861.356C360.762,-854.074 438.317,-849.066 496,-879 527.781,-895.493 550.031,-932.218 561.65,-955.73"/>
<polygon fill="#000000" stroke="#000000" points="558.543,-957.349 565.975,-964.9 564.874,-954.363 558.543,-957.349"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_mc~~CallsGraph_edge62" class="edge"><title>proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M297.436,-1004.04C303.594,-1006.87 310.061,-1009.96 316,-1013 343.025,-1026.84 372.988,-1044.09 394.316,-1056.71"/>
<polygon fill="#000000" stroke="#000000" points="392.796,-1059.88 403.18,-1061.99 396.375,-1053.87 392.796,-1059.88"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge63" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.738,-989.771C370.24,-987.005 464.546,-982.305 521.967,-979.444"/>
<polygon fill="#000000" stroke="#000000" points="522.428,-982.925 532.242,-978.931 522.08,-975.934 522.428,-982.925"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~npa_mc~~CallsGraph_node43" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~npa_mc~~CallsGraph_node43"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="603,-560 541,-560 541,-536 603,-536 603,-560"/>
<text text-anchor="middle" x="572" y="-545.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~npa_mc~~CallsGraph_edge64" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M459.231,-549.531C480.622,-549.238 508.271,-548.859 530.716,-548.552"/>
<polygon fill="#000000" stroke="#000000" points="530.993,-552.048 540.944,-548.412 530.897,-545.049 530.993,-552.048"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_mc~~CallsGraph_edge65" class="edge"><title>proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M297.436,-1143.96C303.594,-1141.13 310.061,-1138.04 316,-1135 343.025,-1121.16 372.988,-1103.91 394.316,-1091.29"/>
<polygon fill="#000000" stroke="#000000" points="396.375,-1094.13 403.18,-1086.01 392.796,-1088.12 396.375,-1094.13"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge66" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.705,-1164.78C363.72,-1171.8 442.501,-1175.17 496,-1138 543.048,-1105.32 561.308,-1035.28 567.786,-999.317"/>
<polygon fill="#000000" stroke="#000000" points="571.26,-999.766 569.437,-989.329 564.353,-998.625 571.26,-999.766"/>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge67" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.569,-821.39C363.107,-816.572 441.132,-816.013 496,-851 533.851,-875.136 555.143,-925.808 564.729,-955.005"/>
<polygon fill="#000000" stroke="#000000" points="561.431,-956.189 567.74,-964.701 568.117,-954.113 561.431,-956.189"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_mc~~CallsGraph_edge69" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M281.08,-497.964C295.657,-483.115 322.861,-458.65 352,-449 412.755,-428.88 434.783,-430.332 496,-449 555.425,-467.121 567.908,-483.232 612,-527 636.31,-551.131 657.378,-584.949 669.639,-606.668"/>
<polygon fill="#000000" stroke="#000000" points="666.736,-608.652 674.632,-615.717 672.865,-605.27 666.736,-608.652"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~npa_mc~~CallsGraph_edge68" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M303.199,-501.321C326.836,-495.141 358.696,-486.811 383.619,-480.296"/>
<polygon fill="#000000" stroke="#000000" points="384.696,-483.632 393.486,-477.716 382.926,-476.859 384.696,-483.632"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~npa_mc~~CallsGraph_edge70" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M303.199,-518.679C325.346,-524.47 354.714,-532.147 378.829,-538.452"/>
<polygon fill="#000000" stroke="#000000" points="378.247,-541.917 388.807,-541.061 380.017,-535.145 378.247,-541.917"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_mc~~CallsGraph_edge71" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M303.061,-505.495C348.962,-500.802 433.404,-497.914 496,-529 517.422,-539.638 513.193,-554.223 532,-569 533.542,-570.212 535.164,-571.39 536.834,-572.53"/>
<polygon fill="#000000" stroke="#000000" points="535.106,-575.577 545.446,-577.885 538.802,-569.632 535.106,-575.577"/>
</g>
<!-- proc~bb_cx_rates -->
<g id="proc~~npa_mc~~CallsGraph_node42" class="node"><title>proc~bb_cx_rates</title>
<g id="a_proc~~npa_mc~~CallsGraph_node42"><a xlink:href=".././proc/bb_cx_rates.html" xlink:title="bb_cx_rates">
<polygon fill="#d9534f" stroke="#d9534f" points="459.5,-402 388.5,-402 388.5,-378 459.5,-378 459.5,-402"/>
<text text-anchor="middle" x="424" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bb_cx_rates</text>
</a>
</g>
</g>
<!-- proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates -->
<g id="proc~~npa_mc~~CallsGraph_edge72" class="edge"><title>proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates</title>
<path fill="none" stroke="#000000" d="M312.619,-418.136C333.135,-412.907 357.726,-406.638 378.485,-401.347"/>
<polygon fill="#000000" stroke="#000000" points="379.507,-404.698 388.333,-398.837 377.778,-397.915 379.507,-404.698"/>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_mc~~CallsGraph_edge73" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M468.316,-356.698C477.87,-359.715 487.629,-363.719 496,-369 516.229,-381.761 513.193,-394.223 532,-409 533.542,-410.212 535.164,-411.39 536.834,-412.53"/>
<polygon fill="#000000" stroke="#000000" points="535.106,-415.577 545.446,-417.885 538.802,-409.632 535.106,-415.577"/>
</g>
<!-- dgetrs -->
<g id="proc~~npa_mc~~CallsGraph_node49" class="node"><title>dgetrs</title>
<polygon fill="#777777" stroke="#777777" points="599,-190 545,-190 545,-166 599,-166 599,-190"/>
<text text-anchor="middle" x="572" y="-175.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrs</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrs -->
<g id="proc~~npa_mc~~CallsGraph_edge76" class="edge"><title>proc~linsolve&#45;&gt;dgetrs</title>
<path fill="none" stroke="#000000" d="M451.234,-260.115C465.374,-257.105 482.616,-251.89 496,-243 517.047,-229.02 512.505,-215.074 532,-199 533.346,-197.89 534.76,-196.812 536.219,-195.769"/>
<polygon fill="#000000" stroke="#000000" points="538.381,-198.54 544.911,-190.197 534.604,-192.647 538.381,-198.54"/>
</g>
<!-- proc~matinv -->
<g id="proc~~npa_mc~~CallsGraph_node52" class="node"><title>proc~matinv</title>
<g id="a_proc~~npa_mc~~CallsGraph_node52"><a xlink:href=".././proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-106 545,-106 545,-82 599,-82 599,-106"/>
<text text-anchor="middle" x="572" y="-91.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~linsolve&#45;&gt;proc~matinv -->
<g id="proc~~npa_mc~~CallsGraph_edge74" class="edge"><title>proc~linsolve&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M451.138,-262.391C466.138,-260.125 484.263,-254.895 496,-243 537.506,-200.934 495.047,-161.118 532,-115 533.406,-113.245 535.001,-111.616 536.721,-110.109"/>
<polygon fill="#000000" stroke="#000000" points="538.798,-112.926 544.885,-104.255 534.719,-107.238 538.798,-112.926"/>
</g>
<!-- dgetrf -->
<g id="proc~~npa_mc~~CallsGraph_node53" class="node"><title>dgetrf</title>
<polygon fill="#777777" stroke="#777777" points="599,-148 545,-148 545,-124 599,-124 599,-148"/>
<text text-anchor="middle" x="572" y="-133.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrf</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrf -->
<g id="proc~~npa_mc~~CallsGraph_edge75" class="edge"><title>proc~linsolve&#45;&gt;dgetrf</title>
<path fill="none" stroke="#000000" d="M451.312,-261.738C466,-259.234 483.75,-253.984 496,-243 526.85,-215.338 504.163,-187.693 532,-157 533.356,-155.505 534.844,-154.095 536.423,-152.77"/>
<polygon fill="#000000" stroke="#000000" points="538.706,-155.443 544.88,-146.834 534.685,-149.714 538.706,-155.443"/>
</g>
<!-- proc~bb_cx_rates&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_mc~~CallsGraph_edge77" class="edge"><title>proc~bb_cx_rates&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M459.6,-399.479C478.659,-404.701 502.599,-411.26 523.397,-416.958"/>
<polygon fill="#000000" stroke="#000000" points="522.75,-420.41 533.32,-419.677 524.6,-413.659 522.75,-420.41"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_mc~~CallsGraph_edge79" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M597.402,-560.101C602.349,-562.84 607.432,-565.871 612,-569 629.443,-580.951 647.554,-596.579 660.841,-608.749"/>
<polygon fill="#000000" stroke="#000000" points="658.735,-611.57 668.443,-615.815 663.502,-606.443 658.735,-611.57"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~npa_mc~~CallsGraph_edge78" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M603.084,-537.136C614.411,-533.046 627.498,-528.32 639.674,-523.923"/>
<polygon fill="#000000" stroke="#000000" points="640.975,-527.175 649.192,-520.486 638.598,-520.591 640.975,-527.175"/>
</g>
<!-- proc~balback -->
<g id="proc~~npa_mc~~CallsGraph_node47" class="node"><title>proc~balback</title>
<g id="a_proc~~npa_mc~~CallsGraph_node47"><a xlink:href=".././proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-358 545,-358 545,-334 599,-334 599,-358"/>
<text text-anchor="middle" x="572" y="-343.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~npa_mc~~CallsGraph_edge80" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M451.102,-313.151C474.418,-319.539 508.802,-328.96 534.778,-336.076"/>
<polygon fill="#000000" stroke="#000000" points="534.062,-339.509 544.632,-338.776 535.912,-332.758 534.062,-339.509"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~npa_mc~~CallsGraph_node48" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~npa_mc~~CallsGraph_node48"><a xlink:href=".././proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-274 545,-274 545,-250 599,-250 599,-274"/>
<text text-anchor="middle" x="572" y="-259.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~npa_mc~~CallsGraph_edge81" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M451.319,-298.284C464.707,-294.341 481.23,-289.449 496,-285 508.862,-281.126 522.947,-276.823 535.402,-272.996"/>
<polygon fill="#000000" stroke="#000000" points="536.459,-276.333 544.987,-270.047 534.4,-269.643 536.459,-276.333"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~npa_mc~~CallsGraph_node50" class="node"><title>proc~elmhes</title>
<g id="a_proc~~npa_mc~~CallsGraph_node50"><a xlink:href=".././proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-316 545,-316 545,-292 599,-292 599,-316"/>
<text text-anchor="middle" x="572" y="-301.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~npa_mc~~CallsGraph_edge82" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M451.102,-305.642C474.314,-305.324 508.498,-304.856 534.432,-304.501"/>
<polygon fill="#000000" stroke="#000000" points="534.681,-307.998 544.632,-304.361 534.585,-300.999 534.681,-307.998"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~npa_mc~~CallsGraph_node51" class="node"><title>proc~hqr2</title>
<g id="a_proc~~npa_mc~~CallsGraph_node51"><a xlink:href=".././proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-400 545,-400 545,-376 599,-376 599,-400"/>
<text text-anchor="middle" x="572" y="-385.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~npa_mc~~CallsGraph_edge83" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M451.072,-310.135C465.164,-313.219 482.41,-318.427 496,-327 516.229,-339.761 513.193,-352.223 532,-367 533.542,-368.212 535.164,-369.39 536.834,-370.53"/>
<polygon fill="#000000" stroke="#000000" points="535.106,-373.577 545.446,-375.885 538.802,-367.632 535.106,-373.577"/>
</g>
<!-- proc~balance -->
<g id="proc~~npa_mc~~CallsGraph_node54" class="node"><title>proc~balance</title>
<g id="a_proc~~npa_mc~~CallsGraph_node54"><a xlink:href=".././proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-232 545,-232 545,-208 599,-208 599,-232"/>
<text text-anchor="middle" x="572" y="-217.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~npa_mc~~CallsGraph_edge84" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M451.234,-302.115C465.374,-299.105 482.616,-293.89 496,-285 517.047,-271.02 512.505,-257.074 532,-241 533.346,-239.89 534.76,-238.812 536.219,-237.769"/>
<polygon fill="#000000" stroke="#000000" points="538.381,-240.54 544.911,-232.197 534.604,-234.647 538.381,-240.54"/>
</g>
<!-- proc~rswap -->
<g id="proc~~npa_mc~~CallsGraph_node56" class="node"><title>proc~rswap</title>
<g id="a_proc~~npa_mc~~CallsGraph_node56"><a xlink:href=".././proc/rswap.html" xlink:title="RSWAP">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-316 655,-316 655,-292 709,-292 709,-316"/>
<text text-anchor="middle" x="682" y="-301.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RSWAP</text>
</a>
</g>
</g>
<!-- proc~balback&#45;&gt;proc~rswap -->
<g id="proc~~npa_mc~~CallsGraph_edge85" class="edge"><title>proc~balback&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M599.144,-335.833C612.971,-330.456 630.153,-323.774 645.2,-317.922"/>
<polygon fill="#000000" stroke="#000000" points="646.671,-321.106 654.723,-314.219 644.134,-314.581 646.671,-321.106"/>
</g>
<!-- proc~elmhes&#45;&gt;proc~rswap -->
<g id="proc~~npa_mc~~CallsGraph_edge86" class="edge"><title>proc~elmhes&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M599.144,-304C612.707,-304 629.499,-304 644.338,-304"/>
<polygon fill="#000000" stroke="#000000" points="644.723,-307.5 654.723,-304 644.723,-300.5 644.723,-307.5"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~npa_mc~~CallsGraph_node55" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~npa_mc~~CallsGraph_node55"><a xlink:href=".././proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-400 655,-400 655,-376 709,-376 709,-400"/>
<text text-anchor="middle" x="682" y="-385.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~npa_mc~~CallsGraph_edge87" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M599.144,-388C612.707,-388 629.499,-388 644.338,-388"/>
<polygon fill="#000000" stroke="#000000" points="644.723,-391.5 654.723,-388 644.723,-384.5 644.723,-391.5"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~npa_mc~~CallsGraph_node57" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~npa_mc~~CallsGraph_node57"><a xlink:href=".././proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-127 655,-127 655,-103 709,-103 709,-127"/>
<text text-anchor="middle" x="682" y="-112.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~npa_mc~~CallsGraph_edge88" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M599.144,-99.0835C612.839,-101.746 629.826,-105.049 644.769,-107.955"/>
<polygon fill="#000000" stroke="#000000" points="644.238,-111.417 654.723,-109.891 645.575,-104.546 644.238,-111.417"/>
</g>
<!-- proc~lubksb -->
<g id="proc~~npa_mc~~CallsGraph_node58" class="node"><title>proc~lubksb</title>
<g id="a_proc~~npa_mc~~CallsGraph_node58"><a xlink:href=".././proc/lubksb.html" xlink:title="lubksb">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-85 655,-85 655,-61 709,-61 709,-85"/>
<text text-anchor="middle" x="682" y="-70.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lubksb</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~lubksb -->
<g id="proc~~npa_mc~~CallsGraph_edge89" class="edge"><title>proc~matinv&#45;&gt;proc~lubksb</title>
<path fill="none" stroke="#000000" d="M599.144,-88.9165C612.839,-86.2536 629.826,-82.9506 644.769,-80.0449"/>
<polygon fill="#000000" stroke="#000000" points="645.575,-83.4539 654.723,-78.1095 644.238,-76.5826 645.575,-83.4539"/>
</g>
<!-- proc~balance&#45;&gt;proc~rswap -->
<g id="proc~~npa_mc~~CallsGraph_edge90" class="edge"><title>proc~balance&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M597.893,-232.216C602.704,-234.904 607.609,-237.886 612,-241 630.36,-254.023 649.089,-271.438 662.393,-284.658"/>
<polygon fill="#000000" stroke="#000000" points="660.032,-287.248 669.556,-291.892 665.007,-282.323 660.032,-287.248"/>
</g>
<!-- proc~comdiv -->
<g id="proc~~npa_mc~~CallsGraph_node60" class="node"><title>proc~comdiv</title>
<g id="a_proc~~npa_mc~~CallsGraph_node60"><a xlink:href=".././proc/comdiv.html" xlink:title="Comdiv">
<polygon fill="#d9534f" stroke="#d9534f" points="809,-400 755,-400 755,-376 809,-376 809,-400"/>
<text text-anchor="middle" x="782" y="-385.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Comdiv</text>
</a>
</g>
</g>
<!-- proc~hqrvec&#45;&gt;proc~comdiv -->
<g id="proc~~npa_mc~~CallsGraph_edge91" class="edge"><title>proc~hqrvec&#45;&gt;proc~comdiv</title>
<path fill="none" stroke="#000000" d="M709.005,-388C719.969,-388 732.92,-388 744.794,-388"/>
<polygon fill="#000000" stroke="#000000" points="744.874,-391.5 754.874,-388 744.874,-384.5 744.874,-391.5"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~npa_mc~~CallsGraph_node59" class="node"><title>proc~outerprod</title>
<g id="a_proc~~npa_mc~~CallsGraph_node59"><a xlink:href=".././proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="811.5,-148 752.5,-148 752.5,-124 811.5,-124 811.5,-148"/>
<text text-anchor="middle" x="782" y="-133.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~npa_mc~~CallsGraph_edge92" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M709.005,-120.572C719.251,-122.768 731.231,-125.335 742.446,-127.739"/>
<polygon fill="#000000" stroke="#000000" points="741.947,-131.211 752.459,-129.884 743.414,-124.366 741.947,-131.211"/>
</g>
<!-- proc~swap -->
<g id="proc~~npa_mc~~CallsGraph_node61" class="node"><title>proc~swap</title>
<g id="a_proc~~npa_mc~~CallsGraph_node61"><a xlink:href=".././proc/swap.html" xlink:title="swap">
<polygon fill="#d9534f" stroke="#d9534f" points="809,-106 755,-106 755,-82 809,-82 809,-106"/>
<text text-anchor="middle" x="782" y="-91.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swap</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~swap -->
<g id="proc~~npa_mc~~CallsGraph_edge93" class="edge"><title>proc~ludcmp&#45;&gt;proc~swap</title>
<path fill="none" stroke="#000000" d="M709.005,-109.428C719.969,-107.078 732.92,-104.303 744.794,-101.758"/>
<polygon fill="#000000" stroke="#000000" points="745.829,-105.116 754.874,-99.5985 744.362,-98.2716 745.829,-105.116"/>
</g>
</g>
</svg>
</div><script>var panprocnpa_mcCallsGraph = svgPanZoom('#procnpa_mcCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~npa_mc~~CalledByGraph Pages: 1 -->
<svg id="procnpa_mcCalledByGraph" width="152pt" height="32pt"
 viewBox="0.00 0.00 152.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~npa_mc~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~npa_mc~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 148,-28 148,4 -4,4"/>
<!-- proc~npa_mc -->
<g id="proc~~npa_mc~~CalledByGraph_node1" class="node"><title>proc~npa_mc</title>
<polygon fill="none" stroke="black" points="144,-24 90,-24 90,-0 144,-0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">npa_mc</text>
</g>
<!-- program~fidasim -->
<g id="proc~~npa_mc~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~npa_mc~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_mc -->
<g id="proc~~npa_mc~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~npa_mc</title>
<path fill="none" stroke="#000000" d="M54.4029,-12C62.3932,-12 71.3106,-12 79.8241,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.919,-15.5001 89.919,-12 79.919,-8.5001 79.919,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/npa_mc.html#src">npa_mc</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">npa_mc</span><span class="w"></span>
<span class="w">    </span><span class="c">!+ Calculate Active NPA flux using a Monte Carlo fast-ion distribution</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iion</span><span class="p">,</span><span class="n">igamma</span><span class="p">,</span><span class="n">ngamma</span><span class="p">,</span><span class="n">npart</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">FastIon</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fast_ion</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">phi</span><span class="p">,</span><span class="n">theta</span><span class="p">,</span><span class="n">dtheta</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">rf</span><span class="p">,</span><span class="w"> </span><span class="n">rg</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">det</span><span class="p">,</span><span class="n">ichan</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">nrange</span><span class="p">,</span><span class="n">it</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fields</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">GyroSurface</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">gs</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rates</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">states</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">flux</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">neut_types</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ind</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">uvw</span><span class="p">,</span><span class="w"> </span><span class="n">uvw_vi</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">gyrange</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="n">c</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">randomu</span><span class="w"></span>

<span class="w">    </span><span class="n">ngamma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">.</span><span class="nb">or</span><span class="p">.(</span><span class="n">inputs</span><span class="p">%</span><span class="n">dist_type</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">ngamma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ceiling</span><span class="p">(</span><span class="nb">dble</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_npa</span><span class="p">)</span><span class="o">/</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">    if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i10)&#39;</span><span class="p">)</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="o">*</span><span class="n">ngamma</span><span class="p">,</span><span class="n">Int64</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span><span class="w"></span>

<span class="w">    </span><span class="c">!$OMP PARALLEL DO schedule(guided) private(iion,igamma,ind,fast_ion,vi,ri,rf,phi,s,c,ir,it, &amp;</span>
<span class="w">    </span><span class="c">!$OMP&amp; randomu,rg,fields,uvw,uvw_vi,rates,states,flux,det,ichan,gs,nrange,gyrange,theta,dtheta)</span>
<span class="w">    </span><span class="n">loop_over_fast_ions</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">iion</span><span class="o">=</span><span class="n">istart</span><span class="p">,</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="p">,</span><span class="n">istep</span><span class="w"></span>
<span class="w">        </span><span class="n">fast_ion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">particles</span><span class="p">%</span><span class="n">fast_ion</span><span class="p">(</span><span class="n">iion</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vabs</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">loop_over_fast_ions</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">beam_grid_cross_grid</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">loop_over_fast_ions</span><span class="w"></span>
<span class="w">        </span><span class="n">gamma_loop</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">igamma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ngamma</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">                </span><span class="c">!! Pick random toroidal angle</span>
<span class="w">                </span><span class="k">call </span><span class="n">randu</span><span class="p">(</span><span class="n">randomu</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="n">phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">beam_grid_phi_enter</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">delta_phi</span><span class="o">*</span><span class="n">randomu</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">else</span>
<span class="k">                </span><span class="n">phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">phi</span><span class="w"></span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">            </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="c">!! Calculate position in machine coordinates</span>
<span class="w">            </span><span class="n">uvw</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">c</span><span class="w"></span>
<span class="w">            </span><span class="n">uvw</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">s</span><span class="w"></span>
<span class="w">            </span><span class="n">uvw</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">z</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">dist_type</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">                </span><span class="c">!! Convert to beam grid coordinates</span>
<span class="w">                </span><span class="k">call </span><span class="n">uvw_to_xyz</span><span class="p">(</span><span class="n">uvw</span><span class="p">,</span><span class="w"> </span><span class="n">rg</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Get electomagnetic fields</span>
<span class="w">                </span><span class="k">call </span><span class="n">get_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="o">=</span><span class="n">rg</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Correct for gyro motion and get position and velocity</span>
<span class="w">                </span><span class="k">call </span><span class="n">gyro_surface</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">energy</span><span class="p">,</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">pitch</span><span class="p">,</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">gs</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="n">detector_loop</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">ichan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">npa_chords</span><span class="p">%</span><span class="n">nchan</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">npa_gyro_range</span><span class="p">(</span><span class="n">ichan</span><span class="p">,</span><span class="w"> </span><span class="n">gs</span><span class="p">,</span><span class="w"> </span><span class="n">gyrange</span><span class="p">,</span><span class="w"> </span><span class="n">nrange</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="n">nrange</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">detector_loop</span><span class="w"></span>

<span class="w">                    </span><span class="n">gyro_range_loop</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">ir</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nrange</span><span class="w"></span>
<span class="w">                        </span><span class="n">dtheta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gyrange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="n">theta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gyrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="n">dtheta</span><span class="w"></span>
<span class="w">                        </span><span class="k">call </span><span class="n">gyro_trajectory</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span><span class="w"> </span><span class="n">theta</span><span class="p">,</span><span class="w"> </span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="p">)</span><span class="w"></span>

<span class="w">                        </span><span class="c">!! Check if particle hits a NPA detector</span>
<span class="w">                        </span><span class="k">call </span><span class="n">hit_npa_detector</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="w"> </span><span class="p">,</span><span class="n">det</span><span class="p">,</span><span class="w"> </span><span class="n">rf</span><span class="p">,</span><span class="w"> </span><span class="n">det</span><span class="o">=</span><span class="n">ichan</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">if</span><span class="p">(</span><span class="n">det</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">ichan</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                            if</span><span class="w"> </span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="k">                                write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;NPA_MC: Missed Detector &quot;</span><span class="p">,</span><span class="n">ichan</span><span class="w"></span>
<span class="w">                            </span><span class="k">endif</span>
<span class="k">                            cycle </span><span class="n">gyro_range_loop</span><span class="w"></span>
<span class="w">                        </span><span class="k">endif</span><span class="w"></span>

<span class="w">                        </span><span class="c">!! Get beam grid indices at ri</span>
<span class="w">                        </span><span class="k">call </span><span class="n">get_indices</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span><span class="w"></span>

<span class="w">                        </span><span class="c">!! Calculate CX probability with beam and halo neutrals</span>
<span class="w">                        </span><span class="k">call </span><span class="n">get_total_cx_rate</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="w"> </span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="p">,</span><span class="w"> </span><span class="n">neut_types</span><span class="p">,</span><span class="w"> </span><span class="n">rates</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">gyro_range_loop</span><span class="w"></span>

<span class="w">                        </span><span class="c">!! Weight CX rates by ion source density</span>
<span class="w">                        </span><span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">weight</span><span class="o">*</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">delta_phi</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">/</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="o">/</span><span class="n">ngamma</span><span class="w"></span>

<span class="w">                        </span><span class="c">!! Attenuate states as the particle move through plasma</span>
<span class="w">                        </span><span class="k">call </span><span class="n">attenuate</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">states</span><span class="p">)</span><span class="w"></span>

<span class="w">                        </span><span class="c">!! Store NPA Flux</span>
<span class="w">                        </span><span class="n">flux</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dtheta</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="o">*</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="w"></span>
<span class="w">                        </span><span class="n">spread_loop</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">it</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">25</span><span class="w"></span>
<span class="w">                            </span><span class="n">theta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gyrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">it</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">dtheta</span><span class="o">/</span><span class="mi">25</span><span class="w"></span>
<span class="w">                            </span><span class="k">call </span><span class="n">gyro_trajectory</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span><span class="w"> </span><span class="n">theta</span><span class="p">,</span><span class="w"> </span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="p">)</span><span class="w"></span>
<span class="w">                            </span><span class="k">call </span><span class="n">hit_npa_detector</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="w"> </span><span class="p">,</span><span class="n">det</span><span class="p">,</span><span class="w"> </span><span class="n">rf</span><span class="p">,</span><span class="w"> </span><span class="n">det</span><span class="o">=</span><span class="n">ichan</span><span class="p">)</span><span class="w"></span>
<span class="w">                            </span><span class="k">if</span><span class="p">(</span><span class="n">det</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">ichan</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                if</span><span class="w"> </span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="k">                                    write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;NPA_MC: Missed Detector &quot;</span><span class="p">,</span><span class="n">ichan</span><span class="w"></span>
<span class="w">                                </span><span class="k">endif</span>
<span class="k">                                cycle </span><span class="n">spread_loop</span><span class="w"></span>
<span class="w">                            </span><span class="k">endif</span>
<span class="k">                            call </span><span class="n">store_npa</span><span class="p">(</span><span class="n">det</span><span class="p">,</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">flux</span><span class="o">/</span><span class="mi">25</span><span class="p">,</span><span class="n">fast_ion</span><span class="p">%</span><span class="k">class</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">enddo </span><span class="n">spread_loop</span><span class="w"></span>
<span class="w">                    </span><span class="k">enddo </span><span class="n">gyro_range_loop</span><span class="w"></span>
<span class="w">                </span><span class="k">enddo </span><span class="n">detector_loop</span><span class="w"></span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="c">!! Full Orbit</span>
<span class="w">                </span><span class="c">!! Convert to beam grid coordinates</span>
<span class="w">                </span><span class="k">call </span><span class="n">uvw_to_xyz</span><span class="p">(</span><span class="n">uvw</span><span class="p">,</span><span class="w"> </span><span class="n">ri</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Calculate velocity vector</span>
<span class="w">                </span><span class="n">uvw_vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vt</span><span class="w"></span>
<span class="w">                </span><span class="n">uvw_vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vt</span><span class="w"></span>
<span class="w">                </span><span class="n">uvw_vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vz</span><span class="w"></span>
<span class="w">                </span><span class="n">vi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">matmul</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">inv_basis</span><span class="p">,</span><span class="n">uvw_vi</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Check if particle hits a NPA detector</span>
<span class="w">                </span><span class="k">call </span><span class="n">hit_npa_detector</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="w"> </span><span class="p">,</span><span class="n">det</span><span class="p">,</span><span class="w"> </span><span class="n">rf</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="n">det</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">gamma_loop</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Get beam grid indices at ri</span>
<span class="w">                </span><span class="k">call </span><span class="n">get_indices</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Calculate CX probability with beam and halo neutrals</span>
<span class="w">                </span><span class="k">call </span><span class="n">get_total_cx_rate</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="w"> </span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="p">,</span><span class="w"> </span><span class="n">neut_types</span><span class="p">,</span><span class="w"> </span><span class="n">rates</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">gamma_loop</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Weight CX rates by ion source density</span>
<span class="w">                </span><span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">weight</span><span class="o">*</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">delta_phi</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">/</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="o">/</span><span class="n">ngamma</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Attenuate states as the particle moves though plasma</span>
<span class="w">                </span><span class="k">call </span><span class="n">attenuate</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">states</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Store NPA Flux</span>
<span class="w">                </span><span class="n">flux</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="o">*</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="w"></span>
<span class="w">                </span><span class="k">call </span><span class="n">store_npa</span><span class="p">(</span><span class="n">det</span><span class="p">,</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">flux</span><span class="p">,</span><span class="n">fast_ion</span><span class="p">%</span><span class="k">class</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">        enddo </span><span class="n">gamma_loop</span><span class="w"></span>
<span class="w">    </span><span class="k">enddo </span><span class="n">loop_over_fast_ions</span><span class="w"></span>
<span class="w">    </span><span class="c">!$OMP END PARALLEL DO</span>

<span class="w">    </span><span class="n">npart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">npa</span><span class="p">%</span><span class="n">npart</span><span class="w"></span>
<span class="cp">#ifdef _MPI</span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">npart</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">npa</span><span class="p">%</span><span class="n">flux</span><span class="p">)</span><span class="w"></span>
<span class="cp">#endif</span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T4,&quot;Number of Active NPA particles that hit a detector: &quot;,i8)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">npart</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">end subroutine </span><span class="n">npa_mc</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>