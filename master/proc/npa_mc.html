<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="">
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>npa_mc &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>User Guide</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>npa_mc
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.7% of total for procedures.">103 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
     <li><a href='../module/libfida.html'>libfida</a></li>
     <li class="active">npa_mc</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/npa_mc.html#src">npa_mc</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public subroutine npa_mc()</h2>
    

    <p>Calculate Active NPA flux using a Monte Carlo fast-ion distribution</p>

    <h3>Arguments</h3>
    <em>None</em>
    <br>
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~npa_mc~~CallsGraph Pages: 1 -->
<svg id="procnpa_mcCallsGraph" width="641pt" height="913pt"
 viewBox="0.00 0.00 641.00 913.05" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~npa_mc~~CallsGraph" class="graph" transform="scale(0.781707 0.781707) rotate(0) translate(4 1164.02)">
<title>proc~~npa_mc~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1164.02 816,-1164.02 816,4 -4,4"/>
<!-- proc~npa_mc -->
<g id="proc~~npa_mc~~CallsGraph_node1" class="node"><title>proc~npa_mc</title>
<polygon fill="none" stroke="black" points="54,-389 0,-389 0,-365 54,-365 54,-389"/>
<text text-anchor="middle" x="27" y="-374.6" font-family="Helvetica,sans-Serif" font-size="10.50">npa_mc</text>
</g>
<!-- proc~gyro_surface -->
<g id="proc~~npa_mc~~CallsGraph_node2" class="node"><title>proc~gyro_surface</title>
<g id="a_proc~~npa_mc~~CallsGraph_node2"><a xlink:href=".././proc/gyro_surface.html" xlink:title="gyro_surface">
<polygon fill="#d9534f" stroke="#d9534f" points="175.5,-974 100.5,-974 100.5,-950 175.5,-950 175.5,-974"/>
<text text-anchor="middle" x="138" y="-959.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_surface</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~gyro_surface -->
<g id="proc~~npa_mc~~CallsGraph_edge1" class="edge"><title>proc~npa_mc&#45;&gt;proc~gyro_surface</title>
<path fill="none" stroke="#000000" d="M27.7405,-389.455C26.4255,-463.822 22.9659,-849.07 90,-941 90.7701,-942.056 91.6056,-943.06 92.4965,-944.014"/>
<polygon fill="#000000" stroke="#000000" points="90.303,-946.742 100.246,-950.401 94.7548,-941.34 90.303,-946.742"/>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~npa_mc~~CallsGraph_node3" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~npa_mc~~CallsGraph_node3"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="174.5,-932 101.5,-932 101.5,-908 174.5,-908 174.5,-932"/>
<text text-anchor="middle" x="138" y="-917.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;interface~parallel_sum -->
<g id="proc~~npa_mc~~CallsGraph_edge2" class="edge"><title>proc~npa_mc&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M30.4294,-389.103C44.3748,-458.573 114.262,-806.727 132.592,-898.041"/>
<polygon fill="#000000" stroke="#000000" points="129.165,-898.753 134.565,-907.868 136.028,-897.375 129.165,-898.753"/>
</g>
<!-- proc~npa_gyro_range -->
<g id="proc~~npa_mc~~CallsGraph_node4" class="node"><title>proc~npa_gyro_range</title>
<g id="a_proc~~npa_mc~~CallsGraph_node4"><a xlink:href=".././proc/npa_gyro_range.html" xlink:title="npa_gyro_range">
<polygon fill="#d9534f" stroke="#d9534f" points="183.5,-621 92.5,-621 92.5,-597 183.5,-597 183.5,-621"/>
<text text-anchor="middle" x="138" y="-606.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_gyro_range</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~npa_gyro_range -->
<g id="proc~~npa_mc~~CallsGraph_edge4" class="edge"><title>proc~npa_mc&#45;&gt;proc~npa_gyro_range</title>
<path fill="none" stroke="#000000" d="M33.7068,-389.147C51.2917,-426.575 104.802,-540.47 127.091,-587.91"/>
<polygon fill="#000000" stroke="#000000" points="123.929,-589.411 131.35,-596.974 130.265,-586.434 123.929,-589.411"/>
</g>
<!-- proc~get_indices -->
<g id="proc~~npa_mc~~CallsGraph_node5" class="node"><title>proc~get_indices</title>
<g id="a_proc~~npa_mc~~CallsGraph_node5"><a xlink:href=".././proc/get_indices.html" xlink:title="get_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="171.5,-490 104.5,-490 104.5,-466 171.5,-466 171.5,-490"/>
<text text-anchor="middle" x="138" y="-475.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_indices</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~get_indices -->
<g id="proc~~npa_mc~~CallsGraph_edge5" class="edge"><title>proc~npa_mc&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M35.86,-389.104C46.63,-405.006 67.2486,-433.121 90,-452 93.7495,-455.111 97.9264,-458.036 102.2,-460.72"/>
<polygon fill="#000000" stroke="#000000" points="100.604,-463.841 111.002,-465.875 104.142,-457.801 100.604,-463.841"/>
</g>
<!-- proc~attenuate -->
<g id="proc~~npa_mc~~CallsGraph_node6" class="node"><title>proc~attenuate</title>
<g id="a_proc~~npa_mc~~CallsGraph_node6"><a xlink:href=".././proc/attenuate.html" xlink:title="attenuate">
<polygon fill="#d9534f" stroke="#d9534f" points="167,-326 109,-326 109,-302 167,-302 167,-326"/>
<text text-anchor="middle" x="138" y="-311.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">attenuate</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~attenuate -->
<g id="proc~~npa_mc~~CallsGraph_edge6" class="edge"><title>proc~npa_mc&#45;&gt;proc~attenuate</title>
<path fill="none" stroke="#000000" d="M44.0798,-364.959C56.3125,-356.086 73.7544,-344.04 90,-335 93.0603,-333.297 96.285,-331.623 99.5521,-330.01"/>
<polygon fill="#000000" stroke="#000000" points="101.228,-333.089 108.77,-325.648 98.2341,-326.761 101.228,-333.089"/>
</g>
<!-- proc~gyro_trajectory -->
<g id="proc~~npa_mc~~CallsGraph_node7" class="node"><title>proc~gyro_trajectory</title>
<g id="a_proc~~npa_mc~~CallsGraph_node7"><a xlink:href=".././proc/gyro_trajectory.html" xlink:title="gyro_trajectory">
<polygon fill="#d9534f" stroke="#d9534f" points="180,-410 96,-410 96,-386 180,-386 180,-410"/>
<text text-anchor="middle" x="138" y="-395.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_trajectory</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~gyro_trajectory -->
<g id="proc~~npa_mc~~CallsGraph_edge7" class="edge"><title>proc~npa_mc&#45;&gt;proc~gyro_trajectory</title>
<path fill="none" stroke="#000000" d="M54.1082,-382.03C63.6559,-383.869 74.8164,-386.02 85.7977,-388.135"/>
<polygon fill="#000000" stroke="#000000" points="85.2993,-391.604 95.7808,-390.059 86.6236,-384.73 85.2993,-391.604"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~npa_mc~~CallsGraph_node8" class="node"><title>proc~get_fields</title>
<g id="a_proc~~npa_mc~~CallsGraph_node8"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="298,-246 240,-246 240,-222 298,-222 298,-246"/>
<text text-anchor="middle" x="269" y="-231.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~get_fields -->
<g id="proc~~npa_mc~~CallsGraph_edge11" class="edge"><title>proc~npa_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M33.8527,-364.856C43.225,-346.654 63.2961,-312.369 90,-293 112.602,-276.606 184.827,-255.694 230.031,-243.678"/>
<polygon fill="#000000" stroke="#000000" points="231.01,-247.039 239.79,-241.11 229.228,-240.27 231.01,-247.039"/>
</g>
<!-- proc~get_total_cx_rate -->
<g id="proc~~npa_mc~~CallsGraph_node9" class="node"><title>proc~get_total_cx_rate</title>
<g id="a_proc~~npa_mc~~CallsGraph_node9"><a xlink:href=".././proc/get_total_cx_rate.html" xlink:title="get_total_cx_rate">
<polygon fill="#d9534f" stroke="#d9534f" points="185.5,-368 90.5,-368 90.5,-344 185.5,-344 185.5,-368"/>
<text text-anchor="middle" x="138" y="-353.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_total_cx_rate</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~get_total_cx_rate -->
<g id="proc~~npa_mc~~CallsGraph_edge8" class="edge"><title>proc~npa_mc&#45;&gt;proc~get_total_cx_rate</title>
<path fill="none" stroke="#000000" d="M54.1082,-371.97C62.0636,-370.437 71.1388,-368.689 80.297,-366.924"/>
<polygon fill="#000000" stroke="#000000" points="81.061,-370.342 90.2183,-365.013 79.7367,-363.468 81.061,-370.342"/>
</g>
<!-- proc~hit_npa_detector -->
<g id="proc~~npa_mc~~CallsGraph_node10" class="node"><title>proc~hit_npa_detector</title>
<g id="a_proc~~npa_mc~~CallsGraph_node10"><a xlink:href=".././proc/hit_npa_detector.html" xlink:title="hit_npa_detector">
<polygon fill="#d9534f" stroke="#d9534f" points="315.5,-537 222.5,-537 222.5,-513 315.5,-513 315.5,-537"/>
<text text-anchor="middle" x="269" y="-522.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hit_npa_detector</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~hit_npa_detector -->
<g id="proc~~npa_mc~~CallsGraph_edge9" class="edge"><title>proc~npa_mc&#45;&gt;proc~hit_npa_detector</title>
<path fill="none" stroke="#000000" d="M43.7131,-389.06C55.8994,-398.057 73.4476,-410.253 90,-419 130.571,-440.44 146.515,-433.62 186,-457 209.173,-470.722 232.515,-490.835 248.336,-505.628"/>
<polygon fill="#000000" stroke="#000000" points="246.228,-508.454 255.883,-512.818 251.056,-503.386 246.228,-508.454"/>
</g>
<!-- proc~store_npa -->
<g id="proc~~npa_mc~~CallsGraph_node11" class="node"><title>proc~store_npa</title>
<g id="a_proc~~npa_mc~~CallsGraph_node11"><a xlink:href=".././proc/store_npa.html" xlink:title="store_npa">
<polygon fill="#d9534f" stroke="#d9534f" points="168.5,-246 107.5,-246 107.5,-222 168.5,-222 168.5,-246"/>
<text text-anchor="middle" x="138" y="-231.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_npa</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~store_npa -->
<g id="proc~~npa_mc~~CallsGraph_edge10" class="edge"><title>proc~npa_mc&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M31.768,-364.981C39.4592,-342.079 58.9112,-291.653 90,-260 93.0139,-256.931 96.4675,-254.124 100.105,-251.585"/>
<polygon fill="#000000" stroke="#000000" points="102.18,-254.415 108.803,-246.145 98.4687,-248.48 102.18,-254.415"/>
</g>
<!-- interface~randu -->
<g id="proc~~npa_mc~~CallsGraph_node12" class="node"><title>interface~randu</title>
<g id="a_proc~~npa_mc~~CallsGraph_node12"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="165,-204 111,-204 111,-180 165,-180 165,-204"/>
<text text-anchor="middle" x="138" y="-189.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;interface~randu -->
<g id="proc~~npa_mc~~CallsGraph_edge3" class="edge"><title>proc~npa_mc&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M29.4211,-364.603C33.4621,-334.738 47.6094,-257.957 90,-213 93.3492,-209.448 97.409,-206.456 101.724,-203.946"/>
<polygon fill="#000000" stroke="#000000" points="103.389,-207.027 110.792,-199.448 100.278,-200.756 103.389,-207.027"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~npa_mc~~CallsGraph_node13" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~npa_mc~~CallsGraph_node13"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="716,-149 648,-149 648,-125 716,-125 716,-149"/>
<text text-anchor="middle" x="682" y="-134.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_mc~~CallsGraph_edge12" class="edge"><title>proc~npa_mc&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M29.5759,-364.884C38.7034,-300.354 90.71,-0 268,-0 268,-0 268,-0 425,-0 523.769,-0 621.313,-80.2557 661.648,-117.915"/>
<polygon fill="#000000" stroke="#000000" points="659.276,-120.489 668.935,-124.842 664.099,-115.416 659.276,-120.489"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~npa_mc~~CallsGraph_node14" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~npa_mc~~CallsGraph_node14"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-872 225,-872 225,-848 313,-848 313,-872"/>
<text text-anchor="middle" x="269" y="-857.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~npa_mc~~CallsGraph_edge13" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M165.105,-907.858C184.601,-898.79 211.455,-886.3 232.841,-876.353"/>
<polygon fill="#000000" stroke="#000000" points="234.343,-879.515 241.934,-872.124 231.39,-873.168 234.343,-879.515"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~npa_mc~~CallsGraph_node16" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~npa_mc~~CallsGraph_node16"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-994 223.5,-994 223.5,-970 314.5,-970 314.5,-994"/>
<text text-anchor="middle" x="269" y="-979.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~npa_mc~~CallsGraph_edge18" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M167.022,-932.041C173.314,-934.878 179.925,-937.962 186,-941 202.371,-949.186 205.662,-952.749 222,-961 225.071,-962.551 228.279,-964.119 231.512,-965.663"/>
<polygon fill="#000000" stroke="#000000" points="230.048,-968.842 240.588,-969.915 233.017,-962.503 230.048,-968.842"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~npa_mc~~CallsGraph_node19" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~npa_mc~~CallsGraph_node19"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1158 223.5,-1158 223.5,-1134 314.5,-1134 314.5,-1158"/>
<text text-anchor="middle" x="269" y="-1143.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~npa_mc~~CallsGraph_edge22" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.532,-931.253C178.883,-933.875 182.885,-937.083 186,-941 237.87,-1006.22 170.393,-1059.58 222,-1125 222.595,-1125.75 223.222,-1126.48 223.88,-1127.18"/>
<polygon fill="#000000" stroke="#000000" points="221.923,-1130.11 231.86,-1133.79 226.385,-1124.71 221.923,-1130.11"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~npa_mc~~CallsGraph_node20" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~npa_mc~~CallsGraph_node20"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-787 225,-787 225,-763 313,-763 313,-787"/>
<text text-anchor="middle" x="269" y="-772.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~npa_mc~~CallsGraph_edge14" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M144.412,-907.965C155.713,-884.001 183.958,-829.807 222,-797 223.936,-795.331 226.02,-793.758 228.195,-792.281"/>
<polygon fill="#000000" stroke="#000000" points="230.128,-795.203 236.908,-787.062 226.531,-789.198 230.128,-795.203"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~npa_mc~~CallsGraph_node22" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~npa_mc~~CallsGraph_node22"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1116 223.5,-1116 223.5,-1092 314.5,-1092 314.5,-1116"/>
<text text-anchor="middle" x="269" y="-1101.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~npa_mc~~CallsGraph_edge16" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.775,-931.718C178.98,-934.259 182.877,-937.321 186,-941 226.739,-988.998 183.567,-1028.14 222,-1078 224.321,-1081.01 227.095,-1083.73 230.116,-1086.17"/>
<polygon fill="#000000" stroke="#000000" points="228.327,-1089.19 238.544,-1091.99 232.306,-1083.43 228.327,-1089.19"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~npa_mc~~CallsGraph_node24" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~npa_mc~~CallsGraph_node24"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-952 225,-952 225,-928 313,-928 313,-952"/>
<text text-anchor="middle" x="269" y="-937.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~npa_mc~~CallsGraph_edge19" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.591,-925.518C186.952,-927.434 201.1,-929.628 214.581,-931.718"/>
<polygon fill="#000000" stroke="#000000" points="214.301,-935.216 224.72,-933.29 215.374,-928.299 214.301,-935.216"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~npa_mc~~CallsGraph_node25" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~npa_mc~~CallsGraph_node25"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-903 380,-903 380,-879 468,-879 468,-903"/>
<text text-anchor="middle" x="424" y="-888.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~npa_mc~~CallsGraph_edge21" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.681,-916.356C223.768,-911.344 312.516,-902.282 369.549,-896.458"/>
<polygon fill="#000000" stroke="#000000" points="370.22,-899.908 379.812,-895.41 369.508,-892.944 370.22,-899.908"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~npa_mc~~CallsGraph_node27" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~npa_mc~~CallsGraph_node27"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="469.5,-1077 378.5,-1077 378.5,-1053 469.5,-1053 469.5,-1077"/>
<text text-anchor="middle" x="424" y="-1062.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_mc~~CallsGraph_edge20" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.517,-931.946C178.762,-934.451 182.739,-937.442 186,-941 219.051,-977.057 183.611,-1014.69 222,-1045 262.982,-1077.36 324.291,-1078.84 368.415,-1074.42"/>
<polygon fill="#000000" stroke="#000000" points="368.853,-1077.89 378.396,-1073.29 368.066,-1070.94 368.853,-1077.89"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~npa_mc~~CallsGraph_node29" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~npa_mc~~CallsGraph_node29"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-830 223.5,-830 223.5,-806 314.5,-806 314.5,-830"/>
<text text-anchor="middle" x="269" y="-815.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~npa_mc~~CallsGraph_edge15" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M148.941,-907.953C163.536,-890.856 192.269,-859.372 222,-839 224.091,-837.567 226.296,-836.19 228.562,-834.875"/>
<polygon fill="#000000" stroke="#000000" points="230.312,-837.909 237.495,-830.12 227.023,-831.729 230.312,-837.909"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~npa_mc~~CallsGraph_node30" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~npa_mc~~CallsGraph_node30"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1036 223.5,-1036 223.5,-1012 314.5,-1012 314.5,-1036"/>
<text text-anchor="middle" x="269" y="-1021.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~npa_mc~~CallsGraph_edge17" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M172.939,-932.034C177.626,-934.56 182.146,-937.534 186,-941 209.692,-962.307 198.394,-981.597 222,-1003 223.297,-1004.18 224.67,-1005.3 226.101,-1006.36"/>
<polygon fill="#000000" stroke="#000000" points="224.467,-1009.47 234.783,-1011.88 228.224,-1003.56 224.467,-1009.47"/>
</g>
<!-- proc~approx_eq -->
<g id="proc~~npa_mc~~CallsGraph_node15" class="node"><title>proc~approx_eq</title>
<g id="a_proc~~npa_mc~~CallsGraph_node15"><a xlink:href=".././proc/approx_eq.html" xlink:title="approx_eq">
<polygon fill="#d94e8f" stroke="#d94e8f" points="301,-663 237,-663 237,-639 301,-639 301,-663"/>
<text text-anchor="middle" x="269" y="-648.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_eq</text>
</a>
</g>
</g>
<!-- proc~npa_gyro_range&#45;&gt;proc~approx_eq -->
<g id="proc~~npa_mc~~CallsGraph_edge24" class="edge"><title>proc~npa_gyro_range&#45;&gt;proc~approx_eq</title>
<path fill="none" stroke="#000000" d="M175.966,-621.036C191.873,-626.215 210.531,-632.289 226.873,-637.61"/>
<polygon fill="#000000" stroke="#000000" points="226.112,-641.043 236.705,-640.811 228.279,-634.387 226.112,-641.043"/>
</g>
<!-- proc~gyro_range -->
<g id="proc~~npa_mc~~CallsGraph_node17" class="node"><title>proc~gyro_range</title>
<g id="a_proc~~npa_mc~~CallsGraph_node17"><a xlink:href=".././proc/gyro_range.html" xlink:title="gyro_range">
<polygon fill="#d9534f" stroke="#d9534f" points="302.5,-621 235.5,-621 235.5,-597 302.5,-597 302.5,-621"/>
<text text-anchor="middle" x="269" y="-606.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_range</text>
</a>
</g>
</g>
<!-- proc~npa_gyro_range&#45;&gt;proc~gyro_range -->
<g id="proc~~npa_mc~~CallsGraph_edge23" class="edge"><title>proc~npa_gyro_range&#45;&gt;proc~gyro_range</title>
<path fill="none" stroke="#000000" d="M183.756,-609C197.077,-609 211.642,-609 224.859,-609"/>
<polygon fill="#000000" stroke="#000000" points="225.119,-612.5 235.119,-609 225.119,-605.5 225.119,-612.5"/>
</g>
<!-- proc~colrad -->
<g id="proc~~npa_mc~~CallsGraph_node21" class="node"><title>proc~colrad</title>
<g id="a_proc~~npa_mc~~CallsGraph_node21"><a xlink:href=".././proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="296,-431 242,-431 242,-407 296,-407 296,-431"/>
<text text-anchor="middle" x="269" y="-416.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~attenuate&#45;&gt;proc~colrad -->
<g id="proc~~npa_mc~~CallsGraph_edge26" class="edge"><title>proc~attenuate&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M167.467,-324.292C173.868,-327.252 180.414,-330.83 186,-335 205.702,-349.706 204.89,-359.345 222,-377 229.517,-384.756 238.17,-392.853 245.928,-399.844"/>
<polygon fill="#000000" stroke="#000000" points="244.1,-402.902 253.9,-406.928 248.75,-397.669 244.1,-402.902"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~npa_mc~~CallsGraph_node32" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~npa_mc~~CallsGraph_node32"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-288 235,-288 235,-264 303,-264 303,-288"/>
<text text-anchor="middle" x="269" y="-273.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~attenuate&#45;&gt;proc~get_plasma -->
<g id="proc~~npa_mc~~CallsGraph_edge25" class="edge"><title>proc~attenuate&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M167.31,-305.661C184.236,-300.675 206.078,-294.241 225.091,-288.64"/>
<polygon fill="#000000" stroke="#000000" points="226.131,-291.982 234.735,-285.799 224.153,-285.267 226.131,-291.982"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_mc~~CallsGraph_edge31" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M272.846,-221.802C280.212,-193.385 302.854,-123.068 352,-95 448.349,-39.974 586.052,-91.5797 648.267,-120.469"/>
<polygon fill="#000000" stroke="#000000" points="647.051,-123.766 657.586,-124.891 650.052,-117.442 647.051,-123.766"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~npa_mc~~CallsGraph_node18" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~npa_mc~~CallsGraph_node18"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="474,-128 374,-128 374,-104 474,-104 474,-128"/>
<text text-anchor="middle" x="424" y="-113.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~npa_mc~~CallsGraph_edge30" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M277.869,-221.83C291.018,-202.387 319.263,-164.249 352,-142 357.617,-138.183 363.863,-134.846 370.255,-131.953"/>
<polygon fill="#000000" stroke="#000000" points="371.786,-135.106 379.667,-128.025 369.091,-128.646 371.786,-135.106"/>
</g>
<!-- proc~get_position -->
<g id="proc~~npa_mc~~CallsGraph_node23" class="node"><title>proc~get_position</title>
<g id="a_proc~~npa_mc~~CallsGraph_node23"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="459,-246 389,-246 389,-222 459,-222 459,-246"/>
<text text-anchor="middle" x="424" y="-231.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~npa_mc~~CallsGraph_edge28" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M298.063,-234C320.682,-234 352.899,-234 378.952,-234"/>
<polygon fill="#000000" stroke="#000000" points="378.964,-237.5 388.964,-234 378.964,-230.5 378.964,-237.5"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~npa_mc~~CallsGraph_node26" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~npa_mc~~CallsGraph_node26"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="606,-168 538,-168 538,-144 606,-144 606,-168"/>
<text text-anchor="middle" x="572" y="-153.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_mc~~CallsGraph_edge27" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M283.687,-221.994C299.123,-209.209 325.539,-189.532 352,-180 410.256,-159.015 482.411,-154.973 527.59,-154.838"/>
<polygon fill="#000000" stroke="#000000" points="527.625,-158.338 537.637,-154.871 527.649,-151.338 527.625,-158.338"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~npa_mc~~CallsGraph_node31" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~npa_mc~~CallsGraph_node31"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="454.5,-288 393.5,-288 393.5,-264 454.5,-264 454.5,-288"/>
<text text-anchor="middle" x="424" y="-273.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~npa_mc~~CallsGraph_edge29" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M298.063,-241.703C322.006,-248.276 356.703,-257.801 383.46,-265.146"/>
<polygon fill="#000000" stroke="#000000" points="382.718,-268.572 393.287,-267.844 384.571,-261.821 382.718,-268.572"/>
</g>
<!-- proc~neutral_cx_rate -->
<g id="proc~~npa_mc~~CallsGraph_node33" class="node"><title>proc~neutral_cx_rate</title>
<g id="a_proc~~npa_mc~~CallsGraph_node33"><a xlink:href=".././proc/neutral_cx_rate.html" xlink:title="neutral_cx_rate">
<polygon fill="#d9534f" stroke="#d9534f" points="312.5,-368 225.5,-368 225.5,-344 312.5,-344 312.5,-368"/>
<text text-anchor="middle" x="269" y="-353.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutral_cx_rate</text>
</a>
</g>
</g>
<!-- proc~get_total_cx_rate&#45;&gt;proc~neutral_cx_rate -->
<g id="proc~~npa_mc~~CallsGraph_edge32" class="edge"><title>proc~get_total_cx_rate&#45;&gt;proc~neutral_cx_rate</title>
<path fill="none" stroke="#000000" d="M185.572,-356C195.213,-356 205.435,-356 215.278,-356"/>
<polygon fill="#000000" stroke="#000000" points="215.358,-359.5 225.358,-356 215.358,-352.5 215.358,-359.5"/>
</g>
<!-- proc~in_boundary -->
<g id="proc~~npa_mc~~CallsGraph_node28" class="node"><title>proc~in_boundary</title>
<g id="a_proc~~npa_mc~~CallsGraph_node28"><a xlink:href=".././proc/in_boundary.html" xlink:title="in_boundary">
<polygon fill="#d94e8f" stroke="#d94e8f" points="460,-537 388,-537 388,-513 460,-513 460,-537"/>
<text text-anchor="middle" x="424" y="-522.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_boundary</text>
</a>
</g>
</g>
<!-- proc~hit_npa_detector&#45;&gt;proc~in_boundary -->
<g id="proc~~npa_mc~~CallsGraph_edge34" class="edge"><title>proc~hit_npa_detector&#45;&gt;proc~in_boundary</title>
<path fill="none" stroke="#000000" d="M315.905,-525C335.453,-525 358.193,-525 377.677,-525"/>
<polygon fill="#000000" stroke="#000000" points="377.83,-528.5 387.83,-525 377.83,-521.5 377.83,-528.5"/>
</g>
<!-- proc~line_plane_intersect -->
<g id="proc~~npa_mc~~CallsGraph_node34" class="node"><title>proc~line_plane_intersect</title>
<g id="a_proc~~npa_mc~~CallsGraph_node34"><a xlink:href=".././proc/line_plane_intersect.html" xlink:title="line_plane_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="478,-579 370,-579 370,-555 478,-555 478,-579"/>
<text text-anchor="middle" x="424" y="-564.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">line_plane_intersect</text>
</a>
</g>
</g>
<!-- proc~hit_npa_detector&#45;&gt;proc~line_plane_intersect -->
<g id="proc~~npa_mc~~CallsGraph_edge33" class="edge"><title>proc~hit_npa_detector&#45;&gt;proc~line_plane_intersect</title>
<path fill="none" stroke="#000000" d="M313.844,-537.036C331.129,-541.781 351.153,-547.277 369.294,-552.257"/>
<polygon fill="#000000" stroke="#000000" points="368.58,-555.691 379.15,-554.963 370.433,-548.94 368.58,-555.691"/>
</g>
<!-- proc~store_npa&#45;&gt;proc~get_fields -->
<g id="proc~~npa_mc~~CallsGraph_edge36" class="edge"><title>proc~store_npa&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M168.595,-234C186.754,-234 210.196,-234 229.754,-234"/>
<polygon fill="#000000" stroke="#000000" points="229.87,-237.5 239.87,-234 229.87,-230.5 229.87,-237.5"/>
</g>
<!-- proc~store_npa&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_mc~~CallsGraph_edge35" class="edge"><title>proc~store_npa&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M168.279,-221.996C174.251,-219.25 180.413,-216.192 186,-213 264.595,-168.095 265.768,-122.526 352,-95 412.969,-75.5382 435.694,-73.5718 496,-95 519.085,-103.203 540.228,-121.883 554.139,-136.426"/>
<polygon fill="#000000" stroke="#000000" points="551.744,-138.994 561.089,-143.987 556.898,-134.256 551.744,-138.994"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~npa_mc~~CallsGraph_edge37" class="edge"><title>proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M313.026,-868.718C330.708,-872.3 351.361,-876.485 369.964,-880.254"/>
<polygon fill="#000000" stroke="#000000" points="369.271,-883.685 379.767,-882.24 370.661,-876.824 369.271,-883.685"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_node39" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="611.5,-980 532.5,-980 532.5,-956 611.5,-956 611.5,-980"/>
<text text-anchor="middle" x="572" y="-965.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge38" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M313.157,-851.593C360.801,-844.562 438.373,-839.933 496,-870 527.745,-886.563 550.006,-923.267 561.636,-946.755"/>
<polygon fill="#000000" stroke="#000000" points="558.529,-948.371 565.967,-955.916 564.857,-945.379 558.529,-948.371"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_mc~~CallsGraph_edge39" class="edge"><title>proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M297.452,-994.006C303.609,-996.844 310.072,-999.938 316,-1003 343.374,-1017.14 373.68,-1034.91 395.03,-1047.79"/>
<polygon fill="#000000" stroke="#000000" points="393.232,-1050.8 403.596,-1052.99 396.864,-1044.81 393.232,-1050.8"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge40" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.738,-979.919C370.24,-977.338 464.546,-972.951 521.967,-970.281"/>
<polygon fill="#000000" stroke="#000000" points="522.415,-973.764 532.242,-969.803 522.09,-966.771 522.415,-973.764"/>
</g>
<!-- proc~gyro_range&#45;&gt;proc~in_boundary -->
<g id="proc~~npa_mc~~CallsGraph_edge46" class="edge"><title>proc~gyro_range&#45;&gt;proc~in_boundary</title>
<path fill="none" stroke="#000000" d="M282.609,-596.891C297.891,-582.82 324.968,-559.777 352,-546 360.071,-541.886 369.08,-538.446 377.898,-535.62"/>
<polygon fill="#000000" stroke="#000000" points="379.133,-538.904 387.712,-532.688 377.128,-532.197 379.133,-538.904"/>
</g>
<!-- proc~gyro_range&#45;&gt;proc~line_plane_intersect -->
<g id="proc~~npa_mc~~CallsGraph_edge45" class="edge"><title>proc~gyro_range&#45;&gt;proc~line_plane_intersect</title>
<path fill="none" stroke="#000000" d="M302.822,-599.99C322.25,-594.657 347.33,-587.772 369.548,-581.673"/>
<polygon fill="#000000" stroke="#000000" points="370.48,-585.047 379.196,-579.025 368.627,-578.297 370.48,-585.047"/>
</g>
<!-- proc~gyro_surface_coordinates -->
<g id="proc~~npa_mc~~CallsGraph_node37" class="node"><title>proc~gyro_surface_coordinates</title>
<g id="a_proc~~npa_mc~~CallsGraph_node37"><a xlink:href=".././proc/gyro_surface_coordinates.html" xlink:title="gyro_surface_coordinates">
<polygon fill="#d9534f" stroke="#d9534f" points="492,-663 356,-663 356,-639 492,-639 492,-663"/>
<text text-anchor="middle" x="424" y="-648.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_surface_coordinates</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~gyro_surface_coordinates -->
<g id="proc~~npa_mc~~CallsGraph_edge41" class="edge"><title>proc~gyro_range&#45;&gt;proc~gyro_surface_coordinates</title>
<path fill="none" stroke="#000000" d="M302.822,-618.01C322.25,-623.343 347.33,-630.228 369.548,-636.327"/>
<polygon fill="#000000" stroke="#000000" points="368.627,-639.703 379.196,-638.975 370.48,-632.953 368.627,-639.703"/>
</g>
<!-- proc~in_gyro_surface -->
<g id="proc~~npa_mc~~CallsGraph_node42" class="node"><title>proc~in_gyro_surface</title>
<g id="a_proc~~npa_mc~~CallsGraph_node42"><a xlink:href=".././proc/in_gyro_surface.html" xlink:title="in_gyro_surface">
<polygon fill="#d94e8f" stroke="#d94e8f" points="468.5,-621 379.5,-621 379.5,-597 468.5,-597 468.5,-621"/>
<text text-anchor="middle" x="424" y="-606.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_gyro_surface</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~in_gyro_surface -->
<g id="proc~~npa_mc~~CallsGraph_edge42" class="edge"><title>proc~gyro_range&#45;&gt;proc~in_gyro_surface</title>
<path fill="none" stroke="#000000" d="M302.822,-609C322.152,-609 347.076,-609 369.21,-609"/>
<polygon fill="#000000" stroke="#000000" points="369.483,-612.5 379.483,-609 369.483,-605.5 369.483,-612.5"/>
</g>
<!-- proc~boundary_edge -->
<g id="proc~~npa_mc~~CallsGraph_node43" class="node"><title>proc~boundary_edge</title>
<g id="a_proc~~npa_mc~~CallsGraph_node43"><a xlink:href=".././proc/boundary_edge.html" xlink:title="boundary_edge">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-747 380,-747 380,-723 468,-723 468,-747"/>
<text text-anchor="middle" x="424" y="-732.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boundary_edge</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~boundary_edge -->
<g id="proc~~npa_mc~~CallsGraph_edge43" class="edge"><title>proc~gyro_range&#45;&gt;proc~boundary_edge</title>
<path fill="none" stroke="#000000" d="M302.66,-620.194C307.537,-622.867 312.196,-626.107 316,-630 344.383,-659.055 321.645,-687.012 352,-714 357.228,-718.648 363.442,-722.269 369.986,-725.089"/>
<polygon fill="#000000" stroke="#000000" points="369.141,-728.508 379.735,-728.675 371.558,-721.938 369.141,-728.508"/>
</g>
<!-- proc~line_gyro_surface_intersect -->
<g id="proc~~npa_mc~~CallsGraph_node44" class="node"><title>proc~line_gyro_surface_intersect</title>
<g id="a_proc~~npa_mc~~CallsGraph_node44"><a xlink:href=".././proc/line_gyro_surface_intersect.html" xlink:title="line_gyro_surface_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="496,-705 352,-705 352,-681 496,-681 496,-705"/>
<text text-anchor="middle" x="424" y="-690.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">line_gyro_surface_intersect</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~line_gyro_surface_intersect -->
<g id="proc~~npa_mc~~CallsGraph_edge44" class="edge"><title>proc~gyro_range&#45;&gt;proc~line_gyro_surface_intersect</title>
<path fill="none" stroke="#000000" d="M301.237,-621.017C306.391,-623.619 311.511,-626.621 316,-630 335.643,-644.785 331.366,-658.632 352,-672 354.613,-673.693 357.367,-675.253 360.211,-676.691"/>
<polygon fill="#000000" stroke="#000000" points="358.989,-679.979 369.546,-680.879 361.855,-673.592 358.989,-679.979"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_mc~~CallsGraph_edge47" class="edge"><title>proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M297.42,-1133.93C303.579,-1131.1 310.05,-1128.02 316,-1125 342.8,-1111.4 372.567,-1094.56 393.887,-1082.19"/>
<polygon fill="#000000" stroke="#000000" points="395.885,-1085.07 402.759,-1077.01 392.358,-1079.03 395.885,-1085.07"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge48" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.681,-1155.01C363.675,-1162.29 442.438,-1166.04 496,-1129 543.119,-1096.42 561.348,-1026.34 567.803,-990.34"/>
<polygon fill="#000000" stroke="#000000" points="571.277,-990.778 569.447,-980.343 564.37,-989.642 571.277,-990.778"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge49" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M313.228,-769.163C362.366,-764.939 442.656,-765.633 496,-805 542.565,-839.364 561.044,-909.696 567.677,-945.693"/>
<polygon fill="#000000" stroke="#000000" points="564.249,-946.412 569.374,-955.685 571.15,-945.24 564.249,-946.412"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~npa_mc~~CallsGraph_node40" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~npa_mc~~CallsGraph_node40"><a xlink:href=".././proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-410 380,-410 380,-386 468,-386 468,-410"/>
<text text-anchor="middle" x="424" y="-395.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~npa_mc~~CallsGraph_edge50" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M296.302,-415.39C316.427,-412.628 344.85,-408.726 369.677,-405.319"/>
<polygon fill="#000000" stroke="#000000" points="370.272,-408.77 379.703,-403.943 369.32,-401.835 370.272,-408.77"/>
</g>
<!-- proc~eigen -->
<g id="proc~~npa_mc~~CallsGraph_node41" class="node"><title>proc~eigen</title>
<g id="a_proc~~npa_mc~~CallsGraph_node41"><a xlink:href=".././proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="451,-495 397,-495 397,-471 451,-471 451,-495"/>
<text text-anchor="middle" x="424" y="-480.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~npa_mc~~CallsGraph_edge51" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M291.104,-431.092C307.391,-440.106 330.67,-452.309 352,-461 363.277,-465.595 375.886,-469.791 387.314,-473.259"/>
<polygon fill="#000000" stroke="#000000" points="386.408,-476.64 396.99,-476.11 388.387,-469.926 386.408,-476.64"/>
</g>
<!-- proc~linsolve -->
<g id="proc~~npa_mc~~CallsGraph_node45" class="node"><title>proc~linsolve</title>
<g id="a_proc~~npa_mc~~CallsGraph_node45"><a xlink:href=".././proc/linsolve.html" xlink:title="linsolve">
<polygon fill="#d9534f" stroke="#d9534f" points="451,-452 397,-452 397,-428 451,-428 451,-452"/>
<text text-anchor="middle" x="424" y="-437.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linsolve</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~linsolve -->
<g id="proc~~npa_mc~~CallsGraph_edge52" class="edge"><title>proc~colrad&#45;&gt;proc~linsolve</title>
<path fill="none" stroke="#000000" d="M296.302,-422.61C321.227,-426.031 358.881,-431.199 386.667,-435.013"/>
<polygon fill="#000000" stroke="#000000" points="386.403,-438.51 396.786,-436.402 387.355,-431.575 386.403,-438.51"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_mc~~CallsGraph_edge53" class="edge"><title>proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M314.665,-1092.61C331.402,-1088.35 350.614,-1083.45 368.167,-1078.98"/>
<polygon fill="#000000" stroke="#000000" points="369.454,-1082.26 378.279,-1076.4 367.725,-1075.48 369.454,-1082.26"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge54" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M312.495,-1116.08C360.595,-1127.17 439.579,-1137.32 496,-1104 537.745,-1079.35 557.848,-1022.24 566.117,-990.423"/>
<polygon fill="#000000" stroke="#000000" points="569.612,-990.862 568.564,-980.319 562.808,-989.214 569.612,-990.862"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~npa_mc~~CallsGraph_node38" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~npa_mc~~CallsGraph_node38"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="603,-210 541,-210 541,-186 603,-186 603,-210"/>
<text text-anchor="middle" x="572" y="-195.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~npa_mc~~CallsGraph_edge55" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M459.231,-225.56C480.719,-220.261 508.521,-213.406 531.021,-207.858"/>
<polygon fill="#000000" stroke="#000000" points="532.072,-211.203 540.944,-205.411 530.397,-204.407 532.072,-211.203"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~npa_mc~~CallsGraph_edge56" class="edge"><title>proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M307.82,-927.888C328.309,-921.326 353.822,-913.155 375.625,-906.172"/>
<polygon fill="#000000" stroke="#000000" points="376.894,-909.441 385.35,-903.058 374.759,-902.775 376.894,-909.441"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge57" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M313.126,-944.012C368.485,-949.161 464.288,-958.073 522.241,-963.464"/>
<polygon fill="#000000" stroke="#000000" points="521.972,-966.954 532.254,-964.396 522.621,-959.984 521.972,-966.954"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~npa_mc~~CallsGraph_edge58" class="edge"><title>proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M399.529,-903.014C390.984,-911.972 399.141,-921 424,-921 439.149,-921 448.095,-917.647 450.839,-913.001"/>
<polygon fill="#000000" stroke="#000000" points="454.184,-911.936 448.471,-903.014 447.373,-913.552 454.184,-911.936"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge59" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M447.812,-903.031C472.311,-915.952 511.426,-936.581 538.996,-951.121"/>
<polygon fill="#000000" stroke="#000000" points="537.388,-954.23 547.866,-955.799 540.653,-948.038 537.388,-954.23"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_mc~~CallsGraph_edge60" class="edge"><title>proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M399.529,-1077.01C390.984,-1085.97 399.141,-1095 424,-1095 439.149,-1095 448.095,-1091.65 450.839,-1087"/>
<polygon fill="#000000" stroke="#000000" points="454.184,-1085.94 448.471,-1077.01 447.373,-1087.55 454.184,-1085.94"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge61" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M466.873,-1052.87C476.791,-1049.14 487.072,-1044.53 496,-1039 518.586,-1025.01 540.152,-1003.43 554.312,-987.732"/>
<polygon fill="#000000" stroke="#000000" points="557.025,-989.948 561.008,-980.131 551.772,-985.321 557.025,-989.948"/>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge62" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.589,-811.627C363.144,-807.059 441.184,-806.877 496,-842 533.798,-866.219 555.11,-916.859 564.713,-946.029"/>
<polygon fill="#000000" stroke="#000000" points="561.415,-947.209 567.73,-955.715 568.098,-945.127 561.415,-947.209"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_mc~~CallsGraph_edge63" class="edge"><title>proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M314.665,-1035.97C331.402,-1040.45 350.614,-1045.6 368.167,-1050.31"/>
<polygon fill="#000000" stroke="#000000" points="367.714,-1053.81 378.279,-1053.02 369.526,-1047.05 367.714,-1053.81"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge64" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.846,-1018.24C360.627,-1012.04 433.624,-1001.25 496,-988 504.62,-986.169 513.729,-983.969 522.516,-981.707"/>
<polygon fill="#000000" stroke="#000000" points="523.476,-985.074 532.256,-979.144 521.695,-978.304 523.476,-985.074"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_mc~~CallsGraph_edge66" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M454.65,-272.921C468.545,-270.158 484.527,-264.921 496,-255 524.881,-230.026 505.845,-204.816 532,-177 532.889,-176.055 533.83,-175.143 534.813,-174.264"/>
<polygon fill="#000000" stroke="#000000" points="537.059,-176.954 542.981,-168.169 532.873,-171.344 537.059,-176.954"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~npa_mc~~CallsGraph_node36" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~npa_mc~~CallsGraph_node36"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="714.5,-249 649.5,-249 649.5,-225 714.5,-225 714.5,-249"/>
<text text-anchor="middle" x="682" y="-234.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~npa_mc~~CallsGraph_edge65" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M454.617,-271.488C500.052,-264.566 587.135,-251.3 639.048,-243.391"/>
<polygon fill="#000000" stroke="#000000" points="639.893,-246.803 649.252,-241.837 638.839,-239.883 639.893,-246.803"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~npa_mc~~CallsGraph_node46" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~npa_mc~~CallsGraph_node46"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="610.5,-328 533.5,-328 533.5,-304 610.5,-304 610.5,-328"/>
<text text-anchor="middle" x="572" y="-313.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_mc~~CallsGraph_edge67" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M454.545,-284.095C474.36,-289.523 500.891,-296.792 523.625,-303.021"/>
<polygon fill="#000000" stroke="#000000" points="522.865,-306.441 533.434,-305.708 524.714,-299.69 522.865,-306.441"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_mc~~CallsGraph_edge70" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M303.364,-286.907C348.184,-299.817 429.851,-317.172 496,-297 574.214,-273.149 639.436,-194.651 666.958,-157.212"/>
<polygon fill="#000000" stroke="#000000" points="669.833,-159.208 672.838,-149.048 664.153,-155.117 669.833,-159.208"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~npa_mc~~CallsGraph_edge69" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M303.199,-266.887C325.445,-260.78 354.977,-252.673 379.152,-246.037"/>
<polygon fill="#000000" stroke="#000000" points="380.09,-249.409 388.807,-243.386 378.237,-242.659 380.09,-249.409"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_mc~~CallsGraph_edge68" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M301.237,-263.983C306.391,-261.381 311.511,-258.379 316,-255 335.643,-240.215 330.96,-225.719 352,-213 408.19,-179.033 432.676,-197.354 496,-180 506.491,-177.125 517.707,-173.718 528.182,-170.389"/>
<polygon fill="#000000" stroke="#000000" points="529.507,-173.639 537.951,-167.239 527.36,-166.976 529.507,-173.639"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~npa_mc~~CallsGraph_edge71" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M303.199,-276C326.731,-276 358.413,-276 383.287,-276"/>
<polygon fill="#000000" stroke="#000000" points="383.486,-279.5 393.486,-276 383.486,-272.5 383.486,-279.5"/>
</g>
<!-- proc~bb_cx_rates -->
<g id="proc~~npa_mc~~CallsGraph_node35" class="node"><title>proc~bb_cx_rates</title>
<g id="a_proc~~npa_mc~~CallsGraph_node35"><a xlink:href=".././proc/bb_cx_rates.html" xlink:title="bb_cx_rates">
<polygon fill="#d9534f" stroke="#d9534f" points="459.5,-368 388.5,-368 388.5,-344 459.5,-344 459.5,-368"/>
<text text-anchor="middle" x="424" y="-353.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bb_cx_rates</text>
</a>
</g>
</g>
<!-- proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates -->
<g id="proc~~npa_mc~~CallsGraph_edge72" class="edge"><title>proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates</title>
<path fill="none" stroke="#000000" d="M312.619,-356C333.042,-356 357.503,-356 378.201,-356"/>
<polygon fill="#000000" stroke="#000000" points="378.333,-359.5 388.333,-356 378.333,-352.5 378.333,-359.5"/>
</g>
<!-- proc~bb_cx_rates&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_mc~~CallsGraph_edge73" class="edge"><title>proc~bb_cx_rates&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M459.6,-346.521C478.659,-341.299 502.599,-334.74 523.397,-329.042"/>
<polygon fill="#000000" stroke="#000000" points="524.6,-332.341 533.32,-326.323 522.75,-325.59 524.6,-332.341"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_mc~~CallsGraph_edge75" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M595.751,-185.905C601.098,-183.019 606.764,-179.926 612,-177 625.099,-169.679 639.473,-161.388 651.696,-154.26"/>
<polygon fill="#000000" stroke="#000000" points="653.701,-157.142 660.566,-149.071 650.167,-151.099 653.701,-157.142"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~npa_mc~~CallsGraph_edge74" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M603.084,-208.864C614.411,-212.954 627.498,-217.68 639.674,-222.077"/>
<polygon fill="#000000" stroke="#000000" points="638.598,-225.409 649.192,-225.514 640.975,-218.825 638.598,-225.409"/>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_mc~~CallsGraph_edge76" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M468.316,-389.302C477.87,-386.285 487.629,-382.281 496,-377 516.229,-364.239 513.193,-351.777 532,-337 533.542,-335.788 535.164,-334.61 536.834,-333.47"/>
<polygon fill="#000000" stroke="#000000" points="538.802,-336.368 545.446,-328.115 535.106,-330.423 538.802,-336.368"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~npa_mc~~CallsGraph_node47" class="node"><title>proc~hqr2</title>
<g id="a_proc~~npa_mc~~CallsGraph_node47"><a xlink:href=".././proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-664 545,-664 545,-640 599,-640 599,-664"/>
<text text-anchor="middle" x="572" y="-649.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~npa_mc~~CallsGraph_edge77" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M451.13,-484.618C466.126,-486.887 484.251,-492.117 496,-504 537.249,-545.72 495.268,-585.254 532,-631 533.408,-632.754 535.004,-634.381 536.726,-635.888"/>
<polygon fill="#000000" stroke="#000000" points="534.725,-638.76 544.892,-641.74 538.802,-633.07 534.725,-638.76"/>
</g>
<!-- proc~balback -->
<g id="proc~~npa_mc~~CallsGraph_node49" class="node"><title>proc~balback</title>
<g id="a_proc~~npa_mc~~CallsGraph_node49"><a xlink:href=".././proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-538 545,-538 545,-514 599,-514 599,-538"/>
<text text-anchor="middle" x="572" y="-523.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~npa_mc~~CallsGraph_edge78" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M451.102,-490.688C474.418,-497.555 508.802,-507.682 534.778,-515.332"/>
<polygon fill="#000000" stroke="#000000" points="534.05,-518.766 544.632,-518.234 536.028,-512.051 534.05,-518.766"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~npa_mc~~CallsGraph_node50" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~npa_mc~~CallsGraph_node50"><a xlink:href=".././proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-496 545,-496 545,-472 599,-472 599,-496"/>
<text text-anchor="middle" x="572" y="-481.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~npa_mc~~CallsGraph_edge79" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M451.102,-483.179C474.314,-483.338 508.498,-483.572 534.432,-483.75"/>
<polygon fill="#000000" stroke="#000000" points="534.608,-487.251 544.632,-483.819 534.656,-480.251 534.608,-487.251"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~npa_mc~~CallsGraph_node51" class="node"><title>proc~elmhes</title>
<g id="a_proc~~npa_mc~~CallsGraph_node51"><a xlink:href=".././proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-622 545,-622 545,-598 599,-598 599,-622"/>
<text text-anchor="middle" x="572" y="-607.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~npa_mc~~CallsGraph_edge80" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M451.295,-485.281C465.977,-487.792 483.727,-493.042 496,-504 526.603,-531.325 504.375,-558.668 532,-589 533.359,-590.492 534.85,-591.9 536.43,-593.223"/>
<polygon fill="#000000" stroke="#000000" points="534.696,-596.281 544.894,-599.154 538.713,-590.549 534.696,-596.281"/>
</g>
<!-- proc~balance -->
<g id="proc~~npa_mc~~CallsGraph_node53" class="node"><title>proc~balance</title>
<g id="a_proc~~npa_mc~~CallsGraph_node53"><a xlink:href=".././proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-580 545,-580 545,-556 599,-556 599,-580"/>
<text text-anchor="middle" x="572" y="-565.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~npa_mc~~CallsGraph_edge81" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M451.194,-486.945C465.323,-489.972 482.566,-495.185 496,-504 516.839,-517.673 512.68,-531.253 532,-547 533.352,-548.102 534.771,-549.174 536.234,-550.212"/>
<polygon fill="#000000" stroke="#000000" points="534.628,-553.339 544.941,-555.767 538.393,-547.438 534.628,-553.339"/>
</g>
<!-- dgetrf -->
<g id="proc~~npa_mc~~CallsGraph_node48" class="node"><title>dgetrf</title>
<polygon fill="#777777" stroke="#777777" points="599,-412 545,-412 545,-388 599,-388 599,-412"/>
<text text-anchor="middle" x="572" y="-397.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrf</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrf -->
<g id="proc~~npa_mc~~CallsGraph_edge84" class="edge"><title>proc~linsolve&#45;&gt;dgetrf</title>
<path fill="none" stroke="#000000" d="M451.102,-432.849C474.418,-426.461 508.802,-417.04 534.778,-409.924"/>
<polygon fill="#000000" stroke="#000000" points="535.912,-413.242 544.632,-407.224 534.062,-406.491 535.912,-413.242"/>
</g>
<!-- proc~matinv -->
<g id="proc~~npa_mc~~CallsGraph_node52" class="node"><title>proc~matinv</title>
<g id="a_proc~~npa_mc~~CallsGraph_node52"><a xlink:href=".././proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-454 545,-454 545,-430 599,-430 599,-454"/>
<text text-anchor="middle" x="572" y="-439.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~linsolve&#45;&gt;proc~matinv -->
<g id="proc~~npa_mc~~CallsGraph_edge82" class="edge"><title>proc~linsolve&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M451.102,-440.358C474.314,-440.676 508.498,-441.144 534.432,-441.499"/>
<polygon fill="#000000" stroke="#000000" points="534.585,-445.001 544.632,-441.639 534.681,-438.002 534.585,-445.001"/>
</g>
<!-- dgetrs -->
<g id="proc~~npa_mc~~CallsGraph_node54" class="node"><title>dgetrs</title>
<polygon fill="#777777" stroke="#777777" points="599,-370 545,-370 545,-346 599,-346 599,-370"/>
<text text-anchor="middle" x="572" y="-355.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrs</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrs -->
<g id="proc~~npa_mc~~CallsGraph_edge83" class="edge"><title>proc~linsolve&#45;&gt;dgetrs</title>
<path fill="none" stroke="#000000" d="M451.072,-435.865C465.164,-432.781 482.41,-427.573 496,-419 516.229,-406.239 513.193,-393.777 532,-379 533.542,-377.788 535.164,-376.61 536.834,-375.47"/>
<polygon fill="#000000" stroke="#000000" points="538.802,-378.368 545.446,-370.115 535.106,-372.423 538.802,-378.368"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~npa_mc~~CallsGraph_node55" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~npa_mc~~CallsGraph_node55"><a xlink:href=".././proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-664 655,-664 655,-640 709,-640 709,-664"/>
<text text-anchor="middle" x="682" y="-649.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~npa_mc~~CallsGraph_edge85" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M599.144,-652C612.707,-652 629.499,-652 644.338,-652"/>
<polygon fill="#000000" stroke="#000000" points="644.723,-655.5 654.723,-652 644.723,-648.5 644.723,-655.5"/>
</g>
<!-- proc~rswap -->
<g id="proc~~npa_mc~~CallsGraph_node58" class="node"><title>proc~rswap</title>
<g id="a_proc~~npa_mc~~CallsGraph_node58"><a xlink:href=".././proc/rswap.html" xlink:title="RSWAP">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-580 655,-580 655,-556 709,-556 709,-580"/>
<text text-anchor="middle" x="682" y="-565.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RSWAP</text>
</a>
</g>
</g>
<!-- proc~balback&#45;&gt;proc~rswap -->
<g id="proc~~npa_mc~~CallsGraph_edge86" class="edge"><title>proc~balback&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M599.144,-536.167C612.971,-541.544 630.153,-548.226 645.2,-554.078"/>
<polygon fill="#000000" stroke="#000000" points="644.134,-557.419 654.723,-557.781 646.671,-550.894 644.134,-557.419"/>
</g>
<!-- proc~elmhes&#45;&gt;proc~rswap -->
<g id="proc~~npa_mc~~CallsGraph_edge87" class="edge"><title>proc~elmhes&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M599.144,-599.833C612.971,-594.456 630.153,-587.774 645.2,-581.922"/>
<polygon fill="#000000" stroke="#000000" points="646.671,-585.106 654.723,-578.219 644.134,-578.581 646.671,-585.106"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~npa_mc~~CallsGraph_node56" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~npa_mc~~CallsGraph_node56"><a xlink:href=".././proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-475 655,-475 655,-451 709,-451 709,-475"/>
<text text-anchor="middle" x="682" y="-460.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~npa_mc~~CallsGraph_edge88" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M599.144,-447.084C612.839,-449.746 629.826,-453.049 644.769,-455.955"/>
<polygon fill="#000000" stroke="#000000" points="644.238,-459.417 654.723,-457.891 645.575,-452.546 644.238,-459.417"/>
</g>
<!-- proc~lubksb -->
<g id="proc~~npa_mc~~CallsGraph_node57" class="node"><title>proc~lubksb</title>
<g id="a_proc~~npa_mc~~CallsGraph_node57"><a xlink:href=".././proc/lubksb.html" xlink:title="lubksb">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-433 655,-433 655,-409 709,-409 709,-433"/>
<text text-anchor="middle" x="682" y="-418.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lubksb</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~lubksb -->
<g id="proc~~npa_mc~~CallsGraph_edge89" class="edge"><title>proc~matinv&#45;&gt;proc~lubksb</title>
<path fill="none" stroke="#000000" d="M599.144,-436.916C612.839,-434.254 629.826,-430.951 644.769,-428.045"/>
<polygon fill="#000000" stroke="#000000" points="645.575,-431.454 654.723,-426.109 644.238,-424.583 645.575,-431.454"/>
</g>
<!-- proc~balance&#45;&gt;proc~rswap -->
<g id="proc~~npa_mc~~CallsGraph_edge90" class="edge"><title>proc~balance&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M599.144,-568C612.707,-568 629.499,-568 644.338,-568"/>
<polygon fill="#000000" stroke="#000000" points="644.723,-571.5 654.723,-568 644.723,-564.5 644.723,-571.5"/>
</g>
<!-- proc~comdiv -->
<g id="proc~~npa_mc~~CallsGraph_node61" class="node"><title>proc~comdiv</title>
<g id="a_proc~~npa_mc~~CallsGraph_node61"><a xlink:href=".././proc/comdiv.html" xlink:title="Comdiv">
<polygon fill="#d9534f" stroke="#d9534f" points="809,-664 755,-664 755,-640 809,-640 809,-664"/>
<text text-anchor="middle" x="782" y="-649.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Comdiv</text>
</a>
</g>
</g>
<!-- proc~hqrvec&#45;&gt;proc~comdiv -->
<g id="proc~~npa_mc~~CallsGraph_edge91" class="edge"><title>proc~hqrvec&#45;&gt;proc~comdiv</title>
<path fill="none" stroke="#000000" d="M709.005,-652C719.969,-652 732.92,-652 744.794,-652"/>
<polygon fill="#000000" stroke="#000000" points="744.874,-655.5 754.874,-652 744.874,-648.5 744.874,-655.5"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~npa_mc~~CallsGraph_node59" class="node"><title>proc~outerprod</title>
<g id="a_proc~~npa_mc~~CallsGraph_node59"><a xlink:href=".././proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="811.5,-496 752.5,-496 752.5,-472 811.5,-472 811.5,-496"/>
<text text-anchor="middle" x="782" y="-481.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~npa_mc~~CallsGraph_edge93" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M709.005,-468.572C719.251,-470.768 731.231,-473.335 742.446,-475.739"/>
<polygon fill="#000000" stroke="#000000" points="741.947,-479.211 752.459,-477.884 743.414,-472.366 741.947,-479.211"/>
</g>
<!-- proc~swap -->
<g id="proc~~npa_mc~~CallsGraph_node60" class="node"><title>proc~swap</title>
<g id="a_proc~~npa_mc~~CallsGraph_node60"><a xlink:href=".././proc/swap.html" xlink:title="swap">
<polygon fill="#d9534f" stroke="#d9534f" points="809,-454 755,-454 755,-430 809,-430 809,-454"/>
<text text-anchor="middle" x="782" y="-439.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swap</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~swap -->
<g id="proc~~npa_mc~~CallsGraph_edge92" class="edge"><title>proc~ludcmp&#45;&gt;proc~swap</title>
<path fill="none" stroke="#000000" d="M709.005,-457.428C719.969,-455.078 732.92,-452.303 744.794,-449.758"/>
<polygon fill="#000000" stroke="#000000" points="745.829,-453.116 754.874,-447.599 744.362,-446.272 745.829,-453.116"/>
</g>
</g>
</svg>
</div><script>var panprocnpa_mcCallsGraph = svgPanZoom('#procnpa_mcCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~npa_mc~~CalledByGraph Pages: 1 -->
<svg id="procnpa_mcCalledByGraph" width="152pt" height="32pt"
 viewBox="0.00 0.00 152.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~npa_mc~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~npa_mc~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 148,-28 148,4 -4,4"/>
<!-- proc~npa_mc -->
<g id="proc~~npa_mc~~CalledByGraph_node1" class="node"><title>proc~npa_mc</title>
<polygon fill="none" stroke="black" points="144,-24 90,-24 90,-0 144,-0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">npa_mc</text>
</g>
<!-- program~fidasim -->
<g id="proc~~npa_mc~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~npa_mc~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_mc -->
<g id="proc~~npa_mc~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~npa_mc</title>
<path fill="none" stroke="#000000" d="M54.4029,-12C62.3932,-12 71.3106,-12 79.8241,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.919,-15.5001 89.919,-12 79.919,-8.5001 79.919,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/npa_mc.html#src">npa_mc</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">npa_mc</span><span class="w"></span>
<span class="w">    </span><span class="c">!+ Calculate Active NPA flux using a Monte Carlo fast-ion distribution</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iion</span><span class="p">,</span><span class="n">igamma</span><span class="p">,</span><span class="n">ngamma</span><span class="p">,</span><span class="n">npart</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">FastIon</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fast_ion</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">phi</span><span class="p">,</span><span class="n">theta</span><span class="p">,</span><span class="n">dtheta</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">rf</span><span class="p">,</span><span class="w"> </span><span class="n">rg</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">det</span><span class="p">,</span><span class="n">ichan</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">nrange</span><span class="p">,</span><span class="n">it</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fields</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">GyroSurface</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">gs</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rates</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">states</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">flux</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">neut_types</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ind</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">uvw</span><span class="p">,</span><span class="w"> </span><span class="n">uvw_vi</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">gyrange</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="n">c</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">randomu</span><span class="w"></span>

<span class="w">    </span><span class="n">ngamma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">.</span><span class="nb">or</span><span class="p">.(</span><span class="n">inputs</span><span class="p">%</span><span class="n">dist_type</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">ngamma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ceiling</span><span class="p">(</span><span class="nb">dble</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_npa</span><span class="p">)</span><span class="o">/</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">    if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i10)&#39;</span><span class="p">)</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="o">*</span><span class="n">ngamma</span><span class="p">,</span><span class="n">Int64</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span><span class="w"></span>

<span class="w">    </span><span class="c">!$OMP PARALLEL DO schedule(guided) private(iion,igamma,ind,fast_ion,vi,ri,rf,phi,s,c,ir,it, &amp;</span>
<span class="w">    </span><span class="c">!$OMP&amp; randomu,rg,fields,uvw,uvw_vi,rates,states,flux,det,ichan,gs,nrange,gyrange,theta,dtheta)</span>
<span class="w">    </span><span class="n">loop_over_fast_ions</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">iion</span><span class="o">=</span><span class="n">istart</span><span class="p">,</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="p">,</span><span class="n">istep</span><span class="w"></span>
<span class="w">        </span><span class="n">fast_ion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">particles</span><span class="p">%</span><span class="n">fast_ion</span><span class="p">(</span><span class="n">iion</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vabs</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">loop_over_fast_ions</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">beam_grid_cross_grid</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">loop_over_fast_ions</span><span class="w"></span>
<span class="w">        </span><span class="n">gamma_loop</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">igamma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ngamma</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">                </span><span class="c">!! Pick random toroidal angle</span>
<span class="w">                </span><span class="k">call </span><span class="n">randu</span><span class="p">(</span><span class="n">randomu</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="n">phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">beam_grid_phi_enter</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">delta_phi</span><span class="o">*</span><span class="n">randomu</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">else</span>
<span class="k">                </span><span class="n">phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">phi</span><span class="w"></span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">            </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="c">!! Calculate position in machine coordinates</span>
<span class="w">            </span><span class="n">uvw</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">c</span><span class="w"></span>
<span class="w">            </span><span class="n">uvw</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">s</span><span class="w"></span>
<span class="w">            </span><span class="n">uvw</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">z</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">dist_type</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">                </span><span class="c">!! Convert to beam grid coordinates</span>
<span class="w">                </span><span class="k">call </span><span class="n">uvw_to_xyz</span><span class="p">(</span><span class="n">uvw</span><span class="p">,</span><span class="w"> </span><span class="n">rg</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Get electomagnetic fields</span>
<span class="w">                </span><span class="k">call </span><span class="n">get_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="o">=</span><span class="n">rg</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Correct for gyro motion and get position and velocity</span>
<span class="w">                </span><span class="k">call </span><span class="n">gyro_surface</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">energy</span><span class="p">,</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">pitch</span><span class="p">,</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">gs</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="n">detector_loop</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">ichan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">npa_chords</span><span class="p">%</span><span class="n">nchan</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">npa_gyro_range</span><span class="p">(</span><span class="n">ichan</span><span class="p">,</span><span class="w"> </span><span class="n">gs</span><span class="p">,</span><span class="w"> </span><span class="n">gyrange</span><span class="p">,</span><span class="w"> </span><span class="n">nrange</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="n">nrange</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">detector_loop</span><span class="w"></span>

<span class="w">                    </span><span class="n">gyro_range_loop</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">ir</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nrange</span><span class="w"></span>
<span class="w">                        </span><span class="n">dtheta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gyrange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="n">theta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gyrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="n">dtheta</span><span class="w"></span>
<span class="w">                        </span><span class="k">call </span><span class="n">gyro_trajectory</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span><span class="w"> </span><span class="n">theta</span><span class="p">,</span><span class="w"> </span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="p">)</span><span class="w"></span>

<span class="w">                        </span><span class="c">!! Check if particle hits a NPA detector</span>
<span class="w">                        </span><span class="k">call </span><span class="n">hit_npa_detector</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="w"> </span><span class="p">,</span><span class="n">det</span><span class="p">,</span><span class="w"> </span><span class="n">rf</span><span class="p">,</span><span class="w"> </span><span class="n">det</span><span class="o">=</span><span class="n">ichan</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">if</span><span class="p">(</span><span class="n">det</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">ichan</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                            if</span><span class="w"> </span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="k">                                write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;NPA_MC: Missed Detector &quot;</span><span class="p">,</span><span class="n">ichan</span><span class="w"></span>
<span class="w">                            </span><span class="k">endif</span>
<span class="k">                            cycle </span><span class="n">gyro_range_loop</span><span class="w"></span>
<span class="w">                        </span><span class="k">endif</span><span class="w"></span>

<span class="w">                        </span><span class="c">!! Get beam grid indices at ri</span>
<span class="w">                        </span><span class="k">call </span><span class="n">get_indices</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span><span class="w"></span>

<span class="w">                        </span><span class="c">!! Calculate CX probability with beam and halo neutrals</span>
<span class="w">                        </span><span class="k">call </span><span class="n">get_total_cx_rate</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="w"> </span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="p">,</span><span class="w"> </span><span class="n">neut_types</span><span class="p">,</span><span class="w"> </span><span class="n">rates</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">gyro_range_loop</span><span class="w"></span>

<span class="w">                        </span><span class="c">!! Weight CX rates by ion source density</span>
<span class="w">                        </span><span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">weight</span><span class="o">*</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">delta_phi</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">/</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="o">/</span><span class="n">ngamma</span><span class="w"></span>

<span class="w">                        </span><span class="c">!! Attenuate states as the particle move through plasma</span>
<span class="w">                        </span><span class="k">call </span><span class="n">attenuate</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">states</span><span class="p">)</span><span class="w"></span>

<span class="w">                        </span><span class="c">!! Store NPA Flux</span>
<span class="w">                        </span><span class="n">flux</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dtheta</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="o">*</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="w"></span>
<span class="w">                        </span><span class="n">spread_loop</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">it</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">25</span><span class="w"></span>
<span class="w">                            </span><span class="n">theta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gyrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">it</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">dtheta</span><span class="o">/</span><span class="mi">25</span><span class="w"></span>
<span class="w">                            </span><span class="k">call </span><span class="n">gyro_trajectory</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span><span class="w"> </span><span class="n">theta</span><span class="p">,</span><span class="w"> </span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="p">)</span><span class="w"></span>
<span class="w">                            </span><span class="k">call </span><span class="n">hit_npa_detector</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="w"> </span><span class="p">,</span><span class="n">det</span><span class="p">,</span><span class="w"> </span><span class="n">rf</span><span class="p">,</span><span class="w"> </span><span class="n">det</span><span class="o">=</span><span class="n">ichan</span><span class="p">)</span><span class="w"></span>
<span class="w">                            </span><span class="k">if</span><span class="p">(</span><span class="n">det</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">ichan</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                if</span><span class="w"> </span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="k">                                    write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;NPA_MC: Missed Detector &quot;</span><span class="p">,</span><span class="n">ichan</span><span class="w"></span>
<span class="w">                                </span><span class="k">endif</span>
<span class="k">                                cycle </span><span class="n">spread_loop</span><span class="w"></span>
<span class="w">                            </span><span class="k">endif</span>
<span class="k">                            call </span><span class="n">store_npa</span><span class="p">(</span><span class="n">det</span><span class="p">,</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">flux</span><span class="o">/</span><span class="mi">25</span><span class="p">,</span><span class="n">fast_ion</span><span class="p">%</span><span class="k">class</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">enddo </span><span class="n">spread_loop</span><span class="w"></span>
<span class="w">                    </span><span class="k">enddo </span><span class="n">gyro_range_loop</span><span class="w"></span>
<span class="w">                </span><span class="k">enddo </span><span class="n">detector_loop</span><span class="w"></span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="c">!! Full Orbit</span>
<span class="w">                </span><span class="c">!! Convert to beam grid coordinates</span>
<span class="w">                </span><span class="k">call </span><span class="n">uvw_to_xyz</span><span class="p">(</span><span class="n">uvw</span><span class="p">,</span><span class="w"> </span><span class="n">ri</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Calculate velocity vector</span>
<span class="w">                </span><span class="n">uvw_vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vt</span><span class="w"></span>
<span class="w">                </span><span class="n">uvw_vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vt</span><span class="w"></span>
<span class="w">                </span><span class="n">uvw_vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vz</span><span class="w"></span>
<span class="w">                </span><span class="n">vi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">matmul</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">inv_basis</span><span class="p">,</span><span class="n">uvw_vi</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Check if particle hits a NPA detector</span>
<span class="w">                </span><span class="k">call </span><span class="n">hit_npa_detector</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="w"> </span><span class="p">,</span><span class="n">det</span><span class="p">,</span><span class="w"> </span><span class="n">rf</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="n">det</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">gamma_loop</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Get beam grid indices at ri</span>
<span class="w">                </span><span class="k">call </span><span class="n">get_indices</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Calculate CX probability with beam and halo neutrals</span>
<span class="w">                </span><span class="k">call </span><span class="n">get_total_cx_rate</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="w"> </span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="p">,</span><span class="w"> </span><span class="n">neut_types</span><span class="p">,</span><span class="w"> </span><span class="n">rates</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">gamma_loop</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Weight CX rates by ion source density</span>
<span class="w">                </span><span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">weight</span><span class="o">*</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">delta_phi</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">/</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="o">/</span><span class="n">ngamma</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Attenuate states as the particle moves though plasma</span>
<span class="w">                </span><span class="k">call </span><span class="n">attenuate</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">states</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Store NPA Flux</span>
<span class="w">                </span><span class="n">flux</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="o">*</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="w"></span>
<span class="w">                </span><span class="k">call </span><span class="n">store_npa</span><span class="p">(</span><span class="n">det</span><span class="p">,</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">flux</span><span class="p">,</span><span class="n">fast_ion</span><span class="p">%</span><span class="k">class</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">        enddo </span><span class="n">gamma_loop</span><span class="w"></span>
<span class="w">    </span><span class="k">enddo </span><span class="n">loop_over_fast_ions</span><span class="w"></span>
<span class="w">    </span><span class="c">!$OMP END PARALLEL DO</span>

<span class="w">    </span><span class="n">npart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">npa</span><span class="p">%</span><span class="n">npart</span><span class="w"></span>
<span class="cp">#ifdef _MPI</span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">npart</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">npa</span><span class="p">%</span><span class="n">flux</span><span class="p">)</span><span class="w"></span>
<span class="cp">#endif</span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T4,&quot;Number of Active NPA particles that hit a detector: &quot;,i8)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">npart</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">end subroutine </span><span class="n">npa_mc</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>