<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>npa_mc &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
               
        
        
            </ul>
        
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>



          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>npa_mc
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.7% of total for procedures.">103 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
    
     <li><a href='../module/libfida.html'>libfida</a></li>
    
  
     <li class="active">npa_mc</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/npa_mc.html#src">npa_mc</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine npa_mc()
    
    
   
</h2>
    
  


    
    <p>Calculate Active NPA flux using a Monte Carlo fast-ion distribution</p>
    

    <h3>Arguments</h3>
    
    <em>None</em>
    <br>
    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~npa_mc~~CallsGraph Pages: 1 -->
<svg id="procnpa_mcCallsGraph" width="641pt" height="903pt"
 viewBox="0.00 0.00 641.00 903.13" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~npa_mc~~CallsGraph" class="graph" transform="scale(0.781707 0.781707) rotate(0) translate(4 1151.33)">
<title>proc~~npa_mc~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1151.33 816,-1151.33 816,4 -4,4"/>
<!-- proc~npa_mc -->
<g id="proc~~npa_mc~~CallsGraph_node1" class="node"><title>proc~npa_mc</title>
<polygon fill="none" stroke="black" points="54,-639 0,-639 0,-615 54,-615 54,-639"/>
<text text-anchor="middle" x="27" y="-624.6" font-family="Helvetica,sans-Serif" font-size="10.50">npa_mc</text>
</g>
<!-- proc~get_total_cx_rate -->
<g id="proc~~npa_mc~~CallsGraph_node2" class="node"><title>proc~get_total_cx_rate</title>
<g id="a_proc~~npa_mc~~CallsGraph_node2"><a xlink:href=".././proc/get_total_cx_rate.html" xlink:title="get_total_cx_rate">
<polygon fill="#d9534f" stroke="#d9534f" points="185.5,-823 90.5,-823 90.5,-799 185.5,-799 185.5,-823"/>
<text text-anchor="middle" x="138" y="-808.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_total_cx_rate</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~get_total_cx_rate -->
<g id="proc~~npa_mc~~CallsGraph_edge2" class="edge"><title>proc~npa_mc&#45;&gt;proc~get_total_cx_rate</title>
<path fill="none" stroke="#000000" d="M29.8748,-639.15C34.8448,-667.743 50.7637,-740.239 90,-785 92.6892,-788.068 95.832,-790.847 99.1947,-793.345"/>
<polygon fill="#000000" stroke="#000000" points="97.5814,-796.471 107.874,-798.985 101.396,-790.601 97.5814,-796.471"/>
</g>
<!-- proc~hit_npa_detector -->
<g id="proc~~npa_mc~~CallsGraph_node3" class="node"><title>proc~hit_npa_detector</title>
<g id="a_proc~~npa_mc~~CallsGraph_node3"><a xlink:href=".././proc/hit_npa_detector.html" xlink:title="hit_npa_detector">
<polygon fill="#d9534f" stroke="#d9534f" points="315.5,-659 222.5,-659 222.5,-635 315.5,-635 315.5,-659"/>
<text text-anchor="middle" x="269" y="-644.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hit_npa_detector</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~hit_npa_detector -->
<g id="proc~~npa_mc~~CallsGraph_edge1" class="edge"><title>proc~npa_mc&#45;&gt;proc~hit_npa_detector</title>
<path fill="none" stroke="#000000" d="M54.1411,-629.178C91.876,-632.323 162.531,-638.211 212.278,-642.356"/>
<polygon fill="#000000" stroke="#000000" points="211.988,-645.844 222.244,-643.187 212.569,-638.869 211.988,-645.844"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~npa_mc~~CallsGraph_node4" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~npa_mc~~CallsGraph_node4"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="716,-915 648,-915 648,-891 716,-891 716,-915"/>
<text text-anchor="middle" x="682" y="-900.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_mc~~CallsGraph_edge3" class="edge"><title>proc~npa_mc&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M41.9078,-639.094C72.2435,-664.726 147.617,-724.418 222,-752 337.273,-794.745 376.657,-760.466 496,-790 549.225,-803.172 565.943,-802.249 612,-832 633.197,-845.692 652.775,-867.031 665.619,-882.742"/>
<polygon fill="#000000" stroke="#000000" points="663.067,-885.157 672.03,-890.808 668.547,-880.802 663.067,-885.157"/>
</g>
<!-- proc~store_npa -->
<g id="proc~~npa_mc~~CallsGraph_node5" class="node"><title>proc~store_npa</title>
<g id="a_proc~~npa_mc~~CallsGraph_node5"><a xlink:href=".././proc/store_npa.html" xlink:title="store_npa">
<polygon fill="#d9534f" stroke="#d9534f" points="168.5,-1026 107.5,-1026 107.5,-1002 168.5,-1002 168.5,-1026"/>
<text text-anchor="middle" x="138" y="-1011.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_npa</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~store_npa -->
<g id="proc~~npa_mc~~CallsGraph_edge4" class="edge"><title>proc~npa_mc&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M28.5009,-639.197C30.6718,-682.86 41.4917,-834.787 90,-948 97.2021,-964.809 109.21,-981.566 119.285,-993.989"/>
<polygon fill="#000000" stroke="#000000" points="116.763,-996.429 125.868,-1001.84 122.128,-991.932 116.763,-996.429"/>
</g>
<!-- proc~npa_gyro_range -->
<g id="proc~~npa_mc~~CallsGraph_node6" class="node"><title>proc~npa_gyro_range</title>
<g id="a_proc~~npa_mc~~CallsGraph_node6"><a xlink:href=".././proc/npa_gyro_range.html" xlink:title="npa_gyro_range">
<polygon fill="#d9534f" stroke="#d9534f" points="183.5,-619 92.5,-619 92.5,-595 183.5,-595 183.5,-619"/>
<text text-anchor="middle" x="138" y="-604.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_gyro_range</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~npa_gyro_range -->
<g id="proc~~npa_mc~~CallsGraph_edge5" class="edge"><title>proc~npa_mc&#45;&gt;proc~npa_gyro_range</title>
<path fill="none" stroke="#000000" d="M54.1082,-622.21C62.7052,-620.632 72.6099,-618.815 82.514,-616.997"/>
<polygon fill="#000000" stroke="#000000" points="83.1653,-620.436 92.3695,-615.189 81.902,-613.551 83.1653,-620.436"/>
</g>
<!-- interface~randu -->
<g id="proc~~npa_mc~~CallsGraph_node7" class="node"><title>interface~randu</title>
<g id="a_proc~~npa_mc~~CallsGraph_node7"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="165,-577 111,-577 111,-553 165,-553 165,-577"/>
<text text-anchor="middle" x="138" y="-562.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;interface~randu -->
<g id="proc~~npa_mc~~CallsGraph_edge6" class="edge"><title>proc~npa_mc&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M44.6385,-614.915C56.863,-606.307 74.0515,-594.759 90,-586 93.7013,-583.967 97.6375,-581.969 101.596,-580.063"/>
<polygon fill="#000000" stroke="#000000" points="103.172,-583.19 110.771,-575.807 100.227,-576.84 103.172,-583.19"/>
</g>
<!-- proc~gyro_trajectory -->
<g id="proc~~npa_mc~~CallsGraph_node8" class="node"><title>proc~gyro_trajectory</title>
<g id="a_proc~~npa_mc~~CallsGraph_node8"><a xlink:href=".././proc/gyro_trajectory.html" xlink:title="gyro_trajectory">
<polygon fill="#d9534f" stroke="#d9534f" points="180,-535 96,-535 96,-511 180,-511 180,-535"/>
<text text-anchor="middle" x="138" y="-520.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_trajectory</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~gyro_trajectory -->
<g id="proc~~npa_mc~~CallsGraph_edge7" class="edge"><title>proc~npa_mc&#45;&gt;proc~gyro_trajectory</title>
<path fill="none" stroke="#000000" d="M34.4641,-614.745C44.3374,-597.042 64.7187,-564.224 90,-544 91.5703,-542.744 93.2276,-541.546 94.9445,-540.407"/>
<polygon fill="#000000" stroke="#000000" points="97.0205,-543.248 103.899,-535.189 93.4964,-537.2 97.0205,-543.248"/>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~npa_mc~~CallsGraph_node9" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~npa_mc~~CallsGraph_node9"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="174.5,-277 101.5,-277 101.5,-253 174.5,-253 174.5,-277"/>
<text text-anchor="middle" x="138" y="-262.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;interface~parallel_sum -->
<g id="proc~~npa_mc~~CallsGraph_edge8" class="edge"><title>proc~npa_mc&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M31.6266,-614.956C47.3703,-562.669 109.919,-354.939 130.441,-286.784"/>
<polygon fill="#000000" stroke="#000000" points="133.828,-287.674 133.36,-277.09 127.125,-285.656 133.828,-287.674"/>
</g>
<!-- proc~gyro_surface -->
<g id="proc~~npa_mc~~CallsGraph_node10" class="node"><title>proc~gyro_surface</title>
<g id="a_proc~~npa_mc~~CallsGraph_node10"><a xlink:href=".././proc/gyro_surface.html" xlink:title="gyro_surface">
<polygon fill="#d9534f" stroke="#d9534f" points="175.5,-235 100.5,-235 100.5,-211 175.5,-211 175.5,-235"/>
<text text-anchor="middle" x="138" y="-220.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_surface</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~gyro_surface -->
<g id="proc~~npa_mc~~CallsGraph_edge9" class="edge"><title>proc~npa_mc&#45;&gt;proc~gyro_surface</title>
<path fill="none" stroke="#000000" d="M28.4432,-614.939C30.805,-556.636 43.6009,-304.338 90,-244 90.7968,-242.964 91.6559,-241.978 92.5677,-241.039"/>
<polygon fill="#000000" stroke="#000000" points="94.8164,-243.722 100.427,-234.734 90.4362,-238.262 94.8164,-243.722"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~npa_mc~~CallsGraph_node11" class="node"><title>proc~get_fields</title>
<g id="a_proc~~npa_mc~~CallsGraph_node11"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="298,-1026 240,-1026 240,-1002 298,-1002 298,-1026"/>
<text text-anchor="middle" x="269" y="-1011.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~get_fields -->
<g id="proc~~npa_mc~~CallsGraph_edge10" class="edge"><title>proc~npa_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M28.3354,-639.143C29.9127,-677.018 38.8958,-795.164 90,-874 126.804,-930.775 194.566,-974.485 235.031,-997.038"/>
<polygon fill="#000000" stroke="#000000" points="233.509,-1000.19 243.963,-1001.92 236.866,-994.052 233.509,-1000.19"/>
</g>
<!-- proc~attenuate -->
<g id="proc~~npa_mc~~CallsGraph_node12" class="node"><title>proc~attenuate</title>
<g id="a_proc~~npa_mc~~CallsGraph_node12"><a xlink:href=".././proc/attenuate.html" xlink:title="attenuate">
<polygon fill="#d9534f" stroke="#d9534f" points="167,-865 109,-865 109,-841 167,-841 167,-865"/>
<text text-anchor="middle" x="138" y="-850.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">attenuate</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~attenuate -->
<g id="proc~~npa_mc~~CallsGraph_edge11" class="edge"><title>proc~npa_mc&#45;&gt;proc~attenuate</title>
<path fill="none" stroke="#000000" d="M28.3079,-639.296C29.8146,-673.952 38.6332,-773.686 90,-832 92.7137,-835.081 95.9669,-837.732 99.4786,-840.009"/>
<polygon fill="#000000" stroke="#000000" points="98.1187,-843.252 108.58,-844.928 101.447,-837.094 98.1187,-843.252"/>
</g>
<!-- proc~get_indices -->
<g id="proc~~npa_mc~~CallsGraph_node13" class="node"><title>proc~get_indices</title>
<g id="a_proc~~npa_mc~~CallsGraph_node13"><a xlink:href=".././proc/get_indices.html" xlink:title="get_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="171.5,-193 104.5,-193 104.5,-169 171.5,-169 171.5,-193"/>
<text text-anchor="middle" x="138" y="-178.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_indices</text>
</a>
</g>
</g>
<!-- proc~npa_mc&#45;&gt;proc~get_indices -->
<g id="proc~~npa_mc~~CallsGraph_edge12" class="edge"><title>proc~npa_mc&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M28.2313,-614.885C29.6412,-552.699 38.8224,-269.639 90,-202 91.6043,-199.88 93.4704,-197.969 95.5159,-196.247"/>
<polygon fill="#000000" stroke="#000000" points="97.7472,-198.965 104.12,-190.501 93.8596,-193.144 97.7472,-198.965"/>
</g>
<!-- proc~neutral_cx_rate -->
<g id="proc~~npa_mc~~CallsGraph_node17" class="node"><title>proc~neutral_cx_rate</title>
<g id="a_proc~~npa_mc~~CallsGraph_node17"><a xlink:href=".././proc/neutral_cx_rate.html" xlink:title="neutral_cx_rate">
<polygon fill="#d9534f" stroke="#d9534f" points="312.5,-844 225.5,-844 225.5,-820 312.5,-820 312.5,-844"/>
<text text-anchor="middle" x="269" y="-829.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neutral_cx_rate</text>
</a>
</g>
</g>
<!-- proc~get_total_cx_rate&#45;&gt;proc~neutral_cx_rate -->
<g id="proc~~npa_mc~~CallsGraph_edge13" class="edge"><title>proc~get_total_cx_rate&#45;&gt;proc~neutral_cx_rate</title>
<path fill="none" stroke="#000000" d="M185.572,-818.581C195.213,-820.151 205.435,-821.815 215.278,-823.417"/>
<polygon fill="#000000" stroke="#000000" points="214.926,-826.906 225.358,-825.058 216.051,-819.997 214.926,-826.906"/>
</g>
<!-- proc~line_plane_intersect -->
<g id="proc~~npa_mc~~CallsGraph_node19" class="node"><title>proc~line_plane_intersect</title>
<g id="a_proc~~npa_mc~~CallsGraph_node19"><a xlink:href=".././proc/line_plane_intersect.html" xlink:title="line_plane_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="478,-617 370,-617 370,-593 478,-593 478,-617"/>
<text text-anchor="middle" x="424" y="-602.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">line_plane_intersect</text>
</a>
</g>
</g>
<!-- proc~hit_npa_detector&#45;&gt;proc~line_plane_intersect -->
<g id="proc~~npa_mc~~CallsGraph_edge15" class="edge"><title>proc~hit_npa_detector&#45;&gt;proc~line_plane_intersect</title>
<path fill="none" stroke="#000000" d="M313.844,-634.964C331.129,-630.219 351.153,-624.723 369.294,-619.743"/>
<polygon fill="#000000" stroke="#000000" points="370.433,-623.06 379.15,-617.037 368.58,-616.309 370.433,-623.06"/>
</g>
<!-- proc~in_boundary -->
<g id="proc~~npa_mc~~CallsGraph_node31" class="node"><title>proc~in_boundary</title>
<g id="a_proc~~npa_mc~~CallsGraph_node31"><a xlink:href=".././proc/in_boundary.html" xlink:title="in_boundary">
<polygon fill="#d94e8f" stroke="#d94e8f" points="460,-659 388,-659 388,-635 460,-635 460,-659"/>
<text text-anchor="middle" x="424" y="-644.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_boundary</text>
</a>
</g>
</g>
<!-- proc~hit_npa_detector&#45;&gt;proc~in_boundary -->
<g id="proc~~npa_mc~~CallsGraph_edge14" class="edge"><title>proc~hit_npa_detector&#45;&gt;proc~in_boundary</title>
<path fill="none" stroke="#000000" d="M315.905,-647C335.453,-647 358.193,-647 377.677,-647"/>
<polygon fill="#000000" stroke="#000000" points="377.83,-650.5 387.83,-647 377.83,-643.5 377.83,-650.5"/>
</g>
<!-- proc~store_npa&#45;&gt;proc~get_fields -->
<g id="proc~~npa_mc~~CallsGraph_edge16" class="edge"><title>proc~store_npa&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M168.595,-1014C186.754,-1014 210.196,-1014 229.754,-1014"/>
<polygon fill="#000000" stroke="#000000" points="229.87,-1017.5 239.87,-1014 229.87,-1010.5 229.87,-1017.5"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~npa_mc~~CallsGraph_node21" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~npa_mc~~CallsGraph_node21"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="606,-1125 538,-1125 538,-1101 606,-1101 606,-1125"/>
<text text-anchor="middle" x="572" y="-1110.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~store_npa&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_mc~~CallsGraph_edge17" class="edge"><title>proc~store_npa&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M153.521,-1026.11C186.322,-1052.57 269.713,-1114.95 352,-1137 413.819,-1153.57 432.766,-1146.87 496,-1137 507.597,-1135.19 519.85,-1131.89 531.015,-1128.31"/>
<polygon fill="#000000" stroke="#000000" points="532.14,-1131.63 540.504,-1125.12 529.91,-1124.99 532.14,-1131.63"/>
</g>
<!-- proc~gyro_range -->
<g id="proc~~npa_mc~~CallsGraph_node25" class="node"><title>proc~gyro_range</title>
<g id="a_proc~~npa_mc~~CallsGraph_node25"><a xlink:href=".././proc/gyro_range.html" xlink:title="gyro_range">
<polygon fill="#d9534f" stroke="#d9534f" points="302.5,-575 235.5,-575 235.5,-551 302.5,-551 302.5,-575"/>
<text text-anchor="middle" x="269" y="-560.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_range</text>
</a>
</g>
</g>
<!-- proc~npa_gyro_range&#45;&gt;proc~gyro_range -->
<g id="proc~~npa_mc~~CallsGraph_edge18" class="edge"><title>proc~npa_gyro_range&#45;&gt;proc~gyro_range</title>
<path fill="none" stroke="#000000" d="M174.25,-594.977C190.214,-589.532 209.211,-583.052 225.917,-577.354"/>
<polygon fill="#000000" stroke="#000000" points="227.113,-580.644 235.448,-574.103 224.853,-574.019 227.113,-580.644"/>
</g>
<!-- proc~approx_eq -->
<g id="proc~~npa_mc~~CallsGraph_node26" class="node"><title>proc~approx_eq</title>
<g id="a_proc~~npa_mc~~CallsGraph_node26"><a xlink:href=".././proc/approx_eq.html" xlink:title="approx_eq">
<polygon fill="#d94e8f" stroke="#d94e8f" points="301,-617 237,-617 237,-593 301,-593 301,-617"/>
<text text-anchor="middle" x="269" y="-602.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_eq</text>
</a>
</g>
</g>
<!-- proc~npa_gyro_range&#45;&gt;proc~approx_eq -->
<g id="proc~~npa_mc~~CallsGraph_edge19" class="edge"><title>proc~npa_gyro_range&#45;&gt;proc~approx_eq</title>
<path fill="none" stroke="#000000" d="M183.756,-606.306C197.673,-606.09 212.948,-605.854 226.624,-605.641"/>
<polygon fill="#000000" stroke="#000000" points="226.777,-609.14 236.721,-605.485 226.668,-602.14 226.777,-609.14"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~npa_mc~~CallsGraph_node14" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~npa_mc~~CallsGraph_node14"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="469.5,-313 378.5,-313 378.5,-289 469.5,-289 469.5,-313"/>
<text text-anchor="middle" x="424" y="-298.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_mc~~CallsGraph_edge22" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.667,-275.467C189.226,-279.361 206.302,-283.448 222,-286 271.09,-293.98 327.627,-297.723 368.21,-299.473"/>
<polygon fill="#000000" stroke="#000000" points="368.297,-302.98 378.43,-299.887 368.58,-295.985 368.297,-302.98"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~npa_mc~~CallsGraph_node15" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~npa_mc~~CallsGraph_node15"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-277 223.5,-277 223.5,-253 314.5,-253 314.5,-277"/>
<text text-anchor="middle" x="269" y="-262.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~npa_mc~~CallsGraph_edge23" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.591,-265C186.478,-265 200.017,-265 213.026,-265"/>
<polygon fill="#000000" stroke="#000000" points="213.305,-268.5 223.305,-265 213.305,-261.5 213.305,-268.5"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~npa_mc~~CallsGraph_node16" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~npa_mc~~CallsGraph_node16"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-235 223.5,-235 223.5,-211 314.5,-211 314.5,-235"/>
<text text-anchor="middle" x="269" y="-220.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~npa_mc~~CallsGraph_edge26" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.591,-253.412C188.907,-248.751 205.617,-243.311 220.915,-238.33"/>
<polygon fill="#000000" stroke="#000000" points="222.299,-241.56 230.724,-235.136 220.132,-234.904 222.299,-241.56"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~npa_mc~~CallsGraph_node18" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~npa_mc~~CallsGraph_node18"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-139 380,-139 380,-115 468,-115 468,-139"/>
<text text-anchor="middle" x="424" y="-124.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~npa_mc~~CallsGraph_edge21" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.283,-252.832C178.565,-250.361 182.614,-247.439 186,-244 214.5,-215.06 190.02,-185.042 222,-160 263.757,-127.302 325.574,-121.59 369.615,-122.467"/>
<polygon fill="#000000" stroke="#000000" points="369.738,-125.973 379.845,-122.794 369.962,-118.976 369.738,-125.973"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~npa_mc~~CallsGraph_node22" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~npa_mc~~CallsGraph_node22"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-69 225,-69 225,-45 313,-45 313,-69"/>
<text text-anchor="middle" x="269" y="-54.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~npa_mc~~CallsGraph_edge28" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.917,-253.399C179.1,-250.84 182.953,-247.742 186,-244 233.117,-186.131 176.151,-138.879 222,-80 223.382,-78.2256 224.937,-76.5777 226.618,-75.0486"/>
<polygon fill="#000000" stroke="#000000" points="228.709,-77.8555 234.647,-69.0813 224.533,-72.2372 228.709,-77.8555"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~npa_mc~~CallsGraph_node23" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~npa_mc~~CallsGraph_node23"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-193 225,-193 225,-169 313,-169 313,-193"/>
<text text-anchor="middle" x="269" y="-178.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~npa_mc~~CallsGraph_edge29" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M171.415,-252.809C176.513,-250.255 181.559,-247.314 186,-244 205.702,-229.294 202.357,-216.785 222,-202 223.824,-200.627 225.751,-199.317 227.743,-198.07"/>
<polygon fill="#000000" stroke="#000000" points="229.749,-200.958 236.763,-193.017 226.328,-194.851 229.749,-200.958"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~npa_mc~~CallsGraph_node24" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~npa_mc~~CallsGraph_node24"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-24 223.5,-24 223.5,-0 314.5,-0 314.5,-24"/>
<text text-anchor="middle" x="269" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~npa_mc~~CallsGraph_edge24" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.611,-253.809C178.95,-251.178 182.928,-247.951 186,-244 243.595,-169.941 166.678,-111.773 222,-36 223.534,-33.8993 225.307,-31.9672 227.245,-30.1923"/>
<polygon fill="#000000" stroke="#000000" points="229.477,-32.894 235.389,-24.1022 225.285,-27.2882 229.477,-32.894"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~npa_mc~~CallsGraph_node27" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~npa_mc~~CallsGraph_node27"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-113 225,-113 225,-89 313,-89 313,-113"/>
<text text-anchor="middle" x="269" y="-98.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~npa_mc~~CallsGraph_edge25" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.634,-253.159C178.861,-250.637 182.801,-247.614 186,-244 222.06,-203.261 187.899,-169.393 222,-127 224.383,-124.038 227.199,-121.354 230.247,-118.935"/>
<polygon fill="#000000" stroke="#000000" points="232.436,-121.678 238.714,-113.143 228.484,-115.9 232.436,-121.678"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~npa_mc~~CallsGraph_node29" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~npa_mc~~CallsGraph_node29"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-399 223.5,-399 223.5,-375 314.5,-375 314.5,-399"/>
<text text-anchor="middle" x="269" y="-384.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~npa_mc~~CallsGraph_edge20" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M146.298,-277.087C159.269,-297.711 188.177,-339.988 222,-366 223.753,-367.348 225.606,-368.634 227.523,-369.857"/>
<polygon fill="#000000" stroke="#000000" points="225.8,-372.904 236.221,-374.815 229.266,-366.822 225.8,-372.904"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~npa_mc~~CallsGraph_node33" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~npa_mc~~CallsGraph_node33"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-357 223.5,-357 223.5,-333 314.5,-333 314.5,-357"/>
<text text-anchor="middle" x="269" y="-342.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~npa_mc~~CallsGraph_edge27" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M156.928,-277.127C173.6,-288.293 199.223,-305.172 222,-319 226.803,-321.916 231.941,-324.925 236.978,-327.815"/>
<polygon fill="#000000" stroke="#000000" points="235.419,-330.955 245.844,-332.845 238.873,-324.866 235.419,-330.955"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_mc~~CallsGraph_edge30" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M298.185,-1014.16C341.298,-1013.87 425.99,-1011.17 496,-996 549.587,-984.386 563.671,-979.899 612,-954 628.91,-944.938 646.269,-932.086 659.345,-921.551"/>
<polygon fill="#000000" stroke="#000000" points="661.776,-924.084 667.272,-915.026 657.327,-918.679 661.776,-924.084"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~npa_mc~~CallsGraph_node20" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~npa_mc~~CallsGraph_node20"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="454.5,-987 393.5,-987 393.5,-963 454.5,-963 454.5,-987"/>
<text text-anchor="middle" x="424" y="-972.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~npa_mc~~CallsGraph_edge31" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M298.063,-1006.85C322.006,-1000.74 356.703,-991.899 383.46,-985.079"/>
<polygon fill="#000000" stroke="#000000" points="384.462,-988.435 393.287,-982.574 382.733,-981.652 384.462,-988.435"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_mc~~CallsGraph_edge33" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M275.507,-1026.17C286.393,-1048.53 313.035,-1095.56 352,-1114 408.234,-1140.61 482.05,-1132.8 528,-1123.69"/>
<polygon fill="#000000" stroke="#000000" points="528.854,-1127.09 537.927,-1121.62 527.423,-1120.24 528.854,-1127.09"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~npa_mc~~CallsGraph_node28" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~npa_mc~~CallsGraph_node28"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="474,-1105 374,-1105 374,-1081 474,-1081 474,-1105"/>
<text text-anchor="middle" x="424" y="-1090.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~npa_mc~~CallsGraph_edge32" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M286.312,-1026.1C302.413,-1037.66 328.03,-1055.05 352,-1067 359.434,-1070.71 367.53,-1074.17 375.507,-1077.28"/>
<polygon fill="#000000" stroke="#000000" points="374.534,-1080.65 385.126,-1080.9 376.997,-1074.1 374.534,-1080.65"/>
</g>
<!-- proc~get_position -->
<g id="proc~~npa_mc~~CallsGraph_node34" class="node"><title>proc~get_position</title>
<g id="a_proc~~npa_mc~~CallsGraph_node34"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="459,-945 389,-945 389,-921 459,-921 459,-945"/>
<text text-anchor="middle" x="424" y="-930.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~npa_mc~~CallsGraph_edge34" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M283.548,-1001.78C299.069,-988.362 325.756,-966.99 352,-954 360.46,-949.812 369.909,-946.299 379.083,-943.418"/>
<polygon fill="#000000" stroke="#000000" points="380.266,-946.719 388.871,-940.538 378.29,-940.003 380.266,-946.719"/>
</g>
<!-- proc~colrad -->
<g id="proc~~npa_mc~~CallsGraph_node30" class="node"><title>proc~colrad</title>
<g id="a_proc~~npa_mc~~CallsGraph_node30"><a xlink:href=".././proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="296,-743 242,-743 242,-719 296,-719 296,-743"/>
<text text-anchor="middle" x="269" y="-728.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~attenuate&#45;&gt;proc~colrad -->
<g id="proc~~npa_mc~~CallsGraph_edge35" class="edge"><title>proc~attenuate&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M167.056,-843.043C173.611,-840.036 180.328,-836.353 186,-832 215.476,-809.381 240.929,-774.128 255.358,-751.816"/>
<polygon fill="#000000" stroke="#000000" points="258.469,-753.446 260.847,-743.121 252.549,-749.709 258.469,-753.446"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~npa_mc~~CallsGraph_node32" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~npa_mc~~CallsGraph_node32"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-945 235,-945 235,-921 303,-921 303,-945"/>
<text text-anchor="middle" x="269" y="-930.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~attenuate&#45;&gt;proc~get_plasma -->
<g id="proc~~npa_mc~~CallsGraph_edge36" class="edge"><title>proc~attenuate&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M158.592,-865.15C180.312,-878.62 215.519,-900.454 240.111,-915.704"/>
<polygon fill="#000000" stroke="#000000" points="238.303,-918.702 248.646,-920.998 241.992,-912.753 238.303,-918.702"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_mc~~CallsGraph_edge38" class="edge"><title>proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M399.529,-313.014C390.984,-321.972 399.141,-331 424,-331 439.149,-331 448.095,-327.647 450.839,-323.001"/>
<polygon fill="#000000" stroke="#000000" points="454.184,-321.936 448.471,-313.014 447.373,-323.552 454.184,-321.936"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_node43" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="611.5,-216 532.5,-216 532.5,-192 611.5,-192 611.5,-216"/>
<text text-anchor="middle" x="572" y="-201.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge37" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M466.873,-288.871C476.791,-285.142 487.072,-280.529 496,-275 518.586,-261.012 540.152,-239.431 554.312,-223.732"/>
<polygon fill="#000000" stroke="#000000" points="557.025,-225.948 561.008,-216.131 551.772,-221.321 557.025,-225.948"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_mc~~CallsGraph_edge40" class="edge"><title>proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M314.665,-275.509C331.402,-279.448 350.614,-283.968 368.167,-288.098"/>
<polygon fill="#000000" stroke="#000000" points="367.743,-291.594 378.279,-290.477 369.347,-284.78 367.743,-291.594"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge39" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.514,-259.271C360.344,-252.964 433.66,-241.733 496,-227 505.542,-224.745 515.649,-221.939 525.247,-219.071"/>
<polygon fill="#000000" stroke="#000000" points="526.484,-222.353 535.022,-216.08 524.435,-215.659 526.484,-222.353"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_mc~~CallsGraph_edge42" class="edge"><title>proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M297.373,-235.163C303.534,-237.993 310.018,-241.045 316,-244 341.972,-256.831 370.945,-272.341 392.185,-283.941"/>
<polygon fill="#000000" stroke="#000000" points="390.621,-287.074 401.072,-288.812 393.986,-280.936 390.621,-287.074"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge41" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.738,-220.176C370.24,-216.673 464.546,-210.72 521.967,-207.095"/>
<polygon fill="#000000" stroke="#000000" points="522.482,-210.57 532.242,-206.447 522.041,-203.584 522.482,-210.57"/>
</g>
<!-- proc~bb_cx_rates -->
<g id="proc~~npa_mc~~CallsGraph_node37" class="node"><title>proc~bb_cx_rates</title>
<g id="a_proc~~npa_mc~~CallsGraph_node37"><a xlink:href=".././proc/bb_cx_rates.html" xlink:title="bb_cx_rates">
<polygon fill="#d9534f" stroke="#d9534f" points="459.5,-865 388.5,-865 388.5,-841 459.5,-841 459.5,-865"/>
<text text-anchor="middle" x="424" y="-850.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bb_cx_rates</text>
</a>
</g>
</g>
<!-- proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates -->
<g id="proc~~npa_mc~~CallsGraph_edge43" class="edge"><title>proc~neutral_cx_rate&#45;&gt;proc~bb_cx_rates</title>
<path fill="none" stroke="#000000" d="M312.619,-837.85C333.042,-840.653 357.503,-844.01 378.201,-846.851"/>
<polygon fill="#000000" stroke="#000000" points="377.95,-850.349 388.333,-848.242 378.902,-843.414 377.95,-850.349"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~npa_mc~~CallsGraph_edge45" class="edge"><title>proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M399.529,-139.014C390.984,-147.972 399.141,-157 424,-157 439.149,-157 448.095,-153.647 450.839,-149.001"/>
<polygon fill="#000000" stroke="#000000" points="454.184,-147.936 448.471,-139.014 447.373,-149.552 454.184,-147.936"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge44" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M447.812,-139.031C472.311,-151.952 511.426,-172.581 538.996,-187.121"/>
<polygon fill="#000000" stroke="#000000" points="537.388,-190.23 547.866,-191.799 540.653,-184.038 537.388,-190.23"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_mc~~CallsGraph_edge46" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M454.734,-981.383C468.325,-985.373 484.026,-991.593 496,-1001 527.054,-1025.4 549.756,-1066.29 561.624,-1091.34"/>
<polygon fill="#000000" stroke="#000000" points="558.565,-1093.07 565.906,-1100.7 564.931,-1090.15 558.565,-1093.07"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~npa_mc~~CallsGraph_node40" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~npa_mc~~CallsGraph_node40"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="610.5,-865 533.5,-865 533.5,-841 610.5,-841 610.5,-865"/>
<text text-anchor="middle" x="572" y="-850.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_mc~~CallsGraph_edge47" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M454.511,-970.69C468.053,-967.652 483.777,-962.54 496,-954 511.695,-943.035 541.071,-899.715 558.026,-873.501"/>
<polygon fill="#000000" stroke="#000000" points="561.011,-875.331 563.463,-865.024 555.118,-871.552 561.011,-875.331"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~npa_mc~~CallsGraph_node46" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~npa_mc~~CallsGraph_node46"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="714.5,-976 649.5,-976 649.5,-952 714.5,-952 714.5,-976"/>
<text text-anchor="middle" x="682" y="-961.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~npa_mc~~CallsGraph_edge48" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M454.617,-973.727C500.052,-971.775 587.135,-968.033 639.048,-965.803"/>
<polygon fill="#000000" stroke="#000000" points="639.411,-969.29 649.252,-965.364 639.111,-962.297 639.411,-969.29"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge49" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M313.208,-50.5939C361.6,-45.7214 440.509,-44.8902 496,-80 533.492,-103.722 554.92,-153.601 564.625,-182.345"/>
<polygon fill="#000000" stroke="#000000" points="561.298,-183.432 567.678,-191.891 567.965,-181.3 561.298,-183.432"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~npa_mc~~CallsGraph_edge51" class="edge"><title>proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M304.336,-168.881C326.483,-161.065 355.485,-150.829 379.274,-142.433"/>
<polygon fill="#000000" stroke="#000000" points="380.513,-145.707 388.778,-139.078 378.184,-139.106 380.513,-145.707"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge50" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M313.126,-184.295C368.485,-188.525 464.288,-195.846 522.241,-200.274"/>
<polygon fill="#000000" stroke="#000000" points="522.016,-203.767 532.254,-201.039 522.549,-196.788 522.016,-203.767"/>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge52" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.544,-6.58549C363.78,-3.05085 443.102,-4.89732 496,-44 541.634,-77.7331 560.479,-146.256 567.422,-181.679"/>
<polygon fill="#000000" stroke="#000000" points="564.053,-182.714 569.278,-191.931 570.941,-181.467 564.053,-182.714"/>
</g>
<!-- proc~gyro_range&#45;&gt;proc~line_plane_intersect -->
<g id="proc~~npa_mc~~CallsGraph_edge53" class="edge"><title>proc~gyro_range&#45;&gt;proc~line_plane_intersect</title>
<path fill="none" stroke="#000000" d="M302.822,-572.01C322.25,-577.343 347.33,-584.228 369.548,-590.327"/>
<polygon fill="#000000" stroke="#000000" points="368.627,-593.703 379.196,-592.975 370.48,-586.953 368.627,-593.703"/>
</g>
<!-- proc~gyro_range&#45;&gt;proc~in_boundary -->
<g id="proc~~npa_mc~~CallsGraph_edge57" class="edge"><title>proc~gyro_range&#45;&gt;proc~in_boundary</title>
<path fill="none" stroke="#000000" d="M301.237,-575.017C306.391,-577.619 311.511,-580.621 316,-584 335.643,-598.785 331.366,-612.632 352,-626 359.843,-631.081 368.958,-634.97 377.99,-637.934"/>
<polygon fill="#000000" stroke="#000000" points="377.111,-641.324 387.693,-640.8 379.094,-634.611 377.111,-641.324"/>
</g>
<!-- proc~boundary_edge -->
<g id="proc~~npa_mc~~CallsGraph_node35" class="node"><title>proc~boundary_edge</title>
<g id="a_proc~~npa_mc~~CallsGraph_node35"><a xlink:href=".././proc/boundary_edge.html" xlink:title="boundary_edge">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-449 380,-449 380,-425 468,-425 468,-449"/>
<text text-anchor="middle" x="424" y="-434.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boundary_edge</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~boundary_edge -->
<g id="proc~~npa_mc~~CallsGraph_edge54" class="edge"><title>proc~gyro_range&#45;&gt;proc~boundary_edge</title>
<path fill="none" stroke="#000000" d="M276.112,-550.938C287.809,-529.073 315.481,-482.86 352,-458 357.569,-454.209 363.833,-451.09 370.274,-448.527"/>
<polygon fill="#000000" stroke="#000000" points="371.524,-451.798 379.778,-445.156 369.183,-445.201 371.524,-451.798"/>
</g>
<!-- proc~in_gyro_surface -->
<g id="proc~~npa_mc~~CallsGraph_node36" class="node"><title>proc~in_gyro_surface</title>
<g id="a_proc~~npa_mc~~CallsGraph_node36"><a xlink:href=".././proc/in_gyro_surface.html" xlink:title="in_gyro_surface">
<polygon fill="#d94e8f" stroke="#d94e8f" points="468.5,-575 379.5,-575 379.5,-551 468.5,-551 468.5,-575"/>
<text text-anchor="middle" x="424" y="-560.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_gyro_surface</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~in_gyro_surface -->
<g id="proc~~npa_mc~~CallsGraph_edge55" class="edge"><title>proc~gyro_range&#45;&gt;proc~in_gyro_surface</title>
<path fill="none" stroke="#000000" d="M302.822,-563C322.152,-563 347.076,-563 369.21,-563"/>
<polygon fill="#000000" stroke="#000000" points="369.483,-566.5 379.483,-563 369.483,-559.5 369.483,-566.5"/>
</g>
<!-- proc~line_gyro_surface_intersect -->
<g id="proc~~npa_mc~~CallsGraph_node38" class="node"><title>proc~line_gyro_surface_intersect</title>
<g id="a_proc~~npa_mc~~CallsGraph_node38"><a xlink:href=".././proc/line_gyro_surface_intersect.html" xlink:title="line_gyro_surface_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="496,-533 352,-533 352,-509 496,-509 496,-533"/>
<text text-anchor="middle" x="424" y="-518.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">line_gyro_surface_intersect</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~line_gyro_surface_intersect -->
<g id="proc~~npa_mc~~CallsGraph_edge56" class="edge"><title>proc~gyro_range&#45;&gt;proc~line_gyro_surface_intersect</title>
<path fill="none" stroke="#000000" d="M302.822,-553.99C322.25,-548.657 347.33,-541.772 369.548,-535.673"/>
<polygon fill="#000000" stroke="#000000" points="370.48,-539.047 379.196,-533.025 368.627,-532.297 370.48,-539.047"/>
</g>
<!-- proc~gyro_surface_coordinates -->
<g id="proc~~npa_mc~~CallsGraph_node41" class="node"><title>proc~gyro_surface_coordinates</title>
<g id="a_proc~~npa_mc~~CallsGraph_node41"><a xlink:href=".././proc/gyro_surface_coordinates.html" xlink:title="gyro_surface_coordinates">
<polygon fill="#d9534f" stroke="#d9534f" points="492,-491 356,-491 356,-467 492,-467 492,-491"/>
<text text-anchor="middle" x="424" y="-476.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_surface_coordinates</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~gyro_surface_coordinates -->
<g id="proc~~npa_mc~~CallsGraph_edge58" class="edge"><title>proc~gyro_range&#45;&gt;proc~gyro_surface_coordinates</title>
<path fill="none" stroke="#000000" d="M282.609,-550.891C297.891,-536.82 324.968,-513.777 352,-500 355.801,-498.063 359.809,-496.275 363.908,-494.63"/>
<polygon fill="#000000" stroke="#000000" points="365.417,-497.804 373.58,-491.05 362.986,-491.24 365.417,-497.804"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~npa_mc~~CallsGraph_edge60" class="edge"><title>proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M313.026,-108.312C330.626,-111.302 351.17,-114.794 369.707,-117.944"/>
<polygon fill="#000000" stroke="#000000" points="369.322,-121.428 379.767,-119.653 370.494,-114.527 369.322,-121.428"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge59" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M313.05,-91.4076C360.599,-83.1188 438.087,-76.5932 496,-106 527.926,-122.211 550.132,-159.023 561.702,-182.628"/>
<polygon fill="#000000" stroke="#000000" points="558.601,-184.261 566.007,-191.838 564.943,-181.297 558.601,-184.261"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_mc~~CallsGraph_edge62" class="edge"><title>proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M297.986,-374.86C303.994,-372.078 310.259,-369.041 316,-366 343.899,-351.223 374.585,-332.29 395.914,-318.673"/>
<polygon fill="#000000" stroke="#000000" points="397.926,-321.541 404.447,-313.191 394.142,-315.652 397.926,-321.541"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge61" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.791,-395.088C363.882,-401.378 442.731,-403.623 496,-366 543.031,-332.782 561.299,-262.46 567.783,-226.381"/>
<polygon fill="#000000" stroke="#000000" points="571.261,-226.799 569.435,-216.363 564.354,-225.66 571.261,-226.799"/>
</g>
<!-- proc~linsolve -->
<g id="proc~~npa_mc~~CallsGraph_node39" class="node"><title>proc~linsolve</title>
<g id="a_proc~~npa_mc~~CallsGraph_node39"><a xlink:href=".././proc/linsolve.html" xlink:title="linsolve">
<polygon fill="#d9534f" stroke="#d9534f" points="451,-701 397,-701 397,-677 451,-677 451,-701"/>
<text text-anchor="middle" x="424" y="-686.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linsolve</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~linsolve -->
<g id="proc~~npa_mc~~CallsGraph_edge63" class="edge"><title>proc~colrad&#45;&gt;proc~linsolve</title>
<path fill="none" stroke="#000000" d="M296.302,-723.78C321.337,-716.908 359.213,-706.51 387.034,-698.873"/>
<polygon fill="#000000" stroke="#000000" points="388.069,-702.218 396.786,-696.196 386.216,-695.468 388.069,-702.218"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~npa_mc~~CallsGraph_node42" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~npa_mc~~CallsGraph_node42"><a xlink:href=".././proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-823 380,-823 380,-799 468,-799 468,-823"/>
<text text-anchor="middle" x="424" y="-808.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~npa_mc~~CallsGraph_edge65" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M293.237,-743.15C319.337,-756.797 361.857,-779.03 391.067,-794.303"/>
<polygon fill="#000000" stroke="#000000" points="389.562,-797.465 400.045,-798.998 392.805,-791.262 389.562,-797.465"/>
</g>
<!-- proc~eigen -->
<g id="proc~~npa_mc~~CallsGraph_node45" class="node"><title>proc~eigen</title>
<g id="a_proc~~npa_mc~~CallsGraph_node45"><a xlink:href=".././proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="451,-743 397,-743 397,-719 451,-719 451,-743"/>
<text text-anchor="middle" x="424" y="-728.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~npa_mc~~CallsGraph_edge64" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M296.302,-731C321.227,-731 358.881,-731 386.667,-731"/>
<polygon fill="#000000" stroke="#000000" points="386.786,-734.5 396.786,-731 386.786,-727.5 386.786,-734.5"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_mc~~CallsGraph_edge68" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M303.175,-922.707C317.967,-918.586 335.7,-914.281 352,-912 453.579,-897.786 574.467,-899.08 637.64,-901.123"/>
<polygon fill="#000000" stroke="#000000" points="637.526,-904.621 647.641,-901.469 637.768,-897.625 637.526,-904.621"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~npa_mc~~CallsGraph_edge66" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M303.199,-942.113C326.836,-948.602 358.696,-957.348 383.619,-964.19"/>
<polygon fill="#000000" stroke="#000000" points="382.916,-967.626 393.486,-966.898 384.769,-960.876 382.916,-967.626"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_mc~~CallsGraph_edge67" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M284.266,-945.159C300.21,-958.458 327.067,-980.006 352,-996 412.911,-1035.07 432.249,-1037.75 496,-1072 510.551,-1079.82 526.628,-1088.59 540.153,-1096"/>
<polygon fill="#000000" stroke="#000000" points="538.608,-1099.15 549.058,-1100.9 541.978,-1093.01 538.608,-1099.15"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~npa_mc~~CallsGraph_edge69" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M303.199,-933C325.248,-933 354.452,-933 378.506,-933"/>
<polygon fill="#000000" stroke="#000000" points="378.807,-936.5 388.807,-933 378.807,-929.5 378.807,-936.5"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~npa_mc~~CallsGraph_edge71" class="edge"><title>proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M311.808,-332.977C330.276,-327.666 352.167,-321.37 371.62,-315.776"/>
<polygon fill="#000000" stroke="#000000" points="372.599,-319.136 381.243,-313.009 370.665,-312.409 372.599,-319.136"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~npa_mc~~CallsGraph_edge70" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.811,-356.356C363.207,-365.969 440.776,-373.44 496,-340 537.47,-314.889 557.684,-257.964 566.044,-226.3"/>
<polygon fill="#000000" stroke="#000000" points="569.527,-226.795 568.522,-216.248 562.73,-225.12 569.527,-226.795"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~npa_mc~~CallsGraph_node44" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~npa_mc~~CallsGraph_node44"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="603,-945 541,-945 541,-921 603,-921 603,-945"/>
<text text-anchor="middle" x="572" y="-930.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~npa_mc~~CallsGraph_edge72" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M459.231,-933C480.622,-933 508.271,-933 530.716,-933"/>
<polygon fill="#000000" stroke="#000000" points="530.944,-936.5 540.944,-933 530.944,-929.5 530.944,-936.5"/>
</g>
<!-- proc~bb_cx_rates&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_mc~~CallsGraph_edge73" class="edge"><title>proc~bb_cx_rates&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M459.6,-853C478.572,-853 502.381,-853 523.114,-853"/>
<polygon fill="#000000" stroke="#000000" points="523.32,-856.5 533.32,-853 523.32,-849.5 523.32,-856.5"/>
</g>
<!-- proc~matinv -->
<g id="proc~~npa_mc~~CallsGraph_node47" class="node"><title>proc~matinv</title>
<g id="a_proc~~npa_mc~~CallsGraph_node47"><a xlink:href=".././proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-491 545,-491 545,-467 599,-467 599,-491"/>
<text text-anchor="middle" x="572" y="-476.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~linsolve&#45;&gt;proc~matinv -->
<g id="proc~~npa_mc~~CallsGraph_edge74" class="edge"><title>proc~linsolve&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M451.067,-687.705C466.233,-685.563 484.557,-680.354 496,-668 547.892,-611.979 486.154,-561.068 532,-500 533.35,-498.201 534.901,-496.539 536.59,-495.006"/>
<polygon fill="#000000" stroke="#000000" points="538.671,-497.82 544.671,-489.089 534.535,-492.173 538.671,-497.82"/>
</g>
<!-- dgetrf -->
<g id="proc~~npa_mc~~CallsGraph_node52" class="node"><title>dgetrf</title>
<polygon fill="#777777" stroke="#777777" points="599,-575 545,-575 545,-551 599,-551 599,-575"/>
<text text-anchor="middle" x="572" y="-560.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrf</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrf -->
<g id="proc~~npa_mc~~CallsGraph_edge75" class="edge"><title>proc~linsolve&#45;&gt;dgetrf</title>
<path fill="none" stroke="#000000" d="M451.278,-686.699C465.954,-684.182 483.704,-678.932 496,-668 526.355,-641.012 504.586,-613.971 532,-584 533.362,-582.51 534.856,-581.106 536.438,-579.784"/>
<polygon fill="#000000" stroke="#000000" points="538.72,-582.459 544.907,-573.858 534.707,-576.723 538.72,-582.459"/>
</g>
<!-- dgetrs -->
<g id="proc~~npa_mc~~CallsGraph_node53" class="node"><title>dgetrs</title>
<polygon fill="#777777" stroke="#777777" points="599,-533 545,-533 545,-509 599,-509 599,-533"/>
<text text-anchor="middle" x="572" y="-518.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrs</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrs -->
<g id="proc~~npa_mc~~CallsGraph_edge76" class="edge"><title>proc~linsolve&#45;&gt;dgetrs</title>
<path fill="none" stroke="#000000" d="M451.121,-687.373C466.114,-685.101 484.239,-679.871 496,-668 536.991,-626.627 495.488,-587.375 532,-542 533.41,-540.248 535.007,-538.621 536.73,-537.116"/>
<polygon fill="#000000" stroke="#000000" points="538.807,-539.933 544.899,-531.266 534.731,-534.242 538.807,-539.933"/>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_mc~~CallsGraph_edge77" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M466.838,-823.036C484.47,-828.108 505.088,-834.039 523.306,-839.28"/>
<polygon fill="#000000" stroke="#000000" points="522.568,-842.709 533.146,-842.111 524.504,-835.982 522.568,-842.709"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~npa_mc~~CallsGraph_edge78" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M603.084,-924.643C613.801,-921.666 626.092,-918.252 637.698,-915.028"/>
<polygon fill="#000000" stroke="#000000" points="638.964,-918.309 647.662,-912.26 637.09,-911.565 638.964,-918.309"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~npa_mc~~CallsGraph_edge79" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M603.084,-941.635C614.299,-944.854 627.239,-948.569 639.312,-952.034"/>
<polygon fill="#000000" stroke="#000000" points="638.614,-955.475 649.192,-954.87 640.546,-948.747 638.614,-955.475"/>
</g>
<!-- proc~balance -->
<g id="proc~~npa_mc~~CallsGraph_node48" class="node"><title>proc~balance</title>
<g id="a_proc~~npa_mc~~CallsGraph_node48"><a xlink:href=".././proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-701 545,-701 545,-677 599,-677 599,-701"/>
<text text-anchor="middle" x="572" y="-686.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~npa_mc~~CallsGraph_edge81" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M451.102,-723.491C474.418,-716.784 508.802,-706.892 534.778,-699.42"/>
<polygon fill="#000000" stroke="#000000" points="535.989,-702.714 544.632,-696.585 534.054,-695.986 535.989,-702.714"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~npa_mc~~CallsGraph_node49" class="node"><title>proc~elmhes</title>
<g id="a_proc~~npa_mc~~CallsGraph_node49"><a xlink:href=".././proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-617 545,-617 545,-593 599,-593 599,-617"/>
<text text-anchor="middle" x="572" y="-602.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~npa_mc~~CallsGraph_edge80" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M451.278,-728.699C465.954,-726.182 483.704,-720.932 496,-710 526.355,-683.012 504.586,-655.971 532,-626 533.362,-624.51 534.856,-623.106 536.438,-621.784"/>
<polygon fill="#000000" stroke="#000000" points="538.72,-624.459 544.907,-615.858 534.707,-618.723 538.72,-624.459"/>
</g>
<!-- proc~balback -->
<g id="proc~~npa_mc~~CallsGraph_node50" class="node"><title>proc~balback</title>
<g id="a_proc~~npa_mc~~CallsGraph_node50"><a xlink:href=".././proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-659 545,-659 545,-635 599,-635 599,-659"/>
<text text-anchor="middle" x="572" y="-644.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~npa_mc~~CallsGraph_edge82" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M451.154,-726.994C465.271,-723.948 482.515,-718.737 496,-710 516.634,-696.632 512.853,-683.422 532,-668 533.527,-666.77 535.137,-665.577 536.798,-664.425"/>
<polygon fill="#000000" stroke="#000000" points="538.774,-667.317 545.382,-659.035 535.052,-661.388 538.774,-667.317"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~npa_mc~~CallsGraph_node51" class="node"><title>proc~hqr2</title>
<g id="a_proc~~npa_mc~~CallsGraph_node51"><a xlink:href=".././proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-743 545,-743 545,-719 599,-719 599,-743"/>
<text text-anchor="middle" x="572" y="-728.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~npa_mc~~CallsGraph_edge83" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M451.102,-731C474.314,-731 508.498,-731 534.432,-731"/>
<polygon fill="#000000" stroke="#000000" points="534.632,-734.5 544.632,-731 534.632,-727.5 534.632,-734.5"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~npa_mc~~CallsGraph_node54" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~npa_mc~~CallsGraph_node54"><a xlink:href=".././proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-785 545,-785 545,-761 599,-761 599,-785"/>
<text text-anchor="middle" x="572" y="-770.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~npa_mc~~CallsGraph_edge84" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M451.102,-738.509C474.418,-745.216 508.802,-755.108 534.778,-762.58"/>
<polygon fill="#000000" stroke="#000000" points="534.054,-766.014 544.632,-765.415 535.989,-759.286 534.054,-766.014"/>
</g>
<!-- proc~lubksb -->
<g id="proc~~npa_mc~~CallsGraph_node57" class="node"><title>proc~lubksb</title>
<g id="a_proc~~npa_mc~~CallsGraph_node57"><a xlink:href=".././proc/lubksb.html" xlink:title="lubksb">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-512 655,-512 655,-488 709,-488 709,-512"/>
<text text-anchor="middle" x="682" y="-497.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lubksb</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~lubksb -->
<g id="proc~~npa_mc~~CallsGraph_edge85" class="edge"><title>proc~matinv&#45;&gt;proc~lubksb</title>
<path fill="none" stroke="#000000" d="M599.144,-484.084C612.839,-486.746 629.826,-490.049 644.769,-492.955"/>
<polygon fill="#000000" stroke="#000000" points="644.238,-496.417 654.723,-494.891 645.575,-489.546 644.238,-496.417"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~npa_mc~~CallsGraph_node58" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~npa_mc~~CallsGraph_node58"><a xlink:href=".././proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-470 655,-470 655,-446 709,-446 709,-470"/>
<text text-anchor="middle" x="682" y="-455.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~npa_mc~~CallsGraph_edge86" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M599.144,-473.916C612.839,-471.254 629.826,-467.951 644.769,-465.045"/>
<polygon fill="#000000" stroke="#000000" points="645.575,-468.454 654.723,-463.109 644.238,-461.583 645.575,-468.454"/>
</g>
<!-- proc~rswap -->
<g id="proc~~npa_mc~~CallsGraph_node56" class="node"><title>proc~rswap</title>
<g id="a_proc~~npa_mc~~CallsGraph_node56"><a xlink:href=".././proc/rswap.html" xlink:title="RSWAP">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-659 655,-659 655,-635 709,-635 709,-659"/>
<text text-anchor="middle" x="682" y="-644.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RSWAP</text>
</a>
</g>
</g>
<!-- proc~balance&#45;&gt;proc~rswap -->
<g id="proc~~npa_mc~~CallsGraph_edge87" class="edge"><title>proc~balance&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M599.144,-678.833C612.971,-673.456 630.153,-666.774 645.2,-660.922"/>
<polygon fill="#000000" stroke="#000000" points="646.671,-664.106 654.723,-657.219 644.134,-657.581 646.671,-664.106"/>
</g>
<!-- proc~elmhes&#45;&gt;proc~rswap -->
<g id="proc~~npa_mc~~CallsGraph_edge88" class="edge"><title>proc~elmhes&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M599.144,-615.167C612.971,-620.544 630.153,-627.226 645.2,-633.078"/>
<polygon fill="#000000" stroke="#000000" points="644.134,-636.419 654.723,-636.781 646.671,-629.894 644.134,-636.419"/>
</g>
<!-- proc~balback&#45;&gt;proc~rswap -->
<g id="proc~~npa_mc~~CallsGraph_edge89" class="edge"><title>proc~balback&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M599.144,-647C612.707,-647 629.499,-647 644.338,-647"/>
<polygon fill="#000000" stroke="#000000" points="644.723,-650.5 654.723,-647 644.723,-643.5 644.723,-650.5"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~npa_mc~~CallsGraph_node55" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~npa_mc~~CallsGraph_node55"><a xlink:href=".././proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-743 655,-743 655,-719 709,-719 709,-743"/>
<text text-anchor="middle" x="682" y="-728.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~npa_mc~~CallsGraph_edge90" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M599.144,-731C612.707,-731 629.499,-731 644.338,-731"/>
<polygon fill="#000000" stroke="#000000" points="644.723,-734.5 654.723,-731 644.723,-727.5 644.723,-734.5"/>
</g>
<!-- proc~comdiv -->
<g id="proc~~npa_mc~~CallsGraph_node60" class="node"><title>proc~comdiv</title>
<g id="a_proc~~npa_mc~~CallsGraph_node60"><a xlink:href=".././proc/comdiv.html" xlink:title="Comdiv">
<polygon fill="#d9534f" stroke="#d9534f" points="809,-743 755,-743 755,-719 809,-719 809,-743"/>
<text text-anchor="middle" x="782" y="-728.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Comdiv</text>
</a>
</g>
</g>
<!-- proc~hqrvec&#45;&gt;proc~comdiv -->
<g id="proc~~npa_mc~~CallsGraph_edge91" class="edge"><title>proc~hqrvec&#45;&gt;proc~comdiv</title>
<path fill="none" stroke="#000000" d="M709.005,-731C719.969,-731 732.92,-731 744.794,-731"/>
<polygon fill="#000000" stroke="#000000" points="744.874,-734.5 754.874,-731 744.874,-727.5 744.874,-734.5"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~npa_mc~~CallsGraph_node59" class="node"><title>proc~outerprod</title>
<g id="a_proc~~npa_mc~~CallsGraph_node59"><a xlink:href=".././proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="811.5,-491 752.5,-491 752.5,-467 811.5,-467 811.5,-491"/>
<text text-anchor="middle" x="782" y="-476.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~npa_mc~~CallsGraph_edge92" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M709.005,-463.572C719.251,-465.768 731.231,-468.335 742.446,-470.739"/>
<polygon fill="#000000" stroke="#000000" points="741.947,-474.211 752.459,-472.884 743.414,-467.366 741.947,-474.211"/>
</g>
<!-- proc~swap -->
<g id="proc~~npa_mc~~CallsGraph_node61" class="node"><title>proc~swap</title>
<g id="a_proc~~npa_mc~~CallsGraph_node61"><a xlink:href=".././proc/swap.html" xlink:title="swap">
<polygon fill="#d9534f" stroke="#d9534f" points="809,-449 755,-449 755,-425 809,-425 809,-449"/>
<text text-anchor="middle" x="782" y="-434.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swap</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~swap -->
<g id="proc~~npa_mc~~CallsGraph_edge93" class="edge"><title>proc~ludcmp&#45;&gt;proc~swap</title>
<path fill="none" stroke="#000000" d="M709.005,-452.428C719.969,-450.078 732.92,-447.303 744.794,-444.758"/>
<polygon fill="#000000" stroke="#000000" points="745.829,-448.116 754.874,-442.599 744.362,-441.272 745.829,-448.116"/>
</g>
</g>
</svg>
</div><script>var panprocnpa_mcCallsGraph = svgPanZoom('#procnpa_mcCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~npa_mc~~CalledByGraph Pages: 1 -->
<svg id="procnpa_mcCalledByGraph" width="152pt" height="32pt"
 viewBox="0.00 0.00 152.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~npa_mc~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~npa_mc~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 148,-28 148,4 -4,4"/>
<!-- proc~npa_mc -->
<g id="proc~~npa_mc~~CalledByGraph_node1" class="node"><title>proc~npa_mc</title>
<polygon fill="none" stroke="black" points="144,-24 90,-24 90,-0 144,-0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">npa_mc</text>
</g>
<!-- program~fidasim -->
<g id="proc~~npa_mc~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~npa_mc~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_mc -->
<g id="proc~~npa_mc~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~npa_mc</title>
<path fill="none" stroke="#000000" d="M54.4029,-12C62.3932,-12 71.3106,-12 79.8241,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.919,-15.5001 89.919,-12 79.919,-8.5001 79.919,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/npa_mc.html#src">npa_mc</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">npa_mc</span>
    <span class="c">!+ Calculate Active NPA flux using a Monte Carlo fast-ion distribution</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iion</span><span class="p">,</span><span class="n">igamma</span><span class="p">,</span><span class="n">ngamma</span><span class="p">,</span><span class="n">npart</span>
    <span class="k">type</span><span class="p">(</span><span class="n">FastIon</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fast_ion</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">phi</span><span class="p">,</span><span class="n">theta</span><span class="p">,</span><span class="n">dtheta</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ri</span><span class="p">,</span> <span class="n">rf</span><span class="p">,</span> <span class="n">rg</span><span class="p">,</span> <span class="n">vi</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">det</span><span class="p">,</span><span class="n">ichan</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">nrange</span><span class="p">,</span><span class="n">it</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fields</span>
    <span class="k">type</span><span class="p">(</span><span class="n">GyroSurface</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gs</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rates</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">states</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">flux</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="kd">::</span> <span class="n">neut_types</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ind</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">uvw</span><span class="p">,</span> <span class="n">uvw_vi</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gyrange</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">s</span><span class="p">,</span><span class="n">c</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">randomu</span>

    <span class="n">ngamma</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">.</span><span class="nb">or</span><span class="p">.(</span><span class="n">inputs</span><span class="p">%</span><span class="n">dist_type</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">))</span> <span class="k">then</span>
<span class="k">        </span><span class="n">ngamma</span> <span class="o">=</span> <span class="nb">ceiling</span><span class="p">(</span><span class="nb">dble</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_npa</span><span class="p">)</span><span class="o">/</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="p">)</span>
    <span class="k">endif</span>

<span class="k">    if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i10)&#39;</span><span class="p">)</span> <span class="nb">int</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="o">*</span><span class="n">ngamma</span><span class="p">,</span><span class="n">Int64</span><span class="p">)</span>
    <span class="k">endif</span>

    <span class="c">!$OMP PARALLEL DO schedule(guided) private(iion,igamma,ind,fast_ion,vi,ri,rf,phi,s,c,ir,it, &amp;</span>
    <span class="c">!$OMP&amp; randomu,rg,fields,uvw,uvw_vi,rates,states,flux,det,ichan,gs,nrange,gyrange,theta,dtheta)</span>
    <span class="n">loop_over_fast_ions</span><span class="p">:</span> <span class="k">do </span><span class="n">iion</span><span class="o">=</span><span class="n">istart</span><span class="p">,</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="p">,</span><span class="n">istep</span>
        <span class="n">fast_ion</span> <span class="o">=</span> <span class="n">particles</span><span class="p">%</span><span class="n">fast_ion</span><span class="p">(</span><span class="n">iion</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vabs</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">loop_over_fast_ions</span>
        <span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">beam_grid_cross_grid</span><span class="p">)</span> <span class="k">cycle </span><span class="n">loop_over_fast_ions</span>
        <span class="n">gamma_loop</span><span class="p">:</span> <span class="k">do </span><span class="n">igamma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ngamma</span>
            <span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">)</span> <span class="k">then</span>
                <span class="c">!! Pick random toroidal angle</span>
                <span class="k">call </span><span class="n">randu</span><span class="p">(</span><span class="n">randomu</span><span class="p">)</span>
                <span class="n">phi</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">beam_grid_phi_enter</span> <span class="o">+</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">delta_phi</span><span class="o">*</span><span class="n">randomu</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span>
<span class="k">                </span><span class="n">phi</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">phi</span>
            <span class="k">endif</span>
<span class="k">            </span><span class="n">s</span> <span class="o">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="nb">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>

            <span class="c">!! Calculate position in machine coordinates</span>
            <span class="n">uvw</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">c</span>
            <span class="n">uvw</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">s</span>
            <span class="n">uvw</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">z</span>

            <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">dist_type</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
                <span class="c">!! Convert to beam grid coordinates</span>
                <span class="k">call </span><span class="n">uvw_to_xyz</span><span class="p">(</span><span class="n">uvw</span><span class="p">,</span> <span class="n">rg</span><span class="p">)</span>

                <span class="c">!! Get electomagnetic fields</span>
                <span class="k">call </span><span class="n">get_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">rg</span><span class="p">)</span>

                <span class="c">!! Correct for gyro motion and get position and velocity</span>
                <span class="k">call </span><span class="n">gyro_surface</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">energy</span><span class="p">,</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">pitch</span><span class="p">,</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">A</span><span class="p">,</span> <span class="n">gs</span><span class="p">)</span>

                <span class="n">detector_loop</span><span class="p">:</span> <span class="k">do </span><span class="n">ichan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">npa_chords</span><span class="p">%</span><span class="n">nchan</span>
                    <span class="k">call </span><span class="n">npa_gyro_range</span><span class="p">(</span><span class="n">ichan</span><span class="p">,</span> <span class="n">gs</span><span class="p">,</span> <span class="n">gyrange</span><span class="p">,</span> <span class="n">nrange</span><span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">nrange</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">detector_loop</span>

                    <span class="n">gyro_range_loop</span><span class="p">:</span> <span class="k">do </span><span class="n">ir</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nrange</span>
                        <span class="n">dtheta</span> <span class="o">=</span> <span class="n">gyrange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span>
                        <span class="n">theta</span> <span class="o">=</span> <span class="n">gyrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dtheta</span>
                        <span class="k">call </span><span class="n">gyro_trajectory</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">)</span>

                        <span class="c">!! Check if particle hits a NPA detector</span>
                        <span class="k">call </span><span class="n">hit_npa_detector</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span> <span class="n">vi</span> <span class="p">,</span><span class="n">det</span><span class="p">,</span> <span class="n">rf</span><span class="p">,</span> <span class="n">det</span><span class="o">=</span><span class="n">ichan</span><span class="p">)</span>
                        <span class="k">if</span><span class="p">(</span><span class="n">det</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">ichan</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                            if</span> <span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="k">                                write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s2">&quot;NPA_MC: Missed Detector &quot;</span><span class="p">,</span><span class="n">ichan</span>
                            <span class="k">endif</span>
<span class="k">                            cycle </span><span class="n">gyro_range_loop</span>
                        <span class="k">endif</span>

                        <span class="c">!! Get beam grid indices at ri</span>
                        <span class="k">call </span><span class="n">get_indices</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span>

                        <span class="c">!! Calculate CX probability with beam and halo neutrals</span>
                        <span class="k">call </span><span class="n">get_total_cx_rate</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">,</span> <span class="n">neut_types</span><span class="p">,</span> <span class="n">rates</span><span class="p">)</span>
                        <span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span> <span class="k">cycle </span><span class="n">gyro_range_loop</span>

                        <span class="c">!! Weight CX rates by ion source density</span>
                        <span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">weight</span><span class="o">*</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">delta_phi</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">/</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="o">/</span><span class="n">ngamma</span>

                        <span class="c">!! Attenuate states as the particle move through plasma</span>
                        <span class="k">call </span><span class="n">attenuate</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">states</span><span class="p">)</span>

                        <span class="c">!! Store NPA Flux</span>
                        <span class="n">flux</span> <span class="o">=</span> <span class="p">(</span><span class="n">dtheta</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="o">*</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span>
                        <span class="n">spread_loop</span><span class="p">:</span> <span class="k">do </span><span class="n">it</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">25</span>
                            <span class="n">theta</span> <span class="o">=</span> <span class="n">gyrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">it</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">dtheta</span><span class="o">/</span><span class="mi">25</span>
                            <span class="k">call </span><span class="n">gyro_trajectory</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">)</span>
                            <span class="k">call </span><span class="n">hit_npa_detector</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span> <span class="n">vi</span> <span class="p">,</span><span class="n">det</span><span class="p">,</span> <span class="n">rf</span><span class="p">,</span> <span class="n">det</span><span class="o">=</span><span class="n">ichan</span><span class="p">)</span>
                            <span class="k">if</span><span class="p">(</span><span class="n">det</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">ichan</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                                if</span> <span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="k">                                    write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s2">&quot;NPA_MC: Missed Detector &quot;</span><span class="p">,</span><span class="n">ichan</span>
                                <span class="k">endif</span>
<span class="k">                                cycle </span><span class="n">spread_loop</span>
                            <span class="k">endif</span>
<span class="k">                            call </span><span class="n">store_npa</span><span class="p">(</span><span class="n">det</span><span class="p">,</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">flux</span><span class="o">/</span><span class="mi">25</span><span class="p">,</span><span class="n">fast_ion</span><span class="p">%</span><span class="k">class</span><span class="p">)</span>
                        <span class="k">enddo </span><span class="n">spread_loop</span>
                    <span class="k">enddo </span><span class="n">gyro_range_loop</span>
                <span class="k">enddo </span><span class="n">detector_loop</span>
            <span class="k">else</span> <span class="c">!! Full Orbit</span>
                <span class="c">!! Convert to beam grid coordinates</span>
                <span class="k">call </span><span class="n">uvw_to_xyz</span><span class="p">(</span><span class="n">uvw</span><span class="p">,</span> <span class="n">ri</span><span class="p">)</span>

                <span class="c">!! Calculate velocity vector</span>
                <span class="n">uvw_vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vr</span> <span class="o">-</span> <span class="n">s</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vt</span>
                <span class="n">uvw_vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vr</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vt</span>
                <span class="n">uvw_vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">vz</span>
                <span class="n">vi</span> <span class="o">=</span> <span class="nb">matmul</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">inv_basis</span><span class="p">,</span><span class="n">uvw_vi</span><span class="p">)</span>

                <span class="c">!! Check if particle hits a NPA detector</span>
                <span class="k">call </span><span class="n">hit_npa_detector</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span> <span class="n">vi</span> <span class="p">,</span><span class="n">det</span><span class="p">,</span> <span class="n">rf</span><span class="p">)</span>
                <span class="k">if</span><span class="p">(</span><span class="n">det</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">gamma_loop</span>

                <span class="c">!! Get beam grid indices at ri</span>
                <span class="k">call </span><span class="n">get_indices</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span>

                <span class="c">!! Calculate CX probability with beam and halo neutrals</span>
                <span class="k">call </span><span class="n">get_total_cx_rate</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">,</span> <span class="n">neut_types</span><span class="p">,</span> <span class="n">rates</span><span class="p">)</span>
                <span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span> <span class="k">cycle </span><span class="n">gamma_loop</span>

                <span class="c">!! Weight CX rates by ion source density</span>
                <span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">weight</span><span class="o">*</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">delta_phi</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">/</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="o">/</span><span class="n">ngamma</span>

                <span class="c">!! Attenuate states as the particle moves though plasma</span>
                <span class="k">call </span><span class="n">attenuate</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">states</span><span class="p">)</span>

                <span class="c">!! Store NPA Flux</span>
                <span class="n">flux</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="o">*</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span>
                <span class="k">call </span><span class="n">store_npa</span><span class="p">(</span><span class="n">det</span><span class="p">,</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">flux</span><span class="p">,</span><span class="n">fast_ion</span><span class="p">%</span><span class="k">class</span><span class="p">)</span>
            <span class="k">endif</span>
<span class="k">        enddo </span><span class="n">gamma_loop</span>
    <span class="k">enddo </span><span class="n">loop_over_fast_ions</span>
    <span class="c">!$OMP END PARALLEL DO</span>

    <span class="n">npart</span> <span class="o">=</span> <span class="n">npa</span><span class="p">%</span><span class="n">npart</span>
<span class="cp">#ifdef _MPI</span>
    <span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">npart</span><span class="p">)</span>
    <span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">npa</span><span class="p">%</span><span class="n">flux</span><span class="p">)</span>
<span class="cp">#endif</span>

    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T4,&quot;Number of Active NPA particles that hit a detector: &quot;,i8)&#39;</span><span class="p">)</span> <span class="n">npart</span>
    <span class="k">endif</span>

<span class="k">end subroutine </span><span class="n">npa_mc</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2021 
                                          </p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            
            
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>