<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>pfida_mc &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
               
        
        
            </ul>
        
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>



          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>pfida_mc
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.5% of total for procedures.">74 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
    
     <li><a href='../module/libfida.html'>libfida</a></li>
    
  
     <li class="active">pfida_mc</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pfida_mc.html#src">pfida_mc</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine pfida_mc()
    
    
   
</h2>
    
  


    
    <p>Calculate Passive FIDA emission using a Monte Carlo Fast-ion distribution</p>
    

    <h3>Arguments</h3>
    
    <em>None</em>
    <br>
    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~pfida_mc~~CallsGraph Pages: 1 -->
<svg id="procpfida_mcCallsGraph" width="641pt" height="1096pt"
 viewBox="0.00 0.00 641.00 1095.58" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pfida_mc~~CallsGraph" class="graph" transform="scale(0.748832 0.748832) rotate(0) translate(4 1459.05)">
<title>proc~~pfida_mc~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1459.05 852,-1459.05 852,4 -4,4"/>
<!-- proc~pfida_mc -->
<g id="proc~~pfida_mc~~CallsGraph_node1" class="node"><title>proc~pfida_mc</title>
<polygon fill="none" stroke="black" points="56,-503 0,-503 0,-479 56,-479 56,-503"/>
<text text-anchor="middle" x="28" y="-488.6" font-family="Helvetica,sans-Serif" font-size="10.50">pfida_mc</text>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~pfida_mc~~CallsGraph_node2" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node2"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="180.5,-1239 107.5,-1239 107.5,-1215 180.5,-1215 180.5,-1239"/>
<text text-anchor="middle" x="144" y="-1224.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;interface~parallel_sum -->
<g id="proc~~pfida_mc~~CallsGraph_edge1" class="edge"><title>proc~pfida_mc&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M30.8836,-503.161C44.0381,-588.088 122.151,-1092.39 139.561,-1204.8"/>
<polygon fill="#000000" stroke="#000000" points="136.146,-1205.61 141.135,-1214.96 143.063,-1204.54 136.146,-1205.61"/>
</g>
<!-- proc~bt_cx_rates -->
<g id="proc~~pfida_mc~~CallsGraph_node3" class="node"><title>proc~bt_cx_rates</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node3"><a xlink:href=".././proc/bt_cx_rates.html" xlink:title="bt_cx_rates">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-644 110,-644 110,-620 178,-620 178,-644"/>
<text text-anchor="middle" x="144" y="-629.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bt_cx_rates</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~bt_cx_rates -->
<g id="proc~~pfida_mc~~CallsGraph_edge2" class="edge"><title>proc~pfida_mc&#45;&gt;proc~bt_cx_rates</title>
<path fill="none" stroke="#000000" d="M38.7196,-503.022C58.2243,-527.146 102.329,-581.696 126.46,-611.543"/>
<polygon fill="#000000" stroke="#000000" points="123.971,-614.031 132.98,-619.607 129.415,-609.63 123.971,-614.031"/>
</g>
<!-- proc~colrad -->
<g id="proc~~pfida_mc~~CallsGraph_node4" class="node"><title>proc~colrad</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node4"><a xlink:href=".././proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="171,-723 117,-723 117,-699 171,-699 171,-723"/>
<text text-anchor="middle" x="144" y="-708.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~colrad -->
<g id="proc~~pfida_mc~~CallsGraph_edge3" class="edge"><title>proc~pfida_mc&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M32.1123,-503.042C39.6268,-530.859 60.4991,-601.166 92,-653 100.517,-667.015 112.538,-680.878 122.77,-691.535"/>
<polygon fill="#000000" stroke="#000000" points="120.312,-694.027 129.828,-698.684 125.293,-689.109 120.312,-694.027"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~pfida_mc~~CallsGraph_node5" class="node"><title>proc~get_fields</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node5"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="456,-284 398,-284 398,-260 456,-260 456,-284"/>
<text text-anchor="middle" x="427" y="-269.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~get_fields -->
<g id="proc~~pfida_mc~~CallsGraph_edge4" class="edge"><title>proc~pfida_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M34.3561,-478.807C43.4902,-459.332 63.8594,-421.151 92,-399 183.848,-326.702 321.427,-292.031 387.664,-278.763"/>
<polygon fill="#000000" stroke="#000000" points="388.518,-282.163 397.664,-276.815 387.179,-275.292 388.518,-282.163"/>
</g>
<!-- proc~track_cylindrical -->
<g id="proc~~pfida_mc~~CallsGraph_node6" class="node"><title>proc~track_cylindrical</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node6"><a xlink:href=".././proc/track_cylindrical.html" xlink:title="track_cylindrical">
<polygon fill="#d9534f" stroke="#d9534f" points="322,-443 234,-443 234,-419 322,-419 322,-443"/>
<text text-anchor="middle" x="278" y="-428.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track_cylindrical</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~track_cylindrical -->
<g id="proc~~pfida_mc~~CallsGraph_edge5" class="edge"><title>proc~pfida_mc&#45;&gt;proc~track_cylindrical</title>
<path fill="none" stroke="#000000" d="M56.0124,-484.465C96.1458,-474.755 172.316,-456.327 223.875,-443.853"/>
<polygon fill="#000000" stroke="#000000" points="224.944,-447.195 233.84,-441.442 223.298,-440.392 224.944,-447.195"/>
</g>
<!-- proc~gyro_correction -->
<g id="proc~~pfida_mc~~CallsGraph_node7" class="node"><title>proc~gyro_correction</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node7"><a xlink:href=".././proc/gyro_correction.html" xlink:title="gyro_correction">
<polygon fill="#d9534f" stroke="#d9534f" points="187.5,-544 100.5,-544 100.5,-520 187.5,-520 187.5,-544"/>
<text text-anchor="middle" x="144" y="-529.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_correction</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~gyro_correction -->
<g id="proc~~pfida_mc~~CallsGraph_edge6" class="edge"><title>proc~pfida_mc&#45;&gt;proc~gyro_correction</title>
<path fill="none" stroke="#000000" d="M56.0164,-500.716C69.0872,-505.417 85.0985,-511.176 99.8053,-516.465"/>
<polygon fill="#000000" stroke="#000000" points="98.6428,-519.766 109.237,-519.857 101.012,-513.179 98.6428,-519.766"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~pfida_mc~~CallsGraph_node8" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node8"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="461,-343 393,-343 393,-319 461,-319 461,-343"/>
<text text-anchor="middle" x="427" y="-328.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~get_plasma -->
<g id="proc~~pfida_mc~~CallsGraph_edge7" class="edge"><title>proc~pfida_mc&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M44.3415,-478.835C56.6799,-469.48 74.7445,-456.72 92,-448 191.419,-397.758 317.539,-359.997 382.677,-342.238"/>
<polygon fill="#000000" stroke="#000000" points="383.852,-345.547 392.594,-339.561 382.027,-338.789 383.852,-345.547"/>
</g>
<!-- proc~store_fida_photons -->
<g id="proc~~pfida_mc~~CallsGraph_node9" class="node"><title>proc~store_fida_photons</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node9"><a xlink:href=".././proc/store_fida_photons.html" xlink:title="store_fida_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="196,-186 92,-186 92,-162 196,-162 196,-186"/>
<text text-anchor="middle" x="144" y="-171.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_fida_photons</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~store_fida_photons -->
<g id="proc~~pfida_mc~~CallsGraph_edge8" class="edge"><title>proc~pfida_mc&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M31.8777,-478.815C39.7922,-445.972 63.2212,-353.087 92,-279 103.593,-249.157 120.299,-216.16 131.394,-195.267"/>
<polygon fill="#000000" stroke="#000000" points="134.555,-196.778 136.2,-186.312 128.387,-193.468 134.555,-196.778"/>
</g>
<!-- interface~randu -->
<g id="proc~~pfida_mc~~CallsGraph_node10" class="node"><title>interface~randu</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node10"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="305,-503 251,-503 251,-479 305,-479 305,-503"/>
<text text-anchor="middle" x="278" y="-488.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;interface~randu -->
<g id="proc~~pfida_mc~~CallsGraph_edge9" class="edge"><title>proc~pfida_mc&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M56.0124,-491C100.784,-491 190.403,-491 240.671,-491"/>
<polygon fill="#000000" stroke="#000000" points="240.77,-494.5 250.769,-491 240.769,-487.5 240.77,-494.5"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~pfida_mc~~CallsGraph_node12" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node12"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="323.5,-1323 232.5,-1323 232.5,-1299 323.5,-1299 323.5,-1323"/>
<text text-anchor="middle" x="278" y="-1308.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~pfida_mc~~CallsGraph_edge14" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M159.804,-1239.07C176.658,-1252.48 205.317,-1274.31 232,-1290 234.508,-1291.48 237.137,-1292.93 239.811,-1294.33"/>
<polygon fill="#000000" stroke="#000000" points="238.461,-1297.57 248.969,-1298.93 241.598,-1291.32 238.461,-1297.57"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~pfida_mc~~CallsGraph_node14" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node14"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="323.5,-1159 232.5,-1159 232.5,-1135 323.5,-1135 323.5,-1159"/>
<text text-anchor="middle" x="278" y="-1144.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~pfida_mc~~CallsGraph_edge17" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M164.243,-1214.81C181.802,-1203.75 208.515,-1187.07 232,-1173 236.838,-1170.1 241.995,-1167.07 247.029,-1164.14"/>
<polygon fill="#000000" stroke="#000000" points="248.955,-1167.07 255.858,-1159.03 245.449,-1161.01 248.955,-1167.07"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~pfida_mc~~CallsGraph_node17" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node17"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="323.5,-1117 232.5,-1117 232.5,-1093 323.5,-1093 323.5,-1117"/>
<text text-anchor="middle" x="278" y="-1102.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~pfida_mc~~CallsGraph_edge10" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M152.813,-1214.97C166.654,-1194.42 197.315,-1152.27 232,-1126 233.787,-1124.65 235.675,-1123.35 237.625,-1122.12"/>
<polygon fill="#000000" stroke="#000000" points="239.491,-1125.08 246.454,-1117.1 236.031,-1119 239.491,-1125.08"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~pfida_mc~~CallsGraph_node18" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node18"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="322,-1075 234,-1075 234,-1051 322,-1051 322,-1075"/>
<text text-anchor="middle" x="278" y="-1060.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~pfida_mc~~CallsGraph_edge13" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M149.612,-1214.63C160.247,-1187.59 188.923,-1122.58 232,-1084 233.325,-1082.81 234.728,-1081.68 236.188,-1080.6"/>
<polygon fill="#000000" stroke="#000000" points="238.452,-1083.31 245.033,-1075.01 234.711,-1077.4 238.452,-1083.31"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~pfida_mc~~CallsGraph_node23" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node23"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="322,-1365 234,-1365 234,-1341 322,-1341 322,-1365"/>
<text text-anchor="middle" x="278" y="-1350.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~pfida_mc~~CallsGraph_edge11" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M152.482,-1239.19C166.046,-1260.45 196.592,-1304.65 232,-1332 233.774,-1333.37 235.652,-1334.68 237.594,-1335.92"/>
<polygon fill="#000000" stroke="#000000" points="235.984,-1339.04 246.4,-1340.97 239.466,-1332.96 235.984,-1339.04"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~pfida_mc~~CallsGraph_node24" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node24"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="322,-1445 234,-1445 234,-1421 322,-1421 322,-1445"/>
<text text-anchor="middle" x="278" y="-1430.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~pfida_mc~~CallsGraph_edge12" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M148.217,-1239.38C156.917,-1270.8 183.575,-1354.87 232,-1407 234.754,-1409.96 237.924,-1412.69 241.279,-1415.16"/>
<polygon fill="#000000" stroke="#000000" points="239.592,-1418.24 249.872,-1420.81 243.434,-1412.39 239.592,-1418.24"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~pfida_mc~~CallsGraph_node29" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node29"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="323.5,-1281 232.5,-1281 232.5,-1257 323.5,-1257 323.5,-1281"/>
<text text-anchor="middle" x="278" y="-1266.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~pfida_mc~~CallsGraph_edge18" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M180.721,-1238.37C195.643,-1243.11 213.202,-1248.7 229.21,-1253.79"/>
<polygon fill="#000000" stroke="#000000" points="228.349,-1257.19 238.939,-1256.89 230.471,-1250.52 228.349,-1257.19"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~pfida_mc~~CallsGraph_node30" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node30"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="471,-1405 383,-1405 383,-1381 471,-1381 471,-1405"/>
<text text-anchor="middle" x="427" y="-1390.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~pfida_mc~~CallsGraph_edge16" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M148.113,-1239.14C156.268,-1268.18 181.22,-1341.67 232,-1374 273.71,-1400.56 331.008,-1402.99 372.51,-1400.18"/>
<polygon fill="#000000" stroke="#000000" points="373.013,-1403.65 382.703,-1399.37 372.455,-1396.68 373.013,-1403.65"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~pfida_mc~~CallsGraph_node31" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node31"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="323.5,-1239 232.5,-1239 232.5,-1215 323.5,-1215 323.5,-1239"/>
<text text-anchor="middle" x="278" y="-1224.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~pfida_mc~~CallsGraph_edge19" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M180.721,-1227C193.501,-1227 208.214,-1227 222.231,-1227"/>
<polygon fill="#000000" stroke="#000000" points="222.276,-1230.5 232.276,-1227 222.276,-1223.5 222.276,-1230.5"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~pfida_mc~~CallsGraph_node33" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node33"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="472.5,-1193 381.5,-1193 381.5,-1169 472.5,-1169 472.5,-1193"/>
<text text-anchor="middle" x="427" y="-1178.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~pfida_mc~~CallsGraph_edge15" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M180.791,-1217.43C196.43,-1213.49 215.039,-1209.13 232,-1206 278.75,-1197.37 332.383,-1190.7 371.391,-1186.43"/>
<polygon fill="#000000" stroke="#000000" points="371.915,-1189.9 381.483,-1185.35 371.165,-1182.94 371.915,-1189.9"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~pfida_mc~~CallsGraph_node35" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node35"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="743.5,-665 666.5,-665 666.5,-641 743.5,-641 743.5,-665"/>
<text text-anchor="middle" x="705" y="-650.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~bt_cx_rates&#45;&gt;interface~interpol_coeff -->
<g id="proc~~pfida_mc~~CallsGraph_edge20" class="edge"><title>proc~bt_cx_rates&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M178.294,-633.251C273.13,-636.813 544.974,-647.026 655.945,-651.195"/>
<polygon fill="#000000" stroke="#000000" points="656.047,-654.701 666.171,-651.579 656.31,-647.706 656.047,-654.701"/>
</g>
<!-- proc~linsolve -->
<g id="proc~~pfida_mc~~CallsGraph_node11" class="node"><title>proc~linsolve</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node11"><a xlink:href=".././proc/linsolve.html" xlink:title="linsolve">
<polygon fill="#d9534f" stroke="#d9534f" points="305,-974 251,-974 251,-950 305,-950 305,-974"/>
<text text-anchor="middle" x="278" y="-959.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linsolve</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~linsolve -->
<g id="proc~~pfida_mc~~CallsGraph_edge21" class="edge"><title>proc~colrad&#45;&gt;proc~linsolve</title>
<path fill="none" stroke="#000000" d="M151.367,-723.106C172.272,-762.858 239.002,-889.746 265.751,-940.61"/>
<polygon fill="#000000" stroke="#000000" points="262.79,-942.5 270.543,-949.721 268.986,-939.241 262.79,-942.5"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~pfida_mc~~CallsGraph_node26" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node26"><a xlink:href=".././proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="624,-705 536,-705 536,-681 624,-681 624,-705"/>
<text text-anchor="middle" x="580" y="-690.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~pfida_mc~~CallsGraph_edge23" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M171.171,-709.915C240.857,-707.024 431.976,-699.098 525.724,-695.21"/>
<polygon fill="#000000" stroke="#000000" points="525.998,-698.701 535.845,-694.79 525.708,-691.707 525.998,-698.701"/>
</g>
<!-- proc~eigen -->
<g id="proc~~pfida_mc~~CallsGraph_node38" class="node"><title>proc~eigen</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node38"><a xlink:href=".././proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="305,-806 251,-806 251,-782 305,-782 305,-806"/>
<text text-anchor="middle" x="278" y="-791.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~pfida_mc~~CallsGraph_edge22" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M164.194,-723.069C186.581,-737.145 223.77,-760.53 249.287,-776.575"/>
<polygon fill="#000000" stroke="#000000" points="247.454,-779.556 257.783,-781.917 251.18,-773.631 247.454,-779.556"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~pfida_mc~~CallsGraph_node19" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node19"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="610.5,-424 549.5,-424 549.5,-400 610.5,-400 610.5,-424"/>
<text text-anchor="middle" x="580" y="-409.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~pfida_mc~~CallsGraph_edge25" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M456.086,-283.278C468.97,-289.582 483.646,-298.507 494,-310 520.369,-339.269 501.958,-363.33 530,-391 533.039,-393.998 536.573,-396.598 540.326,-398.845"/>
<polygon fill="#000000" stroke="#000000" points="538.853,-402.023 549.348,-403.471 542.047,-395.794 538.853,-402.023"/>
</g>
<!-- proc~get_position -->
<g id="proc~~pfida_mc~~CallsGraph_node20" class="node"><title>proc~get_position</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node20"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="615,-382 545,-382 545,-358 615,-358 615,-382"/>
<text text-anchor="middle" x="580" y="-367.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~pfida_mc~~CallsGraph_edge26" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M450.304,-284.166C463.238,-291.388 479.738,-300.888 494,-310 514.869,-323.333 537.765,-339.594 554.53,-351.823"/>
<polygon fill="#000000" stroke="#000000" points="552.563,-354.72 562.696,-357.813 556.703,-349.076 552.563,-354.72"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~pfida_mc~~CallsGraph_node22" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node22"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="848,-243 780,-243 780,-219 848,-219 848,-243"/>
<text text-anchor="middle" x="814" y="-228.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~pfida_mc~~CallsGraph_edge28" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M438.342,-259.595C463.957,-228.887 528.404,-151.742 530,-151 616.246,-110.902 657.529,-111.39 744,-151 770.367,-163.078 790.487,-190.757 802.017,-210.157"/>
<polygon fill="#000000" stroke="#000000" points="799.002,-211.935 806.977,-218.91 805.092,-208.485 799.002,-211.935"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~pfida_mc~~CallsGraph_node27" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node27"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="739,-284 671,-284 671,-260 739,-260 739,-284"/>
<text text-anchor="middle" x="705" y="-269.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~pfida_mc~~CallsGraph_edge27" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M456.24,-272C504.612,-272 603.619,-272 660.746,-272"/>
<polygon fill="#000000" stroke="#000000" points="660.904,-275.5 670.904,-272 660.904,-268.5 660.904,-275.5"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~pfida_mc~~CallsGraph_node32" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node32"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="630,-226 530,-226 530,-202 630,-202 630,-226"/>
<text text-anchor="middle" x="580" y="-211.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~pfida_mc~~CallsGraph_edge24" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M456.048,-261.227C479.114,-252.367 512.118,-239.69 538.125,-229.7"/>
<polygon fill="#000000" stroke="#000000" points="539.635,-232.87 547.715,-226.017 537.125,-226.335 539.635,-232.87"/>
</g>
<!-- proc~track_cylindrical&#45;&gt;proc~get_fields -->
<g id="proc~~pfida_mc~~CallsGraph_edge30" class="edge"><title>proc~track_cylindrical&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M284.826,-418.676C296.418,-395.171 324.356,-343.315 360,-310 368.741,-301.83 379.549,-294.688 389.871,-288.868"/>
<polygon fill="#000000" stroke="#000000" points="391.596,-291.914 398.752,-284.101 388.286,-285.746 391.596,-291.914"/>
</g>
<!-- proc~track_cylindrical&#45;&gt;proc~get_plasma -->
<g id="proc~~pfida_mc~~CallsGraph_edge33" class="edge"><title>proc~track_cylindrical&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M289.702,-418.762C304.252,-402.745 331.719,-374.643 360,-357 367.285,-352.455 375.497,-348.458 383.591,-345.046"/>
<polygon fill="#000000" stroke="#000000" points="384.977,-348.261 392.975,-341.313 382.39,-341.757 384.977,-348.261"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~pfida_mc~~CallsGraph_node15" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node15"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="846.5,-424 781.5,-424 781.5,-400 846.5,-400 846.5,-424"/>
<text text-anchor="middle" x="814" y="-409.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~track_cylindrical&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~pfida_mc~~CallsGraph_edge35" class="edge"><title>proc~track_cylindrical&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M322.297,-431.586C334.491,-431.737 347.765,-431.888 360,-432 530.68,-433.556 574.77,-448.254 744,-426 752.893,-424.831 762.358,-423.181 771.335,-421.423"/>
<polygon fill="#000000" stroke="#000000" points="772.107,-424.838 781.207,-419.412 770.71,-417.979 772.107,-424.838"/>
</g>
<!-- proc~plane_basis -->
<g id="proc~~pfida_mc~~CallsGraph_node16" class="node"><title>proc~plane_basis</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node16"><a xlink:href=".././proc/plane_basis.html" xlink:title="plane_basis">
<polygon fill="#d9534f" stroke="#d9534f" points="462,-587 392,-587 392,-563 462,-563 462,-587"/>
<text text-anchor="middle" x="427" y="-572.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">plane_basis</text>
</a>
</g>
</g>
<!-- proc~track_cylindrical&#45;&gt;proc~plane_basis -->
<g id="proc~~pfida_mc~~CallsGraph_edge37" class="edge"><title>proc~track_cylindrical&#45;&gt;proc~plane_basis</title>
<path fill="none" stroke="#000000" d="M296.524,-443.157C305.645,-450.174 316.439,-459.648 324,-470 347.956,-502.801 329.923,-526.703 360,-554 366.336,-559.75 374.249,-563.926 382.372,-566.959"/>
<polygon fill="#000000" stroke="#000000" points="381.332,-570.301 391.923,-570.02 383.469,-563.635 381.332,-570.301"/>
</g>
<!-- proc~track_cylindrical&#45;&gt;proc~in_plasma -->
<g id="proc~~pfida_mc~~CallsGraph_edge32" class="edge"><title>proc~track_cylindrical&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M296.705,-418.952C312.511,-408.973 336.697,-395.562 360,-390 417.929,-376.174 434.921,-382.478 494,-390 509.088,-391.921 525.328,-395.687 539.529,-399.567"/>
<polygon fill="#000000" stroke="#000000" points="538.888,-403.024 549.464,-402.389 540.8,-396.29 538.888,-403.024"/>
</g>
<!-- proc~line_cylinder_intersect -->
<g id="proc~~pfida_mc~~CallsGraph_node25" class="node"><title>proc~line_cylinder_intersect</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node25"><a xlink:href=".././proc/line_cylinder_intersect.html" xlink:title="line_cylinder_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="486,-545 368,-545 368,-521 486,-521 486,-545"/>
<text text-anchor="middle" x="427" y="-530.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">line_cylinder_intersect</text>
</a>
</g>
</g>
<!-- proc~track_cylindrical&#45;&gt;proc~line_cylinder_intersect -->
<g id="proc~~pfida_mc~~CallsGraph_edge29" class="edge"><title>proc~track_cylindrical&#45;&gt;proc~line_cylinder_intersect</title>
<path fill="none" stroke="#000000" d="M294.085,-443.118C303.066,-450.563 314.523,-460.471 324,-470 341.337,-487.432 339.504,-498.422 360,-512 362.573,-513.705 365.294,-515.279 368.107,-516.731"/>
<polygon fill="#000000" stroke="#000000" points="366.789,-519.977 377.337,-520.967 369.709,-513.615 366.789,-519.977"/>
</g>
<!-- proc~line_plane_intersect -->
<g id="proc~~pfida_mc~~CallsGraph_node28" class="node"><title>proc~line_plane_intersect</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node28"><a xlink:href=".././proc/line_plane_intersect.html" xlink:title="line_plane_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="481,-503 373,-503 373,-479 481,-479 481,-503"/>
<text text-anchor="middle" x="427" y="-488.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">line_plane_intersect</text>
</a>
</g>
</g>
<!-- proc~track_cylindrical&#45;&gt;proc~line_plane_intersect -->
<g id="proc~~pfida_mc~~CallsGraph_edge34" class="edge"><title>proc~track_cylindrical&#45;&gt;proc~line_plane_intersect</title>
<path fill="none" stroke="#000000" d="M307.426,-443.113C322.931,-449.674 342.483,-457.874 360,-465 368.288,-468.372 377.188,-471.924 385.685,-475.282"/>
<polygon fill="#000000" stroke="#000000" points="384.466,-478.564 395.053,-478.972 387.031,-472.051 384.466,-478.564"/>
</g>
<!-- proc~doppler_stark -->
<g id="proc~~pfida_mc~~CallsGraph_node34" class="node"><title>proc~doppler_stark</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node34"><a xlink:href=".././proc/doppler_stark.html" xlink:title="doppler_stark">
<polygon fill="#d9534f" stroke="#d9534f" points="466,-423 388,-423 388,-399 466,-399 466,-423"/>
<text text-anchor="middle" x="427" y="-408.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">doppler_stark</text>
</a>
</g>
</g>
<!-- proc~track_cylindrical&#45;&gt;proc~doppler_stark -->
<g id="proc~~pfida_mc~~CallsGraph_edge31" class="edge"><title>proc~track_cylindrical&#45;&gt;proc~doppler_stark</title>
<path fill="none" stroke="#000000" d="M322.31,-425.108C339.807,-422.727 360.067,-419.971 378.011,-417.529"/>
<polygon fill="#000000" stroke="#000000" points="378.552,-420.988 387.989,-416.172 377.608,-414.052 378.552,-420.988"/>
</g>
<!-- proc~get_passive_grid_indices -->
<g id="proc~~pfida_mc~~CallsGraph_node37" class="node"><title>proc~get_passive_grid_indices</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node37"><a xlink:href=".././proc/get_passive_grid_indices.html" xlink:title="get_passive_grid_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="493.5,-184 360.5,-184 360.5,-160 493.5,-160 493.5,-184"/>
<text text-anchor="middle" x="427" y="-169.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_passive_grid_indices</text>
</a>
</g>
</g>
<!-- proc~track_cylindrical&#45;&gt;proc~get_passive_grid_indices -->
<g id="proc~~pfida_mc~~CallsGraph_edge36" class="edge"><title>proc~track_cylindrical&#45;&gt;proc~get_passive_grid_indices</title>
<path fill="none" stroke="#000000" d="M283.231,-418.631C293.781,-388.597 323.083,-309.961 360,-251 373.73,-229.072 393.037,-206.681 407.223,-191.364"/>
<polygon fill="#000000" stroke="#000000" points="409.813,-193.719 414.118,-184.038 404.716,-188.921 409.813,-193.719"/>
</g>
<!-- proc~gyro_correction&#45;&gt;interface~randu -->
<g id="proc~~pfida_mc~~CallsGraph_edge38" class="edge"><title>proc~gyro_correction&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M183.89,-519.92C201.945,-514.313 223.275,-507.687 240.961,-502.194"/>
<polygon fill="#000000" stroke="#000000" points="242.39,-505.415 250.901,-499.106 240.313,-498.73 242.39,-505.415"/>
</g>
<!-- proc~pitch_to_vec -->
<g id="proc~~pfida_mc~~CallsGraph_node13" class="node"><title>proc~pitch_to_vec</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node13"><a xlink:href=".././proc/pitch_to_vec.html" xlink:title="pitch_to_vec">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-587 241.5,-587 241.5,-563 314.5,-563 314.5,-587"/>
<text text-anchor="middle" x="278" y="-572.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pitch_to_vec</text>
</a>
</g>
</g>
<!-- proc~gyro_correction&#45;&gt;proc~pitch_to_vec -->
<g id="proc~~pfida_mc~~CallsGraph_edge40" class="edge"><title>proc~gyro_correction&#45;&gt;proc~pitch_to_vec</title>
<path fill="none" stroke="#000000" d="M182.121,-544.092C197.403,-549.071 215.257,-554.887 231.33,-560.123"/>
<polygon fill="#000000" stroke="#000000" points="230.476,-563.525 241.068,-563.295 232.644,-556.87 230.476,-563.525"/>
</g>
<!-- proc~gyro_step -->
<g id="proc~~pfida_mc~~CallsGraph_node21" class="node"><title>proc~gyro_step</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node21"><a xlink:href=".././proc/gyro_step.html" xlink:title="gyro_step">
<polygon fill="#d9534f" stroke="#d9534f" points="308,-545 248,-545 248,-521 308,-521 308,-545"/>
<text text-anchor="middle" x="278" y="-530.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_step</text>
</a>
</g>
</g>
<!-- proc~gyro_correction&#45;&gt;proc~gyro_step -->
<g id="proc~~pfida_mc~~CallsGraph_edge39" class="edge"><title>proc~gyro_correction&#45;&gt;proc~gyro_step</title>
<path fill="none" stroke="#000000" d="M187.857,-532.325C203.759,-532.445 221.715,-532.581 237.322,-532.699"/>
<polygon fill="#000000" stroke="#000000" points="237.671,-536.202 247.697,-532.778 237.724,-529.202 237.671,-536.202"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~pfida_mc~~CallsGraph_edge43" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M461.086,-341.216C472,-345.309 483.917,-350.593 494,-357 512.575,-368.803 511.602,-378.923 530,-391 533.165,-393.078 536.57,-395.027 540.057,-396.837"/>
<polygon fill="#000000" stroke="#000000" points="538.839,-400.135 549.371,-401.293 541.86,-393.82 538.839,-400.135"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~pfida_mc~~CallsGraph_edge44" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M461.138,-339.559C482.863,-345.17 511.508,-352.568 535.118,-358.666"/>
<polygon fill="#000000" stroke="#000000" points="534.336,-362.079 544.893,-361.191 536.086,-355.301 534.336,-362.079"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~pfida_mc~~CallsGraph_edge41" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M461.318,-333.804C521.156,-337.409 649.4,-338.532 744,-293 764.743,-283.016 783.835,-264.851 796.651,-250.754"/>
<polygon fill="#000000" stroke="#000000" points="799.475,-252.842 803.438,-243.016 794.213,-248.227 799.475,-252.842"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~pfida_mc~~CallsGraph_edge42" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M461.018,-323.942C510.992,-313.259 605.853,-292.981 661.108,-281.169"/>
<polygon fill="#000000" stroke="#000000" points="661.897,-284.579 670.944,-279.066 660.433,-277.734 661.897,-284.579"/>
</g>
<!-- proc~store_photons -->
<g id="proc~~pfida_mc~~CallsGraph_node36" class="node"><title>proc~store_photons</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node36"><a xlink:href=".././proc/store_photons.html" xlink:title="store_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="318.5,-145 237.5,-145 237.5,-121 318.5,-121 318.5,-145"/>
<text text-anchor="middle" x="278" y="-130.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_photons</text>
</a>
</g>
</g>
<!-- proc~store_fida_photons&#45;&gt;proc~store_photons -->
<g id="proc~~pfida_mc~~CallsGraph_edge45" class="edge"><title>proc~store_fida_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M183.89,-161.92C197.731,-157.621 213.497,-152.724 228.071,-148.198"/>
<polygon fill="#000000" stroke="#000000" points="229.42,-151.444 237.931,-145.135 227.343,-144.759 229.42,-151.444"/>
</g>
<!-- proc~matinv -->
<g id="proc~~pfida_mc~~CallsGraph_node42" class="node"><title>proc~matinv</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node42"><a xlink:href=".././proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="454,-1037 400,-1037 400,-1013 454,-1013 454,-1037"/>
<text text-anchor="middle" x="427" y="-1022.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~linsolve&#45;&gt;proc~matinv -->
<g id="proc~~pfida_mc~~CallsGraph_edge48" class="edge"><title>proc~linsolve&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M299.847,-974.064C315.935,-983.064 338.93,-995.26 360,-1004 369.663,-1008.01 380.381,-1011.72 390.32,-1014.87"/>
<polygon fill="#000000" stroke="#000000" points="389.346,-1018.23 399.933,-1017.82 391.402,-1011.54 389.346,-1018.23"/>
</g>
<!-- dgetrs -->
<g id="proc~~pfida_mc~~CallsGraph_node45" class="node"><title>dgetrs</title>
<polygon fill="#777777" stroke="#777777" points="454,-995 400,-995 400,-971 454,-971 454,-995"/>
<text text-anchor="middle" x="427" y="-980.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrs</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrs -->
<g id="proc~~pfida_mc~~CallsGraph_edge47" class="edge"><title>proc~linsolve&#45;&gt;dgetrs</title>
<path fill="none" stroke="#000000" d="M305.281,-965.754C328.902,-969.129 363.807,-974.115 390.016,-977.859"/>
<polygon fill="#000000" stroke="#000000" points="389.552,-981.329 399.947,-979.278 390.542,-974.399 389.552,-981.329"/>
</g>
<!-- dgetrf -->
<g id="proc~~pfida_mc~~CallsGraph_node49" class="node"><title>dgetrf</title>
<polygon fill="#777777" stroke="#777777" points="454,-953 400,-953 400,-929 454,-929 454,-953"/>
<text text-anchor="middle" x="427" y="-938.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrf</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrf -->
<g id="proc~~pfida_mc~~CallsGraph_edge46" class="edge"><title>proc~linsolve&#45;&gt;dgetrf</title>
<path fill="none" stroke="#000000" d="M305.281,-958.246C328.902,-954.871 363.807,-949.885 390.016,-946.141"/>
<polygon fill="#000000" stroke="#000000" points="390.542,-949.601 399.947,-944.722 389.552,-942.671 390.542,-949.601"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~pfida_mc~~CallsGraph_node43" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="619.5,-1270 540.5,-1270 540.5,-1246 619.5,-1246 619.5,-1270"/>
<text text-anchor="middle" x="580" y="-1255.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~pfida_mc~~CallsGraph_edge49" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M323.613,-1304.78C367.196,-1298.51 435.348,-1288.18 494,-1277 505.718,-1274.77 518.286,-1272.1 530.067,-1269.49"/>
<polygon fill="#000000" stroke="#000000" points="531.188,-1272.83 540.177,-1267.22 529.653,-1266 531.188,-1272.83"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~pfida_mc~~CallsGraph_edge50" class="edge"><title>proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M323.504,-1157.29C338.546,-1160.77 355.518,-1164.7 371.26,-1168.34"/>
<polygon fill="#000000" stroke="#000000" points="370.862,-1171.84 381.394,-1170.68 372.44,-1165.02 370.862,-1171.84"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~pfida_mc~~CallsGraph_edge51" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M323.543,-1140.04C368.891,-1135.09 440.009,-1133.36 494,-1160 527.905,-1176.73 553.894,-1213.66 567.77,-1237.1"/>
<polygon fill="#000000" stroke="#000000" points="564.812,-1238.98 572.804,-1245.94 570.894,-1235.51 564.812,-1238.98"/>
</g>
<!-- proc~cross_product -->
<g id="proc~~pfida_mc~~CallsGraph_node48" class="node"><title>proc~cross_product</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node48"><a xlink:href=".././proc/cross_product.html" xlink:title="cross_product">
<polygon fill="#d94e8f" stroke="#d94e8f" points="620,-606 540,-606 540,-582 620,-582 620,-606"/>
<text text-anchor="middle" x="580" y="-591.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cross_product</text>
</a>
</g>
</g>
<!-- proc~plane_basis&#45;&gt;proc~cross_product -->
<g id="proc~~pfida_mc~~CallsGraph_edge52" class="edge"><title>proc~plane_basis&#45;&gt;proc~cross_product</title>
<path fill="none" stroke="#000000" d="M462.264,-579.311C482.17,-581.816 507.593,-585.015 529.629,-587.788"/>
<polygon fill="#000000" stroke="#000000" points="529.45,-591.293 539.808,-589.069 530.324,-584.347 529.45,-591.293"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~pfida_mc~~CallsGraph_edge53" class="edge"><title>proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M305.773,-1117.18C311.801,-1120.01 318.145,-1123.06 324,-1126 348.21,-1138.16 375.176,-1152.75 395.298,-1163.84"/>
<polygon fill="#000000" stroke="#000000" points="393.861,-1167.05 404.305,-1168.83 397.251,-1160.92 393.861,-1167.05"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~pfida_mc~~CallsGraph_edge54" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M323.668,-1100.63C369.762,-1098.32 442.063,-1101.05 494,-1133 533.416,-1157.25 558.862,-1207.4 570.881,-1236.27"/>
<polygon fill="#000000" stroke="#000000" points="567.748,-1237.86 574.703,-1245.85 574.25,-1235.27 567.748,-1237.86"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~pfida_mc~~CallsGraph_edge55" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M322.387,-1058.8C369.082,-1056.57 443.439,-1059.91 494,-1096 542.026,-1130.28 565.112,-1200.12 574.163,-1235.86"/>
<polygon fill="#000000" stroke="#000000" points="570.805,-1236.86 576.533,-1245.78 577.613,-1235.24 570.805,-1236.86"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~pfida_mc~~CallsGraph_edge57" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M610.855,-412C651.615,-412 724.884,-412 771.12,-412"/>
<polygon fill="#000000" stroke="#000000" points="771.405,-415.5 781.405,-412 771.405,-408.5 771.405,-415.5"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~pfida_mc~~CallsGraph_edge56" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M610.671,-402.712C617.492,-399.684 624.383,-395.825 630,-391 661.607,-363.851 684.043,-319.767 695.434,-293.558"/>
<polygon fill="#000000" stroke="#000000" points="698.74,-294.723 699.381,-284.147 692.285,-292.015 698.74,-294.723"/>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~pfida_mc~~CallsGraph_edge58" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M587.269,-424.283C607.008,-462.96 668.056,-582.572 693.105,-631.652"/>
<polygon fill="#000000" stroke="#000000" points="690.081,-633.426 697.744,-640.742 696.315,-630.244 690.081,-633.426"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~pfida_mc~~CallsGraph_node50" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node50"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="736,-382 674,-382 674,-358 736,-358 736,-382"/>
<text text-anchor="middle" x="705" y="-367.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~pfida_mc~~CallsGraph_edge59" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M615.262,-370C630.163,-370 647.737,-370 663.298,-370"/>
<polygon fill="#000000" stroke="#000000" points="663.692,-373.5 673.692,-370 663.692,-366.5 663.692,-373.5"/>
</g>
<!-- proc~gyro_step&#45;&gt;proc~cross_product -->
<g id="proc~~pfida_mc~~CallsGraph_edge60" class="edge"><title>proc~gyro_step&#45;&gt;proc~cross_product</title>
<path fill="none" stroke="#000000" d="M308.134,-544.369C313.651,-547.127 319.193,-550.351 324,-554 343.581,-568.867 337.664,-585.727 360,-596 413.953,-620.815 483.59,-614.606 529.691,-605.992"/>
<polygon fill="#000000" stroke="#000000" points="530.598,-609.38 539.73,-604.009 529.241,-602.513 530.598,-609.38"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~pfida_mc~~CallsGraph_edge61" class="edge"><title>proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M322.31,-1364.78C338.16,-1369.1 356.278,-1374.03 372.887,-1378.55"/>
<polygon fill="#000000" stroke="#000000" points="372.432,-1382.05 383,-1381.3 374.27,-1375.3 372.432,-1382.05"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~pfida_mc~~CallsGraph_edge62" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M322.337,-1345.95C366.421,-1338.03 436.274,-1323.42 494,-1302 513.404,-1294.8 534.048,-1284.19 550.132,-1275.19"/>
<polygon fill="#000000" stroke="#000000" points="552.077,-1278.11 559.031,-1270.12 548.61,-1272.03 552.077,-1278.11"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~pfida_mc~~CallsGraph_edge63" class="edge"><title>proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M322.31,-1421.22C338.16,-1416.9 356.278,-1411.97 372.887,-1407.45"/>
<polygon fill="#000000" stroke="#000000" points="374.27,-1410.7 383,-1404.7 372.432,-1403.95 374.27,-1410.7"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~pfida_mc~~CallsGraph_edge64" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M320.993,-1445.03C367.149,-1455.64 441.677,-1464.84 494,-1432 547.908,-1398.16 568.569,-1319.22 575.675,-1280.38"/>
<polygon fill="#000000" stroke="#000000" points="579.192,-1280.58 577.403,-1270.14 572.289,-1279.42 579.192,-1280.58"/>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~pfida_mc~~CallsGraph_edge65" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M617.904,-680.999C630.197,-677.001 644.059,-672.493 657.011,-668.281"/>
<polygon fill="#000000" stroke="#000000" points="658.27,-671.552 666.697,-665.131 656.105,-664.895 658.27,-671.552"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~pfida_mc~~CallsGraph_edge66" class="edge"><title>proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M306.446,-1256.96C312.318,-1254.17 318.429,-1251.11 324,-1248 351.077,-1232.89 380.529,-1213.16 400.792,-1199.03"/>
<polygon fill="#000000" stroke="#000000" points="402.978,-1201.77 409.147,-1193.16 398.953,-1196.05 402.978,-1201.77"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~pfida_mc~~CallsGraph_edge67" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M323.589,-1267.37C378.907,-1265.34 472.899,-1261.89 530.13,-1259.79"/>
<polygon fill="#000000" stroke="#000000" points="530.505,-1263.28 540.37,-1259.42 530.249,-1256.29 530.505,-1263.28"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~pfida_mc~~CallsGraph_edge68" class="edge"><title>proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M402.529,-1405.01C393.984,-1413.97 402.141,-1423 427,-1423 442.149,-1423 451.095,-1419.65 453.839,-1415"/>
<polygon fill="#000000" stroke="#000000" points="457.184,-1413.94 451.471,-1405.01 450.373,-1415.55 457.184,-1413.94"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~pfida_mc~~CallsGraph_edge69" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M468.539,-1380.97C477.407,-1377.29 486.404,-1372.68 494,-1367 526.41,-1342.77 553.002,-1303.17 567.379,-1278.96"/>
<polygon fill="#000000" stroke="#000000" points="570.466,-1280.61 572.444,-1270.21 564.407,-1277.11 570.466,-1280.61"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~pfida_mc~~CallsGraph_edge70" class="edge"><title>proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M317.623,-1214.91C336.106,-1209.13 358.421,-1202.15 377.986,-1196.02"/>
<polygon fill="#000000" stroke="#000000" points="379.137,-1199.33 387.635,-1193.01 377.047,-1192.65 379.137,-1199.33"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~pfida_mc~~CallsGraph_edge71" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M323.589,-1231.61C378.907,-1237.32 472.899,-1247.04 530.13,-1252.95"/>
<polygon fill="#000000" stroke="#000000" points="530.064,-1256.46 540.37,-1254.01 530.783,-1249.5 530.064,-1256.46"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~pfida_mc~~CallsGraph_edge72" class="edge"><title>proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M402.529,-1193.01C393.984,-1201.97 402.141,-1211 427,-1211 442.149,-1211 451.095,-1207.65 453.839,-1203"/>
<polygon fill="#000000" stroke="#000000" points="457.184,-1201.94 451.471,-1193.01 450.373,-1203.55 457.184,-1201.94"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~pfida_mc~~CallsGraph_edge73" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M451.594,-1193.03C476.931,-1205.95 517.386,-1226.58 545.9,-1241.12"/>
<polygon fill="#000000" stroke="#000000" points="544.575,-1244.37 555.074,-1245.8 547.755,-1238.14 544.575,-1244.37"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_fields -->
<g id="proc~~pfida_mc~~CallsGraph_edge75" class="edge"><title>proc~store_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M291.788,-145.092C317.309,-169.224 374.747,-223.536 405.557,-252.669"/>
<polygon fill="#000000" stroke="#000000" points="403.466,-255.509 413.137,-259.837 408.275,-250.423 403.466,-255.509"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~pfida_mc~~CallsGraph_edge78" class="edge"><title>proc~store_photons&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M313.127,-120.932C394.192,-94.5043 602.133,-40.0666 744,-121 777.559,-140.145 797.11,-182.958 806.368,-209.168"/>
<polygon fill="#000000" stroke="#000000" points="803.143,-210.564 809.618,-218.95 809.786,-208.357 803.143,-210.564"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_passive_grid_indices -->
<g id="proc~~pfida_mc~~CallsGraph_edge77" class="edge"><title>proc~store_photons&#45;&gt;proc~get_passive_grid_indices</title>
<path fill="none" stroke="#000000" d="M318.78,-143.554C334.773,-147.797 353.485,-152.761 370.76,-157.345"/>
<polygon fill="#000000" stroke="#000000" points="370.171,-160.809 380.734,-159.991 371.966,-154.043 370.171,-160.809"/>
</g>
<!-- proc~get_indices -->
<g id="proc~~pfida_mc~~CallsGraph_node41" class="node"><title>proc~get_indices</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node41"><a xlink:href=".././proc/get_indices.html" xlink:title="get_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="460.5,-66 393.5,-66 393.5,-42 460.5,-42 460.5,-66"/>
<text text-anchor="middle" x="427" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_indices</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_indices -->
<g id="proc~~pfida_mc~~CallsGraph_edge74" class="edge"><title>proc~store_photons&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M295.458,-120.79C311.409,-109.309 336.565,-92.1214 360,-80 367.548,-76.0961 375.822,-72.4078 383.882,-69.1025"/>
<polygon fill="#000000" stroke="#000000" points="385.185,-72.3506 393.189,-65.4083 382.603,-65.8443 385.185,-72.3506"/>
</g>
<!-- proc~spectrum -->
<g id="proc~~pfida_mc~~CallsGraph_node47" class="node"><title>proc~spectrum</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node47"><a xlink:href=".././proc/spectrum.html" xlink:title="spectrum">
<polygon fill="#d9534f" stroke="#d9534f" points="455.5,-24 398.5,-24 398.5,-0 455.5,-0 455.5,-24"/>
<text text-anchor="middle" x="427" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spectrum</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~spectrum -->
<g id="proc~~pfida_mc~~CallsGraph_edge76" class="edge"><title>proc~store_photons&#45;&gt;proc~spectrum</title>
<path fill="none" stroke="#000000" d="M285.574,-120.929C297.596,-99.9682 325.126,-56.8086 360,-33 368.565,-27.1525 378.851,-22.8614 388.725,-19.7419"/>
<polygon fill="#000000" stroke="#000000" points="389.72,-23.0977 398.383,-16.9985 387.808,-16.3641 389.72,-23.0977"/>
</g>
<!-- proc~xyz_to_cyl -->
<g id="proc~~pfida_mc~~CallsGraph_node39" class="node"><title>proc~xyz_to_cyl</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node39"><a xlink:href=".././proc/xyz_to_cyl.html" xlink:title="xyz_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="611,-184 549,-184 549,-160 611,-160 611,-184"/>
<text text-anchor="middle" x="580" y="-169.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_cyl</text>
</a>
</g>
</g>
<!-- proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl -->
<g id="proc~~pfida_mc~~CallsGraph_edge79" class="edge"><title>proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl</title>
<path fill="none" stroke="#000000" d="M493.792,-172C509.118,-172 524.987,-172 538.816,-172"/>
<polygon fill="#000000" stroke="#000000" points="538.95,-175.5 548.95,-172 538.95,-168.5 538.95,-175.5"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~pfida_mc~~CallsGraph_node40" class="node"><title>proc~hqr2</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node40"><a xlink:href=".././proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="454,-785 400,-785 400,-761 454,-761 454,-785"/>
<text text-anchor="middle" x="427" y="-770.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~pfida_mc~~CallsGraph_edge80" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M305.281,-790.246C328.902,-786.871 363.807,-781.885 390.016,-778.141"/>
<polygon fill="#000000" stroke="#000000" points="390.542,-781.601 399.947,-776.722 389.552,-774.671 390.542,-781.601"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~pfida_mc~~CallsGraph_node44" class="node"><title>proc~elmhes</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node44"><a xlink:href=".././proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="454,-869 400,-869 400,-845 454,-845 454,-869"/>
<text text-anchor="middle" x="427" y="-854.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~pfida_mc~~CallsGraph_edge81" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M299.847,-806.064C315.935,-815.064 338.93,-827.26 360,-836 369.663,-840.008 380.381,-843.717 390.32,-846.868"/>
<polygon fill="#000000" stroke="#000000" points="389.346,-850.23 399.933,-849.823 391.402,-843.539 389.346,-850.23"/>
</g>
<!-- proc~balance -->
<g id="proc~~pfida_mc~~CallsGraph_node46" class="node"><title>proc~balance</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node46"><a xlink:href=".././proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="454,-911 400,-911 400,-887 454,-887 454,-911"/>
<text text-anchor="middle" x="427" y="-896.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~pfida_mc~~CallsGraph_edge82" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M287.54,-806.122C300.952,-824.296 328.679,-858.545 360,-878 369.116,-883.662 379.898,-887.929 390.076,-891.085"/>
<polygon fill="#000000" stroke="#000000" points="389.394,-894.529 399.969,-893.881 391.298,-887.793 389.394,-894.529"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~pfida_mc~~CallsGraph_node51" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node51"><a xlink:href=".././proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="454,-743 400,-743 400,-719 454,-719 454,-743"/>
<text text-anchor="middle" x="427" y="-728.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~pfida_mc~~CallsGraph_edge83" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M299.847,-781.936C315.935,-772.936 338.93,-760.74 360,-752 369.663,-747.992 380.381,-744.283 390.32,-741.132"/>
<polygon fill="#000000" stroke="#000000" points="391.402,-744.461 399.933,-738.177 389.346,-737.77 391.402,-744.461"/>
</g>
<!-- proc~balback -->
<g id="proc~~pfida_mc~~CallsGraph_node52" class="node"><title>proc~balback</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node52"><a xlink:href=".././proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="454,-827 400,-827 400,-803 454,-803 454,-827"/>
<text text-anchor="middle" x="427" y="-812.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~pfida_mc~~CallsGraph_edge84" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M305.281,-797.754C328.902,-801.129 363.807,-806.115 390.016,-809.859"/>
<polygon fill="#000000" stroke="#000000" points="389.552,-813.329 399.947,-811.278 390.542,-806.399 389.552,-813.329"/>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~pfida_mc~~CallsGraph_edge85" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M611.066,-182.557C617.582,-185.471 624.241,-188.962 630,-193 653.324,-209.353 674.971,-234.037 688.75,-251.453"/>
<polygon fill="#000000" stroke="#000000" points="686.324,-254.038 695.205,-259.816 691.865,-249.761 686.324,-254.038"/>
</g>
<!-- proc~uvw_to_cyl -->
<g id="proc~~pfida_mc~~CallsGraph_node55" class="node"><title>proc~uvw_to_cyl</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node55"><a xlink:href=".././proc/uvw_to_cyl.html" xlink:title="uvw_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="737.5,-184 672.5,-184 672.5,-160 737.5,-160 737.5,-184"/>
<text text-anchor="middle" x="705" y="-169.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_cyl</text>
</a>
</g>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl -->
<g id="proc~~pfida_mc~~CallsGraph_edge86" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl</title>
<path fill="none" stroke="#000000" d="M611.089,-172C626.402,-172 645.267,-172 661.989,-172"/>
<polygon fill="#000000" stroke="#000000" points="662.072,-175.5 672.072,-172 662.072,-168.5 662.072,-175.5"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~pfida_mc~~CallsGraph_node57" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node57"><a xlink:href=".././proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="607,-785 553,-785 553,-761 607,-761 607,-785"/>
<text text-anchor="middle" x="580" y="-770.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~pfida_mc~~CallsGraph_edge87" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M454.302,-773C478.769,-773 515.446,-773 542.696,-773"/>
<polygon fill="#000000" stroke="#000000" points="542.999,-776.5 552.999,-773 542.999,-769.5 542.999,-776.5"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~pfida_mc~~CallsGraph_node53" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node53"><a xlink:href=".././proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="607,-1058 553,-1058 553,-1034 607,-1034 607,-1058"/>
<text text-anchor="middle" x="580" y="-1043.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~pfida_mc~~CallsGraph_edge89" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M454.302,-1028.66C478.878,-1032.08 515.771,-1037.21 543.057,-1041"/>
<polygon fill="#000000" stroke="#000000" points="542.612,-1044.47 552.999,-1042.38 543.577,-1037.54 542.612,-1044.47"/>
</g>
<!-- proc~lubksb -->
<g id="proc~~pfida_mc~~CallsGraph_node56" class="node"><title>proc~lubksb</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node56"><a xlink:href=".././proc/lubksb.html" xlink:title="lubksb">
<polygon fill="#d9534f" stroke="#d9534f" points="607,-1016 553,-1016 553,-992 607,-992 607,-1016"/>
<text text-anchor="middle" x="580" y="-1001.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lubksb</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~lubksb -->
<g id="proc~~pfida_mc~~CallsGraph_edge88" class="edge"><title>proc~matinv&#45;&gt;proc~lubksb</title>
<path fill="none" stroke="#000000" d="M454.302,-1021.34C478.878,-1017.92 515.771,-1012.79 543.057,-1009"/>
<polygon fill="#000000" stroke="#000000" points="543.577,-1012.46 552.999,-1007.62 542.612,-1005.53 543.577,-1012.46"/>
</g>
<!-- proc~rswap -->
<g id="proc~~pfida_mc~~CallsGraph_node54" class="node"><title>proc~rswap</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node54"><a xlink:href=".././proc/rswap.html" xlink:title="RSWAP">
<polygon fill="#d9534f" stroke="#d9534f" points="607,-869 553,-869 553,-845 607,-845 607,-869"/>
<text text-anchor="middle" x="580" y="-854.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RSWAP</text>
</a>
</g>
</g>
<!-- proc~elmhes&#45;&gt;proc~rswap -->
<g id="proc~~pfida_mc~~CallsGraph_edge90" class="edge"><title>proc~elmhes&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M454.302,-857C478.769,-857 515.446,-857 542.696,-857"/>
<polygon fill="#000000" stroke="#000000" points="542.999,-860.5 552.999,-857 542.999,-853.5 542.999,-860.5"/>
</g>
<!-- proc~balance&#45;&gt;proc~rswap -->
<g id="proc~~pfida_mc~~CallsGraph_edge91" class="edge"><title>proc~balance&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M454.302,-891.684C478.878,-884.849 515.771,-874.587 543.057,-866.997"/>
<polygon fill="#000000" stroke="#000000" points="544.303,-870.284 552.999,-864.232 542.427,-863.54 544.303,-870.284"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~pfida_mc~~CallsGraph_edge92" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M736.09,-381.811C747.503,-386.291 760.687,-391.466 772.88,-396.252"/>
<polygon fill="#000000" stroke="#000000" points="771.805,-399.59 782.393,-399.986 774.363,-393.074 771.805,-399.59"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~pfida_mc~~CallsGraph_edge93" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M726.964,-357.962C732.879,-353.98 739.046,-349.217 744,-344 770.312,-316.287 791.549,-276.912 803.206,-252.709"/>
<polygon fill="#000000" stroke="#000000" points="806.521,-253.884 807.602,-243.344 800.185,-250.909 806.521,-253.884"/>
</g>
<!-- proc~balback&#45;&gt;proc~rswap -->
<g id="proc~~pfida_mc~~CallsGraph_edge94" class="edge"><title>proc~balback&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M454.302,-822.316C478.878,-829.151 515.771,-839.413 543.057,-847.003"/>
<polygon fill="#000000" stroke="#000000" points="542.427,-850.46 552.999,-849.768 544.303,-843.716 542.427,-850.46"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~pfida_mc~~CallsGraph_node58" class="node"><title>proc~outerprod</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node58"><a xlink:href=".././proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="734.5,-1079 675.5,-1079 675.5,-1055 734.5,-1055 734.5,-1079"/>
<text text-anchor="middle" x="705" y="-1064.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~pfida_mc~~CallsGraph_edge95" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M607.085,-1050.45C624.061,-1053.35 646.499,-1057.18 665.509,-1060.43"/>
<polygon fill="#000000" stroke="#000000" points="664.929,-1063.88 675.375,-1062.11 666.107,-1056.98 664.929,-1063.88"/>
</g>
<!-- proc~swap -->
<g id="proc~~pfida_mc~~CallsGraph_node59" class="node"><title>proc~swap</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node59"><a xlink:href=".././proc/swap.html" xlink:title="swap">
<polygon fill="#d9534f" stroke="#d9534f" points="732,-1037 678,-1037 678,-1013 732,-1013 732,-1037"/>
<text text-anchor="middle" x="705" y="-1022.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swap</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~swap -->
<g id="proc~~pfida_mc~~CallsGraph_edge96" class="edge"><title>proc~ludcmp&#45;&gt;proc~swap</title>
<path fill="none" stroke="#000000" d="M607.085,-1041.55C624.779,-1038.53 648.405,-1034.49 667.9,-1031.16"/>
<polygon fill="#000000" stroke="#000000" points="668.684,-1034.58 677.952,-1029.45 667.506,-1027.68 668.684,-1034.58"/>
</g>
<!-- proc~comdiv -->
<g id="proc~~pfida_mc~~CallsGraph_node60" class="node"><title>proc~comdiv</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node60"><a xlink:href=".././proc/comdiv.html" xlink:title="Comdiv">
<polygon fill="#d9534f" stroke="#d9534f" points="732,-785 678,-785 678,-761 732,-761 732,-785"/>
<text text-anchor="middle" x="705" y="-770.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Comdiv</text>
</a>
</g>
</g>
<!-- proc~hqrvec&#45;&gt;proc~comdiv -->
<g id="proc~~pfida_mc~~CallsGraph_edge97" class="edge"><title>proc~hqrvec&#45;&gt;proc~comdiv</title>
<path fill="none" stroke="#000000" d="M607.085,-773C624.779,-773 648.405,-773 667.9,-773"/>
<polygon fill="#000000" stroke="#000000" points="667.952,-776.5 677.952,-773 667.952,-769.5 667.952,-776.5"/>
</g>
</g>
</svg>
</div><script>var panprocpfida_mcCallsGraph = svgPanZoom('#procpfida_mcCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~pfida_mc~~CalledByGraph Pages: 1 -->
<svg id="procpfida_mcCalledByGraph" width="154pt" height="32pt"
 viewBox="0.00 0.00 154.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pfida_mc~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~pfida_mc~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 150,-28 150,4 -4,4"/>
<!-- proc~pfida_mc -->
<g id="proc~~pfida_mc~~CalledByGraph_node1" class="node"><title>proc~pfida_mc</title>
<polygon fill="none" stroke="black" points="146,-24 90,-24 90,-0 146,-0 146,-24"/>
<text text-anchor="middle" x="118" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">pfida_mc</text>
</g>
<!-- program~fidasim -->
<g id="proc~~pfida_mc~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~pfida_mc~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~pfida_mc -->
<g id="proc~~pfida_mc~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~pfida_mc</title>
<path fill="none" stroke="#000000" d="M54.2216,-12C62.1684,-12 71.0565,-12 79.5879,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.7302,-15.5001 89.7301,-12 79.7301,-8.5001 79.7302,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pfida_mc.html#src">pfida_mc</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">pfida_mc</span>
    <span class="c">!+ Calculate Passive FIDA emission using a Monte Carlo Fast-ion distribution</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iion</span><span class="p">,</span><span class="n">igamma</span><span class="p">,</span><span class="n">ngamma</span>
    <span class="k">type</span><span class="p">(</span><span class="n">FastIon</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fast_ion</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fields</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span> <span class="kd">::</span> <span class="n">plasma</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">phi</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ri</span>      <span class="c">!! start position</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vi</span>      <span class="c">!! velocity of fast ions</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xyz_vi</span>
    <span class="c">!! Determination of the CX probability</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">denn</span>    <span class="c">!!  neutral dens (n=1-4)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rates</span><span class="p">,</span> <span class="n">rates_is</span>    <span class="c">!! CX rates</span>
    <span class="c">!! Collisiional radiative model along track</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">states</span>  <span class="c">! Density of n-states</span>
    <span class="k">type</span><span class="p">(</span><span class="n">ParticleTrack</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">ntrack</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tracks</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ntrack</span>
    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">los_intersect</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">jj</span><span class="p">,</span> <span class="k">is</span>
<span class="k">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">photons</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">s</span><span class="p">,</span> <span class="n">c</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">randomu</span>

    <span class="n">ngamma</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">.</span><span class="nb">or</span><span class="p">.(</span><span class="n">inputs</span><span class="p">%</span><span class="n">dist_type</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">))</span> <span class="k">then</span>
<span class="k">        </span><span class="n">ngamma</span> <span class="o">=</span> <span class="nb">ceiling</span><span class="p">(</span><span class="nb">dble</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_pfida</span><span class="p">)</span><span class="o">/</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="p">)</span>
    <span class="k">endif</span>

<span class="k">    if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i10)&#39;</span><span class="p">)</span> <span class="nb">int</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="o">*</span><span class="n">ngamma</span><span class="p">,</span><span class="n">Int64</span><span class="p">)</span>
    <span class="k">endif</span>

    <span class="c">!$OMP PARALLEL DO schedule(dynamic,1) private(iion,igamma,is,fast_ion,vi,ri,phi,tracks,s,c,&amp;</span>
    <span class="c">!$OMP&amp; randomu,plasma,fields,ntrack,jj,rates,rates_is,denn,los_intersect,states,photons,xyz_vi)</span>
    <span class="n">loop_over_fast_ions</span><span class="p">:</span> <span class="k">do </span><span class="n">iion</span><span class="o">=</span><span class="n">istart</span><span class="p">,</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="p">,</span><span class="n">istep</span>
        <span class="n">fast_ion</span> <span class="o">=</span> <span class="n">particles</span><span class="p">%</span><span class="n">fast_ion</span><span class="p">(</span><span class="n">iion</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vabs</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">loop_over_fast_ions</span>
        <span class="n">gamma_loop</span><span class="p">:</span> <span class="k">do </span><span class="n">igamma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ngamma</span>
            <span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">)</span> <span class="k">then</span>
                <span class="c">!! Pick random toroidal angle</span>
                <span class="k">call </span><span class="n">randu</span><span class="p">(</span><span class="n">randomu</span><span class="p">)</span>
                <span class="n">phi</span> <span class="o">=</span> <span class="n">pass_grid</span><span class="p">%</span><span class="n">phi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">nphi</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dphi</span><span class="o">*</span><span class="n">randomu</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span>
<span class="k">                </span><span class="n">phi</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">phi</span>
            <span class="k">endif</span>
<span class="k">            </span><span class="n">s</span> <span class="o">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="nb">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>

            <span class="c">!! Calculate position in machine coordinates</span>
            <span class="n">ri</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">c</span>
            <span class="n">ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">s</span>
            <span class="n">ri</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">z</span>

            <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">dist_type</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
                <span class="c">!! Get electomagnetic fields</span>
                <span class="k">call </span><span class="n">get_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">,</span> <span class="n">input_coords</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">output_coords</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

                <span class="c">!! Correct for gyro motion and get particle position and velocity</span>
                <span class="k">call </span><span class="n">gyro_correction</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">energy</span><span class="p">,</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">pitch</span><span class="p">,</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">A</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">)</span>
            <span class="k">else</span> <span class="c">!! Full Orbit</span>
                <span class="c">!! Calculate velocity vector</span>
                <span class="n">vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vr</span> <span class="o">-</span> <span class="n">s</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vt</span>
                <span class="n">vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vr</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vt</span>
                <span class="n">vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">vz</span>
            <span class="k">endif</span>
<span class="k">            </span><span class="n">xyz_vi</span> <span class="o">=</span> <span class="nb">matmul</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">inv_basis</span><span class="p">,</span><span class="n">vi</span><span class="p">)</span>

            <span class="c">!! Track particle through grid</span>
            <span class="k">call </span><span class="n">track_cylindrical</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">,</span> <span class="n">tracks</span><span class="p">,</span> <span class="n">ntrack</span><span class="p">,</span> <span class="n">los_intersect</span><span class="p">)</span>
            <span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">los_intersect</span><span class="p">)</span> <span class="k">cycle </span><span class="n">gamma_loop</span>
            <span class="k">if</span><span class="p">(</span><span class="n">ntrack</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">gamma_loop</span>

            <span class="c">!! Calculate CX probability</span>
            <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">,</span> <span class="n">input_coords</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">rates</span> <span class="o">=</span> <span class="mf">0.d0</span>
            <span class="k">do is</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n_thermal</span>
                <span class="k">call </span><span class="n">bt_cx_rates</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span> <span class="n">plasma</span><span class="p">%</span><span class="n">denn</span><span class="p">(:,</span><span class="k">is</span><span class="p">),</span> <span class="n">thermal_mass</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="n">xyz_vi</span><span class="p">,</span> <span class="n">rates_is</span><span class="p">)</span>
                <span class="n">rates</span> <span class="o">=</span> <span class="n">rates</span> <span class="o">+</span> <span class="n">rates_is</span>
            <span class="k">enddo</span>
<span class="k">            if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span> <span class="k">cycle </span><span class="n">gamma_loop</span>

            <span class="c">!! Weight CX rates by ion source density</span>
            <span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                </span><span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">weight</span><span class="o">*</span><span class="p">(</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">nphi</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dphi</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span>  <span class="p">&amp;</span>
                       <span class="o">/</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dv</span><span class="p">)</span><span class="o">/</span><span class="n">ngamma</span>

            <span class="k">else</span>
<span class="k">                </span><span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">weight</span><span class="o">/</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dv</span><span class="p">)</span><span class="o">/</span><span class="n">ngamma</span>
            <span class="k">endif</span>

            <span class="c">!! Calculate the spectra produced in each cell along the path</span>
            <span class="n">loop_along_track</span><span class="p">:</span> <span class="k">do </span><span class="n">jj</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ntrack</span>
                <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span><span class="n">input_coords</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

                <span class="k">call </span><span class="n">colrad</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">A</span><span class="p">,</span> <span class="n">xyz_vi</span><span class="p">,</span> <span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="nb">time</span><span class="p">,</span> <span class="n">states</span><span class="p">,</span> <span class="n">denn</span><span class="p">,</span> <span class="n">photons</span><span class="p">)</span>

                <span class="k">call </span><span class="n">store_fida_photons</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span> <span class="n">xyz_vi</span><span class="p">,</span> <span class="n">beam_lambda0</span><span class="p">,</span> <span class="n">photons</span><span class="p">,</span> <span class="n">fast_ion</span><span class="p">%</span><span class="k">class</span><span class="p">,</span><span class="n">passive</span><span class="o">=</span><span class="p">.</span><span class="n">True</span><span class="p">.)</span>
            <span class="k">enddo </span><span class="n">loop_along_track</span>
        <span class="k">enddo </span><span class="n">gamma_loop</span>
    <span class="k">enddo </span><span class="n">loop_over_fast_ions</span>
    <span class="c">!$OMP END PARALLEL DO</span>

<span class="cp">#ifdef _MPI</span>
    <span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">pfida</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="k">end subroutine </span><span class="n">pfida_mc</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2021 
                                          </p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            
            
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>