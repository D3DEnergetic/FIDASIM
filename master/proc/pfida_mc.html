<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>pfida_mc &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
               
        
        
            </ul>
        
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>



          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>pfida_mc
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.5% of total for procedures.">74 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
    
     <li><a href='../module/libfida.html'>libfida</a></li>
    
  
     <li class="active">pfida_mc</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pfida_mc.html#src">pfida_mc</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine pfida_mc()
    
    
   
</h2>
    
  


    
    <p>Calculate Passive FIDA emission using a Monte Carlo Fast-ion distribution</p>
    

    <h3>Arguments</h3>
    
    <em>None</em>
    <br>
    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~pfida_mc~~CallsGraph Pages: 1 -->
<svg id="procpfida_mcCallsGraph" width="641pt" height="1057pt"
 viewBox="0.00 0.00 641.00 1056.98" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pfida_mc~~CallsGraph" class="graph" transform="scale(0.748832 0.748832) rotate(0) translate(4 1407.51)">
<title>proc~~pfida_mc~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1407.51 852,-1407.51 852,4 -4,4"/>
<!-- proc~pfida_mc -->
<g id="proc~~pfida_mc~~CallsGraph_node1" class="node"><title>proc~pfida_mc</title>
<polygon fill="none" stroke="black" points="56,-405.509 0,-405.509 0,-381.509 56,-381.509 56,-405.509"/>
<text text-anchor="middle" x="28" y="-391.109" font-family="Helvetica,sans-Serif" font-size="10.50">pfida_mc</text>
</g>
<!-- proc~colrad -->
<g id="proc~~pfida_mc~~CallsGraph_node2" class="node"><title>proc~colrad</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node2"><a xlink:href=".././proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="171,-1078.51 117,-1078.51 117,-1054.51 171,-1054.51 171,-1078.51"/>
<text text-anchor="middle" x="144" y="-1064.11" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~colrad -->
<g id="proc~~pfida_mc~~CallsGraph_edge1" class="edge"><title>proc~pfida_mc&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M30.9543,-405.819C38.565,-453.677 67.0341,-631.955 92,-778.509 108.93,-877.889 130.274,-996.341 139.004,-1044.51"/>
<polygon fill="#000000" stroke="#000000" points="135.577,-1045.23 140.806,-1054.45 142.465,-1043.98 135.577,-1045.23"/>
</g>
<!-- interface~randu -->
<g id="proc~~pfida_mc~~CallsGraph_node3" class="node"><title>interface~randu</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node3"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="305,-405.509 251,-405.509 251,-381.509 305,-381.509 305,-405.509"/>
<text text-anchor="middle" x="278" y="-391.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;interface~randu -->
<g id="proc~~pfida_mc~~CallsGraph_edge2" class="edge"><title>proc~pfida_mc&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M56.0124,-393.509C100.784,-393.509 190.403,-393.509 240.671,-393.509"/>
<polygon fill="#000000" stroke="#000000" points="240.77,-397.009 250.769,-393.509 240.769,-390.009 240.77,-397.009"/>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~pfida_mc~~CallsGraph_node4" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node4"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="180.5,-769.509 107.5,-769.509 107.5,-745.509 180.5,-745.509 180.5,-769.509"/>
<text text-anchor="middle" x="144" y="-755.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;interface~parallel_sum -->
<g id="proc~~pfida_mc~~CallsGraph_edge3" class="edge"><title>proc~pfida_mc&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M32.793,-405.62C49.2589,-458.195 114.677,-667.073 136.14,-735.604"/>
<polygon fill="#000000" stroke="#000000" points="132.864,-736.856 139.193,-745.353 139.544,-734.764 132.864,-736.856"/>
</g>
<!-- proc~gyro_correction -->
<g id="proc~~pfida_mc~~CallsGraph_node5" class="node"><title>proc~gyro_correction</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node5"><a xlink:href=".././proc/gyro_correction.html" xlink:title="gyro_correction">
<polygon fill="#d9534f" stroke="#d9534f" points="187.5,-364.509 100.5,-364.509 100.5,-340.509 187.5,-340.509 187.5,-364.509"/>
<text text-anchor="middle" x="144" y="-350.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_correction</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~gyro_correction -->
<g id="proc~~pfida_mc~~CallsGraph_edge4" class="edge"><title>proc~pfida_mc&#45;&gt;proc~gyro_correction</title>
<path fill="none" stroke="#000000" d="M56.0164,-383.793C69.0872,-379.092 85.0985,-373.333 99.8053,-368.044"/>
<polygon fill="#000000" stroke="#000000" points="101.012,-371.33 109.237,-364.652 98.6428,-364.743 101.012,-371.33"/>
</g>
<!-- proc~store_fida_photons -->
<g id="proc~~pfida_mc~~CallsGraph_node6" class="node"><title>proc~store_fida_photons</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node6"><a xlink:href=".././proc/store_fida_photons.html" xlink:title="store_fida_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="196,-446.509 92,-446.509 92,-422.509 196,-422.509 196,-446.509"/>
<text text-anchor="middle" x="144" y="-432.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_fida_photons</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~store_fida_photons -->
<g id="proc~~pfida_mc~~CallsGraph_edge5" class="edge"><title>proc~pfida_mc&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M56.0164,-403.226C69.0872,-407.926 85.0985,-413.685 99.8053,-418.974"/>
<polygon fill="#000000" stroke="#000000" points="98.6428,-422.275 109.237,-422.366 101.012,-415.689 98.6428,-422.275"/>
</g>
<!-- proc~bt_cx_rates -->
<g id="proc~~pfida_mc~~CallsGraph_node7" class="node"><title>proc~bt_cx_rates</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node7"><a xlink:href=".././proc/bt_cx_rates.html" xlink:title="bt_cx_rates">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-526.509 110,-526.509 110,-502.509 178,-502.509 178,-526.509"/>
<text text-anchor="middle" x="144" y="-512.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bt_cx_rates</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~bt_cx_rates -->
<g id="proc~~pfida_mc~~CallsGraph_edge6" class="edge"><title>proc~pfida_mc&#45;&gt;proc~bt_cx_rates</title>
<path fill="none" stroke="#000000" d="M40.3475,-405.553C59.9635,-426.374 100.397,-469.29 124.246,-494.603"/>
<polygon fill="#000000" stroke="#000000" points="121.954,-497.275 131.359,-502.153 127.049,-492.475 121.954,-497.275"/>
</g>
<!-- proc~track_cylindrical -->
<g id="proc~~pfida_mc~~CallsGraph_node8" class="node"><title>proc~track_cylindrical</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node8"><a xlink:href=".././proc/track_cylindrical.html" xlink:title="track_cylindrical">
<polygon fill="#d9534f" stroke="#d9534f" points="322,-218.509 234,-218.509 234,-194.509 322,-194.509 322,-218.509"/>
<text text-anchor="middle" x="278" y="-204.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track_cylindrical</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~track_cylindrical -->
<g id="proc~~pfida_mc~~CallsGraph_edge7" class="edge"><title>proc~pfida_mc&#45;&gt;proc~track_cylindrical</title>
<path fill="none" stroke="#000000" d="M30.9452,-381.463C35.933,-354.596 51.7375,-289.472 92,-255.509 128.797,-224.47 183.201,-212.869 223.496,-208.647"/>
<polygon fill="#000000" stroke="#000000" points="224.042,-212.111 233.677,-207.704 223.396,-205.141 224.042,-212.111"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~pfida_mc~~CallsGraph_node9" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node9"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="461,-75.5091 393,-75.5091 393,-51.5091 461,-51.5091 461,-75.5091"/>
<text text-anchor="middle" x="427" y="-61.1091" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~get_plasma -->
<g id="proc~~pfida_mc~~CallsGraph_edge8" class="edge"><title>proc~pfida_mc&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M29.9501,-381.114C33.0441,-348.861 45.5051,-261.242 92,-209.509 170.925,-121.693 312.215,-84.3295 383.044,-70.5226"/>
<polygon fill="#000000" stroke="#000000" points="383.788,-73.9441 392.967,-68.6533 382.492,-67.0651 383.788,-73.9441"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~pfida_mc~~CallsGraph_node10" class="node"><title>proc~get_fields</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node10"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="456,-281.509 398,-281.509 398,-257.509 456,-257.509 456,-281.509"/>
<text text-anchor="middle" x="427" y="-267.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~pfida_mc&#45;&gt;proc~get_fields -->
<g id="proc~~pfida_mc~~CallsGraph_edge9" class="edge"><title>proc~pfida_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M38.3656,-381.248C49.645,-367.288 69.8572,-344.713 92,-331.509 187.007,-274.856 322.084,-267.937 387.518,-268.286"/>
<polygon fill="#000000" stroke="#000000" points="387.74,-271.789 397.78,-268.405 387.821,-264.789 387.74,-271.789"/>
</g>
<!-- proc~linsolve -->
<g id="proc~~pfida_mc~~CallsGraph_node27" class="node"><title>proc~linsolve</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node27"><a xlink:href=".././proc/linsolve.html" xlink:title="linsolve">
<polygon fill="#d9534f" stroke="#d9534f" points="305,-1298.51 251,-1298.51 251,-1274.51 305,-1274.51 305,-1298.51"/>
<text text-anchor="middle" x="278" y="-1284.11" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linsolve</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~linsolve -->
<g id="proc~~pfida_mc~~CallsGraph_edge10" class="edge"><title>proc~colrad&#45;&gt;proc~linsolve</title>
<path fill="none" stroke="#000000" d="M152.285,-1078.65C173.831,-1114.56 237.43,-1220.56 264.536,-1265.74"/>
<polygon fill="#000000" stroke="#000000" points="261.591,-1267.63 269.738,-1274.41 267.594,-1264.03 261.591,-1267.63"/>
</g>
<!-- proc~eigen -->
<g id="proc~~pfida_mc~~CallsGraph_node32" class="node"><title>proc~eigen</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node32"><a xlink:href=".././proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="305,-1130.51 251,-1130.51 251,-1106.51 305,-1106.51 305,-1130.51"/>
<text text-anchor="middle" x="278" y="-1116.11" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~pfida_mc~~CallsGraph_edge11" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M171.079,-1076.78C191.237,-1084.72 219.354,-1095.8 241.554,-1104.55"/>
<polygon fill="#000000" stroke="#000000" points="240.388,-1107.85 250.975,-1108.26 242.954,-1101.34 240.388,-1107.85"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~pfida_mc~~CallsGraph_node37" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node37"><a xlink:href=".././proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="624,-922.509 536,-922.509 536,-898.509 624,-898.509 624,-922.509"/>
<text text-anchor="middle" x="580" y="-908.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~pfida_mc~~CallsGraph_edge12" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M171.098,-1062.83C230.721,-1053.73 380.529,-1026.85 494,-972.509 517.568,-961.222 541.34,-943.188 557.728,-929.472"/>
<polygon fill="#000000" stroke="#000000" points="560.26,-931.912 565.584,-922.752 555.71,-926.592 560.26,-931.912"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~pfida_mc~~CallsGraph_node12" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node12"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="472.5,-893.509 381.5,-893.509 381.5,-869.509 472.5,-869.509 472.5,-893.509"/>
<text text-anchor="middle" x="427" y="-879.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~pfida_mc~~CallsGraph_edge15" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M150.882,-769.562C162.691,-792.281 191.649,-841.077 232,-862.509 274.844,-885.265 330.537,-888.494 371.254,-886.929"/>
<polygon fill="#000000" stroke="#000000" points="371.451,-890.424 381.267,-886.437 371.107,-883.432 371.451,-890.424"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~pfida_mc~~CallsGraph_node13" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node13"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="323.5,-975.509 232.5,-975.509 232.5,-951.509 323.5,-951.509 323.5,-975.509"/>
<text text-anchor="middle" x="278" y="-961.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~pfida_mc~~CallsGraph_edge16" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M147.624,-769.546C155.201,-801.694 179.973,-890.635 232,-942.509 233.068,-943.574 234.201,-944.592 235.384,-945.564"/>
<polygon fill="#000000" stroke="#000000" points="233.553,-948.552 243.778,-951.326 237.514,-942.781 233.553,-948.552"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~pfida_mc~~CallsGraph_node17" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node17"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="323.5,-933.509 232.5,-933.509 232.5,-909.509 323.5,-909.509 323.5,-933.509"/>
<text text-anchor="middle" x="278" y="-919.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~pfida_mc~~CallsGraph_edge19" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M150.151,-769.563C161.645,-795.339 191.59,-856.628 232,-895.509 235.233,-898.619 238.907,-901.502 242.73,-904.129"/>
<polygon fill="#000000" stroke="#000000" points="240.89,-907.106 251.221,-909.458 244.611,-901.177 240.89,-907.106"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~pfida_mc~~CallsGraph_node18" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node18"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="471,-681.509 383,-681.509 383,-657.509 471,-657.509 471,-681.509"/>
<text text-anchor="middle" x="427" y="-667.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~pfida_mc~~CallsGraph_edge14" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M157.323,-745.43C173.159,-730.706 202.183,-706.331 232,-694.509 277.303,-676.548 332.779,-670.868 372.785,-669.344"/>
<polygon fill="#000000" stroke="#000000" points="372.976,-672.84 382.864,-669.035 372.761,-665.843 372.976,-672.84"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~pfida_mc~~CallsGraph_node23" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node23"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="322,-769.509 234,-769.509 234,-745.509 322,-745.509 322,-769.509"/>
<text text-anchor="middle" x="278" y="-755.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~pfida_mc~~CallsGraph_edge21" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M180.721,-757.509C193.869,-757.509 209.064,-757.509 223.442,-757.509"/>
<polygon fill="#000000" stroke="#000000" points="223.725,-761.009 233.725,-757.509 223.725,-754.009 223.725,-761.009"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~pfida_mc~~CallsGraph_node24" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node24"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="322,-727.509 234,-727.509 234,-703.509 322,-703.509 322,-727.509"/>
<text text-anchor="middle" x="278" y="-713.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~pfida_mc~~CallsGraph_edge22" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M180.721,-746.143C195.643,-741.395 213.202,-735.809 229.21,-730.715"/>
<polygon fill="#000000" stroke="#000000" points="230.471,-733.987 238.939,-727.619 228.349,-727.316 230.471,-733.987"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~pfida_mc~~CallsGraph_node29" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node29"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="323.5,-605.509 232.5,-605.509 232.5,-581.509 323.5,-581.509 323.5,-605.509"/>
<text text-anchor="middle" x="278" y="-591.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~pfida_mc~~CallsGraph_edge17" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M149.612,-745.136C160.247,-718.1 188.923,-653.092 232,-614.509 233.325,-613.323 234.728,-612.191 236.188,-611.113"/>
<polygon fill="#000000" stroke="#000000" points="238.452,-613.823 245.033,-605.52 234.711,-607.907 238.452,-613.823"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~pfida_mc~~CallsGraph_node31" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node31"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="322,-647.509 234,-647.509 234,-623.509 322,-623.509 322,-647.509"/>
<text text-anchor="middle" x="278" y="-633.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~pfida_mc~~CallsGraph_edge18" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M153.893,-745.484C168.607,-726.143 199.624,-687.649 232,-661.509 235.751,-658.48 239.897,-655.583 244.11,-652.894"/>
<polygon fill="#000000" stroke="#000000" points="245.985,-655.851 252.745,-647.693 242.373,-649.855 245.985,-655.851"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~pfida_mc~~CallsGraph_node34" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node34"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="323.5,-853.509 232.5,-853.509 232.5,-829.509 323.5,-829.509 323.5,-853.509"/>
<text text-anchor="middle" x="278" y="-839.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~pfida_mc~~CallsGraph_edge13" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M159.804,-769.574C176.658,-782.984 205.317,-804.815 232,-820.509 234.508,-821.984 237.137,-823.435 239.811,-824.843"/>
<polygon fill="#000000" stroke="#000000" points="238.461,-828.082 248.969,-829.435 241.598,-821.824 238.461,-828.082"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~pfida_mc~~CallsGraph_node36" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node36"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="323.5,-811.509 232.5,-811.509 232.5,-787.509 323.5,-787.509 323.5,-811.509"/>
<text text-anchor="middle" x="278" y="-797.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~pfida_mc~~CallsGraph_edge20" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M180.721,-768.875C195.643,-773.623 213.202,-779.21 229.21,-784.303"/>
<polygon fill="#000000" stroke="#000000" points="228.349,-787.702 238.939,-787.399 230.471,-781.031 228.349,-787.702"/>
</g>
<!-- proc~gyro_correction&#45;&gt;interface~randu -->
<g id="proc~~pfida_mc~~CallsGraph_edge23" class="edge"><title>proc~gyro_correction&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M183.89,-364.589C201.945,-370.196 223.275,-376.822 240.961,-382.315"/>
<polygon fill="#000000" stroke="#000000" points="240.313,-385.779 250.901,-385.403 242.39,-379.094 240.313,-385.779"/>
</g>
<!-- proc~pitch_to_vec -->
<g id="proc~~pfida_mc~~CallsGraph_node16" class="node"><title>proc~pitch_to_vec</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node16"><a xlink:href=".././proc/pitch_to_vec.html" xlink:title="pitch_to_vec">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-321.509 241.5,-321.509 241.5,-297.509 314.5,-297.509 314.5,-321.509"/>
<text text-anchor="middle" x="278" y="-307.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pitch_to_vec</text>
</a>
</g>
</g>
<!-- proc~gyro_correction&#45;&gt;proc~pitch_to_vec -->
<g id="proc~~pfida_mc~~CallsGraph_edge25" class="edge"><title>proc~gyro_correction&#45;&gt;proc~pitch_to_vec</title>
<path fill="none" stroke="#000000" d="M182.121,-340.417C197.403,-335.439 215.257,-329.622 231.33,-324.386"/>
<polygon fill="#000000" stroke="#000000" points="232.644,-327.64 241.068,-321.214 230.476,-320.984 232.644,-327.64"/>
</g>
<!-- proc~gyro_step -->
<g id="proc~~pfida_mc~~CallsGraph_node22" class="node"><title>proc~gyro_step</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node22"><a xlink:href=".././proc/gyro_step.html" xlink:title="gyro_step">
<polygon fill="#d9534f" stroke="#d9534f" points="308,-363.509 248,-363.509 248,-339.509 308,-339.509 308,-363.509"/>
<text text-anchor="middle" x="278" y="-349.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_step</text>
</a>
</g>
</g>
<!-- proc~gyro_correction&#45;&gt;proc~gyro_step -->
<g id="proc~~pfida_mc~~CallsGraph_edge24" class="edge"><title>proc~gyro_correction&#45;&gt;proc~gyro_step</title>
<path fill="none" stroke="#000000" d="M187.857,-352.184C203.759,-352.064 221.715,-351.928 237.322,-351.81"/>
<polygon fill="#000000" stroke="#000000" points="237.724,-355.307 247.697,-351.731 237.671,-348.307 237.724,-355.307"/>
</g>
<!-- proc~store_photons -->
<g id="proc~~pfida_mc~~CallsGraph_node25" class="node"><title>proc~store_photons</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node25"><a xlink:href=".././proc/store_photons.html" xlink:title="store_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="318.5,-447.509 237.5,-447.509 237.5,-423.509 318.5,-423.509 318.5,-447.509"/>
<text text-anchor="middle" x="278" y="-433.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_photons</text>
</a>
</g>
</g>
<!-- proc~store_fida_photons&#45;&gt;proc~store_photons -->
<g id="proc~~pfida_mc~~CallsGraph_edge26" class="edge"><title>proc~store_fida_photons&#45;&gt;proc~store_photons</title>
<path fill="none" stroke="#000000" d="M196.035,-434.896C206.157,-434.972 216.776,-435.053 226.868,-435.129"/>
<polygon fill="#000000" stroke="#000000" points="227.126,-438.631 237.152,-435.207 227.179,-431.631 227.126,-438.631"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~pfida_mc~~CallsGraph_node30" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node30"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="743.5,-567.509 666.5,-567.509 666.5,-543.509 743.5,-543.509 743.5,-567.509"/>
<text text-anchor="middle" x="705" y="-553.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~bt_cx_rates&#45;&gt;interface~interpol_coeff -->
<g id="proc~~pfida_mc~~CallsGraph_edge27" class="edge"><title>proc~bt_cx_rates&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M178.294,-516.951C273.13,-523.907 544.974,-543.845 655.945,-551.985"/>
<polygon fill="#000000" stroke="#000000" points="655.942,-555.494 666.171,-552.735 656.454,-548.512 655.942,-555.494"/>
</g>
<!-- proc~track_cylindrical&#45;&gt;proc~get_plasma -->
<g id="proc~~pfida_mc~~CallsGraph_edge33" class="edge"><title>proc~track_cylindrical&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M283.707,-194.491C293.873,-170.092 320.221,-114.522 360,-84.5091 366.83,-79.3558 374.962,-75.4449 383.145,-72.4837"/>
<polygon fill="#000000" stroke="#000000" points="384.242,-75.8077 392.699,-69.4264 382.108,-69.1407 384.242,-75.8077"/>
</g>
<!-- proc~track_cylindrical&#45;&gt;proc~get_fields -->
<g id="proc~~pfida_mc~~CallsGraph_edge34" class="edge"><title>proc~track_cylindrical&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M299.847,-218.574C315.935,-227.573 338.93,-239.769 360,-248.509 368.891,-252.197 378.674,-255.632 387.923,-258.611"/>
<polygon fill="#000000" stroke="#000000" points="387.093,-262.018 397.682,-261.656 389.178,-255.336 387.093,-262.018"/>
</g>
<!-- proc~line_cylinder_intersect -->
<g id="proc~~pfida_mc~~CallsGraph_node14" class="node"><title>proc~line_cylinder_intersect</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node14"><a xlink:href=".././proc/line_cylinder_intersect.html" xlink:title="line_cylinder_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="486,-117.509 368,-117.509 368,-93.5091 486,-93.5091 486,-117.509"/>
<text text-anchor="middle" x="427" y="-103.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">line_cylinder_intersect</text>
</a>
</g>
</g>
<!-- proc~track_cylindrical&#45;&gt;proc~line_cylinder_intersect -->
<g id="proc~~pfida_mc~~CallsGraph_edge32" class="edge"><title>proc~track_cylindrical&#45;&gt;proc~line_cylinder_intersect</title>
<path fill="none" stroke="#000000" d="M289.42,-194.373C303.866,-178.176 331.442,-149.458 360,-131.509 365.815,-127.855 372.228,-124.558 378.703,-121.638"/>
<polygon fill="#000000" stroke="#000000" points="380.327,-124.751 388.171,-117.63 377.598,-118.305 380.327,-124.751"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~pfida_mc~~CallsGraph_node15" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node15"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="846.5,-75.5091 781.5,-75.5091 781.5,-51.5091 846.5,-51.5091 846.5,-75.5091"/>
<text text-anchor="middle" x="814" y="-61.1091" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~track_cylindrical&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~pfida_mc~~CallsGraph_edge35" class="edge"><title>proc~track_cylindrical&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M280.704,-194.136C285.847,-162.19 304.438,-77.0366 360,-42.5091 492.051,39.5499 689.925,-17.4835 773.5,-47.8508"/>
<polygon fill="#000000" stroke="#000000" points="772.52,-51.2202 783.113,-51.4108 774.951,-44.6559 772.52,-51.2202"/>
</g>
<!-- proc~line_plane_intersect -->
<g id="proc~~pfida_mc~~CallsGraph_node19" class="node"><title>proc~line_plane_intersect</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node19"><a xlink:href=".././proc/line_plane_intersect.html" xlink:title="line_plane_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="481,-239.509 373,-239.509 373,-215.509 481,-215.509 481,-239.509"/>
<text text-anchor="middle" x="427" y="-225.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">line_plane_intersect</text>
</a>
</g>
</g>
<!-- proc~track_cylindrical&#45;&gt;proc~line_plane_intersect -->
<g id="proc~~pfida_mc~~CallsGraph_edge28" class="edge"><title>proc~track_cylindrical&#45;&gt;proc~line_plane_intersect</title>
<path fill="none" stroke="#000000" d="M322.31,-212.696C334.93,-214.499 348.987,-216.507 362.576,-218.449"/>
<polygon fill="#000000" stroke="#000000" points="362.451,-221.966 372.845,-219.916 363.441,-215.036 362.451,-221.966"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~pfida_mc~~CallsGraph_node20" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node20"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="610.5,-201.509 549.5,-201.509 549.5,-177.509 610.5,-177.509 610.5,-201.509"/>
<text text-anchor="middle" x="580" y="-187.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~track_cylindrical&#45;&gt;proc~in_plasma -->
<g id="proc~~pfida_mc~~CallsGraph_edge30" class="edge"><title>proc~track_cylindrical&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M296.351,-194.372C312.12,-184.131 336.454,-170.251 360,-164.509 417.86,-150.4 435.053,-156.02 494,-164.509 509.069,-166.679 525.192,-170.908 539.301,-175.28"/>
<polygon fill="#000000" stroke="#000000" points="538.583,-178.726 549.175,-178.461 540.73,-172.063 538.583,-178.726"/>
</g>
<!-- proc~get_passive_grid_indices -->
<g id="proc~~pfida_mc~~CallsGraph_node26" class="node"><title>proc~get_passive_grid_indices</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node26"><a xlink:href=".././proc/get_passive_grid_indices.html" xlink:title="get_passive_grid_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="493.5,-403.509 360.5,-403.509 360.5,-379.509 493.5,-379.509 493.5,-403.509"/>
<text text-anchor="middle" x="427" y="-389.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_passive_grid_indices</text>
</a>
</g>
</g>
<!-- proc~track_cylindrical&#45;&gt;proc~get_passive_grid_indices -->
<g id="proc~~pfida_mc~~CallsGraph_edge29" class="edge"><title>proc~track_cylindrical&#45;&gt;proc~get_passive_grid_indices</title>
<path fill="none" stroke="#000000" d="M285.384,-218.709C297.928,-242.101 327.424,-294.327 360,-332.509 372.722,-347.42 389.148,-362.117 402.43,-373.112"/>
<polygon fill="#000000" stroke="#000000" points="400.264,-375.862 410.233,-379.449 404.677,-370.428 400.264,-375.862"/>
</g>
<!-- proc~plane_basis -->
<g id="proc~~pfida_mc~~CallsGraph_node28" class="node"><title>proc~plane_basis</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node28"><a xlink:href=".././proc/plane_basis.html" xlink:title="plane_basis">
<polygon fill="#d9534f" stroke="#d9534f" points="462,-323.509 392,-323.509 392,-299.509 462,-299.509 462,-323.509"/>
<text text-anchor="middle" x="427" y="-309.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">plane_basis</text>
</a>
</g>
</g>
<!-- proc~track_cylindrical&#45;&gt;proc~plane_basis -->
<g id="proc~~pfida_mc~~CallsGraph_edge31" class="edge"><title>proc~track_cylindrical&#45;&gt;proc~plane_basis</title>
<path fill="none" stroke="#000000" d="M287.54,-218.631C300.952,-236.806 328.679,-271.054 360,-290.509 366.751,-294.702 374.415,-298.13 382.072,-300.908"/>
<polygon fill="#000000" stroke="#000000" points="381.102,-304.274 391.696,-304.089 383.299,-297.628 381.102,-304.274"/>
</g>
<!-- proc~doppler_stark -->
<g id="proc~~pfida_mc~~CallsGraph_node38" class="node"><title>proc~doppler_stark</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node38"><a xlink:href=".././proc/doppler_stark.html" xlink:title="doppler_stark">
<polygon fill="#d9534f" stroke="#d9534f" points="466,-197.509 388,-197.509 388,-173.509 466,-173.509 466,-197.509"/>
<text text-anchor="middle" x="427" y="-183.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">doppler_stark</text>
</a>
</g>
</g>
<!-- proc~track_cylindrical&#45;&gt;proc~doppler_stark -->
<g id="proc~~pfida_mc~~CallsGraph_edge36" class="edge"><title>proc~track_cylindrical&#45;&gt;proc~doppler_stark</title>
<path fill="none" stroke="#000000" d="M322.31,-200.322C339.807,-197.822 360.067,-194.928 378.011,-192.365"/>
<polygon fill="#000000" stroke="#000000" points="378.584,-195.818 387.989,-190.939 377.594,-188.889 378.584,-195.818"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~pfida_mc~~CallsGraph_node11" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node11"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="848,-219.509 780,-219.509 780,-195.509 848,-195.509 848,-219.509"/>
<text text-anchor="middle" x="814" y="-205.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~pfida_mc~~CallsGraph_edge39" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M461.278,-61.8795C502.24,-60.9722 573.332,-63.0091 630,-83.5091 695.594,-107.238 760.294,-159.779 792.304,-188.258"/>
<polygon fill="#000000" stroke="#000000" points="790.312,-191.175 800.08,-195.279 795.003,-185.979 790.312,-191.175"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~pfida_mc~~CallsGraph_edge37" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M461.057,-68.2158C472.595,-71.2583 484.918,-76.2664 494,-84.5091 524.077,-111.806 501.279,-139.788 530,-168.509 533.019,-171.528 536.54,-174.14 540.285,-176.395"/>
<polygon fill="#000000" stroke="#000000" points="538.805,-179.57 549.299,-181.03 542.006,-173.344 538.805,-179.57"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~pfida_mc~~CallsGraph_node21" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node21"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="739,-221.509 671,-221.509 671,-197.509 739,-197.509 739,-221.509"/>
<text text-anchor="middle" x="705" y="-207.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~pfida_mc~~CallsGraph_edge38" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M461.087,-68.2251C503.112,-75.4138 576.581,-92.081 630,-126.509 655.38,-142.866 677.37,-170.218 690.638,-189.024"/>
<polygon fill="#000000" stroke="#000000" points="687.892,-191.208 696.428,-197.484 693.669,-187.255 687.892,-191.208"/>
</g>
<!-- proc~get_position -->
<g id="proc~~pfida_mc~~CallsGraph_node35" class="node"><title>proc~get_position</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node35"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="615,-159.509 545,-159.509 545,-135.509 615,-135.509 615,-159.509"/>
<text text-anchor="middle" x="580" y="-145.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~pfida_mc~~CallsGraph_edge40" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M461.272,-70.6526C472.2,-73.8771 484.078,-78.3771 494,-84.5091 513.517,-96.5714 511.644,-107.743 530,-121.509 534.225,-124.678 538.889,-127.682 543.61,-130.447"/>
<polygon fill="#000000" stroke="#000000" points="542.212,-133.674 552.657,-135.45 545.599,-127.548 542.212,-133.674"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~pfida_mc~~CallsGraph_edge41" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M456.077,-277.952C495.374,-288.523 568.829,-303.733 630,-290.509 688.22,-277.923 750.184,-245.204 785,-224.807"/>
<polygon fill="#000000" stroke="#000000" points="786.854,-227.776 793.661,-219.657 783.277,-221.76 786.854,-227.776"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~pfida_mc~~CallsGraph_edge42" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M456.093,-263.458C468.257,-260.122 482.346,-255.259 494,-248.509 512.782,-237.63 512.271,-228.03 530,-215.509 534.523,-212.315 539.486,-209.244 544.464,-206.402"/>
<polygon fill="#000000" stroke="#000000" points="546.244,-209.417 553.347,-201.556 542.892,-203.272 546.244,-209.417"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~pfida_mc~~CallsGraph_edge44" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M456.24,-263.37C504.713,-252.832 604.03,-231.242 661.101,-218.835"/>
<polygon fill="#000000" stroke="#000000" points="661.876,-222.248 670.904,-216.704 660.389,-215.408 661.876,-222.248"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~pfida_mc~~CallsGraph_node33" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node33"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="630,-281.509 530,-281.509 530,-257.509 630,-257.509 630,-281.509"/>
<text text-anchor="middle" x="580" y="-267.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~pfida_mc~~CallsGraph_edge43" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M456.048,-269.509C473.866,-269.509 497.614,-269.509 519.486,-269.509"/>
<polygon fill="#000000" stroke="#000000" points="519.706,-273.009 529.706,-269.509 519.705,-266.009 519.706,-273.009"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~pfida_mc~~CallsGraph_edge45" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M456.285,-265.864C469.06,-262.972 483.588,-257.79 494,-248.509 523.106,-222.566 502.184,-195.83 530,-168.509 531.849,-166.693 533.879,-165.023 536.03,-163.489"/>
<polygon fill="#000000" stroke="#000000" points="538.021,-166.376 544.787,-158.224 534.414,-160.377 538.021,-166.376"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~pfida_mc~~CallsGraph_edge47" class="edge"><title>proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M402.529,-893.523C393.984,-902.481 402.141,-911.509 427,-911.509 442.149,-911.509 451.095,-908.157 453.839,-903.51"/>
<polygon fill="#000000" stroke="#000000" points="457.184,-902.446 451.471,-893.523 450.373,-904.061 457.184,-902.446"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~pfida_mc~~CallsGraph_node48" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="619.5,-796.509 540.5,-796.509 540.5,-772.509 619.5,-772.509 619.5,-796.509"/>
<text text-anchor="middle" x="580" y="-782.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~pfida_mc~~CallsGraph_edge46" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M464.61,-869.491C474.455,-865.622 484.892,-860.914 494,-855.509 518.583,-840.92 543.281,-819.33 559.669,-803.791"/>
<polygon fill="#000000" stroke="#000000" points="562.245,-806.169 567.01,-796.706 557.384,-801.133 562.245,-806.169"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~pfida_mc~~CallsGraph_edge49" class="edge"><title>proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M306.348,-951.293C312.227,-948.515 318.364,-945.499 324,-942.509 349.764,-928.84 378.174,-911.668 398.453,-899.029"/>
<polygon fill="#000000" stroke="#000000" points="400.546,-901.848 407.159,-893.57 396.828,-895.917 400.546,-901.848"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~pfida_mc~~CallsGraph_edge48" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M323.779,-971.219C370.295,-976.737 443.244,-978.149 494,-944.509 506.777,-936.041 549.378,-847.703 568.977,-806.037"/>
<polygon fill="#000000" stroke="#000000" points="572.253,-807.293 573.326,-796.753 565.914,-804.324 572.253,-807.293"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~pfida_mc~~CallsGraph_edge51" class="edge"><title>proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M323.105,-909.508C338.442,-905.334 355.825,-900.604 371.878,-896.236"/>
<polygon fill="#000000" stroke="#000000" points="372.942,-899.574 381.672,-893.571 371.104,-892.819 372.942,-899.574"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~pfida_mc~~CallsGraph_edge50" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M323.735,-933.197C369.557,-942.572 441.342,-949.855 494,-920.509 537.921,-896.032 562.174,-838.413 572.651,-806.59"/>
<polygon fill="#000000" stroke="#000000" points="576.046,-807.46 575.685,-796.872 569.364,-805.374 576.046,-807.46"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~pfida_mc~~CallsGraph_edge53" class="edge"><title>proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M402.529,-681.523C393.984,-690.481 402.141,-699.509 427,-699.509 442.149,-699.509 451.095,-696.157 453.839,-691.51"/>
<polygon fill="#000000" stroke="#000000" points="457.184,-690.446 451.471,-681.523 450.373,-692.061 457.184,-690.446"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~pfida_mc~~CallsGraph_edge52" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M447.439,-681.683C460.789,-690.233 478.779,-702.13 494,-713.509 516.499,-730.329 541.001,-751.074 557.892,-765.787"/>
<polygon fill="#000000" stroke="#000000" points="555.703,-768.522 565.531,-772.481 560.317,-763.258 555.703,-768.522"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~pfida_mc~~CallsGraph_edge56" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M610.533,-177.509C617.012,-174.695 623.789,-171.609 630,-168.509 686.26,-140.431 749.353,-102.797 784.819,-81.047"/>
<polygon fill="#000000" stroke="#000000" points="786.961,-83.8387 793.64,-75.6149 783.29,-77.8781 786.961,-83.8387"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~pfida_mc~~CallsGraph_edge54" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M610.775,-194.351C625.73,-196.782 644.132,-199.774 660.624,-202.456"/>
<polygon fill="#000000" stroke="#000000" points="660.166,-205.927 670.598,-204.078 661.289,-199.018 660.166,-205.927"/>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~pfida_mc~~CallsGraph_edge55" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M594.29,-201.807C605.505,-212.935 621.114,-230.326 630,-248.509 662.766,-315.555 648.413,-339.987 666,-412.509 676.422,-455.485 690.011,-505.326 697.794,-533.366"/>
<polygon fill="#000000" stroke="#000000" points="694.51,-534.619 700.566,-543.313 701.253,-532.74 694.51,-534.619"/>
</g>
<!-- proc~cross_product -->
<g id="proc~~pfida_mc~~CallsGraph_node47" class="node"><title>proc~cross_product</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node47"><a xlink:href=".././proc/cross_product.html" xlink:title="cross_product">
<polygon fill="#d94e8f" stroke="#d94e8f" points="620,-361.509 540,-361.509 540,-337.509 620,-337.509 620,-361.509"/>
<text text-anchor="middle" x="580" y="-347.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cross_product</text>
</a>
</g>
</g>
<!-- proc~gyro_step&#45;&gt;proc~cross_product -->
<g id="proc~~pfida_mc~~CallsGraph_edge57" class="edge"><title>proc~gyro_step&#45;&gt;proc~cross_product</title>
<path fill="none" stroke="#000000" d="M308.038,-351.315C359.298,-350.974 466.363,-350.26 529.481,-349.839"/>
<polygon fill="#000000" stroke="#000000" points="529.621,-353.338 539.597,-349.772 529.574,-346.339 529.621,-353.338"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~pfida_mc~~CallsGraph_edge58" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M322.302,-761.406C377.447,-766.369 472.483,-774.923 530.157,-780.113"/>
<polygon fill="#000000" stroke="#000000" points="530.199,-783.631 540.473,-781.042 530.827,-776.659 530.199,-783.631"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~pfida_mc~~CallsGraph_edge60" class="edge"><title>proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M317.623,-703.423C336.106,-697.639 358.421,-690.656 377.986,-684.534"/>
<polygon fill="#000000" stroke="#000000" points="379.137,-687.841 387.635,-681.514 377.047,-681.161 379.137,-687.841"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~pfida_mc~~CallsGraph_edge59" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M322.029,-723.61C365.573,-732.02 434.744,-745.96 494,-760.509 505.867,-763.423 518.582,-766.848 530.467,-770.184"/>
<polygon fill="#000000" stroke="#000000" points="529.643,-773.588 540.219,-772.952 531.555,-766.854 529.643,-773.588"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_fields -->
<g id="proc~~pfida_mc~~CallsGraph_edge64" class="edge"><title>proc~store_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M313.628,-423.242C317.495,-420.802 321.083,-417.914 324,-414.509 361.335,-370.928 319.942,-331.602 360,-290.509 367.506,-282.81 377.821,-277.927 388.067,-274.832"/>
<polygon fill="#000000" stroke="#000000" points="388.937,-278.223 397.775,-272.38 387.222,-271.436 388.937,-278.223"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~pfida_mc~~CallsGraph_edge62" class="edge"><title>proc~store_photons&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M289.914,-447.542C304.28,-462.388 331.117,-486.85 360,-496.509 525.683,-551.918 620.434,-536.01 744,-412.509 795.092,-361.443 808.361,-271.372 811.8,-229.747"/>
<polygon fill="#000000" stroke="#000000" points="815.304,-229.81 812.52,-219.587 808.322,-229.315 815.304,-229.81"/>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_passive_grid_indices -->
<g id="proc~~pfida_mc~~CallsGraph_edge61" class="edge"><title>proc~store_photons&#45;&gt;proc~get_passive_grid_indices</title>
<path fill="none" stroke="#000000" d="M318.78,-423.602C336.367,-418.338 357.241,-412.09 375.877,-406.512"/>
<polygon fill="#000000" stroke="#000000" points="377.1,-409.799 385.677,-403.579 375.093,-403.093 377.1,-409.799"/>
</g>
<!-- proc~spectrum -->
<g id="proc~~pfida_mc~~CallsGraph_node45" class="node"><title>proc~spectrum</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node45"><a xlink:href=".././proc/spectrum.html" xlink:title="spectrum">
<polygon fill="#d9534f" stroke="#d9534f" points="455.5,-487.509 398.5,-487.509 398.5,-463.509 455.5,-463.509 455.5,-487.509"/>
<text text-anchor="middle" x="427" y="-473.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spectrum</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~spectrum -->
<g id="proc~~pfida_mc~~CallsGraph_edge63" class="edge"><title>proc~store_photons&#45;&gt;proc~spectrum</title>
<path fill="none" stroke="#000000" d="M318.78,-446.334C340.508,-452.246 367.254,-459.524 388.598,-465.332"/>
<polygon fill="#000000" stroke="#000000" points="387.723,-468.721 398.291,-467.969 389.561,-461.966 387.723,-468.721"/>
</g>
<!-- proc~get_indices -->
<g id="proc~~pfida_mc~~CallsGraph_node50" class="node"><title>proc~get_indices</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node50"><a xlink:href=".././proc/get_indices.html" xlink:title="get_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="460.5,-445.509 393.5,-445.509 393.5,-421.509 460.5,-421.509 460.5,-445.509"/>
<text text-anchor="middle" x="427" y="-431.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_indices</text>
</a>
</g>
</g>
<!-- proc~store_photons&#45;&gt;proc~get_indices -->
<g id="proc~~pfida_mc~~CallsGraph_edge65" class="edge"><title>proc~store_photons&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M318.78,-434.968C338.62,-434.698 362.644,-434.371 382.919,-434.095"/>
<polygon fill="#000000" stroke="#000000" points="383.186,-437.592 393.138,-433.956 383.091,-430.593 383.186,-437.592"/>
</g>
<!-- proc~xyz_to_cyl -->
<g id="proc~~pfida_mc~~CallsGraph_node39" class="node"><title>proc~xyz_to_cyl</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node39"><a xlink:href=".././proc/xyz_to_cyl.html" xlink:title="xyz_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="611,-403.509 549,-403.509 549,-379.509 611,-379.509 611,-403.509"/>
<text text-anchor="middle" x="580" y="-389.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_cyl</text>
</a>
</g>
</g>
<!-- proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl -->
<g id="proc~~pfida_mc~~CallsGraph_edge66" class="edge"><title>proc~get_passive_grid_indices&#45;&gt;proc~xyz_to_cyl</title>
<path fill="none" stroke="#000000" d="M493.792,-391.509C509.118,-391.509 524.987,-391.509 538.816,-391.509"/>
<polygon fill="#000000" stroke="#000000" points="538.95,-395.009 548.95,-391.509 538.95,-388.009 538.95,-395.009"/>
</g>
<!-- proc~matinv -->
<g id="proc~~pfida_mc~~CallsGraph_node40" class="node"><title>proc~matinv</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node40"><a xlink:href=".././proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="454,-1361.51 400,-1361.51 400,-1337.51 454,-1337.51 454,-1361.51"/>
<text text-anchor="middle" x="427" y="-1347.11" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~linsolve&#45;&gt;proc~matinv -->
<g id="proc~~pfida_mc~~CallsGraph_edge67" class="edge"><title>proc~linsolve&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M299.847,-1298.57C315.935,-1307.57 338.93,-1319.77 360,-1328.51 369.663,-1332.52 380.381,-1336.23 390.32,-1339.38"/>
<polygon fill="#000000" stroke="#000000" points="389.346,-1342.74 399.933,-1342.33 391.402,-1336.05 389.346,-1342.74"/>
</g>
<!-- dgetrf -->
<g id="proc~~pfida_mc~~CallsGraph_node49" class="node"><title>dgetrf</title>
<polygon fill="#777777" stroke="#777777" points="454,-1319.51 400,-1319.51 400,-1295.51 454,-1295.51 454,-1319.51"/>
<text text-anchor="middle" x="427" y="-1305.11" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrf</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrf -->
<g id="proc~~pfida_mc~~CallsGraph_edge68" class="edge"><title>proc~linsolve&#45;&gt;dgetrf</title>
<path fill="none" stroke="#000000" d="M305.281,-1290.26C328.902,-1293.64 363.807,-1298.62 390.016,-1302.37"/>
<polygon fill="#000000" stroke="#000000" points="389.552,-1305.84 399.947,-1303.79 390.542,-1298.91 389.552,-1305.84"/>
</g>
<!-- dgetrs -->
<g id="proc~~pfida_mc~~CallsGraph_node51" class="node"><title>dgetrs</title>
<polygon fill="#777777" stroke="#777777" points="454,-1277.51 400,-1277.51 400,-1253.51 454,-1253.51 454,-1277.51"/>
<text text-anchor="middle" x="427" y="-1263.11" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrs</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrs -->
<g id="proc~~pfida_mc~~CallsGraph_edge69" class="edge"><title>proc~linsolve&#45;&gt;dgetrs</title>
<path fill="none" stroke="#000000" d="M305.281,-1282.75C328.902,-1279.38 363.807,-1274.39 390.016,-1270.65"/>
<polygon fill="#000000" stroke="#000000" points="390.542,-1274.11 399.947,-1269.23 389.552,-1267.18 390.542,-1274.11"/>
</g>
<!-- proc~plane_basis&#45;&gt;proc~cross_product -->
<g id="proc~~pfida_mc~~CallsGraph_edge70" class="edge"><title>proc~plane_basis&#45;&gt;proc~cross_product</title>
<path fill="none" stroke="#000000" d="M462.264,-320.132C482.261,-325.164 507.824,-331.597 529.928,-337.16"/>
<polygon fill="#000000" stroke="#000000" points="529.256,-340.6 539.808,-339.646 530.965,-333.812 529.256,-340.6"/>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~pfida_mc~~CallsGraph_edge71" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M323.584,-587.184C370.275,-583.001 443.678,-583.588 494,-618.509 543.659,-652.971 566.094,-725.449 574.602,-762.171"/>
<polygon fill="#000000" stroke="#000000" points="571.267,-763.308 576.81,-772.337 578.108,-761.822 571.267,-763.308"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~pfida_mc~~CallsGraph_edge73" class="edge"><title>proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M322.31,-645.526C338.16,-649.192 356.278,-653.383 372.887,-657.224"/>
<polygon fill="#000000" stroke="#000000" points="372.468,-660.72 383,-659.563 374.046,-653.9 372.468,-660.72"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~pfida_mc~~CallsGraph_edge72" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M322.34,-627.138C368.321,-620.631 441.443,-617.269 494,-648.509 537.222,-674.2 561.762,-731.321 572.469,-762.745"/>
<polygon fill="#000000" stroke="#000000" points="569.165,-763.9 575.577,-772.334 575.824,-761.742 569.165,-763.9"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~pfida_mc~~CallsGraph_node41" class="node"><title>proc~elmhes</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node41"><a xlink:href=".././proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="454,-1151.51 400,-1151.51 400,-1127.51 454,-1127.51 454,-1151.51"/>
<text text-anchor="middle" x="427" y="-1137.11" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~pfida_mc~~CallsGraph_edge74" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M305.281,-1122.26C328.902,-1125.64 363.807,-1130.62 390.016,-1134.37"/>
<polygon fill="#000000" stroke="#000000" points="389.552,-1137.84 399.947,-1135.79 390.542,-1130.91 389.552,-1137.84"/>
</g>
<!-- proc~balance -->
<g id="proc~~pfida_mc~~CallsGraph_node42" class="node"><title>proc~balance</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node42"><a xlink:href=".././proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="454,-1235.51 400,-1235.51 400,-1211.51 454,-1211.51 454,-1235.51"/>
<text text-anchor="middle" x="427" y="-1221.11" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~pfida_mc~~CallsGraph_edge75" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M287.54,-1130.63C300.952,-1148.81 328.679,-1183.05 360,-1202.51 369.116,-1208.17 379.898,-1212.44 390.076,-1215.59"/>
<polygon fill="#000000" stroke="#000000" points="389.394,-1219.04 399.969,-1218.39 391.298,-1212.3 389.394,-1219.04"/>
</g>
<!-- proc~balback -->
<g id="proc~~pfida_mc~~CallsGraph_node43" class="node"><title>proc~balback</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node43"><a xlink:href=".././proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="454,-1193.51 400,-1193.51 400,-1169.51 454,-1169.51 454,-1193.51"/>
<text text-anchor="middle" x="427" y="-1179.11" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~pfida_mc~~CallsGraph_edge76" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M299.847,-1130.57C315.935,-1139.57 338.93,-1151.77 360,-1160.51 369.663,-1164.52 380.381,-1168.23 390.32,-1171.38"/>
<polygon fill="#000000" stroke="#000000" points="389.346,-1174.74 399.933,-1174.33 391.402,-1168.05 389.346,-1174.74"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~pfida_mc~~CallsGraph_node44" class="node"><title>proc~hqr2</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node44"><a xlink:href=".././proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="454,-1067.51 400,-1067.51 400,-1043.51 454,-1043.51 454,-1067.51"/>
<text text-anchor="middle" x="427" y="-1053.11" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~pfida_mc~~CallsGraph_edge77" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M299.847,-1106.44C315.935,-1097.45 338.93,-1085.25 360,-1076.51 369.663,-1072.5 380.381,-1068.79 390.32,-1065.64"/>
<polygon fill="#000000" stroke="#000000" points="391.402,-1068.97 399.933,-1062.69 389.346,-1062.28 391.402,-1068.97"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~pfida_mc~~CallsGraph_node52" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node52"><a xlink:href=".././proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="454,-1109.51 400,-1109.51 400,-1085.51 454,-1085.51 454,-1109.51"/>
<text text-anchor="middle" x="427" y="-1095.11" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~pfida_mc~~CallsGraph_edge78" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M305.281,-1114.75C328.902,-1111.38 363.807,-1106.39 390.016,-1102.65"/>
<polygon fill="#000000" stroke="#000000" points="390.542,-1106.11 399.947,-1101.23 389.552,-1099.18 390.542,-1106.11"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~pfida_mc~~CallsGraph_edge80" class="edge"><title>proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M323.105,-853.51C338.442,-857.684 355.825,-862.414 371.878,-866.782"/>
<polygon fill="#000000" stroke="#000000" points="371.104,-870.199 381.672,-869.447 372.942,-863.444 371.104,-870.199"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~pfida_mc~~CallsGraph_edge79" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M323.656,-835.049C367.27,-828.5 435.444,-817.626 494,-805.509 505.862,-803.054 518.575,-800.093 530.46,-797.179"/>
<polygon fill="#000000" stroke="#000000" points="531.352,-800.563 540.212,-794.753 529.663,-793.77 531.352,-800.563"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~pfida_mc~~CallsGraph_node46" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node46"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="736,-75.5091 674,-75.5091 674,-51.5091 736,-51.5091 736,-75.5091"/>
<text text-anchor="middle" x="705" y="-61.1091" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~pfida_mc~~CallsGraph_edge81" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M598.623,-135.474C619.356,-121.314 653.973,-97.6741 677.84,-81.3744"/>
<polygon fill="#000000" stroke="#000000" points="680.126,-84.0519 686.41,-75.5219 676.178,-78.2713 680.126,-84.0519"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~pfida_mc~~CallsGraph_edge83" class="edge"><title>proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M306.348,-811.726C312.227,-814.503 318.364,-817.519 324,-820.509 349.764,-834.179 378.174,-851.35 398.453,-863.989"/>
<polygon fill="#000000" stroke="#000000" points="396.828,-867.101 407.159,-869.448 400.546,-861.17 396.828,-867.101"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~pfida_mc~~CallsGraph_edge82" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M323.589,-797.28C378.907,-794.514 472.899,-789.814 530.13,-786.953"/>
<polygon fill="#000000" stroke="#000000" points="530.558,-790.436 540.37,-786.441 530.208,-783.444 530.558,-790.436"/>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~pfida_mc~~CallsGraph_edge84" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M587.335,-898.478C597.309,-879.222 616.884,-840.122 630,-805.509 661.198,-723.176 687.709,-621.626 698.644,-577.597"/>
<polygon fill="#000000" stroke="#000000" points="702.091,-578.235 701.081,-567.689 695.293,-576.563 702.091,-578.235"/>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~pfida_mc~~CallsGraph_edge86" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M611.116,-382.707C617.923,-379.665 624.697,-375.676 630,-370.509 670.358,-331.184 690.848,-265.706 699.24,-231.636"/>
<polygon fill="#000000" stroke="#000000" points="702.682,-232.284 701.549,-221.75 695.866,-230.692 702.682,-232.284"/>
</g>
<!-- proc~uvw_to_cyl -->
<g id="proc~~pfida_mc~~CallsGraph_node53" class="node"><title>proc~uvw_to_cyl</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node53"><a xlink:href=".././proc/uvw_to_cyl.html" xlink:title="uvw_to_cyl">
<polygon fill="#d9534f" stroke="#d9534f" points="737.5,-403.509 672.5,-403.509 672.5,-379.509 737.5,-379.509 737.5,-403.509"/>
<text text-anchor="middle" x="705" y="-389.109" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_cyl</text>
</a>
</g>
</g>
<!-- proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl -->
<g id="proc~~pfida_mc~~CallsGraph_edge85" class="edge"><title>proc~xyz_to_cyl&#45;&gt;proc~uvw_to_cyl</title>
<path fill="none" stroke="#000000" d="M611.089,-391.509C626.402,-391.509 645.267,-391.509 661.989,-391.509"/>
<polygon fill="#000000" stroke="#000000" points="662.072,-395.009 672.072,-391.509 662.072,-388.009 662.072,-395.009"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~pfida_mc~~CallsGraph_node56" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node56"><a xlink:href=".././proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="607,-1382.51 553,-1382.51 553,-1358.51 607,-1358.51 607,-1382.51"/>
<text text-anchor="middle" x="580" y="-1368.11" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~pfida_mc~~CallsGraph_edge88" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M454.302,-1353.17C478.878,-1356.58 515.771,-1361.72 543.057,-1365.51"/>
<polygon fill="#000000" stroke="#000000" points="542.612,-1368.98 552.999,-1366.89 543.577,-1362.05 542.612,-1368.98"/>
</g>
<!-- proc~lubksb -->
<g id="proc~~pfida_mc~~CallsGraph_node57" class="node"><title>proc~lubksb</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node57"><a xlink:href=".././proc/lubksb.html" xlink:title="lubksb">
<polygon fill="#d9534f" stroke="#d9534f" points="607,-1340.51 553,-1340.51 553,-1316.51 607,-1316.51 607,-1340.51"/>
<text text-anchor="middle" x="580" y="-1326.11" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lubksb</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~lubksb -->
<g id="proc~~pfida_mc~~CallsGraph_edge87" class="edge"><title>proc~matinv&#45;&gt;proc~lubksb</title>
<path fill="none" stroke="#000000" d="M454.302,-1345.85C478.878,-1342.43 515.771,-1337.3 543.057,-1333.51"/>
<polygon fill="#000000" stroke="#000000" points="543.577,-1336.97 552.999,-1332.13 542.612,-1330.04 543.577,-1336.97"/>
</g>
<!-- proc~rswap -->
<g id="proc~~pfida_mc~~CallsGraph_node55" class="node"><title>proc~rswap</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node55"><a xlink:href=".././proc/rswap.html" xlink:title="RSWAP">
<polygon fill="#d9534f" stroke="#d9534f" points="607,-1193.51 553,-1193.51 553,-1169.51 607,-1169.51 607,-1193.51"/>
<text text-anchor="middle" x="580" y="-1179.11" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RSWAP</text>
</a>
</g>
</g>
<!-- proc~elmhes&#45;&gt;proc~rswap -->
<g id="proc~~pfida_mc~~CallsGraph_edge89" class="edge"><title>proc~elmhes&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M454.302,-1146.82C478.878,-1153.66 515.771,-1163.92 543.057,-1171.51"/>
<polygon fill="#000000" stroke="#000000" points="542.427,-1174.97 552.999,-1174.28 544.303,-1168.23 542.427,-1174.97"/>
</g>
<!-- proc~balance&#45;&gt;proc~rswap -->
<g id="proc~~pfida_mc~~CallsGraph_edge90" class="edge"><title>proc~balance&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M454.302,-1216.19C478.878,-1209.36 515.771,-1199.1 543.057,-1191.51"/>
<polygon fill="#000000" stroke="#000000" points="544.303,-1194.79 552.999,-1188.74 542.427,-1188.05 544.303,-1194.79"/>
</g>
<!-- proc~balback&#45;&gt;proc~rswap -->
<g id="proc~~pfida_mc~~CallsGraph_edge91" class="edge"><title>proc~balback&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M454.302,-1181.51C478.769,-1181.51 515.446,-1181.51 542.696,-1181.51"/>
<polygon fill="#000000" stroke="#000000" points="542.999,-1185.01 552.999,-1181.51 542.999,-1178.01 542.999,-1185.01"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~pfida_mc~~CallsGraph_node54" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node54"><a xlink:href=".././proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="607,-1067.51 553,-1067.51 553,-1043.51 607,-1043.51 607,-1067.51"/>
<text text-anchor="middle" x="580" y="-1053.11" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~pfida_mc~~CallsGraph_edge92" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M454.302,-1055.51C478.769,-1055.51 515.446,-1055.51 542.696,-1055.51"/>
<polygon fill="#000000" stroke="#000000" points="542.999,-1059.01 552.999,-1055.51 542.999,-1052.01 542.999,-1059.01"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~pfida_mc~~CallsGraph_edge93" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M727.422,-75.7542C733.217,-79.681 739.205,-84.3618 744,-89.5091 771.296,-118.813 792.588,-160.757 803.93,-185.944"/>
<polygon fill="#000000" stroke="#000000" points="800.821,-187.569 808.042,-195.323 807.233,-184.759 800.821,-187.569"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~pfida_mc~~CallsGraph_edge94" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M736.09,-63.5091C746.99,-63.5091 759.506,-63.5091 771.23,-63.5091"/>
<polygon fill="#000000" stroke="#000000" points="771.27,-67.0092 781.27,-63.5091 771.27,-60.0092 771.27,-67.0092"/>
</g>
<!-- proc~comdiv -->
<g id="proc~~pfida_mc~~CallsGraph_node59" class="node"><title>proc~comdiv</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node59"><a xlink:href=".././proc/comdiv.html" xlink:title="Comdiv">
<polygon fill="#d9534f" stroke="#d9534f" points="732,-1067.51 678,-1067.51 678,-1043.51 732,-1043.51 732,-1067.51"/>
<text text-anchor="middle" x="705" y="-1053.11" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Comdiv</text>
</a>
</g>
</g>
<!-- proc~hqrvec&#45;&gt;proc~comdiv -->
<g id="proc~~pfida_mc~~CallsGraph_edge95" class="edge"><title>proc~hqrvec&#45;&gt;proc~comdiv</title>
<path fill="none" stroke="#000000" d="M607.085,-1055.51C624.779,-1055.51 648.405,-1055.51 667.9,-1055.51"/>
<polygon fill="#000000" stroke="#000000" points="667.952,-1059.01 677.952,-1055.51 667.952,-1052.01 667.952,-1059.01"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~pfida_mc~~CallsGraph_node58" class="node"><title>proc~outerprod</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node58"><a xlink:href=".././proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="734.5,-1403.51 675.5,-1403.51 675.5,-1379.51 734.5,-1379.51 734.5,-1403.51"/>
<text text-anchor="middle" x="705" y="-1389.11" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~pfida_mc~~CallsGraph_edge96" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M607.085,-1374.96C624.061,-1377.86 646.499,-1381.69 665.509,-1384.94"/>
<polygon fill="#000000" stroke="#000000" points="664.929,-1388.39 675.375,-1386.62 666.107,-1381.49 664.929,-1388.39"/>
</g>
<!-- proc~swap -->
<g id="proc~~pfida_mc~~CallsGraph_node60" class="node"><title>proc~swap</title>
<g id="a_proc~~pfida_mc~~CallsGraph_node60"><a xlink:href=".././proc/swap.html" xlink:title="swap">
<polygon fill="#d9534f" stroke="#d9534f" points="732,-1361.51 678,-1361.51 678,-1337.51 732,-1337.51 732,-1361.51"/>
<text text-anchor="middle" x="705" y="-1347.11" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swap</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~swap -->
<g id="proc~~pfida_mc~~CallsGraph_edge97" class="edge"><title>proc~ludcmp&#45;&gt;proc~swap</title>
<path fill="none" stroke="#000000" d="M607.085,-1366.06C624.779,-1363.03 648.405,-1359 667.9,-1355.67"/>
<polygon fill="#000000" stroke="#000000" points="668.684,-1359.09 677.952,-1353.96 667.506,-1352.19 668.684,-1359.09"/>
</g>
</g>
</svg>
</div><script>var panprocpfida_mcCallsGraph = svgPanZoom('#procpfida_mcCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~pfida_mc~~CalledByGraph Pages: 1 -->
<svg id="procpfida_mcCalledByGraph" width="154pt" height="32pt"
 viewBox="0.00 0.00 154.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pfida_mc~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~pfida_mc~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 150,-28 150,4 -4,4"/>
<!-- proc~pfida_mc -->
<g id="proc~~pfida_mc~~CalledByGraph_node1" class="node"><title>proc~pfida_mc</title>
<polygon fill="none" stroke="black" points="146,-24 90,-24 90,-0 146,-0 146,-24"/>
<text text-anchor="middle" x="118" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">pfida_mc</text>
</g>
<!-- program~fidasim -->
<g id="proc~~pfida_mc~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~pfida_mc~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~pfida_mc -->
<g id="proc~~pfida_mc~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~pfida_mc</title>
<path fill="none" stroke="#000000" d="M54.2216,-12C62.1684,-12 71.0565,-12 79.5879,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.7302,-15.5001 89.7301,-12 79.7301,-8.5001 79.7302,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pfida_mc.html#src">pfida_mc</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">pfida_mc</span>
    <span class="c">!+ Calculate Passive FIDA emission using a Monte Carlo Fast-ion distribution</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iion</span><span class="p">,</span><span class="n">igamma</span><span class="p">,</span><span class="n">ngamma</span>
    <span class="k">type</span><span class="p">(</span><span class="n">FastIon</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fast_ion</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fields</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span> <span class="kd">::</span> <span class="n">plasma</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">phi</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ri</span>      <span class="c">!! start position</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vi</span>      <span class="c">!! velocity of fast ions</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xyz_vi</span>
    <span class="c">!! Determination of the CX probability</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">denn</span>    <span class="c">!!  neutral dens (n=1-4)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rates</span><span class="p">,</span> <span class="n">rates_is</span>    <span class="c">!! CX rates</span>
    <span class="c">!! Collisiional radiative model along track</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">states</span>  <span class="c">! Density of n-states</span>
    <span class="k">type</span><span class="p">(</span><span class="n">ParticleTrack</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">ntrack</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tracks</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ntrack</span>
    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">los_intersect</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">jj</span><span class="p">,</span> <span class="k">is</span>
<span class="k">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">photons</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">s</span><span class="p">,</span> <span class="n">c</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">randomu</span>

    <span class="n">ngamma</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">.</span><span class="nb">or</span><span class="p">.(</span><span class="n">inputs</span><span class="p">%</span><span class="n">dist_type</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">))</span> <span class="k">then</span>
<span class="k">        </span><span class="n">ngamma</span> <span class="o">=</span> <span class="nb">ceiling</span><span class="p">(</span><span class="nb">dble</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_pfida</span><span class="p">)</span><span class="o">/</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="p">)</span>
    <span class="k">endif</span>

<span class="k">    if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i10)&#39;</span><span class="p">)</span> <span class="nb">int</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="o">*</span><span class="n">ngamma</span><span class="p">,</span><span class="n">Int64</span><span class="p">)</span>
    <span class="k">endif</span>

    <span class="c">!$OMP PARALLEL DO schedule(dynamic,1) private(iion,igamma,is,fast_ion,vi,ri,phi,tracks,s,c,&amp;</span>
    <span class="c">!$OMP&amp; randomu,plasma,fields,ntrack,jj,rates,rates_is,denn,los_intersect,states,photons,xyz_vi)</span>
    <span class="n">loop_over_fast_ions</span><span class="p">:</span> <span class="k">do </span><span class="n">iion</span><span class="o">=</span><span class="n">istart</span><span class="p">,</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="p">,</span><span class="n">istep</span>
        <span class="n">fast_ion</span> <span class="o">=</span> <span class="n">particles</span><span class="p">%</span><span class="n">fast_ion</span><span class="p">(</span><span class="n">iion</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vabs</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">loop_over_fast_ions</span>
        <span class="n">gamma_loop</span><span class="p">:</span> <span class="k">do </span><span class="n">igamma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ngamma</span>
            <span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">)</span> <span class="k">then</span>
                <span class="c">!! Pick random toroidal angle</span>
                <span class="k">call </span><span class="n">randu</span><span class="p">(</span><span class="n">randomu</span><span class="p">)</span>
                <span class="n">phi</span> <span class="o">=</span> <span class="n">pass_grid</span><span class="p">%</span><span class="n">phi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">nphi</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dphi</span><span class="o">*</span><span class="n">randomu</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span>
<span class="k">                </span><span class="n">phi</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">phi</span>
            <span class="k">endif</span>
<span class="k">            </span><span class="n">s</span> <span class="o">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="nb">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>

            <span class="c">!! Calculate position in machine coordinates</span>
            <span class="n">ri</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">c</span>
            <span class="n">ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">s</span>
            <span class="n">ri</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">z</span>

            <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">dist_type</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
                <span class="c">!! Get electomagnetic fields</span>
                <span class="k">call </span><span class="n">get_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">,</span> <span class="n">input_coords</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">output_coords</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

                <span class="c">!! Correct for gyro motion and get particle position and velocity</span>
                <span class="k">call </span><span class="n">gyro_correction</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">energy</span><span class="p">,</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">pitch</span><span class="p">,</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">A</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">)</span>
            <span class="k">else</span> <span class="c">!! Full Orbit</span>
                <span class="c">!! Calculate velocity vector</span>
                <span class="n">vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vr</span> <span class="o">-</span> <span class="n">s</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vt</span>
                <span class="n">vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vr</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vt</span>
                <span class="n">vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">vz</span>
            <span class="k">endif</span>
<span class="k">            </span><span class="n">xyz_vi</span> <span class="o">=</span> <span class="nb">matmul</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">inv_basis</span><span class="p">,</span><span class="n">vi</span><span class="p">)</span>

            <span class="c">!! Track particle through grid</span>
            <span class="k">call </span><span class="n">track_cylindrical</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">,</span> <span class="n">tracks</span><span class="p">,</span> <span class="n">ntrack</span><span class="p">,</span> <span class="n">los_intersect</span><span class="p">)</span>
            <span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">los_intersect</span><span class="p">)</span> <span class="k">cycle </span><span class="n">gamma_loop</span>
            <span class="k">if</span><span class="p">(</span><span class="n">ntrack</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">gamma_loop</span>

            <span class="c">!! Calculate CX probability</span>
            <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">,</span> <span class="n">input_coords</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">rates</span> <span class="o">=</span> <span class="mf">0.d0</span>
            <span class="k">do is</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n_thermal</span>
                <span class="k">call </span><span class="n">bt_cx_rates</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span> <span class="n">plasma</span><span class="p">%</span><span class="n">denn</span><span class="p">(:,</span><span class="k">is</span><span class="p">),</span> <span class="n">thermal_mass</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="n">xyz_vi</span><span class="p">,</span> <span class="n">rates_is</span><span class="p">)</span>
                <span class="n">rates</span> <span class="o">=</span> <span class="n">rates</span> <span class="o">+</span> <span class="n">rates_is</span>
            <span class="k">enddo</span>
<span class="k">            if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span> <span class="k">cycle </span><span class="n">gamma_loop</span>

            <span class="c">!! Weight CX rates by ion source density</span>
            <span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                </span><span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">weight</span><span class="o">*</span><span class="p">(</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">nphi</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dphi</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span>  <span class="p">&amp;</span>
                       <span class="o">/</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dv</span><span class="p">)</span><span class="o">/</span><span class="n">ngamma</span>

            <span class="k">else</span>
<span class="k">                </span><span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">weight</span><span class="o">/</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dv</span><span class="p">)</span><span class="o">/</span><span class="n">ngamma</span>
            <span class="k">endif</span>

            <span class="c">!! Calculate the spectra produced in each cell along the path</span>
            <span class="n">loop_along_track</span><span class="p">:</span> <span class="k">do </span><span class="n">jj</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ntrack</span>
                <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span><span class="n">input_coords</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

                <span class="k">call </span><span class="n">colrad</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">A</span><span class="p">,</span> <span class="n">xyz_vi</span><span class="p">,</span> <span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="nb">time</span><span class="p">,</span> <span class="n">states</span><span class="p">,</span> <span class="n">denn</span><span class="p">,</span> <span class="n">photons</span><span class="p">)</span>

                <span class="k">call </span><span class="n">store_fida_photons</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span> <span class="n">xyz_vi</span><span class="p">,</span> <span class="n">beam_lambda0</span><span class="p">,</span> <span class="n">photons</span><span class="p">,</span> <span class="n">fast_ion</span><span class="p">%</span><span class="k">class</span><span class="p">,</span><span class="n">passive</span><span class="o">=</span><span class="p">.</span><span class="n">True</span><span class="p">.)</span>
            <span class="k">enddo </span><span class="n">loop_along_track</span>
        <span class="k">enddo </span><span class="n">gamma_loop</span>
    <span class="k">enddo </span><span class="n">loop_over_fast_ions</span>
    <span class="c">!$OMP END PARALLEL DO</span>

<span class="cp">#ifdef _MPI</span>
    <span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">pfida</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="k">end subroutine </span><span class="n">pfida_mc</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2021 
                                          </p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            
            
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>