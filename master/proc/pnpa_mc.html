<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>pnpa_mc &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>pnpa_mc
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.9% of total for procedures.">117 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
    
     <li><a href='../module/libfida.html'>libfida</a></li>
    
  
     <li class="active">pnpa_mc</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pnpa_mc.html#src">pnpa_mc</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine pnpa_mc()
    
    
   
</h2>
    
  


    
    <p>Calculate Passive NPA flux using a Monte Carlo fast-ion distribution</p>
    

    <h3>Arguments</h3>
    
    <em>None</em>
    <br>
    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~pnpa_mc~~CallsGraph Pages: 1 -->
<svg id="procpnpa_mcCallsGraph" width="641pt" height="865pt"
 viewBox="0.00 0.00 641.00 865.11" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pnpa_mc~~CallsGraph" class="graph" transform="scale(0.783619 0.783619) rotate(0) translate(4 1100)">
<title>proc~~pnpa_mc~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1100 814,-1100 814,4 -4,4"/>
<!-- proc~pnpa_mc -->
<g id="proc~~pnpa_mc~~CallsGraph_node1" class="node"><title>proc~pnpa_mc</title>
<polygon fill="none" stroke="black" points="57.5,-560 0.5,-560 0.5,-536 57.5,-536 57.5,-560"/>
<text text-anchor="middle" x="29" y="-545.6" font-family="Helvetica,sans-Serif" font-size="10.50">pnpa_mc</text>
</g>
<!-- proc~gyro_surface -->
<g id="proc~~pnpa_mc~~CallsGraph_node2" class="node"><title>proc~gyro_surface</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node2"><a xlink:href=".././proc/gyro_surface.html" xlink:title="gyro_surface">
<polygon fill="#d9534f" stroke="#d9534f" points="177.5,-928 102.5,-928 102.5,-904 177.5,-904 177.5,-928"/>
<text text-anchor="middle" x="140" y="-913.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_surface</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~gyro_surface -->
<g id="proc~~pnpa_mc~~CallsGraph_edge1" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~gyro_surface</title>
<path fill="none" stroke="#000000" d="M30.7825,-560.366C34.5068,-615.76 52.0273,-840.726 94,-895 94.5769,-895.746 95.1866,-896.466 95.8253,-897.162"/>
<polygon fill="#000000" stroke="#000000" points="93.6993,-899.948 103.602,-903.714 98.2095,-894.594 93.6993,-899.948"/>
</g>
<!-- interface~randu -->
<g id="proc~~pnpa_mc~~CallsGraph_node3" class="node"><title>interface~randu</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node3"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="167,-886 113,-886 113,-862 167,-862 167,-886"/>
<text text-anchor="middle" x="140" y="-871.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;interface~randu -->
<g id="proc~~pnpa_mc~~CallsGraph_edge2" class="edge"><title>proc~pnpa_mc&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M31.1121,-560.221C35.9586,-611.137 56.6824,-805.945 94,-853 96.712,-856.42 100.111,-859.308 103.82,-861.742"/>
<polygon fill="#000000" stroke="#000000" points="102.396,-864.951 112.857,-866.63 105.726,-858.794 102.396,-864.951"/>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~pnpa_mc~~CallsGraph_node4" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node4"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="176.5,-844 103.5,-844 103.5,-820 176.5,-820 176.5,-844"/>
<text text-anchor="middle" x="140" y="-829.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;interface~parallel_sum -->
<g id="proc~~pnpa_mc~~CallsGraph_edge3" class="edge"><title>proc~pnpa_mc&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M34.6836,-560.203C51.5241,-604.081 109.145,-754.211 130.739,-810.476"/>
<polygon fill="#000000" stroke="#000000" points="127.483,-811.76 134.334,-819.842 134.018,-809.252 127.483,-811.76"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~pnpa_mc~~CallsGraph_node5" class="node"><title>proc~get_fields</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node5"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="298,-600 240,-600 240,-576 298,-576 298,-600"/>
<text text-anchor="middle" x="269" y="-585.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~get_fields -->
<g id="proc~~pnpa_mc~~CallsGraph_edge5" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M57.69,-558.483C68.8292,-562.33 81.8843,-566.381 94,-569 140.028,-578.951 194.092,-583.817 229.596,-586.107"/>
<polygon fill="#000000" stroke="#000000" points="229.795,-589.626 239.989,-586.739 230.219,-582.639 229.795,-589.626"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~pnpa_mc~~CallsGraph_node6" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node6"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-481 235,-481 235,-457 303,-457 303,-481"/>
<text text-anchor="middle" x="269" y="-466.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~get_plasma -->
<g id="proc~~pnpa_mc~~CallsGraph_edge6" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M57.7674,-538.783C98.951,-525.113 176.568,-499.349 225.098,-483.241"/>
<polygon fill="#000000" stroke="#000000" points="226.305,-486.528 234.693,-480.056 224.099,-479.884 226.305,-486.528"/>
</g>
<!-- proc~hit_npa_detector -->
<g id="proc~~pnpa_mc~~CallsGraph_node7" class="node"><title>proc~hit_npa_detector</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node7"><a xlink:href=".././proc/hit_npa_detector.html" xlink:title="hit_npa_detector">
<polygon fill="#d9534f" stroke="#d9534f" points="315.5,-234 222.5,-234 222.5,-210 315.5,-210 315.5,-234"/>
<text text-anchor="middle" x="269" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hit_npa_detector</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~hit_npa_detector -->
<g id="proc~~pnpa_mc~~CallsGraph_edge7" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~hit_npa_detector</title>
<path fill="none" stroke="#000000" d="M37.1359,-535.948C48.6023,-516.768 72.0707,-478.274 94,-447 148.559,-369.192 219.419,-281.217 251.24,-242.33"/>
<polygon fill="#000000" stroke="#000000" points="254.13,-244.327 257.766,-234.375 248.718,-239.887 254.13,-244.327"/>
</g>
<!-- proc~gyro_trajectory -->
<g id="proc~~pnpa_mc~~CallsGraph_node8" class="node"><title>proc~gyro_trajectory</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node8"><a xlink:href=".././proc/gyro_trajectory.html" xlink:title="gyro_trajectory">
<polygon fill="#d9534f" stroke="#d9534f" points="182,-202 98,-202 98,-178 182,-178 182,-202"/>
<text text-anchor="middle" x="140" y="-187.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_trajectory</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~gyro_trajectory -->
<g id="proc~~pnpa_mc~~CallsGraph_edge8" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~gyro_trajectory</title>
<path fill="none" stroke="#000000" d="M30.8308,-535.988C34.7643,-482.179 53.0571,-263.654 94,-211 94.688,-210.115 95.4221,-209.266 96.196,-208.451"/>
<polygon fill="#000000" stroke="#000000" points="98.5406,-211.055 104.058,-202.011 94.1046,-205.64 98.5406,-211.055"/>
</g>
<!-- proc~attenuate -->
<g id="proc~~pnpa_mc~~CallsGraph_node9" class="node"><title>proc~attenuate</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node9"><a xlink:href=".././proc/attenuate.html" xlink:title="attenuate">
<polygon fill="#d9534f" stroke="#d9534f" points="169,-480 111,-480 111,-456 169,-456 169,-480"/>
<text text-anchor="middle" x="140" y="-465.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">attenuate</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~attenuate -->
<g id="proc~~pnpa_mc~~CallsGraph_edge9" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~attenuate</title>
<path fill="none" stroke="#000000" d="M43.1724,-535.686C55.7362,-524.237 75.4423,-507.036 94,-494 98.2292,-491.029 102.819,-488.086 107.396,-485.307"/>
<polygon fill="#000000" stroke="#000000" points="109.236,-488.285 116.084,-480.201 105.689,-482.25 109.236,-488.285"/>
</g>
<!-- proc~npa_gyro_range -->
<g id="proc~~pnpa_mc~~CallsGraph_node10" class="node"><title>proc~npa_gyro_range</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node10"><a xlink:href=".././proc/npa_gyro_range.html" xlink:title="npa_gyro_range">
<polygon fill="#d9534f" stroke="#d9534f" points="185.5,-244 94.5,-244 94.5,-220 185.5,-220 185.5,-244"/>
<text text-anchor="middle" x="140" y="-229.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_gyro_range</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~npa_gyro_range -->
<g id="proc~~pnpa_mc~~CallsGraph_edge10" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~npa_gyro_range</title>
<path fill="none" stroke="#000000" d="M34.1855,-535.81C44.3924,-506.091 71.3839,-427.531 94,-362 107.148,-323.902 122.516,-279.543 131.464,-253.732"/>
<polygon fill="#000000" stroke="#000000" points="134.805,-254.78 134.774,-244.185 128.191,-252.487 134.805,-254.78"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~pnpa_mc~~CallsGraph_node11" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node11"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="714,-619 646,-619 646,-595 714,-595 714,-619"/>
<text text-anchor="middle" x="680" y="-604.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~pnpa_mc~~CallsGraph_edge4" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M46.1211,-560.111C58.6488,-569.071 76.7414,-581.05 94,-589 202.804,-639.12 233.496,-649.478 352,-667 465.556,-683.79 502.421,-695.044 610,-655 627.725,-648.402 645.189,-636.181 658.112,-625.723"/>
<polygon fill="#000000" stroke="#000000" points="660.497,-628.291 665.906,-619.181 655.997,-622.929 660.497,-628.291"/>
</g>
<!-- proc~store_npa -->
<g id="proc~~pnpa_mc~~CallsGraph_node12" class="node"><title>proc~store_npa</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node12"><a xlink:href=".././proc/store_npa.html" xlink:title="store_npa">
<polygon fill="#d9534f" stroke="#d9534f" points="170.5,-560 109.5,-560 109.5,-536 170.5,-536 170.5,-560"/>
<text text-anchor="middle" x="140" y="-545.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_npa</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~store_npa -->
<g id="proc~~pnpa_mc~~CallsGraph_edge11" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M57.5053,-548C70.0694,-548 85.1943,-548 98.985,-548"/>
<polygon fill="#000000" stroke="#000000" points="99.2063,-551.5 109.206,-548 99.2062,-544.5 99.2063,-551.5"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~pnpa_mc~~CallsGraph_node13" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node13"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-760 223.5,-760 223.5,-736 314.5,-736 314.5,-760"/>
<text text-anchor="middle" x="269" y="-745.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge12" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M154.616,-819.797C170.157,-806.263 196.706,-784.323 222,-769 224.464,-767.508 227.052,-766.053 229.691,-764.65"/>
<polygon fill="#000000" stroke="#000000" points="231.388,-767.715 238.761,-760.106 228.253,-761.456 231.388,-767.715"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~pnpa_mc~~CallsGraph_node14" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node14"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-718 223.5,-718 223.5,-694 314.5,-694 314.5,-718"/>
<text text-anchor="middle" x="269" y="-703.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge20" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M147.737,-819.748C160.012,-798.393 187.92,-754.055 222,-727 223.732,-725.625 225.568,-724.318 227.472,-723.077"/>
<polygon fill="#000000" stroke="#000000" points="229.226,-726.106 236.132,-718.071 225.723,-720.046 229.226,-726.106"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~pnpa_mc~~CallsGraph_node15" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node15"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-1096 225,-1096 225,-1072 313,-1072 313,-1096"/>
<text text-anchor="middle" x="269" y="-1081.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge13" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M176.44,-844.253C180.074,-846.684 183.384,-849.574 186,-853 243.457,-928.272 164.229,-987.969 222,-1063 222.586,-1063.76 223.205,-1064.49 223.855,-1065.2"/>
<polygon fill="#000000" stroke="#000000" points="221.869,-1068.11 231.781,-1071.85 226.365,-1062.74 221.869,-1068.11"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~pnpa_mc~~CallsGraph_node18" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node18"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1054 223.5,-1054 223.5,-1030 314.5,-1030 314.5,-1054"/>
<text text-anchor="middle" x="269" y="-1039.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge14" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M175.863,-844.072C179.692,-846.545 183.207,-849.493 186,-853 233.577,-912.729 174.174,-961.47 222,-1021 222.601,-1021.75 223.235,-1022.47 223.898,-1023.17"/>
<polygon fill="#000000" stroke="#000000" points="221.965,-1026.11 231.919,-1029.74 226.4,-1020.69 221.965,-1026.11"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~pnpa_mc~~CallsGraph_node21" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node21"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1012 223.5,-1012 223.5,-988 314.5,-988 314.5,-1012"/>
<text text-anchor="middle" x="269" y="-997.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge16" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M175.642,-844.255C179.506,-846.698 183.091,-849.589 186,-853 223.797,-897.31 184.018,-934.848 222,-979 222.744,-979.865 223.532,-980.697 224.356,-981.496"/>
<polygon fill="#000000" stroke="#000000" points="222.536,-984.512 232.594,-987.84 226.807,-978.966 222.536,-984.512"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~pnpa_mc~~CallsGraph_node22" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node22"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-970 225,-970 225,-946 313,-946 313,-970"/>
<text text-anchor="middle" x="269" y="-955.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge17" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.331,-844.076C178.598,-846.577 182.641,-849.532 186,-853 214.262,-882.173 193.617,-907.945 222,-937 222.932,-937.954 223.915,-938.868 224.94,-939.745"/>
<polygon fill="#000000" stroke="#000000" points="223.272,-942.851 233.465,-945.743 227.3,-937.126 223.272,-942.851"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~pnpa_mc~~CallsGraph_node25" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node25"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-928 223.5,-928 223.5,-904 314.5,-904 314.5,-928"/>
<text text-anchor="middle" x="269" y="-913.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge18" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M171.553,-844.088C176.596,-846.683 181.605,-849.663 186,-853 205.581,-867.867 202.357,-880.215 222,-895 223.824,-896.373 225.751,-897.683 227.743,-898.93"/>
<polygon fill="#000000" stroke="#000000" points="226.328,-902.149 236.763,-903.983 229.749,-896.042 226.328,-902.149"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~pnpa_mc~~CallsGraph_node26" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node26"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-886 225,-886 225,-862 313,-862 313,-886"/>
<text text-anchor="middle" x="269" y="-871.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge19" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M176.715,-843.811C190.797,-848.468 207.151,-853.877 222.094,-858.819"/>
<polygon fill="#000000" stroke="#000000" points="221.079,-862.169 231.672,-861.986 223.277,-855.523 221.079,-862.169"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~pnpa_mc~~CallsGraph_node28" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node28"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-844 223.5,-844 223.5,-820 314.5,-820 314.5,-844"/>
<text text-anchor="middle" x="269" y="-829.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge15" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M176.715,-832C187.949,-832 200.628,-832 212.884,-832"/>
<polygon fill="#000000" stroke="#000000" points="213.037,-835.5 223.037,-832 213.037,-828.5 213.037,-835.5"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~pnpa_mc~~CallsGraph_node29" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node29"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-802 225,-802 225,-778 313,-778 313,-802"/>
<text text-anchor="middle" x="269" y="-787.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge21" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M176.715,-820.189C190.797,-815.532 207.151,-810.123 222.094,-805.181"/>
<polygon fill="#000000" stroke="#000000" points="223.277,-808.477 231.672,-802.014 221.079,-801.831 223.277,-808.477"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~pnpa_mc~~CallsGraph_edge22" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M281.677,-600.151C296.458,-614.565 323.456,-637.798 352,-647 451.984,-679.232 576.826,-644.622 639.387,-622.492"/>
<polygon fill="#000000" stroke="#000000" points="640.666,-625.752 648.88,-619.06 638.285,-619.169 640.666,-625.752"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~pnpa_mc~~CallsGraph_node16" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node16"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="474,-638 374,-638 374,-614 474,-614 474,-638"/>
<text text-anchor="middle" x="424" y="-623.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~pnpa_mc~~CallsGraph_edge23" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M298.063,-594.97C316.699,-599.599 341.852,-605.846 364.703,-611.521"/>
<polygon fill="#000000" stroke="#000000" points="364.12,-614.982 374.669,-613.996 365.807,-608.189 364.12,-614.982"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~pnpa_mc~~CallsGraph_node30" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node30"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="605,-562 537,-562 537,-538 605,-538 605,-562"/>
<text text-anchor="middle" x="571" y="-547.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~pnpa_mc~~CallsGraph_edge24" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M298.24,-585.175C341.072,-580.794 424.995,-571.836 496,-562 506.056,-560.607 516.853,-558.949 527.008,-557.316"/>
<polygon fill="#000000" stroke="#000000" points="527.59,-560.768 536.896,-555.703 526.463,-553.859 527.59,-560.768"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~pnpa_mc~~CallsGraph_node31" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node31"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="454.5,-482 393.5,-482 393.5,-458 454.5,-458 454.5,-482"/>
<text text-anchor="middle" x="424" y="-467.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~pnpa_mc~~CallsGraph_edge25" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M285.797,-575.816C312.596,-555.148 367.133,-513.087 398.782,-488.678"/>
<polygon fill="#000000" stroke="#000000" points="401.278,-491.173 407.059,-482.294 397.003,-485.63 401.278,-491.173"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~pnpa_mc~~CallsGraph_edge26" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M298.418,-456.883C360.707,-432.39 511.544,-384.562 610,-449 656.529,-479.453 671.864,-548.917 676.776,-584.733"/>
<polygon fill="#000000" stroke="#000000" points="673.305,-585.184 677.989,-594.687 680.254,-584.337 673.305,-585.184"/>
</g>
<!-- proc~get_position -->
<g id="proc~~pnpa_mc~~CallsGraph_node27" class="node"><title>proc~get_position</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node27"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="459,-402 389,-402 389,-378 459,-378 459,-402"/>
<text text-anchor="middle" x="424" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~pnpa_mc~~CallsGraph_edge28" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M286.312,-456.899C302.413,-445.336 328.03,-427.948 352,-416 360.632,-411.697 370.158,-407.722 379.354,-404.242"/>
<polygon fill="#000000" stroke="#000000" points="380.575,-407.522 388.765,-400.801 378.172,-400.948 380.575,-407.522"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~pnpa_mc~~CallsGraph_edge27" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M303.251,-477.978C357.764,-492.696 466.113,-521.951 526.602,-538.282"/>
<polygon fill="#000000" stroke="#000000" points="526.033,-541.754 536.6,-540.982 527.858,-534.996 526.033,-541.754"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~pnpa_mc~~CallsGraph_edge29" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M303.199,-469.217C326.731,-469.371 358.413,-469.578 383.287,-469.74"/>
<polygon fill="#000000" stroke="#000000" points="383.463,-473.242 393.486,-469.807 383.509,-466.242 383.463,-473.242"/>
</g>
<!-- proc~in_boundary -->
<g id="proc~~pnpa_mc~~CallsGraph_node20" class="node"><title>proc~in_boundary</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node20"><a xlink:href=".././proc/in_boundary.html" xlink:title="in_boundary">
<polygon fill="#d94e8f" stroke="#d94e8f" points="460,-192 388,-192 388,-168 460,-168 460,-192"/>
<text text-anchor="middle" x="424" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_boundary</text>
</a>
</g>
</g>
<!-- proc~hit_npa_detector&#45;&gt;proc~in_boundary -->
<g id="proc~~pnpa_mc~~CallsGraph_edge31" class="edge"><title>proc~hit_npa_detector&#45;&gt;proc~in_boundary</title>
<path fill="none" stroke="#000000" d="M313.844,-209.964C333.937,-204.449 357.732,-197.917 377.968,-192.362"/>
<polygon fill="#000000" stroke="#000000" points="379.168,-195.662 387.885,-189.639 377.315,-188.911 379.168,-195.662"/>
</g>
<!-- proc~line_plane_intersect -->
<g id="proc~~pnpa_mc~~CallsGraph_node24" class="node"><title>proc~line_plane_intersect</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node24"><a xlink:href=".././proc/line_plane_intersect.html" xlink:title="line_plane_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="478,-234 370,-234 370,-210 478,-210 478,-234"/>
<text text-anchor="middle" x="424" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">line_plane_intersect</text>
</a>
</g>
</g>
<!-- proc~hit_npa_detector&#45;&gt;proc~line_plane_intersect -->
<g id="proc~~pnpa_mc~~CallsGraph_edge30" class="edge"><title>proc~hit_npa_detector&#45;&gt;proc~line_plane_intersect</title>
<path fill="none" stroke="#000000" d="M315.905,-222C329.708,-222 345.102,-222 359.817,-222"/>
<polygon fill="#000000" stroke="#000000" points="359.869,-225.5 369.869,-222 359.869,-218.5 359.869,-225.5"/>
</g>
<!-- proc~attenuate&#45;&gt;proc~get_plasma -->
<g id="proc~~pnpa_mc~~CallsGraph_edge33" class="edge"><title>proc~attenuate&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M169.185,-468.222C185.511,-468.35 206.402,-468.515 224.767,-468.66"/>
<polygon fill="#000000" stroke="#000000" points="224.921,-472.161 234.948,-468.74 224.976,-465.161 224.921,-472.161"/>
</g>
<!-- proc~colrad -->
<g id="proc~~pnpa_mc~~CallsGraph_node23" class="node"><title>proc~colrad</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node23"><a xlink:href=".././proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="296,-339 242,-339 242,-315 296,-315 296,-339"/>
<text text-anchor="middle" x="269" y="-324.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~attenuate&#45;&gt;proc~colrad -->
<g id="proc~~pnpa_mc~~CallsGraph_edge32" class="edge"><title>proc~attenuate&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M151.828,-455.978C173.65,-431.751 223.113,-376.835 249.919,-347.074"/>
<polygon fill="#000000" stroke="#000000" points="252.745,-349.166 256.837,-339.393 247.544,-344.481 252.745,-349.166"/>
</g>
<!-- proc~approx_eq -->
<g id="proc~~pnpa_mc~~CallsGraph_node17" class="node"><title>proc~approx_eq</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node17"><a xlink:href=".././proc/approx_eq.html" xlink:title="approx_eq">
<polygon fill="#d94e8f" stroke="#d94e8f" points="301,-129 237,-129 237,-105 301,-105 301,-129"/>
<text text-anchor="middle" x="269" y="-114.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_eq</text>
</a>
</g>
</g>
<!-- proc~npa_gyro_range&#45;&gt;proc~approx_eq -->
<g id="proc~~pnpa_mc~~CallsGraph_edge35" class="edge"><title>proc~npa_gyro_range&#45;&gt;proc~approx_eq</title>
<path fill="none" stroke="#000000" d="M174.164,-219.758C178.455,-217.281 182.55,-214.377 186,-211 211.854,-185.697 196.041,-163.195 222,-138 223.874,-136.181 225.934,-134.501 228.111,-132.953"/>
<polygon fill="#000000" stroke="#000000" points="230.195,-135.783 236.943,-127.615 226.575,-129.792 230.195,-135.783"/>
</g>
<!-- proc~gyro_range -->
<g id="proc~~pnpa_mc~~CallsGraph_node19" class="node"><title>proc~gyro_range</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node19"><a xlink:href=".././proc/gyro_range.html" xlink:title="gyro_range">
<polygon fill="#d9534f" stroke="#d9534f" points="302.5,-171 235.5,-171 235.5,-147 302.5,-147 302.5,-171"/>
<text text-anchor="middle" x="269" y="-156.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_range</text>
</a>
</g>
</g>
<!-- proc~npa_gyro_range&#45;&gt;proc~gyro_range -->
<g id="proc~~pnpa_mc~~CallsGraph_edge34" class="edge"><title>proc~npa_gyro_range&#45;&gt;proc~gyro_range</title>
<path fill="none" stroke="#000000" d="M168.408,-219.895C174.283,-217.111 180.404,-214.064 186,-211 205.159,-200.511 225.93,-187.319 241.773,-176.847"/>
<polygon fill="#000000" stroke="#000000" points="244.106,-179.498 250.483,-171.036 240.222,-173.675 244.106,-179.498"/>
</g>
<!-- proc~store_npa&#45;&gt;proc~get_fields -->
<g id="proc~~pnpa_mc~~CallsGraph_edge36" class="edge"><title>proc~store_npa&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M170.776,-557.378C188.507,-562.963 211.179,-570.104 230.169,-576.085"/>
<polygon fill="#000000" stroke="#000000" points="229.129,-579.427 239.718,-579.092 231.232,-572.75 229.129,-579.427"/>
</g>
<!-- proc~store_npa&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~pnpa_mc~~CallsGraph_edge37" class="edge"><title>proc~store_npa&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M170.826,-548.139C245.324,-548.486 439.792,-549.393 526.813,-549.799"/>
<polygon fill="#000000" stroke="#000000" points="526.861,-553.299 536.877,-549.846 526.894,-546.299 526.861,-553.299"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_node36" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="463.5,-907 384.5,-907 384.5,-883 463.5,-883 463.5,-907"/>
<text text-anchor="middle" x="424" y="-892.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge38" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M301.733,-760.245C306.722,-762.792 311.659,-765.717 316,-769 356.101,-799.328 391.428,-847.157 409.734,-874.329"/>
<polygon fill="#000000" stroke="#000000" points="406.835,-876.29 415.272,-882.697 412.672,-872.426 406.835,-876.29"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge39" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M302.615,-718C307.388,-720.553 312.026,-723.543 316,-727 364.44,-769.141 398.9,-838.527 414.178,-873.47"/>
<polygon fill="#000000" stroke="#000000" points="410.994,-874.927 418.137,-882.752 417.433,-872.181 410.994,-874.927"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge40" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M302.615,-1072C307.388,-1069.45 312.026,-1066.46 316,-1063 364.44,-1020.86 398.9,-951.473 414.178,-916.53"/>
<polygon fill="#000000" stroke="#000000" points="417.433,-917.819 418.137,-907.248 410.994,-915.073 417.433,-917.819"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge41" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M301.733,-1029.76C306.722,-1027.21 311.659,-1024.28 316,-1021 356.101,-990.672 391.428,-942.843 409.734,-915.671"/>
<polygon fill="#000000" stroke="#000000" points="412.672,-917.574 415.272,-907.303 406.835,-913.71 412.672,-917.574"/>
</g>
<!-- proc~gyro_range&#45;&gt;proc~in_boundary -->
<g id="proc~~pnpa_mc~~CallsGraph_edge43" class="edge"><title>proc~gyro_range&#45;&gt;proc~in_boundary</title>
<path fill="none" stroke="#000000" d="M302.822,-163.505C324.719,-166.51 353.795,-170.501 377.863,-173.805"/>
<polygon fill="#000000" stroke="#000000" points="377.452,-177.281 387.835,-175.173 378.404,-170.346 377.452,-177.281"/>
</g>
<!-- proc~gyro_range&#45;&gt;proc~line_plane_intersect -->
<g id="proc~~pnpa_mc~~CallsGraph_edge45" class="edge"><title>proc~gyro_range&#45;&gt;proc~line_plane_intersect</title>
<path fill="none" stroke="#000000" d="M291.073,-171.172C307.342,-180.227 330.614,-192.447 352,-201 357.072,-203.029 362.417,-204.963 367.805,-206.777"/>
<polygon fill="#000000" stroke="#000000" points="366.906,-210.165 377.498,-209.91 369.059,-203.504 366.906,-210.165"/>
</g>
<!-- proc~in_gyro_surface -->
<g id="proc~~pnpa_mc~~CallsGraph_node35" class="node"><title>proc~in_gyro_surface</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node35"><a xlink:href=".././proc/in_gyro_surface.html" xlink:title="in_gyro_surface">
<polygon fill="#d94e8f" stroke="#d94e8f" points="468.5,-108 379.5,-108 379.5,-84 468.5,-84 468.5,-108"/>
<text text-anchor="middle" x="424" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_gyro_surface</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~in_gyro_surface -->
<g id="proc~~pnpa_mc~~CallsGraph_edge42" class="edge"><title>proc~gyro_range&#45;&gt;proc~in_gyro_surface</title>
<path fill="none" stroke="#000000" d="M297.946,-146.782C303.955,-144.005 310.232,-140.989 316,-138 332.446,-129.476 334.996,-124.347 352,-117 357.518,-114.616 363.39,-112.402 369.301,-110.376"/>
<polygon fill="#000000" stroke="#000000" points="370.805,-113.567 379.233,-107.146 368.64,-106.91 370.805,-113.567"/>
</g>
<!-- proc~boundary_edge -->
<g id="proc~~pnpa_mc~~CallsGraph_node37" class="node"><title>proc~boundary_edge</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node37"><a xlink:href=".././proc/boundary_edge.html" xlink:title="boundary_edge">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-66 380,-66 380,-42 468,-42 468,-66"/>
<text text-anchor="middle" x="424" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boundary_edge</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~boundary_edge -->
<g id="proc~~pnpa_mc~~CallsGraph_edge44" class="edge"><title>proc~gyro_range&#45;&gt;proc~boundary_edge</title>
<path fill="none" stroke="#000000" d="M302.763,-147.166C307.517,-144.592 312.11,-141.552 316,-138 339.816,-116.256 326.715,-95.0164 352,-75 357.417,-70.7116 363.69,-67.2982 370.219,-64.5815"/>
<polygon fill="#000000" stroke="#000000" points="371.687,-67.7724 379.9,-61.0789 369.306,-61.19 371.687,-67.7724"/>
</g>
<!-- proc~gyro_surface_coordinates -->
<g id="proc~~pnpa_mc~~CallsGraph_node39" class="node"><title>proc~gyro_surface_coordinates</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node39"><a xlink:href=".././proc/gyro_surface_coordinates.html" xlink:title="gyro_surface_coordinates">
<polygon fill="#d9534f" stroke="#d9534f" points="492,-24 356,-24 356,-0 492,-0 492,-24"/>
<text text-anchor="middle" x="424" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_surface_coordinates</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~gyro_surface_coordinates -->
<g id="proc~~pnpa_mc~~CallsGraph_edge46" class="edge"><title>proc~gyro_range&#45;&gt;proc~gyro_surface_coordinates</title>
<path fill="none" stroke="#000000" d="M302.914,-148.046C307.761,-145.344 312.344,-142.033 316,-138 349.134,-101.45 316.379,-67.1309 352,-33 353.276,-31.7772 354.62,-30.6252 356.021,-29.5398"/>
<polygon fill="#000000" stroke="#000000" points="358.074,-32.3808 364.588,-24.0248 354.285,-26.4949 358.074,-32.3808"/>
</g>
<!-- proc~line_gyro_surface_intersect -->
<g id="proc~~pnpa_mc~~CallsGraph_node41" class="node"><title>proc~line_gyro_surface_intersect</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node41"><a xlink:href=".././proc/line_gyro_surface_intersect.html" xlink:title="line_gyro_surface_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="496,-150 352,-150 352,-126 496,-126 496,-150"/>
<text text-anchor="middle" x="424" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">line_gyro_surface_intersect</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~line_gyro_surface_intersect -->
<g id="proc~~pnpa_mc~~CallsGraph_edge47" class="edge"><title>proc~gyro_range&#45;&gt;proc~line_gyro_surface_intersect</title>
<path fill="none" stroke="#000000" d="M302.822,-154.495C314.41,-152.905 328.008,-151.038 341.811,-149.144"/>
<polygon fill="#000000" stroke="#000000" points="342.44,-152.59 351.871,-147.763 341.488,-145.655 342.44,-152.59"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge48" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M299.25,-987.913C304.933,-985.214 310.751,-982.196 316,-979 347.876,-959.592 381.17,-932.137 401.985,-913.965"/>
<polygon fill="#000000" stroke="#000000" points="404.401,-916.501 409.583,-907.26 399.769,-911.253 404.401,-916.501"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge49" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M299.5,-945.853C323.707,-935.885 358.165,-921.697 384.535,-910.839"/>
<polygon fill="#000000" stroke="#000000" points="385.936,-914.047 393.85,-907.003 383.271,-907.574 385.936,-914.047"/>
</g>
<!-- proc~linsolve -->
<g id="proc~~pnpa_mc~~CallsGraph_node32" class="node"><title>proc~linsolve</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node32"><a xlink:href=".././proc/linsolve.html" xlink:title="linsolve">
<polygon fill="#d9534f" stroke="#d9534f" points="451,-276 397,-276 397,-252 451,-252 451,-276"/>
<text text-anchor="middle" x="424" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linsolve</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~linsolve -->
<g id="proc~~pnpa_mc~~CallsGraph_edge52" class="edge"><title>proc~colrad&#45;&gt;proc~linsolve</title>
<path fill="none" stroke="#000000" d="M291.073,-314.828C307.342,-305.773 330.614,-293.553 352,-285 363.262,-280.496 375.868,-276.459 387.297,-273.157"/>
<polygon fill="#000000" stroke="#000000" points="388.286,-276.515 396.974,-270.451 386.401,-269.773 388.286,-276.515"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~pnpa_mc~~CallsGraph_node33" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node33"><a xlink:href=".././proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-360 380,-360 380,-336 468,-336 468,-360"/>
<text text-anchor="middle" x="424" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~pnpa_mc~~CallsGraph_edge51" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M296.302,-330.61C316.427,-333.372 344.85,-337.274 369.677,-340.681"/>
<polygon fill="#000000" stroke="#000000" points="369.32,-344.165 379.703,-342.057 370.272,-337.23 369.32,-344.165"/>
</g>
<!-- proc~eigen -->
<g id="proc~~pnpa_mc~~CallsGraph_node38" class="node"><title>proc~eigen</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node38"><a xlink:href=".././proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="451,-318 397,-318 397,-294 451,-294 451,-318"/>
<text text-anchor="middle" x="424" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~pnpa_mc~~CallsGraph_edge50" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M296.302,-323.39C321.227,-319.969 358.881,-314.801 386.667,-310.987"/>
<polygon fill="#000000" stroke="#000000" points="387.355,-314.425 396.786,-309.598 386.403,-307.49 387.355,-314.425"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge53" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.665,-909.869C333.357,-907.304 355.134,-904.315 374.241,-901.692"/>
<polygon fill="#000000" stroke="#000000" points="374.82,-905.146 384.251,-900.318 373.868,-898.211 374.82,-905.146"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge54" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M313.026,-879.906C332.144,-882.53 354.736,-885.63 374.454,-888.337"/>
<polygon fill="#000000" stroke="#000000" points="374.087,-891.819 384.47,-889.712 375.039,-884.884 374.087,-891.819"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~pnpa_mc~~CallsGraph_node42" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node42"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="602,-402 540,-402 540,-378 602,-378 602,-402"/>
<text text-anchor="middle" x="571" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~pnpa_mc~~CallsGraph_edge55" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M459.363,-390C480.474,-390 507.615,-390 529.732,-390"/>
<polygon fill="#000000" stroke="#000000" points="529.818,-393.5 539.818,-390 529.818,-386.5 529.818,-393.5"/>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge56" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M299.5,-844.147C323.707,-854.115 358.165,-868.303 384.535,-879.161"/>
<polygon fill="#000000" stroke="#000000" points="383.271,-882.426 393.85,-882.997 385.936,-875.953 383.271,-882.426"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge57" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M299.25,-802.087C304.933,-804.786 310.751,-807.804 316,-811 347.876,-830.408 381.17,-857.863 401.985,-876.035"/>
<polygon fill="#000000" stroke="#000000" points="399.769,-878.747 409.583,-882.74 404.401,-873.499 399.769,-878.747"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~pnpa_mc~~CallsGraph_edge60" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M454.567,-478.544C467.672,-482.902 483.026,-488.81 496,-496 513.729,-505.825 515.628,-512.049 532,-524 535.658,-526.67 539.558,-529.432 543.414,-532.114"/>
<polygon fill="#000000" stroke="#000000" points="541.45,-535.011 551.673,-537.791 545.415,-529.242 541.45,-535.011"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~pnpa_mc~~CallsGraph_node34" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node34"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="712.5,-460 647.5,-460 647.5,-436 712.5,-436 712.5,-460"/>
<text text-anchor="middle" x="680" y="-445.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~pnpa_mc~~CallsGraph_edge58" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M454.741,-480.337C491.788,-491.641 556.702,-506.248 610,-491 626.98,-486.142 643.845,-475.761 656.651,-466.415"/>
<polygon fill="#000000" stroke="#000000" points="658.987,-469.036 664.82,-460.192 654.745,-463.468 658.987,-469.036"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~pnpa_mc~~CallsGraph_node40" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node40"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="609.5,-482 532.5,-482 532.5,-458 609.5,-458 609.5,-482"/>
<text text-anchor="middle" x="571" y="-467.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~pnpa_mc~~CallsGraph_edge59" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M454.693,-470C474.077,-470 499.821,-470 522.066,-470"/>
<polygon fill="#000000" stroke="#000000" points="522.332,-473.5 532.332,-470 522.332,-466.5 522.332,-473.5"/>
</g>
<!-- dgetrf -->
<g id="proc~~pnpa_mc~~CallsGraph_node44" class="node"><title>dgetrf</title>
<polygon fill="#777777" stroke="#777777" points="598,-66 544,-66 544,-42 598,-42 598,-66"/>
<text text-anchor="middle" x="571" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrf</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrf -->
<g id="proc~~pnpa_mc~~CallsGraph_edge61" class="edge"><title>proc~linsolve&#45;&gt;dgetrf</title>
<path fill="none" stroke="#000000" d="M451.067,-262.705C466.233,-260.563 484.557,-255.354 496,-243 547.892,-186.979 486.488,-136.317 532,-75 533.179,-73.4112 534.516,-71.9274 535.966,-70.5439"/>
<polygon fill="#000000" stroke="#000000" points="538.132,-73.2934 543.95,-64.4386 533.88,-67.7329 538.132,-73.2934"/>
</g>
<!-- proc~matinv -->
<g id="proc~~pnpa_mc~~CallsGraph_node47" class="node"><title>proc~matinv</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node47"><a xlink:href=".././proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-150 544,-150 544,-126 598,-126 598,-150"/>
<text text-anchor="middle" x="571" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~linsolve&#45;&gt;proc~matinv -->
<g id="proc~~pnpa_mc~~CallsGraph_edge62" class="edge"><title>proc~linsolve&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M451.278,-261.699C465.954,-259.182 483.704,-253.932 496,-243 526.355,-216.012 504.75,-189.12 532,-159 533.147,-157.732 534.39,-156.524 535.701,-155.374"/>
<polygon fill="#000000" stroke="#000000" points="537.801,-158.175 543.79,-149.436 533.658,-152.533 537.801,-158.175"/>
</g>
<!-- dgetrs -->
<g id="proc~~pnpa_mc~~CallsGraph_node50" class="node"><title>dgetrs</title>
<polygon fill="#777777" stroke="#777777" points="598,-108 544,-108 544,-84 598,-84 598,-108"/>
<text text-anchor="middle" x="571" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrs</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrs -->
<g id="proc~~pnpa_mc~~CallsGraph_edge63" class="edge"><title>proc~linsolve&#45;&gt;dgetrs</title>
<path fill="none" stroke="#000000" d="M451.121,-262.373C466.114,-260.101 484.239,-254.871 496,-243 536.991,-201.627 495.737,-162.574 532,-117 533.097,-115.621 534.311,-114.319 535.61,-113.091"/>
<polygon fill="#000000" stroke="#000000" points="537.958,-115.703 543.783,-106.853 533.71,-110.139 537.958,-115.703"/>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~pnpa_mc~~CallsGraph_edge64" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M468.349,-355.973C478.005,-359.029 487.799,-363.231 496,-369 511.586,-379.964 540.533,-423.284 557.229,-449.498"/>
<polygon fill="#000000" stroke="#000000" points="554.284,-451.389 562.582,-457.976 560.203,-447.652 554.284,-451.389"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~pnpa_mc~~CallsGraph_node43" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node43"><a xlink:href=".././proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-276 544,-276 544,-252 598,-252 598,-276"/>
<text text-anchor="middle" x="571" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~pnpa_mc~~CallsGraph_edge65" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M451.258,-298.394C474.458,-291.674 508.499,-281.814 534.192,-274.372"/>
<polygon fill="#000000" stroke="#000000" points="535.306,-277.693 543.937,-271.549 533.358,-270.97 535.306,-277.693"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~pnpa_mc~~CallsGraph_node45" class="node"><title>proc~elmhes</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node45"><a xlink:href=".././proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-234 544,-234 544,-210 598,-210 598,-234"/>
<text text-anchor="middle" x="571" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~pnpa_mc~~CallsGraph_edge66" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M451.154,-301.994C465.271,-298.948 482.515,-293.737 496,-285 516.634,-271.632 512.937,-258.526 532,-243 533.366,-241.887 534.8,-240.803 536.277,-239.75"/>
<polygon fill="#000000" stroke="#000000" points="538.534,-242.46 545.049,-234.105 534.746,-236.574 538.534,-242.46"/>
</g>
<!-- proc~balback -->
<g id="proc~~pnpa_mc~~CallsGraph_node46" class="node"><title>proc~balback</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node46"><a xlink:href=".././proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-192 544,-192 544,-168 598,-168 598,-192"/>
<text text-anchor="middle" x="571" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~pnpa_mc~~CallsGraph_edge67" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M451.278,-303.699C465.954,-301.182 483.704,-295.932 496,-285 526.355,-258.012 504.75,-231.12 532,-201 533.147,-199.732 534.39,-198.524 535.701,-197.374"/>
<polygon fill="#000000" stroke="#000000" points="537.801,-200.175 543.79,-191.436 533.658,-194.533 537.801,-200.175"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~pnpa_mc~~CallsGraph_node48" class="node"><title>proc~hqr2</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node48"><a xlink:href=".././proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-360 544,-360 544,-336 598,-336 598,-360"/>
<text text-anchor="middle" x="571" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge68" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M451.258,-313.606C474.458,-320.326 508.499,-330.186 534.192,-337.628"/>
<polygon fill="#000000" stroke="#000000" points="533.358,-341.03 543.937,-340.451 535.306,-334.307 533.358,-341.03"/>
</g>
<!-- proc~balance -->
<g id="proc~~pnpa_mc~~CallsGraph_node49" class="node"><title>proc~balance</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node49"><a xlink:href=".././proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-318 544,-318 544,-294 598,-294 598,-318"/>
<text text-anchor="middle" x="571" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~pnpa_mc~~CallsGraph_edge69" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M451.258,-306C474.355,-306 508.198,-306 533.85,-306"/>
<polygon fill="#000000" stroke="#000000" points="533.937,-309.5 543.937,-306 533.937,-302.5 533.937,-309.5"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~pnpa_mc~~CallsGraph_edge71" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M594.845,-402.248C600.386,-406.066 605.89,-410.69 610,-416 650.462,-468.274 668.667,-546.43 675.514,-584.517"/>
<polygon fill="#000000" stroke="#000000" points="672.094,-585.288 677.219,-594.561 678.996,-584.116 672.094,-585.288"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~pnpa_mc~~CallsGraph_edge70" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M594.17,-402.018C609.665,-410.417 630.573,-421.75 647.754,-431.063"/>
<polygon fill="#000000" stroke="#000000" points="646.399,-434.309 656.858,-435.998 649.734,-428.155 646.399,-434.309"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~pnpa_mc~~CallsGraph_node51" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node51"><a xlink:href=".././proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="707,-150 653,-150 653,-126 707,-126 707,-150"/>
<text text-anchor="middle" x="680" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~pnpa_mc~~CallsGraph_edge72" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M598.175,-138C611.518,-138 627.96,-138 642.523,-138"/>
<polygon fill="#000000" stroke="#000000" points="642.724,-141.5 652.724,-138 642.724,-134.5 642.724,-141.5"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~pnpa_mc~~CallsGraph_node52" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node52"><a xlink:href=".././proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="707,-360 653,-360 653,-336 707,-336 707,-360"/>
<text text-anchor="middle" x="680" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~pnpa_mc~~CallsGraph_edge73" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M598.175,-348C611.518,-348 627.96,-348 642.523,-348"/>
<polygon fill="#000000" stroke="#000000" points="642.724,-351.5 652.724,-348 642.724,-344.5 642.724,-351.5"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~pnpa_mc~~CallsGraph_node53" class="node"><title>proc~outerprod</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node53"><a xlink:href=".././proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="809.5,-150 750.5,-150 750.5,-126 809.5,-126 809.5,-150"/>
<text text-anchor="middle" x="780" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~pnpa_mc~~CallsGraph_edge74" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M707.005,-138C717.251,-138 729.231,-138 740.446,-138"/>
<polygon fill="#000000" stroke="#000000" points="740.459,-141.5 750.459,-138 740.459,-134.5 740.459,-141.5"/>
</g>
</g>
</svg>
</div><script>var panprocpnpa_mcCallsGraph = svgPanZoom('#procpnpa_mcCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~pnpa_mc~~CalledByGraph Pages: 1 -->
<svg id="procpnpa_mcCalledByGraph" width="156pt" height="32pt"
 viewBox="0.00 0.00 156.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pnpa_mc~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~pnpa_mc~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 152,-28 152,4 -4,4"/>
<!-- proc~pnpa_mc -->
<g id="proc~~pnpa_mc~~CalledByGraph_node1" class="node"><title>proc~pnpa_mc</title>
<polygon fill="none" stroke="black" points="147.5,-24 90.5,-24 90.5,-0 147.5,-0 147.5,-24"/>
<text text-anchor="middle" x="119" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">pnpa_mc</text>
</g>
<!-- program~fidasim -->
<g id="proc~~pnpa_mc~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~pnpa_mc~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~pnpa_mc -->
<g id="proc~~pnpa_mc~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~pnpa_mc</title>
<path fill="none" stroke="#000000" d="M54.0317,-12C62.2408,-12 71.4806,-12 80.3316,-12"/>
<polygon fill="#000000" stroke="#000000" points="80.4582,-15.5001 90.4582,-12 80.4582,-8.5001 80.4582,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pnpa_mc.html#src">pnpa_mc</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">pnpa_mc</span>
    <span class="c">!+ Calculate Passive NPA flux using a Monte Carlo fast-ion distribution</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iion</span><span class="p">,</span><span class="n">igamma</span><span class="p">,</span><span class="n">ngamma</span><span class="p">,</span><span class="n">npart</span>
    <span class="k">type</span><span class="p">(</span><span class="n">FastIon</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fast_ion</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">phi</span><span class="p">,</span><span class="n">theta</span><span class="p">,</span><span class="n">dtheta</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ri</span><span class="p">,</span> <span class="n">rf</span><span class="p">,</span> <span class="n">rg</span><span class="p">,</span> <span class="n">vi</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">det</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">ichan</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">nrange</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="k">is</span>
<span class="k">    type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fields</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span> <span class="kd">::</span> <span class="n">plasma</span>
    <span class="k">type</span><span class="p">(</span><span class="n">GyroSurface</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gs</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rates</span><span class="p">,</span> <span class="n">rates_is</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">states</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">flux</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ind</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">uvw</span><span class="p">,</span> <span class="n">uvw_vi</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gyrange</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">s</span><span class="p">,</span><span class="n">c</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">randomu</span>

    <span class="n">ngamma</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">.</span><span class="nb">or</span><span class="p">.(</span><span class="n">inputs</span><span class="p">%</span><span class="n">dist_type</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">))</span> <span class="k">then</span>
<span class="k">        </span><span class="n">ngamma</span> <span class="o">=</span> <span class="nb">ceiling</span><span class="p">(</span><span class="nb">dble</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_pnpa</span><span class="p">)</span><span class="o">/</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="p">)</span>
    <span class="n">endif</span>

    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i10)&#39;</span><span class="p">)</span> <span class="nb">int</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="o">*</span><span class="n">ngamma</span><span class="p">,</span><span class="n">Int64</span><span class="p">)</span>
    <span class="n">endif</span>

    <span class="c">!$OMP PARALLEL DO schedule(guided) private(iion,igamma,ind,fast_ion,vi,ri,rf,phi,s,c,ir,it,plasma, &amp;</span>
    <span class="c">!$OMP&amp; randomu,rg,fields,uvw,uvw_vi,rates,rates_is,is,states,flux,det,ichan,gs,nrange,gyrange,theta,dtheta)</span>
    <span class="n">loop_over_fast_ions</span><span class="p">:</span> <span class="k">do </span><span class="n">iion</span><span class="o">=</span><span class="n">istart</span><span class="p">,</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="p">,</span><span class="n">istep</span>
        <span class="n">fast_ion</span> <span class="o">=</span> <span class="n">particles</span><span class="p">%</span><span class="n">fast_ion</span><span class="p">(</span><span class="n">iion</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vabs</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">loop_over_fast_ions</span>
        <span class="n">gamma_loop</span><span class="p">:</span> <span class="k">do </span><span class="n">igamma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ngamma</span>
            <span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">)</span> <span class="k">then</span>
                <span class="c">!! Pick random toroidal angle</span>
                <span class="k">call </span><span class="n">randu</span><span class="p">(</span><span class="n">randomu</span><span class="p">)</span>
                <span class="n">phi</span> <span class="o">=</span> <span class="n">pass_grid</span><span class="p">%</span><span class="n">phi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">nphi</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dphi</span><span class="o">*</span><span class="n">randomu</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span>
<span class="k">                </span><span class="n">phi</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">phi</span>
            <span class="n">endif</span>
            <span class="n">s</span> <span class="o">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="nb">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>

            <span class="c">!! Calculate position in machine coordinates</span>
            <span class="n">uvw</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">c</span>
            <span class="n">uvw</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">s</span>
            <span class="n">uvw</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">z</span>

            <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">dist_type</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
                <span class="c">!! Get electomagnetic fields</span>
                <span class="k">call </span><span class="n">get_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">uvw</span><span class="p">,</span> <span class="n">input_coords</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

                <span class="c">!! Correct for gyro motion and get position and velocity</span>
                <span class="k">call </span><span class="n">gyro_surface</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">energy</span><span class="p">,</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">pitch</span><span class="p">,</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">A</span><span class="p">,</span> <span class="n">gs</span><span class="p">)</span>

                <span class="n">detector_loop</span><span class="p">:</span> <span class="k">do </span><span class="n">ichan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">npa_chords</span><span class="p">%</span><span class="n">nchan</span>
                    <span class="k">call </span><span class="n">npa_gyro_range</span><span class="p">(</span><span class="n">ichan</span><span class="p">,</span> <span class="n">gs</span><span class="p">,</span> <span class="n">gyrange</span><span class="p">,</span> <span class="n">nrange</span><span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">nrange</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">detector_loop</span>

                    <span class="n">gyro_range_loop</span><span class="p">:</span> <span class="k">do </span><span class="n">ir</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nrange</span>
                        <span class="n">dtheta</span> <span class="o">=</span> <span class="n">gyrange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span>
                        <span class="n">theta</span> <span class="o">=</span> <span class="n">gyrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dtheta</span>
                        <span class="k">call </span><span class="n">gyro_trajectory</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">)</span>

                        <span class="c">!! Check if particle hits a NPA detector</span>
                        <span class="k">call </span><span class="n">hit_npa_detector</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span> <span class="n">vi</span> <span class="p">,</span><span class="n">det</span><span class="p">,</span> <span class="n">rf</span><span class="p">,</span> <span class="n">det</span><span class="o">=</span><span class="n">ichan</span><span class="p">)</span>
                        <span class="k">if</span><span class="p">(</span><span class="n">det</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">ichan</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                            if</span> <span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="k">                                write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s2">&quot;PNPA_MC: Missed Detector &quot;</span><span class="p">,</span><span class="n">ichan</span>
                            <span class="n">endif</span>
                            <span class="k">cycle </span><span class="n">gyro_range_loop</span>
                        <span class="n">endif</span>

                        <span class="c">!! Calculate CX probability with beam and halo neutrals</span>
                        <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">)</span>
                        <span class="n">rates</span> <span class="o">=</span> <span class="mf">0.d0</span>
                        <span class="k">do is</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n_thermal</span>
                            <span class="k">call </span><span class="n">bt_cx_rates</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span> <span class="n">plasma</span><span class="p">%</span><span class="n">denn</span><span class="p">(:,</span><span class="k">is</span><span class="p">),</span> <span class="n">thermal_mass</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="n">vi</span><span class="p">,</span> <span class="n">rates_is</span><span class="p">)</span>
                            <span class="n">rates</span> <span class="o">=</span> <span class="n">rates</span> <span class="o">+</span> <span class="n">rates_is</span>
                        <span class="n">enddo</span>
                        <span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span> <span class="k">cycle </span><span class="n">gyro_range_loop</span>

                        <span class="c">!! Weight CX rates by ion source density</span>
                        <span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                            </span><span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">weight</span><span class="o">*</span><span class="p">(</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">nphi</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dphi</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span> <span class="p">&amp;</span>
                                   <span class="o">/</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dv</span><span class="p">)</span><span class="o">/</span><span class="n">ngamma</span>
                        <span class="k">else</span>
<span class="k">                            </span><span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">weight</span><span class="o">/</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dv</span><span class="p">)</span><span class="o">/</span><span class="n">ngamma</span>
                        <span class="n">endif</span>

                        <span class="c">!! Attenuate states as the particle move through plasma</span>
                        <span class="k">call </span><span class="n">attenuate</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">states</span><span class="p">)</span>

                        <span class="c">!! Store NPA Flux</span>
                        <span class="n">flux</span> <span class="o">=</span> <span class="p">(</span><span class="n">dtheta</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dv</span><span class="p">)</span>
                        <span class="n">spread_loop</span><span class="p">:</span> <span class="k">do </span><span class="n">it</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">25</span>
                            <span class="n">theta</span> <span class="o">=</span> <span class="n">gyrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">it</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">dtheta</span><span class="o">/</span><span class="mi">25</span>
                            <span class="k">call </span><span class="n">gyro_trajectory</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">)</span>
                            <span class="k">call </span><span class="n">hit_npa_detector</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span> <span class="n">vi</span> <span class="p">,</span><span class="n">det</span><span class="p">,</span> <span class="n">rf</span><span class="p">,</span> <span class="n">det</span><span class="o">=</span><span class="n">ichan</span><span class="p">)</span>
                            <span class="k">if</span><span class="p">(</span><span class="n">det</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">ichan</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                                if</span> <span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="k">                                    write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s2">&quot;PNPA_MC: Missed Detector &quot;</span><span class="p">,</span><span class="n">ichan</span>
                                <span class="n">endif</span>
                                <span class="k">cycle </span><span class="n">spread_loop</span>
                            <span class="n">endif</span>
                            <span class="k">call </span><span class="n">store_npa</span><span class="p">(</span><span class="n">det</span><span class="p">,</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">flux</span><span class="o">/</span><span class="mi">25</span><span class="p">,</span><span class="n">fast_ion</span><span class="p">%</span><span class="k">class</span><span class="p">,</span> <span class="n">passive</span><span class="o">=</span><span class="p">.</span><span class="n">True</span><span class="p">.)</span>
                        <span class="n">enddo</span> <span class="n">spread_loop</span>
                    <span class="n">enddo</span> <span class="n">gyro_range_loop</span>
                <span class="n">enddo</span> <span class="n">detector_loop</span>
            <span class="k">else</span> <span class="c">!! Full Orbit</span>
                <span class="c">!! Convert to beam grid coordinates</span>
                <span class="k">call </span><span class="n">uvw_to_xyz</span><span class="p">(</span><span class="n">uvw</span><span class="p">,</span> <span class="n">ri</span><span class="p">)</span>

                <span class="c">!! Calculate velocity vector</span>
                <span class="n">uvw_vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vr</span> <span class="o">-</span> <span class="n">s</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vt</span>
                <span class="n">uvw_vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vr</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vt</span>
                <span class="n">uvw_vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">vz</span>
                <span class="n">vi</span> <span class="o">=</span> <span class="nb">matmul</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">inv_basis</span><span class="p">,</span><span class="n">uvw_vi</span><span class="p">)</span>

                <span class="c">!! Check if particle hits a NPA detector</span>
                <span class="k">call </span><span class="n">hit_npa_detector</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span> <span class="n">vi</span> <span class="p">,</span><span class="n">det</span><span class="p">,</span> <span class="n">rf</span><span class="p">)</span>
                <span class="k">if</span><span class="p">(</span><span class="n">det</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">gamma_loop</span>

                <span class="c">!! Calculate CX probability with edge neutrals</span>
                <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">)</span>
                <span class="n">rates</span> <span class="o">=</span> <span class="mf">0.d0</span>
                <span class="k">do is</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_thermal</span>
                    <span class="k">call </span><span class="n">bt_cx_rates</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span> <span class="n">plasma</span><span class="p">%</span><span class="n">denn</span><span class="p">(:,</span><span class="k">is</span><span class="p">),</span> <span class="n">thermal_mass</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="n">vi</span><span class="p">,</span> <span class="n">rates_is</span><span class="p">)</span>
                    <span class="n">rates</span> <span class="o">=</span> <span class="n">rates</span> <span class="o">+</span> <span class="n">rates_is</span>
                <span class="n">enddo</span>
                <span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span> <span class="k">cycle </span><span class="n">gamma_loop</span>

                <span class="c">!! Weight CX rates by ion source density</span>
                <span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                    </span><span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">weight</span><span class="o">*</span><span class="p">(</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">nphi</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dphi</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span> <span class="p">&amp;</span>
                           <span class="o">/</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dv</span><span class="p">)</span><span class="o">/</span><span class="n">ngamma</span>
                <span class="k">else</span>
<span class="k">                    </span><span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">weight</span><span class="o">/</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dv</span><span class="p">)</span><span class="o">/</span><span class="n">ngamma</span>
                <span class="n">endif</span>

                <span class="c">!! Attenuate states as the particle moves though plasma</span>
                <span class="k">call </span><span class="n">attenuate</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">states</span><span class="p">)</span>

                <span class="c">!! Store NPA Flux</span>
                <span class="n">flux</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dv</span><span class="p">)</span>
                <span class="k">call </span><span class="n">store_npa</span><span class="p">(</span><span class="n">det</span><span class="p">,</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">flux</span><span class="p">,</span><span class="n">fast_ion</span><span class="p">%</span><span class="k">class</span><span class="p">,</span><span class="n">passive</span><span class="o">=</span><span class="p">.</span><span class="n">True</span><span class="p">.)</span>
            <span class="n">endif</span>
        <span class="n">enddo</span> <span class="n">gamma_loop</span>
    <span class="n">enddo</span> <span class="n">loop_over_fast_ions</span>
    <span class="c">!$OMP END PARALLEL DO</span>

    <span class="n">npart</span> <span class="o">=</span> <span class="n">pnpa</span><span class="p">%</span><span class="n">npart</span>
<span class="cp">#ifdef _MPI</span>
    <span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">npart</span><span class="p">)</span>
    <span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">pnpa</span><span class="p">%</span><span class="n">flux</span><span class="p">)</span>
<span class="cp">#endif</span>

    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T4,&quot;Number of Passive NPA particles that hit a detector: &quot;,i8)&#39;</span><span class="p">)</span> <span class="n">npart</span>
    <span class="n">endif</span>

<span class="k">end subroutine </span><span class="n">pnpa_mc</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> FIDASIM was developed by Luke Stagner</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>