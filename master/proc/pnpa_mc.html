<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="">
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>pnpa_mc &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>User Guide</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>pnpa_mc
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.8% of total for procedures.">117 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
     <li><a href='../module/libfida.html'>libfida</a></li>
     <li class="active">pnpa_mc</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pnpa_mc.html#src">pnpa_mc</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public subroutine pnpa_mc()</h2>
    

    <p>Calculate Passive NPA flux using a Monte Carlo fast-ion distribution</p>

    <h3>Arguments</h3>
    <em>None</em>
    <br>
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~pnpa_mc~~CallsGraph Pages: 1 -->
<svg id="procpnpa_mcCallsGraph" width="641pt" height="918pt"
 viewBox="0.00 0.00 641.00 917.72" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pnpa_mc~~CallsGraph" class="graph" transform="scale(0.781707 0.781707) rotate(0) translate(4 1170)">
<title>proc~~pnpa_mc~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1170 816,-1170 816,4 -4,4"/>
<!-- proc~pnpa_mc -->
<g id="proc~~pnpa_mc~~CallsGraph_node1" class="node"><title>proc~pnpa_mc</title>
<polygon fill="none" stroke="black" points="57.5,-802 0.5,-802 0.5,-778 57.5,-778 57.5,-802"/>
<text text-anchor="middle" x="29" y="-787.6" font-family="Helvetica,sans-Serif" font-size="10.50">pnpa_mc</text>
</g>
<!-- proc~attenuate -->
<g id="proc~~pnpa_mc~~CallsGraph_node2" class="node"><title>proc~attenuate</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node2"><a xlink:href=".././proc/attenuate.html" xlink:title="attenuate">
<polygon fill="#d9534f" stroke="#d9534f" points="169,-903 111,-903 111,-879 169,-879 169,-903"/>
<text text-anchor="middle" x="140" y="-888.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">attenuate</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~attenuate -->
<g id="proc~~pnpa_mc~~CallsGraph_edge1" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~attenuate</title>
<path fill="none" stroke="#000000" d="M38.2522,-802.019C49.5232,-817.826 70.9765,-845.837 94,-865 97.7058,-868.084 101.825,-871.014 106.024,-873.719"/>
<polygon fill="#000000" stroke="#000000" points="104.28,-876.754 114.648,-878.934 107.902,-870.764 104.28,-876.754"/>
</g>
<!-- proc~gyro_surface -->
<g id="proc~~pnpa_mc~~CallsGraph_node3" class="node"><title>proc~gyro_surface</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node3"><a xlink:href=".././proc/gyro_surface.html" xlink:title="gyro_surface">
<polygon fill="#d9534f" stroke="#d9534f" points="177.5,-781 102.5,-781 102.5,-757 177.5,-757 177.5,-781"/>
<text text-anchor="middle" x="140" y="-766.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_surface</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~gyro_surface -->
<g id="proc~~pnpa_mc~~CallsGraph_edge2" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~gyro_surface</title>
<path fill="none" stroke="#000000" d="M57.5053,-784.701C68.1479,-782.65 80.6278,-780.246 92.5778,-777.944"/>
<polygon fill="#000000" stroke="#000000" points="93.282,-781.373 102.439,-776.044 91.9577,-774.499 93.282,-781.373"/>
</g>
<!-- interface~randu -->
<g id="proc~~pnpa_mc~~CallsGraph_node4" class="node"><title>interface~randu</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node4"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="167,-739 113,-739 113,-715 167,-715 167,-739"/>
<text text-anchor="middle" x="140" y="-724.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;interface~randu -->
<g id="proc~~pnpa_mc~~CallsGraph_edge3" class="edge"><title>proc~pnpa_mc&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M46.9654,-777.9C59.629,-769.108 77.5177,-757.191 94,-748 97.106,-746.268 100.379,-744.549 103.686,-742.883"/>
<polygon fill="#000000" stroke="#000000" points="105.515,-745.886 112.979,-738.366 102.455,-739.59 105.515,-745.886"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~pnpa_mc~~CallsGraph_node5" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node5"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-1004 235,-1004 235,-980 303,-980 303,-1004"/>
<text text-anchor="middle" x="269" y="-989.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~get_plasma -->
<g id="proc~~pnpa_mc~~CallsGraph_edge4" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M30.9355,-802.088C33.9773,-832.622 46.3573,-913.308 94,-954 130.213,-984.929 185.834,-992.397 224.402,-993.438"/>
<polygon fill="#000000" stroke="#000000" points="224.753,-996.943 234.798,-993.576 224.845,-989.944 224.753,-996.943"/>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~pnpa_mc~~CallsGraph_node6" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node6"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="176.5,-482 103.5,-482 103.5,-458 176.5,-458 176.5,-482"/>
<text text-anchor="middle" x="140" y="-467.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;interface~parallel_sum -->
<g id="proc~~pnpa_mc~~CallsGraph_edge5" class="edge"><title>proc~pnpa_mc&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M34.1398,-777.846C50.4614,-729.93 110.491,-553.697 131.599,-491.727"/>
<polygon fill="#000000" stroke="#000000" points="134.945,-492.76 134.856,-482.166 128.319,-490.503 134.945,-492.76"/>
</g>
<!-- proc~npa_gyro_range -->
<g id="proc~~pnpa_mc~~CallsGraph_node7" class="node"><title>proc~npa_gyro_range</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node7"><a xlink:href=".././proc/npa_gyro_range.html" xlink:title="npa_gyro_range">
<polygon fill="#d9534f" stroke="#d9534f" points="185.5,-306 94.5,-306 94.5,-282 185.5,-282 185.5,-306"/>
<text text-anchor="middle" x="140" y="-291.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_gyro_range</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~npa_gyro_range -->
<g id="proc~~pnpa_mc~~CallsGraph_edge6" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~npa_gyro_range</title>
<path fill="none" stroke="#000000" d="M31.8456,-777.829C38.6639,-733.478 63.6173,-576.44 94,-449 105.401,-401.177 122.312,-346.099 131.825,-316.174"/>
<polygon fill="#000000" stroke="#000000" points="135.255,-316.939 134.971,-306.348 128.589,-314.804 135.255,-316.939"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~pnpa_mc~~CallsGraph_node8" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node8"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="716,-1101 648,-1101 648,-1077 716,-1077 716,-1101"/>
<text text-anchor="middle" x="682" y="-1086.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~pnpa_mc~~CallsGraph_edge7" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M31.538,-802.084C40.4601,-866.442 91.4701,-1166 268,-1166 268,-1166 268,-1166 425,-1166 508.366,-1166 600.779,-1128.09 648.499,-1105.47"/>
<polygon fill="#000000" stroke="#000000" points="650.22,-1108.53 657.708,-1101.03 647.18,-1102.22 650.22,-1108.53"/>
</g>
<!-- proc~bt_cx_rates -->
<g id="proc~~pnpa_mc~~CallsGraph_node9" class="node"><title>proc~bt_cx_rates</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node9"><a xlink:href=".././proc/bt_cx_rates.html" xlink:title="bt_cx_rates">
<polygon fill="#d9534f" stroke="#d9534f" points="174,-823 106,-823 106,-799 174,-799 174,-823"/>
<text text-anchor="middle" x="140" y="-808.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bt_cx_rates</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~bt_cx_rates -->
<g id="proc~~pnpa_mc~~CallsGraph_edge8" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~bt_cx_rates</title>
<path fill="none" stroke="#000000" d="M57.5053,-795.299C69.0505,-797.523 82.758,-800.164 95.6056,-802.64"/>
<polygon fill="#000000" stroke="#000000" points="95.1854,-806.123 105.667,-804.578 96.5098,-799.249 95.1854,-806.123"/>
</g>
<!-- proc~hit_npa_detector -->
<g id="proc~~pnpa_mc~~CallsGraph_node10" class="node"><title>proc~hit_npa_detector</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node10"><a xlink:href=".././proc/hit_npa_detector.html" xlink:title="hit_npa_detector">
<polygon fill="#d9534f" stroke="#d9534f" points="315.5,-66 222.5,-66 222.5,-42 315.5,-42 315.5,-66"/>
<text text-anchor="middle" x="269" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hit_npa_detector</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~hit_npa_detector -->
<g id="proc~~pnpa_mc~~CallsGraph_edge9" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~hit_npa_detector</title>
<path fill="none" stroke="#000000" d="M29.8957,-777.645C29.5352,-707.121 30.962,-355.728 94,-273 120.813,-237.812 156.954,-268.368 186,-235 227.9,-186.866 189.074,-150.666 222,-96 227.245,-87.2922 234.84,-79.3165 242.352,-72.7093"/>
<polygon fill="#000000" stroke="#000000" points="244.869,-75.1702 250.356,-66.107 240.415,-69.7703 244.869,-75.1702"/>
</g>
<!-- proc~gyro_trajectory -->
<g id="proc~~pnpa_mc~~CallsGraph_node11" class="node"><title>proc~gyro_trajectory</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node11"><a xlink:href=".././proc/gyro_trajectory.html" xlink:title="gyro_trajectory">
<polygon fill="#d9534f" stroke="#d9534f" points="182,-226 98,-226 98,-202 182,-202 182,-226"/>
<text text-anchor="middle" x="140" y="-211.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_trajectory</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~gyro_trajectory -->
<g id="proc~~pnpa_mc~~CallsGraph_edge10" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~gyro_trajectory</title>
<path fill="none" stroke="#000000" d="M29.9674,-777.944C29.9807,-705.946 33.0263,-332.79 94,-240 95.8333,-237.21 98.0767,-234.683 100.573,-232.402"/>
<polygon fill="#000000" stroke="#000000" points="102.804,-235.103 108.666,-226.278 98.5801,-229.521 102.804,-235.103"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~pnpa_mc~~CallsGraph_node12" class="node"><title>proc~get_fields</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node12"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="298,-944 240,-944 240,-920 298,-920 298,-944"/>
<text text-anchor="middle" x="269" y="-929.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~get_fields -->
<g id="proc~~pnpa_mc~~CallsGraph_edge11" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M46.5796,-802.134C59.1971,-811.055 77.1979,-823.119 94,-832 133.112,-852.673 147.598,-848.036 186,-870 207.9,-882.526 230.617,-900.123 246.571,-913.371"/>
<polygon fill="#000000" stroke="#000000" points="244.356,-916.082 254.257,-919.853 248.869,-910.731 244.356,-916.082"/>
</g>
<!-- proc~store_npa -->
<g id="proc~~pnpa_mc~~CallsGraph_node13" class="node"><title>proc~store_npa</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node13"><a xlink:href=".././proc/store_npa.html" xlink:title="store_npa">
<polygon fill="#d9534f" stroke="#d9534f" points="170.5,-945 109.5,-945 109.5,-921 170.5,-921 170.5,-945"/>
<text text-anchor="middle" x="140" y="-930.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_npa</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~store_npa -->
<g id="proc~~pnpa_mc~~CallsGraph_edge12" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M33.5373,-802.364C40.9884,-826.419 60.4357,-879.961 94,-912 95.9099,-913.823 98.0068,-915.51 100.219,-917.069"/>
<polygon fill="#000000" stroke="#000000" points="98.7937,-920.296 109.167,-922.451 102.402,-914.297 98.7937,-920.296"/>
</g>
<!-- proc~attenuate&#45;&gt;proc~get_plasma -->
<g id="proc~~pnpa_mc~~CallsGraph_edge14" class="edge"><title>proc~attenuate&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M169.154,-901.947C174.983,-904.803 180.896,-908.172 186,-912 205.401,-926.549 204.705,-936.002 222,-953 229.129,-960.006 237.338,-967.211 244.83,-973.492"/>
<polygon fill="#000000" stroke="#000000" points="242.651,-976.231 252.594,-979.891 247.104,-970.829 242.651,-976.231"/>
</g>
<!-- proc~colrad -->
<g id="proc~~pnpa_mc~~CallsGraph_node16" class="node"><title>proc~colrad</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node16"><a xlink:href=".././proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="296,-763 242,-763 242,-739 296,-739 296,-763"/>
<text text-anchor="middle" x="269" y="-748.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~attenuate&#45;&gt;proc~colrad -->
<g id="proc~~pnpa_mc~~CallsGraph_edge13" class="edge"><title>proc~attenuate&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M152.27,-878.576C174.355,-854.23 223.484,-800.073 250.075,-770.76"/>
<polygon fill="#000000" stroke="#000000" points="252.81,-772.955 256.936,-763.196 247.625,-768.251 252.81,-772.955"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~pnpa_mc~~CallsGraph_edge18" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M278.11,-1004.08C291.182,-1022.39 318.833,-1056.56 352,-1071 447.138,-1112.43 572.642,-1104.18 637.707,-1095.86"/>
<polygon fill="#000000" stroke="#000000" points="638.551,-1099.28 647.996,-1094.48 637.619,-1092.34 638.551,-1099.28"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~pnpa_mc~~CallsGraph_node15" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node15"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="454.5,-944 393.5,-944 393.5,-920 454.5,-920 454.5,-944"/>
<text text-anchor="middle" x="424" y="-929.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~pnpa_mc~~CallsGraph_edge15" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M300.962,-979.858C324.887,-970.476 358.155,-957.43 383.914,-947.328"/>
<polygon fill="#000000" stroke="#000000" points="385.352,-950.524 393.384,-943.614 382.796,-944.007 385.352,-950.524"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~pnpa_mc~~CallsGraph_node23" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node23"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="606,-1012 538,-1012 538,-988 606,-988 606,-1012"/>
<text text-anchor="middle" x="572" y="-997.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~pnpa_mc~~CallsGraph_edge17" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M303.073,-992.879C357.788,-994.333 467.121,-997.239 527.842,-998.853"/>
<polygon fill="#000000" stroke="#000000" points="527.783,-1002.35 537.872,-999.12 527.969,-995.355 527.783,-1002.35"/>
</g>
<!-- proc~get_position -->
<g id="proc~~pnpa_mc~~CallsGraph_node30" class="node"><title>proc~get_position</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node30"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="459,-1062 389,-1062 389,-1038 459,-1038 459,-1062"/>
<text text-anchor="middle" x="424" y="-1047.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~pnpa_mc~~CallsGraph_edge16" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M300.316,-1004.01C315.758,-1010.08 334.847,-1017.51 352,-1024 361.113,-1027.45 370.909,-1031.08 380.227,-1034.5"/>
<polygon fill="#000000" stroke="#000000" points="379.122,-1037.82 389.715,-1037.98 381.528,-1031.25 379.122,-1037.82"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~pnpa_mc~~CallsGraph_node17" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node17"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-440 225,-440 225,-416 313,-416 313,-440"/>
<text text-anchor="middle" x="269" y="-425.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge19" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M176.715,-458.189C190.797,-453.532 207.151,-448.123 222.094,-443.181"/>
<polygon fill="#000000" stroke="#000000" points="223.277,-446.477 231.672,-440.014 221.079,-439.831 223.277,-446.477"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~pnpa_mc~~CallsGraph_node21" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node21"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-390 380,-390 380,-366 468,-366 468,-390"/>
<text text-anchor="middle" x="424" y="-375.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge20" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M152.332,-457.976C166.931,-443.31 193.803,-418.994 222,-407 269.257,-386.899 327.807,-380.284 369.502,-378.315"/>
<polygon fill="#000000" stroke="#000000" points="369.868,-381.804 379.722,-377.91 369.591,-374.809 369.868,-381.804"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~pnpa_mc~~CallsGraph_node24" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node24"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-646 223.5,-646 223.5,-622 314.5,-622 314.5,-646"/>
<text text-anchor="middle" x="269" y="-631.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge21" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M145.033,-482.405C154.414,-509.507 180.141,-574.637 222,-613 223.29,-614.183 224.659,-615.308 226.085,-616.379"/>
<polygon fill="#000000" stroke="#000000" points="224.44,-619.481 234.75,-621.919 228.211,-613.584 224.44,-619.481"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~pnpa_mc~~CallsGraph_node25" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node25"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-604 223.5,-604 223.5,-580 314.5,-580 314.5,-604"/>
<text text-anchor="middle" x="269" y="-589.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge22" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M149.069,-482.115C162.472,-501.584 190.943,-540.252 222,-566 225.69,-569.059 229.79,-571.953 233.979,-574.621"/>
<polygon fill="#000000" stroke="#000000" points="232.218,-577.645 242.599,-579.761 235.803,-571.633 232.218,-577.645"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~pnpa_mc~~CallsGraph_node26" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node26"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-524 223.5,-524 223.5,-500 314.5,-500 314.5,-524"/>
<text text-anchor="middle" x="269" y="-509.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge23" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M176.715,-481.811C190.797,-486.468 207.151,-491.877 222.094,-496.819"/>
<polygon fill="#000000" stroke="#000000" points="221.079,-500.169 231.672,-499.986 223.277,-493.523 221.079,-500.169"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~pnpa_mc~~CallsGraph_node27" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node27"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="469.5,-564 378.5,-564 378.5,-540 469.5,-540 469.5,-564"/>
<text text-anchor="middle" x="424" y="-549.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge24" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M152.24,-482.248C166.743,-497.146 193.517,-521.701 222,-533 268.856,-551.587 326.5,-555.287 368.024,-554.96"/>
<polygon fill="#000000" stroke="#000000" points="368.275,-558.457 378.217,-554.797 368.163,-551.458 368.275,-558.457"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~pnpa_mc~~CallsGraph_node28" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node28"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-482 223.5,-482 223.5,-458 314.5,-458 314.5,-482"/>
<text text-anchor="middle" x="269" y="-467.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge25" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M176.715,-470C187.949,-470 200.628,-470 212.884,-470"/>
<polygon fill="#000000" stroke="#000000" points="213.037,-473.5 223.037,-470 213.037,-466.5 213.037,-473.5"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~pnpa_mc~~CallsGraph_node29" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node29"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-318 225,-318 225,-294 313,-294 313,-318"/>
<text text-anchor="middle" x="269" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge26" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M145.033,-457.595C154.414,-430.493 180.141,-365.363 222,-327 223.29,-325.817 224.659,-324.692 226.085,-323.621"/>
<polygon fill="#000000" stroke="#000000" points="228.211,-326.416 234.75,-318.081 224.44,-320.519 228.211,-326.416"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~pnpa_mc~~CallsGraph_node31" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node31"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-360 225,-360 225,-336 313,-336 313,-360"/>
<text text-anchor="middle" x="269" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge27" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M149.069,-457.885C162.472,-438.416 190.943,-399.748 222,-374 225.69,-370.941 229.79,-368.047 233.979,-365.379"/>
<polygon fill="#000000" stroke="#000000" points="235.803,-368.367 242.599,-360.239 232.218,-362.355 235.803,-368.367"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~pnpa_mc~~CallsGraph_node32" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node32"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-275 223.5,-275 223.5,-251 314.5,-251 314.5,-275"/>
<text text-anchor="middle" x="269" y="-260.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge28" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M143.221,-457.995C149.725,-425.929 171.544,-337.17 222,-285 223.385,-283.568 224.881,-282.218 226.46,-280.947"/>
<polygon fill="#000000" stroke="#000000" points="228.58,-283.738 234.89,-275.227 224.649,-277.945 228.58,-283.738"/>
</g>
<!-- proc~approx_eq -->
<g id="proc~~pnpa_mc~~CallsGraph_node14" class="node"><title>proc~approx_eq</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node14"><a xlink:href=".././proc/approx_eq.html" xlink:title="approx_eq">
<polygon fill="#d94e8f" stroke="#d94e8f" points="301,-129 237,-129 237,-105 301,-105 301,-129"/>
<text text-anchor="middle" x="269" y="-114.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_eq</text>
</a>
</g>
</g>
<!-- proc~npa_gyro_range&#45;&gt;proc~approx_eq -->
<g id="proc~~pnpa_mc~~CallsGraph_edge29" class="edge"><title>proc~npa_gyro_range&#45;&gt;proc~approx_eq</title>
<path fill="none" stroke="#000000" d="M169.767,-281.843C175.833,-278.154 181.693,-273.566 186,-268 222.687,-220.584 183.088,-183.608 222,-138 223.745,-135.955 225.731,-134.098 227.875,-132.415"/>
<polygon fill="#000000" stroke="#000000" points="230.209,-135.077 236.754,-126.745 226.442,-129.177 230.209,-135.077"/>
</g>
<!-- proc~gyro_range -->
<g id="proc~~pnpa_mc~~CallsGraph_node33" class="node"><title>proc~gyro_range</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node33"><a xlink:href=".././proc/gyro_range.html" xlink:title="gyro_range">
<polygon fill="#d9534f" stroke="#d9534f" points="302.5,-171 235.5,-171 235.5,-147 302.5,-147 302.5,-171"/>
<text text-anchor="middle" x="269" y="-156.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_range</text>
</a>
</g>
</g>
<!-- proc~npa_gyro_range&#45;&gt;proc~gyro_range -->
<g id="proc~~pnpa_mc~~CallsGraph_edge30" class="edge"><title>proc~npa_gyro_range&#45;&gt;proc~gyro_range</title>
<path fill="none" stroke="#000000" d="M166.024,-281.906C172.881,-277.982 180.056,-273.265 186,-268 215.603,-241.78 241.477,-203.387 255.891,-179.858"/>
<polygon fill="#000000" stroke="#000000" points="259.032,-181.426 261.175,-171.051 253.029,-177.825 259.032,-181.426"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~pnpa_mc~~CallsGraph_node20" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node20"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="610.5,-866 533.5,-866 533.5,-842 610.5,-842 610.5,-866"/>
<text text-anchor="middle" x="572" y="-851.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~bt_cx_rates&#45;&gt;interface~interpol_coeff -->
<g id="proc~~pnpa_mc~~CallsGraph_edge31" class="edge"><title>proc~bt_cx_rates&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M174.099,-810.221C237.241,-809.316 379.025,-810.086 496,-831 506.566,-832.889 517.735,-835.795 528.134,-838.912"/>
<polygon fill="#000000" stroke="#000000" points="527.234,-842.298 537.823,-841.94 529.322,-835.617 527.234,-842.298"/>
</g>
<!-- proc~line_plane_intersect -->
<g id="proc~~pnpa_mc~~CallsGraph_node18" class="node"><title>proc~line_plane_intersect</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node18"><a xlink:href=".././proc/line_plane_intersect.html" xlink:title="line_plane_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="478,-24 370,-24 370,-0 478,-0 478,-24"/>
<text text-anchor="middle" x="424" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">line_plane_intersect</text>
</a>
</g>
</g>
<!-- proc~hit_npa_detector&#45;&gt;proc~line_plane_intersect -->
<g id="proc~~pnpa_mc~~CallsGraph_edge32" class="edge"><title>proc~hit_npa_detector&#45;&gt;proc~line_plane_intersect</title>
<path fill="none" stroke="#000000" d="M313.844,-41.9645C331.129,-37.2195 351.153,-31.7228 369.294,-26.7427"/>
<polygon fill="#000000" stroke="#000000" points="370.433,-30.0597 379.15,-24.0373 368.58,-23.3094 370.433,-30.0597"/>
</g>
<!-- proc~in_boundary -->
<g id="proc~~pnpa_mc~~CallsGraph_node19" class="node"><title>proc~in_boundary</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node19"><a xlink:href=".././proc/in_boundary.html" xlink:title="in_boundary">
<polygon fill="#d94e8f" stroke="#d94e8f" points="460,-66 388,-66 388,-42 460,-42 460,-66"/>
<text text-anchor="middle" x="424" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_boundary</text>
</a>
</g>
</g>
<!-- proc~hit_npa_detector&#45;&gt;proc~in_boundary -->
<g id="proc~~pnpa_mc~~CallsGraph_edge33" class="edge"><title>proc~hit_npa_detector&#45;&gt;proc~in_boundary</title>
<path fill="none" stroke="#000000" d="M315.905,-54C335.453,-54 358.193,-54 377.677,-54"/>
<polygon fill="#000000" stroke="#000000" points="377.83,-57.5001 387.83,-54 377.83,-50.5001 377.83,-57.5001"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~pnpa_mc~~CallsGraph_edge37" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M298.029,-923.141C341.292,-910.853 426.598,-892.157 496,-911 553.673,-926.658 569.113,-937.382 612,-979 638.896,-1005.1 659.959,-1043.69 671.421,-1067.54"/>
<polygon fill="#000000" stroke="#000000" points="668.334,-1069.2 675.735,-1076.78 674.676,-1066.24 668.334,-1069.2"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~pnpa_mc~~CallsGraph_edge34" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M298.063,-932C321.9,-932 356.398,-932 383.106,-932"/>
<polygon fill="#000000" stroke="#000000" points="383.287,-935.5 393.287,-932 383.287,-928.5 383.287,-935.5"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~pnpa_mc~~CallsGraph_node22" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node22"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="474,-864 374,-864 374,-840 474,-840 474,-864"/>
<text text-anchor="middle" x="424" y="-849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~pnpa_mc~~CallsGraph_edge35" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M285.972,-919.869C302.025,-908.072 327.796,-890.194 352,-878 359.418,-874.263 367.506,-870.785 375.48,-867.666"/>
<polygon fill="#000000" stroke="#000000" points="376.971,-870.845 385.098,-864.047 374.506,-864.293 376.971,-870.845"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~pnpa_mc~~CallsGraph_edge36" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M298.017,-939.466C313.83,-943.606 333.976,-948.76 352,-953 412.929,-967.334 483.818,-982.224 528.054,-991.303"/>
<polygon fill="#000000" stroke="#000000" points="527.39,-994.74 537.889,-993.316 528.794,-987.882 527.39,-994.74"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~pnpa_mc~~CallsGraph_edge38" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M285.797,-944.184C312.596,-964.852 367.133,-1006.91 398.782,-1031.32"/>
<polygon fill="#000000" stroke="#000000" points="397.003,-1034.37 407.059,-1037.71 401.278,-1028.83 397.003,-1034.37"/>
</g>
<!-- proc~store_npa&#45;&gt;proc~get_fields -->
<g id="proc~~pnpa_mc~~CallsGraph_edge40" class="edge"><title>proc~store_npa&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M170.776,-932.766C188.344,-932.627 210.764,-932.451 229.646,-932.302"/>
<polygon fill="#000000" stroke="#000000" points="229.746,-935.801 239.718,-932.223 229.691,-928.802 229.746,-935.801"/>
</g>
<!-- proc~store_npa&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~pnpa_mc~~CallsGraph_edge39" class="edge"><title>proc~store_npa&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M150.886,-945.227C165.139,-962.228 192.952,-993.152 222,-1013 274.238,-1048.69 290.12,-1057.82 352,-1071 414.596,-1084.33 437.855,-1097.74 496,-1071 518.336,-1060.73 514.024,-1045.77 532,-1029 535.91,-1025.35 540.274,-1021.73 544.628,-1018.35"/>
<polygon fill="#000000" stroke="#000000" points="546.948,-1020.99 552.866,-1012.2 542.759,-1015.38 546.948,-1020.99"/>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~pnpa_mc~~CallsGraph_edge43" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M447.493,-919.983C472.07,-906.853 511.63,-885.718 539.338,-870.915"/>
<polygon fill="#000000" stroke="#000000" points="541.07,-873.958 548.241,-866.159 537.772,-867.784 541.07,-873.958"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~pnpa_mc~~CallsGraph_edge41" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M454.788,-941.719C467.654,-946.22 482.76,-951.916 496,-958 511.755,-965.24 528.658,-974.56 542.422,-982.58"/>
<polygon fill="#000000" stroke="#000000" points="541.006,-985.809 551.396,-987.883 544.568,-979.782 541.006,-985.809"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~pnpa_mc~~CallsGraph_node41" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node41"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="714.5,-1007 649.5,-1007 649.5,-983 714.5,-983 714.5,-1007"/>
<text text-anchor="middle" x="682" y="-992.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~pnpa_mc~~CallsGraph_edge42" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M454.617,-939.288C500.147,-950.493 587.499,-971.99 639.373,-984.756"/>
<polygon fill="#000000" stroke="#000000" points="638.705,-988.196 649.252,-987.187 640.378,-981.399 638.705,-988.196"/>
</g>
<!-- proc~linsolve -->
<g id="proc~~pnpa_mc~~CallsGraph_node37" class="node"><title>proc~linsolve</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node37"><a xlink:href=".././proc/linsolve.html" xlink:title="linsolve">
<polygon fill="#d9534f" stroke="#d9534f" points="451,-700 397,-700 397,-676 451,-676 451,-700"/>
<text text-anchor="middle" x="424" y="-685.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linsolve</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~linsolve -->
<g id="proc~~pnpa_mc~~CallsGraph_edge45" class="edge"><title>proc~colrad&#45;&gt;proc~linsolve</title>
<path fill="none" stroke="#000000" d="M291.073,-738.828C307.342,-729.773 330.614,-717.553 352,-709 363.262,-704.496 375.868,-700.459 387.297,-697.157"/>
<polygon fill="#000000" stroke="#000000" points="388.286,-700.515 396.974,-694.451 386.401,-693.773 388.286,-700.515"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~pnpa_mc~~CallsGraph_node38" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node38"><a xlink:href=".././proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-784 380,-784 380,-760 468,-760 468,-784"/>
<text text-anchor="middle" x="424" y="-769.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~pnpa_mc~~CallsGraph_edge46" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M296.302,-754.61C316.427,-757.372 344.85,-761.274 369.677,-764.681"/>
<polygon fill="#000000" stroke="#000000" points="369.32,-768.165 379.703,-766.057 370.272,-761.23 369.32,-768.165"/>
</g>
<!-- proc~eigen -->
<g id="proc~~pnpa_mc~~CallsGraph_node40" class="node"><title>proc~eigen</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node40"><a xlink:href=".././proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="451,-742 397,-742 397,-718 451,-718 451,-742"/>
<text text-anchor="middle" x="424" y="-727.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~pnpa_mc~~CallsGraph_edge44" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M296.302,-747.39C321.227,-743.969 358.881,-738.801 386.667,-734.987"/>
<polygon fill="#000000" stroke="#000000" points="387.355,-738.425 396.786,-733.598 386.403,-731.49 387.355,-738.425"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge47" class="edge"><title>proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M307.037,-415.896C327.915,-409.074 354.192,-400.486 376.452,-393.212"/>
<polygon fill="#000000" stroke="#000000" points="377.621,-396.512 386.039,-390.079 375.447,-389.858 377.621,-396.512"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_node39" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="611.5,-467 532.5,-467 532.5,-443 611.5,-443 611.5,-467"/>
<text text-anchor="middle" x="572" y="-452.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge48" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M313.126,-431.868C368.485,-436.834 464.288,-445.428 522.241,-450.626"/>
<polygon fill="#000000" stroke="#000000" points="521.981,-454.117 532.254,-451.524 522.606,-447.145 521.981,-454.117"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge49" class="edge"><title>proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M399.529,-390.014C390.984,-398.972 399.141,-408 424,-408 439.149,-408 448.095,-404.647 450.839,-400.001"/>
<polygon fill="#000000" stroke="#000000" points="454.184,-398.936 448.471,-390.014 447.373,-400.552 454.184,-398.936"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge50" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M447.812,-390.031C472.311,-402.952 511.426,-423.581 538.996,-438.121"/>
<polygon fill="#000000" stroke="#000000" points="537.388,-441.23 547.866,-442.799 540.653,-435.038 537.388,-441.23"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge52" class="edge"><title>proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M297.436,-621.963C303.594,-619.127 310.061,-616.041 316,-613 343.025,-599.163 372.988,-581.91 394.316,-569.287"/>
<polygon fill="#000000" stroke="#000000" points="396.375,-572.134 403.18,-564.013 392.796,-566.118 396.375,-572.134"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge51" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.834,-644.272C364.701,-652.895 444.944,-658.052 496,-617 539.394,-582.109 504.337,-545.324 532,-497 536.619,-488.931 543.062,-481.157 549.382,-474.538"/>
<polygon fill="#000000" stroke="#000000" points="551.993,-476.877 556.627,-467.349 547.063,-471.908 551.993,-476.877"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge54" class="edge"><title>proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M314.665,-580.323C331.402,-575.947 350.614,-570.924 368.167,-566.335"/>
<polygon fill="#000000" stroke="#000000" points="369.49,-569.607 378.279,-563.692 367.719,-562.835 369.49,-569.607"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge53" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M308.675,-604.032C357.064,-616.557 440.321,-629.481 496,-591 532.803,-565.565 508.348,-534.973 532,-497 536.991,-488.987 543.639,-481.144 550.031,-474.447"/>
<polygon fill="#000000" stroke="#000000" points="552.71,-476.717 557.302,-467.169 547.758,-471.77 552.71,-476.717"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge56" class="edge"><title>proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M314.665,-523.677C331.402,-528.053 350.614,-533.076 368.167,-537.665"/>
<polygon fill="#000000" stroke="#000000" points="367.719,-541.165 378.279,-540.308 369.49,-534.393 367.719,-541.165"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge55" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.881,-506.401C360.69,-500.324 433.707,-489.635 496,-476 504.637,-474.109 513.756,-471.814 522.546,-469.445"/>
<polygon fill="#000000" stroke="#000000" points="523.579,-472.791 532.287,-466.756 521.716,-466.043 523.579,-472.791"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge58" class="edge"><title>proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M399.529,-564.014C390.984,-572.972 399.141,-582 424,-582 439.149,-582 448.095,-578.647 450.839,-574.001"/>
<polygon fill="#000000" stroke="#000000" points="454.184,-572.936 448.471,-564.014 447.373,-574.552 454.184,-572.936"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge57" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M466.873,-539.871C476.791,-536.142 487.072,-531.529 496,-526 508.137,-518.483 534.197,-492.843 552.161,-474.537"/>
<polygon fill="#000000" stroke="#000000" points="554.825,-476.818 559.3,-467.214 549.813,-471.931 554.825,-476.818"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge60" class="edge"><title>proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M297.436,-482.037C303.594,-484.873 310.061,-487.959 316,-491 343.025,-504.837 372.988,-522.09 394.316,-534.713"/>
<polygon fill="#000000" stroke="#000000" points="392.796,-537.882 403.18,-539.987 396.375,-531.866 392.796,-537.882"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge59" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.738,-467.771C370.24,-465.005 464.546,-460.305 521.967,-457.444"/>
<polygon fill="#000000" stroke="#000000" points="522.428,-460.925 532.242,-456.931 522.08,-453.934 522.428,-460.925"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge61" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M313.253,-299.522C361.687,-294.585 440.633,-293.695 496,-329 533.851,-353.136 555.143,-403.808 564.729,-433.005"/>
<polygon fill="#000000" stroke="#000000" points="561.431,-434.189 567.74,-442.701 568.117,-432.113 561.431,-434.189"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~pnpa_mc~~CallsGraph_node43" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node43"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="603,-1062 541,-1062 541,-1038 603,-1038 603,-1062"/>
<text text-anchor="middle" x="572" y="-1047.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~pnpa_mc~~CallsGraph_edge62" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M459.231,-1050C480.622,-1050 508.271,-1050 530.716,-1050"/>
<polygon fill="#000000" stroke="#000000" points="530.944,-1053.5 540.944,-1050 530.944,-1046.5 530.944,-1053.5"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge63" class="edge"><title>proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M313.026,-356.437C330.626,-359.887 351.17,-363.916 369.707,-367.55"/>
<polygon fill="#000000" stroke="#000000" points="369.28,-371.033 379.767,-369.523 370.627,-364.164 369.28,-371.033"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge64" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M313.136,-339.356C360.762,-332.074 438.317,-327.066 496,-357 527.781,-373.493 550.031,-410.218 561.65,-433.73"/>
<polygon fill="#000000" stroke="#000000" points="558.543,-435.349 565.975,-442.9 564.874,-432.363 558.543,-435.349"/>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge65" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.542,-257.33C363.775,-253.524 443.096,-254.973 496,-294 542.1,-328.008 560.789,-397.447 567.572,-432.982"/>
<polygon fill="#000000" stroke="#000000" points="564.128,-433.605 569.313,-442.845 571.022,-432.388 564.128,-433.605"/>
</g>
<!-- proc~gyro_range&#45;&gt;proc~line_plane_intersect -->
<g id="proc~~pnpa_mc~~CallsGraph_edge69" class="edge"><title>proc~gyro_range&#45;&gt;proc~line_plane_intersect</title>
<path fill="none" stroke="#000000" d="M302.914,-148.046C307.761,-145.344 312.344,-142.033 316,-138 349.134,-101.45 316.379,-67.1309 352,-33 354.712,-30.4015 357.73,-28.1227 360.948,-26.1243"/>
<polygon fill="#000000" stroke="#000000" points="362.624,-29.1977 369.864,-21.4627 359.381,-22.9943 362.624,-29.1977"/>
</g>
<!-- proc~gyro_range&#45;&gt;proc~in_boundary -->
<g id="proc~~pnpa_mc~~CallsGraph_edge70" class="edge"><title>proc~gyro_range&#45;&gt;proc~in_boundary</title>
<path fill="none" stroke="#000000" d="M302.763,-147.166C307.517,-144.592 312.11,-141.552 316,-138 339.816,-116.256 326.715,-95.0164 352,-75 359.63,-68.9601 368.956,-64.656 378.308,-61.5892"/>
<polygon fill="#000000" stroke="#000000" points="379.34,-64.9344 387.993,-58.8204 377.416,-58.204 379.34,-64.9344"/>
</g>
<!-- proc~boundary_edge -->
<g id="proc~~pnpa_mc~~CallsGraph_node34" class="node"><title>proc~boundary_edge</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node34"><a xlink:href=".././proc/boundary_edge.html" xlink:title="boundary_edge">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-192 380,-192 380,-168 468,-168 468,-192"/>
<text text-anchor="middle" x="424" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boundary_edge</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~boundary_edge -->
<g id="proc~~pnpa_mc~~CallsGraph_edge66" class="edge"><title>proc~gyro_range&#45;&gt;proc~boundary_edge</title>
<path fill="none" stroke="#000000" d="M302.822,-163.505C322.315,-166.181 347.498,-169.637 369.772,-172.694"/>
<polygon fill="#000000" stroke="#000000" points="369.387,-176.174 379.77,-174.066 370.339,-169.239 369.387,-176.174"/>
</g>
<!-- proc~in_gyro_surface -->
<g id="proc~~pnpa_mc~~CallsGraph_node35" class="node"><title>proc~in_gyro_surface</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node35"><a xlink:href=".././proc/in_gyro_surface.html" xlink:title="in_gyro_surface">
<polygon fill="#d94e8f" stroke="#d94e8f" points="468.5,-150 379.5,-150 379.5,-126 468.5,-126 468.5,-150"/>
<text text-anchor="middle" x="424" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_gyro_surface</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~in_gyro_surface -->
<g id="proc~~pnpa_mc~~CallsGraph_edge67" class="edge"><title>proc~gyro_range&#45;&gt;proc~in_gyro_surface</title>
<path fill="none" stroke="#000000" d="M302.822,-154.495C322.239,-151.83 347.301,-148.39 369.51,-145.342"/>
<polygon fill="#000000" stroke="#000000" points="370.052,-148.8 379.483,-143.973 369.1,-141.865 370.052,-148.8"/>
</g>
<!-- proc~gyro_surface_coordinates -->
<g id="proc~~pnpa_mc~~CallsGraph_node36" class="node"><title>proc~gyro_surface_coordinates</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node36"><a xlink:href=".././proc/gyro_surface_coordinates.html" xlink:title="gyro_surface_coordinates">
<polygon fill="#d9534f" stroke="#d9534f" points="492,-108 356,-108 356,-84 492,-84 492,-108"/>
<text text-anchor="middle" x="424" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_surface_coordinates</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~gyro_surface_coordinates -->
<g id="proc~~pnpa_mc~~CallsGraph_edge68" class="edge"><title>proc~gyro_range&#45;&gt;proc~gyro_surface_coordinates</title>
<path fill="none" stroke="#000000" d="M297.946,-146.782C303.955,-144.005 310.232,-140.989 316,-138 332.446,-129.476 334.996,-124.347 352,-117 356.674,-114.981 361.601,-113.083 366.592,-111.319"/>
<polygon fill="#000000" stroke="#000000" points="367.847,-114.589 376.216,-108.092 365.622,-107.953 367.847,-114.589"/>
</g>
<!-- proc~line_gyro_surface_intersect -->
<g id="proc~~pnpa_mc~~CallsGraph_node42" class="node"><title>proc~line_gyro_surface_intersect</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node42"><a xlink:href=".././proc/line_gyro_surface_intersect.html" xlink:title="line_gyro_surface_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="496,-234 352,-234 352,-210 496,-210 496,-234"/>
<text text-anchor="middle" x="424" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">line_gyro_surface_intersect</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~line_gyro_surface_intersect -->
<g id="proc~~pnpa_mc~~CallsGraph_edge71" class="edge"><title>proc~gyro_range&#45;&gt;proc~line_gyro_surface_intersect</title>
<path fill="none" stroke="#000000" d="M291.073,-171.172C307.342,-180.227 330.614,-192.447 352,-201 357.072,-203.029 362.417,-204.963 367.805,-206.777"/>
<polygon fill="#000000" stroke="#000000" points="366.906,-210.165 377.498,-209.91 369.059,-203.504 366.906,-210.165"/>
</g>
<!-- dgetrf -->
<g id="proc~~pnpa_mc~~CallsGraph_node46" class="node"><title>dgetrf</title>
<polygon fill="#777777" stroke="#777777" points="599,-614 545,-614 545,-590 599,-590 599,-614"/>
<text text-anchor="middle" x="572" y="-599.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrf</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrf -->
<g id="proc~~pnpa_mc~~CallsGraph_edge72" class="edge"><title>proc~linsolve&#45;&gt;dgetrf</title>
<path fill="none" stroke="#000000" d="M451.024,-681.695C465.101,-677.517 482.349,-671.105 496,-662 515.625,-648.911 513.36,-637.457 532,-623 533.55,-621.798 535.177,-620.628 536.852,-619.494"/>
<polygon fill="#000000" stroke="#000000" points="538.816,-622.395 545.479,-614.157 535.133,-616.442 538.816,-622.395"/>
</g>
<!-- proc~matinv -->
<g id="proc~~pnpa_mc~~CallsGraph_node47" class="node"><title>proc~matinv</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node47"><a xlink:href=".././proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-530 545,-530 545,-506 599,-506 599,-530"/>
<text text-anchor="middle" x="572" y="-515.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~linsolve&#45;&gt;proc~matinv -->
<g id="proc~~pnpa_mc~~CallsGraph_edge73" class="edge"><title>proc~linsolve&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M451.194,-684.36C466.213,-680.97 484.34,-674.46 496,-662 534.92,-620.41 496.149,-583.262 532,-539 533.416,-537.252 535.017,-535.629 536.743,-534.126"/>
<polygon fill="#000000" stroke="#000000" points="538.819,-536.945 544.921,-528.283 534.749,-531.249 538.819,-536.945"/>
</g>
<!-- dgetrs -->
<g id="proc~~pnpa_mc~~CallsGraph_node48" class="node"><title>dgetrs</title>
<polygon fill="#777777" stroke="#777777" points="599,-572 545,-572 545,-548 599,-548 599,-572"/>
<text text-anchor="middle" x="572" y="-557.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrs</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrs -->
<g id="proc~~pnpa_mc~~CallsGraph_edge74" class="edge"><title>proc~linsolve&#45;&gt;dgetrs</title>
<path fill="none" stroke="#000000" d="M451.295,-683.606C465.977,-679.975 483.727,-673.475 496,-662 524.777,-635.095 505.218,-609.891 532,-581 533.372,-579.52 534.873,-578.122 536.462,-576.806"/>
<polygon fill="#000000" stroke="#000000" points="538.742,-579.483 544.949,-570.896 534.742,-573.738 538.742,-579.483"/>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~pnpa_mc~~CallsGraph_edge75" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M466.926,-784.045C476.841,-787.776 487.109,-792.411 496,-798 514.893,-809.876 514.003,-819.806 532,-833 533.628,-834.194 535.332,-835.363 537.08,-836.501"/>
<polygon fill="#000000" stroke="#000000" points="535.657,-839.73 546.028,-841.892 539.269,-833.734 535.657,-839.73"/>
</g>
<!-- proc~balance -->
<g id="proc~~pnpa_mc~~CallsGraph_node44" class="node"><title>proc~balance</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node44"><a xlink:href=".././proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-698 545,-698 545,-674 599,-674 599,-698"/>
<text text-anchor="middle" x="572" y="-683.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~pnpa_mc~~CallsGraph_edge77" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M451.319,-722.284C464.707,-718.341 481.23,-713.449 496,-709 508.862,-705.126 522.947,-700.823 535.402,-696.996"/>
<polygon fill="#000000" stroke="#000000" points="536.459,-700.333 544.987,-694.047 534.4,-693.643 536.459,-700.333"/>
</g>
<!-- proc~balback -->
<g id="proc~~pnpa_mc~~CallsGraph_node45" class="node"><title>proc~balback</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node45"><a xlink:href=".././proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-782 545,-782 545,-758 599,-758 599,-782"/>
<text text-anchor="middle" x="572" y="-767.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~pnpa_mc~~CallsGraph_edge76" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M451.102,-737.151C474.418,-743.539 508.802,-752.96 534.778,-760.076"/>
<polygon fill="#000000" stroke="#000000" points="534.062,-763.509 544.632,-762.776 535.912,-756.758 534.062,-763.509"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~pnpa_mc~~CallsGraph_node49" class="node"><title>proc~hqr2</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node49"><a xlink:href=".././proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-656 545,-656 545,-632 599,-632 599,-656"/>
<text text-anchor="middle" x="572" y="-641.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge78" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M451.234,-726.115C465.374,-723.105 482.616,-717.89 496,-709 517.047,-695.02 512.505,-681.074 532,-665 533.346,-663.89 534.76,-662.812 536.219,-661.769"/>
<polygon fill="#000000" stroke="#000000" points="538.381,-664.54 544.911,-656.197 534.604,-658.647 538.381,-664.54"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~pnpa_mc~~CallsGraph_node50" class="node"><title>proc~elmhes</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node50"><a xlink:href=".././proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-740 545,-740 545,-716 599,-716 599,-740"/>
<text text-anchor="middle" x="572" y="-725.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~pnpa_mc~~CallsGraph_edge79" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M451.102,-729.642C474.314,-729.324 508.498,-728.856 534.432,-728.501"/>
<polygon fill="#000000" stroke="#000000" points="534.681,-731.998 544.632,-728.361 534.585,-724.999 534.681,-731.998"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~pnpa_mc~~CallsGraph_node51" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node51"><a xlink:href=".././proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-824 545,-824 545,-800 599,-800 599,-824"/>
<text text-anchor="middle" x="572" y="-809.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~pnpa_mc~~CallsGraph_edge80" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M451.072,-734.135C465.164,-737.219 482.41,-742.427 496,-751 516.229,-763.761 513.193,-776.223 532,-791 533.542,-792.212 535.164,-793.39 536.834,-794.53"/>
<polygon fill="#000000" stroke="#000000" points="535.106,-797.577 545.446,-799.885 538.802,-791.632 535.106,-797.577"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~pnpa_mc~~CallsGraph_edge82" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M603.084,-1060.86C613.909,-1064.77 626.341,-1069.26 638.049,-1073.49"/>
<polygon fill="#000000" stroke="#000000" points="637.068,-1076.86 647.662,-1076.96 639.445,-1070.27 637.068,-1076.86"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~pnpa_mc~~CallsGraph_edge81" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M596.701,-1037.93C611.754,-1030.26 631.451,-1020.23 648.019,-1011.8"/>
<polygon fill="#000000" stroke="#000000" points="650.032,-1014.7 657.354,-1007.04 646.855,-1008.46 650.032,-1014.7"/>
</g>
<!-- proc~rswap -->
<g id="proc~~pnpa_mc~~CallsGraph_node54" class="node"><title>proc~rswap</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node54"><a xlink:href=".././proc/rswap.html" xlink:title="RSWAP">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-740 655,-740 655,-716 709,-716 709,-740"/>
<text text-anchor="middle" x="682" y="-725.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RSWAP</text>
</a>
</g>
</g>
<!-- proc~balance&#45;&gt;proc~rswap -->
<g id="proc~~pnpa_mc~~CallsGraph_edge83" class="edge"><title>proc~balance&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M599.144,-696.167C612.971,-701.544 630.153,-708.226 645.2,-714.078"/>
<polygon fill="#000000" stroke="#000000" points="644.134,-717.419 654.723,-717.781 646.671,-710.894 644.134,-717.419"/>
</g>
<!-- proc~balback&#45;&gt;proc~rswap -->
<g id="proc~~pnpa_mc~~CallsGraph_edge84" class="edge"><title>proc~balback&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M599.144,-759.833C612.971,-754.456 630.153,-747.774 645.2,-741.922"/>
<polygon fill="#000000" stroke="#000000" points="646.671,-745.106 654.723,-738.219 644.134,-738.581 646.671,-745.106"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~pnpa_mc~~CallsGraph_node52" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node52"><a xlink:href=".././proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-551 655,-551 655,-527 709,-527 709,-551"/>
<text text-anchor="middle" x="682" y="-536.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~pnpa_mc~~CallsGraph_edge85" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M599.144,-523.084C612.839,-525.746 629.826,-529.049 644.769,-531.955"/>
<polygon fill="#000000" stroke="#000000" points="644.238,-535.417 654.723,-533.891 645.575,-528.546 644.238,-535.417"/>
</g>
<!-- proc~lubksb -->
<g id="proc~~pnpa_mc~~CallsGraph_node53" class="node"><title>proc~lubksb</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node53"><a xlink:href=".././proc/lubksb.html" xlink:title="lubksb">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-509 655,-509 655,-485 709,-485 709,-509"/>
<text text-anchor="middle" x="682" y="-494.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lubksb</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~lubksb -->
<g id="proc~~pnpa_mc~~CallsGraph_edge86" class="edge"><title>proc~matinv&#45;&gt;proc~lubksb</title>
<path fill="none" stroke="#000000" d="M599.144,-512.916C612.839,-510.254 629.826,-506.951 644.769,-504.045"/>
<polygon fill="#000000" stroke="#000000" points="645.575,-507.454 654.723,-502.109 644.238,-500.583 645.575,-507.454"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~pnpa_mc~~CallsGraph_node55" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node55"><a xlink:href=".././proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-656 655,-656 655,-632 709,-632 709,-656"/>
<text text-anchor="middle" x="682" y="-641.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~pnpa_mc~~CallsGraph_edge87" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M599.144,-644C612.707,-644 629.499,-644 644.338,-644"/>
<polygon fill="#000000" stroke="#000000" points="644.723,-647.5 654.723,-644 644.723,-640.5 644.723,-647.5"/>
</g>
<!-- proc~elmhes&#45;&gt;proc~rswap -->
<g id="proc~~pnpa_mc~~CallsGraph_edge88" class="edge"><title>proc~elmhes&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M599.144,-728C612.707,-728 629.499,-728 644.338,-728"/>
<polygon fill="#000000" stroke="#000000" points="644.723,-731.5 654.723,-728 644.723,-724.5 644.723,-731.5"/>
</g>
<!-- proc~swap -->
<g id="proc~~pnpa_mc~~CallsGraph_node56" class="node"><title>proc~swap</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node56"><a xlink:href=".././proc/swap.html" xlink:title="swap">
<polygon fill="#d9534f" stroke="#d9534f" points="809,-572 755,-572 755,-548 809,-548 809,-572"/>
<text text-anchor="middle" x="782" y="-557.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swap</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~swap -->
<g id="proc~~pnpa_mc~~CallsGraph_edge89" class="edge"><title>proc~ludcmp&#45;&gt;proc~swap</title>
<path fill="none" stroke="#000000" d="M709.005,-544.572C719.969,-546.922 732.92,-549.697 744.794,-552.242"/>
<polygon fill="#000000" stroke="#000000" points="744.362,-555.728 754.874,-554.401 745.829,-548.884 744.362,-555.728"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~pnpa_mc~~CallsGraph_node57" class="node"><title>proc~outerprod</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node57"><a xlink:href=".././proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="811.5,-530 752.5,-530 752.5,-506 811.5,-506 811.5,-530"/>
<text text-anchor="middle" x="782" y="-515.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~pnpa_mc~~CallsGraph_edge90" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M709.005,-533.428C719.251,-531.232 731.231,-528.665 742.446,-526.261"/>
<polygon fill="#000000" stroke="#000000" points="743.414,-529.634 752.459,-524.116 741.947,-522.789 743.414,-529.634"/>
</g>
<!-- proc~comdiv -->
<g id="proc~~pnpa_mc~~CallsGraph_node58" class="node"><title>proc~comdiv</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node58"><a xlink:href=".././proc/comdiv.html" xlink:title="Comdiv">
<polygon fill="#d9534f" stroke="#d9534f" points="809,-656 755,-656 755,-632 809,-632 809,-656"/>
<text text-anchor="middle" x="782" y="-641.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Comdiv</text>
</a>
</g>
</g>
<!-- proc~hqrvec&#45;&gt;proc~comdiv -->
<g id="proc~~pnpa_mc~~CallsGraph_edge91" class="edge"><title>proc~hqrvec&#45;&gt;proc~comdiv</title>
<path fill="none" stroke="#000000" d="M709.005,-644C719.969,-644 732.92,-644 744.794,-644"/>
<polygon fill="#000000" stroke="#000000" points="744.874,-647.5 754.874,-644 744.874,-640.5 744.874,-647.5"/>
</g>
</g>
</svg>
</div><script>var panprocpnpa_mcCallsGraph = svgPanZoom('#procpnpa_mcCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~pnpa_mc~~CalledByGraph Pages: 1 -->
<svg id="procpnpa_mcCalledByGraph" width="156pt" height="32pt"
 viewBox="0.00 0.00 156.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pnpa_mc~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~pnpa_mc~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 152,-28 152,4 -4,4"/>
<!-- proc~pnpa_mc -->
<g id="proc~~pnpa_mc~~CalledByGraph_node1" class="node"><title>proc~pnpa_mc</title>
<polygon fill="none" stroke="black" points="147.5,-24 90.5,-24 90.5,-0 147.5,-0 147.5,-24"/>
<text text-anchor="middle" x="119" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">pnpa_mc</text>
</g>
<!-- program~fidasim -->
<g id="proc~~pnpa_mc~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~pnpa_mc~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~pnpa_mc -->
<g id="proc~~pnpa_mc~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~pnpa_mc</title>
<path fill="none" stroke="#000000" d="M54.0317,-12C62.2408,-12 71.4806,-12 80.3316,-12"/>
<polygon fill="#000000" stroke="#000000" points="80.4582,-15.5001 90.4582,-12 80.4582,-8.5001 80.4582,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pnpa_mc.html#src">pnpa_mc</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">pnpa_mc</span><span class="w"></span>
<span class="w">    </span><span class="c">!+ Calculate Passive NPA flux using a Monte Carlo fast-ion distribution</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iion</span><span class="p">,</span><span class="n">igamma</span><span class="p">,</span><span class="n">ngamma</span><span class="p">,</span><span class="n">npart</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">FastIon</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fast_ion</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">phi</span><span class="p">,</span><span class="n">theta</span><span class="p">,</span><span class="n">dtheta</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">rf</span><span class="p">,</span><span class="w"> </span><span class="n">rg</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">det</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">ichan</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">nrange</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="k">is</span>
<span class="k">    type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fields</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">plasma</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">GyroSurface</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">gs</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rates</span><span class="p">,</span><span class="w"> </span><span class="n">rates_is</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">states</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">flux</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ind</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">uvw</span><span class="p">,</span><span class="w"> </span><span class="n">uvw_vi</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">gyrange</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="n">c</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">randomu</span><span class="w"></span>

<span class="w">    </span><span class="n">ngamma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">.</span><span class="nb">or</span><span class="p">.(</span><span class="n">inputs</span><span class="p">%</span><span class="n">dist_type</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">ngamma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ceiling</span><span class="p">(</span><span class="nb">dble</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_pnpa</span><span class="p">)</span><span class="o">/</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">    if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i10)&#39;</span><span class="p">)</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="o">*</span><span class="n">ngamma</span><span class="p">,</span><span class="n">Int64</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span><span class="w"></span>

<span class="w">    </span><span class="c">!$OMP PARALLEL DO schedule(guided) private(iion,igamma,ind,fast_ion,vi,ri,rf,phi,s,c,ir,it,plasma, &amp;</span>
<span class="w">    </span><span class="c">!$OMP&amp; randomu,rg,fields,uvw,uvw_vi,rates,rates_is,is,states,flux,det,ichan,gs,nrange,gyrange,theta,dtheta)</span>
<span class="w">    </span><span class="n">loop_over_fast_ions</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">iion</span><span class="o">=</span><span class="n">istart</span><span class="p">,</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="p">,</span><span class="n">istep</span><span class="w"></span>
<span class="w">        </span><span class="n">fast_ion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">particles</span><span class="p">%</span><span class="n">fast_ion</span><span class="p">(</span><span class="n">iion</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vabs</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">loop_over_fast_ions</span><span class="w"></span>
<span class="w">        </span><span class="n">gamma_loop</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">igamma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ngamma</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">                </span><span class="c">!! Pick random toroidal angle</span>
<span class="w">                </span><span class="k">call </span><span class="n">randu</span><span class="p">(</span><span class="n">randomu</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="n">phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pass_grid</span><span class="p">%</span><span class="n">phi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">nphi</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dphi</span><span class="o">*</span><span class="n">randomu</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">else</span>
<span class="k">                </span><span class="n">phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">phi</span><span class="w"></span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">            </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="c">!! Calculate position in machine coordinates</span>
<span class="w">            </span><span class="n">uvw</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">c</span><span class="w"></span>
<span class="w">            </span><span class="n">uvw</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">s</span><span class="w"></span>
<span class="w">            </span><span class="n">uvw</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">z</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">dist_type</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">                </span><span class="c">!! Get electomagnetic fields</span>
<span class="w">                </span><span class="k">call </span><span class="n">get_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="o">=</span><span class="n">uvw</span><span class="p">,</span><span class="w"> </span><span class="n">input_coords</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Correct for gyro motion and get position and velocity</span>
<span class="w">                </span><span class="k">call </span><span class="n">gyro_surface</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">energy</span><span class="p">,</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">pitch</span><span class="p">,</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">gs</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="n">detector_loop</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">ichan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">npa_chords</span><span class="p">%</span><span class="n">nchan</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">npa_gyro_range</span><span class="p">(</span><span class="n">ichan</span><span class="p">,</span><span class="w"> </span><span class="n">gs</span><span class="p">,</span><span class="w"> </span><span class="n">gyrange</span><span class="p">,</span><span class="w"> </span><span class="n">nrange</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="n">nrange</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">detector_loop</span><span class="w"></span>

<span class="w">                    </span><span class="n">gyro_range_loop</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">ir</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nrange</span><span class="w"></span>
<span class="w">                        </span><span class="n">dtheta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gyrange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="n">theta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gyrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="n">dtheta</span><span class="w"></span>
<span class="w">                        </span><span class="k">call </span><span class="n">gyro_trajectory</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span><span class="w"> </span><span class="n">theta</span><span class="p">,</span><span class="w"> </span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="p">)</span><span class="w"></span>

<span class="w">                        </span><span class="c">!! Check if particle hits a NPA detector</span>
<span class="w">                        </span><span class="k">call </span><span class="n">hit_npa_detector</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="w"> </span><span class="p">,</span><span class="n">det</span><span class="p">,</span><span class="w"> </span><span class="n">rf</span><span class="p">,</span><span class="w"> </span><span class="n">det</span><span class="o">=</span><span class="n">ichan</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">if</span><span class="p">(</span><span class="n">det</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">ichan</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                            if</span><span class="w"> </span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="k">                                write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;PNPA_MC: Missed Detector &quot;</span><span class="p">,</span><span class="n">ichan</span><span class="w"></span>
<span class="w">                            </span><span class="k">endif</span>
<span class="k">                            cycle </span><span class="n">gyro_range_loop</span><span class="w"></span>
<span class="w">                        </span><span class="k">endif</span><span class="w"></span>

<span class="w">                        </span><span class="c">!! Calculate CX probability with beam and halo neutrals</span>
<span class="w">                        </span><span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="n">rates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.d0</span><span class="w"></span>
<span class="w">                        </span><span class="k">do is</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n_thermal</span><span class="w"></span>
<span class="w">                            </span><span class="k">call </span><span class="n">bt_cx_rates</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="w"> </span><span class="n">plasma</span><span class="p">%</span><span class="n">denn</span><span class="p">(:,</span><span class="k">is</span><span class="p">),</span><span class="w"> </span><span class="n">thermal_mass</span><span class="p">(</span><span class="k">is</span><span class="p">),</span><span class="w"> </span><span class="n">vi</span><span class="p">,</span><span class="w"> </span><span class="n">rates_is</span><span class="p">)</span><span class="w"></span>
<span class="w">                            </span><span class="n">rates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rates</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rates_is</span><span class="w"></span>
<span class="w">                        </span><span class="k">enddo</span>
<span class="k">                        if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">gyro_range_loop</span><span class="w"></span>

<span class="w">                        </span><span class="c">!! Weight CX rates by ion source density</span>
<span class="w">                        </span><span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                            </span><span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">weight</span><span class="o">*</span><span class="p">(</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">nphi</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dphi</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                                   </span><span class="o">/</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dv</span><span class="p">)</span><span class="o">/</span><span class="n">ngamma</span><span class="w"></span>
<span class="w">                        </span><span class="k">else</span>
<span class="k">                            </span><span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">weight</span><span class="o">/</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dv</span><span class="p">)</span><span class="o">/</span><span class="n">ngamma</span><span class="w"></span>
<span class="w">                        </span><span class="k">endif</span><span class="w"></span>

<span class="w">                        </span><span class="c">!! Attenuate states as the particle move through plasma</span>
<span class="w">                        </span><span class="k">call </span><span class="n">attenuate</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">states</span><span class="p">)</span><span class="w"></span>

<span class="w">                        </span><span class="c">!! Store NPA Flux</span>
<span class="w">                        </span><span class="n">flux</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dtheta</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dv</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="n">spread_loop</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">it</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">25</span><span class="w"></span>
<span class="w">                            </span><span class="n">theta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gyrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">it</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">dtheta</span><span class="o">/</span><span class="mi">25</span><span class="w"></span>
<span class="w">                            </span><span class="k">call </span><span class="n">gyro_trajectory</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span><span class="w"> </span><span class="n">theta</span><span class="p">,</span><span class="w"> </span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="p">)</span><span class="w"></span>
<span class="w">                            </span><span class="k">call </span><span class="n">hit_npa_detector</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="w"> </span><span class="p">,</span><span class="n">det</span><span class="p">,</span><span class="w"> </span><span class="n">rf</span><span class="p">,</span><span class="w"> </span><span class="n">det</span><span class="o">=</span><span class="n">ichan</span><span class="p">)</span><span class="w"></span>
<span class="w">                            </span><span class="k">if</span><span class="p">(</span><span class="n">det</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">ichan</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                if</span><span class="w"> </span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="k">                                    write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;PNPA_MC: Missed Detector &quot;</span><span class="p">,</span><span class="n">ichan</span><span class="w"></span>
<span class="w">                                </span><span class="k">endif</span>
<span class="k">                                cycle </span><span class="n">spread_loop</span><span class="w"></span>
<span class="w">                            </span><span class="k">endif</span>
<span class="k">                            call </span><span class="n">store_npa</span><span class="p">(</span><span class="n">det</span><span class="p">,</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">flux</span><span class="o">/</span><span class="mi">25</span><span class="p">,</span><span class="n">fast_ion</span><span class="p">%</span><span class="k">class</span><span class="p">,</span><span class="w"> </span><span class="n">passive</span><span class="o">=</span><span class="p">.</span><span class="n">True</span><span class="p">.)</span><span class="w"></span>
<span class="w">                        </span><span class="k">enddo </span><span class="n">spread_loop</span><span class="w"></span>
<span class="w">                    </span><span class="k">enddo </span><span class="n">gyro_range_loop</span><span class="w"></span>
<span class="w">                </span><span class="k">enddo </span><span class="n">detector_loop</span><span class="w"></span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="c">!! Full Orbit</span>
<span class="w">                </span><span class="c">!! Convert to beam grid coordinates</span>
<span class="w">                </span><span class="k">call </span><span class="n">uvw_to_xyz</span><span class="p">(</span><span class="n">uvw</span><span class="p">,</span><span class="w"> </span><span class="n">ri</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Calculate velocity vector</span>
<span class="w">                </span><span class="n">uvw_vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vt</span><span class="w"></span>
<span class="w">                </span><span class="n">uvw_vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vt</span><span class="w"></span>
<span class="w">                </span><span class="n">uvw_vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vz</span><span class="w"></span>
<span class="w">                </span><span class="n">vi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">matmul</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">inv_basis</span><span class="p">,</span><span class="n">uvw_vi</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Check if particle hits a NPA detector</span>
<span class="w">                </span><span class="k">call </span><span class="n">hit_npa_detector</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="w"> </span><span class="n">vi</span><span class="w"> </span><span class="p">,</span><span class="n">det</span><span class="p">,</span><span class="w"> </span><span class="n">rf</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="n">det</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">gamma_loop</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Calculate CX probability with edge neutrals</span>
<span class="w">                </span><span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="n">rates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.d0</span><span class="w"></span>
<span class="w">                </span><span class="k">do is</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n_thermal</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">bt_cx_rates</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="w"> </span><span class="n">plasma</span><span class="p">%</span><span class="n">denn</span><span class="p">(:,</span><span class="k">is</span><span class="p">),</span><span class="w"> </span><span class="n">thermal_mass</span><span class="p">(</span><span class="k">is</span><span class="p">),</span><span class="w"> </span><span class="n">vi</span><span class="p">,</span><span class="w"> </span><span class="n">rates_is</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="n">rates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rates</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rates_is</span><span class="w"></span>
<span class="w">                </span><span class="k">enddo</span>
<span class="k">                if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">gamma_loop</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Weight CX rates by ion source density</span>
<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">weight</span><span class="o">*</span><span class="p">(</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">nphi</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dphi</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                           </span><span class="o">/</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dv</span><span class="p">)</span><span class="o">/</span><span class="n">ngamma</span><span class="w"></span>
<span class="w">                </span><span class="k">else</span>
<span class="k">                    </span><span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">weight</span><span class="o">/</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dv</span><span class="p">)</span><span class="o">/</span><span class="n">ngamma</span><span class="w"></span>
<span class="w">                </span><span class="k">endif</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Attenuate states as the particle moves though plasma</span>
<span class="w">                </span><span class="k">call </span><span class="n">attenuate</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">states</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="c">!! Store NPA Flux</span>
<span class="w">                </span><span class="n">flux</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dv</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">call </span><span class="n">store_npa</span><span class="p">(</span><span class="n">det</span><span class="p">,</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">flux</span><span class="p">,</span><span class="n">fast_ion</span><span class="p">%</span><span class="k">class</span><span class="p">,</span><span class="n">passive</span><span class="o">=</span><span class="p">.</span><span class="n">True</span><span class="p">.)</span><span class="w"></span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">        enddo </span><span class="n">gamma_loop</span><span class="w"></span>
<span class="w">    </span><span class="k">enddo </span><span class="n">loop_over_fast_ions</span><span class="w"></span>
<span class="w">    </span><span class="c">!$OMP END PARALLEL DO</span>

<span class="w">    </span><span class="n">npart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pnpa</span><span class="p">%</span><span class="n">npart</span><span class="w"></span>
<span class="cp">#ifdef _MPI</span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">npart</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">pnpa</span><span class="p">%</span><span class="n">flux</span><span class="p">)</span><span class="w"></span>
<span class="cp">#endif</span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T4,&quot;Number of Passive NPA particles that hit a detector: &quot;,i8)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">npart</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">end subroutine </span><span class="n">pnpa_mc</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>