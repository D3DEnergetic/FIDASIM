<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>pnpa_mc &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
               
        
        
            </ul>
        
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>



          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>pnpa_mc
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.8% of total for procedures.">117 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
    
     <li><a href='../module/libfida.html'>libfida</a></li>
    
  
     <li class="active">pnpa_mc</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pnpa_mc.html#src">pnpa_mc</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine pnpa_mc()
    
    
   
</h2>
    
  


    
    <p>Calculate Passive NPA flux using a Monte Carlo fast-ion distribution</p>
    

    <h3>Arguments</h3>
    
    <em>None</em>
    <br>
    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~pnpa_mc~~CallsGraph Pages: 1 -->
<svg id="procpnpa_mcCallsGraph" width="641pt" height="1094pt"
 viewBox="0.00 0.00 641.00 1094.39" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pnpa_mc~~CallsGraph" class="graph" transform="scale(0.781707 0.781707) rotate(0) translate(4 1396)">
<title>proc~~pnpa_mc~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1396 816,-1396 816,4 -4,4"/>
<!-- proc~pnpa_mc -->
<g id="proc~~pnpa_mc~~CallsGraph_node1" class="node"><title>proc~pnpa_mc</title>
<polygon fill="none" stroke="black" points="57.5,-612 0.5,-612 0.5,-588 57.5,-588 57.5,-612"/>
<text text-anchor="middle" x="29" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50">pnpa_mc</text>
</g>
<!-- proc~hit_npa_detector -->
<g id="proc~~pnpa_mc~~CallsGraph_node2" class="node"><title>proc~hit_npa_detector</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node2"><a xlink:href=".././proc/hit_npa_detector.html" xlink:title="hit_npa_detector">
<polygon fill="#d9534f" stroke="#d9534f" points="315.5,-1350 222.5,-1350 222.5,-1326 315.5,-1326 315.5,-1350"/>
<text text-anchor="middle" x="269" y="-1335.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hit_npa_detector</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~hit_npa_detector -->
<g id="proc~~pnpa_mc~~CallsGraph_edge1" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~hit_npa_detector</title>
<path fill="none" stroke="#000000" d="M30.0074,-612.116C30.2401,-687.926 34.2803,-1097.25 94,-1204 125.345,-1260.03 190.734,-1300.33 231.821,-1321.34"/>
<polygon fill="#000000" stroke="#000000" points="230.442,-1324.57 240.953,-1325.9 233.569,-1318.31 230.442,-1324.57"/>
</g>
<!-- proc~store_npa -->
<g id="proc~~pnpa_mc~~CallsGraph_node3" class="node"><title>proc~store_npa</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node3"><a xlink:href=".././proc/store_npa.html" xlink:title="store_npa">
<polygon fill="#d9534f" stroke="#d9534f" points="170.5,-591 109.5,-591 109.5,-567 170.5,-567 170.5,-591"/>
<text text-anchor="middle" x="140" y="-576.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_npa</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~store_npa -->
<g id="proc~~pnpa_mc~~CallsGraph_edge2" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M57.5053,-594.701C70.0694,-592.28 85.1943,-589.366 98.985,-586.709"/>
<polygon fill="#000000" stroke="#000000" points="100.049,-590.069 109.206,-584.74 98.7247,-583.195 100.049,-590.069"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="proc~~pnpa_mc~~CallsGraph_node4" class="node"><title>proc~uvw_to_xyz</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node4"><a xlink:href=".././proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="716,-577 648,-577 648,-553 716,-553 716,-577"/>
<text text-anchor="middle" x="682" y="-562.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~pnpa_mc~~CallsGraph_edge3" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M35.3699,-612.258C44.4161,-631.272 64.6287,-667.407 94,-684 161.732,-722.264 190.207,-703 268,-703 268,-703 268,-703 425,-703 523.93,-703 621.389,-622.159 661.674,-584.225"/>
<polygon fill="#000000" stroke="#000000" points="664.156,-586.694 668.952,-577.247 659.312,-581.641 664.156,-586.694"/>
</g>
<!-- proc~npa_gyro_range -->
<g id="proc~~pnpa_mc~~CallsGraph_node5" class="node"><title>proc~npa_gyro_range</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node5"><a xlink:href=".././proc/npa_gyro_range.html" xlink:title="npa_gyro_range">
<polygon fill="#d9534f" stroke="#d9534f" points="185.5,-1195 94.5,-1195 94.5,-1171 185.5,-1171 185.5,-1195"/>
<text text-anchor="middle" x="140" y="-1180.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_gyro_range</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~npa_gyro_range -->
<g id="proc~~pnpa_mc~~CallsGraph_edge4" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~npa_gyro_range</title>
<path fill="none" stroke="#000000" d="M32.2766,-612.177C45.9217,-685.159 116.878,-1064.68 134.856,-1160.84"/>
<polygon fill="#000000" stroke="#000000" points="131.458,-1161.7 136.736,-1170.89 138.338,-1160.42 131.458,-1161.7"/>
</g>
<!-- interface~randu -->
<g id="proc~~pnpa_mc~~CallsGraph_node6" class="node"><title>interface~randu</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node6"><a xlink:href=".././interface/randu.html" xlink:title="randu">
<polygon fill="#a7506f" stroke="#a7506f" points="167,-675 113,-675 113,-651 167,-651 167,-675"/>
<text text-anchor="middle" x="140" y="-660.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;interface~randu -->
<g id="proc~~pnpa_mc~~CallsGraph_edge5" class="edge"><title>proc~pnpa_mc&#45;&gt;interface~randu</title>
<path fill="none" stroke="#000000" d="M46.9654,-612.1C59.629,-620.892 77.5177,-632.809 94,-642 97.106,-643.732 100.379,-645.451 103.686,-647.117"/>
<polygon fill="#000000" stroke="#000000" points="102.455,-650.41 112.979,-651.634 105.515,-644.114 102.455,-650.41"/>
</g>
<!-- proc~gyro_trajectory -->
<g id="proc~~pnpa_mc~~CallsGraph_node7" class="node"><title>proc~gyro_trajectory</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node7"><a xlink:href=".././proc/gyro_trajectory.html" xlink:title="gyro_trajectory">
<polygon fill="#d9534f" stroke="#d9534f" points="182,-633 98,-633 98,-609 182,-609 182,-633"/>
<text text-anchor="middle" x="140" y="-618.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_trajectory</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~gyro_trajectory -->
<g id="proc~~pnpa_mc~~CallsGraph_edge6" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~gyro_trajectory</title>
<path fill="none" stroke="#000000" d="M57.5053,-605.299C66.7772,-607.086 77.4435,-609.14 87.9392,-611.163"/>
<polygon fill="#000000" stroke="#000000" points="87.417,-614.626 97.8986,-613.081 88.7413,-607.753 87.417,-614.626"/>
</g>
<!-- interface~parallel_sum -->
<g id="proc~~pnpa_mc~~CallsGraph_node8" class="node"><title>interface~parallel_sum</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node8"><a xlink:href=".././interface/parallel_sum.html" xlink:title="parallel_sum">
<polygon fill="#a7506f" stroke="#a7506f" points="176.5,-921 103.5,-921 103.5,-897 176.5,-897 176.5,-921"/>
<text text-anchor="middle" x="140" y="-906.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;interface~parallel_sum -->
<g id="proc~~pnpa_mc~~CallsGraph_edge7" class="edge"><title>proc~pnpa_mc&#45;&gt;interface~parallel_sum</title>
<path fill="none" stroke="#000000" d="M34.2729,-612.113C50.722,-658.744 110.091,-827.046 131.356,-887.33"/>
<polygon fill="#000000" stroke="#000000" points="128.129,-888.704 134.757,-896.971 134.731,-886.376 128.129,-888.704"/>
</g>
<!-- proc~gyro_surface -->
<g id="proc~~pnpa_mc~~CallsGraph_node9" class="node"><title>proc~gyro_surface</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node9"><a xlink:href=".././proc/gyro_surface.html" xlink:title="gyro_surface">
<polygon fill="#d9534f" stroke="#d9534f" points="177.5,-549 102.5,-549 102.5,-525 177.5,-525 177.5,-549"/>
<text text-anchor="middle" x="140" y="-534.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_surface</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~gyro_surface -->
<g id="proc~~pnpa_mc~~CallsGraph_edge8" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~gyro_surface</title>
<path fill="none" stroke="#000000" d="M46.9654,-587.9C59.629,-579.108 77.5177,-567.191 94,-558 96.6989,-556.495 99.5243,-555 102.388,-553.541"/>
<polygon fill="#000000" stroke="#000000" points="104.122,-556.589 111.555,-549.039 101.036,-550.305 104.122,-556.589"/>
</g>
<!-- proc~bt_cx_rates -->
<g id="proc~~pnpa_mc~~CallsGraph_node10" class="node"><title>proc~bt_cx_rates</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node10"><a xlink:href=".././proc/bt_cx_rates.html" xlink:title="bt_cx_rates">
<polygon fill="#d9534f" stroke="#d9534f" points="174,-375 106,-375 106,-351 174,-351 174,-375"/>
<text text-anchor="middle" x="140" y="-360.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bt_cx_rates</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~bt_cx_rates -->
<g id="proc~~pnpa_mc~~CallsGraph_edge9" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~bt_cx_rates</title>
<path fill="none" stroke="#000000" d="M31.2944,-587.981C35.3522,-554.899 50.2726,-460.793 94,-398 98.3551,-391.746 104.161,-386.088 110.152,-381.233"/>
<polygon fill="#000000" stroke="#000000" points="112.403,-383.92 118.316,-375.129 108.211,-378.314 112.403,-383.92"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~pnpa_mc~~CallsGraph_node11" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node11"><a xlink:href=".././proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-455 235,-455 235,-431 303,-431 303,-455"/>
<text text-anchor="middle" x="269" y="-440.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~get_plasma -->
<g id="proc~~pnpa_mc~~CallsGraph_edge10" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M34.7107,-587.745C43.328,-566.913 63.5881,-524.57 94,-501 132.419,-471.224 186.887,-456.336 224.605,-449.168"/>
<polygon fill="#000000" stroke="#000000" points="225.546,-452.555 234.772,-447.345 224.311,-445.665 225.546,-452.555"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~pnpa_mc~~CallsGraph_node12" class="node"><title>proc~get_fields</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node12"><a xlink:href=".././proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="298,-557 240,-557 240,-533 298,-533 298,-557"/>
<text text-anchor="middle" x="269" y="-542.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~get_fields -->
<g id="proc~~pnpa_mc~~CallsGraph_edge11" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M34.8842,-587.988C43.5032,-568.62 63.4416,-531.135 94,-516 139.85,-493.292 199.963,-512.575 236.195,-528.712"/>
<polygon fill="#000000" stroke="#000000" points="234.764,-531.906 245.309,-532.93 237.704,-525.554 234.764,-531.906"/>
</g>
<!-- proc~attenuate -->
<g id="proc~~pnpa_mc~~CallsGraph_node13" class="node"><title>proc~attenuate</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node13"><a xlink:href=".././proc/attenuate.html" xlink:title="attenuate">
<polygon fill="#d9534f" stroke="#d9534f" points="169,-431 111,-431 111,-407 169,-407 169,-431"/>
<text text-anchor="middle" x="140" y="-416.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">attenuate</text>
</a>
</g>
</g>
<!-- proc~pnpa_mc&#45;&gt;proc~attenuate -->
<g id="proc~~pnpa_mc~~CallsGraph_edge12" class="edge"><title>proc~pnpa_mc&#45;&gt;proc~attenuate</title>
<path fill="none" stroke="#000000" d="M32.2546,-587.707C37.9806,-559.469 55.4481,-489.024 94,-445 96.6006,-442.03 99.6266,-439.316 102.857,-436.857"/>
<polygon fill="#000000" stroke="#000000" points="104.828,-439.749 111.18,-431.27 100.927,-433.937 104.828,-439.749"/>
</g>
<!-- proc~line_plane_intersect -->
<g id="proc~~pnpa_mc~~CallsGraph_node14" class="node"><title>proc~line_plane_intersect</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node14"><a xlink:href=".././proc/line_plane_intersect.html" xlink:title="line_plane_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="478,-1392 370,-1392 370,-1368 478,-1368 478,-1392"/>
<text text-anchor="middle" x="424" y="-1377.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">line_plane_intersect</text>
</a>
</g>
</g>
<!-- proc~hit_npa_detector&#45;&gt;proc~line_plane_intersect -->
<g id="proc~~pnpa_mc~~CallsGraph_edge14" class="edge"><title>proc~hit_npa_detector&#45;&gt;proc~line_plane_intersect</title>
<path fill="none" stroke="#000000" d="M313.844,-1350.04C331.129,-1354.78 351.153,-1360.28 369.294,-1365.26"/>
<polygon fill="#000000" stroke="#000000" points="368.58,-1368.69 379.15,-1367.96 370.433,-1361.94 368.58,-1368.69"/>
</g>
<!-- proc~in_boundary -->
<g id="proc~~pnpa_mc~~CallsGraph_node21" class="node"><title>proc~in_boundary</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node21"><a xlink:href=".././proc/in_boundary.html" xlink:title="in_boundary">
<polygon fill="#d94e8f" stroke="#d94e8f" points="460,-1350 388,-1350 388,-1326 460,-1326 460,-1350"/>
<text text-anchor="middle" x="424" y="-1335.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_boundary</text>
</a>
</g>
</g>
<!-- proc~hit_npa_detector&#45;&gt;proc~in_boundary -->
<g id="proc~~pnpa_mc~~CallsGraph_edge13" class="edge"><title>proc~hit_npa_detector&#45;&gt;proc~in_boundary</title>
<path fill="none" stroke="#000000" d="M315.905,-1338C335.453,-1338 358.193,-1338 377.677,-1338"/>
<polygon fill="#000000" stroke="#000000" points="377.83,-1341.5 387.83,-1338 377.83,-1334.5 377.83,-1341.5"/>
</g>
<!-- proc~store_npa&#45;&gt;proc~get_fields -->
<g id="proc~~pnpa_mc~~CallsGraph_edge15" class="edge"><title>proc~store_npa&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M170.776,-571.029C188.425,-566.303 210.971,-560.267 229.908,-555.198"/>
<polygon fill="#000000" stroke="#000000" points="230.964,-558.539 239.718,-552.571 229.153,-551.777 230.964,-558.539"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~pnpa_mc~~CallsGraph_node24" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node24"><a xlink:href=".././proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="606,-506 538,-506 538,-482 606,-482 606,-506"/>
<text text-anchor="middle" x="572" y="-491.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~store_npa&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~pnpa_mc~~CallsGraph_edge16" class="edge"><title>proc~store_npa&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M169.335,-591.089C209.217,-607.383 284.584,-635.553 352,-646 415.245,-655.8 444.74,-684.319 496,-646 541.28,-612.151 500.031,-570.627 532,-524 534.811,-519.9 538.359,-516.115 542.163,-512.712"/>
<polygon fill="#000000" stroke="#000000" points="544.566,-515.272 550.18,-506.287 540.188,-509.81 544.566,-515.272"/>
</g>
<!-- proc~gyro_range -->
<g id="proc~~pnpa_mc~~CallsGraph_node23" class="node"><title>proc~gyro_range</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node23"><a xlink:href=".././proc/gyro_range.html" xlink:title="gyro_range">
<polygon fill="#d9534f" stroke="#d9534f" points="302.5,-1266 235.5,-1266 235.5,-1242 302.5,-1242 302.5,-1266"/>
<text text-anchor="middle" x="269" y="-1251.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_range</text>
</a>
</g>
</g>
<!-- proc~npa_gyro_range&#45;&gt;proc~gyro_range -->
<g id="proc~~pnpa_mc~~CallsGraph_edge17" class="edge"><title>proc~npa_gyro_range&#45;&gt;proc~gyro_range</title>
<path fill="none" stroke="#000000" d="M162.544,-1195.04C183.161,-1206.57 214.458,-1224.07 237.607,-1237.01"/>
<polygon fill="#000000" stroke="#000000" points="235.914,-1240.07 246.35,-1241.9 239.33,-1233.96 235.914,-1240.07"/>
</g>
<!-- proc~approx_eq -->
<g id="proc~~pnpa_mc~~CallsGraph_node26" class="node"><title>proc~approx_eq</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node26"><a xlink:href=".././proc/approx_eq.html" xlink:title="approx_eq">
<polygon fill="#d94e8f" stroke="#d94e8f" points="301,-1195 237,-1195 237,-1171 301,-1171 301,-1195"/>
<text text-anchor="middle" x="269" y="-1180.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">approx_eq</text>
</a>
</g>
</g>
<!-- proc~npa_gyro_range&#45;&gt;proc~approx_eq -->
<g id="proc~~pnpa_mc~~CallsGraph_edge18" class="edge"><title>proc~npa_gyro_range&#45;&gt;proc~approx_eq</title>
<path fill="none" stroke="#000000" d="M185.775,-1183C199.074,-1183 213.576,-1183 226.647,-1183"/>
<polygon fill="#000000" stroke="#000000" points="226.772,-1186.5 236.772,-1183 226.772,-1179.5 226.772,-1186.5"/>
</g>
<!-- proc~parallel_sum_d3 -->
<g id="proc~~pnpa_mc~~CallsGraph_node17" class="node"><title>proc~parallel_sum_d3</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node17"><a xlink:href=".././proc/parallel_sum_d3.html" xlink:title="parallel_sum_d3">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-839 223.5,-839 223.5,-815 314.5,-815 314.5,-839"/>
<text text-anchor="middle" x="269" y="-824.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d3 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge19" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M154.967,-896.988C170.606,-883.902 197.04,-862.856 222,-848 224.475,-846.527 227.072,-845.086 229.718,-843.694"/>
<polygon fill="#000000" stroke="#000000" points="231.409,-846.762 238.8,-839.171 228.288,-840.496 231.409,-846.762"/>
</g>
<!-- proc~parallel_sum_d1 -->
<g id="proc~~pnpa_mc~~CallsGraph_node19" class="node"><title>proc~parallel_sum_d1</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node19"><a xlink:href=".././proc/parallel_sum_d1.html" xlink:title="parallel_sum_d1">
<polygon fill="#d9534f" stroke="#d9534f" points="469.5,-910 378.5,-910 378.5,-886 469.5,-886 469.5,-910"/>
<text text-anchor="middle" x="424" y="-895.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge21" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M176.715,-907.607C224.991,-905.724 311.521,-902.348 368.093,-900.142"/>
<polygon fill="#000000" stroke="#000000" points="368.436,-903.631 378.292,-899.744 368.163,-896.636 368.436,-903.631"/>
</g>
<!-- proc~parallel_sum_d4 -->
<g id="proc~~pnpa_mc~~CallsGraph_node20" class="node"><title>proc~parallel_sum_d4</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node20"><a xlink:href=".././proc/parallel_sum_d4.html" xlink:title="parallel_sum_d4">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-1003 223.5,-1003 223.5,-979 314.5,-979 314.5,-1003"/>
<text text-anchor="middle" x="269" y="-988.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d4</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d4 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge22" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M154.967,-921.012C170.606,-934.098 197.04,-955.144 222,-970 224.475,-971.473 227.072,-972.914 229.718,-974.306"/>
<polygon fill="#000000" stroke="#000000" points="228.288,-977.504 238.8,-978.829 231.409,-971.238 228.288,-977.504"/>
</g>
<!-- proc~parallel_sum_d0 -->
<g id="proc~~pnpa_mc~~CallsGraph_node22" class="node"><title>proc~parallel_sum_d0</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node22"><a xlink:href=".././proc/parallel_sum_d0.html" xlink:title="parallel_sum_d0">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-797 223.5,-797 223.5,-773 314.5,-773 314.5,-797"/>
<text text-anchor="middle" x="269" y="-782.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d0 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge23" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M147.795,-896.989C160.159,-876.052 188.201,-832.576 222,-806 223.738,-804.633 225.58,-803.332 227.487,-802.097"/>
<polygon fill="#000000" stroke="#000000" points="229.238,-805.127 236.159,-797.105 225.746,-799.061 229.238,-805.127"/>
</g>
<!-- proc~parallel_sum_i0 -->
<g id="proc~~pnpa_mc~~CallsGraph_node25" class="node"><title>proc~parallel_sum_i0</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node25"><a xlink:href=".././proc/parallel_sum_i0.html" xlink:title="parallel_sum_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-755 225,-755 225,-731 313,-731 313,-755"/>
<text text-anchor="middle" x="269" y="-740.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i0</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i0 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge27" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M144.845,-896.832C154.011,-869.603 179.6,-803.091 222,-764 223.287,-762.814 224.652,-761.685 226.076,-760.611"/>
<polygon fill="#000000" stroke="#000000" points="228.203,-763.405 234.732,-755.061 224.425,-757.513 228.203,-763.405"/>
</g>
<!-- proc~parallel_sum_i3 -->
<g id="proc~~pnpa_mc~~CallsGraph_node28" class="node"><title>proc~parallel_sum_i3</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node28"><a xlink:href=".././proc/parallel_sum_i3.html" xlink:title="parallel_sum_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-1125 225,-1125 225,-1101 313,-1101 313,-1125"/>
<text text-anchor="middle" x="269" y="-1110.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i3</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i3 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge24" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M143.765,-921.268C151.325,-952.41 174.981,-1035.68 222,-1087 224.858,-1090.12 228.18,-1092.96 231.705,-1095.52"/>
<polygon fill="#000000" stroke="#000000" points="229.877,-1098.5 240.178,-1100.98 233.67,-1092.62 229.877,-1098.5"/>
</g>
<!-- proc~parallel_sum_d5 -->
<g id="proc~~pnpa_mc~~CallsGraph_node29" class="node"><title>proc~parallel_sum_d5</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node29"><a xlink:href=".././proc/parallel_sum_d5.html" xlink:title="parallel_sum_d5">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-961 223.5,-961 223.5,-937 314.5,-937 314.5,-961"/>
<text text-anchor="middle" x="269" y="-946.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d5</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d5 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge25" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M176.715,-920.249C190.186,-924.492 205.737,-929.389 220.142,-933.927"/>
<polygon fill="#000000" stroke="#000000" points="219.302,-937.332 229.892,-936.997 221.405,-930.655 219.302,-937.332"/>
</g>
<!-- proc~parallel_sum_d2 -->
<g id="proc~~pnpa_mc~~CallsGraph_node30" class="node"><title>proc~parallel_sum_d2</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node30"><a xlink:href=".././proc/parallel_sum_d2.html" xlink:title="parallel_sum_d2">
<polygon fill="#d9534f" stroke="#d9534f" points="314.5,-881 223.5,-881 223.5,-857 314.5,-857 314.5,-881"/>
<text text-anchor="middle" x="269" y="-866.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_d2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_d2 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge26" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_d2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M176.715,-897.751C190.186,-893.508 205.737,-888.611 220.142,-884.073"/>
<polygon fill="#000000" stroke="#000000" points="221.405,-887.345 229.892,-881.003 219.302,-880.668 221.405,-887.345"/>
</g>
<!-- proc~parallel_sum_i1 -->
<g id="proc~~pnpa_mc~~CallsGraph_node31" class="node"><title>proc~parallel_sum_i1</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node31"><a xlink:href=".././proc/parallel_sum_i1.html" xlink:title="parallel_sum_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-1084 380,-1084 380,-1060 468,-1060 468,-1084"/>
<text text-anchor="middle" x="424" y="-1069.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i1</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge20" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M143.768,-921.403C150.951,-950.35 173.13,-1022.31 222,-1054 265.678,-1082.33 326.367,-1083.83 369.606,-1080.11"/>
<polygon fill="#000000" stroke="#000000" points="370.04,-1083.59 379.651,-1079.13 369.357,-1076.62 370.04,-1083.59"/>
</g>
<!-- proc~parallel_sum_i2 -->
<g id="proc~~pnpa_mc~~CallsGraph_node32" class="node"><title>proc~parallel_sum_i2</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node32"><a xlink:href=".././proc/parallel_sum_i2.html" xlink:title="parallel_sum_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-1045 225,-1045 225,-1021 313,-1021 313,-1045"/>
<text text-anchor="middle" x="269" y="-1030.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">parallel_sum_i2</text>
</a>
</g>
</g>
<!-- interface~parallel_sum&#45;&gt;proc~parallel_sum_i2 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge28" class="edge"><title>interface~parallel_sum&#45;&gt;proc~parallel_sum_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M147.795,-921.011C160.159,-941.948 188.201,-985.424 222,-1012 223.738,-1013.37 225.58,-1014.67 227.487,-1015.9"/>
<polygon fill="#000000" stroke="#000000" points="225.746,-1018.94 236.159,-1020.89 229.238,-1012.87 225.746,-1018.94"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~pnpa_mc~~CallsGraph_node27" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node27"><a xlink:href=".././interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="610.5,-360 533.5,-360 533.5,-336 610.5,-336 610.5,-360"/>
<text text-anchor="middle" x="572" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~bt_cx_rates&#45;&gt;interface~interpol_coeff -->
<g id="proc~~pnpa_mc~~CallsGraph_edge29" class="edge"><title>proc~bt_cx_rates&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M174.027,-361.848C249.524,-359.214 434.981,-352.745 523.06,-349.672"/>
<polygon fill="#000000" stroke="#000000" points="523.433,-353.162 533.305,-349.315 523.189,-346.166 523.433,-353.162"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~pnpa_mc~~CallsGraph_edge32" class="edge"><title>proc~get_plasma&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M290.393,-430.851C306.494,-422.001 329.86,-410.764 352,-406 414.568,-392.538 434.182,-389.43 496,-406 553.507,-421.414 567.458,-433.495 612,-473 635.597,-493.929 656.347,-524.063 668.778,-544.071"/>
<polygon fill="#000000" stroke="#000000" points="665.857,-546.003 674.036,-552.738 671.841,-542.373 665.857,-546.003"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~pnpa_mc~~CallsGraph_node15" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node15"><a xlink:href=".././proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="454.5,-439 393.5,-439 393.5,-415 454.5,-415 454.5,-439"/>
<text text-anchor="middle" x="424" y="-424.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~pnpa_mc~~CallsGraph_edge30" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M303.199,-439.528C326.731,-437.067 358.413,-433.754 383.287,-431.153"/>
<polygon fill="#000000" stroke="#000000" points="383.904,-434.608 393.486,-430.086 383.176,-427.646 383.904,-434.608"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~pnpa_mc~~CallsGraph_edge31" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M303.073,-448.604C357.788,-457.874 467.121,-476.399 527.842,-486.687"/>
<polygon fill="#000000" stroke="#000000" points="527.428,-490.167 537.872,-488.387 528.597,-483.266 527.428,-490.167"/>
</g>
<!-- proc~get_position -->
<g id="proc~~pnpa_mc~~CallsGraph_node33" class="node"><title>proc~get_position</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node33"><a xlink:href=".././proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="459,-557 389,-557 389,-533 459,-533 459,-557"/>
<text text-anchor="middle" x="424" y="-542.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~pnpa_mc~~CallsGraph_edge33" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M288.152,-455.101C314.953,-472.968 365.276,-506.518 396.292,-527.195"/>
<polygon fill="#000000" stroke="#000000" points="394.61,-530.28 404.872,-532.914 398.493,-524.455 394.61,-530.28"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~pnpa_mc~~CallsGraph_edge34" class="edge"><title>proc~get_fields&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M298.124,-554.065C313.797,-558.643 333.775,-563.703 352,-566 453.727,-578.819 574.555,-573.169 637.679,-568.648"/>
<polygon fill="#000000" stroke="#000000" points="637.959,-572.137 647.672,-567.907 637.441,-565.156 637.959,-572.137"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~pnpa_mc~~CallsGraph_edge35" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M285.797,-532.816C312.596,-512.148 367.133,-470.087 398.782,-445.678"/>
<polygon fill="#000000" stroke="#000000" points="401.278,-448.173 407.059,-439.294 397.003,-442.63 401.278,-448.173"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~pnpa_mc~~CallsGraph_node16" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node16"><a xlink:href=".././proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="474,-637 374,-637 374,-613 474,-613 474,-637"/>
<text text-anchor="middle" x="424" y="-622.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~pnpa_mc~~CallsGraph_edge36" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M285.972,-557.131C302.025,-568.928 327.796,-586.806 352,-599 359.418,-602.737 367.506,-606.215 375.48,-609.334"/>
<polygon fill="#000000" stroke="#000000" points="374.506,-612.707 385.098,-612.953 376.971,-606.155 374.506,-612.707"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~pnpa_mc~~CallsGraph_edge37" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M298.28,-536.905C314,-532.621 333.973,-527.531 352,-524 412.491,-512.151 483.288,-503.361 527.645,-498.456"/>
<polygon fill="#000000" stroke="#000000" points="528.222,-501.914 537.784,-497.351 527.464,-494.955 528.222,-501.914"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~pnpa_mc~~CallsGraph_edge38" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M298.063,-545C320.682,-545 352.899,-545 378.952,-545"/>
<polygon fill="#000000" stroke="#000000" points="378.964,-548.5 388.964,-545 378.964,-541.5 378.964,-548.5"/>
</g>
<!-- proc~attenuate&#45;&gt;proc~get_plasma -->
<g id="proc~~pnpa_mc~~CallsGraph_edge40" class="edge"><title>proc~attenuate&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M169.185,-424.326C185.587,-427.426 206.596,-431.396 225.023,-434.878"/>
<polygon fill="#000000" stroke="#000000" points="224.472,-438.336 234.948,-436.754 225.772,-431.458 224.472,-438.336"/>
</g>
<!-- proc~colrad -->
<g id="proc~~pnpa_mc~~CallsGraph_node18" class="node"><title>proc~colrad</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node18"><a xlink:href=".././proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="296,-298 242,-298 242,-274 296,-274 296,-298"/>
<text text-anchor="middle" x="269" y="-283.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~attenuate&#45;&gt;proc~colrad -->
<g id="proc~~pnpa_mc~~CallsGraph_edge39" class="edge"><title>proc~attenuate&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M158.37,-406.844C167.031,-400.453 177.453,-392.247 186,-384 211.702,-359.199 237.509,-326.832 253.123,-306.225"/>
<polygon fill="#000000" stroke="#000000" points="255.963,-308.27 259.16,-298.169 250.362,-304.072 255.963,-308.27"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~pnpa_mc~~CallsGraph_edge41" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M454.758,-436.784C467.619,-441.296 482.729,-446.983 496,-453 511.483,-460.02 528.129,-468.968 541.795,-476.712"/>
<polygon fill="#000000" stroke="#000000" points="540.315,-479.898 550.73,-481.843 543.801,-473.828 540.315,-479.898"/>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~pnpa_mc~~CallsGraph_edge42" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M447.493,-414.829C472.214,-401.453 512.093,-379.874 539.823,-364.87"/>
<polygon fill="#000000" stroke="#000000" points="541.592,-367.892 548.721,-360.055 538.261,-361.736 541.592,-367.892"/>
</g>
<!-- proc~cyl_to_uvw -->
<g id="proc~~pnpa_mc~~CallsGraph_node38" class="node"><title>proc~cyl_to_uvw</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node38"><a xlink:href=".././proc/cyl_to_uvw.html" xlink:title="cyl_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="714.5,-491 649.5,-491 649.5,-467 714.5,-467 714.5,-491"/>
<text text-anchor="middle" x="682" y="-476.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_uvw</text>
</a>
</g>
</g>
<!-- proc~in_plasma&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~pnpa_mc~~CallsGraph_edge43" class="edge"><title>proc~in_plasma&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M454.617,-433.016C500.147,-442.264 587.499,-460.008 639.373,-470.544"/>
<polygon fill="#000000" stroke="#000000" points="638.755,-473.99 649.252,-472.551 640.148,-467.13 638.755,-473.99"/>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge45" class="edge"><title>proc~parallel_sum_d3&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M296.775,-839.175C303.085,-842.057 309.784,-845.129 316,-848 340.052,-859.11 367.083,-871.742 387.959,-881.53"/>
<polygon fill="#000000" stroke="#000000" points="386.544,-884.733 397.084,-885.811 389.518,-878.395 386.544,-884.733"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_node40" class="node"><title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="611.5,-939 532.5,-939 532.5,-915 611.5,-915 611.5,-939"/>
<text text-anchor="middle" x="572" y="-924.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_allreduce</text>
</g>
<!-- proc~parallel_sum_d3&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge44" class="edge"><title>proc~parallel_sum_d3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.741,-824.762C362.048,-824.169 437.74,-828.372 496,-856 520.419,-867.58 542.082,-890.136 555.77,-906.73"/>
<polygon fill="#000000" stroke="#000000" points="553.207,-909.13 562.174,-914.774 558.684,-904.77 553.207,-909.13"/>
</g>
<!-- proc~linsolve -->
<g id="proc~~pnpa_mc~~CallsGraph_node37" class="node"><title>proc~linsolve</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node37"><a xlink:href=".././proc/linsolve.html" xlink:title="linsolve">
<polygon fill="#d9534f" stroke="#d9534f" points="451,-276 397,-276 397,-252 451,-252 451,-276"/>
<text text-anchor="middle" x="424" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linsolve</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~linsolve -->
<g id="proc~~pnpa_mc~~CallsGraph_edge46" class="edge"><title>proc~colrad&#45;&gt;proc~linsolve</title>
<path fill="none" stroke="#000000" d="M296.302,-282.218C321.227,-278.634 358.881,-273.22 386.667,-269.224"/>
<polygon fill="#000000" stroke="#000000" points="387.386,-272.657 396.786,-267.769 386.39,-265.728 387.386,-272.657"/>
</g>
<!-- proc~eigen -->
<g id="proc~~pnpa_mc~~CallsGraph_node42" class="node"><title>proc~eigen</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node42"><a xlink:href=".././proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="451,-129 397,-129 397,-105 451,-105 451,-129"/>
<text text-anchor="middle" x="424" y="-114.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~pnpa_mc~~CallsGraph_edge47" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M281.003,-273.846C307.138,-244.978 373.138,-172.076 405.103,-136.769"/>
<polygon fill="#000000" stroke="#000000" points="407.98,-138.806 412.096,-129.044 402.79,-134.108 407.98,-138.806"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~pnpa_mc~~CallsGraph_node43" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node43"><a xlink:href=".././proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-319 380,-319 380,-295 468,-295 468,-319"/>
<text text-anchor="middle" x="424" y="-304.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~pnpa_mc~~CallsGraph_edge48" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M296.302,-289.61C316.427,-292.372 344.85,-296.274 369.677,-299.681"/>
<polygon fill="#000000" stroke="#000000" points="369.32,-303.165 379.703,-301.057 370.272,-296.23 369.32,-303.165"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge50" class="edge"><title>proc~parallel_sum_d1&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M399.529,-910.014C390.984,-918.972 399.141,-928 424,-928 439.149,-928 448.095,-924.647 450.839,-920.001"/>
<polygon fill="#000000" stroke="#000000" points="454.184,-918.936 448.471,-910.014 447.373,-920.552 454.184,-918.936"/>
</g>
<!-- proc~parallel_sum_d1&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge49" class="edge"><title>proc~parallel_sum_d1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M469.598,-906.859C486.126,-910.142 504.956,-913.882 521.865,-917.24"/>
<polygon fill="#000000" stroke="#000000" points="521.618,-920.76 532.108,-919.275 522.982,-913.894 521.618,-920.76"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge52" class="edge"><title>proc~parallel_sum_d4&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M298.583,-978.834C304.433,-976.099 310.484,-973.087 316,-970 345.536,-953.468 377.501,-931.354 398.727,-916.015"/>
<polygon fill="#000000" stroke="#000000" points="400.833,-918.811 406.854,-910.093 396.711,-913.153 400.833,-918.811"/>
</g>
<!-- proc~parallel_sum_d4&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge51" class="edge"><title>proc~parallel_sum_d4&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.715,-986.54C360.704,-981.335 434.145,-971.298 496,-955 508.285,-951.763 521.359,-947.268 533.092,-942.826"/>
<polygon fill="#000000" stroke="#000000" points="534.533,-946.021 542.586,-939.136 531.997,-939.496 534.533,-946.021"/>
</g>
<!-- proc~parallel_sum_d0&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge53" class="edge"><title>proc~parallel_sum_d0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.707,-782.279C363.012,-781.457 440.504,-786.478 496,-821 528.302,-841.094 550.607,-880.756 562.059,-905.457"/>
<polygon fill="#000000" stroke="#000000" points="558.916,-907.004 566.172,-914.724 565.315,-904.164 558.916,-907.004"/>
</g>
<!-- proc~gyro_range&#45;&gt;proc~line_plane_intersect -->
<g id="proc~~pnpa_mc~~CallsGraph_edge54" class="edge"><title>proc~gyro_range&#45;&gt;proc~line_plane_intersect</title>
<path fill="none" stroke="#000000" d="M278.971,-1266.34C298.215,-1292.67 342.488,-1352.52 352,-1359 354.71,-1360.84 357.584,-1362.53 360.563,-1364.07"/>
<polygon fill="#000000" stroke="#000000" points="359.205,-1367.3 369.756,-1368.27 362.112,-1360.93 359.205,-1367.3"/>
</g>
<!-- proc~gyro_range&#45;&gt;proc~in_boundary -->
<g id="proc~~pnpa_mc~~CallsGraph_edge58" class="edge"><title>proc~gyro_range&#45;&gt;proc~in_boundary</title>
<path fill="none" stroke="#000000" d="M282.609,-1266.11C297.891,-1280.18 324.968,-1303.22 352,-1317 360.071,-1321.11 369.08,-1324.55 377.898,-1327.38"/>
<polygon fill="#000000" stroke="#000000" points="377.128,-1330.8 387.712,-1330.31 379.133,-1324.1 377.128,-1330.8"/>
</g>
<!-- proc~boundary_edge -->
<g id="proc~~pnpa_mc~~CallsGraph_node34" class="node"><title>proc~boundary_edge</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node34"><a xlink:href=".././proc/boundary_edge.html" xlink:title="boundary_edge">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-1224 380,-1224 380,-1200 468,-1200 468,-1224"/>
<text text-anchor="middle" x="424" y="-1209.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boundary_edge</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~boundary_edge -->
<g id="proc~~pnpa_mc~~CallsGraph_edge55" class="edge"><title>proc~gyro_range&#45;&gt;proc~boundary_edge</title>
<path fill="none" stroke="#000000" d="M302.822,-1244.99C322.403,-1239.61 347.725,-1232.66 370.072,-1226.53"/>
<polygon fill="#000000" stroke="#000000" points="371.053,-1229.89 379.77,-1223.87 369.2,-1223.14 371.053,-1229.89"/>
</g>
<!-- proc~in_gyro_surface -->
<g id="proc~~pnpa_mc~~CallsGraph_node35" class="node"><title>proc~in_gyro_surface</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node35"><a xlink:href=".././proc/in_gyro_surface.html" xlink:title="in_gyro_surface">
<polygon fill="#d94e8f" stroke="#d94e8f" points="468.5,-1182 379.5,-1182 379.5,-1158 468.5,-1158 468.5,-1182"/>
<text text-anchor="middle" x="424" y="-1167.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_gyro_surface</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~in_gyro_surface -->
<g id="proc~~pnpa_mc~~CallsGraph_edge56" class="edge"><title>proc~gyro_range&#45;&gt;proc~in_gyro_surface</title>
<path fill="none" stroke="#000000" d="M282.609,-1241.89C297.891,-1227.82 324.968,-1204.78 352,-1191 357.562,-1188.17 363.568,-1185.65 369.651,-1183.44"/>
<polygon fill="#000000" stroke="#000000" points="370.867,-1186.72 379.218,-1180.2 368.624,-1180.09 370.867,-1186.72"/>
</g>
<!-- proc~line_gyro_surface_intersect -->
<g id="proc~~pnpa_mc~~CallsGraph_node36" class="node"><title>proc~line_gyro_surface_intersect</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node36"><a xlink:href=".././proc/line_gyro_surface_intersect.html" xlink:title="line_gyro_surface_intersect">
<polygon fill="#d9534f" stroke="#d9534f" points="496,-1308 352,-1308 352,-1284 496,-1284 496,-1308"/>
<text text-anchor="middle" x="424" y="-1293.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">line_gyro_surface_intersect</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~line_gyro_surface_intersect -->
<g id="proc~~pnpa_mc~~CallsGraph_edge57" class="edge"><title>proc~gyro_range&#45;&gt;proc~line_gyro_surface_intersect</title>
<path fill="none" stroke="#000000" d="M302.822,-1263.01C322.25,-1268.34 347.33,-1275.23 369.548,-1281.33"/>
<polygon fill="#000000" stroke="#000000" points="368.627,-1284.7 379.196,-1283.98 370.48,-1277.95 368.627,-1284.7"/>
</g>
<!-- proc~gyro_surface_coordinates -->
<g id="proc~~pnpa_mc~~CallsGraph_node39" class="node"><title>proc~gyro_surface_coordinates</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node39"><a xlink:href=".././proc/gyro_surface_coordinates.html" xlink:title="gyro_surface_coordinates">
<polygon fill="#d9534f" stroke="#d9534f" points="492,-1266 356,-1266 356,-1242 492,-1242 492,-1266"/>
<text text-anchor="middle" x="424" y="-1251.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_surface_coordinates</text>
</a>
</g>
</g>
<!-- proc~gyro_range&#45;&gt;proc~gyro_surface_coordinates -->
<g id="proc~~pnpa_mc~~CallsGraph_edge59" class="edge"><title>proc~gyro_range&#45;&gt;proc~gyro_surface_coordinates</title>
<path fill="none" stroke="#000000" d="M302.822,-1254C315.45,-1254 330.465,-1254 345.531,-1254"/>
<polygon fill="#000000" stroke="#000000" points="345.94,-1257.5 355.94,-1254 345.94,-1250.5 345.94,-1257.5"/>
</g>
<!-- proc~parallel_sum_i0&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge60" class="edge"><title>proc~parallel_sum_i0&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M313.072,-738.878C362.065,-736.485 442.221,-739.8 496,-779 538.246,-809.793 558.286,-871.307 566.374,-904.509"/>
<polygon fill="#000000" stroke="#000000" points="563.039,-905.625 568.673,-914.598 569.864,-904.07 563.039,-905.625"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge62" class="edge"><title>proc~parallel_sum_i3&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M313.026,-1101.47C330.708,-1096.73 351.361,-1091.2 369.964,-1086.21"/>
<polygon fill="#000000" stroke="#000000" points="371.013,-1089.55 379.767,-1083.59 369.201,-1082.79 371.013,-1089.55"/>
</g>
<!-- proc~parallel_sum_i3&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge61" class="edge"><title>proc~parallel_sum_i3&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M310.265,-1125.05C358.777,-1136.98 440.645,-1148.57 496,-1111 550.528,-1073.99 565.44,-989.751 569.496,-949.382"/>
<polygon fill="#000000" stroke="#000000" points="572.999,-949.5 570.377,-939.235 566.025,-948.895 572.999,-949.5"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge64" class="edge"><title>proc~parallel_sum_d5&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M306.259,-936.914C327.427,-929.858 354.343,-920.886 376.993,-913.336"/>
<polygon fill="#000000" stroke="#000000" points="378.357,-916.571 386.737,-910.088 376.143,-909.93 378.357,-916.571"/>
</g>
<!-- proc~parallel_sum_d5&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge63" class="edge"><title>proc~parallel_sum_d5&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.673,-947.676C360.318,-946.077 433.209,-942.844 496,-937 504.461,-936.213 513.435,-935.185 522.122,-934.088"/>
<polygon fill="#000000" stroke="#000000" points="522.678,-937.545 532.14,-932.779 521.771,-930.604 522.678,-937.545"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge66" class="edge"><title>proc~parallel_sum_d2&#45;&gt;proc~parallel_sum_d1</title>
<path fill="none" stroke="#000000" d="M314.665,-877.466C331.402,-880.638 350.614,-884.28 368.167,-887.607"/>
<polygon fill="#000000" stroke="#000000" points="367.802,-891.1 378.279,-889.524 369.106,-884.222 367.802,-891.1"/>
</g>
<!-- proc~parallel_sum_d2&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge65" class="edge"><title>proc~parallel_sum_d2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M314.549,-863.554C361.041,-859.472 435.462,-857.495 496,-877 515.983,-883.438 535.619,-896.86 549.783,-908.178"/>
<polygon fill="#000000" stroke="#000000" points="547.919,-911.179 557.85,-914.871 552.389,-905.792 547.919,-911.179"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge68" class="edge"><title>proc~parallel_sum_i1&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M399.529,-1084.01C390.984,-1092.97 399.141,-1102 424,-1102 439.149,-1102 448.095,-1098.65 450.839,-1094"/>
<polygon fill="#000000" stroke="#000000" points="454.184,-1092.94 448.471,-1084.01 447.373,-1094.55 454.184,-1092.94"/>
</g>
<!-- proc~parallel_sum_i1&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge67" class="edge"><title>proc~parallel_sum_i1&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M468.322,-1061.25C478.086,-1057.49 487.935,-1052.52 496,-1046 528.528,-1019.71 551.101,-975.336 562.48,-948.841"/>
<polygon fill="#000000" stroke="#000000" points="565.831,-949.897 566.417,-939.319 559.362,-947.223 565.831,-949.897"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge70" class="edge"><title>proc~parallel_sum_i2&#45;&gt;proc~parallel_sum_i1</title>
<path fill="none" stroke="#000000" d="M313.026,-1043.97C330.708,-1048.47 351.361,-1053.74 369.964,-1058.48"/>
<polygon fill="#000000" stroke="#000000" points="369.212,-1061.9 379.767,-1060.98 370.941,-1055.12 369.212,-1061.9"/>
</g>
<!-- proc~parallel_sum_i2&#45;&gt;mpi_allreduce -->
<g id="proc~~pnpa_mc~~CallsGraph_edge69" class="edge"><title>proc~parallel_sum_i2&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#000000" d="M313.325,-1028.57C360.101,-1022.58 435.967,-1009.34 496,-982 516.023,-972.881 535.978,-957.888 550.266,-945.857"/>
<polygon fill="#000000" stroke="#000000" points="552.708,-948.373 557.981,-939.183 548.128,-943.079 552.708,-948.373"/>
</g>
<!-- proc~cyl_to_xyz -->
<g id="proc~~pnpa_mc~~CallsGraph_node41" class="node"><title>proc~cyl_to_xyz</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node41"><a xlink:href=".././proc/cyl_to_xyz.html" xlink:title="cyl_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="603,-557 541,-557 541,-533 603,-533 603,-557"/>
<text text-anchor="middle" x="572" y="-542.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cyl_to_xyz</text>
</a>
</g>
</g>
<!-- proc~get_position&#45;&gt;proc~cyl_to_xyz -->
<g id="proc~~pnpa_mc~~CallsGraph_edge71" class="edge"><title>proc~get_position&#45;&gt;proc~cyl_to_xyz</title>
<path fill="none" stroke="#000000" d="M459.231,-545C480.622,-545 508.271,-545 530.716,-545"/>
<polygon fill="#000000" stroke="#000000" points="530.944,-548.5 540.944,-545 530.944,-541.5 530.944,-548.5"/>
</g>
<!-- proc~matinv -->
<g id="proc~~pnpa_mc~~CallsGraph_node44" class="node"><title>proc~matinv</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node44"><a xlink:href=".././proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-234 545,-234 545,-210 599,-210 599,-234"/>
<text text-anchor="middle" x="572" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~linsolve&#45;&gt;proc~matinv -->
<g id="proc~~pnpa_mc~~CallsGraph_edge72" class="edge"><title>proc~linsolve&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M451.102,-256.491C474.418,-249.784 508.802,-239.892 534.778,-232.42"/>
<polygon fill="#000000" stroke="#000000" points="535.989,-235.714 544.632,-229.585 534.054,-228.986 535.989,-235.714"/>
</g>
<!-- dgetrf -->
<g id="proc~~pnpa_mc~~CallsGraph_node49" class="node"><title>dgetrf</title>
<polygon fill="#777777" stroke="#777777" points="599,-318 545,-318 545,-294 599,-294 599,-318"/>
<text text-anchor="middle" x="572" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrf</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrf -->
<g id="proc~~pnpa_mc~~CallsGraph_edge73" class="edge"><title>proc~linsolve&#45;&gt;dgetrf</title>
<path fill="none" stroke="#000000" d="M451.102,-271.509C474.418,-278.216 508.802,-288.108 534.778,-295.58"/>
<polygon fill="#000000" stroke="#000000" points="534.054,-299.014 544.632,-298.415 535.989,-292.286 534.054,-299.014"/>
</g>
<!-- dgetrs -->
<g id="proc~~pnpa_mc~~CallsGraph_node50" class="node"><title>dgetrs</title>
<polygon fill="#777777" stroke="#777777" points="599,-276 545,-276 545,-252 599,-252 599,-276"/>
<text text-anchor="middle" x="572" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgetrs</text>
</g>
<!-- proc~linsolve&#45;&gt;dgetrs -->
<g id="proc~~pnpa_mc~~CallsGraph_edge74" class="edge"><title>proc~linsolve&#45;&gt;dgetrs</title>
<path fill="none" stroke="#000000" d="M451.102,-264C474.314,-264 508.498,-264 534.432,-264"/>
<polygon fill="#000000" stroke="#000000" points="534.632,-267.5 544.632,-264 534.632,-260.5 534.632,-267.5"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz -->
<g id="proc~~pnpa_mc~~CallsGraph_edge75" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M603.084,-550.571C613.801,-552.556 626.092,-554.832 637.698,-556.981"/>
<polygon fill="#000000" stroke="#000000" points="637.192,-560.447 647.662,-558.826 638.467,-553.564 637.192,-560.447"/>
</g>
<!-- proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw -->
<g id="proc~~pnpa_mc~~CallsGraph_edge76" class="edge"><title>proc~cyl_to_xyz&#45;&gt;proc~cyl_to_uvw</title>
<path fill="none" stroke="#000000" d="M592.809,-532.895C609.555,-522.661 633.754,-507.872 652.569,-496.374"/>
<polygon fill="#000000" stroke="#000000" points="654.609,-499.23 661.317,-491.029 650.959,-493.257 654.609,-499.23"/>
</g>
<!-- proc~balance -->
<g id="proc~~pnpa_mc~~CallsGraph_node45" class="node"><title>proc~balance</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node45"><a xlink:href=".././proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-24 545,-24 545,-0 599,-0 599,-24"/>
<text text-anchor="middle" x="572" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~pnpa_mc~~CallsGraph_edge78" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M438.952,-104.771C458.839,-87.6439 496.831,-56.029 532,-33 533.934,-31.7336 535.952,-30.475 538.007,-29.2398"/>
<polygon fill="#000000" stroke="#000000" points="540.174,-32.0317 547.111,-24.0234 536.694,-25.958 540.174,-32.0317"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~pnpa_mc~~CallsGraph_node46" class="node"><title>proc~elmhes</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node46"><a xlink:href=".././proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-108 545,-108 545,-84 599,-84 599,-108"/>
<text text-anchor="middle" x="572" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~pnpa_mc~~CallsGraph_edge77" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M451.102,-113.246C474.314,-109.907 508.498,-104.99 534.432,-101.26"/>
<polygon fill="#000000" stroke="#000000" points="535.232,-104.681 544.632,-99.7927 534.235,-97.7521 535.232,-104.681"/>
</g>
<!-- proc~balback -->
<g id="proc~~pnpa_mc~~CallsGraph_node47" class="node"><title>proc~balback</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node47"><a xlink:href=".././proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-66 545,-66 545,-42 599,-42 599,-66"/>
<text text-anchor="middle" x="572" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~pnpa_mc~~CallsGraph_edge79" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M451.102,-105.737C474.521,-95.6314 509.107,-80.7073 535.122,-69.4816"/>
<polygon fill="#000000" stroke="#000000" points="536.837,-72.5536 544.632,-65.378 534.063,-66.1265 536.837,-72.5536"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~pnpa_mc~~CallsGraph_node48" class="node"><title>proc~hqr2</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node48"><a xlink:href=".././proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-192 545,-192 545,-168 599,-168 599,-192"/>
<text text-anchor="middle" x="572" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~pnpa_mc~~CallsGraph_edge80" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M451.102,-128.263C474.521,-138.369 509.107,-153.293 535.122,-164.518"/>
<polygon fill="#000000" stroke="#000000" points="534.063,-167.874 544.632,-168.622 536.837,-161.446 534.063,-167.874"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~pnpa_mc~~CallsGraph_node51" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node51"><a xlink:href=".././proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="599,-150 545,-150 545,-126 599,-126 599,-150"/>
<text text-anchor="middle" x="572" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~pnpa_mc~~CallsGraph_edge81" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M451.102,-120.754C474.314,-124.093 508.498,-129.01 534.432,-132.74"/>
<polygon fill="#000000" stroke="#000000" points="534.235,-136.248 544.632,-134.207 535.232,-129.319 534.235,-136.248"/>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~pnpa_mc~~CallsGraph_edge82" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M468.015,-319.08C485.474,-323.982 505.703,-329.663 523.586,-334.685"/>
<polygon fill="#000000" stroke="#000000" points="522.673,-338.064 533.247,-337.398 524.566,-331.325 522.673,-338.064"/>
</g>
<!-- proc~lubksb -->
<g id="proc~~pnpa_mc~~CallsGraph_node54" class="node"><title>proc~lubksb</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node54"><a xlink:href=".././proc/lubksb.html" xlink:title="lubksb">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-276 655,-276 655,-252 709,-252 709,-276"/>
<text text-anchor="middle" x="682" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lubksb</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~lubksb -->
<g id="proc~~pnpa_mc~~CallsGraph_edge83" class="edge"><title>proc~matinv&#45;&gt;proc~lubksb</title>
<path fill="none" stroke="#000000" d="M599.144,-232.167C612.971,-237.544 630.153,-244.226 645.2,-250.078"/>
<polygon fill="#000000" stroke="#000000" points="644.134,-253.419 654.723,-253.781 646.671,-246.894 644.134,-253.419"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~pnpa_mc~~CallsGraph_node55" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node55"><a xlink:href=".././proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-234 655,-234 655,-210 709,-210 709,-234"/>
<text text-anchor="middle" x="682" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~pnpa_mc~~CallsGraph_edge84" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M599.144,-222C612.707,-222 629.499,-222 644.338,-222"/>
<polygon fill="#000000" stroke="#000000" points="644.723,-225.5 654.723,-222 644.723,-218.5 644.723,-225.5"/>
</g>
<!-- proc~rswap -->
<g id="proc~~pnpa_mc~~CallsGraph_node53" class="node"><title>proc~rswap</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node53"><a xlink:href=".././proc/rswap.html" xlink:title="RSWAP">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-66 655,-66 655,-42 709,-42 709,-66"/>
<text text-anchor="middle" x="682" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RSWAP</text>
</a>
</g>
</g>
<!-- proc~balance&#45;&gt;proc~rswap -->
<g id="proc~~pnpa_mc~~CallsGraph_edge85" class="edge"><title>proc~balance&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M599.144,-22.167C612.971,-27.5441 630.153,-34.226 645.2,-40.0776"/>
<polygon fill="#000000" stroke="#000000" points="644.134,-43.4185 654.723,-43.781 646.671,-36.8945 644.134,-43.4185"/>
</g>
<!-- proc~elmhes&#45;&gt;proc~rswap -->
<g id="proc~~pnpa_mc~~CallsGraph_edge86" class="edge"><title>proc~elmhes&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M599.144,-85.833C612.971,-80.4559 630.153,-73.774 645.2,-67.9224"/>
<polygon fill="#000000" stroke="#000000" points="646.671,-71.1055 654.723,-64.219 644.134,-64.5815 646.671,-71.1055"/>
</g>
<!-- proc~balback&#45;&gt;proc~rswap -->
<g id="proc~~pnpa_mc~~CallsGraph_edge87" class="edge"><title>proc~balback&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M599.144,-54C612.707,-54 629.499,-54 644.338,-54"/>
<polygon fill="#000000" stroke="#000000" points="644.723,-57.5001 654.723,-54 644.723,-50.5001 644.723,-57.5001"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~pnpa_mc~~CallsGraph_node52" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node52"><a xlink:href=".././proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="709,-192 655,-192 655,-168 709,-168 709,-192"/>
<text text-anchor="middle" x="682" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~pnpa_mc~~CallsGraph_edge88" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M599.144,-180C612.707,-180 629.499,-180 644.338,-180"/>
<polygon fill="#000000" stroke="#000000" points="644.723,-183.5 654.723,-180 644.723,-176.5 644.723,-183.5"/>
</g>
<!-- proc~comdiv -->
<g id="proc~~pnpa_mc~~CallsGraph_node57" class="node"><title>proc~comdiv</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node57"><a xlink:href=".././proc/comdiv.html" xlink:title="Comdiv">
<polygon fill="#d9534f" stroke="#d9534f" points="809,-192 755,-192 755,-168 809,-168 809,-192"/>
<text text-anchor="middle" x="782" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Comdiv</text>
</a>
</g>
</g>
<!-- proc~hqrvec&#45;&gt;proc~comdiv -->
<g id="proc~~pnpa_mc~~CallsGraph_edge89" class="edge"><title>proc~hqrvec&#45;&gt;proc~comdiv</title>
<path fill="none" stroke="#000000" d="M709.005,-180C719.969,-180 732.92,-180 744.794,-180"/>
<polygon fill="#000000" stroke="#000000" points="744.874,-183.5 754.874,-180 744.874,-176.5 744.874,-183.5"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~pnpa_mc~~CallsGraph_node56" class="node"><title>proc~outerprod</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node56"><a xlink:href=".././proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="811.5,-276 752.5,-276 752.5,-252 811.5,-252 811.5,-276"/>
<text text-anchor="middle" x="782" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~pnpa_mc~~CallsGraph_edge90" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M709.005,-233.145C719.549,-237.664 731.929,-242.97 743.422,-247.895"/>
<polygon fill="#000000" stroke="#000000" points="742.237,-251.195 752.807,-251.917 744.995,-244.761 742.237,-251.195"/>
</g>
<!-- proc~swap -->
<g id="proc~~pnpa_mc~~CallsGraph_node58" class="node"><title>proc~swap</title>
<g id="a_proc~~pnpa_mc~~CallsGraph_node58"><a xlink:href=".././proc/swap.html" xlink:title="swap">
<polygon fill="#d9534f" stroke="#d9534f" points="809,-234 755,-234 755,-210 809,-210 809,-234"/>
<text text-anchor="middle" x="782" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swap</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~swap -->
<g id="proc~~pnpa_mc~~CallsGraph_edge91" class="edge"><title>proc~ludcmp&#45;&gt;proc~swap</title>
<path fill="none" stroke="#000000" d="M709.005,-222C719.969,-222 732.92,-222 744.794,-222"/>
<polygon fill="#000000" stroke="#000000" points="744.874,-225.5 754.874,-222 744.874,-218.5 744.874,-225.5"/>
</g>
</g>
</svg>
</div><script>var panprocpnpa_mcCallsGraph = svgPanZoom('#procpnpa_mcCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~pnpa_mc~~CalledByGraph Pages: 1 -->
<svg id="procpnpa_mcCalledByGraph" width="156pt" height="32pt"
 viewBox="0.00 0.00 156.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pnpa_mc~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~pnpa_mc~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 152,-28 152,4 -4,4"/>
<!-- proc~pnpa_mc -->
<g id="proc~~pnpa_mc~~CalledByGraph_node1" class="node"><title>proc~pnpa_mc</title>
<polygon fill="none" stroke="black" points="147.5,-24 90.5,-24 90.5,-0 147.5,-0 147.5,-24"/>
<text text-anchor="middle" x="119" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">pnpa_mc</text>
</g>
<!-- program~fidasim -->
<g id="proc~~pnpa_mc~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~pnpa_mc~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~pnpa_mc -->
<g id="proc~~pnpa_mc~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~pnpa_mc</title>
<path fill="none" stroke="#000000" d="M54.0317,-12C62.2408,-12 71.4806,-12 80.3316,-12"/>
<polygon fill="#000000" stroke="#000000" points="80.4582,-15.5001 90.4582,-12 80.4582,-8.5001 80.4582,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pnpa_mc.html#src">pnpa_mc</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">pnpa_mc</span>
    <span class="c">!+ Calculate Passive NPA flux using a Monte Carlo fast-ion distribution</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iion</span><span class="p">,</span><span class="n">igamma</span><span class="p">,</span><span class="n">ngamma</span><span class="p">,</span><span class="n">npart</span>
    <span class="k">type</span><span class="p">(</span><span class="n">FastIon</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fast_ion</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">phi</span><span class="p">,</span><span class="n">theta</span><span class="p">,</span><span class="n">dtheta</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ri</span><span class="p">,</span> <span class="n">rf</span><span class="p">,</span> <span class="n">rg</span><span class="p">,</span> <span class="n">vi</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">det</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">ichan</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">nrange</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="k">is</span>
<span class="k">    type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fields</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span> <span class="kd">::</span> <span class="n">plasma</span>
    <span class="k">type</span><span class="p">(</span><span class="n">GyroSurface</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gs</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rates</span><span class="p">,</span> <span class="n">rates_is</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">states</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">flux</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ind</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">uvw</span><span class="p">,</span> <span class="n">uvw_vi</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gyrange</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">s</span><span class="p">,</span><span class="n">c</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">randomu</span>

    <span class="n">ngamma</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">.</span><span class="nb">or</span><span class="p">.(</span><span class="n">inputs</span><span class="p">%</span><span class="n">dist_type</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">))</span> <span class="k">then</span>
<span class="k">        </span><span class="n">ngamma</span> <span class="o">=</span> <span class="nb">ceiling</span><span class="p">(</span><span class="nb">dble</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_pnpa</span><span class="p">)</span><span class="o">/</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="p">)</span>
    <span class="k">endif</span>

<span class="k">    if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i10)&#39;</span><span class="p">)</span> <span class="nb">int</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="o">*</span><span class="n">ngamma</span><span class="p">,</span><span class="n">Int64</span><span class="p">)</span>
    <span class="k">endif</span>

    <span class="c">!$OMP PARALLEL DO schedule(guided) private(iion,igamma,ind,fast_ion,vi,ri,rf,phi,s,c,ir,it,plasma, &amp;</span>
    <span class="c">!$OMP&amp; randomu,rg,fields,uvw,uvw_vi,rates,rates_is,is,states,flux,det,ichan,gs,nrange,gyrange,theta,dtheta)</span>
    <span class="n">loop_over_fast_ions</span><span class="p">:</span> <span class="k">do </span><span class="n">iion</span><span class="o">=</span><span class="n">istart</span><span class="p">,</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="p">,</span><span class="n">istep</span>
        <span class="n">fast_ion</span> <span class="o">=</span> <span class="n">particles</span><span class="p">%</span><span class="n">fast_ion</span><span class="p">(</span><span class="n">iion</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vabs</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">loop_over_fast_ions</span>
        <span class="n">gamma_loop</span><span class="p">:</span> <span class="k">do </span><span class="n">igamma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ngamma</span>
            <span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">)</span> <span class="k">then</span>
                <span class="c">!! Pick random toroidal angle</span>
                <span class="k">call </span><span class="n">randu</span><span class="p">(</span><span class="n">randomu</span><span class="p">)</span>
                <span class="n">phi</span> <span class="o">=</span> <span class="n">pass_grid</span><span class="p">%</span><span class="n">phi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">nphi</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dphi</span><span class="o">*</span><span class="n">randomu</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span>
<span class="k">                </span><span class="n">phi</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">phi</span>
            <span class="k">endif</span>
<span class="k">            </span><span class="n">s</span> <span class="o">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="nb">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>

            <span class="c">!! Calculate position in machine coordinates</span>
            <span class="n">uvw</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">c</span>
            <span class="n">uvw</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">s</span>
            <span class="n">uvw</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">z</span>

            <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">dist_type</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
                <span class="c">!! Get electomagnetic fields</span>
                <span class="k">call </span><span class="n">get_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">uvw</span><span class="p">,</span> <span class="n">input_coords</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

                <span class="c">!! Correct for gyro motion and get position and velocity</span>
                <span class="k">call </span><span class="n">gyro_surface</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">energy</span><span class="p">,</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">pitch</span><span class="p">,</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">A</span><span class="p">,</span> <span class="n">gs</span><span class="p">)</span>

                <span class="n">detector_loop</span><span class="p">:</span> <span class="k">do </span><span class="n">ichan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">npa_chords</span><span class="p">%</span><span class="n">nchan</span>
                    <span class="k">call </span><span class="n">npa_gyro_range</span><span class="p">(</span><span class="n">ichan</span><span class="p">,</span> <span class="n">gs</span><span class="p">,</span> <span class="n">gyrange</span><span class="p">,</span> <span class="n">nrange</span><span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">nrange</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">detector_loop</span>

                    <span class="n">gyro_range_loop</span><span class="p">:</span> <span class="k">do </span><span class="n">ir</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nrange</span>
                        <span class="n">dtheta</span> <span class="o">=</span> <span class="n">gyrange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span>
                        <span class="n">theta</span> <span class="o">=</span> <span class="n">gyrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dtheta</span>
                        <span class="k">call </span><span class="n">gyro_trajectory</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">)</span>

                        <span class="c">!! Check if particle hits a NPA detector</span>
                        <span class="k">call </span><span class="n">hit_npa_detector</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span> <span class="n">vi</span> <span class="p">,</span><span class="n">det</span><span class="p">,</span> <span class="n">rf</span><span class="p">,</span> <span class="n">det</span><span class="o">=</span><span class="n">ichan</span><span class="p">)</span>
                        <span class="k">if</span><span class="p">(</span><span class="n">det</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">ichan</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                            if</span> <span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="k">                                write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s2">&quot;PNPA_MC: Missed Detector &quot;</span><span class="p">,</span><span class="n">ichan</span>
                            <span class="k">endif</span>
<span class="k">                            cycle </span><span class="n">gyro_range_loop</span>
                        <span class="k">endif</span>

                        <span class="c">!! Calculate CX probability with beam and halo neutrals</span>
                        <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">)</span>
                        <span class="n">rates</span> <span class="o">=</span> <span class="mf">0.d0</span>
                        <span class="k">do is</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n_thermal</span>
                            <span class="k">call </span><span class="n">bt_cx_rates</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span> <span class="n">plasma</span><span class="p">%</span><span class="n">denn</span><span class="p">(:,</span><span class="k">is</span><span class="p">),</span> <span class="n">thermal_mass</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="n">vi</span><span class="p">,</span> <span class="n">rates_is</span><span class="p">)</span>
                            <span class="n">rates</span> <span class="o">=</span> <span class="n">rates</span> <span class="o">+</span> <span class="n">rates_is</span>
                        <span class="k">enddo</span>
<span class="k">                        if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span> <span class="k">cycle </span><span class="n">gyro_range_loop</span>

                        <span class="c">!! Weight CX rates by ion source density</span>
                        <span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                            </span><span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">weight</span><span class="o">*</span><span class="p">(</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">nphi</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dphi</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span> <span class="p">&amp;</span>
                                   <span class="o">/</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dv</span><span class="p">)</span><span class="o">/</span><span class="n">ngamma</span>
                        <span class="k">else</span>
<span class="k">                            </span><span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">weight</span><span class="o">/</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dv</span><span class="p">)</span><span class="o">/</span><span class="n">ngamma</span>
                        <span class="k">endif</span>

                        <span class="c">!! Attenuate states as the particle move through plasma</span>
                        <span class="k">call </span><span class="n">attenuate</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">states</span><span class="p">)</span>

                        <span class="c">!! Store NPA Flux</span>
                        <span class="n">flux</span> <span class="o">=</span> <span class="p">(</span><span class="n">dtheta</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dv</span><span class="p">)</span>
                        <span class="n">spread_loop</span><span class="p">:</span> <span class="k">do </span><span class="n">it</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">25</span>
                            <span class="n">theta</span> <span class="o">=</span> <span class="n">gyrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">it</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">dtheta</span><span class="o">/</span><span class="mi">25</span>
                            <span class="k">call </span><span class="n">gyro_trajectory</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">)</span>
                            <span class="k">call </span><span class="n">hit_npa_detector</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span> <span class="n">vi</span> <span class="p">,</span><span class="n">det</span><span class="p">,</span> <span class="n">rf</span><span class="p">,</span> <span class="n">det</span><span class="o">=</span><span class="n">ichan</span><span class="p">)</span>
                            <span class="k">if</span><span class="p">(</span><span class="n">det</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">ichan</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                                if</span> <span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="k">                                    write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s2">&quot;PNPA_MC: Missed Detector &quot;</span><span class="p">,</span><span class="n">ichan</span>
                                <span class="k">endif</span>
<span class="k">                                cycle </span><span class="n">spread_loop</span>
                            <span class="k">endif</span>
<span class="k">                            call </span><span class="n">store_npa</span><span class="p">(</span><span class="n">det</span><span class="p">,</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">flux</span><span class="o">/</span><span class="mi">25</span><span class="p">,</span><span class="n">fast_ion</span><span class="p">%</span><span class="k">class</span><span class="p">,</span> <span class="n">passive</span><span class="o">=</span><span class="p">.</span><span class="n">True</span><span class="p">.)</span>
                        <span class="k">enddo </span><span class="n">spread_loop</span>
                    <span class="k">enddo </span><span class="n">gyro_range_loop</span>
                <span class="k">enddo </span><span class="n">detector_loop</span>
            <span class="k">else</span> <span class="c">!! Full Orbit</span>
                <span class="c">!! Convert to beam grid coordinates</span>
                <span class="k">call </span><span class="n">uvw_to_xyz</span><span class="p">(</span><span class="n">uvw</span><span class="p">,</span> <span class="n">ri</span><span class="p">)</span>

                <span class="c">!! Calculate velocity vector</span>
                <span class="n">uvw_vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vr</span> <span class="o">-</span> <span class="n">s</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vt</span>
                <span class="n">uvw_vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vr</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vt</span>
                <span class="n">uvw_vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">vz</span>
                <span class="n">vi</span> <span class="o">=</span> <span class="nb">matmul</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">inv_basis</span><span class="p">,</span><span class="n">uvw_vi</span><span class="p">)</span>

                <span class="c">!! Check if particle hits a NPA detector</span>
                <span class="k">call </span><span class="n">hit_npa_detector</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span> <span class="n">vi</span> <span class="p">,</span><span class="n">det</span><span class="p">,</span> <span class="n">rf</span><span class="p">)</span>
                <span class="k">if</span><span class="p">(</span><span class="n">det</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">gamma_loop</span>

                <span class="c">!! Calculate CX probability with edge neutrals</span>
                <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">)</span>
                <span class="n">rates</span> <span class="o">=</span> <span class="mf">0.d0</span>
                <span class="k">do is</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_thermal</span>
                    <span class="k">call </span><span class="n">bt_cx_rates</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span> <span class="n">plasma</span><span class="p">%</span><span class="n">denn</span><span class="p">(:,</span><span class="k">is</span><span class="p">),</span> <span class="n">thermal_mass</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="n">vi</span><span class="p">,</span> <span class="n">rates_is</span><span class="p">)</span>
                    <span class="n">rates</span> <span class="o">=</span> <span class="n">rates</span> <span class="o">+</span> <span class="n">rates_is</span>
                <span class="k">enddo</span>
<span class="k">                if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rates</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span> <span class="k">cycle </span><span class="n">gamma_loop</span>

                <span class="c">!! Weight CX rates by ion source density</span>
                <span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">axisym</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                    </span><span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">weight</span><span class="o">*</span><span class="p">(</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">nphi</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dphi</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span> <span class="p">&amp;</span>
                           <span class="o">/</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dv</span><span class="p">)</span><span class="o">/</span><span class="n">ngamma</span>
                <span class="k">else</span>
<span class="k">                    </span><span class="n">states</span><span class="o">=</span><span class="n">rates</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">weight</span><span class="o">/</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dv</span><span class="p">)</span><span class="o">/</span><span class="n">ngamma</span>
                <span class="k">endif</span>

                <span class="c">!! Attenuate states as the particle moves though plasma</span>
                <span class="k">call </span><span class="n">attenuate</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">states</span><span class="p">)</span>

                <span class="c">!! Store NPA Flux</span>
                <span class="n">flux</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">pass_grid</span><span class="p">%</span><span class="n">dv</span><span class="p">)</span>
                <span class="k">call </span><span class="n">store_npa</span><span class="p">(</span><span class="n">det</span><span class="p">,</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">flux</span><span class="p">,</span><span class="n">fast_ion</span><span class="p">%</span><span class="k">class</span><span class="p">,</span><span class="n">passive</span><span class="o">=</span><span class="p">.</span><span class="n">True</span><span class="p">.)</span>
            <span class="k">endif</span>
<span class="k">        enddo </span><span class="n">gamma_loop</span>
    <span class="k">enddo </span><span class="n">loop_over_fast_ions</span>
    <span class="c">!$OMP END PARALLEL DO</span>

    <span class="n">npart</span> <span class="o">=</span> <span class="n">pnpa</span><span class="p">%</span><span class="n">npart</span>
<span class="cp">#ifdef _MPI</span>
    <span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">npart</span><span class="p">)</span>
    <span class="k">call </span><span class="n">parallel_sum</span><span class="p">(</span><span class="n">pnpa</span><span class="p">%</span><span class="n">flux</span><span class="p">)</span>
<span class="cp">#endif</span>

    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T4,&quot;Number of Passive NPA particles that hit a detector: &quot;,i8)&#39;</span><span class="p">)</span> <span class="n">npart</span>
    <span class="k">endif</span>

<span class="k">end subroutine </span><span class="n">pnpa_mc</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>FIDASIM was developed by Luke Stagner<br>&copy; 2021 
                                          </p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            
            
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>