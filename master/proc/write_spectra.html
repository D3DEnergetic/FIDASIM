<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="Luke Stagner" >
    <link rel="icon" href="../favicon.png">

    <title>write_spectra &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>3.0.0-dev</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>write_spectra
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 1.3% of total for procedures.">169 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
    
     <li><a href='../module/libfida.html'>libfida</a></li>
    
  
     <li class="active">write_spectra</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/write_spectra.html#src">write_spectra</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine write_spectra()
    
    
   
</h2>
    
  


    
    <p>Writes <a href="../module/libfida.html#type-spectra">Spectra</a> to a HDF5 file</p>
    

    <h3>Arguments</h3>
    
    <em>None</em>
    <br>
    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~write_spectra~~CallsGraph Pages: 1 -->
<svg id="procwrite_spectraCallsGraph" width="641pt" height="429pt"
 viewBox="0.00 0.00 641.00 428.72" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~write_spectra~~CallsGraph" class="graph" transform="scale(0.832468 0.832468) rotate(0) translate(4 511)">
<title>proc~~write_spectra~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-511 766,-511 766,4 -4,4"/>
<!-- proc~write_spectra -->
<g id="proc~~write_spectra~~CallsGraph_node1" class="node"><title>proc~write_spectra</title>
<polygon fill="none" stroke="black" points="76,-150 0,-150 0,-126 76,-126 76,-150"/>
<text text-anchor="middle" x="38" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50">write_spectra</text>
</g>
<!-- interface~h5ltmake_compressed_dataset_double_f -->
<g id="proc~~write_spectra~~CallsGraph_node2" class="node"><title>interface~h5ltmake_compressed_dataset_double_f</title>
<g id="a_proc~~write_spectra~~CallsGraph_node2"><a xlink:href=".././interface/h5ltmake_compressed_dataset_double_f.html" xlink:title="h5ltmake_compressed_dataset_double_f">
<polygon fill="#a7506f" stroke="#a7506f" points="321.5,-276 112.5,-276 112.5,-252 321.5,-252 321.5,-276"/>
<text text-anchor="middle" x="217" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h5ltmake_compressed_dataset_double_f</text>
</a>
</g>
</g>
<!-- proc~write_spectra&#45;&gt;interface~h5ltmake_compressed_dataset_double_f -->
<g id="proc~~write_spectra~~CallsGraph_edge1" class="edge"><title>proc~write_spectra&#45;&gt;interface~h5ltmake_compressed_dataset_double_f</title>
<path fill="none" stroke="#000000" d="M43.7262,-150.018C53.124,-172.235 76.373,-219.594 112,-243 114.61,-244.715 117.33,-246.294 120.135,-247.749"/>
<polygon fill="#000000" stroke="#000000" points="118.799,-250.987 129.347,-251.985 121.723,-244.627 118.799,-250.987"/>
</g>
<!-- h5close_f -->
<g id="proc~~write_spectra~~CallsGraph_node3" class="node"><title>h5close_f</title>
<polygon fill="#777777" stroke="#777777" points="246,-234 188,-234 188,-210 246,-210 246,-234"/>
<text text-anchor="middle" x="217" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h5close_f</text>
</g>
<!-- proc~write_spectra&#45;&gt;h5close_f -->
<g id="proc~~write_spectra~~CallsGraph_edge3" class="edge"><title>proc~write_spectra&#45;&gt;h5close_f</title>
<path fill="none" stroke="#000000" d="M49.2974,-150.058C62.3581,-164.526 86.2938,-188.404 112,-201 132.424,-211.008 157.341,-216.247 177.665,-218.99"/>
<polygon fill="#000000" stroke="#000000" points="177.48,-222.492 187.826,-220.208 178.314,-215.542 177.48,-222.492"/>
</g>
<!-- h5fcreate_f -->
<g id="proc~~write_spectra~~CallsGraph_node4" class="node"><title>h5fcreate_f</title>
<polygon fill="#777777" stroke="#777777" points="250.5,-192 183.5,-192 183.5,-168 250.5,-168 250.5,-192"/>
<text text-anchor="middle" x="217" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h5fcreate_f</text>
</g>
<!-- proc~write_spectra&#45;&gt;h5fcreate_f -->
<g id="proc~~write_spectra~~CallsGraph_edge2" class="edge"><title>proc~write_spectra&#45;&gt;h5fcreate_f</title>
<path fill="none" stroke="#000000" d="M76.3569,-149.376C87.7484,-152.674 100.342,-156.151 112,-159 131.929,-163.87 154.202,-168.477 173.007,-172.129"/>
<polygon fill="#000000" stroke="#000000" points="172.581,-175.611 183.061,-174.055 173.898,-168.736 172.581,-175.611"/>
</g>
<!-- h5fclose_f -->
<g id="proc~~write_spectra~~CallsGraph_node5" class="node"><title>h5fclose_f</title>
<polygon fill="#777777" stroke="#777777" points="247.5,-150 186.5,-150 186.5,-126 247.5,-126 247.5,-150"/>
<text text-anchor="middle" x="217" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h5fclose_f</text>
</g>
<!-- proc~write_spectra&#45;&gt;h5fclose_f -->
<g id="proc~~write_spectra~~CallsGraph_edge4" class="edge"><title>proc~write_spectra&#45;&gt;h5fclose_f</title>
<path fill="none" stroke="#000000" d="M76.105,-138C105.395,-138 146.178,-138 176.155,-138"/>
<polygon fill="#000000" stroke="#000000" points="176.271,-141.5 186.271,-138 176.27,-134.5 176.271,-141.5"/>
</g>
<!-- h5ltset_attribute_string_f -->
<g id="proc~~write_spectra~~CallsGraph_node6" class="node"><title>h5ltset_attribute_string_f</title>
<polygon fill="#777777" stroke="#777777" points="282,-108 152,-108 152,-84 282,-84 282,-108"/>
<text text-anchor="middle" x="217" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h5ltset_attribute_string_f</text>
</g>
<!-- proc~write_spectra&#45;&gt;h5ltset_attribute_string_f -->
<g id="proc~~write_spectra~~CallsGraph_edge5" class="edge"><title>proc~write_spectra&#45;&gt;h5ltset_attribute_string_f</title>
<path fill="none" stroke="#000000" d="M76.3569,-126.624C87.7484,-123.326 100.342,-119.849 112,-117 121.831,-114.598 132.232,-112.259 142.506,-110.068"/>
<polygon fill="#000000" stroke="#000000" points="143.227,-113.493 152.295,-108.015 141.79,-106.642 143.227,-113.493"/>
</g>
<!-- h5open_f -->
<g id="proc~~write_spectra~~CallsGraph_node7" class="node"><title>h5open_f</title>
<polygon fill="#777777" stroke="#777777" points="246,-66 188,-66 188,-42 246,-42 246,-66"/>
<text text-anchor="middle" x="217" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h5open_f</text>
</g>
<!-- proc~write_spectra&#45;&gt;h5open_f -->
<g id="proc~~write_spectra~~CallsGraph_edge6" class="edge"><title>proc~write_spectra&#45;&gt;h5open_f</title>
<path fill="none" stroke="#000000" d="M49.2974,-125.942C62.3581,-111.474 86.2938,-87.5963 112,-75 132.424,-64.992 157.341,-59.7528 177.665,-57.0105"/>
<polygon fill="#000000" stroke="#000000" points="178.314,-60.4578 187.826,-55.792 177.48,-53.5076 178.314,-60.4578"/>
</g>
<!-- h5ltmake_dataset_int_f -->
<g id="proc~~write_spectra~~CallsGraph_node8" class="node"><title>h5ltmake_dataset_int_f</title>
<polygon fill="#777777" stroke="#777777" points="279,-24 155,-24 155,-0 279,-0 279,-24"/>
<text text-anchor="middle" x="217" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h5ltmake_dataset_int_f</text>
</g>
<!-- proc~write_spectra&#45;&gt;h5ltmake_dataset_int_f -->
<g id="proc~~write_spectra~~CallsGraph_edge7" class="edge"><title>proc~write_spectra&#45;&gt;h5ltmake_dataset_int_f</title>
<path fill="none" stroke="#000000" d="M43.7262,-125.982C53.124,-103.765 76.373,-56.4058 112,-33 121.922,-26.4812 133.441,-21.9138 145.123,-18.7283"/>
<polygon fill="#000000" stroke="#000000" points="146.039,-22.1078 154.943,-16.365 144.401,-15.3021 146.039,-22.1078"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_6 -->
<g id="proc~~write_spectra~~CallsGraph_node9" class="node"><title>proc~h5ltmake_compressed_dataset_double_f_6</title>
<g id="a_proc~~write_spectra~~CallsGraph_node9"><a xlink:href=".././proc/h5ltmake_compressed_dataset_double_f_6.html" xlink:title="h5ltmake_compressed_dataset_double_f_6">
<polygon fill="#d9534f" stroke="#d9534f" points="579.5,-150 358.5,-150 358.5,-126 579.5,-126 579.5,-150"/>
<text text-anchor="middle" x="469" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h5ltmake_compressed_dataset_double_f_6</text>
</a>
</g>
</g>
<!-- interface~h5ltmake_compressed_dataset_double_f&#45;&gt;proc~h5ltmake_compressed_dataset_double_f_6 -->
<g id="proc~~write_spectra~~CallsGraph_edge8" class="edge"><title>interface~h5ltmake_compressed_dataset_double_f&#45;&gt;proc~h5ltmake_compressed_dataset_double_f_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M308.025,-251.948C313.001,-249.443 317.712,-246.486 322,-243 353.517,-217.379 326.347,-184.454 358,-159 359.619,-157.698 361.295,-156.468 363.02,-155.306"/>
<polygon fill="#000000" stroke="#000000" points="365.148,-158.117 372.017,-150.05 361.617,-152.072 365.148,-158.117"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_3 -->
<g id="proc~~write_spectra~~CallsGraph_node10" class="node"><title>proc~h5ltmake_compressed_dataset_double_f_3</title>
<g id="a_proc~~write_spectra~~CallsGraph_node10"><a xlink:href=".././proc/h5ltmake_compressed_dataset_double_f_3.html" xlink:title="h5ltmake_compressed_dataset_double_f_3">
<polygon fill="#d9534f" stroke="#d9534f" points="579.5,-402 358.5,-402 358.5,-378 579.5,-378 579.5,-402"/>
<text text-anchor="middle" x="469" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h5ltmake_compressed_dataset_double_f_3</text>
</a>
</g>
</g>
<!-- interface~h5ltmake_compressed_dataset_double_f&#45;&gt;proc~h5ltmake_compressed_dataset_double_f_3 -->
<g id="proc~~write_spectra~~CallsGraph_edge9" class="edge"><title>interface~h5ltmake_compressed_dataset_double_f&#45;&gt;proc~h5ltmake_compressed_dataset_double_f_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M230.228,-276.334C253.114,-298.641 304.921,-345.546 358,-369 363.002,-371.21 368.232,-373.188 373.58,-374.958"/>
<polygon fill="#000000" stroke="#000000" points="372.725,-378.356 383.311,-377.925 374.767,-371.661 372.725,-378.356"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_2 -->
<g id="proc~~write_spectra~~CallsGraph_node11" class="node"><title>proc~h5ltmake_compressed_dataset_double_f_2</title>
<g id="a_proc~~write_spectra~~CallsGraph_node11"><a xlink:href=".././proc/h5ltmake_compressed_dataset_double_f_2.html" xlink:title="h5ltmake_compressed_dataset_double_f_2">
<polygon fill="#d9534f" stroke="#d9534f" points="579.5,-360 358.5,-360 358.5,-336 579.5,-336 579.5,-360"/>
<text text-anchor="middle" x="469" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h5ltmake_compressed_dataset_double_f_2</text>
</a>
</g>
</g>
<!-- interface~h5ltmake_compressed_dataset_double_f&#45;&gt;proc~h5ltmake_compressed_dataset_double_f_2 -->
<g id="proc~~write_spectra~~CallsGraph_edge10" class="edge"><title>interface~h5ltmake_compressed_dataset_double_f&#45;&gt;proc~h5ltmake_compressed_dataset_double_f_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M240.634,-276.185C267.791,-290.329 315.045,-313.442 358,-327 365.862,-329.482 374.138,-331.717 382.475,-333.721"/>
<polygon fill="#000000" stroke="#000000" points="381.739,-337.143 392.268,-335.966 383.304,-330.32 381.739,-337.143"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_4 -->
<g id="proc~~write_spectra~~CallsGraph_node12" class="node"><title>proc~h5ltmake_compressed_dataset_double_f_4</title>
<g id="a_proc~~write_spectra~~CallsGraph_node12"><a xlink:href=".././proc/h5ltmake_compressed_dataset_double_f_4.html" xlink:title="h5ltmake_compressed_dataset_double_f_4">
<polygon fill="#d9534f" stroke="#d9534f" points="579.5,-318 358.5,-318 358.5,-294 579.5,-294 579.5,-318"/>
<text text-anchor="middle" x="469" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h5ltmake_compressed_dataset_double_f_4</text>
</a>
</g>
</g>
<!-- interface~h5ltmake_compressed_dataset_double_f&#45;&gt;proc~h5ltmake_compressed_dataset_double_f_4 -->
<g id="proc~~write_spectra~~CallsGraph_edge11" class="edge"><title>interface~h5ltmake_compressed_dataset_double_f&#45;&gt;proc~h5ltmake_compressed_dataset_double_f_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M289.64,-276.036C319.845,-281.11 355.168,-287.044 386.374,-292.287"/>
<polygon fill="#000000" stroke="#000000" points="385.908,-295.757 396.35,-293.963 387.068,-288.854 385.908,-295.757"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_1 -->
<g id="proc~~write_spectra~~CallsGraph_node13" class="node"><title>proc~h5ltmake_compressed_dataset_double_f_1</title>
<g id="a_proc~~write_spectra~~CallsGraph_node13"><a xlink:href=".././proc/h5ltmake_compressed_dataset_double_f_1.html" xlink:title="h5ltmake_compressed_dataset_double_f_1">
<polygon fill="#d9534f" stroke="#d9534f" points="579.5,-276 358.5,-276 358.5,-252 579.5,-252 579.5,-276"/>
<text text-anchor="middle" x="469" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h5ltmake_compressed_dataset_double_f_1</text>
</a>
</g>
</g>
<!-- interface~h5ltmake_compressed_dataset_double_f&#45;&gt;proc~h5ltmake_compressed_dataset_double_f_1 -->
<g id="proc~~write_spectra~~CallsGraph_edge12" class="edge"><title>interface~h5ltmake_compressed_dataset_double_f&#45;&gt;proc~h5ltmake_compressed_dataset_double_f_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M321.851,-264C330.529,-264 339.347,-264 348.131,-264"/>
<polygon fill="#000000" stroke="#000000" points="348.417,-267.5 358.417,-264 348.417,-260.5 348.417,-267.5"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_5 -->
<g id="proc~~write_spectra~~CallsGraph_node14" class="node"><title>proc~h5ltmake_compressed_dataset_double_f_5</title>
<g id="a_proc~~write_spectra~~CallsGraph_node14"><a xlink:href=".././proc/h5ltmake_compressed_dataset_double_f_5.html" xlink:title="h5ltmake_compressed_dataset_double_f_5">
<polygon fill="#d9534f" stroke="#d9534f" points="579.5,-234 358.5,-234 358.5,-210 579.5,-210 579.5,-234"/>
<text text-anchor="middle" x="469" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h5ltmake_compressed_dataset_double_f_5</text>
</a>
</g>
</g>
<!-- interface~h5ltmake_compressed_dataset_double_f&#45;&gt;proc~h5ltmake_compressed_dataset_double_f_5 -->
<g id="proc~~write_spectra~~CallsGraph_edge13" class="edge"><title>interface~h5ltmake_compressed_dataset_double_f&#45;&gt;proc~h5ltmake_compressed_dataset_double_f_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M289.64,-251.964C319.845,-246.89 355.168,-240.956 386.374,-235.713"/>
<polygon fill="#000000" stroke="#000000" points="387.068,-239.146 396.35,-234.037 385.908,-232.243 387.068,-239.146"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_7 -->
<g id="proc~~write_spectra~~CallsGraph_node15" class="node"><title>proc~h5ltmake_compressed_dataset_double_f_7</title>
<g id="a_proc~~write_spectra~~CallsGraph_node15"><a xlink:href=".././proc/h5ltmake_compressed_dataset_double_f_7.html" xlink:title="h5ltmake_compressed_dataset_double_f_7">
<polygon fill="#d9534f" stroke="#d9534f" points="579.5,-192 358.5,-192 358.5,-168 579.5,-168 579.5,-192"/>
<text text-anchor="middle" x="469" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h5ltmake_compressed_dataset_double_f_7</text>
</a>
</g>
</g>
<!-- interface~h5ltmake_compressed_dataset_double_f&#45;&gt;proc~h5ltmake_compressed_dataset_double_f_7 -->
<g id="proc~~write_spectra~~CallsGraph_edge14" class="edge"><title>interface~h5ltmake_compressed_dataset_double_f&#45;&gt;proc~h5ltmake_compressed_dataset_double_f_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M302.673,-251.958C309.427,-249.497 315.963,-246.543 322,-243 343.204,-230.556 336.731,-213.331 358,-201 361.217,-199.135 364.567,-197.432 368.012,-195.876"/>
<polygon fill="#000000" stroke="#000000" points="369.381,-199.098 377.33,-192.093 366.748,-192.612 369.381,-199.098"/>
</g>
<!-- h5sclose_f -->
<g id="proc~~write_spectra~~CallsGraph_node16" class="node"><title>h5sclose_f</title>
<polygon fill="#777777" stroke="#777777" points="721,-255 657,-255 657,-231 721,-231 721,-255"/>
<text text-anchor="middle" x="689" y="-240.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h5sclose_f</text>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_6&#45;&gt;h5sclose_f -->
<g id="proc~~write_spectra~~CallsGraph_edge15" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_6&#45;&gt;h5sclose_f</title>
<path fill="none" stroke="#000000" d="M564.185,-150.034C569.765,-152.535 575.095,-155.497 580,-159 606.244,-177.742 590.677,-202.031 616,-222 624.924,-229.037 636.132,-233.717 647.03,-236.828"/>
<polygon fill="#000000" stroke="#000000" points="646.328,-240.26 656.876,-239.268 648.011,-233.466 646.328,-240.26"/>
</g>
<!-- h5dclose_f -->
<g id="proc~~write_spectra~~CallsGraph_node17" class="node"><title>h5dclose_f</title>
<polygon fill="#777777" stroke="#777777" points="721,-213 657,-213 657,-189 721,-189 721,-213"/>
<text text-anchor="middle" x="689" y="-198.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h5dclose_f</text>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_6&#45;&gt;h5dclose_f -->
<g id="proc~~write_spectra~~CallsGraph_edge16" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_6&#45;&gt;h5dclose_f</title>
<path fill="none" stroke="#000000" d="M550.486,-150.069C560.568,-152.539 570.623,-155.488 580,-159 597.347,-165.497 598.982,-172.686 616,-180 625.881,-184.247 636.882,-187.94 647.251,-190.994"/>
<polygon fill="#000000" stroke="#000000" points="646.367,-194.381 656.942,-193.723 648.265,-187.643 646.367,-194.381"/>
</g>
<!-- h5dcreate_f -->
<g id="proc~~write_spectra~~CallsGraph_node18" class="node"><title>h5dcreate_f</title>
<polygon fill="#777777" stroke="#777777" points="724,-171 654,-171 654,-147 724,-147 724,-171"/>
<text text-anchor="middle" x="689" y="-156.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h5dcreate_f</text>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_6&#45;&gt;h5dcreate_f -->
<g id="proc~~write_spectra~~CallsGraph_edge17" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_6&#45;&gt;h5dcreate_f</title>
<path fill="none" stroke="#000000" d="M579.639,-148.562C602.257,-150.74 624.838,-152.916 643.487,-154.712"/>
<polygon fill="#000000" stroke="#000000" points="643.41,-158.221 653.7,-155.696 644.081,-151.253 643.41,-158.221"/>
</g>
<!-- h5screate_simple_f -->
<g id="proc~~write_spectra~~CallsGraph_node19" class="node"><title>h5screate_simple_f</title>
<polygon fill="#777777" stroke="#777777" points="742,-129 636,-129 636,-105 742,-105 742,-129"/>
<text text-anchor="middle" x="689" y="-114.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h5screate_simple_f</text>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_6&#45;&gt;h5screate_simple_f -->
<g id="proc~~write_spectra~~CallsGraph_edge18" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_6&#45;&gt;h5screate_simple_f</title>
<path fill="none" stroke="#000000" d="M579.639,-127.438C595.423,-125.918 611.189,-124.399 625.613,-123.01"/>
<polygon fill="#000000" stroke="#000000" points="626.242,-126.465 635.86,-122.023 625.571,-119.498 626.242,-126.465"/>
</g>
<!-- h5pset_deflate_f -->
<g id="proc~~write_spectra~~CallsGraph_node20" class="node"><title>h5pset_deflate_f</title>
<polygon fill="#777777" stroke="#777777" points="735,-87 643,-87 643,-63 735,-63 735,-87"/>
<text text-anchor="middle" x="689" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h5pset_deflate_f</text>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_6&#45;&gt;h5pset_deflate_f -->
<g id="proc~~write_spectra~~CallsGraph_edge19" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_6&#45;&gt;h5pset_deflate_f</title>
<path fill="none" stroke="#000000" d="M511.775,-125.928C547.297,-115.662 598.448,-100.88 636.5,-89.8831"/>
<polygon fill="#000000" stroke="#000000" points="637.732,-93.1704 646.367,-87.0316 635.788,-86.4456 637.732,-93.1704"/>
</g>
<!-- h5ltmake_dataset_double_f -->
<g id="proc~~write_spectra~~CallsGraph_node21" class="node"><title>h5ltmake_dataset_double_f</title>
<polygon fill="#777777" stroke="#777777" points="761.5,-45 616.5,-45 616.5,-21 761.5,-21 761.5,-45"/>
<text text-anchor="middle" x="689" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h5ltmake_dataset_double_f</text>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_6&#45;&gt;h5ltmake_dataset_double_f -->
<g id="proc~~write_spectra~~CallsGraph_edge20" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_6&#45;&gt;h5ltmake_dataset_double_f</title>
<path fill="none" stroke="#000000" d="M487.714,-125.939C514.486,-108.152 567.309,-74.7553 616,-54 620.744,-51.9776 625.744,-50.0783 630.807,-48.3124"/>
<polygon fill="#000000" stroke="#000000" points="632.175,-51.5467 640.57,-45.0837 629.977,-44.9007 632.175,-51.5467"/>
</g>
<!-- h5pset_shuffle_f -->
<g id="proc~~write_spectra~~CallsGraph_node22" class="node"><title>h5pset_shuffle_f</title>
<polygon fill="#777777" stroke="#777777" points="734.5,-507 643.5,-507 643.5,-483 734.5,-483 734.5,-507"/>
<text text-anchor="middle" x="689" y="-492.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h5pset_shuffle_f</text>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_6&#45;&gt;h5pset_shuffle_f -->
<g id="proc~~write_spectra~~CallsGraph_edge21" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_6&#45;&gt;h5pset_shuffle_f</title>
<path fill="none" stroke="#000000" d="M569.461,-150.053C573.281,-152.616 576.826,-155.579 580,-159 675.842,-262.298 525.18,-366.261 616,-474 620.789,-479.681 627.02,-483.873 633.813,-486.957"/>
<polygon fill="#000000" stroke="#000000" points="632.748,-490.295 643.341,-490.512 635.195,-483.737 632.748,-490.295"/>
</g>
<!-- h5pcreate_f -->
<g id="proc~~write_spectra~~CallsGraph_node23" class="node"><title>h5pcreate_f</title>
<polygon fill="#777777" stroke="#777777" points="724,-465 654,-465 654,-441 724,-441 724,-465"/>
<text text-anchor="middle" x="689" y="-450.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h5pcreate_f</text>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_6&#45;&gt;h5pcreate_f -->
<g id="proc~~write_spectra~~CallsGraph_edge22" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_6&#45;&gt;h5pcreate_f</title>
<path fill="none" stroke="#000000" d="M569.389,-150.121C573.227,-152.666 576.797,-155.607 580,-159 664.014,-247.991 536.314,-339.114 616,-432 623.205,-440.399 633.561,-445.535 644.182,-448.65"/>
<polygon fill="#000000" stroke="#000000" points="643.388,-452.059 653.928,-450.978 645.014,-445.251 643.388,-452.059"/>
</g>
<!-- proc~chunk_size -->
<g id="proc~~write_spectra~~CallsGraph_node24" class="node"><title>proc~chunk_size</title>
<g id="a_proc~~write_spectra~~CallsGraph_node24"><a xlink:href=".././proc/chunk_size.html" xlink:title="chunk_size">
<polygon fill="#d9534f" stroke="#d9534f" points="722,-423 656,-423 656,-399 722,-399 722,-423"/>
<text text-anchor="middle" x="689" y="-408.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">chunk_size</text>
</a>
</g>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_6&#45;&gt;proc~chunk_size -->
<g id="proc~~write_spectra~~CallsGraph_edge23" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_6&#45;&gt;proc~chunk_size</title>
<path fill="none" stroke="#000000" d="M569.291,-150.214C573.156,-152.734 576.757,-155.645 580,-159 652.212,-233.712 547.423,-311.938 616,-390 623.71,-398.777 634.859,-403.981 646.09,-407.038"/>
<polygon fill="#000000" stroke="#000000" points="645.376,-410.465 655.896,-409.209 646.889,-403.63 645.376,-410.465"/>
</g>
<!-- h5pclose_f -->
<g id="proc~~write_spectra~~CallsGraph_node25" class="node"><title>h5pclose_f</title>
<polygon fill="#777777" stroke="#777777" points="721,-381 657,-381 657,-357 721,-357 721,-381"/>
<text text-anchor="middle" x="689" y="-366.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h5pclose_f</text>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_6&#45;&gt;h5pclose_f -->
<g id="proc~~write_spectra~~CallsGraph_edge24" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_6&#45;&gt;h5pclose_f</title>
<path fill="none" stroke="#000000" d="M568.664,-150.041C572.75,-152.596 576.564,-155.562 580,-159 640.452,-219.477 558.492,-284.716 616,-348 623.992,-356.795 635.437,-361.988 646.856,-365.029"/>
<polygon fill="#000000" stroke="#000000" points="646.283,-368.486 656.798,-367.185 647.767,-361.645 646.283,-368.486"/>
</g>
<!-- h5pset_chunk_f -->
<g id="proc~~write_spectra~~CallsGraph_node26" class="node"><title>h5pset_chunk_f</title>
<polygon fill="#777777" stroke="#777777" points="733,-339 645,-339 645,-315 733,-315 733,-339"/>
<text text-anchor="middle" x="689" y="-324.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h5pset_chunk_f</text>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_6&#45;&gt;h5pset_chunk_f -->
<g id="proc~~write_spectra~~CallsGraph_edge25" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_6&#45;&gt;h5pset_chunk_f</title>
<path fill="none" stroke="#000000" d="M568.449,-150.262C572.591,-152.759 576.476,-155.653 580,-159 628.772,-205.322 569.486,-257.411 616,-306 621.262,-311.496 627.873,-315.578 634.944,-318.604"/>
<polygon fill="#000000" stroke="#000000" points="634.192,-322.051 644.786,-322.11 636.54,-315.457 634.192,-322.051"/>
</g>
<!-- h5dwrite_f -->
<g id="proc~~write_spectra~~CallsGraph_node27" class="node"><title>h5dwrite_f</title>
<polygon fill="#777777" stroke="#777777" points="720,-297 658,-297 658,-273 720,-273 720,-297"/>
<text text-anchor="middle" x="689" y="-282.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h5dwrite_f</text>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_6&#45;&gt;h5dwrite_f -->
<g id="proc~~write_spectra~~CallsGraph_edge26" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_6&#45;&gt;h5dwrite_f</title>
<path fill="none" stroke="#000000" d="M567.068,-150.091C571.682,-152.612 576.035,-155.56 580,-159 617.265,-191.328 580.314,-229.937 616,-264 624.669,-272.275 636.411,-277.314 647.896,-280.375"/>
<polygon fill="#000000" stroke="#000000" points="647.318,-283.831 657.839,-282.587 648.838,-276.999 647.318,-283.831"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_3&#45;&gt;h5sclose_f -->
<g id="proc~~write_spectra~~CallsGraph_edge27" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_3&#45;&gt;h5sclose_f</title>
<path fill="none" stroke="#000000" d="M567.068,-377.909C571.682,-375.388 576.035,-372.44 580,-369 617.265,-336.672 580.314,-298.063 616,-264 624.365,-256.015 635.592,-251.043 646.687,-247.955"/>
<polygon fill="#000000" stroke="#000000" points="647.807,-251.288 656.755,-245.615 646.222,-244.469 647.807,-251.288"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_3&#45;&gt;h5dclose_f -->
<g id="proc~~write_spectra~~CallsGraph_edge28" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_3&#45;&gt;h5dclose_f</title>
<path fill="none" stroke="#000000" d="M568.449,-377.738C572.591,-375.241 576.476,-372.347 580,-369 628.772,-322.678 569.486,-270.589 616,-222 624.148,-213.489 635.532,-208.37 646.846,-205.31"/>
<polygon fill="#000000" stroke="#000000" points="647.689,-208.708 656.688,-203.117 646.166,-201.876 647.689,-208.708"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_3&#45;&gt;h5dcreate_f -->
<g id="proc~~write_spectra~~CallsGraph_edge29" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_3&#45;&gt;h5dcreate_f</title>
<path fill="none" stroke="#000000" d="M568.664,-377.959C572.75,-375.404 576.564,-372.438 580,-369 640.452,-308.523 558.492,-243.284 616,-180 623.3,-171.967 633.48,-166.939 643.89,-163.811"/>
<polygon fill="#000000" stroke="#000000" points="644.982,-167.146 653.855,-161.357 643.309,-160.349 644.982,-167.146"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_3&#45;&gt;h5screate_simple_f -->
<g id="proc~~write_spectra~~CallsGraph_edge30" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_3&#45;&gt;h5screate_simple_f</title>
<path fill="none" stroke="#000000" d="M569.291,-377.786C573.156,-375.266 576.757,-372.355 580,-369 652.212,-294.288 547.423,-216.062 616,-138 619.08,-134.494 622.709,-131.558 626.673,-129.101"/>
<polygon fill="#000000" stroke="#000000" points="628.48,-132.109 635.803,-124.452 625.304,-125.871 628.48,-132.109"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_3&#45;&gt;h5pset_deflate_f -->
<g id="proc~~write_spectra~~CallsGraph_edge31" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_3&#45;&gt;h5pset_deflate_f</title>
<path fill="none" stroke="#000000" d="M569.389,-377.879C573.227,-375.334 576.797,-372.393 580,-369 664.014,-280.009 536.314,-188.886 616,-96 620.614,-90.6218 626.52,-86.5811 632.96,-83.5525"/>
<polygon fill="#000000" stroke="#000000" points="634.619,-86.6643 642.69,-79.8013 632.101,-80.1329 634.619,-86.6643"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_3&#45;&gt;h5ltmake_dataset_double_f -->
<g id="proc~~write_spectra~~CallsGraph_edge32" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_3&#45;&gt;h5ltmake_dataset_double_f</title>
<path fill="none" stroke="#000000" d="M569.461,-377.947C573.281,-375.384 576.826,-372.421 580,-369 675.842,-265.702 525.18,-161.739 616,-54 616.734,-53.1289 617.503,-52.2928 618.302,-51.4903"/>
<polygon fill="#000000" stroke="#000000" points="620.616,-54.1207 626.237,-45.1393 616.242,-48.6556 620.616,-54.1207"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_3&#45;&gt;h5pset_shuffle_f -->
<g id="proc~~write_spectra~~CallsGraph_edge33" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_3&#45;&gt;h5pset_shuffle_f</title>
<path fill="none" stroke="#000000" d="M487.714,-402.061C514.486,-419.848 567.309,-453.245 616,-474 621.525,-476.355 627.396,-478.543 633.31,-480.548"/>
<polygon fill="#000000" stroke="#000000" points="632.657,-484.015 643.248,-483.746 634.801,-477.351 632.657,-484.015"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_3&#45;&gt;h5pcreate_f -->
<g id="proc~~write_spectra~~CallsGraph_edge34" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_3&#45;&gt;h5pcreate_f</title>
<path fill="none" stroke="#000000" d="M511.775,-402.072C549.681,-413.027 605.382,-429.124 643.973,-440.277"/>
<polygon fill="#000000" stroke="#000000" points="643.306,-443.727 653.884,-443.141 645.249,-437.002 643.306,-443.727"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_3&#45;&gt;proc~chunk_size -->
<g id="proc~~write_spectra~~CallsGraph_edge35" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_3&#45;&gt;proc~chunk_size</title>
<path fill="none" stroke="#000000" d="M579.639,-400.562C603.077,-402.819 626.477,-405.073 645.501,-406.906"/>
<polygon fill="#000000" stroke="#000000" points="645.304,-410.403 655.593,-407.878 645.975,-403.435 645.304,-410.403"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_3&#45;&gt;h5pclose_f -->
<g id="proc~~write_spectra~~CallsGraph_edge36" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_3&#45;&gt;h5pclose_f</title>
<path fill="none" stroke="#000000" d="M579.639,-379.438C603.614,-377.129 627.549,-374.823 646.802,-372.969"/>
<polygon fill="#000000" stroke="#000000" points="647.368,-376.43 656.987,-371.988 646.697,-369.463 647.368,-376.43"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_3&#45;&gt;h5pset_chunk_f -->
<g id="proc~~write_spectra~~CallsGraph_edge37" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_3&#45;&gt;h5pset_chunk_f</title>
<path fill="none" stroke="#000000" d="M550.486,-377.931C560.568,-375.461 570.623,-372.512 580,-369 597.347,-362.503 598.982,-355.314 616,-348 622.108,-345.375 628.645,-342.961 635.195,-340.779"/>
<polygon fill="#000000" stroke="#000000" points="636.278,-344.108 644.754,-337.751 634.164,-337.435 636.278,-344.108"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_3&#45;&gt;h5dwrite_f -->
<g id="proc~~write_spectra~~CallsGraph_edge38" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_3&#45;&gt;h5dwrite_f</title>
<path fill="none" stroke="#000000" d="M564.185,-377.966C569.765,-375.465 575.095,-372.503 580,-369 606.244,-350.258 590.677,-325.969 616,-306 625.159,-298.778 636.724,-294.039 647.889,-290.929"/>
<polygon fill="#000000" stroke="#000000" points="649.048,-294.25 657.951,-288.507 647.41,-287.445 649.048,-294.25"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_2&#45;&gt;h5sclose_f -->
<g id="proc~~write_spectra~~CallsGraph_edge39" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_2&#45;&gt;h5sclose_f</title>
<path fill="none" stroke="#000000" d="M564.185,-335.966C569.765,-333.465 575.095,-330.503 580,-327 606.244,-308.258 590.677,-283.969 616,-264 624.924,-256.963 636.132,-252.283 647.03,-249.172"/>
<polygon fill="#000000" stroke="#000000" points="648.011,-252.534 656.876,-246.732 646.328,-245.74 648.011,-252.534"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_2&#45;&gt;h5dclose_f -->
<g id="proc~~write_spectra~~CallsGraph_edge40" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_2&#45;&gt;h5dclose_f</title>
<path fill="none" stroke="#000000" d="M567.068,-335.909C571.682,-333.388 576.035,-330.44 580,-327 617.265,-294.672 580.314,-256.063 616,-222 624.365,-214.015 635.592,-209.043 646.687,-205.955"/>
<polygon fill="#000000" stroke="#000000" points="647.807,-209.288 656.755,-203.615 646.222,-202.469 647.807,-209.288"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_2&#45;&gt;h5dcreate_f -->
<g id="proc~~write_spectra~~CallsGraph_edge41" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_2&#45;&gt;h5dcreate_f</title>
<path fill="none" stroke="#000000" d="M568.449,-335.738C572.591,-333.241 576.476,-330.347 580,-327 628.772,-280.678 569.486,-228.589 616,-180 623.438,-172.231 633.571,-167.289 643.887,-164.159"/>
<polygon fill="#000000" stroke="#000000" points="644.906,-167.511 653.752,-161.679 643.2,-160.723 644.906,-167.511"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_2&#45;&gt;h5screate_simple_f -->
<g id="proc~~write_spectra~~CallsGraph_edge42" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_2&#45;&gt;h5screate_simple_f</title>
<path fill="none" stroke="#000000" d="M568.664,-335.959C572.75,-333.404 576.564,-330.438 580,-327 640.452,-266.523 558.492,-201.284 616,-138 619.139,-134.546 622.81,-131.647 626.803,-129.217"/>
<polygon fill="#000000" stroke="#000000" points="628.613,-132.225 635.978,-124.608 625.47,-125.969 628.613,-132.225"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_2&#45;&gt;h5pset_deflate_f -->
<g id="proc~~write_spectra~~CallsGraph_edge43" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_2&#45;&gt;h5pset_deflate_f</title>
<path fill="none" stroke="#000000" d="M569.291,-335.786C573.156,-333.266 576.757,-330.355 580,-327 652.212,-252.288 547.423,-174.062 616,-96 620.677,-90.6763 626.619,-86.6671 633.077,-83.654"/>
<polygon fill="#000000" stroke="#000000" points="634.739,-86.7653 642.821,-79.9152 632.231,-80.2299 634.739,-86.7653"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_2&#45;&gt;h5ltmake_dataset_double_f -->
<g id="proc~~write_spectra~~CallsGraph_edge44" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_2&#45;&gt;h5ltmake_dataset_double_f</title>
<path fill="none" stroke="#000000" d="M569.389,-335.879C573.227,-333.334 576.797,-330.393 580,-327 664.014,-238.009 536.314,-146.886 616,-54 616.742,-53.1353 617.517,-52.3051 618.323,-51.5082"/>
<polygon fill="#000000" stroke="#000000" points="620.631,-54.1448 626.304,-45.1965 616.289,-48.6542 620.631,-54.1448"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_2&#45;&gt;h5pset_shuffle_f -->
<g id="proc~~write_spectra~~CallsGraph_edge45" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_2&#45;&gt;h5pset_shuffle_f</title>
<path fill="none" stroke="#000000" d="M567.068,-360.091C571.682,-362.612 576.035,-365.56 580,-369 617.265,-401.328 580.314,-439.937 616,-474 621.063,-478.832 627.173,-482.561 633.669,-485.437"/>
<polygon fill="#000000" stroke="#000000" points="632.791,-488.846 643.384,-489.069 635.243,-482.289 632.791,-488.846"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_2&#45;&gt;h5pcreate_f -->
<g id="proc~~write_spectra~~CallsGraph_edge46" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_2&#45;&gt;h5pcreate_f</title>
<path fill="none" stroke="#000000" d="M564.185,-360.034C569.765,-362.535 575.095,-365.497 580,-369 606.244,-387.742 590.677,-412.031 616,-432 624.128,-438.41 634.152,-442.864 644.11,-445.958"/>
<polygon fill="#000000" stroke="#000000" points="643.406,-449.394 653.973,-448.622 645.231,-442.636 643.406,-449.394"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_2&#45;&gt;proc~chunk_size -->
<g id="proc~~write_spectra~~CallsGraph_edge47" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_2&#45;&gt;proc~chunk_size</title>
<path fill="none" stroke="#000000" d="M550.486,-360.069C560.568,-362.539 570.623,-365.488 580,-369 597.347,-375.497 598.982,-382.686 616,-390 625.51,-394.088 636.057,-397.662 646.08,-400.647"/>
<polygon fill="#000000" stroke="#000000" points="645.294,-404.062 655.871,-403.433 647.211,-397.329 645.294,-404.062"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_2&#45;&gt;h5pclose_f -->
<g id="proc~~write_spectra~~CallsGraph_edge48" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_2&#45;&gt;h5pclose_f</title>
<path fill="none" stroke="#000000" d="M579.639,-358.562C603.614,-360.871 627.549,-363.177 646.802,-365.031"/>
<polygon fill="#000000" stroke="#000000" points="646.697,-368.537 656.987,-366.012 647.368,-361.57 646.697,-368.537"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_2&#45;&gt;h5pset_chunk_f -->
<g id="proc~~write_spectra~~CallsGraph_edge49" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_2&#45;&gt;h5pset_chunk_f</title>
<path fill="none" stroke="#000000" d="M579.639,-337.438C598.868,-335.586 618.07,-333.736 634.853,-332.12"/>
<polygon fill="#000000" stroke="#000000" points="635.35,-335.588 644.968,-331.145 634.678,-328.62 635.35,-335.588"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_2&#45;&gt;h5dwrite_f -->
<g id="proc~~write_spectra~~CallsGraph_edge50" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_2&#45;&gt;h5dwrite_f</title>
<path fill="none" stroke="#000000" d="M550.486,-335.931C560.568,-333.461 570.623,-330.512 580,-327 597.347,-320.503 598.982,-313.314 616,-306 626.063,-301.675 637.286,-297.925 647.821,-294.839"/>
<polygon fill="#000000" stroke="#000000" points="648.964,-298.153 657.65,-292.087 647.077,-291.413 648.964,-298.153"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_4&#45;&gt;h5sclose_f -->
<g id="proc~~write_spectra~~CallsGraph_edge51" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_4&#45;&gt;h5sclose_f</title>
<path fill="none" stroke="#000000" d="M550.486,-293.931C560.568,-291.461 570.623,-288.512 580,-285 597.347,-278.503 598.982,-271.314 616,-264 625.881,-259.753 636.882,-256.06 647.251,-253.006"/>
<polygon fill="#000000" stroke="#000000" points="648.265,-256.357 656.942,-250.277 646.367,-249.619 648.265,-256.357"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_4&#45;&gt;h5dclose_f -->
<g id="proc~~write_spectra~~CallsGraph_edge52" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_4&#45;&gt;h5dclose_f</title>
<path fill="none" stroke="#000000" d="M564.185,-293.966C569.765,-291.465 575.095,-288.503 580,-285 606.244,-266.258 590.677,-241.969 616,-222 624.924,-214.963 636.132,-210.283 647.03,-207.172"/>
<polygon fill="#000000" stroke="#000000" points="648.011,-210.534 656.876,-204.732 646.328,-203.74 648.011,-210.534"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_4&#45;&gt;h5dcreate_f -->
<g id="proc~~write_spectra~~CallsGraph_edge53" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_4&#45;&gt;h5dcreate_f</title>
<path fill="none" stroke="#000000" d="M567.068,-293.909C571.682,-291.388 576.035,-288.44 580,-285 617.265,-252.672 580.314,-214.063 616,-180 623.709,-172.642 633.847,-167.842 644.075,-164.717"/>
<polygon fill="#000000" stroke="#000000" points="645.019,-168.088 653.831,-162.205 643.274,-161.309 645.019,-168.088"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_4&#45;&gt;h5screate_simple_f -->
<g id="proc~~write_spectra~~CallsGraph_edge54" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_4&#45;&gt;h5screate_simple_f</title>
<path fill="none" stroke="#000000" d="M568.449,-293.738C572.591,-291.241 576.476,-288.347 580,-285 628.772,-238.678 569.486,-186.589 616,-138 619.175,-134.683 622.842,-131.881 626.805,-129.516"/>
<polygon fill="#000000" stroke="#000000" points="628.481,-132.591 635.876,-125.004 625.364,-126.324 628.481,-132.591"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_4&#45;&gt;h5pset_deflate_f -->
<g id="proc~~write_spectra~~CallsGraph_edge55" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_4&#45;&gt;h5pset_deflate_f</title>
<path fill="none" stroke="#000000" d="M568.664,-293.959C572.75,-291.404 576.564,-288.438 580,-285 640.452,-224.523 558.492,-159.284 616,-96 620.707,-90.8204 626.611,-86.8901 633.003,-83.9128"/>
<polygon fill="#000000" stroke="#000000" points="634.562,-87.0626 642.633,-80.1981 632.043,-80.5316 634.562,-87.0626"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_4&#45;&gt;h5ltmake_dataset_double_f -->
<g id="proc~~write_spectra~~CallsGraph_edge56" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_4&#45;&gt;h5ltmake_dataset_double_f</title>
<path fill="none" stroke="#000000" d="M569.291,-293.786C573.156,-291.266 576.757,-288.355 580,-285 652.212,-210.288 547.423,-132.062 616,-54 616.87,-53.0095 617.784,-52.0646 618.737,-51.1631"/>
<polygon fill="#000000" stroke="#000000" points="620.898,-53.9168 626.725,-45.0686 616.652,-48.3515 620.898,-53.9168"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_4&#45;&gt;h5pset_shuffle_f -->
<g id="proc~~write_spectra~~CallsGraph_edge57" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_4&#45;&gt;h5pset_shuffle_f</title>
<path fill="none" stroke="#000000" d="M568.449,-318.262C572.591,-320.759 576.476,-323.653 580,-327 628.772,-373.322 569.486,-425.411 616,-474 620.9,-479.119 626.971,-483.01 633.493,-485.965"/>
<polygon fill="#000000" stroke="#000000" points="632.696,-489.405 643.288,-489.657 635.165,-482.855 632.696,-489.405"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_4&#45;&gt;h5pcreate_f -->
<g id="proc~~write_spectra~~CallsGraph_edge58" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_4&#45;&gt;h5pcreate_f</title>
<path fill="none" stroke="#000000" d="M567.068,-318.091C571.682,-320.612 576.035,-323.56 580,-327 617.265,-359.328 580.314,-397.937 616,-432 623.709,-439.358 633.847,-444.158 644.075,-447.283"/>
<polygon fill="#000000" stroke="#000000" points="643.274,-450.691 653.831,-449.795 645.019,-443.912 643.274,-450.691"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_4&#45;&gt;proc~chunk_size -->
<g id="proc~~write_spectra~~CallsGraph_edge59" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_4&#45;&gt;proc~chunk_size</title>
<path fill="none" stroke="#000000" d="M564.185,-318.034C569.765,-320.535 575.095,-323.497 580,-327 606.244,-345.742 590.677,-370.031 616,-390 624.6,-396.782 635.323,-401.374 645.844,-404.484"/>
<polygon fill="#000000" stroke="#000000" points="645.237,-407.942 655.793,-407.034 646.975,-401.161 645.237,-407.942"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_4&#45;&gt;h5pclose_f -->
<g id="proc~~write_spectra~~CallsGraph_edge60" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_4&#45;&gt;h5pclose_f</title>
<path fill="none" stroke="#000000" d="M550.486,-318.069C560.568,-320.539 570.623,-323.488 580,-327 597.347,-333.497 598.982,-340.686 616,-348 625.881,-352.247 636.882,-355.94 647.251,-358.994"/>
<polygon fill="#000000" stroke="#000000" points="646.367,-362.381 656.942,-361.723 648.265,-355.643 646.367,-362.381"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_4&#45;&gt;h5pset_chunk_f -->
<g id="proc~~write_spectra~~CallsGraph_edge61" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_4&#45;&gt;h5pset_chunk_f</title>
<path fill="none" stroke="#000000" d="M579.639,-316.562C598.868,-318.414 618.07,-320.264 634.853,-321.88"/>
<polygon fill="#000000" stroke="#000000" points="634.678,-325.38 644.968,-322.855 635.35,-318.412 634.678,-325.38"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_4&#45;&gt;h5dwrite_f -->
<g id="proc~~write_spectra~~CallsGraph_edge62" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_4&#45;&gt;h5dwrite_f</title>
<path fill="none" stroke="#000000" d="M579.639,-295.438C604.085,-293.084 628.488,-290.733 647.93,-288.86"/>
<polygon fill="#000000" stroke="#000000" points="648.284,-292.342 657.903,-287.899 647.613,-285.374 648.284,-292.342"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_1&#45;&gt;h5sclose_f -->
<g id="proc~~write_spectra~~CallsGraph_edge63" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_1&#45;&gt;h5sclose_f</title>
<path fill="none" stroke="#000000" d="M579.639,-253.438C603.614,-251.129 627.549,-248.823 646.802,-246.969"/>
<polygon fill="#000000" stroke="#000000" points="647.368,-250.43 656.987,-245.988 646.697,-243.463 647.368,-250.43"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_1&#45;&gt;h5dclose_f -->
<g id="proc~~write_spectra~~CallsGraph_edge64" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_1&#45;&gt;h5dclose_f</title>
<path fill="none" stroke="#000000" d="M550.486,-251.931C560.568,-249.461 570.623,-246.512 580,-243 597.347,-236.503 598.982,-229.314 616,-222 625.881,-217.753 636.882,-214.06 647.251,-211.006"/>
<polygon fill="#000000" stroke="#000000" points="648.265,-214.357 656.942,-208.277 646.367,-207.619 648.265,-214.357"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_1&#45;&gt;h5dcreate_f -->
<g id="proc~~write_spectra~~CallsGraph_edge65" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_1&#45;&gt;h5dcreate_f</title>
<path fill="none" stroke="#000000" d="M564.185,-251.966C569.765,-249.465 575.095,-246.503 580,-243 606.244,-224.258 590.677,-199.969 616,-180 624.128,-173.59 634.152,-169.136 644.11,-166.042"/>
<polygon fill="#000000" stroke="#000000" points="645.231,-169.364 653.973,-163.378 643.406,-162.606 645.231,-169.364"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_1&#45;&gt;h5screate_simple_f -->
<g id="proc~~write_spectra~~CallsGraph_edge66" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_1&#45;&gt;h5screate_simple_f</title>
<path fill="none" stroke="#000000" d="M567.068,-251.909C571.682,-249.388 576.035,-246.44 580,-243 617.265,-210.672 580.314,-172.063 616,-138 619.267,-134.881 622.971,-132.222 626.933,-129.956"/>
<polygon fill="#000000" stroke="#000000" points="628.471,-133.099 635.949,-125.594 625.423,-126.798 628.471,-133.099"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_1&#45;&gt;h5pset_deflate_f -->
<g id="proc~~write_spectra~~CallsGraph_edge67" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_1&#45;&gt;h5pset_deflate_f</title>
<path fill="none" stroke="#000000" d="M568.449,-251.738C572.591,-249.241 576.476,-246.347 580,-243 628.772,-196.678 569.486,-144.589 616,-96 620.84,-90.9444 626.821,-87.086 633.252,-84.145"/>
<polygon fill="#000000" stroke="#000000" points="634.817,-87.2938 642.913,-80.4598 632.323,-80.7534 634.817,-87.2938"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_1&#45;&gt;h5ltmake_dataset_double_f -->
<g id="proc~~write_spectra~~CallsGraph_edge68" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_1&#45;&gt;h5ltmake_dataset_double_f</title>
<path fill="none" stroke="#000000" d="M568.664,-251.959C572.75,-249.404 576.564,-246.438 580,-243 640.452,-182.523 558.492,-117.284 616,-54 616.887,-53.0243 617.816,-52.093 618.783,-51.2039"/>
<polygon fill="#000000" stroke="#000000" points="620.931,-53.9682 626.856,-45.1849 616.746,-48.3563 620.931,-53.9682"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_1&#45;&gt;h5pset_shuffle_f -->
<g id="proc~~write_spectra~~CallsGraph_edge69" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_1&#45;&gt;h5pset_shuffle_f</title>
<path fill="none" stroke="#000000" d="M568.664,-276.041C572.75,-278.596 576.564,-281.562 580,-285 640.452,-345.477 558.492,-410.716 616,-474 620.937,-479.433 627.191,-483.491 633.942,-486.517"/>
<polygon fill="#000000" stroke="#000000" points="632.788,-489.822 643.381,-490.035 635.233,-483.262 632.788,-489.822"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_1&#45;&gt;h5pcreate_f -->
<g id="proc~~write_spectra~~CallsGraph_edge70" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_1&#45;&gt;h5pcreate_f</title>
<path fill="none" stroke="#000000" d="M568.449,-276.262C572.591,-278.759 576.476,-281.653 580,-285 628.772,-331.322 569.486,-383.411 616,-432 623.438,-439.769 633.571,-444.711 643.887,-447.841"/>
<polygon fill="#000000" stroke="#000000" points="643.2,-451.277 653.752,-450.321 644.906,-444.489 643.2,-451.277"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_1&#45;&gt;proc~chunk_size -->
<g id="proc~~write_spectra~~CallsGraph_edge71" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_1&#45;&gt;proc~chunk_size</title>
<path fill="none" stroke="#000000" d="M567.068,-276.091C571.682,-278.612 576.035,-281.56 580,-285 617.265,-317.328 580.314,-355.937 616,-390 624.149,-397.778 635.013,-402.698 645.826,-405.802"/>
<polygon fill="#000000" stroke="#000000" points="645.122,-409.232 655.664,-408.173 646.762,-402.427 645.122,-409.232"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_1&#45;&gt;h5pclose_f -->
<g id="proc~~write_spectra~~CallsGraph_edge72" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_1&#45;&gt;h5pclose_f</title>
<path fill="none" stroke="#000000" d="M564.185,-276.034C569.765,-278.535 575.095,-281.497 580,-285 606.244,-303.742 590.677,-328.031 616,-348 624.924,-355.037 636.132,-359.717 647.03,-362.828"/>
<polygon fill="#000000" stroke="#000000" points="646.328,-366.26 656.876,-365.268 648.011,-359.466 646.328,-366.26"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_1&#45;&gt;h5pset_chunk_f -->
<g id="proc~~write_spectra~~CallsGraph_edge73" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_1&#45;&gt;h5pset_chunk_f</title>
<path fill="none" stroke="#000000" d="M550.486,-276.069C560.568,-278.539 570.623,-281.488 580,-285 597.347,-291.497 598.982,-298.686 616,-306 622.108,-308.625 628.645,-311.039 635.195,-313.221"/>
<polygon fill="#000000" stroke="#000000" points="634.164,-316.565 644.754,-316.249 636.278,-309.892 634.164,-316.565"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_1&#45;&gt;h5dwrite_f -->
<g id="proc~~write_spectra~~CallsGraph_edge74" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_1&#45;&gt;h5dwrite_f</title>
<path fill="none" stroke="#000000" d="M579.639,-274.562C604.085,-276.916 628.488,-279.267 647.93,-281.14"/>
<polygon fill="#000000" stroke="#000000" points="647.613,-284.626 657.903,-282.101 648.284,-277.658 647.613,-284.626"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_5&#45;&gt;h5sclose_f -->
<g id="proc~~write_spectra~~CallsGraph_edge75" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_5&#45;&gt;h5sclose_f</title>
<path fill="none" stroke="#000000" d="M579.639,-232.562C603.614,-234.871 627.549,-237.177 646.802,-239.031"/>
<polygon fill="#000000" stroke="#000000" points="646.697,-242.537 656.987,-240.012 647.368,-235.57 646.697,-242.537"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_5&#45;&gt;h5dclose_f -->
<g id="proc~~write_spectra~~CallsGraph_edge76" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_5&#45;&gt;h5dclose_f</title>
<path fill="none" stroke="#000000" d="M579.639,-211.438C603.614,-209.129 627.549,-206.823 646.802,-204.969"/>
<polygon fill="#000000" stroke="#000000" points="647.368,-208.43 656.987,-203.988 646.697,-201.463 647.368,-208.43"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_5&#45;&gt;h5dcreate_f -->
<g id="proc~~write_spectra~~CallsGraph_edge77" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_5&#45;&gt;h5dcreate_f</title>
<path fill="none" stroke="#000000" d="M550.486,-209.931C560.568,-207.461 570.623,-204.512 580,-201 597.347,-194.503 598.982,-187.314 616,-180 624.879,-176.184 634.661,-172.815 644.076,-169.956"/>
<polygon fill="#000000" stroke="#000000" points="645.074,-173.311 653.703,-167.163 643.123,-166.588 645.074,-173.311"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_5&#45;&gt;h5screate_simple_f -->
<g id="proc~~write_spectra~~CallsGraph_edge78" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_5&#45;&gt;h5screate_simple_f</title>
<path fill="none" stroke="#000000" d="M564.185,-209.966C569.765,-207.465 575.095,-204.503 580,-201 606.244,-182.258 590.677,-157.969 616,-138 619.187,-135.487 622.666,-133.274 626.317,-131.326"/>
<polygon fill="#000000" stroke="#000000" points="628.067,-134.374 635.684,-127.009 625.137,-128.017 628.067,-134.374"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_5&#45;&gt;h5pset_deflate_f -->
<g id="proc~~write_spectra~~CallsGraph_edge79" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_5&#45;&gt;h5pset_deflate_f</title>
<path fill="none" stroke="#000000" d="M567.068,-209.909C571.682,-207.388 576.035,-204.44 580,-201 617.265,-168.672 580.314,-130.063 616,-96 620.936,-91.2884 626.868,-87.6258 633.182,-84.7801"/>
<polygon fill="#000000" stroke="#000000" points="634.542,-88.0073 642.634,-81.1684 632.044,-81.4684 634.542,-88.0073"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_5&#45;&gt;h5ltmake_dataset_double_f -->
<g id="proc~~write_spectra~~CallsGraph_edge80" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_5&#45;&gt;h5ltmake_dataset_double_f</title>
<path fill="none" stroke="#000000" d="M568.449,-209.738C572.591,-207.241 576.476,-204.347 580,-201 628.772,-154.678 569.486,-102.589 616,-54 616.937,-53.0212 617.917,-52.0873 618.934,-51.1962"/>
<polygon fill="#000000" stroke="#000000" points="621.278,-53.8236 627.392,-45.1702 617.216,-48.1227 621.278,-53.8236"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_5&#45;&gt;h5pset_shuffle_f -->
<g id="proc~~write_spectra~~CallsGraph_edge81" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_5&#45;&gt;h5pset_shuffle_f</title>
<path fill="none" stroke="#000000" d="M569.291,-234.214C573.156,-236.734 576.757,-239.645 580,-243 652.212,-317.712 547.423,-395.938 616,-474 620.845,-479.515 627.047,-483.619 633.775,-486.667"/>
<polygon fill="#000000" stroke="#000000" points="632.603,-489.965 643.195,-490.201 635.062,-483.411 632.603,-489.965"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_5&#45;&gt;h5pcreate_f -->
<g id="proc~~write_spectra~~CallsGraph_edge82" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_5&#45;&gt;h5pcreate_f</title>
<path fill="none" stroke="#000000" d="M568.664,-234.041C572.75,-236.596 576.564,-239.562 580,-243 640.452,-303.477 558.492,-368.716 616,-432 623.3,-440.033 633.48,-445.061 643.89,-448.189"/>
<polygon fill="#000000" stroke="#000000" points="643.309,-451.651 653.855,-450.643 644.982,-444.854 643.309,-451.651"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_5&#45;&gt;proc~chunk_size -->
<g id="proc~~write_spectra~~CallsGraph_edge83" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_5&#45;&gt;proc~chunk_size</title>
<path fill="none" stroke="#000000" d="M568.449,-234.262C572.591,-236.759 576.476,-239.653 580,-243 628.772,-289.322 569.486,-341.411 616,-390 623.928,-398.281 634.919,-403.35 645.929,-406.437"/>
<polygon fill="#000000" stroke="#000000" points="645.427,-409.913 655.958,-408.75 647,-403.092 645.427,-409.913"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_5&#45;&gt;h5pclose_f -->
<g id="proc~~write_spectra~~CallsGraph_edge84" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_5&#45;&gt;h5pclose_f</title>
<path fill="none" stroke="#000000" d="M567.068,-234.091C571.682,-236.612 576.035,-239.56 580,-243 617.265,-275.328 580.314,-313.937 616,-348 624.365,-355.985 635.592,-360.957 646.687,-364.045"/>
<polygon fill="#000000" stroke="#000000" points="646.222,-367.531 656.755,-366.385 647.807,-360.712 646.222,-367.531"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_5&#45;&gt;h5pset_chunk_f -->
<g id="proc~~write_spectra~~CallsGraph_edge85" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_5&#45;&gt;h5pset_chunk_f</title>
<path fill="none" stroke="#000000" d="M564.185,-234.034C569.765,-236.535 575.095,-239.497 580,-243 606.244,-261.742 590.677,-286.031 616,-306 621.694,-310.49 628.317,-314.02 635.197,-316.796"/>
<polygon fill="#000000" stroke="#000000" points="634.078,-320.112 644.673,-320.132 636.403,-313.51 634.078,-320.112"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_5&#45;&gt;h5dwrite_f -->
<g id="proc~~write_spectra~~CallsGraph_edge86" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_5&#45;&gt;h5dwrite_f</title>
<path fill="none" stroke="#000000" d="M550.486,-234.069C560.568,-236.539 570.623,-239.488 580,-243 597.347,-249.497 598.982,-256.686 616,-264 626.063,-268.325 637.286,-272.075 647.821,-275.161"/>
<polygon fill="#000000" stroke="#000000" points="647.077,-278.587 657.65,-277.913 648.964,-271.847 647.077,-278.587"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_7&#45;&gt;h5sclose_f -->
<g id="proc~~write_spectra~~CallsGraph_edge87" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_7&#45;&gt;h5sclose_f</title>
<path fill="none" stroke="#000000" d="M550.486,-192.069C560.568,-194.539 570.623,-197.488 580,-201 597.347,-207.497 598.982,-214.686 616,-222 625.881,-226.247 636.882,-229.94 647.251,-232.994"/>
<polygon fill="#000000" stroke="#000000" points="646.367,-236.381 656.942,-235.723 648.265,-229.643 646.367,-236.381"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_7&#45;&gt;h5dclose_f -->
<g id="proc~~write_spectra~~CallsGraph_edge88" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_7&#45;&gt;h5dclose_f</title>
<path fill="none" stroke="#000000" d="M579.639,-190.562C603.614,-192.871 627.549,-195.177 646.802,-197.031"/>
<polygon fill="#000000" stroke="#000000" points="646.697,-200.537 656.987,-198.012 647.368,-193.57 646.697,-200.537"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_7&#45;&gt;h5dcreate_f -->
<g id="proc~~write_spectra~~CallsGraph_edge89" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_7&#45;&gt;h5dcreate_f</title>
<path fill="none" stroke="#000000" d="M579.639,-169.438C602.257,-167.26 624.838,-165.084 643.487,-163.288"/>
<polygon fill="#000000" stroke="#000000" points="644.081,-166.747 653.7,-162.304 643.41,-159.779 644.081,-166.747"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_7&#45;&gt;h5screate_simple_f -->
<g id="proc~~write_spectra~~CallsGraph_edge90" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_7&#45;&gt;h5screate_simple_f</title>
<path fill="none" stroke="#000000" d="M550.486,-167.931C560.568,-165.461 570.623,-162.512 580,-159 597.347,-152.503 598.982,-145.314 616,-138 620.738,-135.963 625.734,-134.054 630.794,-132.282"/>
<polygon fill="#000000" stroke="#000000" points="632.164,-135.515 640.553,-129.045 629.96,-128.871 632.164,-135.515"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_7&#45;&gt;h5pset_deflate_f -->
<g id="proc~~write_spectra~~CallsGraph_edge91" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_7&#45;&gt;h5pset_deflate_f</title>
<path fill="none" stroke="#000000" d="M564.185,-167.966C569.765,-165.465 575.095,-162.503 580,-159 606.244,-140.258 590.677,-115.969 616,-96 621.099,-91.9788 626.945,-88.7274 633.052,-86.0985"/>
<polygon fill="#000000" stroke="#000000" points="634.652,-89.237 642.794,-82.4584 632.202,-82.6798 634.652,-89.237"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_7&#45;&gt;h5ltmake_dataset_double_f -->
<g id="proc~~write_spectra~~CallsGraph_edge92" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_7&#45;&gt;h5ltmake_dataset_double_f</title>
<path fill="none" stroke="#000000" d="M567.068,-167.909C571.682,-165.388 576.035,-162.44 580,-159 617.265,-126.672 580.314,-88.0635 616,-54 617.263,-52.7947 618.591,-51.6581 619.973,-50.5862"/>
<polygon fill="#000000" stroke="#000000" points="621.921,-53.4945 628.422,-45.1283 618.123,-47.6148 621.921,-53.4945"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_7&#45;&gt;h5pset_shuffle_f -->
<g id="proc~~write_spectra~~CallsGraph_edge93" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_7&#45;&gt;h5pset_shuffle_f</title>
<path fill="none" stroke="#000000" d="M569.389,-192.121C573.227,-194.666 576.797,-197.607 580,-201 664.014,-289.991 536.314,-381.114 616,-474 620.838,-479.639 627.096,-483.808 633.902,-486.881"/>
<polygon fill="#000000" stroke="#000000" points="632.846,-490.223 643.438,-490.429 635.286,-483.662 632.846,-490.223"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_7&#45;&gt;h5pcreate_f -->
<g id="proc~~write_spectra~~CallsGraph_edge94" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_7&#45;&gt;h5pcreate_f</title>
<path fill="none" stroke="#000000" d="M569.291,-192.214C573.156,-194.734 576.757,-197.645 580,-201 652.212,-275.712 547.423,-353.938 616,-432 623.164,-440.154 633.296,-445.225 643.704,-448.355"/>
<polygon fill="#000000" stroke="#000000" points="643.135,-451.819 653.68,-450.799 644.8,-445.02 643.135,-451.819"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_7&#45;&gt;proc~chunk_size -->
<g id="proc~~write_spectra~~CallsGraph_edge95" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_7&#45;&gt;proc~chunk_size</title>
<path fill="none" stroke="#000000" d="M568.664,-192.041C572.75,-194.596 576.564,-197.562 580,-201 640.452,-261.477 558.492,-326.716 616,-390 623.71,-398.485 634.634,-403.617 645.648,-406.699"/>
<polygon fill="#000000" stroke="#000000" points="645.171,-410.181 655.699,-408.991 646.728,-403.356 645.171,-410.181"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_7&#45;&gt;h5pclose_f -->
<g id="proc~~write_spectra~~CallsGraph_edge96" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_7&#45;&gt;h5pclose_f</title>
<path fill="none" stroke="#000000" d="M568.449,-192.262C572.591,-194.759 576.476,-197.653 580,-201 628.772,-247.322 569.486,-299.411 616,-348 624.148,-356.511 635.532,-361.63 646.846,-364.69"/>
<polygon fill="#000000" stroke="#000000" points="646.166,-368.124 656.688,-366.883 647.689,-361.292 646.166,-368.124"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_7&#45;&gt;h5pset_chunk_f -->
<g id="proc~~write_spectra~~CallsGraph_edge97" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_7&#45;&gt;h5pset_chunk_f</title>
<path fill="none" stroke="#000000" d="M567.068,-192.091C571.682,-194.612 576.035,-197.56 580,-201 617.265,-233.328 580.314,-271.937 616,-306 621.439,-311.192 628.089,-315.11 635.125,-318.065"/>
<polygon fill="#000000" stroke="#000000" points="634.288,-321.482 644.883,-321.527 636.629,-314.885 634.288,-321.482"/>
</g>
<!-- proc~h5ltmake_compressed_dataset_double_f_7&#45;&gt;h5dwrite_f -->
<g id="proc~~write_spectra~~CallsGraph_edge98" class="edge"><title>proc~h5ltmake_compressed_dataset_double_f_7&#45;&gt;h5dwrite_f</title>
<path fill="none" stroke="#000000" d="M564.185,-192.034C569.765,-194.535 575.095,-197.497 580,-201 606.244,-219.742 590.677,-244.031 616,-264 625.159,-271.222 636.724,-275.961 647.889,-279.071"/>
<polygon fill="#000000" stroke="#000000" points="647.41,-282.555 657.951,-281.493 649.048,-275.75 647.41,-282.555"/>
</g>
</g>
</svg>
</div><script>var panprocwrite_spectraCallsGraph = svgPanZoom('#procwrite_spectraCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~write_spectra~~CalledByGraph Pages: 1 -->
<svg id="procwrite_spectraCalledByGraph" width="174pt" height="32pt"
 viewBox="0.00 0.00 174.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~write_spectra~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~write_spectra~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 170,-28 170,4 -4,4"/>
<!-- proc~write_spectra -->
<g id="proc~~write_spectra~~CalledByGraph_node1" class="node"><title>proc~write_spectra</title>
<polygon fill="none" stroke="black" points="166,-24 90,-24 90,-0 166,-0 166,-24"/>
<text text-anchor="middle" x="128" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">write_spectra</text>
</g>
<!-- program~fidasim -->
<g id="proc~~write_spectra~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~write_spectra~~CalledByGraph_node2"><a xlink:href=".././program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~write_spectra -->
<g id="proc~~write_spectra~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~write_spectra</title>
<path fill="none" stroke="#000000" d="M54.0111,-12C61.917,-12 70.8635,-12 79.7154,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.9953,-15.5001 89.9953,-12 79.9952,-8.5001 79.9953,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/write_spectra.html#src">write_spectra</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">write_spectra</span>
    <span class="c">!+ Writes [[libfida:spectra]] to a HDF5 file</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">HID_T</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fid</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">HSIZE_T</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dims</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">HSIZE_T</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">d</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">error</span>

    <span class="kt">character</span><span class="p">(</span><span class="n">charlim</span><span class="p">)</span> <span class="kd">::</span> <span class="n">filename</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">factor</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">lambda_arr</span>

    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">nlambda</span><span class="p">,</span><span class="n">spec_chords</span><span class="p">%</span><span class="n">nchan</span><span class="p">)</span> <span class="kd">::</span> <span class="n">full</span><span class="p">,</span> <span class="n">half</span><span class="p">,</span> <span class="n">third</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">nlambda</span><span class="p">,</span><span class="n">spec_chords</span><span class="p">%</span><span class="n">nchan</span><span class="p">,</span><span class="n">n_thermal</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dcx</span><span class="p">,</span> <span class="n">halo</span><span class="p">,</span> <span class="n">cold</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">nlambda</span><span class="p">,</span><span class="n">spec_chords</span><span class="p">%</span><span class="n">nchan</span><span class="p">,</span><span class="n">particles</span><span class="p">%</span><span class="n">nclass</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fida</span><span class="p">,</span> <span class="n">pfida</span>

    <span class="k">allocate</span><span class="p">(</span><span class="n">lambda_arr</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">nlambda</span><span class="p">))</span>
    <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inputs</span><span class="p">%</span><span class="n">nlambda</span>
        <span class="n">lambda_arr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">inputs</span><span class="p">%</span><span class="n">dlambda</span> <span class="o">+</span> <span class="n">inputs</span><span class="p">%</span><span class="n">lambdamin</span>
    <span class="n">enddo</span>

    <span class="c">!! convert [Ph/(s*wavel_bin*cm^2*all_directions)] to [Ph/(s*nm*sr*m^2)]!</span>
    <span class="n">factor</span> <span class="o">=</span> <span class="mf">1.d0</span><span class="o">/</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">dlambda</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">4.d0</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="mf">1.d4</span>

    <span class="c">!! write to file</span>
    <span class="n">filename</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">result_dir</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot;/&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">runid</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot;_spectra.h5&quot;</span>

    <span class="c">!Open HDF5 interface</span>
    <span class="k">call </span><span class="n">h5open_f</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

    <span class="c">!Create file overwriting any existing file</span>
    <span class="k">call </span><span class="n">h5fcreate_f</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">H5F_ACC_TRUNC_F</span><span class="p">,</span> <span class="n">fid</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>

    <span class="c">!Write variables</span>
    <span class="n">d</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">call </span><span class="n">h5ltmake_dataset_int_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/nchan&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="p">[</span><span class="n">spec_chords</span><span class="p">%</span><span class="n">nchan</span><span class="p">],</span> <span class="n">error</span><span class="p">)</span>
    <span class="k">call </span><span class="n">h5ltmake_dataset_int_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/nlambda&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="p">[</span><span class="n">inputs</span><span class="p">%</span><span class="n">nlambda</span><span class="p">],</span> <span class="n">error</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">stark_components</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">h5ltmake_dataset_int_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/nstark&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="p">[</span><span class="n">n_stark</span><span class="p">],</span> <span class="n">error</span><span class="p">)</span>
    <span class="n">endif</span>
    <span class="n">dims</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">n_stark</span>
    <span class="n">dims</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">%</span><span class="n">nlambda</span>
    <span class="n">dims</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">spec_chords</span><span class="p">%</span><span class="n">nchan</span>
    <span class="n">dims</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">n_thermal</span>
    <span class="k">call </span><span class="n">h5ltmake_compressed_dataset_double_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/lambda&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dims</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="p">),</span> <span class="p">&amp;</span>
         <span class="n">lambda_arr</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
    <span class="k">call </span><span class="n">h5ltmake_compressed_dataset_double_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/radius&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dims</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">3</span><span class="p">),</span> <span class="p">&amp;</span>
         <span class="n">spec_chords</span><span class="p">%</span><span class="n">radius</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>

    <span class="c">!Add attributes</span>
    <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/nchan&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="s2">&quot;Number of channels&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
    <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/nlambda&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="s2">&quot;Number of wavelengths&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
    <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/lambda&quot;</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="s2">&quot;Wavelength array&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
    <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/lambda&quot;</span><span class="p">,</span><span class="s2">&quot;units&quot;</span><span class="p">,</span><span class="s2">&quot;nm&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
    <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/radius&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="s2">&quot;Line of sight radius at midplane or tangency point&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
    <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/radius&quot;</span><span class="p">,</span><span class="s2">&quot;units&quot;</span><span class="p">,</span><span class="s2">&quot;cm&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>

    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_brems</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">spec</span><span class="p">%</span><span class="n">brems</span> <span class="o">=</span> <span class="n">factor</span><span class="o">*</span><span class="n">spec</span><span class="p">%</span><span class="n">brems</span>
        <span class="c">!Write variables</span>
        <span class="k">call </span><span class="n">h5ltmake_compressed_dataset_double_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/brems&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="n">dims</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">),</span> <span class="n">spec</span><span class="p">%</span><span class="n">brems</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
        <span class="c">!Add attributes</span>
        <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/brems&quot;</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="s2">&quot;Visible Bremsstrahlung: brems(lambda,chan)&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
        <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/brems&quot;</span><span class="p">,</span><span class="s2">&quot;units&quot;</span><span class="p">,&amp;</span>
             <span class="s2">&quot;Ph/(s*nm*sr*m^2)&quot;</span><span class="p">,</span><span class="n">error</span> <span class="p">)</span>
    <span class="n">endif</span>

    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_bes</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">spec</span><span class="p">%</span><span class="n">full</span> <span class="o">=</span> <span class="n">factor</span><span class="o">*</span><span class="n">spec</span><span class="p">%</span><span class="n">full</span>
        <span class="n">spec</span><span class="p">%</span><span class="n">half</span> <span class="o">=</span> <span class="n">factor</span><span class="o">*</span><span class="n">spec</span><span class="p">%</span><span class="n">half</span>
        <span class="n">spec</span><span class="p">%</span><span class="n">third</span> <span class="o">=</span> <span class="n">factor</span><span class="o">*</span><span class="n">spec</span><span class="p">%</span><span class="n">third</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">stark_components</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">full</span>  <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">full</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">half</span>  <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">half</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">third</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">third</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c">!Write variables</span>
            <span class="k">call </span><span class="n">h5ltmake_compressed_dataset_double_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/full&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dims</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">),</span> <span class="p">&amp;</span>
                 <span class="n">full</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltmake_compressed_dataset_double_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/half&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dims</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">),</span> <span class="p">&amp;</span>
                 <span class="n">half</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltmake_compressed_dataset_double_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/third&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dims</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">),&amp;</span>
                 <span class="n">third</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="c">!Add attributes</span>
            <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/full&quot;</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="s2">&quot;Full energy component of the beam emmision: full(lambda,chan)&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/full&quot;</span><span class="p">,</span><span class="s2">&quot;units&quot;</span><span class="p">,</span><span class="s2">&quot;Ph/(s*nm*sr*m^2)&quot;</span><span class="p">,</span><span class="n">error</span> <span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/half&quot;</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="s2">&quot;Half energy component of the beam emmision: half(lambda,chan)&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/half&quot;</span><span class="p">,</span><span class="s2">&quot;units&quot;</span><span class="p">,</span><span class="s2">&quot;Ph/(s*nm*sr*m^2)&quot;</span><span class="p">,</span><span class="n">error</span> <span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/third&quot;</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="s2">&quot;Third energy component of the beam emmision: third(lambda,chan)&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/third&quot;</span><span class="p">,</span><span class="s2">&quot;units&quot;</span><span class="p">,</span><span class="s2">&quot;Ph/(s*nm*sr*m^2)&quot;</span><span class="p">,</span><span class="n">error</span> <span class="p">)</span>
        <span class="k">else</span>
<span class="k">            call </span><span class="n">h5ltmake_compressed_dataset_double_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/full&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">dims</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">),</span> <span class="p">&amp;</span>
                 <span class="n">spec</span><span class="p">%</span><span class="n">full</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltmake_compressed_dataset_double_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/half&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">dims</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">),</span> <span class="p">&amp;</span>
                 <span class="n">spec</span><span class="p">%</span><span class="n">half</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltmake_compressed_dataset_double_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/third&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">dims</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">),&amp;</span>
                 <span class="n">spec</span><span class="p">%</span><span class="n">third</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/full&quot;</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="s2">&quot;Full energy component of the beam emmision stark components: full(stark,lambda,chan)&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="n">error</span><span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/full&quot;</span><span class="p">,</span><span class="s2">&quot;units&quot;</span><span class="p">,</span><span class="s2">&quot;Ph/(s*nm*sr*m^2)&quot;</span><span class="p">,</span><span class="n">error</span> <span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/half&quot;</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="s2">&quot;Half energy component of the beam emmision stark components: half(stark,lambda,chan)&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="n">error</span><span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/half&quot;</span><span class="p">,</span><span class="s2">&quot;units&quot;</span><span class="p">,</span><span class="s2">&quot;Ph/(s*nm*sr*m^2)&quot;</span><span class="p">,</span><span class="n">error</span> <span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/third&quot;</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="s2">&quot;Third energy component of the beam emmision stark components: third(stark,lambda,chan)&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="n">error</span><span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/third&quot;</span><span class="p">,</span><span class="s2">&quot;units&quot;</span><span class="p">,</span><span class="s2">&quot;Ph/(s*nm*sr*m^2)&quot;</span><span class="p">,</span><span class="n">error</span> <span class="p">)</span>
        <span class="n">endif</span>
    <span class="n">endif</span>

    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_dcx</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">spec</span><span class="p">%</span><span class="n">dcx</span> <span class="o">=</span> <span class="n">factor</span><span class="o">*</span><span class="n">spec</span><span class="p">%</span><span class="n">dcx</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">stark_components</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">dcx</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">dcx</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltmake_compressed_dataset_double_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/dcx&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">dims</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">),</span> <span class="p">&amp;</span>
                 <span class="n">dcx</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/dcx&quot;</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="s2">&quot;Direct Charge Exchange (DCX) emission: dcx(lambda,chan,species)&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/dcx&quot;</span><span class="p">,</span><span class="s2">&quot;units&quot;</span><span class="p">,</span><span class="s2">&quot;Ph/(s*nm*sr*m^2)&quot;</span><span class="p">,</span><span class="n">error</span> <span class="p">)</span>
        <span class="k">else</span>
<span class="k">            call </span><span class="n">h5ltmake_compressed_dataset_double_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/dcx&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="n">spec</span><span class="p">%</span><span class="n">dcx</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/dcx&quot;</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="s2">&quot;Direct Charge Exchange (DCX) emission stark components: dcx(stark,lambda,chan,species)&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/dcx&quot;</span><span class="p">,</span><span class="s2">&quot;units&quot;</span><span class="p">,</span><span class="s2">&quot;Ph/(s*nm*sr*m^2)&quot;</span><span class="p">,</span><span class="n">error</span> <span class="p">)</span>
        <span class="n">endif</span>
    <span class="n">endif</span>

    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_halo</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">spec</span><span class="p">%</span><span class="n">halo</span> <span class="o">=</span> <span class="n">factor</span><span class="o">*</span><span class="n">spec</span><span class="p">%</span><span class="n">halo</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">stark_components</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">halo</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">halo</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltmake_compressed_dataset_double_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/halo&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">dims</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">),</span> <span class="p">&amp;</span>
                 <span class="n">halo</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/halo&quot;</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="s2">&quot;Halo component of the beam emmision: halo(lambda,chan,species)&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/halo&quot;</span><span class="p">,</span><span class="s2">&quot;units&quot;</span><span class="p">,</span><span class="s2">&quot;Ph/(s*nm*sr*m^2)&quot;</span><span class="p">,</span><span class="n">error</span> <span class="p">)</span>
        <span class="k">else</span>
<span class="k">            call </span><span class="n">h5ltmake_compressed_dataset_double_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/halo&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="n">spec</span><span class="p">%</span><span class="n">halo</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/halo&quot;</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="s2">&quot;Halo component of the beam emmision stark components: halo(stark,lambda,chan,species)&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/halo&quot;</span><span class="p">,</span><span class="s2">&quot;units&quot;</span><span class="p">,</span><span class="s2">&quot;Ph/(s*nm*sr*m^2)&quot;</span><span class="p">,</span><span class="n">error</span> <span class="p">)</span>
        <span class="n">endif</span>
    <span class="n">endif</span>

    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_cold</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">spec</span><span class="p">%</span><span class="n">cold</span> <span class="o">=</span> <span class="n">factor</span><span class="o">*</span><span class="n">spec</span><span class="p">%</span><span class="n">cold</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">stark_components</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">cold</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">cold</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltmake_compressed_dataset_double_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/cold&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">dims</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">),</span> <span class="p">&amp;</span>
                 <span class="n">cold</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/cold&quot;</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="s2">&quot;Cold D-alpha emission: cold(lambda,chan,species)&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/cold&quot;</span><span class="p">,</span><span class="s2">&quot;units&quot;</span><span class="p">,</span><span class="s2">&quot;Ph/(s*nm*sr*m^2)&quot;</span><span class="p">,</span><span class="n">error</span> <span class="p">)</span>
        <span class="k">else</span>
<span class="k">            call </span><span class="n">h5ltmake_compressed_dataset_double_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/cold&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="n">spec</span><span class="p">%</span><span class="n">cold</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/cold&quot;</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="s2">&quot;Cold D-alpha emission stark components: cold(stark,lambda,chan,species)&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="n">error</span><span class="p">)</span>
            <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/cold&quot;</span><span class="p">,</span><span class="s2">&quot;units&quot;</span><span class="p">,</span><span class="s2">&quot;Ph/(s*nm*sr*m^2)&quot;</span><span class="p">,</span><span class="n">error</span> <span class="p">)</span>
        <span class="n">endif</span>
    <span class="n">endif</span>

    <span class="n">dims</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">particles</span><span class="p">%</span><span class="n">nclass</span>
    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_fida</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">spec</span><span class="p">%</span><span class="n">fida</span> <span class="o">=</span> <span class="n">factor</span><span class="o">*</span><span class="n">spec</span><span class="p">%</span><span class="n">fida</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">stark_components</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="n">fida</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">fida</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c">!Write variables</span>
        <span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">nclass</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            if</span> <span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">stark_components</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                call </span><span class="n">h5ltmake_compressed_dataset_double_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/fida&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">dims</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">),</span> <span class="n">fida</span><span class="p">(:,:,</span><span class="mi">1</span><span class="p">),</span> <span class="n">error</span><span class="p">)</span>
                <span class="c">!Add attributes</span>
                <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/fida&quot;</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="s2">&quot;Active Fast-ion D-alpha (FIDA) emmision: fida(lambda,chan)&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="k">else</span>
<span class="k">                call </span><span class="n">h5ltmake_compressed_dataset_double_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/fida&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">dims</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">),</span> <span class="n">spec</span><span class="p">%</span><span class="n">fida</span><span class="p">(:,:,:,</span><span class="mi">1</span><span class="p">),</span> <span class="n">error</span><span class="p">)</span>
                <span class="c">!Add attributes</span>
                <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/fida&quot;</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="s2">&quot;Active Fast-ion D-alpha (FIDA) emmision stark components: fida(stark,lambda,chan)&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">error</span><span class="p">)</span>
            <span class="n">endif</span>
        <span class="k">else</span>
<span class="k">            if</span> <span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">stark_components</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                call </span><span class="n">h5ltmake_dataset_int_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/nclass&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="p">[</span><span class="n">particles</span><span class="p">%</span><span class="n">nclass</span><span class="p">],</span> <span class="n">error</span><span class="p">)</span>
                <span class="k">call </span><span class="n">h5ltmake_compressed_dataset_double_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/fida&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">dims</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">),</span> <span class="n">fida</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
                <span class="c">!Add attributes</span>
                <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/fida&quot;</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="s2">&quot;Active Fast-ion D-alpha (FIDA) emmision: fida(lambda,chan,class)&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="k">else</span>
<span class="k">                call </span><span class="n">h5ltmake_compressed_dataset_double_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/fida&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">dims</span><span class="p">,</span> <span class="n">spec</span><span class="p">%</span><span class="n">fida</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
                <span class="c">!Add attributes</span>
                <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/fida&quot;</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="s2">&quot;Active Fast-ion D-alpha (FIDA) emmision stark components: fida(stark,lambda,chan,class)&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">error</span><span class="p">)</span>
            <span class="n">endif</span>
       <span class="n">endif</span>
       <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/fida&quot;</span><span class="p">,</span><span class="s2">&quot;units&quot;</span><span class="p">,</span><span class="s2">&quot;Ph/(s*nm*sr*m^2)&quot;</span><span class="p">,</span><span class="n">error</span> <span class="p">)</span>
    <span class="n">endif</span>

    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_pfida</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">spec</span><span class="p">%</span><span class="n">pfida</span> <span class="o">=</span> <span class="n">factor</span><span class="o">*</span><span class="n">spec</span><span class="p">%</span><span class="n">pfida</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">stark_components</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="n">pfida</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">spec</span><span class="p">%</span><span class="n">pfida</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c">!Write variables</span>
        <span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">nclass</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            if</span> <span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">stark_components</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                call </span><span class="n">h5ltmake_compressed_dataset_double_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/pfida&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">dims</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">),</span> <span class="n">pfida</span><span class="p">(:,:,</span><span class="mi">1</span><span class="p">),</span> <span class="n">error</span><span class="p">)</span>
                <span class="c">!Add attributes</span>
                <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/pfida&quot;</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="s2">&quot;Passive Fast-ion D-alpha (p-FIDA) emmision: pfida(lambda,chan)&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="k">else</span>
<span class="k">                call </span><span class="n">h5ltmake_compressed_dataset_double_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/pfida&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">dims</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">),</span> <span class="n">spec</span><span class="p">%</span><span class="n">pfida</span><span class="p">(:,:,:,</span><span class="mi">1</span><span class="p">),</span> <span class="n">error</span><span class="p">)</span>
                <span class="c">!Add attributes</span>
                <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/pfida&quot;</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="s2">&quot;Passive Fast-ion D-alpha (p-FIDA) emmision stark components: pfida(stark,lambda,chan)&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">error</span><span class="p">)</span>
            <span class="n">endif</span>
        <span class="k">else</span>
<span class="k">            if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">calc_fida</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                call </span><span class="n">h5ltmake_dataset_int_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/nclass&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="p">[</span><span class="n">particles</span><span class="p">%</span><span class="n">nclass</span><span class="p">],</span> <span class="n">error</span><span class="p">)</span>
            <span class="n">endif</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">stark_components</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                call </span><span class="n">h5ltmake_compressed_dataset_double_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/pfida&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">dims</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">),</span> <span class="n">pfida</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
                <span class="c">!Add attributes</span>
                <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/pfida&quot;</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="s2">&quot;Passive Fast-ion D-alpha (p-FIDA) emmision: pfida(lambda,chan,class)&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="k">else</span>
<span class="k">                call </span><span class="n">h5ltmake_compressed_dataset_double_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/pfida&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">dims</span><span class="p">,</span> <span class="n">spec</span><span class="p">%</span><span class="n">pfida</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
                <span class="c">!Add attributes</span>
                <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/pfida&quot;</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="s2">&quot;Passive Fast-ion D-alpha (p-FIDA) emmision stark components: pfida(stark,lambda,chan,class)&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">error</span><span class="p">)</span>
            <span class="n">endif</span>
       <span class="n">endif</span>
       <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/pfida&quot;</span><span class="p">,</span><span class="s2">&quot;units&quot;</span><span class="p">,</span><span class="s2">&quot;Ph/(s*nm*sr*m^2)&quot;</span><span class="p">,</span><span class="n">error</span> <span class="p">)</span>
    <span class="n">endif</span>

    <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;version&quot;</span><span class="p">,</span> <span class="n">version</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
    <span class="k">call </span><span class="n">h5ltset_attribute_string_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="p">,&amp;</span>
         <span class="s2">&quot;Spectra calculated by FIDASIM&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>

    <span class="c">!Close file</span>
    <span class="k">call </span><span class="n">h5fclose_f</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>

    <span class="c">!Close HDF5 interface</span>
    <span class="k">call </span><span class="n">h5close_f</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T4,a,a)&#39;</span><span class="p">)</span> <span class="s1">&#39;Spectra written to: &#39;</span><span class="p">,</span> <span class="nb">trim</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">endif</span>

<span class="k">end subroutine </span><span class="n">write_spectra</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> FIDASIM was developed by Luke Stagner</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>