<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="FIDASIM - A Neutral Beam and Fast-ion Diagnostic Modeling Suite">
    
    <meta name="author" content="Chris MacMackin" >
    <link rel="icon" href="../favicon.png">

    <title>Getting Started &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>1.0.0</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
				
            <li><a href='../page/index.html'>User Guide</a></li>
				
                
            <li><a href="../lists/files.html">Source Files</a></li>
				
				
            <li><a href="../lists/modules.html">Modules</a></li>
				
				
            <li><a href="../lists/procedures.html">Procedures</a></li>
				
								
            <li><a href="../lists/types.html">Derived Types</a></li>
				
				
            <li><a href="../lists/programs.html">Programs</a></li>
				
          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  <div class="row">
    <h1>Getting Started</h1>
    <div class="row">
    <div class="col-lg-12">
    <div class="well well-sm" style="min-height: 40px;">
      <ul class="list-inline" style="margin-bottom:0px; display:inline">
         
         
<!--
        
-->
      </ul>
        <ol class="breadcrumb in-well">
      
         <li><a href='../page/index.html'>User Guide</a></li>
      
         <li class="active">Getting Started</li>
      </ol>
    </div>
    </div>
    </div>
  </div>
  
  <div class="row">
    
    <div class="col-lg-3">
        <div class="well toc">
          <ul class="nav nav-stacked nav-pills">
            <li role="presentation" class="title"><a href='../page/index.html'>User Guide</a></li>
          </ul>
          <hr>
          <ul class="nav nav-stacked nav-pills">
            
            <li role="presentation" class="disabled">
            <a href='../page/./01_getting_started.html'>Getting Started</a>
            
            </li>
            
            <li role="presentation">
            <a href='../page/02_input_files/index.html'>Input Files</a>
            
            <ul class="nav nav-stacked nav-pills">
              
            <li role="presentation">
            <a href='../page/02_input_files/01_namelist_file.html'>Namelist File</a>
            
            </li>
            
            <li role="presentation">
            <a href='../page/02_input_files/02_geometry_file.html'>Geometry File</a>
            
            </li>
            
            <li role="presentation">
            <a href='../page/02_input_files/03_equilibrium_file.html'>Equilibrium File</a>
            
            </li>
            
            <li role="presentation">
            <a href='../page/02_input_files/04_distribution_file.html'>Distribution File</a>
            
            </li>
            
            <li role="presentation">
            <a href='../page/02_input_files/05_prefida.html'>Making Input Files</a>
            
            </li>
            
            </ul>
            
            </li>
            
          </ul>
        </div>
    </div>
    
    <div class="col-lg-9" id='text'>
        <h1 id="getting-started">Getting Started</h1>
<p>So you have decided to install FIDASIM. Don't worry this should be relatively painless.</p>
<p></p><div class="alert alert-info" role="alert"><h4>Note</h4>If you experiance problems installing FIDASIM you did something wrong and you should <a href="https://github.com/D3DEnergetic/FIDASIM/issues/new"><strong>let us know</strong></a> so we can laugh at you (and also help you)</div>
<p>The following code snippets assumes you are using a BASH shell.
To figure out what shell you currently have run <code>echo $SHELL</code> to find out. </p>
<hr>
<h2 id="dependencies">Dependencies</h2>
<p>FIDASIM has the following dependencies:</p>
<ul>
<li>Linux because all other operating systems are inferior</li>
<li><a href="http://www.harrisgeospatial.com/IntelliEarthSolutions/GeospatialProducts/IDL.aspx">IDL</a> for pre-processing. Sorry.</li>
<li><a href="https://www.hdfgroup.org/HDF5/">HDF5</a> for reading and writing compressed data files</li>
<li><a href="https://github.com/cmacmackin/ford">Ford</a> for creating HTML documentation (Optional)</li>
</ul>
<p>Fortunately for you (the user) FIDASIM bundles and builds HDF5 for you and only FIDASIM developers should need Ford.</p>
<h2 id="getting-fidasim-source">Getting FIDASIM source</h2>
<p>It is a fact of nature that you cannot run code you haven't installed. There are two ways correcting this.</p>
<h3 id="downloading-source-directly">Downloading source directly</h3>
<p>The most recent version of FIDASIM (1.0.0) can be downloaded from <a href="https://github.com/D3DEnergetic/FIDASIM/releases">here</a>
Once you have downloaded the <code>.tar.gz</code> or <code>.zip</code> file unpack it using the following commands.</p>
<div class="codehilite"><pre>tar -zxf FIDASIM-1.0.0.tar.gz
</pre></div>


<p>or if you downloaded the <code>.zip</code> file</p>
<div class="codehilite"><pre>unzip FIDASIM-1.0.0.zip
</pre></div>


<p>There should now be a directory named <code>FIDASIM-1.0.0</code> in your current directory. Enter the directory using</p>
<div class="codehilite"><pre><span class="nb">cd</span> FIDASIM-1.0.0
</pre></div>


<h3 id="cloning-the-git-repository">Cloning the git repository</h3>
<p>If you are planning to develop FIDASIM it is best to use git.</p>
<div class="codehilite"><pre>git clone https://github.com/D3DEnergetic/FIDASIM.git FIDASIM
<span class="nb">cd</span> FIDASIM
</pre></div>


<p>By default you will be on the master branch which may or may not be in a usable state.
To use the release version run the command</p>
<div class="codehilite"><pre>git checkout v1.0.0
</pre></div>


<h2 id="setting-up-environmental-variables">Setting up environmental variables</h2>
<p>FIDASIM needs to know where somethings are so you have to set the following environmental variables in your <code>.bashrc</code></p>
<div class="codehilite"><pre><span class="nb">export</span> <span class="nv">FIDASIM_DIR</span><span class="o">=</span>/path/to/fidasim/install
<span class="nb">export</span> <span class="nv">FC</span><span class="o">=</span>gfortran <span class="c1">#use &#39;ifort&#39; for Intel Fortran compiler</span>
<span class="nb">export</span> <span class="nv">CC</span><span class="o">=</span>gcc      <span class="c1">#use &#39;icc&#39; for Intel C compiler</span>
<span class="nb">export</span> <span class="nv">CXX</span><span class="o">=</span>g++     <span class="c1">#use &#39;icpc&#39; for Intel C++ compiler</span>

<span class="c1">#For HDF5 dependency</span>
<span class="nb">export</span> <span class="nv">HDF5_INCLUDE</span><span class="o">=</span><span class="nv">$F</span>IDASIM_DIR/deps/hdf5/include
<span class="nb">export</span> <span class="nv">HDF5_LIB</span><span class="o">=</span><span class="nv">$F</span>IDASIM_DIR/deps/hdf5/lib
<span class="nb">export</span> <span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span>$HDF5_LIB:$HDF5_INCLUDE:$LD_LIBRARY_PATH

<span class="c1">#For using helper routines</span>
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$F</span>IDASIM_DIR/lib:$PATH
</pre></div>


<p>replacing <code>/path/to/fidasim/install</code> with the real directory</p>
<p>While we are at it lets set up your IDL environment as well.
Add the following to your <code>.idl_startup</code> file.</p>
<div class="codehilite"><pre>!path <span class="o">=</span> !path <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="nb">expand_path</span>(<span class="s2">&quot;+&quot;</span> <span class="o">+</span> <span class="nb">getenv</span>(<span class="s2">&quot;FIDASIM_DIR&quot;</span>) <span class="o">+</span> <span class="s2">&quot;/&quot;</span>)
.compile <span class="o">/</span>path<span class="o">/</span>to<span class="o">/</span>fidasim<span class="o">/</span>install<span class="o">/</span>src<span class="o">/</span>prefida.<span class="k">pro</span>
</pre></div>


<p>replacing <code>/path/to/fidasim/install</code> with the real directory</p>
<h2 id="building-fidasim">Building FIDASIM</h2>
<p>Once you are in the source directory run the following</p>
<div class="codehilite"><pre>make
</pre></div>


<p>Once running, go get a coffee since it will take a while because HDF5 is being built as well.</p>
<p>Once make has completed check if FIDASIM compiled correctly.</p>
<div class="codehilite"><pre>user@computer:~/FIDASIM-1.0.0$ ./fidasim
   ____ ____ ___   ___    ____ ____ __  ___
  / __//  _// _ <span class="se">\ </span>/ _ <span class="p">|</span>  / __//  _//  <span class="p">|</span>/  /
 / _/ _/ / / // // __ <span class="p">|</span> _<span class="se">\ \ </span>_/ / / /<span class="p">|</span>_/ / 
/_/  /___//____//_/ <span class="p">|</span>_<span class="p">|</span>/___//___//_/  /_/  

Version: 1.0.0

FIDASIM is released as open <span class="nb">source</span> code under the MIT Licence.
For more information visit http://d3denergetic.github.io/FIDASIM/

usage: ./fidasim namelist_file <span class="o">[</span>num_threads<span class="o">]</span>
</pre></div>


<p>Congrats you installed FIDASIM! But wait there's more.</p>
<h2 id="generating-atomic-tables">Generating Atomic Tables</h2>
<p>Calculating reaction rates on the fly is time consuming so FIDASIM pre-computes them to save time.
The following code snippit will generate the atomic tables using the default settings.
If you want to change the settings you can edit the <code>table_settings.dat</code> namelist file located in the <code>tables</code> directory.</p>
<div class="codehilite"><pre>make atomic_tables
</pre></div>


<p></p><div class="alert alert-warning" role="alert"><h4>Warning</h4>This is computationally expensive so make sure you run this on a computer 
where you won't get angry emails for using up all the CPU's.
Optionally you can add <code>NTHREADS=#</code> to the command to set the number of threads.</div>
<p>Now would be a good time to get more coffee... or maybe a nap. </p>
<h2 id="run-a-test-case">Run a test case</h2>
<p>From within IDL</p>
<div class="codehilite"><pre>IDL<span class="o">&gt;</span> run_tests, <span class="s2">&quot;/place/where/you/want/the/output&quot;</span>
</pre></div>


<p>Some stuff that will make sense later will flash by and when its done you should see something like</p>
<div class="codehilite"><pre>SUCCESS: FIDASIM pre-processing completed
To run FIDASIM use the following command
/u/lstagner/FIDASIM/fidasim /p/fida/lstagner/TEST/test_1a_inputs.dat
</pre></div>


<p>Now do what the computer says.
Think of as good practice for when the <a href="https://www.youtube.com/watch?v=7Pq-S557XQU">robots take over</a>.</p>
<p>It should print out the following. </p>
<div class="codehilite"><pre>[lstagner@dawson061]% /u/lstagner/FIDASIM/fidasim /p/fida/lstagner/TEST/test_1a_inputs.dat
   ____ ____ ___   ___    ____ ____ __  ___
  / __//  _// _ \ / _ |  / __//  _//  |/  /
 / _/ _/ / / // // __ | _\ \ _/ / / /|_/ / 
/_/  /___//____//_/ |_|/___//___//_/  /_/  

Version: v0.3.2-64-g16005c5

FIDASIM is released as open source code under the MIT Licence.
For more information visit http://d3denergetic.github.io/FIDASIM/

---- Shot settings ----
 Shot:        1
 Time: 1000 [ms]
 Runid: test_1a

---- Input files ----
 Tables file: /u/lstagner/FIDASIM/tables/atomic_tables.h5
 Geometry file: /p/fida/lstagner/TEST/test_1a_geometry.h5
 Equilibrium file: /p/fida/lstagner/TEST/test_1a_equilibrium.h5
 Distribution file: /p/fida/lstagner/TEST/test_1a_distribution.h5

---- OpenMP settings ----
 Number of threads: 16

---- Beam grid settings ----
 Nx:  50
 Ny:  60
 Nz:  70
 dV:  8.00 [cm^3]
 alpha:  0.00 [rad]
 beta:   0.00 [rad]
 gamma:  0.00 [rad]
 origin: [   0.00,   0.00,   0.00] [cm]

---- Interpolation grid settings ----
 Nr:  70
 Nz: 100
 dA: 4.10 [cm^2]

---- Neutral beam settings ----
 Beam: test_beam               
 Power:    1.70 [MW]
 Voltage: 72.50 [keV]

---- Atomic tables settings ----
 Maximum n/m:  6
 Beam/Fast-ion mass:  2.014 [amu]
 Thermal/Bulk-ion mass:  2.014 [amu]
 Impurity mass: 12.011 [amu]

---- Fast-ion distribution settings ----
 Distribution type: Fast-ion Density Function F(energy,pitch,R,Z)
 Nenergy =   6
 Npitch  =   6
 Energy range = [67.33, 75.44]
 Pitch  range = [-0.10, 0.10]

---- FIDA/BES settings ----
 FIDA/BES System: SPECTRAL
 Number of channels:   3

---- NPA settings ----
 NPA System: NPA
 Number of channels:   3
 Calculating hit probabilities for NPA channels

ndmc:     1:43:23
     # of markers:     50000
   birth profile written to: /p/fida/lstagner/TEST/test_1a_birth.h5

dcx:      1:43:41
     # of markers:    505020
   dcx written to: /p/fida/lstagner/TEST/test_1a_dcx.h5

halo:     1:44:32
     # of markers:    505180
     # of markers:    310573
     # of markers:    188148
     # of markers:    110872
     # of markers:     62806
     # of markers:     32484
     # of markers:     13881
   neutral density written to: /p/fida/lstagner/TEST/test_1a_neutrals.h5

bremsstrahlung:     1:46:25

fida:     1:46:25
     # of markers:   5049813

   Spectra written to: /p/fida/lstagner/TEST/test_1a_spectra.h5

npa:     1:47:46
     # of markers:    505074
Number of NPA particles that hit a detector:   125638

   NPA data written to: /p/fida/lstagner/TEST/test_1a_npa.h5

fida weight function:     1:49:46
 Number of Channels:   3
 Nlambda: 1000
 Nenergy:  50
 Npitch:  50
 Ngyro: 100
 Maximum Energy:  100.00
 LOS averaged: True

   Channel:   1
   Radius:  200.00
   Mean Fast-ion Density:    7.97429E+11

   Channel:   2
   Radius:  170.00
   Mean Fast-ion Density:    7.98346E+11

   Channel:   3
   Radius:  140.00
   Mean Fast-ion Density:    7.98330E+11

   FIDA weights written to: /p/fida/lstagner/TEST/test_1a_fida_weights.h5

npa weight function:     1:50:02
 Number of Channels:   3
 Nenergy:  50
 Npitch:  50
 Maximum energy:  100.00

   Channel:   1
   Radius:    200.000
   Flux:      1.22243E+14
   Weight:    3.79893E+03

   Channel:   2
   Radius:    170.000
   Flux:      1.07364E+14
   Weight:    1.85565E+03

   Channel:   3
   Radius:    140.000
   Flux:      3.46488E+13
   Weight:    8.81099E+02

   NPA weights written to: /p/fida/lstagner/TEST/test_1a_npa_weights.h5

END: hour, minute, second:  1:53:07
duration:                   0:15:53
</pre></div>


<h2 id="now-what">Now what</h2>
<p>Most likely you won't be satisfied by just running a test case.</p>
<p>To figure out what kind of input files are needed to run FIDASIM click <a href="./input_files/index.html">this</a></p>
    </div>
  </div>

    <hr>
    <footer>
        <div class="row">
        <div class="col-md-4">&copy; 2016 </div>
	<div class="col-md-4"><span class="text-center"> FIDASIM was developed by Luke Stagner</span></div>
        <div class="col-md-4"><span class="pull-right">Documentation generated by <a href="https://github.com/cmacmackin/ford">FORD</a></span></div>
        </div>
        <br>
    </footer>
    </div> <!-- /container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': { 
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>