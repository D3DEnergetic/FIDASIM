<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="">
    
    <meta name="author" content="Chris MacMackin" >
    <link rel="icon" href="../favicon.png">

    <title>colrad &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>1.0.0-rc1</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
				
            <li><a href='../page/index.html'>User Guide</a></li>
				
                
            <li><a href="../lists/files.html">Source Files</a></li>
				
				
            <li><a href="../lists/modules.html">Modules</a></li>
				
				
            <li><a href="../lists/procedures.html">Procedures</a></li>
				
								
            <li><a href="../lists/types.html">Derived Types</a></li>
				
				
            <li><a href="../lists/programs.html">Programs</a></li>
				
          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>colrad
    <small>Subroutine</small>
    
    </h1>
	 
<div class="row">
<div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
  
     <li><a href='../module/libfida.html'>libfida</a></li>
  
     <li class="active">colrad</li>
  </ol>
</div>
</div>
</div>
    
  </div>
  
  <div class="row">
    <div class="col-lg-3">
    
<div id="sidebar">
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars">Variables</a></h3></div>
    <div id="vars" class="panel-collapse collapse">
      <div class="list-group">
        
        <a class="list-group-item" href="../proc/colrad.html#variable-matrix%7E2">matrix</a>
        
        <a class="list-group-item" href="../proc/colrad.html#variable-b_amu%7E3">b_amu</a>
        
        <a class="list-group-item" href="../proc/colrad.html#variable-vnet_square">vnet_square</a>
        
        <a class="list-group-item" href="../proc/colrad.html#variable-eb%7E3">eb</a>
        
        <a class="list-group-item" href="../proc/colrad.html#variable-eigvec%7E2">eigvec</a>
        
        <a class="list-group-item" href="../proc/colrad.html#variable-eigvec_inv">eigvec_inv</a>
        
        <a class="list-group-item" href="../proc/colrad.html#variable-eigval%7E2">eigval</a>
        
        <a class="list-group-item" href="../proc/colrad.html#variable-coef">coef</a>
        
        <a class="list-group-item" href="../proc/colrad.html#variable-exp_eigval_dt">exp_eigval_dt</a>
        
        <a class="list-group-item" href="../proc/colrad.html#variable-iflux">iflux</a>
        
        <a class="list-group-item" href="../proc/colrad.html#variable-n%7E15">n</a>
        
      </div>
    </div>
  </div>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
    <div class="list-group">
      <a class="list-group-item" href="../proc/colrad.html#src">colrad</a>
    </div>
  </div>
  
  <hr>
  
  <div class="panel panel-default">
    <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allprocs">All Procedures</a></h3></div>
    <div id="allprocs" class="panel-collapse collapse">
        <div class="list-group">
          
          <a class="list-group-item" href="../proc/aq_cx.html">Aq_cx</a>
          
          <a class="list-group-item" href="../proc/aq_cx_n.html">Aq_cx_n</a>
          
          <a class="list-group-item" href="../proc/aq_cx_n_adas.html">Aq_cx_n_adas</a>
          
          <a class="list-group-item" href="../proc/aq_cx_n_janev.html">Aq_cx_n_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit.html">Aq_excit</a>
          
          <a class="list-group-item" href="../proc/aq_excit_1_2_janev.html">Aq_excit_1_2_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_1_3_janev.html">Aq_excit_1_3_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_1_4_janev.html">Aq_excit_1_4_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_1_5_janev.html">Aq_excit_1_5_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_1_janev.html">Aq_excit_1_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_10_janev.html">Aq_excit_2_10_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_3_janev.html">Aq_excit_2_3_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_4_janev.html">Aq_excit_2_4_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_5_janev.html">Aq_excit_2_5_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_6_janev.html">Aq_excit_2_6_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_7_janev.html">Aq_excit_2_7_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_8_janev.html">Aq_excit_2_8_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_9_janev.html">Aq_excit_2_9_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_janev.html">Aq_excit_2_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_3_10_janev.html">Aq_excit_3_10_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_3_4_janev.html">Aq_excit_3_4_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_3_5_janev.html">Aq_excit_3_5_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_3_6_janev.html">Aq_excit_3_6_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_3_7_janev.html">Aq_excit_3_7_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_3_8_janev.html">Aq_excit_3_8_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_3_9_janev.html">Aq_excit_3_9_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_3_janev.html">Aq_excit_3_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_n.html">Aq_excit_n</a>
          
          <a class="list-group-item" href="../proc/aq_excit_n_janev.html">Aq_excit_n_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_n_m.html">Aq_excit_n_m</a>
          
          <a class="list-group-item" href="../proc/aq_ioniz.html">Aq_ioniz</a>
          
          <a class="list-group-item" href="../proc/aq_ioniz_n.html">Aq_ioniz_n</a>
          
          <a class="list-group-item" href="../proc/aq_ioniz_n_janev.html">Aq_ioniz_n_janev</a>
          
          <a class="list-group-item" href="../interface/assignment%28%3D%29.html">assignment(=)</a>
          
          <a class="list-group-item" href="../proc/attenuate.html">attenuate</a>
          
          <a class="list-group-item" href="../proc/b5_cx_1_adas.html">B5_cx_1_adas</a>
          
          <a class="list-group-item" href="../proc/b5_cx_1_janev.html">B5_cx_1_janev</a>
          
          <a class="list-group-item" href="../proc/b5_cx_2_adas.html">B5_cx_2_adas</a>
          
          <a class="list-group-item" href="../proc/b5_ioniz_1_janev.html">B5_ioniz_1_janev</a>
          
          <a class="list-group-item" href="../proc/balance.html">balance</a>
          
          <a class="list-group-item" href="../proc/balback.html">balback</a>
          
          <a class="list-group-item" href="../proc/bremsstrahlung.html">bremsstrahlung</a>
          
          <a class="list-group-item" href="../interface/bt_maxwellian.html">bt_maxwellian</a>
          
          <a class="list-group-item" href="../proc/bt_maxwellian_n.html">bt_maxwellian_n</a>
          
          <a class="list-group-item" href="../proc/bt_maxwellian_n_m.html">bt_maxwellian_n_m</a>
          
          <a class="list-group-item" href="../proc/bt_maxwellian_q_n.html">bt_maxwellian_q_n</a>
          
          <a class="list-group-item" href="../proc/bt_maxwellian_q_n_m.html">bt_maxwellian_q_n_m</a>
          
          <a class="list-group-item" href="../proc/c6_cx_1_adas.html">C6_cx_1_adas</a>
          
          <a class="list-group-item" href="../proc/c6_cx_1_janev.html">C6_cx_1_janev</a>
          
          <a class="list-group-item" href="../proc/c6_cx_2_adas.html">C6_cx_2_adas</a>
          
          <a class="list-group-item" href="../proc/c6_cx_3_adas.html">C6_cx_3_adas</a>
          
          <a class="list-group-item" href="../proc/c6_ioniz_1_janev.html">C6_ioniz_1_janev</a>
          
          <a class="list-group-item" href="../proc/calc_perp_vectors.html">calc_perp_vectors</a>
          
          <a class="list-group-item" href="../proc/check_compression_availability.html">check_compression_availability</a>
          
          <a class="list-group-item" href="../proc/colrad.html">colrad</a>
          
          <a class="list-group-item" href="../proc/comabs.html">comabs</a>
          
          <a class="list-group-item" href="../proc/comdiv.html">Comdiv</a>
          
          <a class="list-group-item" href="../proc/cross_product.html">cross_product</a>
          
          <a class="list-group-item" href="../proc/dcx.html">dcx</a>
          
          <a class="list-group-item" href="../proc/e_excit.html">e_excit</a>
          
          <a class="list-group-item" href="../proc/e_excit_1_2_janev.html">e_excit_1_2_janev</a>
          
          <a class="list-group-item" href="../proc/e_excit_1_3_janev.html">e_excit_1_3_janev</a>
          
          <a class="list-group-item" href="../proc/e_excit_1_4_janev.html">e_excit_1_4_janev</a>
          
          <a class="list-group-item" href="../proc/e_excit_1_5_janev.html">e_excit_1_5_janev</a>
          
          <a class="list-group-item" href="../proc/e_excit_1_janev.html">e_excit_1_janev</a>
          
          <a class="list-group-item" href="../proc/e_excit_2_3_janev.html">e_excit_2_3_janev</a>
          
          <a class="list-group-item" href="../proc/e_excit_f.html">e_excit_f</a>
          
          <a class="list-group-item" href="../proc/e_excit_n.html">e_excit_n</a>
          
          <a class="list-group-item" href="../proc/e_excit_n_m.html">e_excit_n_m</a>
          
          <a class="list-group-item" href="../proc/e_ioniz.html">e_ioniz</a>
          
          <a class="list-group-item" href="../proc/e_ioniz_1_janev.html">e_ioniz_1_janev</a>
          
          <a class="list-group-item" href="../proc/e_ioniz_2_janev.html">e_ioniz_2_janev</a>
          
          <a class="list-group-item" href="../proc/e_ioniz_3_janev.html">e_ioniz_3_janev</a>
          
          <a class="list-group-item" href="../proc/e_ioniz_n.html">e_ioniz_n</a>
          
          <a class="list-group-item" href="../proc/eigen.html">eigen</a>
          
          <a class="list-group-item" href="../proc/elmhes.html">elmhes</a>
          
          <a class="list-group-item" href="../proc/elmtrans.html">elmtrans</a>
          
          <a class="list-group-item" href="../proc/fast_ion_assign.html">fast_ion_assign</a>
          
          <a class="list-group-item" href="../proc/ff_add.html">ff_add</a>
          
          <a class="list-group-item" href="../proc/ff_assign.html">ff_assign</a>
          
          <a class="list-group-item" href="../proc/ff_subtract.html">ff_subtract</a>
          
          <a class="list-group-item" href="../proc/fida_f.html">fida_f</a>
          
          <a class="list-group-item" href="../proc/fida_mc.html">fida_mc</a>
          
          <a class="list-group-item" href="../proc/fida_weights_los.html">fida_weights_los</a>
          
          <a class="list-group-item" href="../proc/fida_weights_mc.html">fida_weights_mc</a>
          
          <a class="list-group-item" href="../proc/flf_assign.html">flf_assign</a>
          
          <a class="list-group-item" href="../proc/fs_divide.html">fs_divide</a>
          
          <a class="list-group-item" href="../proc/fs_multiply.html">fs_multiply</a>
          
          <a class="list-group-item" href="../proc/get_beam_cx_prob.html">get_beam_cx_prob</a>
          
          <a class="list-group-item" href="../proc/get_distribution.html">get_distribution</a>
          
          <a class="list-group-item" href="../proc/get_ep_denf.html">get_ep_denf</a>
          
          <a class="list-group-item" href="../proc/get_fields.html">get_fields</a>
          
          <a class="list-group-item" href="../proc/get_indices.html">get_indices</a>
          
          <a class="list-group-item" href="../proc/get_nlaunch.html">get_nlaunch</a>
          
          <a class="list-group-item" href="../proc/get_plasma.html">get_plasma</a>
          
          <a class="list-group-item" href="../proc/get_position.html">get_position</a>
          
          <a class="list-group-item" href="../proc/get_rate_matrix.html">get_rate_matrix</a>
          
          <a class="list-group-item" href="../proc/grid_intersect.html">grid_intersect</a>
          
          <a class="list-group-item" href="../proc/gyro_correction.html">gyro_correction</a>
          
          <a class="list-group-item" href="../interface/h5ltmake_compressed_dataset_double_f.html">h5ltmake_compressed_dataset_double_f</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_double_f_1.html">h5ltmake_compressed_dataset_double_f_1</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_double_f_2.html">h5ltmake_compressed_dataset_double_f_2</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_double_f_3.html">h5ltmake_compressed_dataset_double_f_3</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_double_f_4.html">h5ltmake_compressed_dataset_double_f_4</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_double_f_5.html">h5ltmake_compressed_dataset_double_f_5</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_double_f_6.html">h5ltmake_compressed_dataset_double_f_6</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_double_f_7.html">h5ltmake_compressed_dataset_double_f_7</a>
          
          <a class="list-group-item" href="../interface/h5ltmake_compressed_dataset_int_f.html">h5ltmake_compressed_dataset_int_f</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_int_f_1.html">h5ltmake_compressed_dataset_int_f_1</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_int_f_2.html">h5ltmake_compressed_dataset_int_f_2</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_int_f_3.html">h5ltmake_compressed_dataset_int_f_3</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_int_f_4.html">h5ltmake_compressed_dataset_int_f_4</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_int_f_5.html">h5ltmake_compressed_dataset_int_f_5</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_int_f_6.html">h5ltmake_compressed_dataset_int_f_6</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_int_f_7.html">h5ltmake_compressed_dataset_int_f_7</a>
          
          <a class="list-group-item" href="../proc/h5ltread_dataset_double_scalar_f.html">h5ltread_dataset_double_scalar_f</a>
          
          <a class="list-group-item" href="../proc/h5ltread_dataset_int_scalar_f.html">h5ltread_dataset_int_scalar_f</a>
          
          <a class="list-group-item" href="../proc/halo.html">halo</a>
          
          <a class="list-group-item" href="../proc/hit_npa_detector.html">hit_npa_detector</a>
          
          <a class="list-group-item" href="../proc/hqr2.html">hqr2</a>
          
          <a class="list-group-item" href="../proc/hqrvec.html">hqrvec</a>
          
          <a class="list-group-item" href="../proc/in_boundary.html">in_boundary</a>
          
          <a class="list-group-item" href="../proc/in_plasma.html">in_plasma</a>
          
          <a class="list-group-item" href="../proc/ind2sub.html">ind2sub</a>
          
          <a class="list-group-item" href="../interface/interpol.html">interpol</a>
          
          <a class="list-group-item" href="../proc/interpol1d_arr.html">interpol1D_arr</a>
          
          <a class="list-group-item" href="../proc/interpol1d_coeff.html">interpol1D_coeff</a>
          
          <a class="list-group-item" href="../proc/interpol1d_coeff_arr.html">interpol1D_coeff_arr</a>
          
          <a class="list-group-item" href="../proc/interpol2d_2d_arr.html">interpol2D_2D_arr</a>
          
          <a class="list-group-item" href="../proc/interpol2d_arr.html">interpol2D_arr</a>
          
          <a class="list-group-item" href="../proc/interpol2d_coeff.html">interpol2D_coeff</a>
          
          <a class="list-group-item" href="../proc/interpol2d_coeff_arr.html">interpol2D_coeff_arr</a>
          
          <a class="list-group-item" href="../interface/interpol_coeff.html">interpol_coeff</a>
          
          <a class="list-group-item" href="../proc/lff_assign.html">lff_assign</a>
          
          <a class="list-group-item" href="../proc/lflf_add.html">lflf_add</a>
          
          <a class="list-group-item" href="../proc/lflf_assign.html">lflf_assign</a>
          
          <a class="list-group-item" href="../proc/lflf_subtract.html">lflf_subtract</a>
          
          <a class="list-group-item" href="../proc/lfs_divide.html">lfs_divide</a>
          
          <a class="list-group-item" href="../proc/lfs_multiply.html">lfs_multiply</a>
          
          <a class="list-group-item" href="../proc/line_basis.html">line_basis</a>
          
          <a class="list-group-item" href="../proc/lplp_add.html">lplp_add</a>
          
          <a class="list-group-item" href="../proc/lplp_assign.html">lplp_assign</a>
          
          <a class="list-group-item" href="../proc/lplp_subtract.html">lplp_subtract</a>
          
          <a class="list-group-item" href="../proc/lpp_assign.html">lpp_assign</a>
          
          <a class="list-group-item" href="../proc/lps_divide.html">lps_divide</a>
          
          <a class="list-group-item" href="../proc/lps_multiply.html">lps_multiply</a>
          
          <a class="list-group-item" href="../proc/lubksb.html">lubksb</a>
          
          <a class="list-group-item" href="../proc/ludcmp.html">ludcmp</a>
          
          <a class="list-group-item" href="../proc/m_spread.html">m_spread</a>
          
          <a class="list-group-item" href="../proc/make_beam_grid.html">make_beam_grid</a>
          
          <a class="list-group-item" href="../proc/matinv.html">matinv</a>
          
          <a class="list-group-item" href="../proc/mc_fastion.html">mc_fastion</a>
          
          <a class="list-group-item" href="../proc/mc_halo.html">mc_halo</a>
          
          <a class="list-group-item" href="../proc/mc_nbi.html">mc_nbi</a>
          
          <a class="list-group-item" href="../proc/ndmc.html">ndmc</a>
          
          <a class="list-group-item" href="../proc/neut_rates.html">neut_rates</a>
          
          <a class="list-group-item" href="../proc/normp.html">normp</a>
          
          <a class="list-group-item" href="../proc/npa_f.html">npa_f</a>
          
          <a class="list-group-item" href="../proc/npa_mc.html">npa_mc</a>
          
          <a class="list-group-item" href="../proc/npa_part_assign.html">npa_part_assign</a>
          
          <a class="list-group-item" href="../proc/npa_weights.html">npa_weights</a>
          
          <a class="list-group-item" href="../interface/operator%28%2A%29.html">operator(*)</a>
          
          <a class="list-group-item" href="../interface/operator%28%2B%29.html">operator(+)</a>
          
          <a class="list-group-item" href="../interface/operator%28-%29.html">operator(-)</a>
          
          <a class="list-group-item" href="../interface/operator%28SLASH%29.html">operator(/)</a>
          
          <a class="list-group-item" href="../proc/outerprod.html">outerprod</a>
          
          <a class="list-group-item" href="../proc/p_cx.html">p_cx</a>
          
          <a class="list-group-item" href="../proc/p_cx_1.html">p_cx_1</a>
          
          <a class="list-group-item" href="../proc/p_cx_1_1_adas.html">p_cx_1_1_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_1_2_adas.html">p_cx_1_2_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_1_3_adas.html">p_cx_1_3_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_1_4_adas.html">p_cx_1_4_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_1_janev.html">p_cx_1_janev</a>
          
          <a class="list-group-item" href="../proc/p_cx_2.html">p_cx_2</a>
          
          <a class="list-group-item" href="../proc/p_cx_2_2_adas.html">p_cx_2_2_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_2_3_adas.html">p_cx_2_3_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_2_janev.html">p_cx_2_janev</a>
          
          <a class="list-group-item" href="../proc/p_cx_3.html">p_cx_3</a>
          
          <a class="list-group-item" href="../proc/p_cx_3_2_adas.html">p_cx_3_2_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_3_3_adas.html">p_cx_3_3_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_3_4_adas.html">p_cx_3_4_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_3_5_adas.html">p_cx_3_5_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_3_6inf_adas.html">p_cx_3_6inf_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_3_janev.html">p_cx_3_janev</a>
          
          <a class="list-group-item" href="../proc/p_cx_janev.html">p_cx_janev</a>
          
          <a class="list-group-item" href="../proc/p_cx_n.html">p_cx_n</a>
          
          <a class="list-group-item" href="../proc/p_cx_n_janev.html">p_cx_n_janev</a>
          
          <a class="list-group-item" href="../proc/p_cx_n_m.html">p_cx_n_m</a>
          
          <a class="list-group-item" href="../proc/p_excit.html">p_excit</a>
          
          <a class="list-group-item" href="../proc/p_excit_1_2_janev.html">p_excit_1_2_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_1_3_janev.html">p_excit_1_3_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_1_4_janev.html">p_excit_1_4_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_1_5_janev.html">p_excit_1_5_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_1_6_janev.html">p_excit_1_6_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_1_janev.html">p_excit_1_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_10_janev.html">p_excit_2_10_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_3_janev.html">p_excit_2_3_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_4_janev.html">p_excit_2_4_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_5_janev.html">p_excit_2_5_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_6_janev.html">p_excit_2_6_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_7_janev.html">p_excit_2_7_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_8_janev.html">p_excit_2_8_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_9_janev.html">p_excit_2_9_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_janev.html">p_excit_2_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_3_10_janev.html">p_excit_3_10_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_3_4_janev.html">p_excit_3_4_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_3_5_janev.html">p_excit_3_5_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_3_6_janev.html">p_excit_3_6_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_3_7_janev.html">p_excit_3_7_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_3_8_janev.html">p_excit_3_8_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_3_9_janev.html">p_excit_3_9_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_3_janev.html">p_excit_3_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_n.html">p_excit_n</a>
          
          <a class="list-group-item" href="../proc/p_excit_n_m.html">p_excit_n_m</a>
          
          <a class="list-group-item" href="../proc/p_ioniz.html">p_ioniz</a>
          
          <a class="list-group-item" href="../proc/p_ioniz_1_janev.html">p_ioniz_1_janev</a>
          
          <a class="list-group-item" href="../proc/p_ioniz_2_omullane.html">p_ioniz_2_omullane</a>
          
          <a class="list-group-item" href="../proc/p_ioniz_3_omullane.html">p_ioniz_3_omullane</a>
          
          <a class="list-group-item" href="../proc/p_ioniz_4_omullane.html">p_ioniz_4_omullane</a>
          
          <a class="list-group-item" href="../proc/p_ioniz_5_omullane.html">p_ioniz_5_omullane</a>
          
          <a class="list-group-item" href="../proc/p_ioniz_n.html">p_ioniz_n</a>
          
          <a class="list-group-item" href="../proc/pitch_to_vec.html">pitch_to_vec</a>
          
          <a class="list-group-item" href="../proc/plane_basis.html">plane_basis</a>
          
          <a class="list-group-item" href="../proc/plane_intercept.html">plane_intercept</a>
          
          <a class="list-group-item" href="../proc/plp_assign.html">plp_assign</a>
          
          <a class="list-group-item" href="../proc/pp_add.html">pp_add</a>
          
          <a class="list-group-item" href="../proc/pp_assign.html">pp_assign</a>
          
          <a class="list-group-item" href="../proc/pp_subtract.html">pp_subtract</a>
          
          <a class="list-group-item" href="../proc/print_banner.html">print_banner</a>
          
          <a class="list-group-item" href="../proc/print_default_namelist.html">print_default_namelist</a>
          
          <a class="list-group-item" href="../proc/ps_divide.html">ps_divide</a>
          
          <a class="list-group-item" href="../proc/ps_multiply.html">ps_multiply</a>
          
          <a class="list-group-item" href="../interface/randind.html">randind</a>
          
          <a class="list-group-item" href="../proc/randn.html">randn</a>
          
          <a class="list-group-item" href="../proc/randu.html">randu</a>
          
          <a class="list-group-item" href="../proc/read_beam.html">read_beam</a>
          
          <a class="list-group-item" href="../proc/read_chords.html">read_chords</a>
          
          <a class="list-group-item" href="../proc/read_cross.html">read_cross</a>
          
          <a class="list-group-item" href="../proc/read_distribution.html">read_distribution</a>
          
          <a class="list-group-item" href="../proc/read_equilibrium.html">read_equilibrium</a>
          
          <a class="list-group-item" href="../proc/read_f.html">read_f</a>
          
          <a class="list-group-item" href="../proc/read_inputs.html">read_inputs</a>
          
          <a class="list-group-item" href="../proc/read_mc.html">read_mc</a>
          
          <a class="list-group-item" href="../proc/read_neutrals.html">read_neutrals</a>
          
          <a class="list-group-item" href="../proc/read_npa.html">read_npa</a>
          
          <a class="list-group-item" href="../proc/read_rates.html">read_rates</a>
          
          <a class="list-group-item" href="../proc/read_tables.html">read_tables</a>
          
          <a class="list-group-item" href="../proc/rng_init.html">rng_init</a>
          
          <a class="list-group-item" href="../proc/rng_normal.html">rng_normal</a>
          
          <a class="list-group-item" href="../proc/rng_uniform.html">rng_uniform</a>
          
          <a class="list-group-item" href="../proc/rswap.html">RSWAP</a>
          
          <a class="list-group-item" href="../proc/sf_multiply.html">sf_multiply</a>
          
          <a class="list-group-item" href="../proc/simpsons_rule.html">simpsons_rule</a>
          
          <a class="list-group-item" href="../proc/slf_multiply.html">slf_multiply</a>
          
          <a class="list-group-item" href="../proc/slp_multiply.html">slp_multiply</a>
          
          <a class="list-group-item" href="../proc/sp_multiply.html">sp_multiply</a>
          
          <a class="list-group-item" href="../proc/spectrum.html">spectrum</a>
          
          <a class="list-group-item" href="../proc/store_bes_photons.html">store_bes_photons</a>
          
          <a class="list-group-item" href="../proc/store_births.html">store_births</a>
          
          <a class="list-group-item" href="../proc/store_fida_photons.html">store_fida_photons</a>
          
          <a class="list-group-item" href="../proc/store_fw_photons.html">store_fw_photons</a>
          
          <a class="list-group-item" href="../proc/store_fw_photons_at_chan.html">store_fw_photons_at_chan</a>
          
          <a class="list-group-item" href="../proc/store_neutrals.html">store_neutrals</a>
          
          <a class="list-group-item" href="../proc/store_npa.html">store_npa</a>
          
          <a class="list-group-item" href="../proc/swap.html">swap</a>
          
          <a class="list-group-item" href="../proc/tb_zyx.html">tb_zyx</a>
          
          <a class="list-group-item" href="../proc/track.html">track</a>
          
          <a class="list-group-item" href="../proc/uvw_to_xyz.html">uvw_to_xyz</a>
          
          <a class="list-group-item" href="../proc/write_bb_h_aq.html">write_bb_H_Aq</a>
          
          <a class="list-group-item" href="../proc/write_bb_h_e.html">write_bb_H_e</a>
          
          <a class="list-group-item" href="../proc/write_bb_h_h.html">write_bb_H_H</a>
          
          <a class="list-group-item" href="../proc/write_beam_grid.html">write_beam_grid</a>
          
          <a class="list-group-item" href="../proc/write_birth_profile.html">write_birth_profile</a>
          
          <a class="list-group-item" href="../proc/write_bt_h_aq.html">write_bt_H_Aq</a>
          
          <a class="list-group-item" href="../proc/write_bt_h_e.html">write_bt_H_e</a>
          
          <a class="list-group-item" href="../proc/write_bt_h_h.html">write_bt_H_H</a>
          
          <a class="list-group-item" href="../proc/write_dcx.html">write_dcx</a>
          
          <a class="list-group-item" href="../proc/write_einstein.html">write_einstein</a>
          
          <a class="list-group-item" href="../proc/write_fida_weights.html">write_fida_weights</a>
          
          <a class="list-group-item" href="../proc/write_neutrals.html">write_neutrals</a>
          
          <a class="list-group-item" href="../proc/write_npa.html">write_npa</a>
          
          <a class="list-group-item" href="../proc/write_npa_weights.html">write_npa_weights</a>
          
          <a class="list-group-item" href="../proc/write_spectra.html">write_spectra</a>
          
          <a class="list-group-item" href="../proc/xyz_to_uvw.html">xyz_to_uvw</a>
          
        </div>
    </div>
  </div>
  
</div>

    </div>
    
    <div class="col-lg-9" id='text'>
    <h2>
public subroutine colrad(plasma, i_type, vn, dt, states, dens, photons)
    
    
    
</h2>
    
  



    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-plasma%7E4"></span>type(<a href='../type/localprofiles.html'>LocalProfiles</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>plasma</strong></td><td><p>Plasma parameters</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-i_type%7E2"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>i_type</strong></td><td><p>Ion/Neutral type (beam,thermal)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-vn%7E5"></span>real(kind=Float64),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(:)</td><td>::</td>
  <td><strong>vn</strong></td><td><p>Neutral velocitiy [cm/s]</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dt"></span>real(kind=Float64),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dt</strong></td><td><p>Time interval [s]</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-states"></span>real(kind=Float64),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(:)</td><td>::</td>
  <td><strong>states</strong></td><td><p>Density of states</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dens%7E4"></span>real(kind=Float64),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(nlevs)</td><td>::</td>
  <td><strong>dens</strong></td><td><p>Density of neutrals</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-photons"></span>real(kind=Float64),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>photons</strong></td><td><p>Emitted photons(3-&gt;2)</p></td>
  
</tr>

</tbody>
</table>

    
    
    
    <h3>Description</h3>
    <p>Evolve density of states in time <code>dt</code> via collisional radiative model</p>
    
    
     <h3>Calls</h3>
     
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: proc~~colrad~~CallsGraph Pages: 1 -->
<svg id="proccolradCallsGraph" width="574pt" height="408pt"
 viewBox="0.00 0.00 574.00 408.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~colrad~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 404)">
<title>proc~~colrad~~CallsGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-404 571,-404 571,5 -4,5"/>
<!-- proc~colrad -->
<g id="node1" class="node"><title>proc~colrad</title>
<polygon fill="none" stroke="black" points="54,-161 2.13163e-14,-161 0,-135 54,-135 54,-161"/>
<text text-anchor="middle" x="27" y="-145.55" font-family="Helvetica,sans-Serif" font-size="10.50">colrad</text>
</g>
<!-- proc~eigen -->
<g id="node2" class="node"><title>proc~eigen</title>
<a xlink:href="../proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="161,-290 107,-290 107,-264 161,-264 161,-290"/>
<text text-anchor="middle" x="134" y="-274.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="edge44" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M38.0479,-161.319C56.6456,-183.741 94.3451,-229.192 116.55,-255.963"/>
<polygon fill="#000000" stroke="#000000" points="114.093,-258.483 123.172,-263.945 119.481,-254.014 114.093,-258.483"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="node3" class="node"><title>proc~get_rate_matrix</title>
<a xlink:href="../proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-161 90,-161 90,-135 178,-135 178,-161"/>
<text text-anchor="middle" x="134" y="-145.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="edge46" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M54.0006,-148C61.9173,-148 70.8698,-148 79.8467,-148"/>
<polygon fill="#000000" stroke="#000000" points="79.9386,-151.5 89.9385,-148 79.9385,-144.5 79.9386,-151.5"/>
</g>
<!-- proc~matinv -->
<g id="node4" class="node"><title>proc~matinv</title>
<a xlink:href="../proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="161,-70 107,-70 107,-44 161,-44 161,-70"/>
<text text-anchor="middle" x="134" y="-54.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
<!-- proc~colrad&#45;&gt;proc~matinv -->
<g id="edge48" class="edge"><title>proc~colrad&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M42.3305,-134.962C60.2875,-119.69 90.2152,-94.2375 110.968,-76.5879"/>
<polygon fill="#000000" stroke="#000000" points="113.348,-79.1587 118.698,-70.0139 108.813,-73.8263 113.348,-79.1587"/>
</g>
<!-- proc~balance -->
<g id="node5" class="node"><title>proc~balance</title>
<a xlink:href="../proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="280,-268 226,-268 226,-242 280,-242 280,-268"/>
<text text-anchor="middle" x="253" y="-252.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="edge12" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M161.003,-272.008C177.168,-269.019 197.95,-265.177 215.67,-261.901"/>
<polygon fill="#000000" stroke="#000000" points="216.495,-265.308 225.692,-260.049 215.222,-258.425 216.495,-265.308"/>
</g>
<!-- proc~balback -->
<g id="node6" class="node"><title>proc~balback</title>
<a xlink:href="../proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="280,-224 226,-224 226,-198 280,-198 280,-224"/>
<text text-anchor="middle" x="253" y="-208.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="edge14" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M157.511,-263.961C175.602,-253.927 200.804,-239.949 220.775,-228.873"/>
<polygon fill="#000000" stroke="#000000" points="222.491,-231.923 229.538,-224.012 219.096,-225.802 222.491,-231.923"/>
</g>
<!-- proc~hqr2 -->
<g id="node7" class="node"><title>proc~hqr2</title>
<a xlink:href="../proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="280,-400 226,-400 226,-374 280,-374 280,-400"/>
<text text-anchor="middle" x="253" y="-384.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="edge16" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M143.753,-290.147C157.815,-308.49 185.268,-342.083 214,-365 215.379,-366.1 216.82,-367.177 218.3,-368.228"/>
<polygon fill="#000000" stroke="#000000" points="216.775,-371.411 227.068,-373.92 220.586,-365.539 216.775,-371.411"/>
</g>
<!-- proc~elmtrans -->
<g id="node8" class="node"><title>proc~elmtrans</title>
<a xlink:href="../proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="280,-356 226,-356 226,-330 280,-330 280,-356"/>
<text text-anchor="middle" x="253" y="-340.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="edge18" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M157.511,-290.039C175.602,-300.073 200.804,-314.051 220.775,-325.127"/>
<polygon fill="#000000" stroke="#000000" points="219.096,-328.198 229.538,-329.988 222.491,-322.077 219.096,-328.198"/>
</g>
<!-- proc~elmhes -->
<g id="node9" class="node"><title>proc~elmhes</title>
<a xlink:href="../proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="280,-312 226,-312 226,-286 280,-286 280,-312"/>
<text text-anchor="middle" x="253" y="-296.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="edge20" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M161.003,-281.992C177.168,-284.981 197.95,-288.823 215.67,-292.099"/>
<polygon fill="#000000" stroke="#000000" points="215.222,-295.575 225.692,-293.951 216.495,-288.692 215.222,-295.575"/>
</g>
<!-- interface~interpol_coeff -->
<g id="node23" class="node"><title>interface~interpol_coeff</title>
<a xlink:href="../interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="291,-161 215,-161 215,-135 291,-135 291,-161"/>
<text text-anchor="middle" x="253" y="-145.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="edge34" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M178.311,-148C186.674,-148 195.465,-148 203.962,-148"/>
<polygon fill="#000000" stroke="#000000" points="204.133,-151.5 214.133,-148 204.133,-144.5 204.133,-151.5"/>
</g>
<!-- proc~ludcmp -->
<g id="node35" class="node"><title>proc~ludcmp</title>
<a xlink:href="../proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="280,-70 226,-70 226,-44 280,-44 280,-70"/>
<text text-anchor="middle" x="253" y="-54.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="edge40" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M161.003,-57C177.168,-57 197.95,-57 215.67,-57"/>
<polygon fill="#000000" stroke="#000000" points="215.692,-60.5001 225.692,-57 215.692,-53.5001 215.692,-60.5001"/>
</g>
<!-- proc~lubksb -->
<g id="node36" class="node"><title>proc~lubksb</title>
<a xlink:href="../proc/lubksb.html" xlink:title="lubksb">
<polygon fill="#d9534f" stroke="#d9534f" points="280,-26 226,-26 226,-1.24345e-14 280,-3.55271e-15 280,-26"/>
<text text-anchor="middle" x="253" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lubksb</text>
</a>
</g>
<!-- proc~matinv&#45;&gt;proc~lubksb -->
<g id="edge42" class="edge"><title>proc~matinv&#45;&gt;proc~lubksb</title>
<path fill="none" stroke="#000000" d="M161.003,-47.0157C177.319,-40.9828 198.339,-33.2109 216.166,-26.6192"/>
<polygon fill="#000000" stroke="#000000" points="217.526,-29.8479 225.692,-23.0971 215.099,-23.2824 217.526,-29.8479"/>
</g>
<!-- proc~rswap -->
<g id="node10" class="node"><title>proc~rswap</title>
<a xlink:href="../proc/rswap.html" xlink:title="RSWAP">
<polygon fill="#d9534f" stroke="#d9534f" points="410,-278 356,-278 356,-252 410,-252 410,-278"/>
<text text-anchor="middle" x="383" y="-262.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RSWAP</text>
</a>
</g>
<!-- proc~balance&#45;&gt;proc~rswap -->
<g id="edge2" class="edge"><title>proc~balance&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M280.252,-257.096C299.233,-258.556 324.785,-260.522 345.659,-262.128"/>
<polygon fill="#000000" stroke="#000000" points="345.545,-265.629 355.784,-262.906 346.082,-258.65 345.545,-265.629"/>
</g>
<!-- proc~balback&#45;&gt;proc~rswap -->
<g id="edge4" class="edge"><title>proc~balback&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M280.252,-222.32C299.493,-230.312 325.486,-241.11 346.514,-249.844"/>
<polygon fill="#000000" stroke="#000000" points="345.206,-253.091 355.784,-253.695 347.891,-246.626 345.206,-253.091"/>
</g>
<!-- proc~hqrvec -->
<g id="node13" class="node"><title>proc~hqrvec</title>
<a xlink:href="../proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="410,-400 356,-400 356,-374 410,-374 410,-400"/>
<text text-anchor="middle" x="383" y="-384.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="edge8" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M280.252,-387C299.233,-387 324.785,-387 345.659,-387"/>
<polygon fill="#000000" stroke="#000000" points="345.784,-390.5 355.784,-387 345.784,-383.5 345.784,-390.5"/>
</g>
<!-- proc~elmhes&#45;&gt;proc~rswap -->
<g id="edge10" class="edge"><title>proc~elmhes&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M280.252,-291.872C299.319,-286.886 325.018,-280.164 345.944,-274.692"/>
<polygon fill="#000000" stroke="#000000" points="346.995,-278.035 355.784,-272.118 345.223,-271.262 346.995,-278.035"/>
</g>
<!-- proc~comdiv -->
<g id="node14" class="node"><title>proc~comdiv</title>
<a xlink:href="../proc/comdiv.html" xlink:title="Comdiv">
<polygon fill="#d9534f" stroke="#d9534f" points="547,-400 493,-400 493,-374 547,-374 547,-400"/>
<text text-anchor="middle" x="520" y="-384.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Comdiv</text>
</a>
</g>
<!-- proc~hqrvec&#45;&gt;proc~comdiv -->
<g id="edge6" class="edge"><title>proc~hqrvec&#45;&gt;proc~comdiv</title>
<path fill="none" stroke="#000000" d="M410.067,-387C430.895,-387 459.909,-387 482.901,-387"/>
<polygon fill="#000000" stroke="#000000" points="482.989,-390.5 492.989,-387 482.989,-383.5 482.989,-390.5"/>
</g>
<!-- proc~interpol1d_coeff -->
<g id="node24" class="node"><title>proc~interpol1d_coeff</title>
<a xlink:href="../proc/interpol1d_coeff.html" xlink:title="interpol1D_coeff">
<polygon fill="#d9534f" stroke="#d9534f" points="565,-206 475,-206 475,-180 565,-180 565,-206"/>
<text text-anchor="middle" x="520" y="-190.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol1D_coeff</text>
</a>
</g>
<!-- interface~interpol_coeff&#45;&gt;proc~interpol1d_coeff -->
<g id="edge26" class="edge"><title>interface~interpol_coeff&#45;&gt;proc~interpol1d_coeff</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M264.999,-161.221C278.663,-175.196 302.427,-196.385 328,-205 372.017,-219.828 424.873,-215.004 463.974,-207.504"/>
<polygon fill="#000000" stroke="#000000" points="465.009,-210.865 474.111,-205.441 463.613,-204.006 465.009,-210.865"/>
</g>
<!-- proc~interpol2d_coeff_arr -->
<g id="node25" class="node"><title>proc~interpol2d_coeff_arr</title>
<a xlink:href="../proc/interpol2d_coeff_arr.html" xlink:title="interpol2D_coeff_arr">
<polygon fill="#d9534f" stroke="#d9534f" points="438,-152 328,-152 328,-126 438,-126 438,-152"/>
<text text-anchor="middle" x="383" y="-136.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol2D_coeff_arr</text>
</a>
</g>
<!-- interface~interpol_coeff&#45;&gt;proc~interpol2d_coeff_arr -->
<g id="edge28" class="edge"><title>interface~interpol_coeff&#45;&gt;proc~interpol2d_coeff_arr</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M291.652,-145.324C299.918,-144.752 308.868,-144.132 317.822,-143.512"/>
<polygon fill="#000000" stroke="#000000" points="318.163,-146.997 327.898,-142.815 317.68,-140.014 318.163,-146.997"/>
</g>
<!-- proc~interpol1d_coeff_arr -->
<g id="node26" class="node"><title>proc~interpol1d_coeff_arr</title>
<a xlink:href="../proc/interpol1d_coeff_arr.html" xlink:title="interpol1D_coeff_arr">
<polygon fill="#d9534f" stroke="#d9534f" points="438,-196 328,-196 328,-170 438,-170 438,-196"/>
<text text-anchor="middle" x="383" y="-180.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol1D_coeff_arr</text>
</a>
</g>
<!-- interface~interpol_coeff&#45;&gt;proc~interpol1d_coeff_arr -->
<g id="edge30" class="edge"><title>interface~interpol_coeff&#45;&gt;proc~interpol1d_coeff_arr</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M291.652,-158.406C302.072,-161.212 313.579,-164.31 324.812,-167.334"/>
<polygon fill="#000000" stroke="#000000" points="324.012,-170.743 334.578,-169.963 325.832,-163.984 324.012,-170.743"/>
</g>
<!-- proc~interpol2d_coeff -->
<g id="node27" class="node"><title>proc~interpol2d_coeff</title>
<a xlink:href="../proc/interpol2d_coeff.html" xlink:title="interpol2D_coeff">
<polygon fill="#d9534f" stroke="#d9534f" points="565,-142 475,-142 475,-116 565,-116 565,-142"/>
<text text-anchor="middle" x="520" y="-126.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol2D_coeff</text>
</a>
</g>
<!-- interface~interpol_coeff&#45;&gt;proc~interpol2d_coeff -->
<g id="edge32" class="edge"><title>interface~interpol_coeff&#45;&gt;proc~interpol2d_coeff</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M277.57,-134.973C291.854,-128.141 310.449,-120.484 328,-117 373.258,-108.015 425.586,-112.223 464.171,-118.001"/>
<polygon fill="#000000" stroke="#000000" points="463.748,-121.477 474.171,-119.579 464.839,-114.563 463.748,-121.477"/>
</g>
<!-- proc~interpol2d_coeff_arr&#45;&gt;proc~interpol2d_coeff -->
<g id="edge22" class="edge"><title>proc~interpol2d_coeff_arr&#45;&gt;proc~interpol2d_coeff</title>
<path fill="none" stroke="#000000" d="M438.328,-134.961C446.776,-134.345 455.501,-133.708 463.963,-133.09"/>
<polygon fill="#000000" stroke="#000000" points="464.4,-136.568 474.119,-132.349 463.891,-129.586 464.4,-136.568"/>
</g>
<!-- proc~interpol1d_coeff_arr&#45;&gt;proc~interpol1d_coeff -->
<g id="edge24" class="edge"><title>proc~interpol1d_coeff_arr&#45;&gt;proc~interpol1d_coeff</title>
<path fill="none" stroke="#000000" d="M438.328,-187.039C446.776,-187.655 455.501,-188.292 463.963,-188.91"/>
<polygon fill="#000000" stroke="#000000" points="463.891,-192.414 474.119,-189.651 464.4,-185.432 463.891,-192.414"/>
</g>
<!-- proc~swap -->
<g id="node37" class="node"><title>proc~swap</title>
<a xlink:href="../proc/swap.html" xlink:title="swap">
<polygon fill="#d9534f" stroke="#d9534f" points="410,-70 356,-70 356,-44 410,-44 410,-70"/>
<text text-anchor="middle" x="383" y="-54.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swap</text>
</a>
</g>
<!-- proc~ludcmp&#45;&gt;proc~swap -->
<g id="edge36" class="edge"><title>proc~ludcmp&#45;&gt;proc~swap</title>
<path fill="none" stroke="#000000" d="M280.252,-57C299.233,-57 324.785,-57 345.659,-57"/>
<polygon fill="#000000" stroke="#000000" points="345.784,-60.5001 355.784,-57 345.784,-53.5001 345.784,-60.5001"/>
</g>
<!-- proc~outerprod -->
<g id="node38" class="node"><title>proc~outerprod</title>
<a xlink:href="../proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="412,-26 354,-26 354,-1.24345e-14 412,-3.55271e-15 412,-26"/>
<text text-anchor="middle" x="383" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="edge38" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M280.252,-47.7762C298.552,-41.5826 322.959,-33.3215 343.394,-26.4052"/>
<polygon fill="#000000" stroke="#000000" points="344.712,-29.6542 353.062,-23.1329 342.468,-23.0237 344.712,-29.6542"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
Nodes of different colours represent the following:
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.80" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph1" class="graph" transform="scale(0.817602 0.817602) rotate(0) translate(4 30)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-30 781,-30 781,5 -4,5"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-26 2.13163e-14,-26 0,-1.24345e-14 54,-3.55271e-15 54,-26"/>
<text text-anchor="middle" x="27" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="138,-26 72,-26 72,-1.24345e-14 138,-3.55271e-15 138,-26"/>
<text text-anchor="middle" x="105" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Type -->
<g id="node3" class="node"><title>Type</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="210,-26 156,-26 156,-1.24345e-14 210,-3.55271e-15 210,-26"/>
<text text-anchor="middle" x="183" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type</text>
</g>
<!-- Subroutine -->
<g id="node4" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="292,-26 228,-26 228,-1.24345e-14 292,-3.55271e-15 292,-26"/>
<text text-anchor="middle" x="260" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node5" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="364,-26 310,-26 310,-1.24345e-14 364,-3.55271e-15 364,-26"/>
<text text-anchor="middle" x="337" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node6" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="436,-26 382,-26 382,-1.24345e-14 436,-3.55271e-15 436,-26"/>
<text text-anchor="middle" x="409" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node7" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="590,-26 454,-26 454,-1.24345e-14 590,-3.55271e-15 590,-26"/>
<text text-anchor="middle" x="522" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node8" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="662,-26 608,-26 608,-1.24345e-14 662,-3.55271e-15 662,-26"/>
<text text-anchor="middle" x="635" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node9" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="776,-26 680,-26 680,-1.24345e-14 776,-3.55271e-15 776,-26"/>
<text text-anchor="middle" x="728" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

Where possible, edges connecting nodes are given different colours to make them
easier to distinguish in large graphs.
<h5>Module Graph</h5>
<p>Solid arrows point from a parent (sub)module to the submodule which is
descended from it. Dashed arrows point from a module being used to the
module using it.</p>
<h5>Type Graph</h5>
<p>Solid arrows point from one derived type to another which extends
(inherits from) it. Dashed arrows point from a derived type to another
type containing it as a components, with a label listing the name(s) of
said component(s).</p>
<h5>Call Graph</h5>
<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.</p>

                      </div>
                    </div>
                  </div>
                </div>
                
     
     
     <h3>Called By</h3>
     
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: proc~~colrad~~CalledByGraph Pages: 1 -->
<svg id="proccolradCalledByGraph" width="408pt" height="419pt"
 viewBox="0.00 0.00 408.00 419.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~colrad~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 415)">
<title>proc~~colrad~~CalledByGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-415 405,-415 405,5 -4,5"/>
<!-- proc~colrad -->
<g id="node1" class="node"><title>proc~colrad</title>
<polygon fill="none" stroke="black" points="400,-257 346,-257 346,-231 400,-231 400,-257"/>
<text text-anchor="middle" x="373" y="-241.55" font-family="Helvetica,sans-Serif" font-size="10.50">colrad</text>
</g>
<!-- proc~halo -->
<g id="node2" class="node"><title>proc~halo</title>
<a xlink:href="../proc/halo.html" xlink:title="halo">
<polygon fill="#d9534f" stroke="#d9534f" points="291,-411 237,-411 237,-385 291,-385 291,-411"/>
<text text-anchor="middle" x="264" y="-395.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">halo</text>
</a>
</g>
<!-- proc~halo&#45;&gt;proc~colrad -->
<g id="edge28" class="edge"><title>proc~halo&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M291.274,-388.675C297.985,-385.437 304.744,-381.26 310,-376 340.875,-345.1 358.703,-296.124 367.077,-267.318"/>
<polygon fill="#000000" stroke="#000000" points="370.543,-267.916 369.831,-257.345 363.796,-266.053 370.543,-267.916"/>
</g>
<!-- proc~fida_f -->
<g id="node3" class="node"><title>proc~fida_f</title>
<a xlink:href="../proc/fida_f.html" xlink:title="fida_f">
<polygon fill="#d9534f" stroke="#d9534f" points="291,-367 237,-367 237,-341 291,-341 291,-367"/>
<text text-anchor="middle" x="264" y="-351.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_f</text>
</a>
</g>
<!-- proc~fida_f&#45;&gt;proc~colrad -->
<g id="edge30" class="edge"><title>proc~fida_f&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M291.156,-343.79C297.719,-340.597 304.438,-336.664 310,-332 332.148,-313.429 350.426,-285.402 361.488,-265.989"/>
<polygon fill="#000000" stroke="#000000" points="364.555,-267.676 366.325,-257.23 358.427,-264.292 364.555,-267.676"/>
</g>
<!-- proc~fida_mc -->
<g id="node4" class="node"><title>proc~fida_mc</title>
<a xlink:href="../proc/fida_mc.html" xlink:title="fida_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="291,-323 237,-323 237,-297 291,-297 291,-323"/>
<text text-anchor="middle" x="264" y="-307.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_mc</text>
</a>
</g>
<!-- proc~fida_mc&#45;&gt;proc~colrad -->
<g id="edge32" class="edge"><title>proc~fida_mc&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M291.14,-297.927C297.435,-294.879 304.035,-291.478 310,-288 322.858,-280.503 336.473,-271.184 347.744,-263.055"/>
<polygon fill="#000000" stroke="#000000" points="349.852,-265.85 355.855,-257.12 345.718,-260.201 349.852,-265.85"/>
</g>
<!-- proc~fida_weights_mc -->
<g id="node5" class="node"><title>proc~fida_weights_mc</title>
<a xlink:href="../proc/fida_weights_mc.html" xlink:title="fida_weights_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="310,-279 218,-279 218,-253 310,-253 310,-279"/>
<text text-anchor="middle" x="264" y="-263.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_weights_mc</text>
</a>
</g>
<!-- proc~fida_weights_mc&#45;&gt;proc~colrad -->
<g id="edge34" class="edge"><title>proc~fida_weights_mc&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M310.226,-256.67C318.793,-254.941 327.64,-253.155 335.893,-251.49"/>
<polygon fill="#000000" stroke="#000000" points="336.852,-254.867 345.962,-249.457 335.467,-248.005 336.852,-254.867"/>
</g>
<!-- proc~ndmc -->
<g id="node6" class="node"><title>proc~ndmc</title>
<a xlink:href="../proc/ndmc.html" xlink:title="ndmc">
<polygon fill="#d9534f" stroke="#d9534f" points="291,-235 237,-235 237,-209 291,-209 291,-235"/>
<text text-anchor="middle" x="264" y="-219.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ndmc</text>
</a>
</g>
<!-- proc~ndmc&#45;&gt;proc~colrad -->
<g id="edge36" class="edge"><title>proc~ndmc&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M291.224,-227.495C304.62,-230.198 320.977,-233.5 335.533,-236.438"/>
<polygon fill="#000000" stroke="#000000" points="335.25,-239.951 345.745,-238.499 336.635,-233.09 335.25,-239.951"/>
</g>
<!-- proc~attenuate -->
<g id="node7" class="node"><title>proc~attenuate</title>
<a xlink:href="../proc/attenuate.html" xlink:title="attenuate">
<polygon fill="#d9534f" stroke="#d9534f" points="293,-92 235,-92 235,-66 293,-66 293,-92"/>
<text text-anchor="middle" x="264" y="-76.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">attenuate</text>
</a>
</g>
<!-- proc~attenuate&#45;&gt;proc~colrad -->
<g id="edge38" class="edge"><title>proc~attenuate&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M277.845,-92.2307C287.517,-101.888 300.372,-115.584 310,-129 331.718,-159.263 351.41,-197.821 362.794,-221.706"/>
<polygon fill="#000000" stroke="#000000" points="359.729,-223.413 367.146,-230.978 366.066,-220.438 359.729,-223.413"/>
</g>
<!-- proc~dcx -->
<g id="node8" class="node"><title>proc~dcx</title>
<a xlink:href="../proc/dcx.html" xlink:title="dcx">
<polygon fill="#d9534f" stroke="#d9534f" points="163,-202 109,-202 109,-176 163,-176 163,-202"/>
<text text-anchor="middle" x="136" y="-186.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dcx</text>
</a>
</g>
<!-- proc~dcx&#45;&gt;proc~colrad -->
<g id="edge40" class="edge"><title>proc~dcx&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M163.12,-186.29C198.127,-183.775 260.427,-182.665 310,-200 324.852,-205.194 339.391,-214.94 350.752,-223.943"/>
<polygon fill="#000000" stroke="#000000" points="348.842,-226.906 358.774,-230.594 353.31,-221.517 348.842,-226.906"/>
</g>
<!-- proc~fida_weights_los -->
<g id="node9" class="node"><title>proc~fida_weights_los</title>
<a xlink:href="../proc/fida_weights_los.html" xlink:title="fida_weights_los">
<polygon fill="#d9534f" stroke="#d9534f" points="181,-158 91,-158 91,-132 181,-132 181,-158"/>
<text text-anchor="middle" x="136" y="-142.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fida_weights_los</text>
</a>
</g>
<!-- proc~fida_weights_los&#45;&gt;proc~colrad -->
<g id="edge42" class="edge"><title>proc~fida_weights_los&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M181.693,-147.277C218.292,-150.737 269.954,-159.397 310,-181 328.827,-191.156 345.698,-208.725 357.233,-222.734"/>
<polygon fill="#000000" stroke="#000000" points="354.744,-225.229 363.694,-230.898 360.233,-220.885 354.744,-225.229"/>
</g>
<!-- program~fidasim -->
<g id="node10" class="node"><title>program~fidasim</title>
<a xlink:href="../program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-222 2.13163e-14,-222 0,-196 54,-196 54,-222"/>
<text text-anchor="middle" x="27" y="-206.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
<!-- program~fidasim&#45;&gt;proc~halo -->
<g id="edge2" class="edge"><title>program~fidasim&#45;&gt;proc~halo</title>
<path fill="none" stroke="#000000" d="M33.1124,-222.026C45.5399,-248.085 73.9346,-305.39 90,-320 129.794,-356.189 189.167,-377.861 227.235,-388.866"/>
<polygon fill="#000000" stroke="#000000" points="226.329,-392.247 236.901,-391.563 228.21,-385.504 226.329,-392.247"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_f -->
<g id="edge4" class="edge"><title>program~fidasim&#45;&gt;proc~fida_f</title>
<path fill="none" stroke="#000000" d="M35.304,-222.178C46.1326,-238.429 66.4903,-265.986 90,-283 132.4,-313.686 189.986,-333.793 227.076,-344.531"/>
<polygon fill="#000000" stroke="#000000" points="226.391,-347.974 236.965,-347.312 228.286,-341.235 226.391,-347.974"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_mc -->
<g id="edge6" class="edge"><title>program~fidasim&#45;&gt;proc~fida_mc</title>
<path fill="none" stroke="#000000" d="M43.3304,-222.017C55.6122,-231.33 73.1533,-243.646 90,-252 135.049,-274.338 190.728,-291.187 226.782,-300.819"/>
<polygon fill="#000000" stroke="#000000" points="226.295,-304.309 236.856,-303.458 228.07,-297.538 226.295,-304.309"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_weights_mc -->
<g id="edge8" class="edge"><title>program~fidasim&#45;&gt;proc~fida_weights_mc</title>
<path fill="none" stroke="#000000" d="M54.1581,-217.696C65.2212,-221.106 78.1683,-224.929 90,-228 129.225,-238.182 173.893,-247.898 208.15,-254.957"/>
<polygon fill="#000000" stroke="#000000" points="207.476,-258.392 217.975,-256.968 208.879,-251.534 207.476,-258.392"/>
</g>
<!-- program~fidasim&#45;&gt;proc~ndmc -->
<g id="edge10" class="edge"><title>program~fidasim&#45;&gt;proc~ndmc</title>
<path fill="none" stroke="#000000" d="M54.1869,-210.491C96.5759,-212.816 178.519,-217.311 226.495,-219.943"/>
<polygon fill="#000000" stroke="#000000" points="226.589,-223.453 236.766,-220.506 226.973,-216.464 226.589,-223.453"/>
</g>
<!-- program~fidasim&#45;&gt;proc~dcx -->
<g id="edge24" class="edge"><title>program~fidasim&#45;&gt;proc~dcx</title>
<path fill="none" stroke="#000000" d="M54.2241,-204.005C67.6197,-201.547 83.9774,-198.545 98.533,-195.875"/>
<polygon fill="#000000" stroke="#000000" points="99.541,-199.248 108.745,-194.001 98.2777,-192.363 99.541,-199.248"/>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_weights_los -->
<g id="edge26" class="edge"><title>program~fidasim&#45;&gt;proc~fida_weights_los</title>
<path fill="none" stroke="#000000" d="M45.0351,-195.982C57.4032,-187.305 74.3452,-175.902 90,-167 92.525,-165.564 95.1584,-164.135 97.831,-162.734"/>
<polygon fill="#000000" stroke="#000000" points="99.6235,-165.75 106.968,-158.114 96.4645,-159.503 99.6235,-165.75"/>
</g>
<!-- proc~npa_mc -->
<g id="node16" class="node"><title>proc~npa_mc</title>
<a xlink:href="../proc/npa_mc.html" xlink:title="npa_mc">
<polygon fill="#d9534f" stroke="#d9534f" points="163,-114 109,-114 109,-88 163,-88 163,-114"/>
<text text-anchor="middle" x="136" y="-98.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_mc</text>
</a>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_mc -->
<g id="edge12" class="edge"><title>program~fidasim&#45;&gt;proc~npa_mc</title>
<path fill="none" stroke="#000000" d="M33.9191,-195.771C44.0887,-177.392 64.6406,-144.029 90,-123 93.0558,-120.466 96.4525,-118.145 99.9769,-116.039"/>
<polygon fill="#000000" stroke="#000000" points="101.729,-119.071 108.879,-111.253 98.4144,-112.906 101.729,-119.071"/>
</g>
<!-- proc~npa_f -->
<g id="node17" class="node"><title>proc~npa_f</title>
<a xlink:href="../proc/npa_f.html" xlink:title="npa_f">
<polygon fill="#d9534f" stroke="#d9534f" points="163,-70 109,-70 109,-44 163,-44 163,-70"/>
<text text-anchor="middle" x="136" y="-54.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_f</text>
</a>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_f -->
<g id="edge14" class="edge"><title>program~fidasim&#45;&gt;proc~npa_f</title>
<path fill="none" stroke="#000000" d="M30.2263,-195.856C37.1128,-170.278 55.5069,-113.316 90,-79 92.8829,-76.1319 96.2124,-73.5847 99.7353,-71.3357"/>
<polygon fill="#000000" stroke="#000000" points="101.694,-74.2521 108.747,-66.3461 98.3029,-68.1281 101.694,-74.2521"/>
</g>
<!-- proc~npa_weights -->
<g id="node18" class="node"><title>proc~npa_weights</title>
<a xlink:href="../proc/npa_weights.html" xlink:title="npa_weights">
<polygon fill="#d9534f" stroke="#d9534f" points="172,-26 100,-26 100,-1.24345e-14 172,-3.55271e-15 172,-26"/>
<text text-anchor="middle" x="136" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">npa_weights</text>
</a>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_weights -->
<g id="edge16" class="edge"><title>program~fidasim&#45;&gt;proc~npa_weights</title>
<path fill="none" stroke="#000000" d="M28.3527,-195.929C32.2559,-164.425 46.215,-83.3358 90,-35 90.8692,-34.0405 91.7892,-33.1188 92.7514,-32.2337"/>
<polygon fill="#000000" stroke="#000000" points="94.9404,-34.9665 100.81,-26.1463 90.7212,-29.381 94.9404,-34.9665"/>
</g>
<!-- proc~npa_mc&#45;&gt;proc~attenuate -->
<g id="edge18" class="edge"><title>proc~npa_mc&#45;&gt;proc~attenuate</title>
<path fill="none" stroke="#000000" d="M163.146,-96.3344C181.018,-93.2625 204.708,-89.1908 224.637,-85.7656"/>
<polygon fill="#000000" stroke="#000000" points="225.402,-89.1855 234.664,-84.0421 224.216,-82.2866 225.402,-89.1855"/>
</g>
<!-- proc~npa_f&#45;&gt;proc~attenuate -->
<g id="edge20" class="edge"><title>proc~npa_f&#45;&gt;proc~attenuate</title>
<path fill="none" stroke="#000000" d="M163.146,-61.6656C181.018,-64.7375 204.708,-68.8092 224.637,-72.2344"/>
<polygon fill="#000000" stroke="#000000" points="224.216,-75.7134 234.664,-73.9579 225.402,-68.8145 224.216,-75.7134"/>
</g>
<!-- proc~npa_weights&#45;&gt;proc~attenuate -->
<g id="edge22" class="edge"><title>proc~npa_weights&#45;&gt;proc~attenuate</title>
<path fill="none" stroke="#000000" d="M163.832,-26.0557C169.849,-28.9492 176.157,-32.0373 182,-35 198.467,-43.3502 216.573,-53.0136 231.574,-61.1537"/>
<polygon fill="#000000" stroke="#000000" points="230.014,-64.2895 240.469,-65.9999 233.362,-58.1424 230.014,-64.2895"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
Nodes of different colours represent the following:
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.80" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph1" class="graph" transform="scale(0.817602 0.817602) rotate(0) translate(4 30)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-30 781,-30 781,5 -4,5"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-26 2.13163e-14,-26 0,-1.24345e-14 54,-3.55271e-15 54,-26"/>
<text text-anchor="middle" x="27" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="138,-26 72,-26 72,-1.24345e-14 138,-3.55271e-15 138,-26"/>
<text text-anchor="middle" x="105" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Type -->
<g id="node3" class="node"><title>Type</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="210,-26 156,-26 156,-1.24345e-14 210,-3.55271e-15 210,-26"/>
<text text-anchor="middle" x="183" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type</text>
</g>
<!-- Subroutine -->
<g id="node4" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="292,-26 228,-26 228,-1.24345e-14 292,-3.55271e-15 292,-26"/>
<text text-anchor="middle" x="260" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node5" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="364,-26 310,-26 310,-1.24345e-14 364,-3.55271e-15 364,-26"/>
<text text-anchor="middle" x="337" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node6" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="436,-26 382,-26 382,-1.24345e-14 436,-3.55271e-15 436,-26"/>
<text text-anchor="middle" x="409" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node7" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="590,-26 454,-26 454,-1.24345e-14 590,-3.55271e-15 590,-26"/>
<text text-anchor="middle" x="522" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node8" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="662,-26 608,-26 608,-1.24345e-14 662,-3.55271e-15 662,-26"/>
<text text-anchor="middle" x="635" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node9" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="776,-26 680,-26 680,-1.24345e-14 776,-3.55271e-15 776,-26"/>
<text text-anchor="middle" x="728" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

Where possible, edges connecting nodes are given different colours to make them
easier to distinguish in large graphs.
<h5>Module Graph</h5>
<p>Solid arrows point from a parent (sub)module to the submodule which is
descended from it. Dashed arrows point from a module being used to the
module using it.</p>
<h5>Type Graph</h5>
<p>Solid arrows point from one derived type to another which extends
(inherits from) it. Dashed arrows point from a derived type to another
type containing it as a components, with a label listing the name(s) of
said component(s).</p>
<h5>Call Graph</h5>
<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.</p>

                      </div>
                    </div>
                  </div>
                </div>
                
     
    <br>
    
    <section>
    <h2>Variables</h2>
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Visibility</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-matrix%7E2"></span>real(kind=Float64),</td>
  
  <td>public,</td>
  <td>dimension(nlevs,nlevs)</td><td>::</td>
  <td><strong>matrix</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-b_amu%7E3"></span>real(kind=Float64),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>b_amu</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-vnet_square"></span>real(kind=Float64),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>vnet_square</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-eb%7E3"></span>real(kind=Float64),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>eb</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-eigvec%7E2"></span>real(kind=Float64),</td>
  
  <td>public,</td>
  <td>dimension(nlevs,nlevs)</td><td>::</td>
  <td><strong>eigvec</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-eigvec_inv"></span>real(kind=Float64),</td>
  
  <td>public,</td>
  <td>dimension(nlevs,nlevs)</td><td>::</td>
  <td><strong>eigvec_inv</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-eigval%7E2"></span>real(kind=Float64),</td>
  
  <td>public,</td>
  <td>dimension(nlevs)</td><td>::</td>
  <td><strong>eigval</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-coef"></span>real(kind=Float64),</td>
  
  <td>public,</td>
  <td>dimension(nlevs)</td><td>::</td>
  <td><strong>coef</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-exp_eigval_dt"></span>real(kind=Float64),</td>
  
  <td>public,</td>
  <td>dimension(nlevs)</td><td>::</td>
  <td><strong>exp_eigval_dt</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iflux"></span>real(kind=Float64),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>iflux</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-n%7E15"></span>integer,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>n</strong></td><td></td><td></td><td></td>
  
</tr>

</tbody>
</table>

    </section>
    <br>
    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">colrad</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">i_type</span><span class="p">,</span><span class="n">vn</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">states</span><span class="p">,</span><span class="n">dens</span><span class="p">,</span><span class="n">photons</span><span class="p">)</span>
    <span class="c">!+ Evolve density of states in time `dt` via collisional radiative model</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">plasma</span> 
        <span class="c">!+ Plasma parameters</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">i_type</span> 
        <span class="c">!+ Ion/Neutral type (beam,thermal)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">vn</span>  
        <span class="c">!+ Neutral velocitiy [cm/s]</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">dt</span>
        <span class="c">!+ Time interval [s]</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">states</span>
        <span class="c">!+ Density of states</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dens</span>
        <span class="c">!+ Density of neutrals</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">photons</span>
        <span class="c">!+ Emitted photons(3-&gt;2)</span>
  
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">,</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">matrix</span>  <span class="c">!! Matrix</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">b_amu</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vnet_square</span>    <span class="c">!! net velocity of neutrals squared</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">eb</span>             <span class="c">!! Energy of the fast neutral</span>

    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">,</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">eigvec</span><span class="p">,</span> <span class="n">eigvec_inv</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">eigval</span><span class="p">,</span> <span class="n">coef</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">exp_eigval_dt</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iflux</span> <span class="c">!!Initial total flux</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span>

    <span class="n">photons</span><span class="o">=</span><span class="mf">0.</span><span class="n">d0</span>
    <span class="n">dens</span><span class="o">=</span><span class="mf">0.</span><span class="n">d0</span>
  
    <span class="n">iflux</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">iflux</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">colrad_threshold</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">inputs</span><span class="p">%</span><span class="n">calc_npa</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="k">        return</span>
<span class="k">    </span><span class="n">endif</span>
  
    <span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">plasma</span><span class="p">%</span><span class="n">in_plasma</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">dens</span> <span class="o">=</span> <span class="n">states</span><span class="o">*</span><span class="n">dt</span>
        <span class="k">return</span>
<span class="k">    </span><span class="n">endif</span>
  
    <span class="k">if</span><span class="p">(</span><span class="n">i_type</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">beam_ion</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">b_amu</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">%</span><span class="n">ab</span>
    <span class="k">else</span>
<span class="k">        </span><span class="n">b_amu</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">%</span><span class="n">ai</span>
    <span class="n">endif</span>
    <span class="n">vnet_square</span><span class="o">=</span><span class="nb">dot_product</span><span class="p">(</span><span class="n">vn</span><span class="o">-</span><span class="n">plasma</span><span class="p">%</span><span class="n">vrot</span><span class="p">,</span><span class="n">vn</span><span class="o">-</span><span class="n">plasma</span><span class="p">%</span><span class="n">vrot</span><span class="p">)</span>  <span class="c">![cm/s]</span>
    <span class="n">eb</span> <span class="o">=</span> <span class="n">v2_to_E_per_amu</span><span class="o">*</span><span class="n">b_amu</span><span class="o">*</span><span class="n">vnet_square</span> <span class="c">![kev]</span>
    <span class="k">call </span><span class="n">get_rate_matrix</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span> <span class="n">i_type</span><span class="p">,</span> <span class="n">eb</span><span class="p">,</span> <span class="n">matrix</span><span class="p">)</span>
  
    <span class="k">call </span><span class="n">eigen</span><span class="p">(</span><span class="n">nlevs</span><span class="p">,</span><span class="n">matrix</span><span class="p">,</span> <span class="n">eigvec</span><span class="p">,</span> <span class="n">eigval</span><span class="p">)</span>
    <span class="k">call </span><span class="n">matinv</span><span class="p">(</span><span class="n">eigvec</span><span class="p">,</span> <span class="n">eigvec_inv</span><span class="p">)</span>
    <span class="n">coef</span> <span class="o">=</span> <span class="nb">matmul</span><span class="p">(</span><span class="n">eigvec_inv</span><span class="p">,</span> <span class="n">states</span><span class="p">)</span><span class="c">!coeffs determined from states at t=0</span>
    <span class="n">exp_eigval_dt</span> <span class="o">=</span> <span class="nb">exp</span><span class="p">(</span><span class="n">eigval</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span>   <span class="c">! to improve speed (used twice)</span>
    <span class="k">do </span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nlevs</span>
        <span class="k">if</span><span class="p">(</span><span class="n">eigval</span><span class="p">(</span><span class="n">n</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span> <span class="n">eigval</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">=</span><span class="n">eigval</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span> <span class="c">!protect against dividing by zero</span>
    <span class="n">enddo</span>
  
    <span class="n">states</span> <span class="o">=</span> <span class="nb">matmul</span><span class="p">(</span><span class="n">eigvec</span><span class="p">,</span> <span class="n">coef</span> <span class="o">*</span> <span class="n">exp_eigval_dt</span><span class="p">)</span>  <span class="c">![neutrals/cm^3/s]!</span>
    <span class="n">dens</span>   <span class="o">=</span> <span class="nb">matmul</span><span class="p">(</span><span class="n">eigvec</span><span class="p">,</span><span class="n">coef</span><span class="o">*</span><span class="p">(</span><span class="n">exp_eigval_dt</span><span class="o">-</span><span class="mf">1.</span><span class="n">d0</span><span class="p">)</span><span class="o">/</span><span class="n">eigval</span><span class="p">)</span>
  
    <span class="k">if</span> <span class="p">((</span><span class="nb">minval</span><span class="p">(</span><span class="n">states</span><span class="p">).</span><span class="n">lt</span><span class="p">.</span><span class="mi">0</span><span class="p">).</span><span class="nb">or</span><span class="p">.(</span><span class="nb">minval</span><span class="p">(</span><span class="n">dens</span><span class="p">).</span><span class="n">lt</span><span class="p">.</span><span class="mi">0</span><span class="p">))</span> <span class="k">then</span>
<span class="k">        do </span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nlevs</span>
            <span class="k">if</span><span class="p">(</span><span class="n">states</span><span class="p">(</span><span class="n">n</span><span class="p">).</span><span class="n">lt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="n">states</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">=</span><span class="mf">0.</span><span class="n">d0</span>
            <span class="k">if</span><span class="p">(</span><span class="n">dens</span><span class="p">(</span><span class="n">n</span><span class="p">).</span><span class="n">lt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="n">dens</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">=</span><span class="mf">0.</span><span class="n">d0</span>
        <span class="n">enddo</span>
    <span class="n">endif</span>
  
    <span class="n">photons</span><span class="o">=</span><span class="n">dens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">tables</span><span class="p">%</span><span class="n">einstein</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="c">!! - [Ph/(s*cm^3)] - !!</span>
  
<span class="k">end subroutine </span><span class="n">colrad</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>

    <hr>
    <footer>
      <div class="row">
        <div class="col-md-4">&copy; 2016 </div>
        <div class="col-md-4"><span class="text-center"> FIDASIM was developed by Luke Stagner</span></div>
        <div class="col-md-4">
          <span class="pull-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </span>
        </div>
      </div>
      <br>
    </footer>
    </div> <!-- /container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': { 
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>