<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="">
    
    <meta name="author" content="Chris MacMackin" >
    <link rel="icon" href="../favicon.png">

    <title>fida_mc &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>1.0.0-rc1</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
				
            <li><a href='../page/index.html'>User Guide</a></li>
				
                
            <li><a href="../lists/files.html">Source Files</a></li>
				
				
            <li><a href="../lists/modules.html">Modules</a></li>
				
				
            <li><a href="../lists/procedures.html">Procedures</a></li>
				
								
            <li><a href="../lists/types.html">Derived Types</a></li>
				
				
            <li><a href="../lists/programs.html">Programs</a></li>
				
          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>fida_mc
    <small>Subroutine</small>
    
    </h1>
	 
<div class="row">
<div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
  
     <li><a href='../module/libfida.html'>libfida</a></li>
  
     <li class="active">fida_mc</li>
  </ol>
</div>
</div>
</div>
    
  </div>
  
  <div class="row">
    <div class="col-lg-3">
    
<div id="sidebar">
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars">Variables</a></h3></div>
    <div id="vars" class="panel-collapse collapse">
      <div class="list-group">
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-iion%7E2">iion</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-iphi">iphi</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-fast_ion%7E2">fast_ion</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-fields%7E12">fields</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-plasma%7E12">plasma</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-phi%7E6">phi</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-theta%7E4">theta</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-ri%7E12">ri</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-vi%7E16">vi</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-vi_norm%7E2">vi_norm</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-denn%7E6">denn</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-prob%7E5">prob</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-states%7E7">states</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-ncell%7E7">ncell</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-tracks%7E7">tracks</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-los_intersect%7E3">los_intersect</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-jj%7E5">jj</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-photons%7E12">photons</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-neut_types%7E3">neut_types</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-xyz%7E12">xyz</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-uvw%7E11">uvw</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-r_gyro%7E3">r_gyro</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-uvw_vi">uvw_vi</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-s%7E8">s</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-c%7E5">c</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-maxcnt">maxcnt</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-inv_maxcnt%7E2">inv_maxcnt</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-cnt%7E7">cnt</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-randomu%7E6">randomu</a>
        
        <a class="list-group-item" href="../proc/fida_mc.html#variable-nlaunch%7E6">nlaunch</a>
        
      </div>
    </div>
  </div>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
    <div class="list-group">
      <a class="list-group-item" href="../proc/fida_mc.html#src">fida_mc</a>
    </div>
  </div>
  
  <hr>
  
  <div class="panel panel-default">
    <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allprocs">All Procedures</a></h3></div>
    <div id="allprocs" class="panel-collapse collapse">
        <div class="list-group">
          
          <a class="list-group-item" href="../proc/aq_cx.html">Aq_cx</a>
          
          <a class="list-group-item" href="../proc/aq_cx_n.html">Aq_cx_n</a>
          
          <a class="list-group-item" href="../proc/aq_cx_n_adas.html">Aq_cx_n_adas</a>
          
          <a class="list-group-item" href="../proc/aq_cx_n_janev.html">Aq_cx_n_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit.html">Aq_excit</a>
          
          <a class="list-group-item" href="../proc/aq_excit_1_2_janev.html">Aq_excit_1_2_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_1_3_janev.html">Aq_excit_1_3_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_1_4_janev.html">Aq_excit_1_4_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_1_5_janev.html">Aq_excit_1_5_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_1_janev.html">Aq_excit_1_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_10_janev.html">Aq_excit_2_10_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_3_janev.html">Aq_excit_2_3_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_4_janev.html">Aq_excit_2_4_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_5_janev.html">Aq_excit_2_5_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_6_janev.html">Aq_excit_2_6_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_7_janev.html">Aq_excit_2_7_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_8_janev.html">Aq_excit_2_8_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_9_janev.html">Aq_excit_2_9_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_janev.html">Aq_excit_2_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_3_10_janev.html">Aq_excit_3_10_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_3_4_janev.html">Aq_excit_3_4_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_3_5_janev.html">Aq_excit_3_5_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_3_6_janev.html">Aq_excit_3_6_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_3_7_janev.html">Aq_excit_3_7_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_3_8_janev.html">Aq_excit_3_8_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_3_9_janev.html">Aq_excit_3_9_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_3_janev.html">Aq_excit_3_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_n.html">Aq_excit_n</a>
          
          <a class="list-group-item" href="../proc/aq_excit_n_janev.html">Aq_excit_n_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_n_m.html">Aq_excit_n_m</a>
          
          <a class="list-group-item" href="../proc/aq_ioniz.html">Aq_ioniz</a>
          
          <a class="list-group-item" href="../proc/aq_ioniz_n.html">Aq_ioniz_n</a>
          
          <a class="list-group-item" href="../proc/aq_ioniz_n_janev.html">Aq_ioniz_n_janev</a>
          
          <a class="list-group-item" href="../interface/assignment%28%3D%29.html">assignment(=)</a>
          
          <a class="list-group-item" href="../proc/attenuate.html">attenuate</a>
          
          <a class="list-group-item" href="../proc/b5_cx_1_adas.html">B5_cx_1_adas</a>
          
          <a class="list-group-item" href="../proc/b5_cx_1_janev.html">B5_cx_1_janev</a>
          
          <a class="list-group-item" href="../proc/b5_cx_2_adas.html">B5_cx_2_adas</a>
          
          <a class="list-group-item" href="../proc/b5_ioniz_1_janev.html">B5_ioniz_1_janev</a>
          
          <a class="list-group-item" href="../proc/balance.html">balance</a>
          
          <a class="list-group-item" href="../proc/balback.html">balback</a>
          
          <a class="list-group-item" href="../proc/bremsstrahlung.html">bremsstrahlung</a>
          
          <a class="list-group-item" href="../interface/bt_maxwellian.html">bt_maxwellian</a>
          
          <a class="list-group-item" href="../proc/bt_maxwellian_n.html">bt_maxwellian_n</a>
          
          <a class="list-group-item" href="../proc/bt_maxwellian_n_m.html">bt_maxwellian_n_m</a>
          
          <a class="list-group-item" href="../proc/bt_maxwellian_q_n.html">bt_maxwellian_q_n</a>
          
          <a class="list-group-item" href="../proc/bt_maxwellian_q_n_m.html">bt_maxwellian_q_n_m</a>
          
          <a class="list-group-item" href="../proc/c6_cx_1_adas.html">C6_cx_1_adas</a>
          
          <a class="list-group-item" href="../proc/c6_cx_1_janev.html">C6_cx_1_janev</a>
          
          <a class="list-group-item" href="../proc/c6_cx_2_adas.html">C6_cx_2_adas</a>
          
          <a class="list-group-item" href="../proc/c6_cx_3_adas.html">C6_cx_3_adas</a>
          
          <a class="list-group-item" href="../proc/c6_ioniz_1_janev.html">C6_ioniz_1_janev</a>
          
          <a class="list-group-item" href="../proc/calc_perp_vectors.html">calc_perp_vectors</a>
          
          <a class="list-group-item" href="../proc/check_compression_availability.html">check_compression_availability</a>
          
          <a class="list-group-item" href="../proc/colrad.html">colrad</a>
          
          <a class="list-group-item" href="../proc/comabs.html">comabs</a>
          
          <a class="list-group-item" href="../proc/comdiv.html">Comdiv</a>
          
          <a class="list-group-item" href="../proc/cross_product.html">cross_product</a>
          
          <a class="list-group-item" href="../proc/dcx.html">dcx</a>
          
          <a class="list-group-item" href="../proc/e_excit.html">e_excit</a>
          
          <a class="list-group-item" href="../proc/e_excit_1_2_janev.html">e_excit_1_2_janev</a>
          
          <a class="list-group-item" href="../proc/e_excit_1_3_janev.html">e_excit_1_3_janev</a>
          
          <a class="list-group-item" href="../proc/e_excit_1_4_janev.html">e_excit_1_4_janev</a>
          
          <a class="list-group-item" href="../proc/e_excit_1_5_janev.html">e_excit_1_5_janev</a>
          
          <a class="list-group-item" href="../proc/e_excit_1_janev.html">e_excit_1_janev</a>
          
          <a class="list-group-item" href="../proc/e_excit_2_3_janev.html">e_excit_2_3_janev</a>
          
          <a class="list-group-item" href="../proc/e_excit_f.html">e_excit_f</a>
          
          <a class="list-group-item" href="../proc/e_excit_n.html">e_excit_n</a>
          
          <a class="list-group-item" href="../proc/e_excit_n_m.html">e_excit_n_m</a>
          
          <a class="list-group-item" href="../proc/e_ioniz.html">e_ioniz</a>
          
          <a class="list-group-item" href="../proc/e_ioniz_1_janev.html">e_ioniz_1_janev</a>
          
          <a class="list-group-item" href="../proc/e_ioniz_2_janev.html">e_ioniz_2_janev</a>
          
          <a class="list-group-item" href="../proc/e_ioniz_3_janev.html">e_ioniz_3_janev</a>
          
          <a class="list-group-item" href="../proc/e_ioniz_n.html">e_ioniz_n</a>
          
          <a class="list-group-item" href="../proc/eigen.html">eigen</a>
          
          <a class="list-group-item" href="../proc/elmhes.html">elmhes</a>
          
          <a class="list-group-item" href="../proc/elmtrans.html">elmtrans</a>
          
          <a class="list-group-item" href="../proc/fast_ion_assign.html">fast_ion_assign</a>
          
          <a class="list-group-item" href="../proc/ff_add.html">ff_add</a>
          
          <a class="list-group-item" href="../proc/ff_assign.html">ff_assign</a>
          
          <a class="list-group-item" href="../proc/ff_subtract.html">ff_subtract</a>
          
          <a class="list-group-item" href="../proc/fida_f.html">fida_f</a>
          
          <a class="list-group-item" href="../proc/fida_mc.html">fida_mc</a>
          
          <a class="list-group-item" href="../proc/fida_weights_los.html">fida_weights_los</a>
          
          <a class="list-group-item" href="../proc/fida_weights_mc.html">fida_weights_mc</a>
          
          <a class="list-group-item" href="../proc/flf_assign.html">flf_assign</a>
          
          <a class="list-group-item" href="../proc/fs_divide.html">fs_divide</a>
          
          <a class="list-group-item" href="../proc/fs_multiply.html">fs_multiply</a>
          
          <a class="list-group-item" href="../proc/get_beam_cx_prob.html">get_beam_cx_prob</a>
          
          <a class="list-group-item" href="../proc/get_distribution.html">get_distribution</a>
          
          <a class="list-group-item" href="../proc/get_ep_denf.html">get_ep_denf</a>
          
          <a class="list-group-item" href="../proc/get_fields.html">get_fields</a>
          
          <a class="list-group-item" href="../proc/get_indices.html">get_indices</a>
          
          <a class="list-group-item" href="../proc/get_nlaunch.html">get_nlaunch</a>
          
          <a class="list-group-item" href="../proc/get_plasma.html">get_plasma</a>
          
          <a class="list-group-item" href="../proc/get_position.html">get_position</a>
          
          <a class="list-group-item" href="../proc/get_rate_matrix.html">get_rate_matrix</a>
          
          <a class="list-group-item" href="../proc/grid_intersect.html">grid_intersect</a>
          
          <a class="list-group-item" href="../proc/gyro_correction.html">gyro_correction</a>
          
          <a class="list-group-item" href="../interface/h5ltmake_compressed_dataset_double_f.html">h5ltmake_compressed_dataset_double_f</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_double_f_1.html">h5ltmake_compressed_dataset_double_f_1</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_double_f_2.html">h5ltmake_compressed_dataset_double_f_2</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_double_f_3.html">h5ltmake_compressed_dataset_double_f_3</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_double_f_4.html">h5ltmake_compressed_dataset_double_f_4</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_double_f_5.html">h5ltmake_compressed_dataset_double_f_5</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_double_f_6.html">h5ltmake_compressed_dataset_double_f_6</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_double_f_7.html">h5ltmake_compressed_dataset_double_f_7</a>
          
          <a class="list-group-item" href="../interface/h5ltmake_compressed_dataset_int_f.html">h5ltmake_compressed_dataset_int_f</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_int_f_1.html">h5ltmake_compressed_dataset_int_f_1</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_int_f_2.html">h5ltmake_compressed_dataset_int_f_2</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_int_f_3.html">h5ltmake_compressed_dataset_int_f_3</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_int_f_4.html">h5ltmake_compressed_dataset_int_f_4</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_int_f_5.html">h5ltmake_compressed_dataset_int_f_5</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_int_f_6.html">h5ltmake_compressed_dataset_int_f_6</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_int_f_7.html">h5ltmake_compressed_dataset_int_f_7</a>
          
          <a class="list-group-item" href="../proc/h5ltread_dataset_double_scalar_f.html">h5ltread_dataset_double_scalar_f</a>
          
          <a class="list-group-item" href="../proc/h5ltread_dataset_int_scalar_f.html">h5ltread_dataset_int_scalar_f</a>
          
          <a class="list-group-item" href="../proc/halo.html">halo</a>
          
          <a class="list-group-item" href="../proc/hit_npa_detector.html">hit_npa_detector</a>
          
          <a class="list-group-item" href="../proc/hqr2.html">hqr2</a>
          
          <a class="list-group-item" href="../proc/hqrvec.html">hqrvec</a>
          
          <a class="list-group-item" href="../proc/in_boundary.html">in_boundary</a>
          
          <a class="list-group-item" href="../proc/in_plasma.html">in_plasma</a>
          
          <a class="list-group-item" href="../proc/ind2sub.html">ind2sub</a>
          
          <a class="list-group-item" href="../interface/interpol.html">interpol</a>
          
          <a class="list-group-item" href="../proc/interpol1d_arr.html">interpol1D_arr</a>
          
          <a class="list-group-item" href="../proc/interpol1d_coeff.html">interpol1D_coeff</a>
          
          <a class="list-group-item" href="../proc/interpol1d_coeff_arr.html">interpol1D_coeff_arr</a>
          
          <a class="list-group-item" href="../proc/interpol2d_2d_arr.html">interpol2D_2D_arr</a>
          
          <a class="list-group-item" href="../proc/interpol2d_arr.html">interpol2D_arr</a>
          
          <a class="list-group-item" href="../proc/interpol2d_coeff.html">interpol2D_coeff</a>
          
          <a class="list-group-item" href="../proc/interpol2d_coeff_arr.html">interpol2D_coeff_arr</a>
          
          <a class="list-group-item" href="../interface/interpol_coeff.html">interpol_coeff</a>
          
          <a class="list-group-item" href="../proc/lff_assign.html">lff_assign</a>
          
          <a class="list-group-item" href="../proc/lflf_add.html">lflf_add</a>
          
          <a class="list-group-item" href="../proc/lflf_assign.html">lflf_assign</a>
          
          <a class="list-group-item" href="../proc/lflf_subtract.html">lflf_subtract</a>
          
          <a class="list-group-item" href="../proc/lfs_divide.html">lfs_divide</a>
          
          <a class="list-group-item" href="../proc/lfs_multiply.html">lfs_multiply</a>
          
          <a class="list-group-item" href="../proc/line_basis.html">line_basis</a>
          
          <a class="list-group-item" href="../proc/lplp_add.html">lplp_add</a>
          
          <a class="list-group-item" href="../proc/lplp_assign.html">lplp_assign</a>
          
          <a class="list-group-item" href="../proc/lplp_subtract.html">lplp_subtract</a>
          
          <a class="list-group-item" href="../proc/lpp_assign.html">lpp_assign</a>
          
          <a class="list-group-item" href="../proc/lps_divide.html">lps_divide</a>
          
          <a class="list-group-item" href="../proc/lps_multiply.html">lps_multiply</a>
          
          <a class="list-group-item" href="../proc/lubksb.html">lubksb</a>
          
          <a class="list-group-item" href="../proc/ludcmp.html">ludcmp</a>
          
          <a class="list-group-item" href="../proc/m_spread.html">m_spread</a>
          
          <a class="list-group-item" href="../proc/make_beam_grid.html">make_beam_grid</a>
          
          <a class="list-group-item" href="../proc/matinv.html">matinv</a>
          
          <a class="list-group-item" href="../proc/mc_fastion.html">mc_fastion</a>
          
          <a class="list-group-item" href="../proc/mc_halo.html">mc_halo</a>
          
          <a class="list-group-item" href="../proc/mc_nbi.html">mc_nbi</a>
          
          <a class="list-group-item" href="../proc/ndmc.html">ndmc</a>
          
          <a class="list-group-item" href="../proc/neut_rates.html">neut_rates</a>
          
          <a class="list-group-item" href="../proc/normp.html">normp</a>
          
          <a class="list-group-item" href="../proc/npa_f.html">npa_f</a>
          
          <a class="list-group-item" href="../proc/npa_mc.html">npa_mc</a>
          
          <a class="list-group-item" href="../proc/npa_part_assign.html">npa_part_assign</a>
          
          <a class="list-group-item" href="../proc/npa_weights.html">npa_weights</a>
          
          <a class="list-group-item" href="../interface/operator%28%2A%29.html">operator(*)</a>
          
          <a class="list-group-item" href="../interface/operator%28%2B%29.html">operator(+)</a>
          
          <a class="list-group-item" href="../interface/operator%28-%29.html">operator(-)</a>
          
          <a class="list-group-item" href="../interface/operator%28SLASH%29.html">operator(/)</a>
          
          <a class="list-group-item" href="../proc/outerprod.html">outerprod</a>
          
          <a class="list-group-item" href="../proc/p_cx.html">p_cx</a>
          
          <a class="list-group-item" href="../proc/p_cx_1.html">p_cx_1</a>
          
          <a class="list-group-item" href="../proc/p_cx_1_1_adas.html">p_cx_1_1_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_1_2_adas.html">p_cx_1_2_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_1_3_adas.html">p_cx_1_3_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_1_4_adas.html">p_cx_1_4_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_1_janev.html">p_cx_1_janev</a>
          
          <a class="list-group-item" href="../proc/p_cx_2.html">p_cx_2</a>
          
          <a class="list-group-item" href="../proc/p_cx_2_2_adas.html">p_cx_2_2_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_2_3_adas.html">p_cx_2_3_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_2_janev.html">p_cx_2_janev</a>
          
          <a class="list-group-item" href="../proc/p_cx_3.html">p_cx_3</a>
          
          <a class="list-group-item" href="../proc/p_cx_3_2_adas.html">p_cx_3_2_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_3_3_adas.html">p_cx_3_3_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_3_4_adas.html">p_cx_3_4_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_3_5_adas.html">p_cx_3_5_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_3_6inf_adas.html">p_cx_3_6inf_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_3_janev.html">p_cx_3_janev</a>
          
          <a class="list-group-item" href="../proc/p_cx_janev.html">p_cx_janev</a>
          
          <a class="list-group-item" href="../proc/p_cx_n.html">p_cx_n</a>
          
          <a class="list-group-item" href="../proc/p_cx_n_janev.html">p_cx_n_janev</a>
          
          <a class="list-group-item" href="../proc/p_cx_n_m.html">p_cx_n_m</a>
          
          <a class="list-group-item" href="../proc/p_excit.html">p_excit</a>
          
          <a class="list-group-item" href="../proc/p_excit_1_2_janev.html">p_excit_1_2_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_1_3_janev.html">p_excit_1_3_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_1_4_janev.html">p_excit_1_4_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_1_5_janev.html">p_excit_1_5_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_1_6_janev.html">p_excit_1_6_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_1_janev.html">p_excit_1_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_10_janev.html">p_excit_2_10_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_3_janev.html">p_excit_2_3_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_4_janev.html">p_excit_2_4_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_5_janev.html">p_excit_2_5_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_6_janev.html">p_excit_2_6_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_7_janev.html">p_excit_2_7_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_8_janev.html">p_excit_2_8_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_9_janev.html">p_excit_2_9_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_janev.html">p_excit_2_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_3_10_janev.html">p_excit_3_10_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_3_4_janev.html">p_excit_3_4_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_3_5_janev.html">p_excit_3_5_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_3_6_janev.html">p_excit_3_6_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_3_7_janev.html">p_excit_3_7_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_3_8_janev.html">p_excit_3_8_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_3_9_janev.html">p_excit_3_9_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_3_janev.html">p_excit_3_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_n.html">p_excit_n</a>
          
          <a class="list-group-item" href="../proc/p_excit_n_m.html">p_excit_n_m</a>
          
          <a class="list-group-item" href="../proc/p_ioniz.html">p_ioniz</a>
          
          <a class="list-group-item" href="../proc/p_ioniz_1_janev.html">p_ioniz_1_janev</a>
          
          <a class="list-group-item" href="../proc/p_ioniz_2_omullane.html">p_ioniz_2_omullane</a>
          
          <a class="list-group-item" href="../proc/p_ioniz_3_omullane.html">p_ioniz_3_omullane</a>
          
          <a class="list-group-item" href="../proc/p_ioniz_4_omullane.html">p_ioniz_4_omullane</a>
          
          <a class="list-group-item" href="../proc/p_ioniz_5_omullane.html">p_ioniz_5_omullane</a>
          
          <a class="list-group-item" href="../proc/p_ioniz_n.html">p_ioniz_n</a>
          
          <a class="list-group-item" href="../proc/pitch_to_vec.html">pitch_to_vec</a>
          
          <a class="list-group-item" href="../proc/plane_basis.html">plane_basis</a>
          
          <a class="list-group-item" href="../proc/plane_intercept.html">plane_intercept</a>
          
          <a class="list-group-item" href="../proc/plp_assign.html">plp_assign</a>
          
          <a class="list-group-item" href="../proc/pp_add.html">pp_add</a>
          
          <a class="list-group-item" href="../proc/pp_assign.html">pp_assign</a>
          
          <a class="list-group-item" href="../proc/pp_subtract.html">pp_subtract</a>
          
          <a class="list-group-item" href="../proc/print_banner.html">print_banner</a>
          
          <a class="list-group-item" href="../proc/print_default_namelist.html">print_default_namelist</a>
          
          <a class="list-group-item" href="../proc/ps_divide.html">ps_divide</a>
          
          <a class="list-group-item" href="../proc/ps_multiply.html">ps_multiply</a>
          
          <a class="list-group-item" href="../interface/randind.html">randind</a>
          
          <a class="list-group-item" href="../proc/randn.html">randn</a>
          
          <a class="list-group-item" href="../proc/randu.html">randu</a>
          
          <a class="list-group-item" href="../proc/read_beam.html">read_beam</a>
          
          <a class="list-group-item" href="../proc/read_chords.html">read_chords</a>
          
          <a class="list-group-item" href="../proc/read_cross.html">read_cross</a>
          
          <a class="list-group-item" href="../proc/read_distribution.html">read_distribution</a>
          
          <a class="list-group-item" href="../proc/read_equilibrium.html">read_equilibrium</a>
          
          <a class="list-group-item" href="../proc/read_f.html">read_f</a>
          
          <a class="list-group-item" href="../proc/read_inputs.html">read_inputs</a>
          
          <a class="list-group-item" href="../proc/read_mc.html">read_mc</a>
          
          <a class="list-group-item" href="../proc/read_neutrals.html">read_neutrals</a>
          
          <a class="list-group-item" href="../proc/read_npa.html">read_npa</a>
          
          <a class="list-group-item" href="../proc/read_rates.html">read_rates</a>
          
          <a class="list-group-item" href="../proc/read_tables.html">read_tables</a>
          
          <a class="list-group-item" href="../proc/rng_init.html">rng_init</a>
          
          <a class="list-group-item" href="../proc/rng_normal.html">rng_normal</a>
          
          <a class="list-group-item" href="../proc/rng_uniform.html">rng_uniform</a>
          
          <a class="list-group-item" href="../proc/rswap.html">RSWAP</a>
          
          <a class="list-group-item" href="../proc/sf_multiply.html">sf_multiply</a>
          
          <a class="list-group-item" href="../proc/simpsons_rule.html">simpsons_rule</a>
          
          <a class="list-group-item" href="../proc/slf_multiply.html">slf_multiply</a>
          
          <a class="list-group-item" href="../proc/slp_multiply.html">slp_multiply</a>
          
          <a class="list-group-item" href="../proc/sp_multiply.html">sp_multiply</a>
          
          <a class="list-group-item" href="../proc/spectrum.html">spectrum</a>
          
          <a class="list-group-item" href="../proc/store_bes_photons.html">store_bes_photons</a>
          
          <a class="list-group-item" href="../proc/store_births.html">store_births</a>
          
          <a class="list-group-item" href="../proc/store_fida_photons.html">store_fida_photons</a>
          
          <a class="list-group-item" href="../proc/store_fw_photons.html">store_fw_photons</a>
          
          <a class="list-group-item" href="../proc/store_fw_photons_at_chan.html">store_fw_photons_at_chan</a>
          
          <a class="list-group-item" href="../proc/store_neutrals.html">store_neutrals</a>
          
          <a class="list-group-item" href="../proc/store_npa.html">store_npa</a>
          
          <a class="list-group-item" href="../proc/swap.html">swap</a>
          
          <a class="list-group-item" href="../proc/tb_zyx.html">tb_zyx</a>
          
          <a class="list-group-item" href="../proc/track.html">track</a>
          
          <a class="list-group-item" href="../proc/uvw_to_xyz.html">uvw_to_xyz</a>
          
          <a class="list-group-item" href="../proc/write_bb_h_aq.html">write_bb_H_Aq</a>
          
          <a class="list-group-item" href="../proc/write_bb_h_e.html">write_bb_H_e</a>
          
          <a class="list-group-item" href="../proc/write_bb_h_h.html">write_bb_H_H</a>
          
          <a class="list-group-item" href="../proc/write_beam_grid.html">write_beam_grid</a>
          
          <a class="list-group-item" href="../proc/write_birth_profile.html">write_birth_profile</a>
          
          <a class="list-group-item" href="../proc/write_bt_h_aq.html">write_bt_H_Aq</a>
          
          <a class="list-group-item" href="../proc/write_bt_h_e.html">write_bt_H_e</a>
          
          <a class="list-group-item" href="../proc/write_bt_h_h.html">write_bt_H_H</a>
          
          <a class="list-group-item" href="../proc/write_dcx.html">write_dcx</a>
          
          <a class="list-group-item" href="../proc/write_einstein.html">write_einstein</a>
          
          <a class="list-group-item" href="../proc/write_fida_weights.html">write_fida_weights</a>
          
          <a class="list-group-item" href="../proc/write_neutrals.html">write_neutrals</a>
          
          <a class="list-group-item" href="../proc/write_npa.html">write_npa</a>
          
          <a class="list-group-item" href="../proc/write_npa_weights.html">write_npa_weights</a>
          
          <a class="list-group-item" href="../proc/write_spectra.html">write_spectra</a>
          
          <a class="list-group-item" href="../proc/xyz_to_uvw.html">xyz_to_uvw</a>
          
        </div>
    </div>
  </div>
  
</div>

    </div>
    
    <div class="col-lg-9" id='text'>
    <h2>
public subroutine fida_mc()
    
    
    
</h2>
    
  



    <h3>Arguments</h3>
    
      <em>None</em>
    
    
    
    <h3>Description</h3>
    <p>Calculate FIDA emission using a Monte Carlo Fast-ion distribution</p>
    
    
     <h3>Calls</h3>
     
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: proc~~fida_mc~~CallsGraph Pages: 1 -->
<svg id="procfida_mcCallsGraph" width="641pt" height="465pt"
 viewBox="0.00 0.00 641.00 465.16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~fida_mc~~CallsGraph" class="graph" transform="scale(0.520292 0.520292) rotate(0) translate(4 890.033)">
<title>proc~~fida_mc~~CallsGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-890.033 1229,-890.033 1229,5 -4,5"/>
<!-- proc~fida_mc -->
<g id="node1" class="node"><title>proc~fida_mc</title>
<polygon fill="none" stroke="black" points="54,-539 2.13163e-14,-539 0,-513 54,-513 54,-539"/>
<text text-anchor="middle" x="27" y="-523.55" font-family="Helvetica,sans-Serif" font-size="10.50">fida_mc</text>
</g>
<!-- proc~pitch_to_vec -->
<g id="node2" class="node"><title>proc~pitch_to_vec</title>
<a xlink:href="../proc/pitch_to_vec.html" xlink:title="pitch_to_vec">
<polygon fill="#d9534f" stroke="#d9534f" points="179,-727 107,-727 107,-701 179,-701 179,-727"/>
<text text-anchor="middle" x="143" y="-711.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pitch_to_vec</text>
</a>
</g>
<!-- proc~fida_mc&#45;&gt;proc~pitch_to_vec -->
<g id="edge128" class="edge"><title>proc~fida_mc&#45;&gt;proc~pitch_to_vec</title>
<path fill="none" stroke="#000000" d="M28.9378,-539.357C33.9106,-569.274 49.6862,-642.52 90,-687 92.8476,-690.142 96.1454,-692.971 99.6755,-695.506"/>
<polygon fill="#000000" stroke="#000000" points="97.9055,-698.527 108.232,-700.897 101.637,-692.605 97.9055,-698.527"/>
</g>
<!-- proc~get_fields -->
<g id="node3" class="node"><title>proc~get_fields</title>
<a xlink:href="../proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="435,-703 377,-703 377,-677 435,-677 435,-703"/>
<text text-anchor="middle" x="406" y="-687.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
<!-- proc~fida_mc&#45;&gt;proc~get_fields -->
<g id="edge130" class="edge"><title>proc~fida_mc&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M37.2091,-539.091C48.6508,-552.911 68.4432,-574.402 90,-587 188.464,-644.543 228.739,-621.25 336,-660 346.663,-663.852 358.037,-668.49 368.448,-672.954"/>
<polygon fill="#000000" stroke="#000000" points="367.126,-676.196 377.692,-676.978 369.92,-669.778 367.126,-676.196"/>
</g>
<!-- proc~store_fida_photons -->
<g id="node4" class="node"><title>proc~store_fida_photons</title>
<a xlink:href="../proc/store_fida_photons.html" xlink:title="store_fida_photons">
<polygon fill="#d9534f" stroke="#d9534f" points="336,-695 232,-695 232,-669 336,-669 336,-695"/>
<text text-anchor="middle" x="284" y="-679.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_fida_photons</text>
</a>
</g>
<!-- proc~fida_mc&#45;&gt;proc~store_fida_photons -->
<g id="edge132" class="edge"><title>proc~fida_mc&#45;&gt;proc~store_fida_photons</title>
<path fill="none" stroke="#000000" d="M29.6922,-539.304C35.6427,-565.027 52.4718,-621.467 90,-649 127.71,-676.667 180.566,-684.18 221.586,-685.183"/>
<polygon fill="#000000" stroke="#000000" points="221.701,-688.685 231.743,-685.306 221.786,-681.685 221.701,-688.685"/>
</g>
<!-- proc~gyro_correction -->
<g id="node5" class="node"><title>proc~gyro_correction</title>
<a xlink:href="../proc/gyro_correction.html" xlink:title="gyro_correction">
<polygon fill="#d9534f" stroke="#d9534f" points="186,-287 100,-287 100,-261 186,-261 186,-287"/>
<text text-anchor="middle" x="143" y="-271.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_correction</text>
</a>
</g>
<!-- proc~fida_mc&#45;&gt;proc~gyro_correction -->
<g id="edge134" class="edge"><title>proc~fida_mc&#45;&gt;proc~gyro_correction</title>
<path fill="none" stroke="#000000" d="M29.066,-512.761C36.1384,-468.923 60.5745,-329.391 90,-296 90.8707,-295.012 91.7928,-294.067 92.7586,-293.164"/>
<polygon fill="#000000" stroke="#000000" points="95.0211,-295.842 100.894,-287.023 90.8036,-290.255 95.0211,-295.842"/>
</g>
<!-- proc~colrad -->
<g id="node6" class="node"><title>proc~colrad</title>
<a xlink:href="../proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="170,-331 116,-331 116,-305 170,-305 170,-331"/>
<text text-anchor="middle" x="143" y="-315.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
<!-- proc~fida_mc&#45;&gt;proc~colrad -->
<g id="edge136" class="edge"><title>proc~fida_mc&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M31.5065,-512.91C40.6368,-487.192 62.7824,-428.686 90,-384 99.7826,-367.939 113.029,-351.443 123.831,-338.96"/>
<polygon fill="#000000" stroke="#000000" points="126.525,-341.197 130.516,-331.382 121.276,-336.566 126.525,-341.197"/>
</g>
<!-- proc~uvw_to_xyz -->
<g id="node7" class="node"><title>proc~uvw_to_xyz</title>
<a xlink:href="../proc/uvw_to_xyz.html" xlink:title="uvw_to_xyz">
<polygon fill="#d9534f" stroke="#d9534f" points="177,-243 109,-243 109,-217 177,-217 177,-243"/>
<text text-anchor="middle" x="143" y="-227.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">uvw_to_xyz</text>
</a>
</g>
<!-- proc~fida_mc&#45;&gt;proc~uvw_to_xyz -->
<g id="edge138" class="edge"><title>proc~fida_mc&#45;&gt;proc~uvw_to_xyz</title>
<path fill="none" stroke="#000000" d="M28.4436,-512.706C34.0208,-463.538 55.5785,-292.728 90,-252 92.7854,-248.704 96.1453,-245.894 99.8058,-243.499"/>
<polygon fill="#000000" stroke="#000000" points="101.647,-246.482 108.763,-238.633 98.3052,-240.331 101.647,-246.482"/>
</g>
<!-- proc~randu -->
<g id="node8" class="node"><title>proc~randu</title>
<a xlink:href="../proc/randu.html" xlink:title="randu">
<polygon fill="#d9534f" stroke="#d9534f" points="433,-410 379,-410 379,-384 433,-384 433,-410"/>
<text text-anchor="middle" x="406" y="-394.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
<!-- proc~fida_mc&#45;&gt;proc~randu -->
<g id="edge140" class="edge"><title>proc~fida_mc&#45;&gt;proc~randu</title>
<path fill="none" stroke="#000000" d="M43.7826,-512.906C56.1442,-503.608 73.5891,-491.194 90,-482 150.079,-448.342 165.659,-438.471 232,-420 277.889,-407.223 332.618,-401.474 368.279,-398.934"/>
<polygon fill="#000000" stroke="#000000" points="368.956,-402.397 378.703,-398.245 368.493,-395.413 368.956,-402.397"/>
</g>
<!-- proc~track -->
<g id="node9" class="node"><title>proc~track</title>
<a xlink:href="../proc/track.html" xlink:title="track">
<polygon fill="#d9534f" stroke="#d9534f" points="311,-607 257,-607 257,-581 311,-581 311,-607"/>
<text text-anchor="middle" x="284" y="-591.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">track</text>
</a>
</g>
<!-- proc~fida_mc&#45;&gt;proc~track -->
<g id="edge142" class="edge"><title>proc~fida_mc&#45;&gt;proc~track</title>
<path fill="none" stroke="#000000" d="M45.7213,-539.062C57.8243,-546.894 74.2121,-556.392 90,-562 142.56,-580.67 207.059,-588.543 246.844,-591.797"/>
<polygon fill="#000000" stroke="#000000" points="246.654,-595.292 256.891,-592.562 247.186,-588.312 246.654,-595.292"/>
</g>
<!-- proc~get_beam_cx_prob -->
<g id="node10" class="node"><title>proc~get_beam_cx_prob</title>
<a xlink:href="../proc/get_beam_cx_prob.html" xlink:title="get_beam_cx_prob">
<polygon fill="#d9534f" stroke="#d9534f" points="195,-517 91,-517 91,-491 195,-491 195,-517"/>
<text text-anchor="middle" x="143" y="-501.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_beam_cx_prob</text>
</a>
</g>
<!-- proc~fida_mc&#45;&gt;proc~get_beam_cx_prob -->
<g id="edge144" class="edge"><title>proc~fida_mc&#45;&gt;proc~get_beam_cx_prob</title>
<path fill="none" stroke="#000000" d="M54.1968,-520.842C62.1636,-519.331 71.2226,-517.613 80.4362,-515.866"/>
<polygon fill="#000000" stroke="#000000" points="81.2776,-519.268 90.4503,-513.966 79.9732,-512.391 81.2776,-519.268"/>
</g>
<!-- proc~get_plasma -->
<g id="node11" class="node"><title>proc~get_plasma</title>
<a xlink:href="../proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="440,-569 372,-569 372,-543 440,-543 440,-569"/>
<text text-anchor="middle" x="406" y="-553.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
<!-- proc~fida_mc&#45;&gt;proc~get_plasma -->
<g id="edge146" class="edge"><title>proc~fida_mc&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M54.2567,-528.158C118.987,-533.281 282.447,-546.22 361.639,-552.489"/>
<polygon fill="#000000" stroke="#000000" points="361.534,-555.991 371.779,-553.291 362.086,-549.013 361.534,-555.991"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="node12" class="node"><title>proc~xyz_to_uvw</title>
<a xlink:href="../proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="699,-662 631,-662 631,-636 699,-636 699,-662"/>
<text text-anchor="middle" x="665" y="-646.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="edge32" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M435.256,-688.853C472.465,-686.982 538.546,-682.276 594,-671 602.82,-669.207 612.105,-666.757 620.946,-664.142"/>
<polygon fill="#000000" stroke="#000000" points="622.162,-667.431 630.691,-661.146 620.104,-660.74 622.162,-667.431"/>
</g>
<!-- interface~interpol_coeff -->
<g id="node13" class="node"><title>interface~interpol_coeff</title>
<a xlink:href="../interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="949,-580 873,-580 873,-554 949,-554 949,-580"/>
<text text-anchor="middle" x="911" y="-564.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
<!-- proc~get_fields&#45;&gt;interface~interpol_coeff -->
<g id="edge34" class="edge"><title>proc~get_fields&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M435.086,-697.801C508.189,-715.677 703.237,-752.512 836,-677 870.055,-657.631 891.893,-615.688 902.762,-589.555"/>
<polygon fill="#000000" stroke="#000000" points="906.089,-590.66 906.514,-580.074 899.58,-588.084 906.089,-590.66"/>
</g>
<!-- proc~get_position -->
<g id="node14" class="node"><title>proc~get_position</title>
<a xlink:href="../proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="570,-662 500,-662 500,-636 570,-636 570,-662"/>
<text text-anchor="middle" x="535" y="-646.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="edge36" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M435.272,-680.696C451.529,-675.529 472.093,-668.994 490.319,-663.201"/>
<polygon fill="#000000" stroke="#000000" points="491.411,-666.527 499.881,-660.162 489.29,-659.855 491.411,-666.527"/>
</g>
<!-- proc~normp -->
<g id="node15" class="node"><title>proc~normp</title>
<a xlink:href="../proc/normp.html" xlink:title="normp">
<polygon fill="#d94e8f" stroke="#d94e8f" points="692,-823 638,-823 638,-797 692,-797 692,-823"/>
<text text-anchor="middle" x="665" y="-807.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">normp</text>
</a>
</g>
<!-- proc~get_fields&#45;&gt;proc~normp -->
<g id="edge38" class="edge"><title>proc~get_fields&#45;&gt;proc~normp</title>
<path fill="none" stroke="#000000" d="M410.879,-703.283C419.891,-725.713 441.444,-770.638 476,-791 522.686,-818.509 587.306,-818.532 627.603,-815.02"/>
<polygon fill="#000000" stroke="#000000" points="628.187,-818.479 637.793,-814.011 627.497,-811.513 628.187,-818.479"/>
</g>
<!-- proc~in_plasma -->
<g id="node16" class="node"><title>proc~in_plasma</title>
<a xlink:href="../proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="565,-618 505,-618 505,-592 565,-592 565,-618"/>
<text text-anchor="middle" x="535" y="-602.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="edge40" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M428.223,-676.887C432.286,-674.141 436.381,-671.125 440,-668 458.354,-652.151 456.035,-640.764 476,-627 481.745,-623.04 488.293,-619.686 494.886,-616.884"/>
<polygon fill="#000000" stroke="#000000" points="496.429,-620.04 504.49,-613.165 493.901,-613.512 496.429,-620.04"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="node17" class="node"><title>proc~calc_perp_vectors</title>
<a xlink:href="../proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="585,-782 485,-782 485,-756 585,-756 585,-782"/>
<text text-anchor="middle" x="535" y="-766.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="edge42" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M421.737,-703.195C435.505,-714.363 456.323,-730.364 476,-742 481.6,-745.311 487.675,-748.503 493.727,-751.46"/>
<polygon fill="#000000" stroke="#000000" points="492.608,-754.801 503.146,-755.897 495.591,-748.469 492.608,-754.801"/>
</g>
<!-- proc~store_fida_photons&#45;&gt;proc~get_fields -->
<g id="edge50" class="edge"><title>proc~store_fida_photons&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M336.093,-685.416C346.366,-686.09 356.984,-686.786 366.746,-687.426"/>
<polygon fill="#000000" stroke="#000000" points="366.74,-690.933 376.947,-688.095 367.198,-683.948 366.74,-690.933"/>
</g>
<!-- proc~spectrum -->
<g id="node47" class="node"><title>proc~spectrum</title>
<a xlink:href="../proc/spectrum.html" xlink:title="spectrum">
<polygon fill="#d9534f" stroke="#d9534f" points="563,-864 507,-864 507,-838 563,-838 563,-864"/>
<text text-anchor="middle" x="535" y="-848.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spectrum</text>
</a>
</g>
<!-- proc~store_fida_photons&#45;&gt;proc~spectrum -->
<g id="edge46" class="edge"><title>proc~store_fida_photons&#45;&gt;proc~spectrum</title>
<path fill="none" stroke="#000000" d="M301.372,-695.012C334.629,-719.739 409.868,-774.816 476,-817 484.433,-822.379 493.737,-827.917 502.414,-832.92"/>
<polygon fill="#000000" stroke="#000000" points="500.747,-835.999 511.167,-837.912 504.214,-829.918 500.747,-835.999"/>
</g>
<!-- proc~get_indices -->
<g id="node48" class="node"><title>proc~get_indices</title>
<a xlink:href="../proc/get_indices.html" xlink:title="get_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="439,-659 373,-659 373,-633 439,-633 439,-659"/>
<text text-anchor="middle" x="406" y="-643.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_indices</text>
</a>
</g>
<!-- proc~store_fida_photons&#45;&gt;proc~get_indices -->
<g id="edge48" class="edge"><title>proc~store_fida_photons&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M328.39,-668.901C339.448,-665.638 351.295,-662.142 362.319,-658.889"/>
<polygon fill="#000000" stroke="#000000" points="363.565,-662.171 372.166,-655.984 361.584,-655.457 363.565,-662.171"/>
</g>
<!-- proc~cross_product -->
<g id="node53" class="node"><title>proc~cross_product</title>
<a xlink:href="../proc/cross_product.html" xlink:title="cross_product">
<polygon fill="#d94e8f" stroke="#d94e8f" points="324,-114 244,-114 244,-88 324,-88 324,-114"/>
<text text-anchor="middle" x="284" y="-98.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cross_product</text>
</a>
</g>
<!-- proc~gyro_correction&#45;&gt;proc~cross_product -->
<g id="edge52" class="edge"><title>proc~gyro_correction&#45;&gt;proc~cross_product</title>
<path fill="none" stroke="#000000" d="M185.09,-260.962C189.145,-258.466 192.896,-255.506 196,-252 235.461,-207.436 192.69,-167.697 232,-123 233.157,-121.684 234.406,-120.445 235.729,-119.278"/>
<polygon fill="#000000" stroke="#000000" points="237.897,-122.03 243.978,-113.354 233.814,-116.344 237.897,-122.03"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="node55" class="node"><title>proc~get_rate_matrix</title>
<a xlink:href="../proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="830,-395 742,-395 742,-369 830,-369 830,-395"/>
<text text-anchor="middle" x="786" y="-379.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="edge84" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M170.26,-318C218.019,-318 319.931,-318 406,-318 406,-318 406,-318 535,-318 611.361,-318 696.851,-346.157 745.765,-365.118"/>
<polygon fill="#000000" stroke="#000000" points="744.752,-368.481 755.338,-368.894 747.32,-361.969 744.752,-368.481"/>
</g>
<!-- proc~eigen -->
<g id="node56" class="node"><title>proc~eigen</title>
<a xlink:href="../proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="311,-158 257,-158 257,-132 311,-132 311,-158"/>
<text text-anchor="middle" x="284" y="-142.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="edge86" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M170.245,-310.546C179.159,-307.155 188.649,-302.425 196,-296 237.023,-260.144 263.793,-200.296 276.121,-167.755"/>
<polygon fill="#000000" stroke="#000000" points="279.463,-168.808 279.616,-158.214 272.89,-166.4 279.463,-168.808"/>
</g>
<!-- proc~matinv -->
<g id="node57" class="node"><title>proc~matinv</title>
<a xlink:href="../proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="311,-290 257,-290 257,-264 311,-264 311,-290"/>
<text text-anchor="middle" x="284" y="-274.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
<!-- proc~colrad&#45;&gt;proc~matinv -->
<g id="edge88" class="edge"><title>proc~colrad&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M170.186,-310.095C192.033,-303.742 222.94,-294.755 247.035,-287.749"/>
<polygon fill="#000000" stroke="#000000" points="248.272,-291.034 256.897,-284.881 246.318,-284.312 248.272,-291.034"/>
</g>
<!-- proc~rng_uniform -->
<g id="node88" class="node"><title>proc~rng_uniform</title>
<a xlink:href="../proc/rng_uniform.html" xlink:title="rng_uniform">
<polygon fill="#d94e8f" stroke="#d94e8f" points="700,-413 630,-413 630,-387 700,-387 700,-413"/>
<text text-anchor="middle" x="665" y="-397.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rng_uniform</text>
</a>
</g>
<!-- proc~randu&#45;&gt;proc~rng_uniform -->
<g id="edge90" class="edge"><title>proc~randu&#45;&gt;proc~rng_uniform</title>
<path fill="none" stroke="#000000" d="M433.136,-386.352C445.923,-381.887 461.52,-377.222 476,-375 527.838,-367.046 542.305,-366.165 594,-375 604.543,-376.802 615.601,-380.007 625.768,-383.534"/>
<polygon fill="#000000" stroke="#000000" points="624.603,-386.834 635.197,-386.978 627.005,-380.259 624.603,-386.834"/>
</g>
<!-- omp_get_thread_num -->
<g id="node89" class="node"><title>omp_get_thread_num</title>
<polygon fill="#777777" stroke="#777777" points="594,-410 476,-410 476,-384 594,-384 594,-410"/>
<text text-anchor="middle" x="535" y="-394.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">omp_get_thread_num</text>
</g>
<!-- proc~randu&#45;&gt;omp_get_thread_num -->
<g id="edge92" class="edge"><title>proc~randu&#45;&gt;omp_get_thread_num</title>
<path fill="none" stroke="#000000" d="M433.043,-397C442.7,-397 454.071,-397 465.652,-397"/>
<polygon fill="#000000" stroke="#000000" points="465.845,-400.5 475.845,-397 465.845,-393.5 465.845,-400.5"/>
</g>
<!-- proc~track&#45;&gt;proc~in_plasma -->
<g id="edge96" class="edge"><title>proc~track&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M311.339,-595.198C355.44,-597.131 442.533,-600.948 494.062,-603.206"/>
<polygon fill="#000000" stroke="#000000" points="494.037,-606.708 504.18,-603.649 494.343,-599.715 494.037,-606.708"/>
</g>
<!-- proc~track&#45;&gt;proc~get_indices -->
<g id="edge94" class="edge"><title>proc~track&#45;&gt;proc~get_indices</title>
<path fill="none" stroke="#000000" d="M311.076,-605.54C327.068,-612.357 347.622,-621.117 365.512,-628.743"/>
<polygon fill="#000000" stroke="#000000" points="364.559,-632.141 375.13,-632.843 367.304,-625.702 364.559,-632.141"/>
</g>
<!-- proc~get_beam_cx_prob&#45;&gt;proc~normp -->
<g id="edge116" class="edge"><title>proc~get_beam_cx_prob&#45;&gt;proc~normp</title>
<path fill="none" stroke="#000000" d="M146.143,-517.009C154.86,-550.946 182.053,-643.712 232,-704 316.159,-805.583 350.088,-833.653 476,-873 526.057,-888.643 544.971,-891.616 594,-873 616.098,-864.609 635.723,-845.843 648.708,-830.962"/>
<polygon fill="#000000" stroke="#000000" points="651.482,-833.102 655.213,-823.186 646.112,-828.611 651.482,-833.102"/>
</g>
<!-- proc~mc_halo -->
<g id="node94" class="node"><title>proc~mc_halo</title>
<a xlink:href="../proc/mc_halo.html" xlink:title="mc_halo">
<polygon fill="#d9534f" stroke="#d9534f" points="311,-455 257,-455 257,-429 311,-429 311,-455"/>
<text text-anchor="middle" x="284" y="-439.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_halo</text>
</a>
</g>
<!-- proc~get_beam_cx_prob&#45;&gt;proc~mc_halo -->
<g id="edge114" class="edge"><title>proc~get_beam_cx_prob&#45;&gt;proc~mc_halo</title>
<path fill="none" stroke="#000000" d="M172.902,-490.851C194.644,-481.291 224.199,-468.296 247.36,-458.111"/>
<polygon fill="#000000" stroke="#000000" points="248.786,-461.308 256.531,-454.078 245.968,-454.9 248.786,-461.308"/>
</g>
<!-- proc~neut_rates -->
<g id="node95" class="node"><title>proc~neut_rates</title>
<a xlink:href="../proc/neut_rates.html" xlink:title="neut_rates">
<polygon fill="#d9534f" stroke="#d9534f" points="567,-498 503,-498 503,-472 567,-472 567,-498"/>
<text text-anchor="middle" x="535" y="-482.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neut_rates</text>
</a>
</g>
<!-- proc~get_beam_cx_prob&#45;&gt;proc~neut_rates -->
<g id="edge118" class="edge"><title>proc~get_beam_cx_prob&#45;&gt;proc~neut_rates</title>
<path fill="none" stroke="#000000" d="M195.867,-501.438C274.546,-497.624 420.884,-490.531 492.838,-487.044"/>
<polygon fill="#000000" stroke="#000000" points="493.079,-490.536 502.898,-486.556 492.74,-483.544 493.079,-490.536"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="edge120" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M440.27,-553.725C479.869,-552.652 545.758,-555.771 594,-583 616.004,-595.42 611.056,-610.28 630,-627 631.11,-627.98 632.268,-628.944 633.46,-629.89"/>
<polygon fill="#000000" stroke="#000000" points="631.495,-632.788 641.648,-635.813 635.597,-627.116 631.495,-632.788"/>
</g>
<!-- proc~get_plasma&#45;&gt;interface~interpol_coeff -->
<g id="edge122" class="edge"><title>proc~get_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M440.23,-551.254C513.348,-541.963 690.011,-524.03 836,-545 845.272,-546.332 854.997,-548.545 864.257,-551.068"/>
<polygon fill="#000000" stroke="#000000" points="863.5,-554.492 874.078,-553.899 865.439,-547.766 863.5,-554.492"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="edge124" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M416.029,-569.239C428.537,-584.943 451.301,-611.004 476,-627 480.417,-629.861 485.26,-632.424 490.211,-634.699"/>
<polygon fill="#000000" stroke="#000000" points="489.209,-638.075 499.784,-638.725 491.922,-631.622 489.209,-638.075"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="edge126" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M440.231,-569.002C456.983,-575.366 477.259,-583.067 494.75,-589.711"/>
<polygon fill="#000000" stroke="#000000" points="493.55,-592.999 504.141,-593.278 496.036,-586.455 493.55,-592.999"/>
</g>
<!-- proc~interpol2d_coeff_arr -->
<g id="node18" class="node"><title>proc~interpol2d_coeff_arr</title>
<a xlink:href="../proc/interpol2d_coeff_arr.html" xlink:title="interpol2D_coeff_arr">
<polygon fill="#d9534f" stroke="#d9534f" points="1096,-601 986,-601 986,-575 1096,-575 1096,-601"/>
<text text-anchor="middle" x="1041" y="-585.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol2D_coeff_arr</text>
</a>
</g>
<!-- interface~interpol_coeff&#45;&gt;proc~interpol2d_coeff_arr -->
<g id="edge6" class="edge"><title>interface~interpol_coeff&#45;&gt;proc~interpol2d_coeff_arr</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M949.652,-573.244C957.918,-574.579 966.868,-576.025 975.822,-577.471"/>
<polygon fill="#000000" stroke="#000000" points="975.468,-580.959 985.898,-579.099 976.584,-574.049 975.468,-580.959"/>
</g>
<!-- proc~interpol1d_coeff_arr -->
<g id="node19" class="node"><title>proc~interpol1d_coeff_arr</title>
<a xlink:href="../proc/interpol1d_coeff_arr.html" xlink:title="interpol1D_coeff_arr">
<polygon fill="#d9534f" stroke="#d9534f" points="1096,-519 986,-519 986,-493 1096,-493 1096,-519"/>
<text text-anchor="middle" x="1041" y="-503.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol1D_coeff_arr</text>
</a>
</g>
<!-- interface~interpol_coeff&#45;&gt;proc~interpol1d_coeff_arr -->
<g id="edge8" class="edge"><title>interface~interpol_coeff&#45;&gt;proc~interpol1d_coeff_arr</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M938.888,-553.914C957.909,-544.989 983.307,-533.071 1004.01,-523.355"/>
<polygon fill="#000000" stroke="#000000" points="1005.59,-526.481 1013.16,-519.064 1002.62,-520.144 1005.59,-526.481"/>
</g>
<!-- proc~interpol1d_coeff -->
<g id="node20" class="node"><title>proc~interpol1d_coeff</title>
<a xlink:href="../proc/interpol1d_coeff.html" xlink:title="interpol1D_coeff">
<polygon fill="#d9534f" stroke="#d9534f" points="1223,-549 1133,-549 1133,-523 1223,-523 1223,-549"/>
<text text-anchor="middle" x="1178" y="-533.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol1D_coeff</text>
</a>
</g>
<!-- interface~interpol_coeff&#45;&gt;proc~interpol1d_coeff -->
<g id="edge10" class="edge"><title>interface~interpol_coeff&#45;&gt;proc~interpol1d_coeff</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M949.539,-562.525C994.894,-557.259 1070.57,-548.473 1122.3,-542.467"/>
<polygon fill="#000000" stroke="#000000" points="1122.78,-545.935 1132.31,-541.305 1121.98,-538.981 1122.78,-545.935"/>
</g>
<!-- proc~interpol2d_coeff -->
<g id="node21" class="node"><title>proc~interpol2d_coeff</title>
<a xlink:href="../proc/interpol2d_coeff.html" xlink:title="interpol2D_coeff">
<polygon fill="#d9534f" stroke="#d9534f" points="1223,-612 1133,-612 1133,-586 1223,-586 1223,-612"/>
<text text-anchor="middle" x="1178" y="-596.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol2D_coeff</text>
</a>
</g>
<!-- interface~interpol_coeff&#45;&gt;proc~interpol2d_coeff -->
<g id="edge12" class="edge"><title>interface~interpol_coeff&#45;&gt;proc~interpol2d_coeff</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M927.738,-580.031C942.235,-590.439 964.245,-604.206 986,-610 1030.72,-621.911 1083.3,-617.698 1122.12,-611.331"/>
<polygon fill="#000000" stroke="#000000" points="1122.93,-614.743 1132.18,-609.582 1121.73,-607.846 1122.93,-614.743"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="edge26" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M565.808,-615.427C582.356,-621.028 603.037,-628.028 621.226,-634.184"/>
<polygon fill="#000000" stroke="#000000" points="620.159,-637.518 630.754,-637.409 622.404,-630.888 620.159,-637.518"/>
</g>
<!-- interface~interpol -->
<g id="node28" class="node"><title>interface~interpol</title>
<a xlink:href="../interface/interpol.html" xlink:title="interpol">
<polygon fill="#a7506f" stroke="#a7506f" points="692,-618 638,-618 638,-592 692,-592 692,-618"/>
<text text-anchor="middle" x="665" y="-602.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol</text>
</a>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol -->
<g id="edge28" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol</title>
<path fill="none" stroke="#000000" d="M565.808,-605C584.393,-605 608.19,-605 627.817,-605"/>
<polygon fill="#000000" stroke="#000000" points="627.941,-608.5 637.941,-605 627.941,-601.5 627.941,-608.5"/>
</g>
<!-- proc~calc_perp_vectors&#45;&gt;proc~normp -->
<g id="edge30" class="edge"><title>proc~calc_perp_vectors&#45;&gt;proc~normp</title>
<path fill="none" stroke="#000000" d="M576.49,-782.085C593.105,-787.325 612.088,-793.312 628.202,-798.395"/>
<polygon fill="#000000" stroke="#000000" points="627.229,-801.757 637.818,-801.427 629.334,-795.081 627.229,-801.757"/>
</g>
<!-- proc~interpol2d_coeff_arr&#45;&gt;proc~interpol2d_coeff -->
<g id="edge2" class="edge"><title>proc~interpol2d_coeff_arr&#45;&gt;proc~interpol2d_coeff</title>
<path fill="none" stroke="#000000" d="M1096.33,-592.442C1104.78,-593.121 1113.5,-593.821 1121.96,-594.501"/>
<polygon fill="#000000" stroke="#000000" points="1121.87,-598.004 1132.12,-595.316 1122.43,-591.027 1121.87,-598.004"/>
</g>
<!-- proc~interpol1d_coeff_arr&#45;&gt;proc~interpol1d_coeff -->
<g id="edge4" class="edge"><title>proc~interpol1d_coeff_arr&#45;&gt;proc~interpol1d_coeff</title>
<path fill="none" stroke="#000000" d="M1096.33,-518.116C1104.87,-519.986 1113.69,-521.918 1122.24,-523.79"/>
<polygon fill="#000000" stroke="#000000" points="1121.6,-527.233 1132.12,-525.953 1123.1,-520.395 1121.6,-527.233"/>
</g>
<!-- proc~interpol2d_2d_arr -->
<g id="node29" class="node"><title>proc~interpol2d_2d_arr</title>
<a xlink:href="../proc/interpol2d_2d_arr.html" xlink:title="interpol2D_2D_arr">
<polygon fill="#d9534f" stroke="#d9534f" points="836,-624 736,-624 736,-598 836,-598 836,-624"/>
<text text-anchor="middle" x="786" y="-608.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol2D_2D_arr</text>
</a>
</g>
<!-- interface~interpol&#45;&gt;proc~interpol2d_2d_arr -->
<g id="edge20" class="edge"><title>interface~interpol&#45;&gt;proc~interpol2d_2d_arr</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M692.155,-606.347C702.071,-606.838 713.725,-607.416 725.384,-607.994"/>
<polygon fill="#000000" stroke="#000000" points="725.428,-611.501 735.589,-608.5 725.774,-604.509 725.428,-611.501"/>
</g>
<!-- proc~interpol1d_arr -->
<g id="node30" class="node"><title>proc~interpol1d_arr</title>
<a xlink:href="../proc/interpol1d_arr.html" xlink:title="interpol1D_arr">
<polygon fill="#d9534f" stroke="#d9534f" points="826,-580 746,-580 746,-554 826,-554 826,-580"/>
<text text-anchor="middle" x="786" y="-564.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol1D_arr</text>
</a>
</g>
<!-- interface~interpol&#45;&gt;proc~interpol1d_arr -->
<g id="edge22" class="edge"><title>interface~interpol&#45;&gt;proc~interpol1d_arr</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M692.155,-596.472C704.958,-592.451 720.659,-587.52 735.528,-582.851"/>
<polygon fill="#000000" stroke="#000000" points="736.648,-586.167 745.14,-579.832 734.551,-579.489 736.648,-586.167"/>
</g>
<!-- proc~interpol2d_arr -->
<g id="node31" class="node"><title>proc~interpol2d_arr</title>
<a xlink:href="../proc/interpol2d_arr.html" xlink:title="interpol2D_arr">
<polygon fill="#d9534f" stroke="#d9534f" points="826,-668 746,-668 746,-642 826,-642 826,-668"/>
<text text-anchor="middle" x="786" y="-652.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol2D_arr</text>
</a>
</g>
<!-- interface~interpol&#45;&gt;proc~interpol2d_arr -->
<g id="edge24" class="edge"><title>interface~interpol&#45;&gt;proc~interpol2d_arr</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M692.155,-616.221C707.675,-622.634 727.454,-630.807 744.848,-637.995"/>
<polygon fill="#000000" stroke="#000000" points="743.645,-641.285 754.224,-641.869 746.318,-634.815 743.645,-641.285"/>
</g>
<!-- proc~interpol2d_2d_arr&#45;&gt;interface~interpol_coeff -->
<g id="edge14" class="edge"><title>proc~interpol2d_2d_arr&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M823.166,-597.918C836.022,-593.392 850.599,-588.261 864.132,-583.498"/>
<polygon fill="#000000" stroke="#000000" points="865.491,-586.73 873.762,-580.108 863.167,-580.127 865.491,-586.73"/>
</g>
<!-- proc~interpol1d_arr&#45;&gt;interface~interpol_coeff -->
<g id="edge16" class="edge"><title>proc~interpol1d_arr&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M826.584,-567C837.942,-567 850.406,-567 862.187,-567"/>
<polygon fill="#000000" stroke="#000000" points="862.32,-570.5 872.32,-567 862.32,-563.5 862.32,-570.5"/>
</g>
<!-- proc~interpol2d_arr&#45;&gt;interface~interpol_coeff -->
<g id="edge18" class="edge"><title>proc~interpol2d_arr&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M819.554,-641.948C825.201,-639.273 830.884,-636.266 836,-633 856.354,-620.009 876.751,-601.628 891.125,-587.562"/>
<polygon fill="#000000" stroke="#000000" points="893.844,-589.794 898.452,-580.253 888.9,-584.838 893.844,-589.794"/>
</g>
<!-- proc~spectrum&#45;&gt;proc~normp -->
<g id="edge44" class="edge"><title>proc~spectrum&#45;&gt;proc~normp</title>
<path fill="none" stroke="#000000" d="M563.529,-842.002C582.541,-836.006 607.709,-828.069 628.222,-821.599"/>
<polygon fill="#000000" stroke="#000000" points="629.387,-824.902 637.871,-818.556 627.282,-818.226 629.387,-824.902"/>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="edge54" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M794.79,-395.009C815.986,-426.379 870.095,-506.46 896.315,-545.267"/>
<polygon fill="#000000" stroke="#000000" points="893.554,-547.432 902.053,-553.758 899.354,-543.512 893.554,-547.432"/>
</g>
<!-- proc~hqr2 -->
<g id="node59" class="node"><title>proc~hqr2</title>
<a xlink:href="../proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="433,-26 379,-26 379,-1.24345e-14 433,-3.55271e-15 433,-26"/>
<text text-anchor="middle" x="406" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="edge66" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M311.257,-138.012C320.045,-134.659 329.248,-129.833 336,-123 365.702,-92.942 345.023,-67.526 372,-35 372.589,-34.2897 373.207,-33.5944 373.85,-32.9145"/>
<polygon fill="#000000" stroke="#000000" points="376.257,-35.4585 381.463,-26.231 371.639,-30.1978 376.257,-35.4585"/>
</g>
<!-- proc~elmtrans -->
<g id="node60" class="node"><title>proc~elmtrans</title>
<a xlink:href="../proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="433,-114 379,-114 379,-88 433,-88 433,-114"/>
<text text-anchor="middle" x="406" y="-98.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="edge68" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M311.076,-135.235C328.292,-129.026 350.795,-120.91 369.57,-114.139"/>
<polygon fill="#000000" stroke="#000000" points="370.78,-117.423 379,-110.738 368.406,-110.838 370.78,-117.423"/>
</g>
<!-- proc~balback -->
<g id="node61" class="node"><title>proc~balback</title>
<a xlink:href="../proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="433,-202 379,-202 379,-176 433,-176 433,-202"/>
<text text-anchor="middle" x="406" y="-186.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="edge70" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M311.076,-154.765C328.292,-160.974 350.795,-169.09 369.57,-175.861"/>
<polygon fill="#000000" stroke="#000000" points="368.406,-179.162 379,-179.262 370.78,-172.577 368.406,-179.162"/>
</g>
<!-- proc~balance -->
<g id="node62" class="node"><title>proc~balance</title>
<a xlink:href="../proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="433,-158 379,-158 379,-132 433,-132 433,-158"/>
<text text-anchor="middle" x="406" y="-142.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="edge72" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M311.076,-145C328.055,-145 350.177,-145 368.792,-145"/>
<polygon fill="#000000" stroke="#000000" points="369,-148.5 379,-145 369,-141.5 369,-148.5"/>
</g>
<!-- proc~elmhes -->
<g id="node63" class="node"><title>proc~elmhes</title>
<a xlink:href="../proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="433,-70 379,-70 379,-44 433,-44 433,-70"/>
<text text-anchor="middle" x="406" y="-54.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="edge74" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M311.254,-136.355C319.654,-132.955 328.624,-128.522 336,-123 356.226,-107.857 353.166,-95.8439 372,-79 373.114,-78.004 374.277,-77.0218 375.473,-76.0579"/>
<polygon fill="#000000" stroke="#000000" points="377.709,-78.7581 383.688,-70.0114 373.56,-73.1206 377.709,-78.7581"/>
</g>
<!-- proc~lubksb -->
<g id="node77" class="node"><title>proc~lubksb</title>
<a xlink:href="../proc/lubksb.html" xlink:title="lubksb">
<polygon fill="#d9534f" stroke="#d9534f" points="433,-290 379,-290 379,-264 433,-264 433,-290"/>
<text text-anchor="middle" x="406" y="-274.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lubksb</text>
</a>
</g>
<!-- proc~matinv&#45;&gt;proc~lubksb -->
<g id="edge80" class="edge"><title>proc~matinv&#45;&gt;proc~lubksb</title>
<path fill="none" stroke="#000000" d="M311.076,-277C328.055,-277 350.177,-277 368.792,-277"/>
<polygon fill="#000000" stroke="#000000" points="369,-280.5 379,-277 369,-273.5 369,-280.5"/>
</g>
<!-- proc~ludcmp -->
<g id="node78" class="node"><title>proc~ludcmp</title>
<a xlink:href="../proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="433,-246 379,-246 379,-220 433,-220 433,-246"/>
<text text-anchor="middle" x="406" y="-230.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="edge82" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M311.076,-267.235C328.292,-261.026 350.795,-252.91 369.57,-246.139"/>
<polygon fill="#000000" stroke="#000000" points="370.78,-249.423 379,-242.738 368.406,-242.838 370.78,-249.423"/>
</g>
<!-- proc~hqrvec -->
<g id="node64" class="node"><title>proc~hqrvec</title>
<a xlink:href="../proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="562,-26 508,-26 508,-1.24345e-14 562,-3.55271e-15 562,-26"/>
<text text-anchor="middle" x="535" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="edge58" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M433.043,-13C451.877,-13 477.232,-13 497.946,-13"/>
<polygon fill="#000000" stroke="#000000" points="497.993,-16.5001 507.993,-13 497.993,-9.5001 497.993,-16.5001"/>
</g>
<!-- proc~rswap -->
<g id="node68" class="node"><title>proc~rswap</title>
<a xlink:href="../proc/rswap.html" xlink:title="RSWAP">
<polygon fill="#d9534f" stroke="#d9534f" points="562,-158 508,-158 508,-132 562,-132 562,-158"/>
<text text-anchor="middle" x="535" y="-142.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RSWAP</text>
</a>
</g>
<!-- proc~balback&#45;&gt;proc~rswap -->
<g id="edge60" class="edge"><title>proc~balback&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M433.043,-179.776C452.049,-173.293 477.696,-164.546 498.512,-157.445"/>
<polygon fill="#000000" stroke="#000000" points="499.658,-160.753 507.993,-154.212 497.398,-154.127 499.658,-160.753"/>
</g>
<!-- proc~balance&#45;&gt;proc~rswap -->
<g id="edge62" class="edge"><title>proc~balance&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M433.043,-145C451.877,-145 477.232,-145 497.946,-145"/>
<polygon fill="#000000" stroke="#000000" points="497.993,-148.5 507.993,-145 497.993,-141.5 497.993,-148.5"/>
</g>
<!-- proc~elmhes&#45;&gt;proc~rswap -->
<g id="edge64" class="edge"><title>proc~elmhes&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M426.568,-70.154C431.015,-73.0414 435.679,-76.1022 440,-79 463.182,-94.5467 489.195,-112.667 508.131,-125.983"/>
<polygon fill="#000000" stroke="#000000" points="506.366,-129.021 516.556,-131.919 510.397,-123.298 506.366,-129.021"/>
</g>
<!-- proc~comdiv -->
<g id="node65" class="node"><title>proc~comdiv</title>
<a xlink:href="../proc/comdiv.html" xlink:title="Comdiv">
<polygon fill="#d9534f" stroke="#d9534f" points="692,-26 638,-26 638,-1.24345e-14 692,-3.55271e-15 692,-26"/>
<text text-anchor="middle" x="665" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Comdiv</text>
</a>
</g>
<!-- proc~hqrvec&#45;&gt;proc~comdiv -->
<g id="edge56" class="edge"><title>proc~hqrvec&#45;&gt;proc~comdiv</title>
<path fill="none" stroke="#000000" d="M562.252,-13C581.233,-13 606.785,-13 627.659,-13"/>
<polygon fill="#000000" stroke="#000000" points="627.784,-16.5001 637.784,-13 627.784,-9.5001 627.784,-16.5001"/>
</g>
<!-- proc~swap -->
<g id="node79" class="node"><title>proc~swap</title>
<a xlink:href="../proc/swap.html" xlink:title="swap">
<polygon fill="#d9534f" stroke="#d9534f" points="562,-268 508,-268 508,-242 562,-242 562,-268"/>
<text text-anchor="middle" x="535" y="-252.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swap</text>
</a>
</g>
<!-- proc~ludcmp&#45;&gt;proc~swap -->
<g id="edge76" class="edge"><title>proc~ludcmp&#45;&gt;proc~swap</title>
<path fill="none" stroke="#000000" d="M433.043,-237.612C451.877,-240.824 477.232,-245.148 497.946,-248.681"/>
<polygon fill="#000000" stroke="#000000" points="497.547,-252.163 507.993,-250.394 498.724,-245.263 497.547,-252.163"/>
</g>
<!-- proc~outerprod -->
<g id="node80" class="node"><title>proc~outerprod</title>
<a xlink:href="../proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="564,-224 506,-224 506,-198 564,-198 564,-224"/>
<text text-anchor="middle" x="535" y="-208.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="edge78" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M433.043,-228.388C451.119,-225.305 475.201,-221.198 495.422,-217.75"/>
<polygon fill="#000000" stroke="#000000" points="496.023,-221.198 505.292,-216.066 494.846,-214.297 496.023,-221.198"/>
</g>
<!-- proc~mc_halo&#45;&gt;proc~randu -->
<g id="edge106" class="edge"><title>proc~mc_halo&#45;&gt;proc~randu</title>
<path fill="none" stroke="#000000" d="M311.076,-432.013C328.292,-425.663 350.795,-417.362 369.57,-410.437"/>
<polygon fill="#000000" stroke="#000000" points="370.829,-413.703 379,-406.959 368.407,-407.136 370.829,-413.703"/>
</g>
<!-- proc~mc_halo&#45;&gt;proc~get_plasma -->
<g id="edge108" class="edge"><title>proc~mc_halo&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M297.995,-455.077C319.117,-474.814 359.318,-512.379 384.27,-535.695"/>
<polygon fill="#000000" stroke="#000000" points="382.096,-538.454 391.792,-542.724 386.875,-533.339 382.096,-538.454"/>
</g>
<!-- proc~randn -->
<g id="node96" class="node"><title>proc~randn</title>
<a xlink:href="../proc/randn.html" xlink:title="randn">
<polygon fill="#d9534f" stroke="#d9534f" points="433,-454 379,-454 379,-428 433,-428 433,-454"/>
<text text-anchor="middle" x="406" y="-438.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randn</text>
</a>
</g>
<!-- proc~mc_halo&#45;&gt;proc~randn -->
<g id="edge104" class="edge"><title>proc~mc_halo&#45;&gt;proc~randn</title>
<path fill="none" stroke="#000000" d="M311.076,-441.778C328.055,-441.639 350.177,-441.458 368.792,-441.305"/>
<polygon fill="#000000" stroke="#000000" points="369.029,-444.803 379,-441.221 368.972,-437.803 369.029,-444.803"/>
</g>
<!-- proc~neut_rates&#45;&gt;interface~interpol_coeff -->
<g id="edge110" class="edge"><title>proc~neut_rates&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M567.447,-482.354C624.013,-478.935 743.479,-477.058 836,-512 856.456,-519.726 876.257,-534.668 890.372,-547.031"/>
<polygon fill="#000000" stroke="#000000" points="888.229,-549.812 897.988,-553.937 892.932,-544.627 888.229,-549.812"/>
</g>
<!-- proc~neut_rates&#45;&gt;proc~normp -->
<g id="edge112" class="edge"><title>proc~neut_rates&#45;&gt;proc~normp</title>
<path fill="none" stroke="#000000" d="M544.27,-498.079C556.899,-516.365 579.586,-550.94 594,-583 626.244,-654.716 649.803,-745.341 659.758,-787.063"/>
<polygon fill="#000000" stroke="#000000" points="656.351,-787.868 662.045,-796.803 663.166,-786.267 656.351,-787.868"/>
</g>
<!-- proc~randn&#45;&gt;omp_get_thread_num -->
<g id="edge102" class="edge"><title>proc~randn&#45;&gt;omp_get_thread_num</title>
<path fill="none" stroke="#000000" d="M433.043,-431.776C448.699,-426.436 468.861,-419.559 487.118,-413.332"/>
<polygon fill="#000000" stroke="#000000" points="488.404,-416.591 496.739,-410.05 486.145,-409.966 488.404,-416.591"/>
</g>
<!-- proc~rng_normal -->
<g id="node97" class="node"><title>proc~rng_normal</title>
<a xlink:href="../proc/rng_normal.html" xlink:title="rng_normal">
<polygon fill="#d94e8f" stroke="#d94e8f" points="568,-454 502,-454 502,-428 568,-428 568,-454"/>
<text text-anchor="middle" x="535" y="-438.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rng_normal</text>
</a>
</g>
<!-- proc~randn&#45;&gt;proc~rng_normal -->
<g id="edge100" class="edge"><title>proc~randn&#45;&gt;proc~rng_normal</title>
<path fill="none" stroke="#000000" d="M433.043,-441C449.826,-441 471.788,-441 491.029,-441"/>
<polygon fill="#000000" stroke="#000000" points="491.094,-444.5 501.094,-441 491.094,-437.5 491.094,-444.5"/>
</g>
<!-- proc~rng_normal&#45;&gt;proc~rng_uniform -->
<g id="edge98" class="edge"><title>proc~rng_normal&#45;&gt;proc~rng_uniform</title>
<path fill="none" stroke="#000000" d="M568.817,-430.335C584.539,-425.376 603.451,-419.412 620.329,-414.088"/>
<polygon fill="#000000" stroke="#000000" points="621.509,-417.387 629.993,-411.041 619.403,-410.711 621.509,-417.387"/>
</g>
</g>
</svg>
</div>
                <script>var panprocfida_mcCallsGraph = svgPanZoom('#procfida_mcCallsGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
Nodes of different colours represent the following:
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.80" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph1" class="graph" transform="scale(0.817602 0.817602) rotate(0) translate(4 30)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-30 781,-30 781,5 -4,5"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-26 2.13163e-14,-26 0,-1.24345e-14 54,-3.55271e-15 54,-26"/>
<text text-anchor="middle" x="27" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="138,-26 72,-26 72,-1.24345e-14 138,-3.55271e-15 138,-26"/>
<text text-anchor="middle" x="105" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Type -->
<g id="node3" class="node"><title>Type</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="210,-26 156,-26 156,-1.24345e-14 210,-3.55271e-15 210,-26"/>
<text text-anchor="middle" x="183" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type</text>
</g>
<!-- Subroutine -->
<g id="node4" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="292,-26 228,-26 228,-1.24345e-14 292,-3.55271e-15 292,-26"/>
<text text-anchor="middle" x="260" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node5" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="364,-26 310,-26 310,-1.24345e-14 364,-3.55271e-15 364,-26"/>
<text text-anchor="middle" x="337" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node6" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="436,-26 382,-26 382,-1.24345e-14 436,-3.55271e-15 436,-26"/>
<text text-anchor="middle" x="409" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node7" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="590,-26 454,-26 454,-1.24345e-14 590,-3.55271e-15 590,-26"/>
<text text-anchor="middle" x="522" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node8" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="662,-26 608,-26 608,-1.24345e-14 662,-3.55271e-15 662,-26"/>
<text text-anchor="middle" x="635" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node9" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="776,-26 680,-26 680,-1.24345e-14 776,-3.55271e-15 776,-26"/>
<text text-anchor="middle" x="728" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

Where possible, edges connecting nodes are given different colours to make them
easier to distinguish in large graphs.
<h5>Module Graph</h5>
<p>Solid arrows point from a parent (sub)module to the submodule which is
descended from it. Dashed arrows point from a module being used to the
module using it.</p>
<h5>Type Graph</h5>
<p>Solid arrows point from one derived type to another which extends
(inherits from) it. Dashed arrows point from a derived type to another
type containing it as a components, with a label listing the name(s) of
said component(s).</p>
<h5>Call Graph</h5>
<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.</p>

                      </div>
                    </div>
                  </div>
                </div>
                
     
     
     <h3>Called By</h3>
     
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: proc~~fida_mc~~CalledByGraph Pages: 1 -->
<svg id="procfida_mcCalledByGraph" width="152pt" height="34pt"
 viewBox="0.00 0.00 152.00 34.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~fida_mc~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 30)">
<title>proc~~fida_mc~~CalledByGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-30 149,-30 149,5 -4,5"/>
<!-- proc~fida_mc -->
<g id="node1" class="node"><title>proc~fida_mc</title>
<polygon fill="none" stroke="black" points="144,-26 90,-26 90,-1.24345e-14 144,-3.55271e-15 144,-26"/>
<text text-anchor="middle" x="117" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50">fida_mc</text>
</g>
<!-- program~fidasim -->
<g id="node2" class="node"><title>program~fidasim</title>
<a xlink:href="../program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-26 2.13163e-14,-26 0,-1.24345e-14 54,-3.55271e-15 54,-26"/>
<text text-anchor="middle" x="27" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
<!-- program~fidasim&#45;&gt;proc~fida_mc -->
<g id="edge2" class="edge"><title>program~fidasim&#45;&gt;proc~fida_mc</title>
<path fill="none" stroke="#000000" d="M54.003,-13C62.0277,-13 70.9665,-13 79.5309,-13"/>
<polygon fill="#000000" stroke="#000000" points="79.7051,-16.5001 89.705,-13 79.705,-9.5001 79.7051,-16.5001"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
Nodes of different colours represent the following:
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.80" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph1" class="graph" transform="scale(0.817602 0.817602) rotate(0) translate(4 30)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-30 781,-30 781,5 -4,5"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-26 2.13163e-14,-26 0,-1.24345e-14 54,-3.55271e-15 54,-26"/>
<text text-anchor="middle" x="27" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="138,-26 72,-26 72,-1.24345e-14 138,-3.55271e-15 138,-26"/>
<text text-anchor="middle" x="105" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Type -->
<g id="node3" class="node"><title>Type</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="210,-26 156,-26 156,-1.24345e-14 210,-3.55271e-15 210,-26"/>
<text text-anchor="middle" x="183" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type</text>
</g>
<!-- Subroutine -->
<g id="node4" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="292,-26 228,-26 228,-1.24345e-14 292,-3.55271e-15 292,-26"/>
<text text-anchor="middle" x="260" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node5" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="364,-26 310,-26 310,-1.24345e-14 364,-3.55271e-15 364,-26"/>
<text text-anchor="middle" x="337" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node6" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="436,-26 382,-26 382,-1.24345e-14 436,-3.55271e-15 436,-26"/>
<text text-anchor="middle" x="409" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node7" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="590,-26 454,-26 454,-1.24345e-14 590,-3.55271e-15 590,-26"/>
<text text-anchor="middle" x="522" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node8" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="662,-26 608,-26 608,-1.24345e-14 662,-3.55271e-15 662,-26"/>
<text text-anchor="middle" x="635" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node9" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="776,-26 680,-26 680,-1.24345e-14 776,-3.55271e-15 776,-26"/>
<text text-anchor="middle" x="728" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

Where possible, edges connecting nodes are given different colours to make them
easier to distinguish in large graphs.
<h5>Module Graph</h5>
<p>Solid arrows point from a parent (sub)module to the submodule which is
descended from it. Dashed arrows point from a module being used to the
module using it.</p>
<h5>Type Graph</h5>
<p>Solid arrows point from one derived type to another which extends
(inherits from) it. Dashed arrows point from a derived type to another
type containing it as a components, with a label listing the name(s) of
said component(s).</p>
<h5>Call Graph</h5>
<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.</p>

                      </div>
                    </div>
                  </div>
                </div>
                
     
    <br>
    
    <section>
    <h2>Variables</h2>
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Visibility</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iion%7E2"></span>integer,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>iion</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iphi"></span>integer,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>iphi</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-fast_ion%7E2"></span>type(<a href='../type/fastion.html'>FastIon</a>),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>fast_ion</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-fields%7E12"></span>type(<a href='../type/localemfields.html'>LocalEMFields</a>),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>fields</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-plasma%7E12"></span>type(<a href='../type/localprofiles.html'>LocalProfiles</a>),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>plasma</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-phi%7E6"></span>real(kind=Float64),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>phi</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-theta%7E4"></span>real(kind=Float64),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>theta</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ri%7E12"></span>real(kind=Float64),</td>
  
  <td>public,</td>
  <td>dimension(3)</td><td>::</td>
  <td><strong>ri</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-vi%7E16"></span>real(kind=Float64),</td>
  
  <td>public,</td>
  <td>dimension(3)</td><td>::</td>
  <td><strong>vi</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-vi_norm%7E2"></span>real(kind=Float64),</td>
  
  <td>public,</td>
  <td>dimension(3)</td><td>::</td>
  <td><strong>vi_norm</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-denn%7E6"></span>real(kind=Float64),</td>
  
  <td>public,</td>
  <td>dimension(nlevs)</td><td>::</td>
  <td><strong>denn</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-prob%7E5"></span>real(kind=Float64),</td>
  
  <td>public,</td>
  <td>dimension(nlevs)</td><td>::</td>
  <td><strong>prob</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-states%7E7"></span>real(kind=Float64),</td>
  
  <td>public,</td>
  <td>dimension(nlevs)</td><td>::</td>
  <td><strong>states</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ncell%7E7"></span>integer,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>ncell</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-tracks%7E7"></span>type(<a href='../type/particletrack.html'>ParticleTrack</a>),</td>
  
  <td>public,</td>
  <td>dimension(beam_grid%ntrack)</td><td>::</td>
  <td><strong>tracks</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-los_intersect%7E3"></span>logical,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>los_intersect</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-jj%7E5"></span>integer,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>jj</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-photons%7E12"></span>real(kind=Float64),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>photons</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-neut_types%7E3"></span>integer,</td>
  
  <td>public,</td>
  <td>dimension(4)</td><td>::</td>
  <td><strong>neut_types</strong></td><td> =</td><td>[1, 2, 3, 4]</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-xyz%7E12"></span>real(kind=Float64),</td>
  
  <td>public,</td>
  <td>dimension(3)</td><td>::</td>
  <td><strong>xyz</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-uvw%7E11"></span>real(kind=Float64),</td>
  
  <td>public,</td>
  <td>dimension(3)</td><td>::</td>
  <td><strong>uvw</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-r_gyro%7E3"></span>real(kind=Float64),</td>
  
  <td>public,</td>
  <td>dimension(3)</td><td>::</td>
  <td><strong>r_gyro</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-uvw_vi"></span>real(kind=Float64),</td>
  
  <td>public,</td>
  <td>dimension(3)</td><td>::</td>
  <td><strong>uvw_vi</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-s%7E8"></span>real(kind=Float64),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>s</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-c%7E5"></span>real(kind=Float64),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>c</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-maxcnt"></span>real(kind=Float64),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>maxcnt</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-inv_maxcnt%7E2"></span>real(kind=Float64),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>inv_maxcnt</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-cnt%7E7"></span>real(kind=Float64),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>cnt</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-randomu%7E6"></span>real(kind=Float64),</td>
  
  <td>public,</td>
  <td>dimension(2)</td><td>::</td>
  <td><strong>randomu</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nlaunch%7E6"></span>integer(kind=Int32),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>nlaunch</strong></td><td></td><td></td><td></td>
  
</tr>

</tbody>
</table>

    </section>
    <br>
    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">fida_mc</span>
    <span class="c">!+ Calculate FIDA emission using a Monte Carlo Fast-ion distribution</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iion</span><span class="p">,</span><span class="n">iphi</span>
    <span class="k">type</span><span class="p">(</span><span class="n">FastIon</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fast_ion</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalEMFields</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fields</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span> <span class="kd">::</span> <span class="n">plasma</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">phi</span><span class="p">,</span><span class="n">theta</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ri</span>      <span class="c">!! start position</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vi</span><span class="p">,</span><span class="n">vi_norm</span>      <span class="c">!! velocity of fast ions</span>
    <span class="c">!! Determination of the CX probability</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">denn</span>    <span class="c">!!  neutral dens (n=1-4)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">prob</span>    <span class="c">!! Prob. for CX </span>
    <span class="c">!! Collisiional radiative model along track</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">states</span>  <span class="c">! Density of n-states</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ncell</span>
    <span class="k">type</span><span class="p">(</span><span class="n">ParticleTrack</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ntrack</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tracks</span>
    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">los_intersect</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">jj</span>      <span class="c">!! counter along track</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">photons</span> <span class="c">!! photon flux </span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">neut_types</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">uvw</span><span class="p">,</span> <span class="n">r_gyro</span><span class="p">,</span> <span class="n">uvw_vi</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">s</span><span class="p">,</span> <span class="n">c</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">maxcnt</span><span class="p">,</span> <span class="n">inv_maxcnt</span><span class="p">,</span> <span class="n">cnt</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">randomu</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">Int32</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nlaunch</span>
  
    <span class="n">maxcnt</span><span class="o">=</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span>
    <span class="n">inv_maxcnt</span> <span class="o">=</span> <span class="mi">10</span><span class="mf">0.</span><span class="n">d0</span><span class="o">/</span><span class="n">maxcnt</span>
  
    <span class="n">nlaunch</span> <span class="o">=</span> <span class="nb">ceiling</span><span class="p">(</span><span class="nb">dble</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_fida</span><span class="p">)</span><span class="o">/</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers per mc particle: &quot;,i7)&#39;</span><span class="p">)</span> <span class="nb">int</span><span class="p">(</span><span class="n">nlaunch</span><span class="p">)</span>
    <span class="n">endif</span>

    <span class="n">cnt</span><span class="o">=</span><span class="mf">0.0</span>
    <span class="c">!$OMP PARALLEL DO schedule(guided) private(iion,iphi,fast_ion,vi,vi_norm,ri,phi,fields,tracks,s,c, &amp;</span>
    <span class="c">!$OMP&amp; plasma,theta,randomu,xyz,uvw,uvw_vi,r_gyro,ncell,jj,prob,denn,los_intersect,states,photons)</span>
    <span class="n">loop_over_fast_ions</span><span class="p">:</span> <span class="k">do </span><span class="n">iion</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">particles</span><span class="p">%</span><span class="n">nparticle</span>
        <span class="n">fast_ion</span> <span class="o">=</span> <span class="n">particles</span><span class="p">%</span><span class="n">fast_ion</span><span class="p">(</span><span class="n">iion</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vabs</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">loop_over_fast_ions</span>
        <span class="k">if</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">cross_grid</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">phi_loop</span><span class="p">:</span> <span class="k">do </span><span class="n">iphi</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nlaunch</span>
                <span class="c">!! Pick random torodial angle</span>
                <span class="k">call </span><span class="n">randu</span><span class="p">(</span><span class="n">randomu</span><span class="p">)</span>
                <span class="n">phi</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">phi_enter</span> <span class="o">+</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">delta_phi</span><span class="o">*</span><span class="n">randomu</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">s</span> <span class="o">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="nb">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
                <span class="n">uvw</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">c</span>
                <span class="n">uvw</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">r</span><span class="o">*</span><span class="n">s</span>
                <span class="n">uvw</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">z</span>
                <span class="k">call </span><span class="n">uvw_to_xyz</span><span class="p">(</span><span class="n">uvw</span><span class="p">,</span><span class="n">xyz</span><span class="p">)</span>
  
                <span class="k">if</span><span class="p">(</span><span class="n">particles</span><span class="p">%</span><span class="n">guiding_center</span><span class="p">)</span> <span class="k">then</span>          
                    <span class="c">!! Pick random gyroangle</span>
                    <span class="n">theta</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">randomu</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                    <span class="k">call </span><span class="n">get_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">xyz</span><span class="p">)</span>
   
                    <span class="k">call </span><span class="n">pitch_to_vec</span><span class="p">(</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">pitch</span><span class="p">,</span><span class="n">theta</span><span class="p">,</span><span class="n">fields</span><span class="p">,</span><span class="n">vi_norm</span><span class="p">)</span>
                    <span class="n">vi</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">vabs</span><span class="o">*</span><span class="n">vi_norm</span>
   
                    <span class="k">call </span><span class="n">gyro_correction</span><span class="p">(</span><span class="n">vi</span><span class="p">,</span><span class="n">fields</span><span class="p">,</span><span class="n">r_gyro</span><span class="p">)</span>
                    <span class="n">ri</span> <span class="o">=</span> <span class="n">xyz</span> <span class="o">-</span> <span class="n">r_gyro</span>
                <span class="k">else</span>
<span class="k">                    </span><span class="n">uvw_vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vr</span> <span class="o">-</span> <span class="n">s</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vt</span>
                    <span class="n">uvw_vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vr</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">vt</span>
                    <span class="n">uvw_vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">fast_ion</span><span class="p">%</span><span class="n">vz</span>
  
                    <span class="n">vi</span> <span class="o">=</span> <span class="nb">matmul</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">inv_basis</span><span class="p">,</span><span class="n">uvw_vi</span><span class="p">)</span>
                    <span class="n">ri</span> <span class="o">=</span> <span class="n">xyz</span>
                <span class="n">endif</span>
   
                <span class="k">call </span><span class="n">track</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">,</span> <span class="n">tracks</span><span class="p">,</span> <span class="n">ncell</span><span class="p">,</span> <span class="n">los_intersect</span><span class="p">)</span>
                <span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">los_intersect</span><span class="p">)</span> <span class="k">cycle </span><span class="n">phi_loop</span>
                <span class="k">if</span><span class="p">(</span><span class="n">ncell</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">cycle </span><span class="n">phi_loop</span>
  
                <span class="c">!! Calculate CX probability</span>
                <span class="k">call </span><span class="n">get_beam_cx_prob</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">ind</span><span class="p">,</span><span class="n">ri</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">neut_types</span><span class="p">,</span><span class="n">prob</span><span class="p">)</span>
                <span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">prob</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span><span class="k">cycle </span><span class="n">phi_loop</span>
  
                <span class="c">!! Calculate the spectra produced in each cell along the path</span>
                <span class="n">states</span><span class="o">=</span><span class="n">prob</span><span class="o">*</span><span class="n">fast_ion</span><span class="p">%</span><span class="n">weight</span>
                <span class="n">loop_along_track</span><span class="p">:</span> <span class="k">do </span><span class="n">jj</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ncell</span>
                    <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">)</span>
  
                    <span class="k">call </span><span class="n">colrad</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">beam_ion</span><span class="p">,</span> <span class="n">vi</span><span class="p">,</span> <span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="nb">time</span><span class="p">,</span> <span class="n">states</span><span class="p">,</span> <span class="n">denn</span><span class="p">,</span> <span class="n">photons</span><span class="p">)</span>
  
                    <span class="k">call </span><span class="n">store_fida_photons</span><span class="p">(</span><span class="n">tracks</span><span class="p">(</span><span class="n">jj</span><span class="p">)%</span><span class="n">pos</span><span class="p">,</span> <span class="n">vi</span><span class="p">,</span> <span class="n">photons</span><span class="o">/</span><span class="nb">dble</span><span class="p">(</span><span class="n">nlaunch</span><span class="p">),</span> <span class="n">fast_ion</span><span class="p">%</span><span class="k">class</span><span class="p">)</span>
                <span class="n">enddo</span> <span class="n">loop_along_track</span>
            <span class="n">enddo</span> <span class="n">phi_loop</span>
        <span class="n">endif</span>
        <span class="n">cnt</span><span class="o">=</span><span class="n">cnt</span><span class="o">+</span><span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="k">then</span>
<span class="k">          WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(f7.2,&quot;% completed&quot;,a,$)&#39;</span><span class="p">)</span> <span class="n">cnt</span><span class="o">*</span><span class="n">inv_maxcnt</span><span class="p">,</span><span class="nb">char</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
        <span class="n">endif</span>
    <span class="n">enddo</span> <span class="n">loop_over_fast_ions</span>
    <span class="c">!$OMP END PARALLEL DO</span>

<span class="k">end subroutine </span><span class="n">fida_mc</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>

    <hr>
    <footer>
      <div class="row">
        <div class="col-md-4">&copy; 2016 </div>
        <div class="col-md-4"><span class="text-center"> FIDASIM was developed by Luke Stagner</span></div>
        <div class="col-md-4">
          <span class="pull-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </span>
        </div>
      </div>
      <br>
    </footer>
    </div> <!-- /container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': { 
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>