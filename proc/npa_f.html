<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="">
    
    <meta name="author" content="Chris MacMackin" >
    <link rel="icon" href="../favicon.png">

    <title>npa_f &ndash; FIDASIM</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FIDASIM <small>1.0.0</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
				
            <li><a href='../page/index.html'>User Guide</a></li>
				
                
            <li><a href="../lists/files.html">Source Files</a></li>
				
				
            <li><a href="../lists/modules.html">Modules</a></li>
				
				
            <li><a href="../lists/procedures.html">Procedures</a></li>
				
								
            <li><a href="../lists/types.html">Derived Types</a></li>
				
				
            <li><a href="../lists/programs.html">Programs</a></li>
				
          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>npa_f
    <small>Subroutine</small>
    
    </h1>
	 
<div class="row">
<div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
    <li><i class="fa fa-code"></i><a href="../src/fidasim.f90"> Source File</a></li>
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
     <li><a href='../sourcefile/fidasim.f90.html'>fidasim.f90</a></li>
  
     <li><a href='../module/libfida.html'>libfida</a></li>
  
     <li class="active">npa_f</li>
  </ol>
</div>
</div>
</div>
    
  </div>
  
  <div class="row">
    <div class="col-lg-3">
    
<div id="sidebar">
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars">Variables</a></h3></div>
    <div id="vars" class="panel-collapse collapse">
      <div class="list-group">
        
        <a class="list-group-item" href="../proc/npa_f.html#variable-i%7E44">i</a>
        
        <a class="list-group-item" href="../proc/npa_f.html#variable-j%7E23">j</a>
        
        <a class="list-group-item" href="../proc/npa_f.html#variable-k%7E12">k</a>
        
        <a class="list-group-item" href="../proc/npa_f.html#variable-iion%7E3">iion</a>
        
        <a class="list-group-item" href="../proc/npa_f.html#variable-det%7E3">det</a>
        
        <a class="list-group-item" href="../proc/npa_f.html#variable-ip%7E3">ip</a>
        
        <a class="list-group-item" href="../proc/npa_f.html#variable-ri%7E13">ri</a>
        
        <a class="list-group-item" href="../proc/npa_f.html#variable-rf%7E5">rf</a>
        
        <a class="list-group-item" href="../proc/npa_f.html#variable-vi%7E17">vi</a>
        
        <a class="list-group-item" href="../proc/npa_f.html#variable-ind%7E24">ind</a>
        
        <a class="list-group-item" href="../proc/npa_f.html#variable-pcell%7E2">pcell</a>
        
        <a class="list-group-item" href="../proc/npa_f.html#variable-plasma%7E13">plasma</a>
        
        <a class="list-group-item" href="../proc/npa_f.html#variable-neut_types%7E4">neut_types</a>
        
        <a class="list-group-item" href="../proc/npa_f.html#variable-prob%7E6">prob</a>
        
        <a class="list-group-item" href="../proc/npa_f.html#variable-states%7E8">states</a>
        
        <a class="list-group-item" href="../proc/npa_f.html#variable-flux%7E5">flux</a>
        
        <a class="list-group-item" href="../proc/npa_f.html#variable-inpa">inpa</a>
        
        <a class="list-group-item" href="../proc/npa_f.html#variable-pcnt%7E2">pcnt</a>
        
        <a class="list-group-item" href="../proc/npa_f.html#variable-papprox_tot%7E5">papprox_tot</a>
        
        <a class="list-group-item" href="../proc/npa_f.html#variable-maxcnt%7E2">maxcnt</a>
        
        <a class="list-group-item" href="../proc/npa_f.html#variable-cnt%7E8">cnt</a>
        
        <a class="list-group-item" href="../proc/npa_f.html#variable-inv_maxcnt%7E3">inv_maxcnt</a>
        
        <a class="list-group-item" href="../proc/npa_f.html#variable-papprox%7E5">papprox</a>
        
        <a class="list-group-item" href="../proc/npa_f.html#variable-nlaunch%7E7">nlaunch</a>
        
      </div>
    </div>
  </div>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
    <div class="list-group">
      <a class="list-group-item" href="../proc/npa_f.html#src">npa_f</a>
    </div>
  </div>
  
  <hr>
  
  <div class="panel panel-default">
    <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allprocs">All Procedures</a></h3></div>
    <div id="allprocs" class="panel-collapse collapse">
        <div class="list-group">
          
          <a class="list-group-item" href="../proc/aq_cx.html">Aq_cx</a>
          
          <a class="list-group-item" href="../proc/aq_cx_n.html">Aq_cx_n</a>
          
          <a class="list-group-item" href="../proc/aq_cx_n_adas.html">Aq_cx_n_adas</a>
          
          <a class="list-group-item" href="../proc/aq_cx_n_janev.html">Aq_cx_n_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit.html">Aq_excit</a>
          
          <a class="list-group-item" href="../proc/aq_excit_1_2_janev.html">Aq_excit_1_2_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_1_3_janev.html">Aq_excit_1_3_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_1_4_janev.html">Aq_excit_1_4_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_1_5_janev.html">Aq_excit_1_5_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_1_janev.html">Aq_excit_1_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_10_janev.html">Aq_excit_2_10_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_3_janev.html">Aq_excit_2_3_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_4_janev.html">Aq_excit_2_4_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_5_janev.html">Aq_excit_2_5_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_6_janev.html">Aq_excit_2_6_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_7_janev.html">Aq_excit_2_7_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_8_janev.html">Aq_excit_2_8_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_9_janev.html">Aq_excit_2_9_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_2_janev.html">Aq_excit_2_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_3_10_janev.html">Aq_excit_3_10_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_3_4_janev.html">Aq_excit_3_4_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_3_5_janev.html">Aq_excit_3_5_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_3_6_janev.html">Aq_excit_3_6_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_3_7_janev.html">Aq_excit_3_7_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_3_8_janev.html">Aq_excit_3_8_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_3_9_janev.html">Aq_excit_3_9_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_3_janev.html">Aq_excit_3_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_n.html">Aq_excit_n</a>
          
          <a class="list-group-item" href="../proc/aq_excit_n_janev.html">Aq_excit_n_janev</a>
          
          <a class="list-group-item" href="../proc/aq_excit_n_m.html">Aq_excit_n_m</a>
          
          <a class="list-group-item" href="../proc/aq_ioniz.html">Aq_ioniz</a>
          
          <a class="list-group-item" href="../proc/aq_ioniz_n.html">Aq_ioniz_n</a>
          
          <a class="list-group-item" href="../proc/aq_ioniz_n_janev.html">Aq_ioniz_n_janev</a>
          
          <a class="list-group-item" href="../interface/assignment%28%3D%29.html">assignment(=)</a>
          
          <a class="list-group-item" href="../proc/attenuate.html">attenuate</a>
          
          <a class="list-group-item" href="../proc/b5_cx_1_adas.html">B5_cx_1_adas</a>
          
          <a class="list-group-item" href="../proc/b5_cx_1_janev.html">B5_cx_1_janev</a>
          
          <a class="list-group-item" href="../proc/b5_cx_2_adas.html">B5_cx_2_adas</a>
          
          <a class="list-group-item" href="../proc/b5_ioniz_1_janev.html">B5_ioniz_1_janev</a>
          
          <a class="list-group-item" href="../proc/balance.html">balance</a>
          
          <a class="list-group-item" href="../proc/balback.html">balback</a>
          
          <a class="list-group-item" href="../proc/bremsstrahlung.html">bremsstrahlung</a>
          
          <a class="list-group-item" href="../interface/bt_maxwellian.html">bt_maxwellian</a>
          
          <a class="list-group-item" href="../proc/bt_maxwellian_n.html">bt_maxwellian_n</a>
          
          <a class="list-group-item" href="../proc/bt_maxwellian_n_m.html">bt_maxwellian_n_m</a>
          
          <a class="list-group-item" href="../proc/bt_maxwellian_q_n.html">bt_maxwellian_q_n</a>
          
          <a class="list-group-item" href="../proc/bt_maxwellian_q_n_m.html">bt_maxwellian_q_n_m</a>
          
          <a class="list-group-item" href="../proc/c6_cx_1_adas.html">C6_cx_1_adas</a>
          
          <a class="list-group-item" href="../proc/c6_cx_1_janev.html">C6_cx_1_janev</a>
          
          <a class="list-group-item" href="../proc/c6_cx_2_adas.html">C6_cx_2_adas</a>
          
          <a class="list-group-item" href="../proc/c6_cx_3_adas.html">C6_cx_3_adas</a>
          
          <a class="list-group-item" href="../proc/c6_ioniz_1_janev.html">C6_ioniz_1_janev</a>
          
          <a class="list-group-item" href="../proc/calc_perp_vectors.html">calc_perp_vectors</a>
          
          <a class="list-group-item" href="../proc/check_compression_availability.html">check_compression_availability</a>
          
          <a class="list-group-item" href="../proc/colrad.html">colrad</a>
          
          <a class="list-group-item" href="../proc/comabs.html">comabs</a>
          
          <a class="list-group-item" href="../proc/comdiv.html">Comdiv</a>
          
          <a class="list-group-item" href="../proc/cross_product.html">cross_product</a>
          
          <a class="list-group-item" href="../proc/dcx.html">dcx</a>
          
          <a class="list-group-item" href="../proc/e_excit.html">e_excit</a>
          
          <a class="list-group-item" href="../proc/e_excit_1_2_janev.html">e_excit_1_2_janev</a>
          
          <a class="list-group-item" href="../proc/e_excit_1_3_janev.html">e_excit_1_3_janev</a>
          
          <a class="list-group-item" href="../proc/e_excit_1_4_janev.html">e_excit_1_4_janev</a>
          
          <a class="list-group-item" href="../proc/e_excit_1_5_janev.html">e_excit_1_5_janev</a>
          
          <a class="list-group-item" href="../proc/e_excit_1_janev.html">e_excit_1_janev</a>
          
          <a class="list-group-item" href="../proc/e_excit_2_3_janev.html">e_excit_2_3_janev</a>
          
          <a class="list-group-item" href="../proc/e_excit_f.html">e_excit_f</a>
          
          <a class="list-group-item" href="../proc/e_excit_n.html">e_excit_n</a>
          
          <a class="list-group-item" href="../proc/e_excit_n_m.html">e_excit_n_m</a>
          
          <a class="list-group-item" href="../proc/e_ioniz.html">e_ioniz</a>
          
          <a class="list-group-item" href="../proc/e_ioniz_1_janev.html">e_ioniz_1_janev</a>
          
          <a class="list-group-item" href="../proc/e_ioniz_2_janev.html">e_ioniz_2_janev</a>
          
          <a class="list-group-item" href="../proc/e_ioniz_3_janev.html">e_ioniz_3_janev</a>
          
          <a class="list-group-item" href="../proc/e_ioniz_n.html">e_ioniz_n</a>
          
          <a class="list-group-item" href="../proc/eigen.html">eigen</a>
          
          <a class="list-group-item" href="../proc/elmhes.html">elmhes</a>
          
          <a class="list-group-item" href="../proc/elmtrans.html">elmtrans</a>
          
          <a class="list-group-item" href="../proc/fast_ion_assign.html">fast_ion_assign</a>
          
          <a class="list-group-item" href="../proc/ff_add.html">ff_add</a>
          
          <a class="list-group-item" href="../proc/ff_assign.html">ff_assign</a>
          
          <a class="list-group-item" href="../proc/ff_subtract.html">ff_subtract</a>
          
          <a class="list-group-item" href="../proc/fida_f.html">fida_f</a>
          
          <a class="list-group-item" href="../proc/fida_mc.html">fida_mc</a>
          
          <a class="list-group-item" href="../proc/fida_weights_los.html">fida_weights_los</a>
          
          <a class="list-group-item" href="../proc/fida_weights_mc.html">fida_weights_mc</a>
          
          <a class="list-group-item" href="../proc/flf_assign.html">flf_assign</a>
          
          <a class="list-group-item" href="../proc/fs_divide.html">fs_divide</a>
          
          <a class="list-group-item" href="../proc/fs_multiply.html">fs_multiply</a>
          
          <a class="list-group-item" href="../proc/get_beam_cx_prob.html">get_beam_cx_prob</a>
          
          <a class="list-group-item" href="../proc/get_distribution.html">get_distribution</a>
          
          <a class="list-group-item" href="../proc/get_ep_denf.html">get_ep_denf</a>
          
          <a class="list-group-item" href="../proc/get_fields.html">get_fields</a>
          
          <a class="list-group-item" href="../proc/get_indices.html">get_indices</a>
          
          <a class="list-group-item" href="../proc/get_nlaunch.html">get_nlaunch</a>
          
          <a class="list-group-item" href="../proc/get_plasma.html">get_plasma</a>
          
          <a class="list-group-item" href="../proc/get_position.html">get_position</a>
          
          <a class="list-group-item" href="../proc/get_rate_matrix.html">get_rate_matrix</a>
          
          <a class="list-group-item" href="../proc/grid_intersect.html">grid_intersect</a>
          
          <a class="list-group-item" href="../proc/gyro_correction.html">gyro_correction</a>
          
          <a class="list-group-item" href="../interface/h5ltmake_compressed_dataset_double_f.html">h5ltmake_compressed_dataset_double_f</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_double_f_1.html">h5ltmake_compressed_dataset_double_f_1</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_double_f_2.html">h5ltmake_compressed_dataset_double_f_2</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_double_f_3.html">h5ltmake_compressed_dataset_double_f_3</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_double_f_4.html">h5ltmake_compressed_dataset_double_f_4</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_double_f_5.html">h5ltmake_compressed_dataset_double_f_5</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_double_f_6.html">h5ltmake_compressed_dataset_double_f_6</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_double_f_7.html">h5ltmake_compressed_dataset_double_f_7</a>
          
          <a class="list-group-item" href="../interface/h5ltmake_compressed_dataset_int_f.html">h5ltmake_compressed_dataset_int_f</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_int_f_1.html">h5ltmake_compressed_dataset_int_f_1</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_int_f_2.html">h5ltmake_compressed_dataset_int_f_2</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_int_f_3.html">h5ltmake_compressed_dataset_int_f_3</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_int_f_4.html">h5ltmake_compressed_dataset_int_f_4</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_int_f_5.html">h5ltmake_compressed_dataset_int_f_5</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_int_f_6.html">h5ltmake_compressed_dataset_int_f_6</a>
          
          <a class="list-group-item" href="../proc/h5ltmake_compressed_dataset_int_f_7.html">h5ltmake_compressed_dataset_int_f_7</a>
          
          <a class="list-group-item" href="../proc/h5ltread_dataset_double_scalar_f.html">h5ltread_dataset_double_scalar_f</a>
          
          <a class="list-group-item" href="../proc/h5ltread_dataset_int_scalar_f.html">h5ltread_dataset_int_scalar_f</a>
          
          <a class="list-group-item" href="../proc/halo.html">halo</a>
          
          <a class="list-group-item" href="../proc/hit_npa_detector.html">hit_npa_detector</a>
          
          <a class="list-group-item" href="../proc/hqr2.html">hqr2</a>
          
          <a class="list-group-item" href="../proc/hqrvec.html">hqrvec</a>
          
          <a class="list-group-item" href="../proc/in_boundary.html">in_boundary</a>
          
          <a class="list-group-item" href="../proc/in_plasma.html">in_plasma</a>
          
          <a class="list-group-item" href="../proc/ind2sub.html">ind2sub</a>
          
          <a class="list-group-item" href="../interface/interpol.html">interpol</a>
          
          <a class="list-group-item" href="../proc/interpol1d_arr.html">interpol1D_arr</a>
          
          <a class="list-group-item" href="../proc/interpol1d_coeff.html">interpol1D_coeff</a>
          
          <a class="list-group-item" href="../proc/interpol1d_coeff_arr.html">interpol1D_coeff_arr</a>
          
          <a class="list-group-item" href="../proc/interpol2d_2d_arr.html">interpol2D_2D_arr</a>
          
          <a class="list-group-item" href="../proc/interpol2d_arr.html">interpol2D_arr</a>
          
          <a class="list-group-item" href="../proc/interpol2d_coeff.html">interpol2D_coeff</a>
          
          <a class="list-group-item" href="../proc/interpol2d_coeff_arr.html">interpol2D_coeff_arr</a>
          
          <a class="list-group-item" href="../interface/interpol_coeff.html">interpol_coeff</a>
          
          <a class="list-group-item" href="../proc/lff_assign.html">lff_assign</a>
          
          <a class="list-group-item" href="../proc/lflf_add.html">lflf_add</a>
          
          <a class="list-group-item" href="../proc/lflf_assign.html">lflf_assign</a>
          
          <a class="list-group-item" href="../proc/lflf_subtract.html">lflf_subtract</a>
          
          <a class="list-group-item" href="../proc/lfs_divide.html">lfs_divide</a>
          
          <a class="list-group-item" href="../proc/lfs_multiply.html">lfs_multiply</a>
          
          <a class="list-group-item" href="../proc/line_basis.html">line_basis</a>
          
          <a class="list-group-item" href="../proc/lplp_add.html">lplp_add</a>
          
          <a class="list-group-item" href="../proc/lplp_assign.html">lplp_assign</a>
          
          <a class="list-group-item" href="../proc/lplp_subtract.html">lplp_subtract</a>
          
          <a class="list-group-item" href="../proc/lpp_assign.html">lpp_assign</a>
          
          <a class="list-group-item" href="../proc/lps_divide.html">lps_divide</a>
          
          <a class="list-group-item" href="../proc/lps_multiply.html">lps_multiply</a>
          
          <a class="list-group-item" href="../proc/lubksb.html">lubksb</a>
          
          <a class="list-group-item" href="../proc/ludcmp.html">ludcmp</a>
          
          <a class="list-group-item" href="../proc/m_spread.html">m_spread</a>
          
          <a class="list-group-item" href="../proc/make_beam_grid.html">make_beam_grid</a>
          
          <a class="list-group-item" href="../proc/matinv.html">matinv</a>
          
          <a class="list-group-item" href="../proc/mc_fastion.html">mc_fastion</a>
          
          <a class="list-group-item" href="../proc/mc_halo.html">mc_halo</a>
          
          <a class="list-group-item" href="../proc/mc_nbi.html">mc_nbi</a>
          
          <a class="list-group-item" href="../proc/ndmc.html">ndmc</a>
          
          <a class="list-group-item" href="../proc/neut_rates.html">neut_rates</a>
          
          <a class="list-group-item" href="../proc/normp.html">normp</a>
          
          <a class="list-group-item" href="../proc/npa_f.html">npa_f</a>
          
          <a class="list-group-item" href="../proc/npa_mc.html">npa_mc</a>
          
          <a class="list-group-item" href="../proc/npa_part_assign.html">npa_part_assign</a>
          
          <a class="list-group-item" href="../proc/npa_weights.html">npa_weights</a>
          
          <a class="list-group-item" href="../interface/operator%28%2A%29.html">operator(*)</a>
          
          <a class="list-group-item" href="../interface/operator%28%2B%29.html">operator(+)</a>
          
          <a class="list-group-item" href="../interface/operator%28-%29.html">operator(-)</a>
          
          <a class="list-group-item" href="../interface/operator%28SLASH%29.html">operator(/)</a>
          
          <a class="list-group-item" href="../proc/outerprod.html">outerprod</a>
          
          <a class="list-group-item" href="../proc/p_cx.html">p_cx</a>
          
          <a class="list-group-item" href="../proc/p_cx_1.html">p_cx_1</a>
          
          <a class="list-group-item" href="../proc/p_cx_1_1_adas.html">p_cx_1_1_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_1_2_adas.html">p_cx_1_2_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_1_3_adas.html">p_cx_1_3_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_1_4_adas.html">p_cx_1_4_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_1_janev.html">p_cx_1_janev</a>
          
          <a class="list-group-item" href="../proc/p_cx_2.html">p_cx_2</a>
          
          <a class="list-group-item" href="../proc/p_cx_2_2_adas.html">p_cx_2_2_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_2_3_adas.html">p_cx_2_3_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_2_janev.html">p_cx_2_janev</a>
          
          <a class="list-group-item" href="../proc/p_cx_3.html">p_cx_3</a>
          
          <a class="list-group-item" href="../proc/p_cx_3_2_adas.html">p_cx_3_2_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_3_3_adas.html">p_cx_3_3_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_3_4_adas.html">p_cx_3_4_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_3_5_adas.html">p_cx_3_5_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_3_6inf_adas.html">p_cx_3_6inf_adas</a>
          
          <a class="list-group-item" href="../proc/p_cx_3_janev.html">p_cx_3_janev</a>
          
          <a class="list-group-item" href="../proc/p_cx_janev.html">p_cx_janev</a>
          
          <a class="list-group-item" href="../proc/p_cx_n.html">p_cx_n</a>
          
          <a class="list-group-item" href="../proc/p_cx_n_janev.html">p_cx_n_janev</a>
          
          <a class="list-group-item" href="../proc/p_cx_n_m.html">p_cx_n_m</a>
          
          <a class="list-group-item" href="../proc/p_excit.html">p_excit</a>
          
          <a class="list-group-item" href="../proc/p_excit_1_2_janev.html">p_excit_1_2_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_1_3_janev.html">p_excit_1_3_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_1_4_janev.html">p_excit_1_4_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_1_5_janev.html">p_excit_1_5_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_1_6_janev.html">p_excit_1_6_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_1_janev.html">p_excit_1_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_10_janev.html">p_excit_2_10_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_3_janev.html">p_excit_2_3_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_4_janev.html">p_excit_2_4_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_5_janev.html">p_excit_2_5_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_6_janev.html">p_excit_2_6_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_7_janev.html">p_excit_2_7_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_8_janev.html">p_excit_2_8_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_9_janev.html">p_excit_2_9_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_2_janev.html">p_excit_2_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_3_10_janev.html">p_excit_3_10_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_3_4_janev.html">p_excit_3_4_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_3_5_janev.html">p_excit_3_5_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_3_6_janev.html">p_excit_3_6_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_3_7_janev.html">p_excit_3_7_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_3_8_janev.html">p_excit_3_8_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_3_9_janev.html">p_excit_3_9_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_3_janev.html">p_excit_3_janev</a>
          
          <a class="list-group-item" href="../proc/p_excit_n.html">p_excit_n</a>
          
          <a class="list-group-item" href="../proc/p_excit_n_m.html">p_excit_n_m</a>
          
          <a class="list-group-item" href="../proc/p_ioniz.html">p_ioniz</a>
          
          <a class="list-group-item" href="../proc/p_ioniz_1_janev.html">p_ioniz_1_janev</a>
          
          <a class="list-group-item" href="../proc/p_ioniz_2_omullane.html">p_ioniz_2_omullane</a>
          
          <a class="list-group-item" href="../proc/p_ioniz_3_omullane.html">p_ioniz_3_omullane</a>
          
          <a class="list-group-item" href="../proc/p_ioniz_4_omullane.html">p_ioniz_4_omullane</a>
          
          <a class="list-group-item" href="../proc/p_ioniz_5_omullane.html">p_ioniz_5_omullane</a>
          
          <a class="list-group-item" href="../proc/p_ioniz_n.html">p_ioniz_n</a>
          
          <a class="list-group-item" href="../proc/pitch_to_vec.html">pitch_to_vec</a>
          
          <a class="list-group-item" href="../proc/plane_basis.html">plane_basis</a>
          
          <a class="list-group-item" href="../proc/plane_intercept.html">plane_intercept</a>
          
          <a class="list-group-item" href="../proc/plp_assign.html">plp_assign</a>
          
          <a class="list-group-item" href="../proc/pp_add.html">pp_add</a>
          
          <a class="list-group-item" href="../proc/pp_assign.html">pp_assign</a>
          
          <a class="list-group-item" href="../proc/pp_subtract.html">pp_subtract</a>
          
          <a class="list-group-item" href="../proc/print_banner.html">print_banner</a>
          
          <a class="list-group-item" href="../proc/print_default_namelist.html">print_default_namelist</a>
          
          <a class="list-group-item" href="../proc/ps_divide.html">ps_divide</a>
          
          <a class="list-group-item" href="../proc/ps_multiply.html">ps_multiply</a>
          
          <a class="list-group-item" href="../interface/randind.html">randind</a>
          
          <a class="list-group-item" href="../proc/randn.html">randn</a>
          
          <a class="list-group-item" href="../proc/randu.html">randu</a>
          
          <a class="list-group-item" href="../proc/read_beam.html">read_beam</a>
          
          <a class="list-group-item" href="../proc/read_chords.html">read_chords</a>
          
          <a class="list-group-item" href="../proc/read_cross.html">read_cross</a>
          
          <a class="list-group-item" href="../proc/read_distribution.html">read_distribution</a>
          
          <a class="list-group-item" href="../proc/read_equilibrium.html">read_equilibrium</a>
          
          <a class="list-group-item" href="../proc/read_f.html">read_f</a>
          
          <a class="list-group-item" href="../proc/read_inputs.html">read_inputs</a>
          
          <a class="list-group-item" href="../proc/read_mc.html">read_mc</a>
          
          <a class="list-group-item" href="../proc/read_neutrals.html">read_neutrals</a>
          
          <a class="list-group-item" href="../proc/read_npa.html">read_npa</a>
          
          <a class="list-group-item" href="../proc/read_rates.html">read_rates</a>
          
          <a class="list-group-item" href="../proc/read_tables.html">read_tables</a>
          
          <a class="list-group-item" href="../proc/rng_init.html">rng_init</a>
          
          <a class="list-group-item" href="../proc/rng_normal.html">rng_normal</a>
          
          <a class="list-group-item" href="../proc/rng_uniform.html">rng_uniform</a>
          
          <a class="list-group-item" href="../proc/rswap.html">RSWAP</a>
          
          <a class="list-group-item" href="../proc/sf_multiply.html">sf_multiply</a>
          
          <a class="list-group-item" href="../proc/simpsons_rule.html">simpsons_rule</a>
          
          <a class="list-group-item" href="../proc/slf_multiply.html">slf_multiply</a>
          
          <a class="list-group-item" href="../proc/slp_multiply.html">slp_multiply</a>
          
          <a class="list-group-item" href="../proc/sp_multiply.html">sp_multiply</a>
          
          <a class="list-group-item" href="../proc/spectrum.html">spectrum</a>
          
          <a class="list-group-item" href="../proc/store_bes_photons.html">store_bes_photons</a>
          
          <a class="list-group-item" href="../proc/store_births.html">store_births</a>
          
          <a class="list-group-item" href="../proc/store_fida_photons.html">store_fida_photons</a>
          
          <a class="list-group-item" href="../proc/store_fw_photons.html">store_fw_photons</a>
          
          <a class="list-group-item" href="../proc/store_fw_photons_at_chan.html">store_fw_photons_at_chan</a>
          
          <a class="list-group-item" href="../proc/store_neutrals.html">store_neutrals</a>
          
          <a class="list-group-item" href="../proc/store_npa.html">store_npa</a>
          
          <a class="list-group-item" href="../proc/swap.html">swap</a>
          
          <a class="list-group-item" href="../proc/tb_zyx.html">tb_zyx</a>
          
          <a class="list-group-item" href="../proc/track.html">track</a>
          
          <a class="list-group-item" href="../proc/uvw_to_xyz.html">uvw_to_xyz</a>
          
          <a class="list-group-item" href="../proc/write_bb_h_aq.html">write_bb_H_Aq</a>
          
          <a class="list-group-item" href="../proc/write_bb_h_e.html">write_bb_H_e</a>
          
          <a class="list-group-item" href="../proc/write_bb_h_h.html">write_bb_H_H</a>
          
          <a class="list-group-item" href="../proc/write_beam_grid.html">write_beam_grid</a>
          
          <a class="list-group-item" href="../proc/write_birth_profile.html">write_birth_profile</a>
          
          <a class="list-group-item" href="../proc/write_bt_h_aq.html">write_bt_H_Aq</a>
          
          <a class="list-group-item" href="../proc/write_bt_h_e.html">write_bt_H_e</a>
          
          <a class="list-group-item" href="../proc/write_bt_h_h.html">write_bt_H_H</a>
          
          <a class="list-group-item" href="../proc/write_dcx.html">write_dcx</a>
          
          <a class="list-group-item" href="../proc/write_einstein.html">write_einstein</a>
          
          <a class="list-group-item" href="../proc/write_fida_weights.html">write_fida_weights</a>
          
          <a class="list-group-item" href="../proc/write_neutrals.html">write_neutrals</a>
          
          <a class="list-group-item" href="../proc/write_npa.html">write_npa</a>
          
          <a class="list-group-item" href="../proc/write_npa_weights.html">write_npa_weights</a>
          
          <a class="list-group-item" href="../proc/write_spectra.html">write_spectra</a>
          
          <a class="list-group-item" href="../proc/xyz_to_uvw.html">xyz_to_uvw</a>
          
        </div>
    </div>
  </div>
  
</div>

    </div>
    
    <div class="col-lg-9" id='text'>
    <h2>
public subroutine npa_f()
    
    
    
</h2>
    
  



    <h3>Arguments</h3>
    
      <em>None</em>
    
    
    
    <h3>Description</h3>
    <p>Calculate NPA flux using a fast-ion distribution function F(E,p,r,z)</p>
    
    
     <h3>Calls</h3>
     
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~npa_f~~CallsGraph Pages: 1 -->
<svg id="procnpa_fCallsGraph" width="641pt" height="476pt"
 viewBox="0.00 0.00 641.00 476.32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~npa_f~~CallsGraph" class="graph" transform="scale(0.521138 0.521138) rotate(0) translate(4 910)">
<title>proc~~npa_f~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-910 1226,-910 1226,4 -4,4"/>
<!-- proc~npa_f -->
<g id="proc~~npa_f~~CallsGraph_node1" class="node"><title>proc~npa_f</title>
<polygon fill="none" stroke="black" points="54,-400 0,-400 0,-376 54,-376 54,-400"/>
<text text-anchor="middle" x="27" y="-385.6" font-family="Helvetica,sans-Serif" font-size="10.50">npa_f</text>
</g>
<!-- proc~mc_fastion -->
<g id="proc~~npa_f~~CallsGraph_node2" class="node"><title>proc~mc_fastion</title>
<g id="a_proc~~npa_f~~CallsGraph_node2"><a xlink:href="../proc/mc_fastion.html" xlink:title="mc_fastion">
<polygon fill="#d9534f" stroke="#d9534f" points="306,-749 242,-749 242,-725 306,-725 306,-749"/>
<text text-anchor="middle" x="274" y="-734.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_fastion</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~mc_fastion -->
<g id="proc~~npa_f~~CallsGraph_edge77" class="edge"><title>proc~npa_f&#45;&gt;proc~mc_fastion</title>
<path fill="none" stroke="#000000" d="M31.3416,-400.053C39.0297,-426.584 59.6708,-491.455 90,-539 137.275,-613.11 213.67,-685.041 251.02,-718.108"/>
<polygon fill="#000000" stroke="#000000" points="248.97,-720.964 258.795,-724.928 253.586,-715.702 248.97,-720.964"/>
</g>
<!-- proc~attenuate -->
<g id="proc~~npa_f~~CallsGraph_node3" class="node"><title>proc~attenuate</title>
<g id="a_proc~~npa_f~~CallsGraph_node3"><a xlink:href="../proc/attenuate.html" xlink:title="attenuate">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-400 245,-400 245,-376 303,-376 303,-400"/>
<text text-anchor="middle" x="274" y="-385.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">attenuate</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~attenuate -->
<g id="proc~~npa_f~~CallsGraph_edge78" class="edge"><title>proc~npa_f&#45;&gt;proc~attenuate</title>
<path fill="none" stroke="#000000" d="M54.2193,-388C97.552,-388 184.306,-388 234.572,-388"/>
<polygon fill="#000000" stroke="#000000" points="234.716,-391.5 244.716,-388 234.716,-384.5 234.716,-391.5"/>
</g>
<!-- proc~store_npa -->
<g id="proc~~npa_f~~CallsGraph_node4" class="node"><title>proc~store_npa</title>
<g id="a_proc~~npa_f~~CallsGraph_node4"><a xlink:href="../proc/store_npa.html" xlink:title="store_npa">
<polygon fill="#d9534f" stroke="#d9534f" points="304.5,-458 243.5,-458 243.5,-434 304.5,-434 304.5,-458"/>
<text text-anchor="middle" x="274" y="-443.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">store_npa</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~store_npa -->
<g id="proc~~npa_f~~CallsGraph_edge79" class="edge"><title>proc~npa_f&#45;&gt;proc~store_npa</title>
<path fill="none" stroke="#000000" d="M54.2193,-394.207C97.1807,-404.377 182.822,-424.652 233.272,-436.595"/>
<polygon fill="#000000" stroke="#000000" points="232.635,-440.041 243.173,-438.939 234.248,-433.229 232.635,-440.041"/>
</g>
<!-- proc~get_nlaunch -->
<g id="proc~~npa_f~~CallsGraph_node5" class="node"><title>proc~get_nlaunch</title>
<g id="a_proc~~npa_f~~CallsGraph_node5"><a xlink:href="../proc/get_nlaunch.html" xlink:title="get_nlaunch">
<polygon fill="#d9534f" stroke="#d9534f" points="178,-263 107,-263 107,-239 178,-239 178,-263"/>
<text text-anchor="middle" x="142.5" y="-248.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_nlaunch</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~get_nlaunch -->
<g id="proc~~npa_f~~CallsGraph_edge80" class="edge"><title>proc~npa_f&#45;&gt;proc~get_nlaunch</title>
<path fill="none" stroke="#000000" d="M37.2291,-375.773C49.1496,-360.09 70.6671,-332.151 90,-309 100.835,-296.025 113.427,-281.829 123.448,-270.729"/>
<polygon fill="#000000" stroke="#000000" points="126.101,-273.013 130.228,-263.255 120.917,-268.31 126.101,-273.013"/>
</g>
<!-- proc~get_plasma -->
<g id="proc~~npa_f~~CallsGraph_node6" class="node"><title>proc~get_plasma</title>
<g id="a_proc~~npa_f~~CallsGraph_node6"><a xlink:href="../proc/get_plasma.html" xlink:title="get_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="430.5,-668 362.5,-668 362.5,-644 430.5,-644 430.5,-668"/>
<text text-anchor="middle" x="396.5" y="-653.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_plasma</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~get_plasma -->
<g id="proc~~npa_f~~CallsGraph_edge81" class="edge"><title>proc~npa_f&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M44.7457,-400.212C103.457,-443.027 300.192,-586.497 370.367,-637.672"/>
<polygon fill="#000000" stroke="#000000" points="368.514,-640.652 378.656,-643.716 372.638,-634.996 368.514,-640.652"/>
</g>
<!-- proc~hit_npa_detector -->
<g id="proc~~npa_f~~CallsGraph_node7" class="node"><title>proc~hit_npa_detector</title>
<g id="a_proc~~npa_f~~CallsGraph_node7"><a xlink:href="../proc/hit_npa_detector.html" xlink:title="hit_npa_detector">
<polygon fill="#d9534f" stroke="#d9534f" points="189,-202 96,-202 96,-178 189,-178 189,-202"/>
<text text-anchor="middle" x="142.5" y="-187.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hit_npa_detector</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~hit_npa_detector -->
<g id="proc~~npa_f~~CallsGraph_edge82" class="edge"><title>proc~npa_f&#45;&gt;proc~hit_npa_detector</title>
<path fill="none" stroke="#000000" d="M30.4434,-375.823C36.5358,-347.782 54.5254,-277.43 90,-230 96.19,-221.724 104.514,-214.264 112.663,-208.09"/>
<polygon fill="#000000" stroke="#000000" points="114.89,-210.801 120.995,-202.142 110.823,-205.104 114.89,-210.801"/>
</g>
<!-- proc~get_beam_cx_prob -->
<g id="proc~~npa_f~~CallsGraph_node8" class="node"><title>proc~get_beam_cx_prob</title>
<g id="a_proc~~npa_f~~CallsGraph_node8"><a xlink:href="../proc/get_beam_cx_prob.html" xlink:title="get_beam_cx_prob">
<polygon fill="#d9534f" stroke="#d9534f" points="195,-342 90,-342 90,-318 195,-318 195,-342"/>
<text text-anchor="middle" x="142.5" y="-327.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_beam_cx_prob</text>
</a>
</g>
</g>
<!-- proc~npa_f&#45;&gt;proc~get_beam_cx_prob -->
<g id="proc~~npa_f~~CallsGraph_edge83" class="edge"><title>proc~npa_f&#45;&gt;proc~get_beam_cx_prob</title>
<path fill="none" stroke="#000000" d="M51.5173,-375.982C68.1052,-367.506 90.542,-356.04 108.861,-346.679"/>
<polygon fill="#000000" stroke="#000000" points="110.701,-349.669 118.013,-342.002 107.515,-343.436 110.701,-349.669"/>
</g>
<!-- proc~pitch_to_vec -->
<g id="proc~~npa_f~~CallsGraph_node9" class="node"><title>proc~pitch_to_vec</title>
<g id="a_proc~~npa_f~~CallsGraph_node9"><a xlink:href="../proc/pitch_to_vec.html" xlink:title="pitch_to_vec">
<polygon fill="#d9534f" stroke="#d9534f" points="433,-875 360,-875 360,-851 433,-851 433,-875"/>
<text text-anchor="middle" x="396.5" y="-860.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pitch_to_vec</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;proc~pitch_to_vec -->
<g id="proc~~npa_f~~CallsGraph_edge29" class="edge"><title>proc~mc_fastion&#45;&gt;proc~pitch_to_vec</title>
<path fill="none" stroke="#000000" d="M281.46,-749.161C293.237,-770.375 320.047,-814.502 353,-842 354.517,-843.266 356.122,-844.478 357.787,-845.637"/>
<polygon fill="#000000" stroke="#000000" points="356.114,-848.717 366.465,-850.976 359.782,-842.755 356.114,-848.717"/>
</g>
<!-- proc~gyro_correction -->
<g id="proc~~npa_f~~CallsGraph_node10" class="node"><title>proc~gyro_correction</title>
<g id="a_proc~~npa_f~~CallsGraph_node10"><a xlink:href="../proc/gyro_correction.html" xlink:title="gyro_correction">
<polygon fill="#d9534f" stroke="#d9534f" points="440,-833 353,-833 353,-809 440,-809 440,-833"/>
<text text-anchor="middle" x="396.5" y="-818.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gyro_correction</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;proc~gyro_correction -->
<g id="proc~~npa_f~~CallsGraph_edge30" class="edge"><title>proc~mc_fastion&#45;&gt;proc~gyro_correction</title>
<path fill="none" stroke="#000000" d="M288.118,-749.11C303.089,-762.561 328.66,-784.427 353,-800 355.262,-801.447 357.637,-802.866 360.061,-804.241"/>
<polygon fill="#000000" stroke="#000000" points="358.463,-807.356 368.93,-808.998 361.772,-801.188 358.463,-807.356"/>
</g>
<!-- proc~get_fields -->
<g id="proc~~npa_f~~CallsGraph_node11" class="node"><title>proc~get_fields</title>
<g id="a_proc~~npa_f~~CallsGraph_node11"><a xlink:href="../proc/get_fields.html" xlink:title="get_fields">
<polygon fill="#d9534f" stroke="#d9534f" points="425.5,-609 367.5,-609 367.5,-585 425.5,-585 425.5,-609"/>
<text text-anchor="middle" x="396.5" y="-594.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_fields</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;proc~get_fields -->
<g id="proc~~npa_f~~CallsGraph_edge31" class="edge"><title>proc~mc_fastion&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M283.205,-724.797C296.722,-705.052 324.978,-665.259 353,-635 359.187,-628.319 366.416,-621.532 373.139,-615.579"/>
<polygon fill="#000000" stroke="#000000" points="375.436,-618.22 380.706,-609.029 370.855,-612.927 375.436,-618.22"/>
</g>
<!-- proc~get_distribution -->
<g id="proc~~npa_f~~CallsGraph_node12" class="node"><title>proc~get_distribution</title>
<g id="a_proc~~npa_f~~CallsGraph_node12"><a xlink:href="../proc/get_distribution.html" xlink:title="get_distribution">
<polygon fill="#d9534f" stroke="#d9534f" points="439,-749 354,-749 354,-725 439,-725 439,-749"/>
<text text-anchor="middle" x="396.5" y="-734.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_distribution</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;proc~get_distribution -->
<g id="proc~~npa_f~~CallsGraph_edge32" class="edge"><title>proc~mc_fastion&#45;&gt;proc~get_distribution</title>
<path fill="none" stroke="#000000" d="M306.032,-737C317.477,-737 330.778,-737 343.568,-737"/>
<polygon fill="#000000" stroke="#000000" points="343.672,-740.5 353.672,-737 343.672,-733.5 343.672,-740.5"/>
</g>
<!-- interface~randind -->
<g id="proc~~npa_f~~CallsGraph_node13" class="node"><title>interface~randind</title>
<g id="a_proc~~npa_f~~CallsGraph_node13"><a xlink:href="../interface/randind.html" xlink:title="randind">
<polygon fill="#a7506f" stroke="#a7506f" points="423.5,-791 369.5,-791 369.5,-767 423.5,-767 423.5,-791"/>
<text text-anchor="middle" x="396.5" y="-776.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randind</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;interface~randind -->
<g id="proc~~npa_f~~CallsGraph_edge33" class="edge"><title>proc~mc_fastion&#45;&gt;interface~randind</title>
<path fill="none" stroke="#000000" d="M306.032,-747.816C322.47,-753.546 342.737,-760.61 359.823,-766.565"/>
<polygon fill="#000000" stroke="#000000" points="358.867,-769.938 369.462,-769.925 361.171,-763.328 358.867,-769.938"/>
</g>
<!-- proc~randu -->
<g id="proc~~npa_f~~CallsGraph_node14" class="node"><title>proc~randu</title>
<g id="a_proc~~npa_f~~CallsGraph_node14"><a xlink:href="../proc/randu.html" xlink:title="randu">
<polygon fill="#d9534f" stroke="#d9534f" points="423.5,-238 369.5,-238 369.5,-214 423.5,-214 423.5,-238"/>
<text text-anchor="middle" x="396.5" y="-223.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randu</text>
</a>
</g>
</g>
<!-- proc~mc_fastion&#45;&gt;proc~randu -->
<g id="proc~~npa_f~~CallsGraph_edge34" class="edge"><title>proc~mc_fastion&#45;&gt;proc~randu</title>
<path fill="none" stroke="#000000" d="M276.879,-724.954C288.592,-649.903 351.148,-249.514 353,-247 355.114,-244.13 357.729,-241.63 360.616,-239.457"/>
<polygon fill="#000000" stroke="#000000" points="362.57,-242.364 369.277,-234.163 358.919,-236.392 362.57,-242.364"/>
</g>
<!-- proc~attenuate&#45;&gt;proc~get_plasma -->
<g id="proc~~npa_f~~CallsGraph_edge55" class="edge"><title>proc~attenuate&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M293.95,-400.3C302.288,-406.682 311.433,-415.198 317,-425 360.092,-500.874 310.188,-541.967 353,-618 357.097,-625.277 363.111,-631.885 369.332,-637.475"/>
<polygon fill="#000000" stroke="#000000" points="367.26,-640.303 377.194,-643.984 371.723,-634.911 367.26,-640.303"/>
</g>
<!-- proc~normp -->
<g id="proc~~npa_f~~CallsGraph_node16" class="node"><title>proc~normp</title>
<g id="a_proc~~npa_f~~CallsGraph_node16"><a xlink:href="../proc/normp.html" xlink:title="normp">
<polygon fill="#d94e8f" stroke="#d94e8f" points="692,-437 638,-437 638,-413 692,-413 692,-437"/>
<text text-anchor="middle" x="665" y="-422.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">normp</text>
</a>
</g>
</g>
<!-- proc~attenuate&#45;&gt;proc~normp -->
<g id="proc~~npa_f~~CallsGraph_edge53" class="edge"><title>proc~attenuate&#45;&gt;proc~normp</title>
<path fill="none" stroke="#000000" d="M303.289,-390.691C372.586,-397.282 550.762,-414.229 627.713,-421.549"/>
<polygon fill="#000000" stroke="#000000" points="627.591,-425.053 637.878,-422.515 628.254,-418.084 627.591,-425.053"/>
</g>
<!-- proc~colrad -->
<g id="proc~~npa_f~~CallsGraph_node32" class="node"><title>proc~colrad</title>
<g id="a_proc~~npa_f~~CallsGraph_node32"><a xlink:href="../proc/colrad.html" xlink:title="colrad">
<polygon fill="#d9534f" stroke="#d9534f" points="423.5,-280 369.5,-280 369.5,-256 423.5,-256 423.5,-280"/>
<text text-anchor="middle" x="396.5" y="-265.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">colrad</text>
</a>
</g>
</g>
<!-- proc~attenuate&#45;&gt;proc~colrad -->
<g id="proc~~npa_f~~CallsGraph_edge54" class="edge"><title>proc~attenuate&#45;&gt;proc~colrad</title>
<path fill="none" stroke="#000000" d="M287.442,-375.61C308.477,-354.662 351.21,-312.106 376.173,-287.247"/>
<polygon fill="#000000" stroke="#000000" points="378.689,-289.68 383.305,-280.144 373.75,-284.72 378.689,-289.68"/>
</g>
<!-- proc~store_npa&#45;&gt;proc~get_fields -->
<g id="proc~~npa_f~~CallsGraph_edge57" class="edge"><title>proc~store_npa&#45;&gt;proc~get_fields</title>
<path fill="none" stroke="#000000" d="M284.657,-458.102C305.281,-483.945 353.816,-544.765 379.271,-576.664"/>
<polygon fill="#000000" stroke="#000000" points="376.823,-579.208 385.797,-584.841 382.295,-574.841 376.823,-579.208"/>
</g>
<!-- proc~store_npa&#45;&gt;proc~normp -->
<g id="proc~~npa_f~~CallsGraph_edge56" class="edge"><title>proc~store_npa&#45;&gt;proc~normp</title>
<path fill="none" stroke="#000000" d="M304.558,-444.404C374.748,-440.615 551.286,-431.085 627.752,-426.957"/>
<polygon fill="#000000" stroke="#000000" points="628.059,-430.445 637.856,-426.411 627.682,-423.456 628.059,-430.445"/>
</g>
<!-- proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_node18" class="node"><title>proc~xyz_to_uvw</title>
<g id="a_proc~~npa_f~~CallsGraph_node18"><a xlink:href="../proc/xyz_to_uvw.html" xlink:title="xyz_to_uvw">
<polygon fill="#d9534f" stroke="#d9534f" points="699,-666 631,-666 631,-642 699,-642 699,-666"/>
<text text-anchor="middle" x="665" y="-651.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xyz_to_uvw</text>
</a>
</g>
</g>
<!-- proc~store_npa&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge58" class="edge"><title>proc~store_npa&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M304.678,-447.532C379.437,-451.632 571.175,-463.728 594,-481 642.676,-517.835 657.62,-594.153 662.117,-631.888"/>
<polygon fill="#000000" stroke="#000000" points="658.639,-632.281 663.166,-641.86 665.601,-631.549 658.639,-632.281"/>
</g>
<!-- proc~get_nlaunch&#45;&gt;proc~randu -->
<g id="proc~~npa_f~~CallsGraph_edge59" class="edge"><title>proc~get_nlaunch&#45;&gt;proc~randu</title>
<path fill="none" stroke="#000000" d="M178.011,-247.576C225.607,-242.854 310.992,-234.384 359.408,-229.581"/>
<polygon fill="#000000" stroke="#000000" points="359.834,-233.056 369.439,-228.585 359.143,-226.09 359.834,-233.056"/>
</g>
<!-- proc~get_position -->
<g id="proc~~npa_f~~CallsGraph_node17" class="node"><title>proc~get_position</title>
<g id="a_proc~~npa_f~~CallsGraph_node17"><a xlink:href="../proc/get_position.html" xlink:title="get_position">
<polygon fill="#d9534f" stroke="#d9534f" points="570,-788 500,-788 500,-764 570,-764 570,-788"/>
<text text-anchor="middle" x="535" y="-773.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_position</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~get_position -->
<g id="proc~~npa_f~~CallsGraph_edge60" class="edge"><title>proc~get_plasma&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M405.03,-668.2C417.612,-687.737 444.644,-726.251 476,-750 480.508,-753.415 485.536,-756.504 490.695,-759.262"/>
<polygon fill="#000000" stroke="#000000" points="489.52,-762.585 500.037,-763.866 492.614,-756.306 489.52,-762.585"/>
</g>
<!-- proc~get_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge63" class="edge"><title>proc~get_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M430.714,-655.751C478.721,-655.39 567.554,-654.724 620.664,-654.325"/>
<polygon fill="#000000" stroke="#000000" points="620.814,-657.824 630.787,-654.249 620.761,-650.824 620.814,-657.824"/>
</g>
<!-- proc~in_plasma -->
<g id="proc~~npa_f~~CallsGraph_node19" class="node"><title>proc~in_plasma</title>
<g id="a_proc~~npa_f~~CallsGraph_node19"><a xlink:href="../proc/in_plasma.html" xlink:title="in_plasma">
<polygon fill="#d9534f" stroke="#d9534f" points="565.5,-708 504.5,-708 504.5,-684 565.5,-684 565.5,-708"/>
<text text-anchor="middle" x="535" y="-693.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_plasma</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;proc~in_plasma -->
<g id="proc~~npa_f~~CallsGraph_edge62" class="edge"><title>proc~get_plasma&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M430.543,-665.683C449.712,-671.3 473.984,-678.413 494.2,-684.337"/>
<polygon fill="#000000" stroke="#000000" points="493.474,-687.771 504.055,-687.225 495.443,-681.054 493.474,-687.771"/>
</g>
<!-- interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_node21" class="node"><title>interface~interpol_coeff</title>
<g id="a_proc~~npa_f~~CallsGraph_node21"><a xlink:href="../interface/interpol_coeff.html" xlink:title="interpol_coeff">
<polygon fill="#a7506f" stroke="#a7506f" points="949,-624 872,-624 872,-600 949,-600 949,-624"/>
<text text-anchor="middle" x="910.5" y="-609.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol_coeff</text>
</a>
</g>
</g>
<!-- proc~get_plasma&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_edge61" class="edge"><title>proc~get_plasma&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M407.997,-668.025C421.836,-682.863 447.755,-707.316 476,-717 627.351,-768.892 694.083,-790.89 836,-717 869.479,-699.569 890.861,-659.137 901.479,-633.839"/>
<polygon fill="#000000" stroke="#000000" points="904.812,-634.929 905.258,-624.344 898.308,-632.341 904.812,-634.929"/>
</g>
<!-- proc~in_boundary -->
<g id="proc~~npa_f~~CallsGraph_node48" class="node"><title>proc~in_boundary</title>
<g id="a_proc~~npa_f~~CallsGraph_node48"><a xlink:href="../proc/in_boundary.html" xlink:title="in_boundary">
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-202 238,-202 238,-178 310,-178 310,-202"/>
<text text-anchor="middle" x="274" y="-187.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">in_boundary</text>
</a>
</g>
</g>
<!-- proc~hit_npa_detector&#45;&gt;proc~in_boundary -->
<g id="proc~~npa_f~~CallsGraph_edge64" class="edge"><title>proc~hit_npa_detector&#45;&gt;proc~in_boundary</title>
<path fill="none" stroke="#000000" d="M189.157,-190C201.673,-190 215.234,-190 227.728,-190"/>
<polygon fill="#000000" stroke="#000000" points="227.926,-193.5 237.926,-190 227.926,-186.5 227.926,-193.5"/>
</g>
<!-- proc~plane_intercept -->
<g id="proc~~npa_f~~CallsGraph_node49" class="node"><title>proc~plane_intercept</title>
<g id="a_proc~~npa_f~~CallsGraph_node49"><a xlink:href="../proc/plane_intercept.html" xlink:title="plane_intercept">
<polygon fill="#d9534f" stroke="#d9534f" points="317,-160 231,-160 231,-136 317,-136 317,-160"/>
<text text-anchor="middle" x="274" y="-145.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">plane_intercept</text>
</a>
</g>
</g>
<!-- proc~hit_npa_detector&#45;&gt;proc~plane_intercept -->
<g id="proc~~npa_f~~CallsGraph_edge65" class="edge"><title>proc~hit_npa_detector&#45;&gt;proc~plane_intercept</title>
<path fill="none" stroke="#000000" d="M180.61,-177.964C194.834,-173.351 211.248,-168.028 226.26,-163.159"/>
<polygon fill="#000000" stroke="#000000" points="227.453,-166.452 235.885,-160.037 225.293,-159.793 227.453,-166.452"/>
</g>
<!-- proc~get_beam_cx_prob&#45;&gt;proc~normp -->
<g id="proc~~npa_f~~CallsGraph_edge74" class="edge"><title>proc~get_beam_cx_prob&#45;&gt;proc~normp</title>
<path fill="none" stroke="#000000" d="M195.322,-335.935C279.618,-346.137 451.367,-369.215 594,-403 605.294,-405.675 617.415,-409.233 628.344,-412.706"/>
<polygon fill="#000000" stroke="#000000" points="627.396,-416.078 637.988,-415.844 629.562,-409.421 627.396,-416.078"/>
</g>
<!-- proc~neut_rates -->
<g id="proc~~npa_f~~CallsGraph_node50" class="node"><title>proc~neut_rates</title>
<g id="a_proc~~npa_f~~CallsGraph_node50"><a xlink:href="../proc/neut_rates.html" xlink:title="neut_rates">
<polygon fill="#d9534f" stroke="#d9534f" points="567,-320 503,-320 503,-296 567,-296 567,-320"/>
<text text-anchor="middle" x="535" y="-305.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">neut_rates</text>
</a>
</g>
</g>
<!-- proc~get_beam_cx_prob&#45;&gt;proc~neut_rates -->
<g id="proc~~npa_f~~CallsGraph_edge75" class="edge"><title>proc~get_beam_cx_prob&#45;&gt;proc~neut_rates</title>
<path fill="none" stroke="#000000" d="M195.355,-327.079C273.859,-322.656 421.291,-314.35 492.891,-310.316"/>
<polygon fill="#000000" stroke="#000000" points="493.1,-313.81 502.887,-309.753 492.706,-306.821 493.1,-313.81"/>
</g>
<!-- proc~mc_halo -->
<g id="proc~~npa_f~~CallsGraph_node51" class="node"><title>proc~mc_halo</title>
<g id="a_proc~~npa_f~~CallsGraph_node51"><a xlink:href="../proc/mc_halo.html" xlink:title="mc_halo">
<polygon fill="#d9534f" stroke="#d9534f" points="301,-282 247,-282 247,-258 301,-258 301,-282"/>
<text text-anchor="middle" x="274" y="-267.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mc_halo</text>
</a>
</g>
</g>
<!-- proc~get_beam_cx_prob&#45;&gt;proc~mc_halo -->
<g id="proc~~npa_f~~CallsGraph_edge76" class="edge"><title>proc~get_beam_cx_prob&#45;&gt;proc~mc_halo</title>
<path fill="none" stroke="#000000" d="M169.706,-317.858C189.278,-308.79 216.236,-296.3 237.704,-286.353"/>
<polygon fill="#000000" stroke="#000000" points="239.231,-289.504 246.833,-282.124 236.288,-283.152 239.231,-289.504"/>
</g>
<!-- proc~cross_product -->
<g id="proc~~npa_f~~CallsGraph_node15" class="node"><title>proc~cross_product</title>
<g id="a_proc~~npa_f~~CallsGraph_node15"><a xlink:href="../proc/cross_product.html" xlink:title="cross_product">
<polygon fill="#d94e8f" stroke="#d94e8f" points="575,-906 495,-906 495,-882 575,-882 575,-906"/>
<text text-anchor="middle" x="535" y="-891.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cross_product</text>
</a>
</g>
</g>
<!-- proc~gyro_correction&#45;&gt;proc~cross_product -->
<g id="proc~~npa_f~~CallsGraph_edge1" class="edge"><title>proc~gyro_correction&#45;&gt;proc~cross_product</title>
<path fill="none" stroke="#000000" d="M423.939,-833.212C429.342,-835.943 434.924,-838.942 440,-842 456.906,-852.185 458.906,-858.134 476,-868 481.908,-871.41 488.344,-874.688 494.709,-877.701"/>
<polygon fill="#000000" stroke="#000000" points="493.364,-880.934 503.914,-881.908 496.274,-874.568 493.364,-880.934"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~normp -->
<g id="proc~~npa_f~~CallsGraph_edge17" class="edge"><title>proc~get_fields&#45;&gt;proc~normp</title>
<path fill="none" stroke="#000000" d="M425.771,-585.625C440.676,-579.682 459.287,-572.344 476,-566 528.185,-546.192 549.564,-556.78 594,-523 621.136,-502.371 642.099,-468.271 653.746,-446.225"/>
<polygon fill="#000000" stroke="#000000" points="657.007,-447.534 658.431,-437.035 650.771,-444.355 657.007,-447.534"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~get_position -->
<g id="proc~~npa_f~~CallsGraph_edge18" class="edge"><title>proc~get_fields&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M414.416,-609.3C422.926,-616.136 432.911,-625.225 440,-635 463.368,-667.22 453.682,-684.044 476,-717 485.947,-731.688 499.795,-745.935 511.465,-756.749"/>
<polygon fill="#000000" stroke="#000000" points="509.351,-759.555 519.122,-763.65 514.037,-754.355 509.351,-759.555"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge19" class="edge"><title>proc~get_fields&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M425.516,-602.992C472.191,-612.975 566.161,-633.074 621.182,-644.842"/>
<polygon fill="#000000" stroke="#000000" points="620.471,-648.269 630.982,-646.938 621.936,-641.424 620.471,-648.269"/>
</g>
<!-- proc~get_fields&#45;&gt;proc~in_plasma -->
<g id="proc~~npa_f~~CallsGraph_edge20" class="edge"><title>proc~get_fields&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M414.238,-609.139C437.877,-626.285 481.229,-657.727 508.78,-677.709"/>
<polygon fill="#000000" stroke="#000000" points="506.976,-680.723 517.126,-683.761 511.085,-675.057 506.976,-680.723"/>
</g>
<!-- proc~calc_perp_vectors -->
<g id="proc~~npa_f~~CallsGraph_node20" class="node"><title>proc~calc_perp_vectors</title>
<g id="a_proc~~npa_f~~CallsGraph_node20"><a xlink:href="../proc/calc_perp_vectors.html" xlink:title="calc_perp_vectors">
<polygon fill="#d9534f" stroke="#d9534f" points="585,-514 485,-514 485,-490 585,-490 585,-514"/>
<text text-anchor="middle" x="535" y="-499.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_perp_vectors</text>
</a>
</g>
</g>
<!-- proc~get_fields&#45;&gt;proc~calc_perp_vectors -->
<g id="proc~~npa_f~~CallsGraph_edge21" class="edge"><title>proc~get_fields&#45;&gt;proc~calc_perp_vectors</title>
<path fill="none" stroke="#000000" d="M409.083,-584.779C423.642,-569.927 449.899,-544.776 476,-528 481.361,-524.554 487.255,-521.34 493.168,-518.428"/>
<polygon fill="#000000" stroke="#000000" points="494.826,-521.517 502.403,-514.112 491.862,-515.176 494.826,-521.517"/>
</g>
<!-- proc~get_fields&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_edge22" class="edge"><title>proc~get_fields&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M425.645,-593.663C495.519,-586.018 682.373,-569.484 836,-591 845.559,-592.339 855.62,-594.612 865.125,-597.181"/>
<polygon fill="#000000" stroke="#000000" points="864.209,-600.559 874.785,-599.938 866.13,-593.828 864.209,-600.559"/>
</g>
<!-- proc~get_distribution&#45;&gt;proc~get_position -->
<g id="proc~~npa_f~~CallsGraph_edge23" class="edge"><title>proc~get_distribution&#45;&gt;proc~get_position</title>
<path fill="none" stroke="#000000" d="M439.196,-748.913C455.298,-753.514 473.736,-758.782 490.046,-763.442"/>
<polygon fill="#000000" stroke="#000000" points="489.309,-766.871 499.885,-766.253 491.232,-760.14 489.309,-766.871"/>
</g>
<!-- proc~get_distribution&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge26" class="edge"><title>proc~get_distribution&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M425.794,-749.156C430.718,-751.775 435.65,-754.747 440,-758 458.89,-772.128 454.391,-787.539 476,-797 524.042,-818.034 551.995,-828.401 594,-797 639.28,-763.151 595.687,-719.929 630,-675 630.571,-674.252 631.177,-673.525 631.813,-672.817"/>
<polygon fill="#000000" stroke="#000000" points="634.339,-675.256 639.515,-666.012 629.704,-670.011 634.339,-675.256"/>
</g>
<!-- proc~get_distribution&#45;&gt;proc~in_plasma -->
<g id="proc~~npa_f~~CallsGraph_edge25" class="edge"><title>proc~get_distribution&#45;&gt;proc~in_plasma</title>
<path fill="none" stroke="#000000" d="M437.716,-724.92C455.681,-719.524 476.782,-713.186 494.644,-707.821"/>
<polygon fill="#000000" stroke="#000000" points="495.895,-711.1 504.466,-704.871 493.881,-704.396 495.895,-711.1"/>
</g>
<!-- interface~interpol -->
<g id="proc~~npa_f~~CallsGraph_node22" class="node"><title>interface~interpol</title>
<g id="a_proc~~npa_f~~CallsGraph_node22"><a xlink:href="../interface/interpol.html" xlink:title="interpol">
<polygon fill="#a7506f" stroke="#a7506f" points="692,-708 638,-708 638,-684 692,-684 692,-708"/>
<text text-anchor="middle" x="665" y="-693.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol</text>
</a>
</g>
</g>
<!-- proc~get_distribution&#45;&gt;interface~interpol -->
<g id="proc~~npa_f~~CallsGraph_edge24" class="edge"><title>proc~get_distribution&#45;&gt;interface~interpol</title>
<path fill="none" stroke="#000000" d="M428.372,-749.211C432.585,-751.713 436.617,-754.633 440,-758 465.358,-783.238 445.566,-811.191 476,-830 520.612,-857.572 549.145,-857.175 594,-830 634.363,-805.547 652.558,-749.342 659.815,-718.049"/>
<polygon fill="#000000" stroke="#000000" points="663.271,-718.624 661.943,-708.112 656.426,-717.157 663.271,-718.624"/>
</g>
<!-- omp_get_thread_num -->
<g id="proc~~npa_f~~CallsGraph_node30" class="node"><title>omp_get_thread_num</title>
<polygon fill="#777777" stroke="#777777" points="594,-92 476,-92 476,-68 594,-68 594,-92"/>
<text text-anchor="middle" x="535" y="-77.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">omp_get_thread_num</text>
</g>
<!-- proc~randu&#45;&gt;omp_get_thread_num -->
<g id="proc~~npa_f~~CallsGraph_edge27" class="edge"><title>proc~randu&#45;&gt;omp_get_thread_num</title>
<path fill="none" stroke="#000000" d="M402.618,-213.81C413.124,-190.099 439.263,-137.351 476,-106 479.99,-102.595 484.497,-99.5585 489.193,-96.8705"/>
<polygon fill="#000000" stroke="#000000" points="491.093,-99.8283 498.368,-92.126 487.878,-93.6104 491.093,-99.8283"/>
</g>
<!-- proc~rng_uniform -->
<g id="proc~~npa_f~~CallsGraph_node31" class="node"><title>proc~rng_uniform</title>
<g id="a_proc~~npa_f~~CallsGraph_node31"><a xlink:href="../proc/rng_uniform.html" xlink:title="rng_uniform">
<polygon fill="#d94e8f" stroke="#d94e8f" points="700,-24 630,-24 630,-0 700,-0 700,-24"/>
<text text-anchor="middle" x="665" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rng_uniform</text>
</a>
</g>
</g>
<!-- proc~randu&#45;&gt;proc~rng_uniform -->
<g id="proc~~npa_f~~CallsGraph_edge28" class="edge"><title>proc~randu&#45;&gt;proc~rng_uniform</title>
<path fill="none" stroke="#000000" d="M405.383,-213.744C418.058,-194.988 444.74,-159.219 476,-139 522.263,-109.077 551.779,-136.398 594,-101 620.205,-79.0298 606.636,-57.9697 630,-33 630.88,-32.0596 631.811,-31.1452 632.781,-30.2579"/>
<polygon fill="#000000" stroke="#000000" points="635.058,-32.9208 640.785,-24.007 630.749,-27.4041 635.058,-32.9208"/>
</g>
<!-- proc~in_plasma&#45;&gt;proc~xyz_to_uvw -->
<g id="proc~~npa_f~~CallsGraph_edge9" class="edge"><title>proc~in_plasma&#45;&gt;proc~xyz_to_uvw</title>
<path fill="none" stroke="#000000" d="M565.688,-686.259C582.214,-680.836 603.075,-673.991 621.324,-668.003"/>
<polygon fill="#000000" stroke="#000000" points="622.46,-671.314 630.87,-664.871 620.278,-664.663 622.46,-671.314"/>
</g>
<!-- proc~in_plasma&#45;&gt;interface~interpol -->
<g id="proc~~npa_f~~CallsGraph_edge8" class="edge"><title>proc~in_plasma&#45;&gt;interface~interpol</title>
<path fill="none" stroke="#000000" d="M565.688,-696C584.218,-696 608.196,-696 627.833,-696"/>
<polygon fill="#000000" stroke="#000000" points="627.943,-699.5 637.943,-696 627.943,-692.5 627.943,-699.5"/>
</g>
<!-- proc~calc_perp_vectors&#45;&gt;proc~normp -->
<g id="proc~~npa_f~~CallsGraph_edge10" class="edge"><title>proc~calc_perp_vectors&#45;&gt;proc~normp</title>
<path fill="none" stroke="#000000" d="M556,-489.969C577.198,-477.217 610.878,-456.956 634.991,-442.451"/>
<polygon fill="#000000" stroke="#000000" points="636.953,-445.355 643.718,-437.201 633.345,-439.357 636.953,-445.355"/>
</g>
<!-- proc~interpol1d_coeff_arr -->
<g id="proc~~npa_f~~CallsGraph_node26" class="node"><title>proc~interpol1d_coeff_arr</title>
<g id="a_proc~~npa_f~~CallsGraph_node26"><a xlink:href="../proc/interpol1d_coeff_arr.html" xlink:title="interpol1D_coeff_arr">
<polygon fill="#d9534f" stroke="#d9534f" points="1095,-644 985,-644 985,-620 1095,-620 1095,-644"/>
<text text-anchor="middle" x="1040" y="-629.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol1D_coeff_arr</text>
</a>
</g>
</g>
<!-- interface~interpol_coeff&#45;&gt;proc~interpol1d_coeff_arr -->
<g id="proc~~npa_f~~CallsGraph_edge13" class="edge"><title>interface~interpol_coeff&#45;&gt;proc~interpol1d_coeff_arr</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M949.065,-617.892C957.177,-619.165 965.974,-620.545 974.783,-621.927"/>
<polygon fill="#000000" stroke="#000000" points="974.276,-625.39 984.697,-623.482 975.361,-618.474 974.276,-625.39"/>
</g>
<!-- proc~interpol2d_coeff -->
<g id="proc~~npa_f~~CallsGraph_node27" class="node"><title>proc~interpol2d_coeff</title>
<g id="a_proc~~npa_f~~CallsGraph_node27"><a xlink:href="../proc/interpol2d_coeff.html" xlink:title="interpol2D_coeff">
<polygon fill="#d9534f" stroke="#d9534f" points="1222,-593 1131,-593 1131,-569 1222,-569 1222,-593"/>
<text text-anchor="middle" x="1176.5" y="-578.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol2D_coeff</text>
</a>
</g>
</g>
<!-- interface~interpol_coeff&#45;&gt;proc~interpol2d_coeff -->
<g id="proc~~npa_f~~CallsGraph_edge14" class="edge"><title>interface~interpol_coeff&#45;&gt;proc~interpol2d_coeff</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M949.044,-607.591C993.886,-602.326 1069.27,-593.474 1120.64,-587.442"/>
<polygon fill="#000000" stroke="#000000" points="1121.05,-590.918 1130.58,-586.275 1120.24,-583.965 1121.05,-590.918"/>
</g>
<!-- proc~interpol2d_coeff_arr -->
<g id="proc~~npa_f~~CallsGraph_node28" class="node"><title>proc~interpol2d_coeff_arr</title>
<g id="a_proc~~npa_f~~CallsGraph_node28"><a xlink:href="../proc/interpol2d_coeff_arr.html" xlink:title="interpol2D_coeff_arr">
<polygon fill="#d9534f" stroke="#d9534f" points="1095,-564 985,-564 985,-540 1095,-540 1095,-564"/>
<text text-anchor="middle" x="1040" y="-549.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol2D_coeff_arr</text>
</a>
</g>
</g>
<!-- interface~interpol_coeff&#45;&gt;proc~interpol2d_coeff_arr -->
<g id="proc~~npa_f~~CallsGraph_edge15" class="edge"><title>interface~interpol_coeff&#45;&gt;proc~interpol2d_coeff_arr</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M937.302,-599.858C956.484,-590.831 982.875,-578.412 1003.96,-568.487"/>
<polygon fill="#000000" stroke="#000000" points="1005.68,-571.549 1013.24,-564.124 1002.7,-565.215 1005.68,-571.549"/>
</g>
<!-- proc~interpol1d_coeff -->
<g id="proc~~npa_f~~CallsGraph_node29" class="node"><title>proc~interpol1d_coeff</title>
<g id="a_proc~~npa_f~~CallsGraph_node29"><a xlink:href="../proc/interpol1d_coeff.html" xlink:title="interpol1D_coeff">
<polygon fill="#d9534f" stroke="#d9534f" points="1222,-654 1131,-654 1131,-630 1222,-630 1222,-654"/>
<text text-anchor="middle" x="1176.5" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol1D_coeff</text>
</a>
</g>
</g>
<!-- interface~interpol_coeff&#45;&gt;proc~interpol1d_coeff -->
<g id="proc~~npa_f~~CallsGraph_edge16" class="edge"><title>interface~interpol_coeff&#45;&gt;proc~interpol1d_coeff</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M927.393,-624.034C941.624,-634.004 963.505,-647.41 985,-653 1029.74,-664.634 1082.3,-660.318 1120.87,-653.983"/>
<polygon fill="#000000" stroke="#000000" points="1121.6,-657.407 1130.85,-652.246 1120.4,-650.511 1121.6,-657.407"/>
</g>
<!-- proc~interpol2d_arr -->
<g id="proc~~npa_f~~CallsGraph_node23" class="node"><title>proc~interpol2d_arr</title>
<g id="a_proc~~npa_f~~CallsGraph_node23"><a xlink:href="../proc/interpol2d_arr.html" xlink:title="interpol2D_arr">
<polygon fill="#d9534f" stroke="#d9534f" points="826.5,-666 745.5,-666 745.5,-642 826.5,-642 826.5,-666"/>
<text text-anchor="middle" x="786" y="-651.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol2D_arr</text>
</a>
</g>
</g>
<!-- interface~interpol&#45;&gt;proc~interpol2d_arr -->
<g id="proc~~npa_f~~CallsGraph_edge5" class="edge"><title>interface~interpol&#45;&gt;proc~interpol2d_arr</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M692.115,-686.783C706.528,-681.696 724.804,-675.246 741.325,-669.415"/>
<polygon fill="#000000" stroke="#000000" points="742.542,-672.697 750.807,-666.068 740.212,-666.096 742.542,-672.697"/>
</g>
<!-- proc~interpol2d_2d_arr -->
<g id="proc~~npa_f~~CallsGraph_node24" class="node"><title>proc~interpol2d_2d_arr</title>
<g id="a_proc~~npa_f~~CallsGraph_node24"><a xlink:href="../proc/interpol2d_2d_arr.html" xlink:title="interpol2D_2D_arr">
<polygon fill="#d9534f" stroke="#d9534f" points="836,-624 736,-624 736,-600 836,-600 836,-624"/>
<text text-anchor="middle" x="786" y="-609.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol2D_2D_arr</text>
</a>
</g>
</g>
<!-- interface~interpol&#45;&gt;proc~interpol2d_2d_arr -->
<g id="proc~~npa_f~~CallsGraph_edge6" class="edge"><title>interface~interpol&#45;&gt;proc~interpol2d_2d_arr</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M687.92,-683.852C692.096,-681.158 696.31,-678.157 700,-675 718.681,-659.017 716.186,-647.554 736,-633 738.023,-631.514 740.168,-630.107 742.386,-628.779"/>
<polygon fill="#000000" stroke="#000000" points="744.042,-631.862 751.198,-624.049 740.731,-625.694 744.042,-631.862"/>
</g>
<!-- proc~interpol1d_arr -->
<g id="proc~~npa_f~~CallsGraph_node25" class="node"><title>proc~interpol1d_arr</title>
<g id="a_proc~~npa_f~~CallsGraph_node25"><a xlink:href="../proc/interpol1d_arr.html" xlink:title="interpol1D_arr">
<polygon fill="#d9534f" stroke="#d9534f" points="826.5,-708 745.5,-708 745.5,-684 826.5,-684 826.5,-708"/>
<text text-anchor="middle" x="786" y="-693.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpol1D_arr</text>
</a>
</g>
</g>
<!-- interface~interpol&#45;&gt;proc~interpol1d_arr -->
<g id="proc~~npa_f~~CallsGraph_edge7" class="edge"><title>interface~interpol&#45;&gt;proc~interpol1d_arr</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M692.115,-696C704.789,-696 720.452,-696 735.281,-696"/>
<polygon fill="#000000" stroke="#000000" points="735.367,-699.5 745.367,-696 735.367,-692.5 735.367,-699.5"/>
</g>
<!-- proc~interpol2d_arr&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_edge2" class="edge"><title>proc~interpol2d_arr&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M822.104,-641.964C835.431,-637.395 850.791,-632.129 864.88,-627.298"/>
<polygon fill="#000000" stroke="#000000" points="866.067,-630.591 874.391,-624.037 863.797,-623.97 866.067,-630.591"/>
</g>
<!-- proc~interpol2d_2d_arr&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_edge3" class="edge"><title>proc~interpol2d_2d_arr&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M836.12,-612C844.543,-612 853.285,-612 861.674,-612"/>
<polygon fill="#000000" stroke="#000000" points="861.686,-615.5 871.686,-612 861.686,-608.5 861.686,-615.5"/>
</g>
<!-- proc~interpol1d_arr&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_edge4" class="edge"><title>proc~interpol1d_arr&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M819.079,-683.921C824.87,-681.277 830.735,-678.277 836,-675 856.105,-662.486 876.345,-644.661 890.481,-631.164"/>
<polygon fill="#000000" stroke="#000000" points="892.94,-633.654 897.666,-624.171 888.058,-628.637 892.94,-633.654"/>
</g>
<!-- proc~interpol1d_coeff_arr&#45;&gt;proc~interpol1d_coeff -->
<g id="proc~~npa_f~~CallsGraph_edge11" class="edge"><title>proc~interpol1d_coeff_arr&#45;&gt;proc~interpol1d_coeff</title>
<path fill="none" stroke="#000000" d="M1095.32,-636.039C1103.72,-636.663 1112.39,-637.308 1120.8,-637.933"/>
<polygon fill="#000000" stroke="#000000" points="1120.65,-641.431 1130.88,-638.682 1121.17,-634.451 1120.65,-641.431"/>
</g>
<!-- proc~interpol2d_coeff_arr&#45;&gt;proc~interpol2d_coeff -->
<g id="proc~~npa_f~~CallsGraph_edge12" class="edge"><title>proc~interpol2d_coeff_arr&#45;&gt;proc~interpol2d_coeff</title>
<path fill="none" stroke="#000000" d="M1095.32,-563.712C1103.81,-565.542 1112.58,-567.434 1121.07,-569.265"/>
<polygon fill="#000000" stroke="#000000" points="1120.37,-572.693 1130.88,-571.379 1121.84,-565.85 1120.37,-572.693"/>
</g>
<!-- proc~eigen -->
<g id="proc~~npa_f~~CallsGraph_node33" class="node"><title>proc~eigen</title>
<g id="a_proc~~npa_f~~CallsGraph_node33"><a xlink:href="../proc/eigen.html" xlink:title="eigen">
<polygon fill="#d9534f" stroke="#d9534f" points="562,-236 508,-236 508,-212 562,-212 562,-236"/>
<text text-anchor="middle" x="535" y="-221.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eigen</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~eigen -->
<g id="proc~~npa_f~~CallsGraph_edge50" class="edge"><title>proc~colrad&#45;&gt;proc~eigen</title>
<path fill="none" stroke="#000000" d="M423.819,-259.516C444.968,-252.699 474.889,-243.054 498.214,-235.535"/>
<polygon fill="#000000" stroke="#000000" points="499.318,-238.857 507.762,-232.458 497.171,-232.194 499.318,-238.857"/>
</g>
<!-- proc~matinv -->
<g id="proc~~npa_f~~CallsGraph_node34" class="node"><title>proc~matinv</title>
<g id="a_proc~~npa_f~~CallsGraph_node34"><a xlink:href="../proc/matinv.html" xlink:title="matinv">
<polygon fill="#d9534f" stroke="#d9534f" points="562,-172 508,-172 508,-148 562,-148 562,-172"/>
<text text-anchor="middle" x="535" y="-157.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matinv</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~matinv -->
<g id="proc~~npa_f~~CallsGraph_edge51" class="edge"><title>proc~colrad&#45;&gt;proc~matinv</title>
<path fill="none" stroke="#000000" d="M423.727,-257.229C429.371,-254.327 435.105,-250.894 440,-247 459.773,-231.27 457.712,-220.435 476,-203 485.498,-193.945 496.927,-185.105 507.12,-177.819"/>
<polygon fill="#000000" stroke="#000000" points="509.125,-180.687 515.321,-172.093 505.118,-174.948 509.125,-180.687"/>
</g>
<!-- proc~get_rate_matrix -->
<g id="proc~~npa_f~~CallsGraph_node35" class="node"><title>proc~get_rate_matrix</title>
<g id="a_proc~~npa_f~~CallsGraph_node35"><a xlink:href="../proc/get_rate_matrix.html" xlink:title="get_rate_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="830,-357 742,-357 742,-333 830,-333 830,-357"/>
<text text-anchor="middle" x="786" y="-342.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_rate_matrix</text>
</a>
</g>
</g>
<!-- proc~colrad&#45;&gt;proc~get_rate_matrix -->
<g id="proc~~npa_f~~CallsGraph_edge52" class="edge"><title>proc~colrad&#45;&gt;proc~get_rate_matrix</title>
<path fill="none" stroke="#000000" d="M423.628,-264.773C462.901,-261.143 538.459,-258.984 594,-287 615.355,-297.772 608.75,-316.023 630,-327 661.139,-343.085 700.392,-347.509 731.604,-347.951"/>
<polygon fill="#000000" stroke="#000000" points="731.855,-351.451 741.858,-347.959 731.861,-344.451 731.855,-351.451"/>
</g>
<!-- proc~elmhes -->
<g id="proc~~npa_f~~CallsGraph_node36" class="node"><title>proc~elmhes</title>
<g id="a_proc~~npa_f~~CallsGraph_node36"><a xlink:href="../proc/elmhes.html" xlink:title="elmhes">
<polygon fill="#d9534f" stroke="#d9534f" points="692,-276 638,-276 638,-252 692,-252 692,-276"/>
<text text-anchor="middle" x="665" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmhes</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmhes -->
<g id="proc~~npa_f~~CallsGraph_edge40" class="edge"><title>proc~eigen&#45;&gt;proc~elmhes</title>
<path fill="none" stroke="#000000" d="M562.212,-232.191C581.194,-238.123 607.086,-246.214 628.005,-252.752"/>
<polygon fill="#000000" stroke="#000000" points="627.235,-256.178 637.823,-255.82 629.323,-249.496 627.235,-256.178"/>
</g>
<!-- proc~hqr2 -->
<g id="proc~~npa_f~~CallsGraph_node37" class="node"><title>proc~hqr2</title>
<g id="a_proc~~npa_f~~CallsGraph_node37"><a xlink:href="../proc/hqr2.html" xlink:title="hqr2">
<polygon fill="#d9534f" stroke="#d9534f" points="692,-66 638,-66 638,-42 692,-42 692,-66"/>
<text text-anchor="middle" x="665" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqr2</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~hqr2 -->
<g id="proc~~npa_f~~CallsGraph_edge41" class="edge"><title>proc~eigen&#45;&gt;proc~hqr2</title>
<path fill="none" stroke="#000000" d="M558.48,-211.868C570.498,-204.377 584.694,-193.761 594,-181 623.317,-140.801 599.008,-113.922 630,-75 630.586,-74.2639 631.206,-73.5468 631.853,-72.8489"/>
<polygon fill="#000000" stroke="#000000" points="634.37,-75.2991 639.633,-66.1039 629.785,-70.0101 634.37,-75.2991"/>
</g>
<!-- proc~elmtrans -->
<g id="proc~~npa_f~~CallsGraph_node38" class="node"><title>proc~elmtrans</title>
<g id="a_proc~~npa_f~~CallsGraph_node38"><a xlink:href="../proc/elmtrans.html" xlink:title="elmtrans">
<polygon fill="#d9534f" stroke="#d9534f" points="692,-318 638,-318 638,-294 692,-294 692,-318"/>
<text text-anchor="middle" x="665" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elmtrans</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~elmtrans -->
<g id="proc~~npa_f~~CallsGraph_edge42" class="edge"><title>proc~eigen&#45;&gt;proc~elmtrans</title>
<path fill="none" stroke="#000000" d="M562.147,-235.901C572.387,-240.974 584.042,-247.273 594,-254 611.496,-265.82 612.965,-272.525 630,-285 631.424,-286.043 632.9,-287.086 634.405,-288.118"/>
<polygon fill="#000000" stroke="#000000" points="632.877,-291.301 643.161,-293.849 636.711,-285.444 632.877,-291.301"/>
</g>
<!-- proc~balback -->
<g id="proc~~npa_f~~CallsGraph_node39" class="node"><title>proc~balback</title>
<g id="a_proc~~npa_f~~CallsGraph_node39"><a xlink:href="../proc/balback.html" xlink:title="balback">
<polygon fill="#d9534f" stroke="#d9534f" points="692,-234 638,-234 638,-210 692,-210 692,-234"/>
<text text-anchor="middle" x="665" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balback</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balback -->
<g id="proc~~npa_f~~CallsGraph_edge43" class="edge"><title>proc~eigen&#45;&gt;proc~balback</title>
<path fill="none" stroke="#000000" d="M562.212,-223.59C581.108,-223.295 606.851,-222.893 627.72,-222.567"/>
<polygon fill="#000000" stroke="#000000" points="627.879,-226.065 637.823,-222.409 627.77,-219.066 627.879,-226.065"/>
</g>
<!-- proc~balance -->
<g id="proc~~npa_f~~CallsGraph_node40" class="node"><title>proc~balance</title>
<g id="a_proc~~npa_f~~CallsGraph_node40"><a xlink:href="../proc/balance.html" xlink:title="balance">
<polygon fill="#d9534f" stroke="#d9534f" points="692,-192 638,-192 638,-168 692,-168 692,-192"/>
<text text-anchor="middle" x="665" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">balance</text>
</a>
</g>
</g>
<!-- proc~eigen&#45;&gt;proc~balance -->
<g id="proc~~npa_f~~CallsGraph_edge44" class="edge"><title>proc~eigen&#45;&gt;proc~balance</title>
<path fill="none" stroke="#000000" d="M562.212,-214.99C581.28,-208.435 607.322,-199.483 628.29,-192.275"/>
<polygon fill="#000000" stroke="#000000" points="629.504,-195.559 637.823,-188.998 627.229,-188.939 629.504,-195.559"/>
</g>
<!-- proc~lubksb -->
<g id="proc~~npa_f~~CallsGraph_node44" class="node"><title>proc~lubksb</title>
<g id="a_proc~~npa_f~~CallsGraph_node44"><a xlink:href="../proc/lubksb.html" xlink:title="lubksb">
<polygon fill="#d9534f" stroke="#d9534f" points="692,-150 638,-150 638,-126 692,-126 692,-150"/>
<text text-anchor="middle" x="665" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lubksb</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~lubksb -->
<g id="proc~~npa_f~~CallsGraph_edge47" class="edge"><title>proc~matinv&#45;&gt;proc~lubksb</title>
<path fill="none" stroke="#000000" d="M562.212,-155.495C581.108,-152.247 606.851,-147.823 627.72,-144.236"/>
<polygon fill="#000000" stroke="#000000" points="628.561,-147.643 637.823,-142.499 627.375,-140.744 628.561,-147.643"/>
</g>
<!-- proc~ludcmp -->
<g id="proc~~npa_f~~CallsGraph_node45" class="node"><title>proc~ludcmp</title>
<g id="a_proc~~npa_f~~CallsGraph_node45"><a xlink:href="../proc/ludcmp.html" xlink:title="ludcmp">
<polygon fill="#d9534f" stroke="#d9534f" points="692,-108 638,-108 638,-84 692,-84 692,-108"/>
<text text-anchor="middle" x="665" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ludcmp</text>
</a>
</g>
</g>
<!-- proc~matinv&#45;&gt;proc~ludcmp -->
<g id="proc~~npa_f~~CallsGraph_edge48" class="edge"><title>proc~matinv&#45;&gt;proc~ludcmp</title>
<path fill="none" stroke="#000000" d="M562.181,-148.768C572.213,-144.334 583.713,-139.089 594,-134 607.235,-127.453 621.608,-119.756 633.867,-113.008"/>
<polygon fill="#000000" stroke="#000000" points="635.728,-115.978 642.775,-108.067 632.332,-109.857 635.728,-115.978"/>
</g>
<!-- proc~get_rate_matrix&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_edge49" class="edge"><title>proc~get_rate_matrix&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M818.703,-357.11C825.134,-360.767 831.344,-365.353 836,-371 890.756,-437.413 904.761,-544.119 908.311,-589.936"/>
<polygon fill="#000000" stroke="#000000" points="904.822,-590.231 908.992,-599.971 911.806,-589.756 904.822,-590.231"/>
</g>
<!-- proc~rswap -->
<g id="proc~~npa_f~~CallsGraph_node41" class="node"><title>proc~rswap</title>
<g id="a_proc~~npa_f~~CallsGraph_node41"><a xlink:href="../proc/rswap.html" xlink:title="RSWAP">
<polygon fill="#d9534f" stroke="#d9534f" points="813,-234 759,-234 759,-210 813,-210 813,-234"/>
<text text-anchor="middle" x="786" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RSWAP</text>
</a>
</g>
</g>
<!-- proc~elmhes&#45;&gt;proc~rswap -->
<g id="proc~~npa_f~~CallsGraph_edge35" class="edge"><title>proc~elmhes&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M692.115,-254.783C708.933,-248.847 731.013,-241.054 749.426,-234.556"/>
<polygon fill="#000000" stroke="#000000" points="750.681,-237.824 758.946,-231.196 748.351,-231.223 750.681,-237.824"/>
</g>
<!-- proc~hqrvec -->
<g id="proc~~npa_f~~CallsGraph_node42" class="node"><title>proc~hqrvec</title>
<g id="a_proc~~npa_f~~CallsGraph_node42"><a xlink:href="../proc/hqrvec.html" xlink:title="hqrvec">
<polygon fill="#d9534f" stroke="#d9534f" points="813,-66 759,-66 759,-42 813,-42 813,-66"/>
<text text-anchor="middle" x="786" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hqrvec</text>
</a>
</g>
</g>
<!-- proc~hqr2&#45;&gt;proc~hqrvec -->
<g id="proc~~npa_f~~CallsGraph_edge37" class="edge"><title>proc~hqr2&#45;&gt;proc~hqrvec</title>
<path fill="none" stroke="#000000" d="M692.115,-54C708.778,-54 730.607,-54 748.916,-54"/>
<polygon fill="#000000" stroke="#000000" points="748.946,-57.5001 758.946,-54 748.946,-50.5001 748.946,-57.5001"/>
</g>
<!-- proc~balback&#45;&gt;proc~rswap -->
<g id="proc~~npa_f~~CallsGraph_edge38" class="edge"><title>proc~balback&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M692.115,-222C708.778,-222 730.607,-222 748.916,-222"/>
<polygon fill="#000000" stroke="#000000" points="748.946,-225.5 758.946,-222 748.946,-218.5 748.946,-225.5"/>
</g>
<!-- proc~balance&#45;&gt;proc~rswap -->
<g id="proc~~npa_f~~CallsGraph_edge39" class="edge"><title>proc~balance&#45;&gt;proc~rswap</title>
<path fill="none" stroke="#000000" d="M692.115,-189.217C708.933,-195.153 731.013,-202.946 749.426,-209.444"/>
<polygon fill="#000000" stroke="#000000" points="748.351,-212.777 758.946,-212.804 750.681,-206.176 748.351,-212.777"/>
</g>
<!-- proc~comdiv -->
<g id="proc~~npa_f~~CallsGraph_node43" class="node"><title>proc~comdiv</title>
<g id="a_proc~~npa_f~~CallsGraph_node43"><a xlink:href="../proc/comdiv.html" xlink:title="Comdiv">
<polygon fill="#d9534f" stroke="#d9534f" points="937.5,-66 883.5,-66 883.5,-42 937.5,-42 937.5,-66"/>
<text text-anchor="middle" x="910.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Comdiv</text>
</a>
</g>
</g>
<!-- proc~hqrvec&#45;&gt;proc~comdiv -->
<g id="proc~~npa_f~~CallsGraph_edge36" class="edge"><title>proc~hqrvec&#45;&gt;proc~comdiv</title>
<path fill="none" stroke="#000000" d="M813.279,-54C830.719,-54 853.846,-54 873.056,-54"/>
<polygon fill="#000000" stroke="#000000" points="873.264,-57.5001 883.264,-54 873.264,-50.5001 873.264,-57.5001"/>
</g>
<!-- proc~outerprod -->
<g id="proc~~npa_f~~CallsGraph_node46" class="node"><title>proc~outerprod</title>
<g id="a_proc~~npa_f~~CallsGraph_node46"><a xlink:href="../proc/outerprod.html" xlink:title="outerprod">
<polygon fill="#d94e8f" stroke="#d94e8f" points="815.5,-150 756.5,-150 756.5,-126 815.5,-126 815.5,-150"/>
<text text-anchor="middle" x="786" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">outerprod</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~outerprod -->
<g id="proc~~npa_f~~CallsGraph_edge45" class="edge"><title>proc~ludcmp&#45;&gt;proc~outerprod</title>
<path fill="none" stroke="#000000" d="M692.115,-105.217C708.163,-110.881 729.002,-118.236 746.874,-124.544"/>
<polygon fill="#000000" stroke="#000000" points="745.853,-127.895 756.448,-127.923 748.183,-121.294 745.853,-127.895"/>
</g>
<!-- proc~swap -->
<g id="proc~~npa_f~~CallsGraph_node47" class="node"><title>proc~swap</title>
<g id="a_proc~~npa_f~~CallsGraph_node47"><a xlink:href="../proc/swap.html" xlink:title="swap">
<polygon fill="#d9534f" stroke="#d9534f" points="813,-108 759,-108 759,-84 813,-84 813,-108"/>
<text text-anchor="middle" x="786" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">swap</text>
</a>
</g>
</g>
<!-- proc~ludcmp&#45;&gt;proc~swap -->
<g id="proc~~npa_f~~CallsGraph_edge46" class="edge"><title>proc~ludcmp&#45;&gt;proc~swap</title>
<path fill="none" stroke="#000000" d="M692.115,-96C708.778,-96 730.607,-96 748.916,-96"/>
<polygon fill="#000000" stroke="#000000" points="748.946,-99.5001 758.946,-96 748.946,-92.5001 748.946,-99.5001"/>
</g>
<!-- proc~neut_rates&#45;&gt;proc~normp -->
<g id="proc~~npa_f~~CallsGraph_edge66" class="edge"><title>proc~neut_rates&#45;&gt;proc~normp</title>
<path fill="none" stroke="#000000" d="M567.108,-317.626C576.514,-321.611 586.363,-326.981 594,-334 618.315,-356.346 608.427,-373.996 630,-399 632.184,-401.532 634.651,-403.977 637.234,-406.288"/>
<polygon fill="#000000" stroke="#000000" points="635.205,-409.15 645.163,-412.768 639.635,-403.73 635.205,-409.15"/>
</g>
<!-- proc~neut_rates&#45;&gt;interface~interpol_coeff -->
<g id="proc~~npa_f~~CallsGraph_edge67" class="edge"><title>proc~neut_rates&#45;&gt;interface~interpol_coeff</title>
<path fill="none" stroke="#000000" d="M565.362,-320.056C574.675,-324.171 584.91,-329.004 594,-334 643.477,-361.192 656.198,-368.381 700,-404 776.896,-466.53 857.16,-553.275 891.828,-591.974"/>
<polygon fill="#000000" stroke="#000000" points="889.624,-594.761 898.89,-599.898 894.85,-590.104 889.624,-594.761"/>
</g>
<!-- proc~mc_halo&#45;&gt;proc~get_plasma -->
<g id="proc~~npa_f~~CallsGraph_edge72" class="edge"><title>proc~mc_halo&#45;&gt;proc~get_plasma</title>
<path fill="none" stroke="#000000" d="M281.531,-282.167C290.9,-300.172 308.013,-335.214 317,-367 347.661,-475.446 299.778,-518.662 353,-618 356.878,-625.239 362.707,-631.777 368.814,-637.308"/>
<polygon fill="#000000" stroke="#000000" points="366.644,-640.056 376.573,-643.753 371.117,-634.671 366.644,-640.056"/>
</g>
<!-- proc~mc_halo&#45;&gt;proc~randu -->
<g id="proc~~npa_f~~CallsGraph_edge73" class="edge"><title>proc~mc_halo&#45;&gt;proc~randu</title>
<path fill="none" stroke="#000000" d="M301.147,-260.453C318.358,-254.168 341.107,-245.862 359.954,-238.979"/>
<polygon fill="#000000" stroke="#000000" points="361.211,-242.246 369.404,-235.529 358.81,-235.671 361.211,-242.246"/>
</g>
<!-- proc~randn -->
<g id="proc~~npa_f~~CallsGraph_node52" class="node"><title>proc~randn</title>
<g id="a_proc~~npa_f~~CallsGraph_node52"><a xlink:href="../proc/randn.html" xlink:title="randn">
<polygon fill="#d9534f" stroke="#d9534f" points="423.5,-92 369.5,-92 369.5,-68 423.5,-68 423.5,-92"/>
<text text-anchor="middle" x="396.5" y="-77.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">randn</text>
</a>
</g>
</g>
<!-- proc~mc_halo&#45;&gt;proc~randn -->
<g id="proc~~npa_f~~CallsGraph_edge71" class="edge"><title>proc~mc_halo&#45;&gt;proc~randn</title>
<path fill="none" stroke="#000000" d="M283.972,-257.99C292.676,-246.203 306.125,-227.625 317,-211 341.838,-173.027 368.549,-127.281 383.528,-101.124"/>
<polygon fill="#000000" stroke="#000000" points="386.752,-102.536 388.667,-92.1155 380.672,-99.0678 386.752,-102.536"/>
</g>
<!-- proc~randn&#45;&gt;omp_get_thread_num -->
<g id="proc~~npa_f~~CallsGraph_edge69" class="edge"><title>proc~randn&#45;&gt;omp_get_thread_num</title>
<path fill="none" stroke="#000000" d="M423.819,-80C435.841,-80 450.698,-80 465.566,-80"/>
<polygon fill="#000000" stroke="#000000" points="465.827,-83.5001 475.827,-80 465.827,-76.5001 465.827,-83.5001"/>
</g>
<!-- proc~rng_normal -->
<g id="proc~~npa_f~~CallsGraph_node53" class="node"><title>proc~rng_normal</title>
<g id="a_proc~~npa_f~~CallsGraph_node53"><a xlink:href="../proc/rng_normal.html" xlink:title="rng_normal">
<polygon fill="#d94e8f" stroke="#d94e8f" points="568.5,-37 501.5,-37 501.5,-13 568.5,-13 568.5,-37"/>
<text text-anchor="middle" x="535" y="-22.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rng_normal</text>
</a>
</g>
</g>
<!-- proc~randn&#45;&gt;proc~rng_normal -->
<g id="proc~~npa_f~~CallsGraph_edge70" class="edge"><title>proc~randn&#45;&gt;proc~rng_normal</title>
<path fill="none" stroke="#000000" d="M423.819,-69.3954C443.884,-61.3106 471.843,-50.0448 494.576,-40.8852"/>
<polygon fill="#000000" stroke="#000000" points="495.993,-44.0878 503.96,-37.104 493.377,-37.595 495.993,-44.0878"/>
</g>
<!-- proc~rng_normal&#45;&gt;proc~rng_uniform -->
<g id="proc~~npa_f~~CallsGraph_edge68" class="edge"><title>proc~rng_normal&#45;&gt;proc~rng_uniform</title>
<path fill="none" stroke="#000000" d="M568.631,-21.6859C584.088,-20.116 602.789,-18.2168 619.521,-16.5174"/>
<polygon fill="#000000" stroke="#000000" points="620.043,-19.9825 629.638,-15.4899 619.335,-13.0183 620.043,-19.9825"/>
</g>
</g>
</svg>
</div>
                <script>var panprocnpa_fCallsGraph = svgPanZoom('#procnpa_fCallsGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
Nodes of different colours represent the following:
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="26pt"
 viewBox="0.00 0.00 641.00 25.98" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.811906 0.811906) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 785.5,-28 785.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.5,-24 72.5,-24 72.5,-0 139.5,-0 139.5,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Type -->
<g id="node3" class="node"><title>Type</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="212,-24 158,-24 158,-0 212,-0 212,-24"/>
<text text-anchor="middle" x="185" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type</text>
</g>
<!-- Subroutine -->
<g id="node4" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="294,-24 230,-24 230,-0 294,-0 294,-24"/>
<text text-anchor="middle" x="262" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node5" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="366,-24 312,-24 312,-0 366,-0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node6" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="439.5,-24 384.5,-24 384.5,-0 439.5,-0 439.5,-24"/>
<text text-anchor="middle" x="412" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node7" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="594,-24 458,-24 458,-0 594,-0 594,-24"/>
<text text-anchor="middle" x="526" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node8" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="666,-24 612,-24 612,-0 666,-0 666,-24"/>
<text text-anchor="middle" x="639" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node9" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="781.5,-24 684.5,-24 684.5,-0 781.5,-0 781.5,-24"/>
<text text-anchor="middle" x="733" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

Where possible, edges connecting nodes are given different colours to make them
easier to distinguish in large graphs.
<h5>Module Graph</h5>
<p>Solid arrows point from a parent (sub)module to the submodule which is
descended from it. Dashed arrows point from a module being used to the
module using it.</p>
<h5>Type Graph</h5>
<p>Solid arrows point from one derived type to another which extends
(inherits from) it. Dashed arrows point from a derived type to another
type containing it as a components, with a label listing the name(s) of
said component(s).</p>
<h5>Call Graph</h5>
<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.</p>

                      </div>
                    </div>
                  </div>
                </div>
                
     
     
     <h3>Called By</h3>
     
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~npa_f~~CalledByGraph Pages: 1 -->
<svg id="procnpa_fCalledByGraph" width="152pt" height="32pt"
 viewBox="0.00 0.00 152.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~npa_f~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~npa_f~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 148,-28 148,4 -4,4"/>
<!-- proc~npa_f -->
<g id="proc~~npa_f~~CalledByGraph_node1" class="node"><title>proc~npa_f</title>
<polygon fill="none" stroke="black" points="144,-24 90,-24 90,-0 144,-0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">npa_f</text>
</g>
<!-- program~fidasim -->
<g id="proc~~npa_f~~CalledByGraph_node2" class="node"><title>program~fidasim</title>
<g id="a_proc~~npa_f~~CalledByGraph_node2"><a xlink:href="../program/fidasim.html" xlink:title="fidasim">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fidasim</text>
</a>
</g>
</g>
<!-- program~fidasim&#45;&gt;proc~npa_f -->
<g id="proc~~npa_f~~CalledByGraph_edge1" class="edge"><title>program~fidasim&#45;&gt;proc~npa_f</title>
<path fill="none" stroke="#000000" d="M54.4029,-12C62.3932,-12 71.3106,-12 79.8241,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.919,-15.5001 89.919,-12 79.919,-8.5001 79.919,-15.5001"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
Nodes of different colours represent the following:
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="26pt"
 viewBox="0.00 0.00 641.00 25.98" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.811906 0.811906) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 785.5,-28 785.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.5,-24 72.5,-24 72.5,-0 139.5,-0 139.5,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Type -->
<g id="node3" class="node"><title>Type</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="212,-24 158,-24 158,-0 212,-0 212,-24"/>
<text text-anchor="middle" x="185" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type</text>
</g>
<!-- Subroutine -->
<g id="node4" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="294,-24 230,-24 230,-0 294,-0 294,-24"/>
<text text-anchor="middle" x="262" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node5" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="366,-24 312,-24 312,-0 366,-0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node6" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="439.5,-24 384.5,-24 384.5,-0 439.5,-0 439.5,-24"/>
<text text-anchor="middle" x="412" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node7" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="594,-24 458,-24 458,-0 594,-0 594,-24"/>
<text text-anchor="middle" x="526" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node8" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="666,-24 612,-24 612,-0 666,-0 666,-24"/>
<text text-anchor="middle" x="639" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node9" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="781.5,-24 684.5,-24 684.5,-0 781.5,-0 781.5,-24"/>
<text text-anchor="middle" x="733" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

Where possible, edges connecting nodes are given different colours to make them
easier to distinguish in large graphs.
<h5>Module Graph</h5>
<p>Solid arrows point from a parent (sub)module to the submodule which is
descended from it. Dashed arrows point from a module being used to the
module using it.</p>
<h5>Type Graph</h5>
<p>Solid arrows point from one derived type to another which extends
(inherits from) it. Dashed arrows point from a derived type to another
type containing it as a components, with a label listing the name(s) of
said component(s).</p>
<h5>Call Graph</h5>
<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.</p>

                      </div>
                    </div>
                  </div>
                </div>
                
     
    <br>
    
    <section>
    <h2>Variables</h2>
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Visibility</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-i%7E44"></span>integer,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>i</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-j%7E23"></span>integer,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>j</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-k%7E12"></span>integer,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>k</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iion%7E3"></span>integer,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>iion</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-det%7E3"></span>integer,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>det</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ip%7E3"></span>integer,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>ip</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ri%7E13"></span>real(kind=Float64),</td>
  
  <td>public,</td>
  <td>dimension(3)</td><td>::</td>
  <td><strong>ri</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-rf%7E5"></span>real(kind=Float64),</td>
  
  <td>public,</td>
  <td>dimension(3)</td><td>::</td>
  <td><strong>rf</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-vi%7E17"></span>real(kind=Float64),</td>
  
  <td>public,</td>
  <td>dimension(3)</td><td>::</td>
  <td><strong>vi</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ind%7E24"></span>integer,</td>
  
  <td>public,</td>
  <td>dimension(3)</td><td>::</td>
  <td><strong>ind</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pcell%7E2"></span>integer,</td>
  
  <td>public,</td>
  <td>dimension(3,beam_grid%ngrid)</td><td>::</td>
  <td><strong>pcell</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-plasma%7E13"></span>type(<a href='../type/localprofiles.html'>LocalProfiles</a>),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>plasma</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-neut_types%7E4"></span>integer,</td>
  
  <td>public,</td>
  <td>dimension(4)</td><td>::</td>
  <td><strong>neut_types</strong></td><td> =</td><td>[1, 2, 3, 4]</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-prob%7E6"></span>real(kind=Float64),</td>
  
  <td>public,</td>
  <td>dimension(nlevs)</td><td>::</td>
  <td><strong>prob</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-states%7E8"></span>real(kind=Float64),</td>
  
  <td>public,</td>
  <td>dimension(nlevs)</td><td>::</td>
  <td><strong>states</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-flux%7E5"></span>real(kind=Float64),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>flux</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-inpa"></span>integer,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>inpa</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pcnt%7E2"></span>integer,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>pcnt</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-papprox_tot%7E5"></span>real(kind=Float64),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>papprox_tot</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-maxcnt%7E2"></span>real(kind=Float64),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>maxcnt</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-cnt%7E8"></span>real(kind=Float64),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>cnt</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-inv_maxcnt%7E3"></span>real(kind=Float64),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>inv_maxcnt</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-papprox%7E5"></span>real(kind=Float64),</td>
  
  <td>public,</td>
  <td>dimension(beam_grid%nx,beam_grid%ny,beam_grid%nz)</td><td>::</td>
  <td><strong>papprox</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nlaunch%7E7"></span>real(kind=Float64),</td>
  
  <td>public,</td>
  <td>dimension(beam_grid%nx,beam_grid%ny,beam_grid%nz)</td><td>::</td>
  <td><strong>nlaunch</strong></td><td></td><td></td><td></td>
  
</tr>

</tbody>
</table>

    </section>
    <br>
    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">npa_f</span>
    <span class="c">!+ Calculate NPA flux using a fast-ion distribution function F(E,p,r,z)</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span>  <span class="c">!! indices  x,y,z  of cells</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iion</span><span class="p">,</span> <span class="n">det</span><span class="p">,</span> <span class="n">ip</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ri</span>      <span class="c">!! start position</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rf</span>      <span class="c">!! end position</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vi</span>      <span class="c">!! velocity of fast ions</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ind</span>      <span class="c">!! new actual cell</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ngrid</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pcell</span>
  
    <span class="c">!! Determination of the CX probability</span>
    <span class="k">type</span><span class="p">(</span><span class="n">LocalProfiles</span><span class="p">)</span> <span class="kd">::</span> <span class="n">plasma</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">neut_types</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">prob</span>    <span class="c">!! Prob. for CX</span>
  
    <span class="c">!! Collisiional radiative model along track</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">nlevs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">states</span>  <span class="c">!! Density of n-states</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">flux</span> <span class="c">!! flux</span>
  
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">inpa</span><span class="p">,</span><span class="n">pcnt</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">papprox_tot</span><span class="p">,</span> <span class="n">maxcnt</span><span class="p">,</span> <span class="n">cnt</span><span class="p">,</span> <span class="n">inv_maxcnt</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nx</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ny</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nz</span><span class="p">)</span> <span class="kd">::</span> <span class="n">papprox</span><span class="p">,</span> <span class="n">nlaunch</span> <span class="c">!! approx. density</span>
  
    <span class="n">papprox</span><span class="o">=</span><span class="mf">0.</span><span class="n">d0</span>
    <span class="n">papprox_tot</span><span class="o">=</span><span class="mf">0.</span><span class="n">d0</span>
  
    <span class="n">pcnt</span><span class="o">=</span><span class="mi">1</span>
    <span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nz</span>
        <span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">ny</span>
            <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">nx</span>
                <span class="n">ind</span> <span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span>
                <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">ind</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span>
                <span class="n">papprox</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">nbif_type</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
                                <span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">nbih_type</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
                                <span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">nbit_type</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
                                <span class="nb">sum</span><span class="p">(</span><span class="n">neut</span><span class="p">%</span><span class="n">dens</span><span class="p">(:,</span><span class="n">halo_type</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span><span class="o">*</span> <span class="p">&amp;</span>
                                <span class="n">plasma</span><span class="p">%</span><span class="n">denf</span>
  
                <span class="k">if</span><span class="p">(</span><span class="n">papprox</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.</span><span class="nb">and</span><span class="p">.(</span><span class="n">npa_chords</span><span class="p">%</span><span class="n">hit</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span> <span class="k">then</span>
<span class="k">                    </span><span class="n">pcell</span><span class="p">(:,</span><span class="n">pcnt</span><span class="p">)</span><span class="o">=</span> <span class="n">ind</span>
                    <span class="n">pcnt</span> <span class="o">=</span> <span class="n">pcnt</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">endif</span>
  
                <span class="k">if</span><span class="p">(</span><span class="n">plasma</span><span class="p">%</span><span class="n">in_plasma</span><span class="p">)</span> <span class="n">papprox_tot</span><span class="o">=</span><span class="n">papprox_tot</span><span class="o">+</span><span class="n">papprox</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
            <span class="n">enddo</span>
        <span class="n">enddo</span>
    <span class="n">enddo</span>
    <span class="n">pcnt</span> <span class="o">=</span> <span class="n">pcnt</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">maxcnt</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">pcnt</span><span class="p">)</span>
    <span class="n">inv_maxcnt</span> <span class="o">=</span> <span class="mi">10</span><span class="mf">0.0</span><span class="o">/</span><span class="n">maxcnt</span>
  
    <span class="k">call </span><span class="n">get_nlaunch</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">n_npa</span><span class="p">,</span><span class="n">papprox</span><span class="p">,</span><span class="n">papprox_tot</span><span class="p">,</span><span class="n">nlaunch</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T6,&quot;# of markers: &quot;,i9)&#39;</span><span class="p">)</span> <span class="nb">int</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">nlaunch</span><span class="p">))</span>
    <span class="n">endif</span>
  
    <span class="c">!! Loop over all cells that can contribute to NPA signal</span>
    <span class="n">cnt</span><span class="o">=</span><span class="mf">0.</span><span class="n">d0</span>
    <span class="c">!$OMP PARALLEL DO schedule(guided) private(ip,i,j,k,inpa,iion,ind, &amp;</span>
    <span class="c">!$OMP&amp; vi,ri,rf,det,plasma,prob,states,flux)</span>
    <span class="n">loop_over_cells</span><span class="p">:</span> <span class="k">do </span><span class="n">ip</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">pcnt</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">pcell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ip</span><span class="p">)</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">pcell</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">ip</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">pcell</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">ip</span><span class="p">)</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>
        <span class="n">npa_loop</span><span class="p">:</span> <span class="k">do </span><span class="n">inpa</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">npa</span><span class="p">%</span><span class="n">nloop</span>
            <span class="n">loop_over_fast_ions</span><span class="p">:</span> <span class="k">do </span><span class="n">iion</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
                <span class="c">!! Sample fast ion distribution for velocity and position</span>
                <span class="k">call </span><span class="n">mc_fastion</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">,</span> <span class="n">at_guiding_center</span> <span class="o">=</span> <span class="p">.</span><span class="n">False</span><span class="p">.)</span>
                <span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">vi</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">cycle </span><span class="n">loop_over_fast_ions</span>
  
                <span class="c">!! Check if particle hits a NPA detector</span>
                <span class="k">call </span><span class="n">hit_npa_detector</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span> <span class="n">vi</span> <span class="p">,</span><span class="n">det</span><span class="p">,</span> <span class="n">rf</span><span class="p">)</span>
                <span class="k">if</span><span class="p">(</span><span class="n">det</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">cycle </span><span class="n">loop_over_fast_ions</span>
                
                <span class="c">!! Calculate CX probability with beam and halo neutrals</span>
                <span class="k">call </span><span class="n">get_beam_cx_prob</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">ri</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">neut_types</span><span class="p">,</span><span class="n">prob</span><span class="p">)</span>
                <span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">prob</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span><span class="k">cycle </span><span class="n">loop_over_fast_ions</span>
  
                <span class="c">!! Attenuate states as the particle move through plasma</span>
                <span class="k">call </span><span class="n">get_plasma</span><span class="p">(</span><span class="n">plasma</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">ri</span><span class="p">)</span>
                <span class="n">states</span><span class="o">=</span><span class="n">prob</span><span class="o">*</span><span class="n">plasma</span><span class="p">%</span><span class="n">denf</span>
                <span class="k">call </span><span class="n">attenuate</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">states</span><span class="p">)</span>
  
                <span class="c">!! Store NPA Flux</span>
                <span class="n">flux</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="o">*</span><span class="n">beam_grid</span><span class="p">%</span><span class="n">dv</span><span class="o">/</span><span class="p">(</span><span class="n">nlaunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="kt">real</span><span class="p">(</span><span class="n">npa</span><span class="p">%</span><span class="n">nloop</span><span class="p">))</span>
                <span class="k">call </span><span class="n">store_npa</span><span class="p">(</span><span class="n">det</span><span class="p">,</span><span class="n">ri</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">vi</span><span class="p">,</span><span class="n">flux</span><span class="p">)</span>
            <span class="n">enddo</span> <span class="n">loop_over_fast_ions</span>
        <span class="n">enddo</span> <span class="n">npa_loop</span>
        <span class="n">cnt</span><span class="o">=</span><span class="n">cnt</span><span class="o">+</span><span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">inputs</span><span class="p">%</span><span class="n">verbose</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="k">then</span>
<span class="k">            WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(f7.2,&quot;% completed&quot;,a,$)&#39;</span><span class="p">)</span> <span class="n">cnt</span><span class="o">*</span><span class="n">inv_maxcnt</span><span class="p">,</span><span class="nb">char</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
        <span class="n">endif</span>
    <span class="n">enddo</span> <span class="n">loop_over_cells</span>
    <span class="c">!$OMP END PARALLEL DO</span>
    <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(T4,&quot;Number of NPA particles that hit a detector: &quot;,i8)&#39;</span><span class="p">)</span> <span class="n">npa</span><span class="p">%</span><span class="n">npart</span>

<span class="k">end subroutine </span><span class="n">npa_f</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>

    <hr>
    <footer>
      <div class="row">
        <div class="col-md-4">&copy; 2016 </div>
        <div class="col-md-4"><span class="text-center"> FIDASIM was developed by Luke Stagner</span></div>
        <div class="col-md-4">
          <span class="pull-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </span>
        </div>
      </div>
      <br>
    </footer>
    </div> <!-- /container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': { 
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>